if (self.CavalryLogger) { CavalryLogger.start_js(["K8zLu"]); }

__d("useVodInstreamPostRollAdsScheduler",["DateConsts","InstreamAdsConfig","InstreamAdsIsEmptyContext","InstreamAdsPalmStateContext","InstreamPalmStateManagerContext","React","VideoPlayerHooks","VideoPlayerInstreamAdsStateHooks"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(){var a=g.useRef(!1),c=b("InstreamAdsIsEmptyContext").useInstreamAdsIsEmptyContext(),d=g.useRef(c),e=b("VideoPlayerHooks").useDuration(),f=b("InstreamAdsPalmStateContext").useInstreamAdsPalmStateContext(),h=b("InstreamPalmStateManagerContext").useInstreamPalmStateManager(),i=b("VideoPlayerInstreamAdsStateHooks").useInstreamAdsPostRollValue(),j=g.useRef(!1),k=b("VideoPlayerHooks").useController(),l=b("VideoPlayerInstreamAdsStateHooks").useInstreamAdsPostRollEndedOrSkippedStateSetter();g.useEffect(function(){d.current=c},[c]);g.useEffect(function(){function c(){var a=k.getPlayheadPosition()*b("DateConsts").MS_PER_SEC;a=e*b("DateConsts").MS_PER_SEC-a;return a<=b("InstreamAdsConfig").getPostRollPreFetchTimeMs()&&a>=b("InstreamAdsConfig").getPostRollPreFetchEndTimeMs()}function f(){h.setCurrentInsertion(i),h.setState("FETCH_POST_ROLL"),l(!1),a.current=!0}function g(){d.current===!1?h.setState("START_AD"):(h.setState("INIT"),l(!0)),j.current=!0}var m=i!==null?k.subscribe(function(){var b=k.getCurrentState(),d=b.ended;b=b.playing;b&&a.current===!1&&c()&&f();d&&a.current===!0&&j.current===!1&&g()}):null;return function(){m&&m.remove()}},[e,f,h,i,l,k])}}),null);