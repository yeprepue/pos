if (self.CavalryLogger) { CavalryLogger.start_js(["A9H+e"]); }

__d("OzHiveStreaming",[],(function $module_OzHiveStreaming(global,require,requireDynamic,requireLazy,module,exports){!function(define){!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).adapter=e()}(function(){return function a(o,s,c){function d(t,e){if(!s[t]){if(!o[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(p)return p(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var i=s[t]={exports:{}};o[t][0].call(i.exports,function(e){return d(o[t][1][e]||e)},i,i.exports,a,o,s,c)}return s[t].exports}for(var p="function"==typeof require&&require,e=0;e<c.length;e++)d(c[e]);return d}({1:[function(e,t,r){"use strict";var n=e("./adapter_factory.js").adapterFactory({window:window});t.exports=n},{"./adapter_factory.js":2}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.adapterFactory=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).window,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},r=a.log,n=a.detectBrowser(e),i={browserDetails:n,commonShim:p,extractVersion:a.extractVersion,disableLog:a.disableLog,disableWarnings:a.disableWarnings};switch(n.browser){case"chrome":if(!o||!o.shimPeerConnection||!t.shimChrome)return r("Chrome shim is not included in this adapter release."),i;r("adapter.js shimming chrome."),(i.browserShim=o).shimGetUserMedia(e),o.shimMediaStream(e),o.shimPeerConnection(e),o.shimOnTrack(e),o.shimAddTrackRemoveTrack(e),o.shimGetSendersWithDtmf(e),o.shimGetStats(e),o.shimSenderReceiverGetStats(e),o.fixNegotiationNeeded(e),p.shimRTCIceCandidate(e),p.shimConnectionState(e),p.shimMaxMessageSize(e),p.shimSendThrowTypeError(e),p.removeAllowExtmapMixed(e);break;case"firefox":if(!c||!c.shimPeerConnection||!t.shimFirefox)return r("Firefox shim is not included in this adapter release."),i;r("adapter.js shimming firefox."),(i.browserShim=c).shimGetUserMedia(e),c.shimPeerConnection(e),c.shimOnTrack(e),c.shimRemoveStream(e),c.shimSenderGetStats(e),c.shimReceiverGetStats(e),c.shimRTCDataChannel(e),p.shimRTCIceCandidate(e),p.shimConnectionState(e),p.shimMaxMessageSize(e),p.shimSendThrowTypeError(e);break;case"edge":if(!s||!s.shimPeerConnection||!t.shimEdge)return r("MS edge shim is not included in this adapter release."),i;r("adapter.js shimming edge."),(i.browserShim=s).shimGetUserMedia(e),s.shimGetDisplayMedia(e),s.shimPeerConnection(e),s.shimReplaceTrack(e),p.shimMaxMessageSize(e),p.shimSendThrowTypeError(e);break;case"safari":if(!d||!t.shimSafari)return r("Safari shim is not included in this adapter release."),i;r("adapter.js shimming safari."),(i.browserShim=d).shimRTCIceServerUrls(e),d.shimCreateOfferLegacy(e),d.shimCallbacksAPI(e),d.shimLocalStreamsAPI(e),d.shimRemoteStreamsAPI(e),d.shimTrackEventTransceiver(e),d.shimGetUserMedia(e),p.shimRTCIceCandidate(e),p.shimMaxMessageSize(e),p.shimSendThrowTypeError(e),p.removeAllowExtmapMixed(e);break;default:r("Unsupported browser!")}return i};var a=n(e("./utils")),o=n(e("./chrome/chrome_shim")),s=n(e("./edge/edge_shim")),c=n(e("./firefox/firefox_shim")),d=n(e("./safari/safari_shim")),p=n(e("./common_shim"));function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return n.shimGetUserMedia}});var i=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}}),r.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},r.shimOnTrack=function(a){if("object"!==(void 0===a?"undefined":s(a))||!a.RTCPeerConnection||"ontrack"in a.RTCPeerConnection.prototype)c.wrapPeerConnectionEvent(a,"track",function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e});else{Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var e=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var i=this;return this._ontrackpoly||(this._ontrackpoly=function(n){n.stream.addEventListener("addtrack",function(t){var e=void 0;e=a.RTCPeerConnection.prototype.getReceivers?i.getReceivers().find(function(e){return e.track&&e.track.id===t.track.id}):{track:t.track};var r=new Event("track");r.track=t.track,r.receiver=e,r.transceiver={receiver:e},r.streams=[n.stream],i.dispatchEvent(r)}),n.stream.getTracks().forEach(function(t){var e=void 0;e=a.RTCPeerConnection.prototype.getReceivers?i.getReceivers().find(function(e){return e.track&&e.track.id===t.id}):{track:t};var r=new Event("track");r.track=t,r.receiver=e,r.transceiver={receiver:e},r.streams=[n.stream],i.dispatchEvent(r)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}},r.shimGetSendersWithDtmf=function(e){if("object"===(void 0===e?"undefined":s(e))&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var n=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var i=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,t){var r=i.apply(this,arguments);return r||(r=n(this,e),this._senders.push(r)),r};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var a=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._senders=this._senders||[],a.apply(this,[e]),e.getTracks().forEach(function(e){t._senders.push(n(t,e))})};var t=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var r=this;this._senders=this._senders||[],t.apply(this,[e]),e.getTracks().forEach(function(t){var e=r._senders.find(function(e){return e.track===t});e&&r._senders.splice(r._senders.indexOf(e),1)})}}else if("object"===(void 0===e?"undefined":s(e))&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var o=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=o.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},r.shimGetStats=function(e){if(!e.RTCPeerConnection)return;var s=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,t,r){var n=this,i=arguments;if(0<arguments.length&&"function"==typeof e)return s.apply(this,arguments);if(0===s.length&&(0===arguments.length||"function"!=typeof e))return s.apply(this,[]);function a(e){var n={};return e.result().forEach(function(t){var r={id:t.id,timestamp:t.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[t.type]||t.type};t.names().forEach(function(e){r[e]=t.stat(e)}),n[r.id]=r}),n}function o(t){return new Map(Object.keys(t).map(function(e){return[e,t[e]]}))}return 2<=arguments.length?s.apply(this,[function(e){i[1](o(a(e)))},e]):new Promise(function(t,e){s.apply(n,[function(e){t(o(a(e)))},e])}).then(t,r)}},r.shimSenderReceiverGetStats=function(e){if(!("object"===(void 0===e?"undefined":s(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){var r=e.RTCPeerConnection.prototype.getSenders;r&&(e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=r.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e});var t=e.RTCPeerConnection.prototype.addTrack;t&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=t.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(e){return c.filterStats(e,t.track,!0)})}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var n=e.RTCPeerConnection.prototype.getReceivers;n&&(e.RTCPeerConnection.prototype.getReceivers=function(){var t=this,e=n.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e}),c.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(e){return c.filterStats(e,t.track,!1)})}}if(!("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype))return;var a=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(0<arguments.length&&arguments[0]instanceof e.MediaStreamTrack){var t=arguments[0],r=void 0,n=void 0,i=void 0;return this.getSenders().forEach(function(e){e.track===t&&(r?i=!0:r=e)}),this.getReceivers().forEach(function(e){return e.track===t&&(n?i=!0:n=e),e.track===t}),i||r&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):r?r.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return a.apply(this,arguments)}},r.shimAddTrackRemoveTrackWithNative=d,r.shimAddTrackRemoveTrack=function(o){if(!o.RTCPeerConnection)return;var e=c.detectBrowser(o);if(o.RTCPeerConnection.prototype.addTrack&&65<=e.version)return d(o);var r=o.RTCPeerConnection.prototype.getLocalStreams;o.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this,e=r.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map(function(e){return t._reverseStreams[e.id]})};var n=o.RTCPeerConnection.prototype.addStream;o.RTCPeerConnection.prototype.addStream=function(e){var r=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},e.getTracks().forEach(function(t){if(r.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[e.id]){var t=new o.MediaStream(e.getTracks());this._streams[e.id]=t,this._reverseStreams[t.id]=e,e=t}n.apply(this,[e])};var t=o.RTCPeerConnection.prototype.removeStream;function i(n,e){var i=e.sdp;return Object.keys(n._reverseStreams||[]).forEach(function(e){var t=n._reverseStreams[e],r=n._streams[t.id];i=i.replace(new RegExp(r.id,"g"),t.id)}),new RTCSessionDescription({type:e.type,sdp:i})}o.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},o.RTCPeerConnection.prototype.addTrack=function(t,e){var r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var n=[].slice.call(arguments,1);if(1!==n.length||!n[0].getTracks().find(function(e){return e===t}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var i=this._streams[e.id];if(i)i.addTrack(t),Promise.resolve().then(function(){r.dispatchEvent(new Event("negotiationneeded"))});else{var a=new o.MediaStream([t]);this._streams[e.id]=a,this._reverseStreams[a.id]=e,this.addStream(a)}return this.getSenders().find(function(e){return e.track===t})},["createOffer","createAnswer"].forEach(function(e){var t=o.RTCPeerConnection.prototype[e];o.RTCPeerConnection.prototype[e]=function(){var r=this,n=arguments;return arguments.length&&"function"==typeof arguments[0]?t.apply(this,[function(e){var t=i(r,e);n[0].apply(null,[t])},function(e){n[1]&&n[1].apply(null,e)},arguments[2]]):t.apply(this,arguments).then(function(e){return i(r,e)})}});var a=o.RTCPeerConnection.prototype.setLocalDescription;o.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type&&(arguments[0]=function(n,e){var i=e.sdp;return Object.keys(n._reverseStreams||[]).forEach(function(e){var t=n._reverseStreams[e],r=n._streams[t.id];i=i.replace(new RegExp(t.id,"g"),r.id)}),new RTCSessionDescription({type:e.type,sdp:i})}(this,arguments[0])),a.apply(this,arguments)};var s=Object.getOwnPropertyDescriptor(o.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(o.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=s.get.apply(this);return""===e.type?e:i(this,e)}}),o.RTCPeerConnection.prototype.removeTrack=function(t){var r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!t._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(t._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var n=void 0;Object.keys(this._streams).forEach(function(e){r._streams[e].getTracks().find(function(e){return t.track===e})&&(n=r._streams[e])}),n&&(1===n.getTracks().length?this.removeStream(this._reverseStreams[n.id]):n.removeTrack(t.track),this.dispatchEvent(new Event("negotiationneeded")))}},r.shimPeerConnection=function(r){!r.RTCPeerConnection&&r.webkitRTCPeerConnection&&(r.RTCPeerConnection=r.webkitRTCPeerConnection);if(!r.RTCPeerConnection)return;["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=r.RTCPeerConnection.prototype[e];r.RTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}});var e=r.RTCPeerConnection.prototype.addIceCandidate;r.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}},r.fixNegotiationNeeded=function(e){c.wrapPeerConnectionEvent(e,"negotiationneeded",function(e){if("stable"===e.target.signalingState)return e})};var c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}(e("../utils.js"));function d(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(e){return t._shimmedLocalStreams[e][0]})};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,t){if(!t)return n.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var r=n.apply(this,arguments);return this._shimmedLocalStreams[t.id]?-1===this._shimmedLocalStreams[t.id].indexOf(r)&&this._shimmedLocalStreams[t.id].push(r):this._shimmedLocalStreams[t.id]=[t,r],r};var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(function(t){if(r.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError")});var t=this.getSenders();i.apply(this,arguments);var n=this.getSenders().filter(function(e){return-1===t.indexOf(e)});this._shimmedLocalStreams[e.id]=[e].concat(n)};var t=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],t.apply(this,arguments)};var a=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(r){var n=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},r&&Object.keys(this._shimmedLocalStreams).forEach(function(e){var t=n._shimmedLocalStreams[e].indexOf(r);-1!==t&&n._shimmedLocalStreams[e].splice(t,1),1===n._shimmedLocalStreams[e].length&&delete n._shimmedLocalStreams[e]}),a.apply(this,arguments)}}},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(a,e){if(a.navigator.mediaDevices&&"getDisplayMedia"in a.navigator.mediaDevices)return;if(!a.navigator.mediaDevices)return;if("function"!=typeof e)return void 0;a.navigator.mediaDevices.getDisplayMedia=function(i){return e(i).then(function(e){var t=i.video&&i.video.width,r=i.video&&i.video.height,n=i.video&&i.video.frameRate;return i.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxFrameRate:n||3}},t&&(i.video.mandatory.maxWidth=t),r&&(i.video.mandatory.maxHeight=r),a.navigator.mediaDevices.getUserMedia(i)})}}},{}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimGetUserMedia=function(e){var o=e&&e.navigator;if(!o.mediaDevices)return;function s(i){if("object"!==(void 0===i?"undefined":d(i))||i.mandatory||i.optional)return i;var a={};return Object.keys(i).forEach(function(t){if("require"!==t&&"advanced"!==t&&"mediaSource"!==t){var r="object"===d(i[t])?i[t]:{ideal:i[t]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var n=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){a.optional=a.optional||[];var e={};"number"==typeof r.ideal?(e[n("min",t)]=r.ideal,a.optional.push(e),(e={})[n("max",t)]=r.ideal):e[n("",t)]=r.ideal,a.optional.push(e)}void 0!==r.exact&&"number"!=typeof r.exact?(a.mandatory=a.mandatory||{},a.mandatory[n("",t)]=r.exact):["min","max"].forEach(function(e){void 0!==r[e]&&(a.mandatory=a.mandatory||{},a.mandatory[n(e,t)]=r[e])})}}),i.advanced&&(a.optional=(a.optional||[]).concat(i.advanced)),a}function n(r,n){if(61<=c.version)return n(r);if((r=JSON.parse(JSON.stringify(r)))&&"object"===d(r.audio)){var e=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])};e((r=JSON.parse(JSON.stringify(r))).audio,"autoGainControl","googAutoGainControl"),e(r.audio,"noiseSuppression","googNoiseSuppression"),r.audio=s(r.audio)}if(r&&"object"===d(r.video)){var i=r.video.facingMode;i=i&&("object"===(void 0===i?"undefined":d(i))?i:{ideal:i});var t=c.version<66;if(i&&("user"===i.exact||"environment"===i.exact||"user"===i.ideal||"environment"===i.ideal)&&(!o.mediaDevices.getSupportedConstraints||!o.mediaDevices.getSupportedConstraints().facingMode||t)){delete r.video.facingMode;var a=void 0;if("environment"===i.exact||"environment"===i.ideal?a=["back","rear"]:"user"!==i.exact&&"user"!==i.ideal||(a=["front"]),a)return o.mediaDevices.enumerateDevices().then(function(e){var t=(e=e.filter(function(e){return"videoinput"===e.kind})).find(function(t){return a.some(function(e){return t.label.toLowerCase().includes(e)})});return!t&&e.length&&a.includes("back")&&(t=e[e.length-1]),t&&(r.video.deviceId=i.exact?{exact:t.deviceId}:{ideal:t.deviceId}),r.video=s(r.video),p("chrome: "+JSON.stringify(r)),n(r)})}r.video=s(r.video)}return p("chrome: "+JSON.stringify(r)),n(r)}function i(e){return 64<=c.version?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}}var c=a.detectBrowser(e);if(o.getUserMedia=function(e,t,r){n(e,function(e){o.webkitGetUserMedia(e,t,function(e){r&&r(i(e))})})}.bind(o),o.mediaDevices.getUserMedia){var r=o.mediaDevices.getUserMedia.bind(o.mediaDevices);o.mediaDevices.getUserMedia=function(e){return n(e,function(t){return r(t).then(function(e){if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return e},function(e){return Promise.reject(i(e))})})}}};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}(e("../utils.js")),p=a.log},{"../utils.js":15}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimRTCIceCandidate=function(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;var i=t.RTCIceCandidate;t.RTCIceCandidate=function(e){if("object"===(void 0===e?"undefined":a(e))&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var t=new i(e),r=s["default"].parseCandidate(e.candidate),n=Object.assign(t,r);return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new i(e)},t.RTCIceCandidate.prototype=i.prototype,c.wrapPeerConnectionEvent(t,"icecandidate",function(e){return e.candidate&&Object.defineProperty(e,"candidate",{value:new t.RTCIceCandidate(e.candidate),writable:"false"}),e})},r.shimMaxMessageSize=function(e){if(e.RTCSctpTransport||!e.RTCPeerConnection)return;var a=c.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var o=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,function(e){if(!e||!e.sdp)return!1;var t=s["default"].splitSections(e.sdp);return t.shift(),t.some(function(e){var t=s["default"].parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})}(arguments[0])){var e=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var r=parseInt(t[1],10);return r!=r?-1:r}(arguments[0]),t=function(e){var t=65536;return"firefox"===a.browser&&(t=a.version<57?-1===e?16384:2147483637:a.version<60?57===a.version?65535:65536:2147483637),t}(e),r=function(e,t){var r=65536;"firefox"===a.browser&&57===a.version&&(r=65535);var n=s["default"].matchPrefix(e.sdp,"a=max-message-size:");return 0<n.length?r=parseInt(n[0].substr(19),10):"firefox"===a.browser&&-1!==t&&(r=2147483637),r}(arguments[0],e),n=void 0;n=0===t&&0===r?Number.POSITIVE_INFINITY:0===t||0===r?Math.max(t,r):Math.min(t,r);var i={};Object.defineProperty(i,"maxMessageSize",{get:function(){return n}}),this._sctp=i}return o.apply(this,arguments)}},r.shimSendThrowTypeError=function(e){if(!(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype))return;function t(r,n){var i=r.send;r.send=function(){var e=arguments[0],t=e.length||e.size||e.byteLength;if("open"===r.readyState&&n.sctp&&t>n.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+n.sctp.maxMessageSize+" bytes)");return i.apply(r,arguments)}}var r=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=r.apply(this,arguments);return t(e,this),e},c.wrapPeerConnectionEvent(e,"datachannel",function(e){return t(e.channel,e.target),e})},r.shimConnectionState=function(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;var r=e.RTCPeerConnection.prototype;Object.defineProperty(r,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(r,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(function(e){var t=r[e];r[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var r=new Event("connectionstatechange",e);t.dispatchEvent(r)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),t.apply(this,arguments)}})},r.removeAllowExtmapMixed=function(e){if(!e.RTCPeerConnection)return;var t=c.detectBrowser(e);if("chrome"===t.browser&&71<=t.version)return;var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter(function(e){return"a=extmap-allow-mixed"!==e.trim()}).join("\n")),r.apply(this,arguments)}};var n,i=e("sdp"),s=(n=i)&&n.__esModule?n:{"default":n},c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}(e("./utils"))},{"./utils":15,sdp:17}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var n=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return n.shimGetUserMedia}});var i=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}}),r.shimPeerConnection=function(e){var t=o.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var r=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){r.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}});e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var n=d["default"](e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=s.filterIceServers(e.iceServers,t.version),o.log("ICE servers after filtering:",e.iceServers)),new n(e)},e.RTCPeerConnection.prototype=n.prototype},r.shimReplaceTrack=function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)};var a,o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}(e("../utils")),s=e("./filtericeservers"),c=e("rtcpeerconnection-shim"),d=(a=c)&&a.__esModule?a:{"default":a}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.filterIceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&i.deprecated("RTCIceServer.url","RTCIceServer.urls");var r="string"==typeof t;return r&&(t=[t]),t=t.filter(function(e){if(0===e.indexOf("stun:"))return!1;var t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!n?n=!0:t&&!n}),delete e.url,e.urls=r?t[0]:t,!!t.length}})};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}(e("../utils"))},{"../utils":15}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(e){if(!("getDisplayMedia"in e.navigator))return;if(!e.navigator.mediaDevices)return;if(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)return;e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)}},{}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetUserMedia=function(e){var t=e&&e.navigator,r=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return r(e)["catch"](function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))})}}},{}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return n.shimGetUserMedia}});var i=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}}),r.shimOnTrack=function(e){"object"===(void 0===e?"undefined":o(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},r.shimPeerConnection=function(r){var n=s.detectBrowser(r);if("object"!==(void 0===r?"undefined":o(r))||!r.RTCPeerConnection&&!r.mozRTCPeerConnection)return;!r.RTCPeerConnection&&r.mozRTCPeerConnection&&(r.RTCPeerConnection=r.mozRTCPeerConnection);["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=r.RTCPeerConnection.prototype[e];r.RTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}});var e=r.RTCPeerConnection.prototype.addIceCandidate;r.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},a=r.RTCPeerConnection.prototype.getStats;r.RTCPeerConnection.prototype.getStats=function(e,t,r){return a.apply(this,[e||null]).then(function(r){if(n.version<53&&!t)try{r.forEach(function(e){e.type=i[e.type]||e.type})}catch(e){if("TypeError"!==e.name)throw e;r.forEach(function(e,t){r.set(t,Object.assign({},e,{type:i[e.type]||e.type}))})}return r}).then(t,r)}},r.shimSenderGetStats=function(e){if("object"!==(void 0===e?"undefined":o(e))||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;var r=e.RTCPeerConnection.prototype.getSenders;r&&(e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=r.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e});var t=e.RTCPeerConnection.prototype.addTrack;t&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=t.apply(this,arguments);return e._pc=this,e});e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map())}},r.shimReceiverGetStats=function(e){if("object"!==(void 0===e?"undefined":o(e))||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;var r=e.RTCPeerConnection.prototype.getReceivers;r&&(e.RTCPeerConnection.prototype.getReceivers=function(){var t=this,e=r.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e});s.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}},r.shimRemoveStream=function(e){if(!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype)return;e.RTCPeerConnection.prototype.removeStream=function(t){var r=this;s.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(e){e.track&&t.getTracks().includes(e.track)&&r.removeTrack(e)})}},r.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)};var s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}(e("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(r,n){if(r.navigator.mediaDevices&&"getDisplayMedia"in r.navigator.mediaDevices)return;if(!r.navigator.mediaDevices)return;r.navigator.mediaDevices.getDisplayMedia=function(e){if(e&&e.video)return!0===e.video?e.video={mediaSource:n}:e.video.mediaSource=n,r.navigator.mediaDevices.getUserMedia(e);var t=new DOMException("getDisplayMedia without video constraints is undefined");return t.name="NotFoundError",t.code=8,Promise.reject(t)}}},{}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimGetUserMedia=function(e){var t=d.detectBrowser(e),n=e&&e.navigator,r=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,r){d.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,r)},!(55<t.version&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var i=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])},a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"===(void 0===e?"undefined":c(e))&&"object"===c(e.audio)&&(e=JSON.parse(JSON.stringify(e)),i(e.audio,"autoGainControl","mozAutoGainControl"),i(e.audio,"noiseSuppression","mozNoiseSuppression")),a(e)},r&&r.prototype.getSettings){var o=r.prototype.getSettings;r.prototype.getSettings=function(){var e=o.apply(this,arguments);return i(e,"mozAutoGainControl","autoGainControl"),i(e,"mozNoiseSuppression","noiseSuppression"),e}}if(r&&r.prototype.applyConstraints){var s=r.prototype.applyConstraints;r.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===(void 0===e?"undefined":c(e))&&(e=JSON.parse(JSON.stringify(e)),i(e,"autoGainControl","mozAutoGainControl"),i(e,"noiseSuppression","mozNoiseSuppression")),s.apply(this,[e])}}}};var d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}(e("../utils"))},{"../utils":15}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimLocalStreamsAPI=function(e){if("object"!==(void 0===e?"undefined":d(e))||!e.RTCPeerConnection)return;"getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams});if(!("addStream"in e.RTCPeerConnection.prototype)){var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(t){var r=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(t)||this._localStreams.push(t),t.getTracks().forEach(function(e){return n.call(r,e,t)})},e.RTCPeerConnection.prototype.addTrack=function(e,t){return t&&(this._localStreams?this._localStreams.includes(t)||this._localStreams.push(t):this._localStreams=[t]),n.call(this,e,t)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var r=this._localStreams.indexOf(e);if(-1!==r){this._localStreams.splice(r,1);var n=e.getTracks();this.getSenders().forEach(function(e){n.includes(e.track)&&t.removeTrack(e)})}})},r.shimRemoteStreamsAPI=function(e){if("object"!==(void 0===e?"undefined":d(e))||!e.RTCPeerConnection)return;"getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]});if(!("onaddstream"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var r=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){if(r._remoteStreams||(r._remoteStreams=[]),!r._remoteStreams.includes(e)){r._remoteStreams.push(e);var t=new Event("addstream");t.stream=e,r.dispatchEvent(t)}})})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){if(r._remoteStreams||(r._remoteStreams=[]),!(0<=r._remoteStreams.indexOf(e))){r._remoteStreams.push(e);var t=new Event("addstream");t.stream=e,r.dispatchEvent(t)}})}),t.apply(r,arguments)}}},r.shimCallbacksAPI=function(e){if("object"!==(void 0===e?"undefined":d(e))||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype,i=t.createOffer,a=t.createAnswer,o=t.setLocalDescription,s=t.setRemoteDescription,c=t.addIceCandidate;t.createOffer=function(e,t){var r=2<=arguments.length?arguments[2]:e,n=i.apply(this,[r]);return t?(n.then(e,t),Promise.resolve()):n},t.createAnswer=function(e,t){var r=2<=arguments.length?arguments[2]:e,n=a.apply(this,[r]);return t?(n.then(e,t),Promise.resolve()):n};var r=function(e,t,r){var n=o.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n};t.setLocalDescription=r,r=function(e,t,r){var n=s.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.setRemoteDescription=r,r=function(e,t,r){var n=c.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.addIceCandidate=r},r.shimGetUserMedia=function(e){var n=e&&e.navigator;if(n.mediaDevices&&n.mediaDevices.getUserMedia){var t=n.mediaDevices,r=t.getUserMedia.bind(t);n.mediaDevices.getUserMedia=function(e){return r(i(e))}}!n.getUserMedia&&n.mediaDevices&&n.mediaDevices.getUserMedia&&(n.getUserMedia=function(e,t,r){n.mediaDevices.getUserMedia(e).then(t,r)}.bind(n))},r.shimConstraints=i,r.shimRTCIceServerUrls=function(e){var a=e.RTCPeerConnection;e.RTCPeerConnection=function(e,t){if(e&&e.iceServers){for(var r=[],n=0;n<e.iceServers.length;n++){var i=e.iceServers[n];!i.hasOwnProperty("urls")&&i.hasOwnProperty("url")?(o.deprecated("RTCIceServer.url","RTCIceServer.urls"),(i=JSON.parse(JSON.stringify(i))).urls=i.url,delete i.url,r.push(i)):r.push(e.iceServers[n])}e.iceServers=r}return new a(e,t)},e.RTCPeerConnection.prototype=a.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return a.generateCertificate}})},r.shimTrackEventTransceiver=function(e){"object"===(void 0===e?"undefined":d(e))&&e.RTCPeerConnection&&"receiver"in e.RTCTrackEvent.prototype&&!e.RTCTransceiver&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},r.shimCreateOfferLegacy=function(e){var n=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var t=this.getTransceivers().find(function(e){return"audio"===e.receiver.track.kind});!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var r=this.getTransceivers().find(function(e){return"video"===e.receiver.track.kind});!1===e.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveVideo||r||this.addTransceiver("video")}return n.apply(this,arguments)}};var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}(e("../utils"));function i(e){return e&&void 0!==e.video?Object.assign({},e,{video:o.compactObject(e.video)}):e}},{"../utils":15}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.extractVersion=a,r.wrapPeerConnectionEvent=function(e,n,i){if(!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype,a=t.addEventListener;t.addEventListener=function(e,r){if(e!==n)return a.apply(this,arguments);function t(e){var t=i(e);t&&r(t)}return this._eventMap=this._eventMap||{},this._eventMap[r]=t,a.apply(this,[e,t])};var o=t.removeEventListener;t.removeEventListener=function(e,t){if(e!==n||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);var r=this._eventMap[t];return delete this._eventMap[t],o.apply(this,[e,r])},Object.defineProperty(t,"on"+n,{get:function(){return this["_on"+n]},set:function(e){this["_on"+n]&&(this.removeEventListener(n,this["_on"+n]),delete this["_on"+n]),e&&this.addEventListener(n,this["_on"+n]=e)},enumerable:!0,configurable:!0})},r.disableLog=function(e){return"boolean"==typeof e?(n=e)?"adapter.js logging disabled":"adapter.js logging enabled":new Error("Argument type: "+(void 0===e?"undefined":s(e))+". Please use a boolean.")},r.disableWarnings=function(e){return"boolean"==typeof e?(i=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled")):new Error("Argument type: "+(void 0===e?"undefined":s(e))+". Please use a boolean.")},r.log=function(){if("object"===("undefined"==typeof window?"undefined":s(window))){if(n)return;"undefined"!=typeof console&&"function"==typeof emptyFunction&&emptyFunction.apply(console,arguments)}},r.deprecated=function(e,t){if(!i)return},r.detectBrowser=function(e){var t=e.navigator,r={browser:null,version:null};if(void 0===e||!e.navigator)return r.browser="Not a browser.",r;if(t.mozGetUserMedia)r.browser="firefox",r.version=a(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)r.browser="chrome",r.version=a(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))r.browser="edge",r.version=a(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return r.browser="Not a supported browser.",r;r.browser="safari",r.version=a(t.userAgent,/AppleWebKit\/(\d+)\./,1)}return r},r.compactObject=function a(o){return"object"!==(void 0===o?"undefined":s(o))?o:Object.keys(o).reduce(function(e,t){var r="object"===s(o[t]),n=r?a(o[t]):o[t],i=r&&!Object.keys(n).length;return void 0===n||i?e:Object.assign(e,c({},t,n))},{})},r.walkStats=o,r.filterStats=function(r,t,e){var n=e?"outbound-rtp":"inbound-rtp",i=new Map();if(null===t)return i;var a=[];return r.forEach(function(e){"track"===e.type&&e.trackIdentifier===t.id&&a.push(e)}),a.forEach(function(t){r.forEach(function(e){e.type===n&&e.trackId===t.id&&o(r,e,i)})}),i};var n=!0,i=!0;function a(e,t,r){var n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}function o(t,r,n){r&&!n.has(r.id)&&(n.set(r.id,r),Object.keys(r).forEach(function(e){e.endsWith("Id")?o(t,t.get(r[e]),n):e.endsWith("Ids")&&r[e].forEach(function(e){o(t,t.get(e),n)})}))}},{}],16:[function(e,t,r){"use strict";var G=e("sdp");function c(e,t,r,n,i){var a=G.writeRtpDescription(e.kind,t);if(a+=G.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=G.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":i||"active"),a+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var o=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=o;var s="msid:"+(n?n.id:"-")+" "+o+"\r\n";a+="a="+s,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+G.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+G.localCName+"\r\n"),a}function A(d,p){function u(e,t){e=parseInt(e,10);for(var r=0;r<t.length;r++)if(t[r].payloadType===e||t[r].preferredPayloadType===e)return t[r]}var f={codecs:[],headerExtensions:[],fecMechanisms:[]};return d.codecs.forEach(function(r){for(var e=0;e<p.codecs.length;e++){var t=p.codecs[e];if(r.name.toLowerCase()===t.name.toLowerCase()&&r.clockRate===t.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&t.parameters.apt&&(n=r,i=t,a=d.codecs,o=p.codecs,c=s=void 0,s=u(n.parameters.apt,a),c=u(i.parameters.apt,o),!s||!c||s.name.toLowerCase()!==c.name.toLowerCase()))continue;(t=JSON.parse(JSON.stringify(t))).numChannels=Math.min(r.numChannels,t.numChannels),f.codecs.push(t),t.rtcpFeedback=t.rtcpFeedback.filter(function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1});break}}var n,i,a,o,s,c}),d.headerExtensions.forEach(function(e){for(var t=0;t<p.headerExtensions.length;t++){var r=p.headerExtensions[t];if(e.uri===r.uri){f.headerExtensions.push(r);break}}}),f}function a(e,t,r){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(r)}function N(e,t){var r=e.getRemoteCandidates().find(function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type});return r||e.addRemoteCandidate(t),!r}function m(e,t){var r=new Error(t);return r.name=e,r.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],r}t.exports=function(I,j){function L(e,t){t.addTrack(e),t.dispatchEvent(new I.MediaStreamTrackEvent("addtrack",{track:e}))}function i(e,t,r,n){var i=new Event("track");i.track=t,i.receiver=r,i.transceiver={receiver:r},i.streams=n,I.setTimeout(function(){e._dispatchEvent("track",i)})}function n(e){var t=this,r=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){t[e]=r[e].bind(r)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",e=JSON.parse(JSON.stringify(e||{})),this.usingBundle="max-bundle"===e.bundlePolicy,"negotiate"===e.rtcpMuxPolicy)throw m("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(e.rtcpMuxPolicy||(e.rtcpMuxPolicy="require"),e.iceTransportPolicy){case"all":case"relay":break;default:e.iceTransportPolicy="all"}switch(e.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:e.bundlePolicy="balanced"}if(e.iceServers=function(e,n){var i=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&!1;var r="string"==typeof t;return r&&(t=[t]),t=t.filter(function(e){return 0===e.indexOf("turn:")&&-1!==e.indexOf("transport=udp")&&-1===e.indexOf("turn:[")&&!i?i=!0:0===e.indexOf("stun:")&&14393<=n&&-1===e.indexOf("?transport=udp")}),delete e.url,e.urls=r?t[0]:t,!!t.length}})}(e.iceServers||[],j),this._iceGatherers=[],e.iceCandidatePoolSize)for(var n=e.iceCandidatePoolSize;0<n;n--)this._iceGatherers.push(new I.RTCIceGatherer({iceServers:e.iceServers,gatherPolicy:e.iceTransportPolicy}));else e.iceCandidatePoolSize=0;this._config=e,this.transceivers=[],this._sdpSessionId=G.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1}Object.defineProperty(n.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(n.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),n.prototype.onicecandidate=null,n.prototype.onaddstream=null,n.prototype.ontrack=null,n.prototype.onremovestream=null,n.prototype.onsignalingstatechange=null,n.prototype.oniceconnectionstatechange=null,n.prototype.onconnectionstatechange=null,n.prototype.onicegatheringstatechange=null,n.prototype.onnegotiationneeded=null,n.prototype.ondatachannel=null,n.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},n.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},n.prototype.getConfiguration=function(){return this._config},n.prototype.getLocalStreams=function(){return this.localStreams},n.prototype.getRemoteStreams=function(){return this.remoteStreams},n.prototype._createTransceiver=function(e,t){var r=0<this.transceivers.length,n={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&r)n.iceTransport=this.transceivers[0].iceTransport,n.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();n.iceTransport=i.iceTransport,n.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(n),n},n.prototype.addTrack=function(t,e){if(this._isClosed)throw m("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find(function(e){return e.track===t}))throw m("InvalidAccessError","Track already exists.");for(var n=0;n<this.transceivers.length;n++)this.transceivers[n].track||this.transceivers[n].kind!==t.kind||(r=this.transceivers[n]);return r=r||this._createTransceiver(t.kind),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(e)&&this.localStreams.push(e),r.track=t,r.stream=e,r.rtpSender=new I.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},n.prototype.addStream=function(t){var r=this;if(15025<=j)t.getTracks().forEach(function(e){r.addTrack(e,t)});else{var n=t.clone();t.getTracks().forEach(function(e,t){var r=n.getTracks()[t];e.addEventListener("enabled",function(e){r.enabled=e.enabled})}),n.getTracks().forEach(function(e){r.addTrack(e,n)})}},n.prototype.removeTrack=function(t){if(this._isClosed)throw m("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof I.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var e=this.transceivers.find(function(e){return e.rtpSender===t});if(!e)throw m("InvalidAccessError","Sender was not created by this connection.");var r=e.stream;e.rtpSender.stop(),e.rtpSender=null,e.track=null,e.stream=null,-1===this.transceivers.map(function(e){return e.stream}).indexOf(r)&&-1<this.localStreams.indexOf(r)&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},n.prototype.removeStream=function(e){var r=this;e.getTracks().forEach(function(t){var e=r.getSenders().find(function(e){return e.track===t});e&&r.removeTrack(e)})},n.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},n.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},n.prototype._createIceGatherer=function(r,e){var n=this;if(e&&0<r)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new I.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[r].bufferedCandidateEvents=[],this.transceivers[r].bufferCandidates=function(e){var t=!e.candidate||0===Object.keys(e.candidate).length;i.state=t?"completed":"gathering",null!==n.transceivers[r].bufferedCandidateEvents&&n.transceivers[r].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[r].bufferCandidates),i},n.prototype._gather=function(s,c){var d=this,p=this.transceivers[c].iceGatherer;if(!p.onlocalcandidate){var e=this.transceivers[c].bufferedCandidateEvents;this.transceivers[c].bufferedCandidateEvents=null,p.removeEventListener("localcandidate",this.transceivers[c].bufferCandidates),p.onlocalcandidate=function(e){if(!(d.usingBundle&&0<c)){var t=new Event("icecandidate");t.candidate={sdpMid:s,sdpMLineIndex:c};var r=e.candidate,n=!r||0===Object.keys(r).length;if(n)"new"!==p.state&&"gathering"!==p.state||(p.state="completed");else{"new"===p.state&&(p.state="gathering"),r.component=1,r.ufrag=p.getLocalParameters().usernameFragment;var i=G.writeCandidate(r);t.candidate=Object.assign(t.candidate,G.parseCandidate(i)),t.candidate.candidate=i,t.candidate.toJSON=function(){return{candidate:t.candidate.candidate,sdpMid:t.candidate.sdpMid,sdpMLineIndex:t.candidate.sdpMLineIndex,usernameFragment:t.candidate.usernameFragment}}}var a=G.getMediaSections(d._localDescription.sdp);a[t.candidate.sdpMLineIndex]+=n?"a=end-of-candidates\r\n":"a="+t.candidate.candidate+"\r\n",d._localDescription.sdp=G.getDescription(d._localDescription.sdp)+a.join("");var o=d.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});"gathering"!==d.iceGatheringState&&(d.iceGatheringState="gathering",d._emitGatheringStateChange()),n||d._dispatchEvent("icecandidate",t),o&&(d._dispatchEvent("icecandidate",new Event("icecandidate")),d.iceGatheringState="complete",d._emitGatheringStateChange())}},I.setTimeout(function(){e.forEach(function(e){p.onlocalcandidate(e)})},0)}},n.prototype._createIceAndDtlsTransports=function(){var e=this,t=new I.RTCIceTransport(null);t.onicestatechange=function(){e._updateIceConnectionState(),e._updateConnectionState()};var r=new I.RTCDtlsTransport(t);return r.ondtlsstatechange=function(){e._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),e._updateConnectionState()},{iceTransport:t,dtlsTransport:r}},n.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var r=this.transceivers[e].iceTransport;r&&(delete r.onicestatechange,delete this.transceivers[e].iceTransport);var n=this.transceivers[e].dtlsTransport;n&&(delete n.ondtlsstatechange,delete n.onerror,delete this.transceivers[e].dtlsTransport)},n.prototype._transceive=function(e,t,r){var n=A(e.localCapabilities,e.remoteCapabilities);t&&e.rtpSender&&(n.encodings=e.sendEncodingParameters,n.rtcp={cname:G.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(n.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(n)),r&&e.rtpReceiver&&0<n.codecs.length&&("video"===e.kind&&e.recvEncodingParameters&&j<15019&&e.recvEncodingParameters.forEach(function(e){delete e.rtx}),e.recvEncodingParameters.length?n.encodings=e.recvEncodingParameters:n.encodings=[{}],n.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(n.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(n.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(n))},n.prototype.setLocalDescription=function(e){var t,u,f=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(m("TypeError",'Unsupported type "'+e.type+'"'));if(!a("setLocalDescription",e.type,f.signalingState)||f._isClosed)return Promise.reject(m("InvalidStateError","Can not set local "+e.type+" in state "+f.signalingState));if("offer"===e.type)t=G.splitSections(e.sdp),u=t.shift(),t.forEach(function(e,t){var r=G.parseRtpParameters(e);f.transceivers[t].localCapabilities=r}),f.transceivers.forEach(function(e,t){f._gather(e.mid,t)});else if("answer"===e.type){t=G.splitSections(f._remoteDescription.sdp),u=t.shift();var l=0<G.matchPrefix(u,"a=ice-lite").length;t.forEach(function(e,t){var r=f.transceivers[t],n=r.iceGatherer,i=r.iceTransport,a=r.dtlsTransport,o=r.localCapabilities,s=r.remoteCapabilities;if(!(G.isRejected(e)&&0===G.matchPrefix(e,"a=bundle-only").length)&&!r.rejected){var c=G.getIceParameters(e,u),d=G.getDtlsParameters(e,u);l&&(d.role="server"),f.usingBundle&&0!==t||(f._gather(r.mid,t),"new"===i.state&&i.start(n,c,l?"controlling":"controlled"),"new"===a.state&&a.start(d));var p=A(o,s);f._transceive(r,0<p.codecs.length,!1)}})}return f._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?f._updateSignalingState("have-local-offer"):f._updateSignalingState("stable"),Promise.resolve()},n.prototype.setRemoteDescription=function(_){var w=this;if(-1===["offer","answer"].indexOf(_.type))return Promise.reject(m("TypeError",'Unsupported type "'+_.type+'"'));if(!a("setRemoteDescription",_.type,w.signalingState)||w._isClosed)return Promise.reject(m("InvalidStateError","Can not set remote "+_.type+" in state "+w.signalingState));var k={};w.remoteStreams.forEach(function(e){k[e.id]=e});var M=[],e=G.splitSections(_.sdp),D=e.shift(),x=0<G.matchPrefix(D,"a=ice-lite").length,O=0<G.matchPrefix(D,"a=group:BUNDLE ").length;w.usingBundle=O;var t=G.matchPrefix(D,"a=ice-options:")[0];return w.canTrickleIceCandidates=!!t&&0<=t.substr(14).split(" ").indexOf("trickle"),e.forEach(function(e,t){var r=G.splitLines(e),n=G.getKind(e),i=G.isRejected(e)&&0===G.matchPrefix(e,"a=bundle-only").length,a=r[0].substr(2).split(" ")[2],o=G.getDirection(e,D),s=G.parseMsid(e),c=G.getMid(e)||G.generateIdentifier();if(i||"application"===n&&("DTLS/SCTP"===a||"UDP/DTLS/SCTP"===a))w.transceivers[t]={mid:c,kind:n,protocol:a,rejected:!0};else{var d,p,u,f,l,m,h,v,y;!i&&w.transceivers[t]&&w.transceivers[t].rejected&&(w.transceivers[t]=w._createTransceiver(n,!0));var g,C,S=G.parseRtpParameters(e);i||(g=G.getIceParameters(e,D),(C=G.getDtlsParameters(e,D)).role="client"),h=G.parseRtpEncodingParameters(e);var T=G.parseRtcpParameters(e),R=0<G.matchPrefix(e,"a=end-of-candidates",D).length,P=G.matchPrefix(e,"a=candidate:").map(function(e){return G.parseCandidate(e)}).filter(function(e){return 1===e.component});if(("offer"===_.type||"answer"===_.type)&&!i&&O&&0<t&&w.transceivers[t]&&(w._disposeIceAndDtlsTransports(t),w.transceivers[t].iceGatherer=w.transceivers[0].iceGatherer,w.transceivers[t].iceTransport=w.transceivers[0].iceTransport,w.transceivers[t].dtlsTransport=w.transceivers[0].dtlsTransport,w.transceivers[t].rtpSender&&w.transceivers[t].rtpSender.setTransport(w.transceivers[0].dtlsTransport),w.transceivers[t].rtpReceiver&&w.transceivers[t].rtpReceiver.setTransport(w.transceivers[0].dtlsTransport)),"offer"!==_.type||i)"answer"===_.type&&!i&&(p=(d=w.transceivers[t]).iceGatherer,u=d.iceTransport,f=d.dtlsTransport,l=d.rtpReceiver,m=d.sendEncodingParameters,v=d.localCapabilities,w.transceivers[t].recvEncodingParameters=h,w.transceivers[t].remoteCapabilities=S,w.transceivers[t].rtcpParameters=T,P.length&&"new"===u.state&&(!x&&!R||O&&0!==t?P.forEach(function(e){N(d.iceTransport,e)}):u.setRemoteCandidates(P)),O&&0!==t||("new"===u.state&&u.start(p,g,"controlling"),"new"===f.state&&f.start(C)),!A(d.localCapabilities,d.remoteCapabilities).codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&d.sendEncodingParameters[0].rtx&&delete d.sendEncodingParameters[0].rtx,w._transceive(d,"sendrecv"===o||"recvonly"===o,"sendrecv"===o||"sendonly"===o),!l||"sendrecv"!==o&&"sendonly"!==o?delete d.rtpReceiver:(y=l.track,s?(k[s.stream]||(k[s.stream]=new I.MediaStream()),L(y,k[s.stream]),M.push([y,l,k[s.stream]])):(k["default"]||(k["default"]=new I.MediaStream()),L(y,k["default"]),M.push([y,l,k["default"]]))));else{(d=w.transceivers[t]||w._createTransceiver(n)).mid=c,d.iceGatherer||(d.iceGatherer=w._createIceGatherer(t,O)),P.length&&"new"===d.iceTransport.state&&(!R||O&&0!==t?P.forEach(function(e){N(d.iceTransport,e)}):d.iceTransport.setRemoteCandidates(P)),v=I.RTCRtpReceiver.getCapabilities(n),j<15019&&(v.codecs=v.codecs.filter(function(e){return"rtx"!==e.name})),m=d.sendEncodingParameters||[{ssrc:1001*(2*t+2)}];var b,E=!1;"sendrecv"===o||"sendonly"===o?(E=!d.rtpReceiver,l=d.rtpReceiver||new I.RTCRtpReceiver(d.dtlsTransport,n),E)&&(y=l.track,s&&"-"===s.stream||(b=s?(k[s.stream]||(k[s.stream]=new I.MediaStream(),Object.defineProperty(k[s.stream],"id",{get:function(){return s.stream}})),Object.defineProperty(y,"id",{get:function(){return s.track}}),k[s.stream]):(k["default"]||(k["default"]=new I.MediaStream()),k["default"])),b&&(L(y,b),d.associatedRemoteMediaStreams.push(b)),M.push([y,l,b])):d.rtpReceiver&&d.rtpReceiver.track&&(d.associatedRemoteMediaStreams.forEach(function(e){var t=e.getTracks().find(function(e){return e.id===d.rtpReceiver.track.id});t&&(function(e,t){t.removeTrack(e),t.dispatchEvent(new I.MediaStreamTrackEvent("removetrack",{track:e}))})(t,e)}),d.associatedRemoteMediaStreams=[]);d.localCapabilities=v,d.remoteCapabilities=S,d.rtpReceiver=l,d.rtcpParameters=T,d.sendEncodingParameters=m,d.recvEncodingParameters=h,w._transceive(w.transceivers[t],!1,E)}}}),void 0===w._dtlsRole&&(w._dtlsRole="offer"===_.type?"active":"passive"),w._remoteDescription={type:_.type,sdp:_.sdp},"offer"===_.type?w._updateSignalingState("have-remote-offer"):w._updateSignalingState("stable"),Object.keys(k).forEach(function(e){var n=k[e];if(n.getTracks().length){if(-1===w.remoteStreams.indexOf(n)){w.remoteStreams.push(n);var t=new Event("addstream");t.stream=n,I.setTimeout(function(){w._dispatchEvent("addstream",t)})}M.forEach(function(e){var t=e[0],r=e[1];n.id===e[2].id&&i(w,t,r,[n])})}}),M.forEach(function(e){e[2]||i(w,e[0],e[1],[])}),I.setTimeout(function(){w&&w.transceivers&&w.transceivers.forEach(function(e){e.iceTransport&&"new"===e.iceTransport.state&&0<e.iceTransport.getRemoteCandidates().length&&(!1,e.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},n.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},n.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},n.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,I.setTimeout(function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}},0))},n.prototype._updateIceConnectionState=function(){var e,t={"new":0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++}),e="new",0<t.failed?e="failed":0<t.checking?e="checking":0<t.disconnected?e="disconnected":0<t["new"]?e="new":0<t.connected?e="connected":0<t.completed&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",r)}},n.prototype._updateConnectionState=function(){var e,t={"new":0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)}),t.connected+=t.completed,e="new",0<t.failed?e="failed":0<t.connecting?e="connecting":0<t.disconnected?e="disconnected":0<t["new"]?e="new":0<t.connected&&(e="connected"),e!==this.connectionState){this.connectionState=e;var r=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",r)}},n.prototype.createOffer=function(){var s=this;if(s._isClosed)return Promise.reject(m("InvalidStateError","Can not call createOffer after close"));var t=s.transceivers.filter(function(e){return"audio"===e.kind}).length,r=s.transceivers.filter(function(e){return"video"===e.kind}).length,e=arguments[0];if(e){if(e.mandatory||e.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==e.offerToReceiveAudio&&(t=!0===e.offerToReceiveAudio?1:!1===e.offerToReceiveAudio?0:e.offerToReceiveAudio),void 0!==e.offerToReceiveVideo&&(r=!0===e.offerToReceiveVideo?1:!1===e.offerToReceiveVideo?0:e.offerToReceiveVideo)}for(s.transceivers.forEach(function(e){"audio"===e.kind?--t<0&&(e.wantReceive=!1):"video"===e.kind&&--r<0&&(e.wantReceive=!1)});0<t||0<r;)0<t&&(s._createTransceiver("audio"),t--),0<r&&(s._createTransceiver("video"),r--);var n=G.writeSessionBoilerplate(s._sdpSessionId,s._sdpSessionVersion++);s.transceivers.forEach(function(e,t){var r=e.track,n=e.kind,i=e.mid||G.generateIdentifier();e.mid=i,e.iceGatherer||(e.iceGatherer=s._createIceGatherer(t,s.usingBundle));var a=I.RTCRtpSender.getCapabilities(n);j<15019&&(a.codecs=a.codecs.filter(function(e){return"rtx"!==e.name})),a.codecs.forEach(function(t){"H264"===t.name&&void 0===t.parameters["level-asymmetry-allowed"]&&(t.parameters["level-asymmetry-allowed"]="1"),e.remoteCapabilities&&e.remoteCapabilities.codecs&&e.remoteCapabilities.codecs.forEach(function(e){t.name.toLowerCase()===e.name.toLowerCase()&&t.clockRate===e.clockRate&&(t.preferredPayloadType=e.payloadType)})}),a.headerExtensions.forEach(function(t){(e.remoteCapabilities&&e.remoteCapabilities.headerExtensions||[]).forEach(function(e){t.uri===e.uri&&(t.id=e.id)})});var o=e.sendEncodingParameters||[{ssrc:1001*(2*t+1)}];r&&15019<=j&&"video"===n&&!o[0].rtx&&(o[0].rtx={ssrc:o[0].ssrc+1}),e.wantReceive&&(e.rtpReceiver=new I.RTCRtpReceiver(e.dtlsTransport,n)),e.localCapabilities=a,e.sendEncodingParameters=o}),"max-compat"!==s._config.bundlePolicy&&(n+="a=group:BUNDLE "+s.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),n+="a=ice-options:trickle\r\n",s.transceivers.forEach(function(e,t){n+=c(e,e.localCapabilities,"offer",e.stream,s._dtlsRole),n+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===s.iceGatheringState||0!==t&&s.usingBundle||(e.iceGatherer.getLocalCandidates().forEach(function(e){e.component=1,n+="a="+G.writeCandidate(e)+"\r\n"}),"completed"===e.iceGatherer.state&&(n+="a=end-of-candidates\r\n"))});var i=new I.RTCSessionDescription({type:"offer",sdp:n});return Promise.resolve(i)},n.prototype.createAnswer=function(){var i=this;if(i._isClosed)return Promise.reject(m("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==i.signalingState&&"have-local-pranswer"!==i.signalingState)return Promise.reject(m("InvalidStateError","Can not call createAnswer in signalingState "+i.signalingState));var a=G.writeSessionBoilerplate(i._sdpSessionId,i._sdpSessionVersion++);i.usingBundle&&(a+="a=group:BUNDLE "+i.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),a+="a=ice-options:trickle\r\n";var o=G.getMediaSections(i._remoteDescription.sdp).length;i.transceivers.forEach(function(e,t){if(!(o<t+1)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?a+="m=application 0 DTLS/SCTP 5000\r\n":a+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?a+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(a+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void (a+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var r;e.stream&&("audio"===e.kind?r=e.stream.getAudioTracks()[0]:"video"===e.kind&&(r=e.stream.getVideoTracks()[0]),r&&15019<=j&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var n=A(e.localCapabilities,e.remoteCapabilities);!n.codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,a+=c(e,n,"answer",e.stream,i._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(a+="a=rtcp-rsize\r\n")}});var e=new I.RTCSessionDescription({type:"answer",sdp:a});return Promise.resolve(e)},n.prototype.addIceCandidate=function(c){var d,p=this;return c&&void 0===c.sdpMLineIndex&&!c.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(e,t){if(!p._remoteDescription)return t(m("InvalidStateError","Can not add ICE candidate without a remote description"));if(c&&""!==c.candidate){var r=c.sdpMLineIndex;if(c.sdpMid)for(var n=0;n<p.transceivers.length;n++)if(p.transceivers[n].mid===c.sdpMid){r=n;break}var i=p.transceivers[r];if(!i)return t(m("OperationError","Can not add ICE candidate"));if(i.rejected)return e();var a=0<Object.keys(c.candidate).length?G.parseCandidate(c.candidate):{};if("tcp"===a.protocol&&(0===a.port||9===a.port))return e();if(a.component&&1!==a.component)return e();if((0===r||0<r&&i.iceTransport!==p.transceivers[0].iceTransport)&&!N(i.iceTransport,a))return t(m("OperationError","Can not add ICE candidate"));var o=c.candidate.trim();0===o.indexOf("a=")&&(o=o.substr(2)),(d=G.getMediaSections(p._remoteDescription.sdp))[r]+="a="+(a.type?o:"end-of-candidates")+"\r\n",p._remoteDescription.sdp=G.getDescription(p._remoteDescription.sdp)+d.join("")}else for(var s=0;s<p.transceivers.length&&(p.transceivers[s].rejected||(p.transceivers[s].iceTransport.addRemoteCandidate({}),(d=G.getMediaSections(p._remoteDescription.sdp))[s]+="a=end-of-candidates\r\n",p._remoteDescription.sdp=G.getDescription(p._remoteDescription.sdp)+d.join(""),!p.usingBundle));s++);e()})},n.prototype.getStats=function(t){if(t&&t instanceof I.MediaStreamTrack){var r=null;if(this.transceivers.forEach(function(e){e.rtpSender&&e.rtpSender.track===t?r=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(r=e.rtpReceiver)}),!r)throw m("InvalidAccessError","Invalid selector.");return r.getStats()}var n=[];return this.transceivers.forEach(function(t){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(e){t[e]&&n.push(t[e].getStats())})}),Promise.all(n).then(function(e){var t=new Map();return e.forEach(function(e){e.forEach(function(e){t.set(e.id,e)})}),t})};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(e){var t=I[e];if(t&&t.prototype&&t.prototype.getStats){var r=t.prototype.getStats;t.prototype.getStats=function(){return r.apply(this).then(function(t){var r=new Map();return Object.keys(t).forEach(function(e){t[e].type=function(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}(t[e]),r.set(e,t[e])}),r})}}});var e=["createOffer","createAnswer"];return e.forEach(function(e){var r=n.prototype[e];n.prototype[e]=function(){var t=arguments;return"function"==typeof t[0]||"function"==typeof t[1]?r.apply(this,[arguments[2]]).then(function(e){"function"==typeof t[0]&&t[0].apply(null,[e])},function(e){"function"==typeof t[1]&&t[1].apply(null,[e])}):r.apply(this,arguments)}}),(e=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(e){var r=n.prototype[e];n.prototype[e]=function(){var t=arguments;return"function"==typeof t[1]||"function"==typeof t[2]?r.apply(this,arguments).then(function(){"function"==typeof t[1]&&t[1].apply(null)},function(e){"function"==typeof t[2]&&t[2].apply(null,[e])}):r.apply(this,arguments)}}),["getStats"].forEach(function(e){var t=n.prototype[e];n.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)}):t.apply(this,arguments)}}),n}},{sdp:17}],17:[function(e,t,r){"use strict";var p={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};p.localCName=p.generateIdentifier(),p.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},p.splitSections=function(e){return e.split("\nm=").map(function(e,t){return(0<t?"m="+e:e).trim()+"\r\n"})},p.getDescription=function(e){var t=p.splitSections(e);return t&&t[0]},p.getMediaSections=function(e){var t=p.splitSections(e);return t.shift(),t},p.matchPrefix=function(e,t){return p.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},p.parseCandidate=function(e){for(var t,r={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},n=8;n<t.length;n+=2)switch(t[n]){case"raddr":r.relatedAddress=t[n+1];break;case"rport":r.relatedPort=parseInt(t[n+1],10);break;case"tcptype":r.tcpType=t[n+1];break;case"ufrag":r.ufrag=t[n+1],r.usernameFragment=t[n+1];break;default:r[t[n]]=t[n+1]}return r},p.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},p.parseIceOptions=function(e){return e.substr(14).split(" ")},p.parseRtpMap=function(e){var t=e.substr(9).split(" "),r={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=parseInt(t[1],10),r.channels=3===t.length?parseInt(t[2],10):1,r.numChannels=r.channels,r},p.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"},p.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:0<t[0].indexOf("/")?t[0].split("/")[1]:"sendrecv",uri:t[1]}},p.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},p.parseFmtp=function(e){for(var t,r={},n=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<n.length;i++)r[(t=n[i].trim().split("="))[0].trim()]=t[1];return r},p.writeFmtp=function(t){var e="",r=t.payloadType;if(void 0!==t.preferredPayloadType&&(r=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){var n=[];Object.keys(t.parameters).forEach(function(e){t.parameters[e]?n.push(e+"="+t.parameters[e]):n.push(e)}),e+="a=fmtp:"+r+" "+n.join(";")+"\r\n"}return e},p.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},p.writeRtcpFb=function(e){var t="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},p.parseSsrcMedia=function(e){var t=e.indexOf(" "),r={ssrc:parseInt(e.substr(7,t-7),10)},n=e.indexOf(":",t);return-1<n?(r.attribute=e.substr(t+1,n-t-1),r.value=e.substr(n+1)):r.attribute=e.substr(t+1),r},p.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map(function(e){return parseInt(e,10)})}},p.getMid=function(e){var t=p.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},p.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},p.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:p.matchPrefix(e+t,"a=fingerprint:").map(p.parseFingerprint)}},p.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),r},p.getIceParameters=function(e,t){var r=p.splitLines(e);return{usernameFragment:(r=r.concat(p.splitLines(t))).filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:r.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)}},p.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},p.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=p.splitLines(e)[0].split(" "),n=3;n<r.length;n++){var i=r[n],a=p.matchPrefix(e,"a=rtpmap:"+i+" ")[0];if(a){var o=p.parseRtpMap(a),s=p.matchPrefix(e,"a=fmtp:"+i+" ");switch(o.parameters=s.length?p.parseFmtp(s[0]):{},o.rtcpFeedback=p.matchPrefix(e,"a=rtcp-fb:"+i+" ").map(p.parseRtcpFb),t.codecs.push(o),o.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(o.name.toUpperCase())}}}return p.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(p.parseExtmap(e))}),t},p.writeRtpDescription=function(e,t){var r="";r+="m="+e+" ",r+=0<t.codecs.length?"9":"0",r+=" UDP/TLS/RTP/SAVPF ",r+=t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){r+=p.writeRtpMap(e),r+=p.writeFmtp(e),r+=p.writeRtcpFb(e)});var n=0;return t.codecs.forEach(function(e){e.maxptime>n&&(n=e.maxptime)}),0<n&&(r+="a=maxptime:"+n+"\r\n"),r+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach(function(e){r+=p.writeExtmap(e)}),r},p.parseRtpEncodingParameters=function(e){var r,n=[],t=p.parseRtpParameters(e),i=-1!==t.fecMechanisms.indexOf("RED"),a=-1!==t.fecMechanisms.indexOf("ULPFEC"),o=p.matchPrefix(e,"a=ssrc:").map(function(e){return p.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),s=0<o.length&&o[0].ssrc,c=p.matchPrefix(e,"a=ssrc-group:FID").map(function(e){return e.substr(17).split(" ").map(function(e){return parseInt(e,10)})});0<c.length&&1<c[0].length&&c[0][0]===s&&(r=c[0][1]),t.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10)};s&&r&&(t.rtx={ssrc:r}),n.push(t),i&&((t=JSON.parse(JSON.stringify(t))).fec={ssrc:s,mechanism:a?"red+ulpfec":"red"},n.push(t))}}),0===n.length&&s&&n.push({ssrc:s});var d=p.matchPrefix(e,"b=");return d.length&&(d=0===d[0].indexOf("b=TIAS:")?parseInt(d[0].substr(7),10):0===d[0].indexOf("b=AS:")?1e3*parseInt(d[0].substr(5),10)*.95-16e3:void 0,n.forEach(function(e){e.maxBitrate=d})),n},p.parseRtcpParameters=function(e){var t={},r=p.matchPrefix(e,"a=ssrc:").map(function(e){return p.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];r&&(t.cname=r.value,t.ssrc=r.ssrc);var n=p.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=0<n.length,t.compound=0===n.length;var i=p.matchPrefix(e,"a=rtcp-mux");return t.mux=0<i.length,t},p.parseMsid=function(e){var t,r=p.matchPrefix(e,"a=msid:");if(1===r.length)return{stream:(t=r[0].substr(7).split(" "))[0],track:t[1]};var n=p.matchPrefix(e,"a=ssrc:").map(function(e){return p.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});return 0<n.length?{stream:(t=n[0].value.split(" "))[0],track:t[1]}:void 0},p.generateSessionId=function(){return Math.random().toString().substr(2,21)},p.writeSessionBoilerplate=function(e,t,r){var n=void 0!==t?t:2;return"v=0\r\no="+(r||"thisisadapterortc")+" "+(e||p.generateSessionId())+" "+n+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},p.writeMediaSection=function(e,t,r,n){var i=p.writeRtpDescription(e.kind,t);if(i+=p.writeIceParameters(e.iceGatherer.getLocalParameters()),i+=p.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":"active"),i+="a=mid:"+e.mid+"\r\n",e.direction?i+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?i+="a=sendrecv\r\n":e.rtpSender?i+="a=sendonly\r\n":e.rtpReceiver?i+="a=recvonly\r\n":i+="a=inactive\r\n",e.rtpSender){var a="msid:"+n.id+" "+e.rtpSender.track.id+"\r\n";i+="a="+a,i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,i+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+p.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+p.localCName+"\r\n"),i},p.getDirection=function(e,t){for(var r=p.splitLines(e),n=0;n<r.length;n++)switch(r[n]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[n].substr(2)}return t?p.getDirection(t):"sendrecv"},p.getKind=function(e){return p.splitLines(e)[0].split(" ")[0].substr(2)},p.isRejected=function(e){return"0"===e.split(" ",2)[1]},p.parseMLine=function(e){var t=p.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},p.parseOLine=function(e){var t=p.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},p.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=p.splitLines(e),r=0;r<t.length;r++)if(t[r].length<2||"="!==t[r].charAt(1))return!1;return!0},"object"==typeof t&&(t.exports=p)},{}]},{},[1])(1)})}(void 0),!function(t,i){if("object"==typeof exports&&"object"==typeof module)module.exports=i();else if("function"==typeof define&&define.i)define([],i);else{var n=i();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}(this,function(){return f=[function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(27),s=n(3),e=n(42),h=n(124),o=(u.getId=function(){return"["+a.time()+"] ["+a.h().id+"]"},u);function u(){}var a=(f.startup=function(t){this.startTime=new Date(),t.apply(this.o),this.u=this.o.resolve(e.v.l),this.logger_=this.o.resolve(e.v.p),this.g=this.u.T(),this.O=!1,this.u.init()},f.m=function(t,i,n){this._<1&&(this.startup(i),this.R(t,n),this.A(t)),this._+=1},f.I=function(){this.network=this.o.resolve(e.v.NETWORK),this.network.init()},f.net=function(){return this.network},f.system=function(){return this.o},f.logger=function(){return this.logger_},f.N=function(){return this.u},f.C=function(t){return this.k.get(t)},f.R=function(t,i){var n=new h.D(t);return n.apply(i),this.k.set(t,n),n},f.A=function(t){this.j=this.C(t)},f.resolve=function(t){return null!=this.j?this.j.context.resolve(t):(!1,null)},f.h=function(){return this.j},f.time=function(){if(this.u)return this.u.time();throw new Error("Framework.time called on purged Framework")},f.setTimeout=function(t,i,n){if(void 0===n&&(n=!1),!this.u||this.O)throw new Error("Framework.setTimeout called on purging / purged Framework");return this.u.setTimeout(t,i,n)},f.clearTimeout=function(t){return this.u.clearTimeout(t)},f.setInterval=function(t,i){if(!this.u||this.O)throw new Error("Framework.setInterval called on purging / purged Framework");return this.u.setInterval(t,i)},f.clearInterval=function(t){return this.u.clearInterval(t)},f.M=function(){return this.u.M()},f.P=function(t){if(void 0===t&&(t=!1),t)return this.L(t),void (this._=0);0!==this._&&(this._<=1&&this.L(),this._-=1)},f.L=function(t){var i=this;void 0===t&&(t=!1),this.O=!0,this.u&&this.u.H(t,function(){i.O&&i.reset()})},f.reset=function(){this.o.U(),this.o=new r.F(),this.k=new s(),this.j=null,this.startTime=null,this.g=!1,this.seed=null,this.u=null,this.network=null,this.logger_=null},f.G=function(t){this.seed=t},f.random=function(){return null==this.seed&&(this.seed=new Date().getTime()),this.seed=(9301*this.seed+49297)%233280,this.seed/233280},f.B=function(){return this.startTime},f.T=function(){return this.g},f.V=o,f.v=e.v,f._=0,f.o=new r.F(),f.k=new s(),f.g=!1,f);function f(){}i.Framework=a},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(126),s=n(20),e=n(8),o=n(2),u=n(2),h=e.Y.q,f=(e.Y.K,e.Y.W),c=e.Y.$,a=(l.getInstance=function(t){return void 0===t&&(t="3.0.0"),void 0===this.instance&&(this.instance=new l(t)),this.instance},l.prototype.X=function(){r.Z.getInstance().J([16,17,88],function(){try{throw new Error("Upload console logs")}catch(t){atatus.notify(t),window.console&&!1}})},l.prototype.tt=function(){try{throw new Error("test")}catch(t){var i=t.stack.match(/(\/\/.*\.js)/i);if(i&&0<i.length)return i[0]}},l.prototype.setUser=function(t){this.it&&this.isActive&&atatus.setUser(t)},l.prototype.nt=function(t){this.logger=t},l.prototype.setCustomData=function(t){this.it&&this.isActive&&atatus.setCustomData(t)},l.prototype.rt=function(t){for(var i in t)t.hasOwnProperty(i)&&(this.st[i]=t[i])},l.prototype.et=function(t){this.ht=t},l.prototype.ot=function(){this.ht=null},l.prototype.logError=function(t,i,n,r,s){var e="",h=n&&u.ut[n]?u.ut[n]:u.ft.at;if("string"==typeof i?e=i.trim():void 0!==i&&(r=i),(r instanceof Error||r&&"object"!=typeof r)&&(r={error:r.toString()}),(r=r||{}).errorCode=n||o.GENERIC_ERROR,this.logger&&(0<Object.keys(r).length?this.logger.warn(e+" "+t,r):this.logger.warn(e+" "+t)),e&&(s=s?s.concat([e]):[e]),r.forceSend=!0,this.it&&this.isActive)try{throw new Error(t)}catch(t){atatus.notify(t,r,s)}if(this.ht)try{this.ht({pluginVersion:this.version,reportingId:this.st?this.st.reportingGuid:"",p2pId:this.st?this.st.p2pId:"",message:t,severity:h,code:r.errorCode})}catch(t){this.logger.warn("Error in the onErrorCallback",t)}},l.prototype.setTags=function(t){this.it&&this.isActive&&atatus.setTags(t)},l.prototype.notify=function(t,i){this.it&&this.isActive&&((i=i||{}).forceSend=!0,atatus.notify(t,i))},l);function l(t){var o=this;if(this.isActive=!1,this.it="undefined"!=typeof atatus&&null!=atatus,this.st={},this.version=t,l.instance)throw new Error("Error: Instantiation failed: Use AtatusLogger.getInstance() instead of new.");var u,i=null!=s.ErrorMonitorOptions.key?s.ErrorMonitorOptions.key:h,n=1==s.ErrorMonitorOptions.enabledRUM,r=1==s.ErrorMonitorOptions.enableKeyCombination,a=1==s.ErrorMonitorOptions.enabledErrorFilter;a&&(u=this.tt()),this.version=t,this.it&&(null==s.ErrorMonitorOptions.enabled&&f||null!=s.ErrorMonitorOptions.enabled&&1==s.ErrorMonitorOptions.enabled)&&(atatus.config(i,{enableSourcemap:!0,disableRUM:!n,console:!1,version:t,beforeErrorSend:function(t){var i=!1;for(var n in t.customData=t.customData||{},void 0!==t.customData.forceSend&&(i=t.customData.forceSend,delete t.customData.forceSend,0===Object.keys(t.customData).length&&(t.customData=null)),o.st)o.st.hasOwnProperty(n)&&(t.customData[n]=o.st[n]);if(!a||i)return!0;if(!u)return!1;try{var r=!1;if(t.backTraces){for(var s=0,e=t.backTraces;s<e.length;s++){var h=e[s];if(-1<h.f.indexOf(u)&&h.ln>c){r=!0;break}}r&&(t.name=t.name.replace(/%s \[[0-9]{2}:[0-9]{2}:[0-9]{2}:[0-9]+] /,""),0<=t.name.indexOf("Status Code Error:")&&(t.tags=["Plugin Error Code",t.name.split(":")[1].trim()]))}return r}catch(t){return!1}}}).install(),r&&this.X(),this.isActive=!0,window.console&&!1,a&&!u&&this.logError("Could not extract error filter"))}i.ErrorMonitor=a},function(t,i,n){"use strict";var r,s,e,h,o,u,a,f,c,l,v,d,E,w,p,g,b,y,T,O,m,_,R,S,A,I,N,C,k,D,j,M,P,L,H,U,F,G,x,B,V,q,Q,Y,K,W,$,X,z,J,Z,tt,it,nt,rt,st,et,ht;Object.defineProperty(i,"s",{value:!0}),(h=e=i.ft||(i.ft={}))[h.at=0]="NORMAL",h[h.ct=1]="HIGH",h[h.CRITICAL=2]="CRITICAL",(u=o=i.lt||(i.lt={}))[u.vt=268435456]="BASE_CODE",u[u.dt=268435457]="FIRE_SERVER_CONNECTED_WITH_SWARM",u[u.Et=268435458]="FIRE_SERVER_CONNECTED_WITHOUT_SWARM",u[u.wt=268435459]="CONNECTION_NOT_ESTABLISHED",u[u.pt=268435460]="SEND_MESSAGE_TO_NON_EXISTING_CHANNEL",u[u.gt=268435461]="RECEIVED_MESSAGE_FROM_NON_EXISTING_CONNECTION",(a=i.bt||(i.bt={}))[a.vt=536870912]="BASE_CODE",a[a.yt=536870913]="CREATE_OFFER",a[a.Tt=536870914]="CREATE_ANSWER",a[a.Ot=536870915]="SIGNALING_STATE_CLOSED",a[a._t=536870916]="SET_LOCAL_DESCRIPTION_FAILED",a[a.Rt=536870917]="NEGOTIATION_FAILURE",a[a.St=536870918]="SETUP_CHANNEL_ERROR",a[a.At=536870919]="ICE_CONNECTION_FAILED",a[a.It=536870920]="SET_REMOTE_DESCRIPTION",a[a.Nt=536870921]="UPDATE_ICE_CANDIDATES",a[a.Ct=536870922]="ANSWER_RECEIVED",a[a.kt=536870923]="OFFER_RECEIVED",a[a.Dt=536870924]="SEND_CANDIDATES",a[a.jt=536870925]="CLOSE_CONNECTION",a[a.Mt=536870926]="SEND_DATA",(f=i.Pt||(i.Pt={}))[f.vt=805306368]="BASE_CODE",f[f.Lt=805306369]="SEND_MSG_WITHOUT_CHANNEL",f[f.Ht=805306370]="MSG_TRIGGER_ERROR",f[f.Ut=805306371]="CONNECTION_TIMEOUT",(c=i.Ft||(i.Ft={}))[c.vt=1073741824]="BASE_CODE",c[c.jt=1073741825]="CLOSE_CONNECTION",c[c.Gt=1073741826]="P2P_DISPATCHER_ERROR",(l=i.xt||(i.xt={}))[l.vt=1342177280]="BASE_CODE",l[l.Bt=1342177281]="CONSTRUCT_MESSAGE",l[l.Vt=1342177282]="DROPPED_MESSAGE",l[l.qt=1342177283]="SEND_MESSAGE",l[l.Qt=1342177284]="RECEIVE_MESSAGE",(v=i.Yt||(i.Yt={}))[v.vt=1610612736]="BASE_CODE",v[v.Kt=1610612737]="NEW_DISPATCHER",(d=i.Wt||(i.Wt={}))[d.vt=1879048192]="BASE_CODE",d[d.$t=1879048193]="INIT_CACHE",d[d.Xt=1879048194]="PUT_OPERATION",d[d.zt=1879048195]="GET_OPERATION",d[d.Jt=1879048196]="CONTAINS_OPERATION",d[d.Zt=1879048197]="GET_KEYS_OPERATION",d[d.ti=1879048198]="GET_ELEMENTS_OPERATION",(E=i.ii||(i.ii={}))[E.vt=2147483648]="BASE_CODE",E[E.Xt=2147483649]="PUT_OPERATION",E[E.zt=2147483650]="GET_OPERATION",E[E.Jt=2147483651]="CONTAINS_OPERATION",E[E.Zt=2147483652]="GET_KEYS_OPERATION",E[E.ti=2147483653]="GET_ELEMENTS_OPERATION",E[E.ni=2147483654]="PURGE_CACHE_OPERATION",(w=i.ri||(i.ri={}))[w.vt=2415919104]="BASE_CODE",(p=i.si||(i.si={}))[p.vt=2684354560]="BASE_CODE",p[p.ei=2684354561]="DISCOVERED_PEERS",p[p.hi=2684354562]="LEADER_ELECTION",p[p.oi=2684354563]="GC_MEMBERS",p[p.ui=2684354564]="ADD_LAN_MEMBER",p[p.ai=2684354565]="ADD_RANDOM_MEMBER",p[p.fi=2684354566]="SAMPLE_MEMBERSHIP",(g=i.ci||(i.ci={}))[g.vt=2952790016]="BASE_CODE",g[g.li=2952790017]="SEND_ALL_HAVES",g[g.vi=2952790018]="SEND_HAVE",g[g.di=2952790019]="UNKNOWN_HAVE",g[g.Ei=2952790020]="UNKNOWN_HAVES",g[g.wi=2952790021]="RECEIVED_HAVE",g[g.pi=2952790022]="RECEIVED_HAVES",g[g.gi=2952790023]="NO_OUT_PARTNER",g[g.bi=2952790024]="CREATE_RANDOM_BUFFER",g[g.yi=2952790025]="REQUEST_PING",g[g.Ti=2952790026]="RECEIVED_PING",g[g.Oi=2952790027]="UNKNOWN_PING",g[g.mi=2952790028]="SEND_PONG",g[g._i=2952790029]="UNKOWN_PONG",g[g.Ri=2952790030]="WRONG_PONG_SIZE",g[g.Si=2952790031]="WRONG_TIMESTAMP",g[g.Ai=2952790032]="RECEIVED_PONG",g[g.Ii=2952790033]="COLLECT_PARTNER_SNAPSHOTS",(y=b=i.Ni||(i.Ni={}))[y.vt=3221225472]="BASE_CODE",y[y.Ci=3221225473]="START_PARTNERSHIP",y[y.ki=3221225474]="NEW_LAN_MEMBER",y[y.Di=3221225475]="IN_PARTNER_CHOICE",y[y.ji=3221225476]="IN_PARTNER_ADD_PROCESS",y[y.Mi=3221225477]="IN_PARTNER_CONNECT",y[y.Pi=3221225478]="IN_PARTNERSHIP_REQUEST",y[y.Li=3221225479]="OUT_PARNTERSHIP_REQUEST_PROCESS",y[y.Hi=3221225480]="CONSTRUCT_DISCOVER_PEER_INFO",y[y.Ui=3221225481]="SEND_PARTN_RESP",y[y.Fi=3221225482]="NEW_IN_PARTNER_TO_LIST",y[y.Gi=3221225483]="REMOVE_DISCONNECTED_PEER",y[y.xi=3221225484]="REMOVE_IN_PARTNER",y[y.Bi=3221225485]="CLOSE_RECEIVED",y[y.Vi=3221225486]="SEND_PART_REQUEST",y[y.qi=3221225487]="PART_REQUEST_EXPIRED",y[y.Qi=3221225488]="UNKNOWN_PARTNERSHIP_REQUEST_EXPIRED",y[y.Yi=3221225489]="UNKNOWN_OUT_PART_RESP",y[y.Ki=3221225490]="CLOSE_PARTNERSHIP",y[y.Wi=3221225491]="ANNOUNCE_QUALITY_LEVEL",y[y.$i=3221225492]="CONSTRUCT_ANNOUNCE_QUALITY_LEVEL_MSG",y[y.Xi=3221225493]="RECEIVE_QUALITY_LEVEL_INFO",y[y.zi=3221225494]="PEER_INFO_RECEIVED",y[y.Ji=3221225495]="PEER_INFO_ANNOUNCED",y[y.Zi=3221225496]="COLLECT_ALL_PARTNERS",(T=i.tn||(i.tn={}))[T.vt=3489660928]="BASE_CODE",T[T["in"]=3489660929]="UPDATE_IN_PARTNERS",(O=i.nn||(i.nn={}))[O.vt=3758096384]="BASE_CODE",O[O.rn=3758096385]="SELECT_PARTNERS_TO_REMOVE",O[O.sn=3758096386]="SELECT_PARTNERS_TO_ADD",O[O.en=3758096387]="SELECT_UPDATE_OUT",(m=i.hn||(i.hn={}))[m.vt=4026531840]="BASE_CODE",m[m.rn=4026531841]="SELECT_PARTNERS_TO_REMOVE",m[m.sn=4026531842]="SELECT_PARTNERS_TO_ADD",m[m.en=4026531843]="SELECT_UPDATE_OUT",(_=i.un||(i.un={}))[_.vt=4294967296]="BASE_CODE",_[_["in"]=4294967297]="UPDATE_IN_PARTNERS",_[_.rn=4294967298]="SELECT_PARTNERS_TO_REMOVE",_[_.sn=4294967299]="SELECT_PARTNERS_TO_ADD",_[_.en=4294967300]="SELECT_UPDATE_OUT",_[_.an=4294967301]="GROUP_PARTNERS",_[_.fn=4294967302]="IDENTIFY_MEMBER_AS_LEADER_OR_SAME_SITE",_[_.cn=4294967303]="AHEAD_BUT_BEHIND_DELTA",_[_.vn=4294967304]="BEHIND_OR_NOT_RETRIEVING_QUALITY_LEVEL",_[_.dn=4294967305]="GET_DELTA_FOR_QUALITY_LEVEL",(R=i.En||(i.En={}))[R.vt=4563402752]="BASE_CODE",R[R.wn=4563402753]="UPDATE_OUT_PARTNERS",(S=i.pn||(i.pn={}))[S.vt=4831838208]="BASE_CODE",S[S.gn=4831838209]="ADD_FRAGMENT_TO_MAP",S[S.bn=4831838210]="WRAP_CHUNK",S[S.yn=4831838211]="GENERATE_HASHMAPS",(A=i.Tn||(i.Tn={}))[A.vt=5100273664]="BASE_CODE",A[A.On=5100273665]="INIT_AES_MANAGER",A[A.mn=5100273666]="INIT_KEY",A[A._n=5100273667]="INIT_IV",A[A.Rn=5100273668]="DECRYPT_BUFFER",A[A.Sn=5100273669]="DOWNLOAD_KEY_ONLOAD",A[A.An=5100273670]="DOWNLOAD_KEY",(N=I=i.In||(i.In={}))[N.vt=5368709120]="BASE_CODE",N[N.Nn=5368709121]="GET_ENTITY_TYPE",N[N.Cn=5368709122]="GET_ENTITY_CHARACTERISTICS",N[N.kn=5368709123]="GET_NEXT_ENTITY",N[N.Dn=5368709124]="IS_CURRENT_CONTEXT",N[N.jn=5368709125]="PARSED_METADATA",N[N.Mn=5368709126]="PREFETCH_METADATA_RECEIVED",N[N.Pn=5368709127]="FRAGMENT_RECEIVED",N[N.Ln=5368709128]="EVALUATE_PROTECTION",N[N.Hn=5368709129]="GET_DISTANCE_DURATION",(k=C=i.Un||(i.Un={}))[k.vt=5637144576]="BASE_CODE",k[k.Fn=5637144577]="PARSE_METADATA",k[k.Gn=5637144578]="EXTRACT_SEGMENT_MAPS",k[k.xn=5637144579]="INIT_PROTECTION",k[k.Bn=5637144580]="GET_SEGMENT_INFO",k[k.Vn=5637144581]="GET_SEGMENT_DISTANCE",k[k.qn=5637144582]="EXTRACT_DURATION",k[k.Qn=5637144583]="EXTRACT_DURATION_OR_DECRYPT",k[k.Yn=5637144584]="EXTRACT_DURATION_CANNOT_DECRYPT",k[k.Kn=5637144585]="EXTRACT_DURATION_NON_ENCRYPTED",k[k.Wn=5637144586]="GENERATE_MISSING_SEGMENTS",k[k.$n=5637144587]="REGENERATE_MANIFEST",k[k.Xn=5637144588]="TRIM_MANIFEST",k[k.zn=5637144589]="PARSE_BITRATES_TO_FILTER",k[k.Jn=5637144590]="FILTER_BITRATES",k[k.Zn=5637144591]="GET_DISTANCE_DURATION_BETWEEN_SEGMENTS",k[k.tr=5637144592]="GET_SEGMENT",(j=D=i.ir||(i.ir={}))[j.vt=5905580032]="BASE_CODE",j[j.Dn=5905580033]="IS_CURRENT_CONTEXT",j[j.Nn=5905580034]="GET_ENTITY_TYPE",j[j.Cn=5905580035]="GET_ENTITY_CHARACTERISTICS",j[j.nr=5905580036]="METADATA_RECEIVED",j[j.rr=5905580037]="SCHEDULE_METADATA_PREFETCH",j[j.kn=5905580038]="GET_NEXT_ENTITY",j[j.Hn=5905580039]="GET_DISTANCE_DURATION",(P=M=i.sr||(i.sr={}))[P.vt=6174015488]="BASE_CODE",P[P.er=6174015489]="PLAYLIST_MISMATCH",P[P.hr=6174015490]="FLOAT_BITRATE",P[P.Fn=6174015491]="PARSE_METADATA",P[P.Bn=6174015492]="GET_SEGMENT_INFO",P[P.ur=6174015493]="UPDATE_PLAYLIST",P[P.ar=6174015494]="TRIM_PLAYLIST",(L=i.cr||(i.cr={}))[L.vt=6442450944]="BASE_CODE",L[L.lr=6442450945]="GET_P2P_TIMEOUT",L[L.vr=6442450946]="DELIVER_DELAY",(H=i.dr||(i.dr={}))[H.vt=6710886400]="BASE_CODE",H[H.Er=6710886401]="IS_PLAYER_BUFFERING_BASE",H[H.wr=6710886402]="CONFIGURE_REQUEST_DIRECTIVE",H[H.pr=6710886403]="ATTEMPT_TO_UPGRADE_PREFETCH",H[H.kn=6710886404]="GET_NEXT_ENTITY",(U=i.gr||(i.gr={}))[U.vt=6979321856]="BASE_CODE",U[U.br=6979321857]="PREPARE_REQUEST",U[U.yr=6979321858]="GET_CONNECTIVITY_INFO",U[U.Tr=6979321859]="COLLECT_TRACKER_REQUEST_INFO",U[U.Or=6979321860]="PREPARE_QUERY",U[U.mr=6979321861]="PREPARE_QUALITY_LEVEL_QUERY",U[U.Rr=6979321862]="PREPARE_TRACKER_INFO",U[U.Sr=6979321863]="SEND_REQUEST",U[U.Ar=6979321864]="HANDLE_RESPONSE",(F=i.Ir||(i.Ir={}))[F.vt=7247757312]="BASE_CODE",F[F.Nr=7247757313]="NEW_TRACKER_CLIENT",F[F.Cr=7247757314]="SERIALIZE_REQUEST",F[F.kr=7247757315]="DESERIALIZE_RESPONSE",F[F.Dr=7247757316]="SERVICE_CONNECTION_DOWN",F[F.Sr=7247757317]="SEND_REQUEST",F[F.jr=7247757318]="TRACKER_MANAGER_INIT",(G=i.Mr||(i.Mr={}))[G.vt=7516192768]="BASE_CODE",G[G.Pr=7516192769]="SORT_PARTNERS",(x=i.Lr||(i.Lr={}))[x.vt=7784628224]="BASE_CODE",x[x.Hr=7784628225]="CHOOSE_PARTNER",(B=i.Ur||(i.Ur={}))[B.vt=8053063680]="BASE_CODE",B[B.Fr=8053063681]="CONSTRUCT_FRAGMENT_REQUEST_MESSAGE",B[B.Gr=8053063682]="SEND_FRAGMENT_REQUEST",B[B.xr=8053063683]="RECEIVE_CHUNK",B[B.Br=8053063684]="SEND_ACK",B[B.Vr=8053063685]="CLEAN_UP_NOT_PENDING",B[B.qr=8053063686]="STOP_TRANSFER",B[B.Qr=8053063687]="RECEIVE_EXPIRED_CHUNK",(V=i.Yr||(i.Yr={}))[V.vt=8321499136]="BASE_CODE",V[V.Kr=8321499137]="CONSTRUCT_CHUNK_RESPONSE",V[V.Wr=8321499138]="START_SENDING_CHUNK",V[V.$r=8321499139]="SEND_CHUNK",V[V.Xr=8321499140]="UNKNOWN_ACK",(q=i.zr||(i.zr={}))[q.vt=8589934592]="BASE_CODE",q[q.Jr=8589934593]="NO_PARTNER_FOUND",q[q.Zr=8589934594]="FILTER_IN_PARTNERS",q[q.ns=8589934595]="SET_REQUEST_TIMEOUT",q[q.rs=8589934596]="REMOVE_REQUEST",q[q.ss=8589934597]="CANCEL_ON_NON_EXISTING_SESSION",q[q.es=8589934598]="DO_NOT_HAVE",q[q.hs=8589934599]="REQUESTED_TO_NON_PARTNER",(Q=i.us||(i.us={}))[Q.vt=8858370048]="BASE_CODE",Q[Q.fs=8858370049]="RESPOND_TO_PEER",Q[Q.cs=8858370050]="REQUEST_SATISFIED",Q[Q.ls=8858370051]="REQUEST_PARTIALLY_SATISFIED",Q[Q.vs=8858370052]="REQUEST_NOT_SATISFIED",Q[Q.ds=8858370053]="SEND_DO_NOT_HAVE",Q[Q.Es=8858370054]="SEND_NO_PARTNERS",(Y=i.ws||(i.ws={}))[Y.vt=9126805504]="BASE_CODE",Y[Y.ps=9126805505]="VIOLATE_SPOOFING_HANDLER",Y[Y.gs=9126805506]="VIOLATE_SPOOFING_RULES",Y[Y.bs=9126805507]="ADD_OR_UPDATE_SPOOFING_MAPS",Y[Y.ys=9126805508]="PERIODIC_CHECK_IP_SPOOFING",(K=i.Ts||(i.Ts={}))[K.vt=9395240960]="BASE_CODE",K[K.Os=9395240961]="REQUEST_COMPLETED",K[K.ms=9395240962]="REQUEST_NOT_EXISTING_COMPLETED",K[K._s=9395240963]="REQUEST_PARTIALLY_FAILED",K[K.Rs=9395240964]="REQUEST_NOT_EXISTING_PARTIALLY_FAILED",K[K.Ss=9395240965]="REQUEST_FAILED",K[K.As=9395240966]="REQUEST_NOT_EXISTING_FAILED",(W=i.Is||(i.Is={}))[W.vt=9663676416]="BASE_CODE",W[W.Ns=9663676417]="UPDATE_WANTED_SESSIONS",W[W.Cs=9663676418]="CONFIGURE_PREFETCHING",W[W.ks=9663676419]="START_PREFETCHING",W[W.Ds=9663676420]="FRAGMENT_RETRIEVED_SESSION_NOT_EXISTING",W[W.js=9663676421]="ATTEMPT_PREFETCH_BEFORE_PLAYER_REQUEST",W[W.Ms=9663676422]="FORWARD_IF_NECESSARY",W[W.Ps=9663676423]="IS_ALLOWED_TO_PREFETCH",W[W.Ls=9663676424]="PREFETCH_PROCESS",W[W.Hs=9663676425]="CHECK_PLAYER_DISTANCE",W[W.Us=9663676426]="OFFLOAD_LEADER",W[W.Fs=9663676427]="UPGRADE_PREFETCH",($=i.Gs||(i.Gs={}))[$.vt=9932111872]="BASE_CODE",$[$.xs=9932111873]="REQUEST_TIMEOUT",(X=i.Bs||(i.Bs={}))[X.vt=10200547328]="BASE_CODE",X[X.Vs=10200547329]="PLAYER_REQUEST_ERROR",X[X.qs=10200547330]="PLAYER_ABORT_ERROR",(z=i.Qs||(i.Qs={}))[z.vt=10468982784]="BASE_CODE",z[z.Ys=10468982785]="ADD_HAVE",z[z.Ks=10468982786]="REMOVE_PEER",(Z=J=i.Ws||(i.Ws={}))[Z.vt=10737418240]="BASE_CODE",Z[Z.$s=10737418241]="CONSTRUCT_SWARM",Z[Z.Xs=10737418242]="INIT_SWARM",Z[Z.zs=10737418243]="SWITCH_STATE",Z[Z.xs=10737418244]="REQUEST_TIMEOUT",(tt=i.Js||(i.Js={}))[tt.vt=11005853696]="BASE_CODE",tt[tt.Zs=11005853697]="SERIALIZE_MESSAGE",tt[tt.te=11005853698]="EXTRACT_MESSAGE",(nt=it=i.ie||(i.ie={}))[nt.vt=11274289152]="BASE_CODE",nt[nt.ne=11274289153]="NO_MATCHING_SESSION",nt[nt.re=11274289154]="UNABLE_RESOLVE_TICKET",nt[nt.se=11274289155]="UNABLE_INIT_TECHS",nt[nt.ee=11274289156]="NO_TOKEN_FOUND",nt[nt.he=11274289157]="NO_VALID_TICKET",nt[nt.oe=11274289158]="ON_ACTIVE_SESSION_CB_ERROR",nt[nt.ue=11274289159]="NO_VISIBILITY_LISTENER",nt[nt.ae=11274289160]="STATUS_CODE",nt[nt.fe=11274289161]="ON_SESSION_STATE_CHANGE_CB_ERROR",nt[nt.ce=11274289162]="NO_REQUIRED_PARAMETERS",(rt=i.le||(i.le={}))[rt.vt=11542724608]="BASE_CODE",rt[rt.ve=11542724609]="CALCULATE_BATCH_LOCALITY",(et=st=i.de||(i.de={}))[et.vt=11811160064]="BASE_CODE",et[et.Ee=11811160065]="BITRATE_TOO_HIGH",et[et.we=11811160066]="NUM_BITRATES_NONE",et[et.pe=11811160067]="NUM_BITRATES_OK",et[et.ge=11811160068]="NUM_BITRATES_WARNING",et[et.be=11811160069]="NUM_BITRATES_ERROR",et[et.ye=11811160070]="NUM_BITRATES_ATATUS_ERROR_NONE",et[et.Te=11811160071]="NUM_BITRATES_ATATUS_ERROR_HIGH",(ht=i.Oe||(i.Oe={}))[ht.vt=12079595520]="BASE_CODE",ht[ht.Zs=12079595521]="SERIALIZE_MESSAGE",ht[ht.Sr=12079595522]="SEND_REQUEST",ht[ht.Dr=12079595523]="SERVICE_CONNECTION_DOWN",ht[ht.yr=12079595524]="GET_CONNECTIVITY_INFO",i.GENERIC_ERROR=1,i.me=((r={})[st.Ee]="The detected bitrate ({0}) is higher than the maximum certified bitrate ({1}). You may encounter issues watching the stream.",r[st.we]="{0} stream detected with missing video bitrate metadata. This is likely caused by an incorrect manifest served by the video platform application.",r[st.pe]="{0} stream detected {1} video bitrates: {2}",r[st.ge]="{0} stream detected with {1} video bitrates: {2}. Hive Streaming recommends four or fewer video bitrates to insure optimal networking savings.",r[st.be]="{0} stream detected with {1} video bitrates: {2}. This is likely caused by an incorrect configuration in the video encoder, video streaming origin or transcoding service.",r[st.ye]="Stream has zero available bitrates.",r[st.Te]="Stream has too many available bitrates.",r),i.ut=((s={})[o.dt]=e.ct,s[o.Et]=e.ct,s[b.Ci]=e.ct,s[I.Dn]=e.ct,s[C.$n]=e.ct,s[D.Dn]=e.ct,s[M.er]=e.ct,s[J.$s]=e.ct,s[it.ne]=e.ct,s[it.re]=e.ct,s[it.se]=e.ct,s[it.ee]=e.ct,s[it.he]=e.ct,s[it.ce]=e.CRITICAL,s)},function(t,i,n){"use strict";n(10);var s=n(73),r=n(11),e=n(59),h=n(12);function o(t,n,i,r){if(!(this instanceof o))return new o(t,n,i,r);n=n||Object.equals,i=i||Object.hash,r=r||Function._e,this.Re=n,this.Se=i,this.Ae=r,this.store=new s(void 0,function(t,i){return n(t.key,i.key)},function(t){return i(t.key)}),this.length=0,this.hiveAddEach(t)}(t.exports=o).Map=o,Object.hiveAddEach(o.prototype,r.prototype),Object.hiveAddEach(o.prototype,e.prototype),Object.hiveAddEach(o.prototype,h.prototype),Object.defineProperty(o.prototype,"size",r.Ie),o.prototype.Ne=function(t){return new this.constructor(t,this.Re,this.Se,this.Ae)},o.prototype.log=function(t,r,i,n){r=r||this.Ce,this.store.log(t,function(t,i,n){r(t.value.value,i,n)},i,n)},o.prototype.Ce=function(t,i){i(" key: "+t.key),i(" value: "+t.value)}},function(i,t,n){(function(W,$){!function(t){"use strict";"function"==typeof bootstrap?bootstrap("promise",t):i.exports=t()}(function(){"use strict";var o=!1;try{throw new Error()}catch(t){o=!!t.stack}function i(){}var s,e=T(),c=function(){var n={ke:void 0,next:null},i=n,r=!1,s=void 0,e=!1,t=!1;try{t=navigator&&("Microsoft Internet Explorer"===navigator.appName||null!=navigator.appVersion.match(/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i))}catch(t){}var h=[];function o(){for(var t,i;n.next;)t=(n=n.next).ke,n.ke=void 0,(i=n.domain)&&(n.domain=void 0,i.De()),u(t,i);for(;h.length;)u(t=h.pop());r=!1}function u(t,i){try{t()}catch(t){if(e)throw i&&i.je(),setTimeout(o,0),i&&i.De(),t;setTimeout(function(){throw t},0)}i&&i.je()}if(c=function(t){"undefined"!=typeof Framework&&Framework.T()?Framework.setTimeout(t,0):(i=i.next={ke:t,domain:e&&W.domain,next:null},r||(r=!0,s()))},"object"==typeof W&&W&&"[object process]"===W.toString()&&W.Me)e=!0,s=function(){W.Me(o)};else if("function"!=typeof $||t)if("undefined"==typeof MessageChannel||t)s=function(){setTimeout(o,0)};else{var a=new MessageChannel();a.port1.onmessage=function(){s=f,(a.port1.onmessage=o)()};var f=function(){a.port2.postMessage(0)};s=function(){setTimeout(o,0),f()}}else s="undefined"!=typeof window?$.bind(window,o):function(){$(o)};return c.Pe=function(t){h.push(t),r||(r=!0,s())},c}(),n=Function.call;function t(t){return function(){return n.apply(t,arguments)}}var h,u=t(Array.prototype.slice),a=t(Array.prototype.reduce||function(t,i){var n=0,r=this.length;if(1===arguments.length)for(;;){if(n in this){i=this[n++];break}if(++n>=r)throw new TypeError()}for(;n<r;n++)n in this&&(i=t(i,this[n],n));return i}),r=t(Array.prototype.indexOf||function(t){for(var i=0;i<this.length;i++)if(this[i]===t)return i;return-1}),f=t(Array.prototype.map||function(r,s){var e=this,h=[];return a(e,function(t,i,n){h.push(r.call(s,i,n,e))},void 0),h}),l=Object.create||function(t){function i(){}return i.prototype=t,new i()},v=Object.defineProperty||function(t,i,n){return t[i]=n.value,t},d=t(Object.prototype.hasOwnProperty),E=Object.keys||function(t){var i=[];for(var n in t)d(t,n)&&i.push(n);return i},w=t(Object.prototype.toString);h="undefined"!=typeof ReturnValue?ReturnValue:function(t){this.value=t};var p="From previous event:";function g(t,i){if(o&&i.stack&&"object"==typeof t&&null!==t&&t.stack){for(var n=[],r=i;r;r=r.source)r.stack&&(!t.Le||t.Le>r.He)&&(v(t,"__minimumStackCounter__",{value:r.He,configurable:!0}),n.unshift(r.stack));n.unshift(t.stack);var s=function(t){for(var i=t.split("\n"),n=[],r=0;r<i.length;++r){var s=i[r];!y(s)&&-1===(e=s).indexOf("(module.js:")&&-1===e.indexOf("(node.js:")&&s&&n.push(s)}var e;return n.join("\n")}(n.join("\n"+p+"\n"));v(t,"stack",{value:s,configurable:!0})}}function b(t){var i=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(i)return[i[1],Number(i[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(n)return[n[1],Number(n[2])];var r=/.*@(.+):(\d+)$/.exec(t);return r?[r[1],Number(r[2])]:void 0}function y(t){var i=b(t);if(!i)return!1;var n=i[0],r=i[1];return n===s&&e<=r&&r<=K}function T(){if(o)try{throw new Error()}catch(t){var i=t.stack.split("\n"),n=b(0<i[0].indexOf("@")?i[1]:i[2]);if(!n)return;return s=n[0],n[1]}}function O(t){return t instanceof A?t:k(t)?function(t){var i=_();return O.Me(function(){try{t.then(i.resolve,i.reject,i.notify)}catch(t){i.reject(t)}}),i.promise}(t):x(t)}(O.resolve=O).Me=c,O.Ue=!1;var m=1;function _(){var s,e=[],h=[],t=l(_.prototype),i=l(A.prototype);if(i.Fe=function(t,i,n){var r=u(arguments);e?(e.push(r),"when"===i&&n[1]&&h.push(n[1])):O.Me(function(){s.Fe.apply(s,r)})},i.valueOf=function(){if(e)return i;var t=N(s);return C(t)&&(s=t),t},i.inspect=function(){return s?s.inspect():{state:"pending"}},O.Ue&&o)try{throw new Error()}catch(t){i.stack=t.stack.substring(t.stack.indexOf("\n")+1),i.He=m++}function n(n){s=n,O.Ue&&o&&(i.source=n),a(e,function(t,i){O.Me(function(){n.Fe.apply(n,i)})},void 0),h=e=void 0}return t.promise=i,t.resolve=function(t){s||n(O(t))},t.fulfill=function(t){s||n(x(t))},t.reject=function(t){s||n(G(t))},t.notify=function(n){s||a(h,function(t,i){O.Me(function(){i(n)})},void 0)},t}function R(t){if("function"!=typeof t)throw new TypeError("resolver must be a function.");var i=_();try{t(i.resolve,i.reject,i.notify)}catch(t){i.reject(t)}return i.promise}function S(s){return R(function(t,i){for(var n=0,r=s.length;n<r;n++)O(s[n]).then(t,i)})}function A(s,e,i){void 0===e&&(e=function(t){return G(new Error("Promise does not support operation: "+t))}),void 0===i&&(i=function(){return{state:"unknown"}});var h=l(A.prototype);if(h.Fe=function(t,i,n){var r;try{r=s[i]?s[i].apply(h,n):e.call(h,i,n)}catch(t){r=G(t)}t&&t(r)},h.inspect=i){var t=i();"rejected"===t.state&&(h.exception=t.reason),h.valueOf=function(){var t=i();return"pending"===t.state||"rejected"===t.state?h:t.value}}return h}function I(t,i,n,r){return O(t).then(i,n,r)}function N(t){if(C(t)){var i=t.inspect();if("fulfilled"===i.state)return i.value}return t}function C(t){return t instanceof A}function k(t){return function(t){return t===Object(t)}(t)&&"function"==typeof t.then}"object"==typeof W&&W&&W.Ge&&W.Ge.xe&&(O.Ue=!0),(O.defer=_).prototype.Be=function(){var n=this;return function(t,i){t?n.reject(t):2<arguments.length?n.resolve(u(arguments,1)):n.resolve(i)}},O.Promise=R,(O.promise=R).race=S,R.all=q,R.reject=G,(R.resolve=O).Ve=function(t){return t},A.prototype.Ve=function(){return this},O.join=function(t,i){return O(t).join(i)},A.prototype.join=function(t){return O([this,t]).qe(function(t,i){if(t===i)return t;throw new Error("Q can't join: not the same: "+t+" "+i)})},O.race=S,A.prototype.race=function(){return this.then(O.race)},(O.Qe=A).prototype.toString=function(){return"[object Promise]"},A.prototype.then=function(i,n,r){var s=this,e=_(),h=!1;return O.Me(function(){s.Fe(function(t){h||(h=!0,e.resolve(function(t){try{return"function"==typeof i?i(t):t}catch(t){return G(t)}}(t)))},"when",[function(t){h||(h=!0,e.resolve(function(t){if("function"==typeof n){g(t,s);try{return n(t)}catch(t){return G(t)}}return G(t)}(t)))}])}),s.Fe(void 0,"when",[void 0,function(t){var i,n=!1;try{i=function(t){return"function"==typeof r?r(t):t}(t)}catch(t){if(n=!0,!O.onerror)throw t;O.onerror(t)}n||e.notify(i)}]),e.promise},O.Ye=function(t,i){return O(t).Ye(i)},A.prototype.Ye=function(i){return i=O(i),this.then(function(t){return i.We(t).Ke(t)})},O.when=I,A.prototype.Ke=function(t){return this.then(function(){return t})},O.Ke=function(t,i){return O(t).Ke(i)},A.prototype.$e=function(t){return this.then(function(){throw t})},O.$e=function(t,i){return O(t).$e(i)},O.Xe=N,O.ze=C,O.Je=k,O.Ze=function(t){return C(t)&&"pending"===t.inspect().state},A.prototype.Ze=function(){return"pending"===this.inspect().state},O.th=function(t){return!C(t)||"fulfilled"===t.inspect().state},A.prototype.th=function(){return"fulfilled"===this.inspect().state},O.ih=function(t){return C(t)&&"rejected"===t.inspect().state},A.prototype.ih=function(){return"rejected"===this.inspect().state};var D,j,M,P=[],L=[],H=[],U=!0;function F(){P.length=0,L.length=0,U=U||!0}function G(i){var t=A({when:function(t){return t&&function(i){if(U){var n=r(L,i);-1!==n&&("object"==typeof W&&W&&"function"==typeof W.nh&&O.Me.Pe(function(){var t=r(H,i);-1!==t&&(W.nh("rejectionHandled",P[n],i),H.splice(t,1))}),L.splice(n,1),P.splice(n,1))}}(this),t?t(i):this}},function(){return this},function(){return{state:"rejected",reason:i}});return function(t,i){U&&("object"==typeof W&&W&&"function"==typeof W.nh&&O.Me.Pe(function(){-1!==r(L,t)&&(W.nh("unhandledRejection",i,t),H.push(t))}),L.push(t),i&&void 0!==i.stack?P.push(i.stack):P.push("(no stack) "+i))}(t,i),t}function x(n){return A({when:function(){return n},get:function(t){return n[t]},set:function(t,i){n[t]=i},"delete":function(t){delete n[t]},rh:function(t,i){return null==t?n.apply(void 0,i):n[t].apply(n,i)},apply:function(t,i){return n.apply(t,i)},keys:function(){return E(n)}},void 0,function(){return{state:"fulfilled",value:n}})}function B(t,i,n){return O(t).qe(i,n)}function V(t,i,n){return O(t).sh(i,n)}function q(t){return I(t,function(s){var e=0,h=_();return a(s,function(t,i,n){var r;C(i)&&"fulfilled"===(r=i.inspect()).state?s[n]=r.value:(++e,I(i,function(t){s[n]=t,0==--e&&h.resolve(s)},h.reject,function(t){h.notify({index:n,value:t})}))},void 0),0===e&&h.resolve(s),h.promise})}function Q(s){if(0===s.length)return O.resolve();var e=O.defer(),h=0;return a(s,function(t,i,n){var r=s[n];h++,I(r,function(t){e.resolve(t)},function(t){if(0===--h){var i=t||new Error(""+t);i.message="Q can't get fulfillment value from any promise, all promises were rejected. Last error message: "+i.message,e.reject(i)}},function(t){e.notify({index:n,value:t})})},void 0),e.promise}function Y(t){return I(t,function(t){return t=f(t,O),I(q(f(t,function(t){return I(t,i,i)})),function(){return t})})}O.eh=F,O.hh=function(){return P.slice()},O.oh=function(){F(),U=!1},F(),O.reject=G,O.fulfill=x,O.uh=function(n){return A({ah:function(){}},function(t,i){return V(n,t,i)},function(){return O(n).inspect()})},O.qe=B,A.prototype.qe=function(i,t){return this.all().then(function(t){return i.apply(void 0,t)},t)},O.async=function(i){return function(){function t(t,i){var n;if("undefined"==typeof StopIteration){try{n=r[t](i)}catch(t){return G(t)}return n.done?O(n.value):I(n.value,s,e)}try{n=r[t](i)}catch(t){return function(t){return"[object StopIteration]"===w(t)||t instanceof h}(t)?O(t.value):G(t)}return I(n,s,e)}var r=i.apply(this,arguments),s=t.bind(t,"next"),e=t.bind(t,"throw");return s()}},O.fh=function(t){O.done(O.async(t)())},O.lh=function(t){throw new h(t)},O.vh=function(n){return function(){return B([this,q(arguments)],function(t,i){return n.apply(t,i)})}},O.sh=V,A.prototype.sh=function(t,i){var n=this,r=_();return O.Me(function(){n.Fe(r.resolve,t,i)}),r.promise},O.get=function(t,i){return O(t).sh("get",[i])},A.prototype.get=function(t){return this.sh("get",[t])},O.set=function(t,i,n){return O(t).sh("set",[i,n])},A.prototype.set=function(t,i){return this.sh("set",[t,i])},O.dh=O["delete"]=function(t,i){return O(t).sh("delete",[i])},A.prototype.dh=A.prototype["delete"]=function(t){return this.sh("delete",[t])},O.Eh=O.rh=function(t,i,n){return O(t).sh("post",[i,n])},A.prototype.Eh=A.prototype.rh=function(t,i){return this.sh("post",[t,i])},O.send=O.wh=O.ph=function(t,i){return O(t).sh("post",[i,u(arguments,2)])},A.prototype.send=A.prototype.wh=A.prototype.ph=function(t){return this.sh("post",[t,u(arguments,1)])},O.gh=function(t,i){return O(t).sh("apply",[void 0,i])},A.prototype.gh=function(t){return this.sh("apply",[void 0,t])},O.bh=O.We=function(t){return O(t).sh("apply",[void 0,u(arguments,1)])},A.prototype.We=function(){return this.sh("apply",[void 0,u(arguments)])},O.yh=function(t){var i=O(t),n=u(arguments,1);return function(){return i.sh("apply",[this,n.concat(u(arguments))])}},A.prototype.yh=function(){var t=this,i=u(arguments);return function(){return t.sh("apply",[this,i.concat(u(arguments))])}},O.keys=function(t){return O(t).sh("keys",[])},A.prototype.keys=function(){return this.sh("keys",[])},O.all=q,A.prototype.all=function(){return q(this)},O.Th=Q,A.prototype.Th=function(){return Q(this)},O.Oh=(D=Y,j="allResolved",M="allSettled",function(){return"undefined"!=typeof console&&"function"==typeof emptyFunction&&!1,D.apply(D,arguments)}),A.prototype.Oh=function(){return Y(this)},O.allSettled=function(t){return O(t).allSettled()},A.prototype.allSettled=function(){return this.then(function(t){return q(f(t,function(t){function i(){return t.inspect()}return(t=O(t)).then(i,i)}))})},O.fail=O["catch"]=function(t,i){return O(t).then(void 0,i)},A.prototype.fail=A.prototype["catch"]=function(t){return this.then(void 0,t)},O.progress=function(t,i){return O(t).then(void 0,void 0,i)},A.prototype.progress=function(t){return this.then(void 0,void 0,t)},O.mh=O["finally"]=function(t,i){return O(t)["finally"](i)},A.prototype.mh=A.prototype["finally"]=function(i){if(!i||"function"!=typeof i.apply)throw new Error("Q can't apply finally callback");return i=O(i),this.then(function(t){return i.We().then(function(){return t})},function(t){return i.We().then(function(){throw t})})},O.done=function(t,i,n,r){return O(t).done(i,n,r)},A.prototype.done=function(t,i,n){var r=function(t){O.Me(function(){if(g(t,s),!O.onerror)throw t;O.onerror(t)})},s=t||i||n?this.then(t,i,n):this;"object"==typeof W&&W&&W.domain&&(r=W.domain.bind(r)),s.then(void 0,r)},O.timeout=function(t,i,n){return O(t).timeout(i,n)},A.prototype.timeout=function(t,i){var n=_(),r=setTimeout(function(){i&&"string"!=typeof i||((i=new Error(i||"Timed out after "+t+" ms")).code="ETIMEDOUT"),n.reject(i)},t);return this.then(function(t){clearTimeout(r),n.resolve(t)},function(t){clearTimeout(r),n.reject(t)},n.notify),n.promise},O.delay=function(t,i){return void 0===i&&(i=t,t=void 0),O(t).delay(i)},A.prototype.delay=function(n){return this.then(function(t){var i=_();return setTimeout(function(){i.resolve(t)},n),i.promise})},O._h=function(t,i){return O(t)._h(i)},A.prototype._h=function(t){var i=_(),n=u(t);return n.push(i.Be()),this.gh(n).fail(i.reject),i.promise},O.Rh=function(t){var i=u(arguments,1);return O(t)._h(i)},A.prototype.Rh=function(){var t=u(arguments),i=_();return t.push(i.Be()),this.gh(t).fail(i.reject),i.promise},O.Sh=O.Ah=function(n){if(void 0===n)throw new Error("Q can't wrap an undefined function");var r=u(arguments,1);return function(){var t=r.concat(u(arguments)),i=_();return t.push(i.Be()),O(n).gh(t).fail(i.reject),i.promise}},A.prototype.Sh=A.prototype.Ah=function(){var t=u(arguments);return t.unshift(this),O.Ah.apply(void 0,t)},O.Ih=function(n,r){var s=u(arguments,2);return function(){var t=s.concat(u(arguments)),i=_();return t.push(i.Be()),O(function(){return n.apply(r,arguments)}).gh(t).fail(i.reject),i.promise}},A.prototype.Ih=function(){var t=u(arguments,0);return t.unshift(this),O.Ih.apply(void 0,t)},O.Nh=O.Ch=function(t,i,n){return O(t).Ch(i,n)},A.prototype.Nh=A.prototype.Ch=function(t,i){var n=u(i||[]),r=_();return n.push(r.Be()),this.sh("post",[t,n]).fail(r.reject),r.promise},O.kh=O.Dh=O.jh=function(t,i){var n=u(arguments,2),r=_();return n.push(r.Be()),O(t).sh("post",[i,n]).fail(r.reject),r.promise},A.prototype.kh=A.prototype.Dh=A.prototype.jh=function(t){var i=u(arguments,1),n=_();return i.push(n.Be()),this.sh("post",[t,i]).fail(n.reject),n.promise},O.Mh=function(t,i){return O(t).Mh(i)},A.prototype.Mh=function(i){if(!i)return this;this.then(function(t){O.Me(function(){i(null,t)})},function(t){O.Me(function(){i(t)})})},O.Ph=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var K=T();return O})}).call(this,n(37),n(117).setImmediate)},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(8),s=(e.Lh=5e3,e.Hh=6,e.Uh=1e4,e.Fh=.2,e.Gh=10,e);function e(){}var h=(o.xh="0.0.1",o.Bh=3e4,o.Vh=4e7,o.qh=1,o.Qh=.8,o.Yh=!1,o.Kh=2e4,o.Wh=1e4,o);function o(){}var u=(a.$h=r.Y.Xh,a.zh=3,a.Jh=1e4,a);function a(){}var f=(c.Zh=1.2,c.to=1.5,c.io=1.2,c.no=.5,c);function c(){}var l=(v.ro=r.Y.so,v.eo=2e4,v.ho=5e3,v);function v(){}var d=(E.oo=[412,404],E);function E(){}var w=(p.uo=2e3,p.ao=!0,p.fo=!1,p.co=!0,p.lo=1,p.vo=.04,p["do"]=2,p.Eo=!0,p.wo=!1,p.po=!1,p.bo=1e4,p.yo=4e4,p.To=3700,p.Oo=2e4,p.mo=1,p._o=5,p.Ro=.4,p.So=1,p.Ao=!0,p.Io=2,p.No=1.5,p);function p(){}var g=(b.Co=30,b.ko=2e4,b.Do=3e4,b);function b(){}var y=(T.jo=3e7,T.Mo=3e4,T.Po=10,T);function T(){}var O=(m.Lo=3,m.Ho=!1,m.Uo=3e4,m.Fo=3,m.Go=.2,m.xo=.2,m.Bo=1e4,m);function m(){}var _=(R.Vo=!1,R);function R(){}var S=(A.qo=64e3,A.Qo=5e3,A.Yo=1,A.Ko=1,A.Wo=!1,A.$o=!0,A);function A(){}var I=(N.Xo=4e3,N.zo=3e4,N.Jo=4096,N.Zo=!0,N.tu=5e3,N.iu=1e4,N);function N(){}var C=(k.nu=100,k.ru=200,k);function k(){}var D=(j.su=20,j.eu=20,j.hu=20,j.ou=5,j.TIMEOUT=6e4,j);function j(){}var M=(P.uu="site",P.au="externalAs",P.fu="availableSendRate",P.cu="remoteAddress",P.lu="localAddress",P.vu=2e4,P);function P(){}var L=(H.du=3e4,H);function H(){}var U=(F.Eu=300,F);function F(){}var G=(x.wu=!0,x.pu=!0,x);function x(){}var B=(V.gu=1,V.bu=6,V.yu=12,V.Tu=4,V.Ou=27,V);function V(){}var q=(Q.mu=s,Q._u=h,Q.Ru=u,Q.Su=f,Q.Au=l,Q.Iu=d,Q.Nu=w,Q.Cu=g,Q.Cache=y,Q.ku=O,Q.Du=_,Q.ju=S,Q.UDPBroadcast=I,Q.Mu=C,Q.Pu=D,Q.Lu=M,Q.Hu=L,Q.Uu=U,Q.Fu=G,Q.Gu=B,Q);function Q(){}i.xu=q},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var a=n(21),e=n(22),h=n(0),r=(s.prototype.next=function(){return this.count++,this.count},s);function s(){this.count=0}i.Counter=r;var o=(u.prototype.start=function(t){void 0===t&&(t=h.Framework.time()),this.Bu||(this.Bu={start:t,end:void 0},this.Vu.push(this.Bu))},u.prototype.stop=function(t){void 0===t&&(t=h.Framework.time()),this.Bu&&(this.Bu.end=t,this.Bu=void 0,this.qu=!1)},u.prototype.Qu=function(t,i){void 0===t&&(t=h.Framework.time());var n=this.Bu,r=this.qu;n&&this.stop(t);var s=(r?i:0)||this.Vu.reduce(function(t,i){var n=i.start;return t+i.end-n},0);return this.Vu.length=0,n&&(this.start(t),this.qu=!0),s},u.prototype.reset=function(){this.qu=!1,this.Bu=void 0,this.Vu.length=0},u.prototype.Yu=function(){return Boolean(this.Bu)},u);function u(t){this.Vu=[],this.qu=!1,void 0!==t&&this.start(t)}i.Ku=o;var f=(c.prototype.add=function(t){t<=0||(this.Wu+=t,this.$u++,t>this.Xu&&(this.Xu=t),t<this.zu&&(this.zu=t))},c.prototype.min=function(t){void 0===t&&(t=!0);var i=this.zu==Number.POSITIVE_INFINITY?0:this.zu;return t&&this.reset(),i},c.prototype.max=function(t){void 0===t&&(t=!0);var i=this.Xu==Number.NEGATIVE_INFINITY?0:this.Xu;return t&&this.reset(),i},c.prototype.Ju=function(t){void 0===t&&(t=!0);var i=this.Wu;return t&&this.reset(),i},c.prototype.Zu=function(t){void 0===t&&(t=!0);var i=0<this.$u?this.Wu/this.$u:0;return t&&this.reset(),i},c.prototype.reset=function(){this.zu=Number.POSITIVE_INFINITY,this.Xu=Number.NEGATIVE_INFINITY,this.Wu=0,this.$u=0},c);function c(){this.reset()}i.ta=f;var l=(v.prototype.ia=function(t,i,n){this.protocol.na(i,e.ra.ONEWAY,n),t.write(this.protocol),this.protocol.sa();var r=this.transport.ea(),s=this.ha(r,",",4);return r.slice(s+1,r.length-1)},v.prototype.oa=function(t,i,n,r){var s="["+n+', "'+i+'", 4, 0,'+t+"]";this.transport.ua(s),this.protocol.aa();var e=new r();return e.read(this.protocol),this.protocol.fa(),e},v.prototype.ha=function(t,i,n){return t.split(i,n).join(i).length},v);function v(){this.transport=new e.ca(),this.protocol=new e.la(this.transport)}i.va=l;var d=(E.prototype.isValid=function(){return void 0!==this.bandwidth},E.prototype.da=function(t){return this.bandwidth=Math.max(E.Ea,t),this},E.prototype.wa=function(t){t.isValid()&&(this.isValid()?this.bandwidth=this.bandwidth*(1-E.ALPHA)+t.bandwidth*E.ALPHA:this.bandwidth=t.bandwidth)},E.prototype.pa=function(t){return this.isValid()?Math.round(8e3*t/this.bandwidth):NaN},E.prototype.ga=function(){return this.isValid()?this.bandwidth:NaN},E.prototype.ba=function(){return this.isValid()?this.bandwidth/1e3:NaN},E.prototype.ya=function(){return this.isValid()?this.bandwidth/1e6:NaN},E.prototype.Ta=function(){return this.isValid()?1e6<this.bandwidth?(this.bandwidth/1e6).toFixed(2)+"Mb/s":1e3<this.bandwidth?(this.bandwidth/1e3).toFixed(2)+"Kb/s":this.bandwidth+"b/s":"NaN"},E.ALPHA=.25,E.Ea=1e8,E.Oa=1e4,E);function E(t,i){void 0!==t&&void 0!==i&&(this.bandwidth=Math.min(E.Ea,i/t*8e3))}i.ma=d,i._a=new r(),i.Ra=function(t,i){return i?t+"-"+i:t},i.appendBuffer=function(t,i){var n=new Uint8Array(t.byteLength+i.byteLength);return n.set(new Uint8Array(t),0),n.set(new Uint8Array(i),t.byteLength),n.buffer},i.Sa=function(t){var i=new Uint8Array(t.byteLength);return i.set(new Uint8Array(t),0),i.buffer},i.Aa=function(t,i,n){void 0===n&&(n=!0);for(var r=0;r<t.length;)if(t[r]===i){if(t.splice(r,1),n)break}else r++},i.Ia=function(t){return String.fromCharCode.apply(null,new Uint8Array(t))},i.Na=function(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search);return null==i?"":decodeURIComponent(i[1].replace(/\+/g," "))},i.Ca=function(t){for(var i=t.length-1;0<i;i--){var n=Math.floor(h.Framework.random()*(i+1)),r=t[i];t[i]=t[n],t[n]=r}return t},i.ka=function(t){var i=new Array();for(var n in t)t.hasOwnProperty(n)&&!/^\d+$/.test(n)&&i.push(n);return i},i.Da=function(t){return Object.keys(t).map(function(t){return parseInt(t,10)}).filter(function(t){return!isNaN(t)})},i.ja=function(t,i){return t[i]?t[i]:null},i.Ma=function(t,i){return new a(i).Pa(t).toString()},i.La=function(t){void 0===t&&(t="");var i=t.toLowerCase().indexOf("(format=mpd-time-csf)");return-1!=i&&(t=t.substr(0,i)),-1==(i=t.indexOf("?"))&&(i=t.length),t.substr(0,i)},i.Ha=function(t){var i,n,r,s,e=new a(t),h=e.origin(),o=e.query(),u=e.path();for("/"!==u.charAt(0)&&(i=!0,u="/"+u),"/.."!==u.slice(-3)&&"/."!==u.slice(-2)||(u+="/"),u=u.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),i&&(n=(n=u.substring(1).match(/^(\.\.\/)+/)||"")&&n[0]);-1!==(r=u.search(/\/\.\.(\/|$)/));)u=0!==r?(-1===(s=u.substring(0,r).lastIndexOf("/"))&&(s=r),u.substring(0,s)+u.substring(r+3)):u.substring(3);return h+u+(o?"?"+o:"")},i.Zu=function(t){return 0==t.length?0:t.reduce(function(t,i){return t+i})/t.length},i.Ua=function(t){for(var i=new ArrayBuffer(t.length),n=new Uint8Array(i),r=0,s=t.length;r<s;r++)n[r]=t.charCodeAt(r);return i},i.createEvent=function(t,i,n,r){var s=new t(i,n),e=r||n.currentTarget;return e&&Object.defineProperties(s,{currentTarget:{value:e,enumerable:!0,writable:!1},target:{value:e,enumerable:!0,writable:!1}}),s},i.Fa=/[-\/\\^$*+?.()|[\]{}]/g,i.Ga=function(t){return t.replace(i.Fa,"\\$&")}},function(t,i,n){"use strict";var r;Object.defineProperty(i,"s",{value:!0}),(r=i.xa||(i.xa={}))[r.Ba=0]="AUDIO",r[r.Va=1]="VIDEO",r[r.qa=2]="METADATA",r[r.Qa=3]="OTHER"},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.Ya=!0,s.Ka=!0,s.Wa="4.1.0",s.$a="oz",s.Xa="undefined"!=typeof HIVE_PLUGIN_TIMEOUT?HIVE_PLUGIN_TIMEOUT:3e4,s.za="6.0.0-rc.3",s.Ja="undefined"!=typeof HIVE_CACHE_PLAYER_REQUEST_QUERY_PARAMS?HIVE_CACHE_PLAYER_REQUEST_QUERY_PARAMS:[],s.Za="undefined"!=typeof HIVE_CACHE_PLAYER_REQUEST_HEADERS?HIVE_CACHE_PLAYER_REQUEST_HEADERS:[],s["if"]=!1,s.nf=!0,s.rf="undefined"!=typeof INCLUDE_UDP_BROADCAST&&INCLUDE_UDP_BROADCAST,s.sf="undefined"!=typeof INCLUDE_UDP_LEADER_ELECTION&&INCLUDE_UDP_LEADER_ELECTION,s.ef="undefined"!=typeof LEADER_SCORE_EQUALITY&&LEADER_SCORE_EQUALITY,s.hf="undefined"!=typeof INCLUDE_DEFAULT_NETWORK&&INCLUDE_DEFAULT_NETWORK,s.uf="undefined"!=typeof HIVE_RESTRICTED_CONNINFO&&HIVE_RESTRICTED_CONNINFO,s.so="undefined"!=typeof HIVE_DISCOVERY?HIVE_DISCOVERY:"ws://127.0.0.1:8000/hive",s.af="undefined"!=typeof P2PDispatcherDetailedLog&&P2PDispatcherDetailedLog,s.ff="undefined"!=typeof NetworkManagerDetailedLog&&NetworkManagerDetailedLog,s.q="undefined"!=typeof ATATUS_KEY?ATATUS_KEY:"0b83dd6a94664cc9a09c478a7d77384e",s.K="undefined"!=typeof ATATUS_VERSION?ATATUS_VERSION:"4.2.1",s.W="undefined"==typeof ATATUS_DEFAULT_ENABLED||ATATUS_DEFAULT_ENABLED,s.$="undefined"!=typeof ATATUS_ROWS_TO_EXCLUDE?ATATUS_ROWS_TO_EXCLUDE:5,s.cf="undefined"==typeof HIVE_DETECT_PRIVATEIP||HIVE_DETECT_PRIVATEIP,s.lf=!0,s.vf=!1,s.df=!0,s.Xh=!1,s.Ef="undefined"==typeof STATS_MANIFEST_INTERCEPTION_ENABLED||STATS_MANIFEST_INTERCEPTION_ENABLED,s.wf="undefined"!=typeof HIVE_REPORTING_THRESHOLD?HIVE_REPORTING_THRESHOLD:0,s);function s(){}i.Y=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0}),n(25);var r,s=n(48);(r=i.pf||(i.pf={}))[r.gf=0]="TRACKER",r[r.bf=1]="UDP";function e(t,i,n){this.type=t,(this.isLeader=n)||(this.isLeader=!1),i&&(this.guid=i.guid,this.internalAs=i.internalAs,this.externalAs=i.externalAs,this.nat=i.nat,this.bandwidth=i.bandwidth,this.watchingQualityLevel=new s.QualityLevel(i.watchingQualityLevel,i.watchingBitrate),this.streams=i.streams,this.rankValue=i.rankValue,this.timestamp=i.timestamp,this.privateIpString=i.privateIpString,this.publicIpString=i.publicIpString)}i.yf=e},function(t,i,n){n(70),n(38),n(71),n(119)},function(t,i,n){"use strict";function r(){throw new Error("Can't construct. GenericCollection is a mixin.")}(t.exports=r).Tf=Object.freeze([]),r.prototype.hiveAddEach=function(i){if(i&&Object(i)===i)if("function"==typeof i.forEach)i.forEach(this.hiveAdd,this);else if("number"==typeof i.length)for(var t=0;t<i.length;t++)this.hiveAdd(i[t],t);else Object.keys(i).forEach(function(t){this.hiveAdd(i[t],t)},this);else if(i&&"number"==typeof i.length)for(t=0;t<i.length;t++)this.hiveAdd(i[t],t);return this},r.prototype.Of=function(t,i){return t.forEach(function(t){this["delete"](t,i)},this),this},r.prototype.forEach=function(e){var h=arguments[1];return this.reduce(function(t,i,n,r,s){e.call(h,i,n,r,s)},void 0)},r.prototype.map=function(e){var h=arguments[1],o=[];return this.reduce(function(t,i,n,r,s){o.push(e.call(h,i,n,r,s))},void 0),o},r.prototype.enumerate=function(n){null==n&&(n=0);var r=[];return this.reduce(function(t,i){r.push([n++,i])},void 0),r},r.prototype.group=function(e,h,o){o=o||Object.equals;var u=[],a=[];return this.forEach(function(t,i,n){i=e.call(h,t,i,n);var r,s=a.indexOf(i,o);-1===s?(r=[],u.push([i,r]),a.push(i)):r=u[s][1],r.push(t)}),u},r.prototype.toArray=function(){return this.map(Function.identity)},r.prototype.mf=function(){var r={};return this.reduce(function(t,i,n){r[n]=i},void 0),r},r.prototype.filter=function(e){var h=arguments[1],o=this.Ne();return this.reduce(function(t,i,n,r,s){e.call(h,i,n,r,s)&&o.hiveAdd(i,n)},void 0),o},r.prototype.every=function(e){var h=arguments[1];return this.reduce(function(t,i,n,r,s){return t&&e.call(h,i,n,r,s)},!0)},r.prototype.some=function(e){var h=arguments[1];return this.reduce(function(t,i,n,r,s){return t||e.call(h,i,n,r,s)},!1)},r.prototype.all=function(){return this.every(Boolean)},r.prototype.Th=function(){return this.some(Boolean)},r.prototype.min=function(n){n=n||this._f||Object.compare;var r=!0;return this.reduce(function(t,i){return r?(r=!1,i):n(i,t)<0?i:t},void 0)},r.prototype.max=function(n){n=n||this._f||Object.compare;var r=!0;return this.reduce(function(t,i){return r?(r=!1,i):0<n(i,t)?i:t},void 0)},r.prototype.Ju=function(t){return t=void 0===t?0:t,this.reduce(function(t,i){return t+i},t)},r.prototype.Rf=function(t){var n=void 0===t?0:t,r=void 0===t?0:t;return this.reduce(function(t,i){n+=i,r+=1},void 0),n/r},r.prototype.concat=function(){for(var t=this.Ne(this),i=0;i<arguments.length;i++)t.hiveAddEach(arguments[i]);return t},r.prototype.Sf=function(){var n=this;return this.reduce(function(t,i){return i.forEach(function(t){this.push(t)},t,n),t},[])},r.prototype.Af=function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),Array.If(t)},r.prototype.join=function(n){return this.reduce(function(t,i){return void 0===t?i:t+n+i},void 0)},r.prototype.Nf=function(n,i,r){return(n=n||this._f||Object.compare).Cf?(i=n.Cf,n=n.compare||this._f||Object.compare):i=i||Function.identity,void 0===r&&(r=1),this.map(function(t){return{Cf:i(t),value:t}}).sort(function(t,i){return n(t.Cf,i.Cf)*r}).map(function(t){return t.value})},r.prototype.reversed=function(){return this.Ne(this).reverse()},r.prototype.clone=function(n,r){if(void 0===n)n=1/0;else if(0===n)return this;var s=this.Ne();return this.forEach(function(t,i){s.hiveAdd(Object.clone(t,n-1,r),i)},this),s},r.prototype.only=function(){if(1===this.length)return this.kf()},r.prototype.iterator=function(){return this.Df.apply(this,arguments)},r.Ie={get:function(){return this.length},enumerable:!1,configurable:!0},Object.defineProperty(r.prototype,"size",r.Ie),n(70)},function(t,i,n){n(10);var r=Object.prototype.hasOwnProperty;function h(){throw new Error("This is an abstract interface. Mix it. Don't construct it")}function o(t,i,n,r){var s,e,h,o=t.active,u=t.jf,a=u.length,f=a;for(o.length>a&&(o.length=a);a--;)o[a]=u[a];for(e=0;e<f;e++)if(h=o[e],!e||0<=u.indexOf(h)){if(!(s=h[t.Mf]||h[t.Pf]||h).call)throw new Error("No event listener for "+t.Lf+" or "+t.Hf+" or call on "+s);s.call(h,n,i,r)}}(t.exports=h).debug=!0,h.prototype.Uf=function(t){this.Ff||Object.defineProperty(this,"Ff",{value:{},enumerable:!1,configurable:!0,writable:!0});var i=this.Ff;if(!r.call(i,t)){var n=String(t);n=n&&n[0].toUpperCase()+n.slice(1),i[t]={Gf:{jf:[],active:[],Mf:"handle"+n+"WillChange",Pf:"handlePropertyWillChange"},xf:{jf:[],active:[],Mf:"handle"+n+"Change",Pf:"handlePropertyChange"}}}return i[t]},h.prototype.Bf=function(t){if(!this.Ff)return!1;if(!t)return!0;var i=this.Ff;return!!r.call(i,t)},h.prototype.Vf=function(t,i,n){this.qf&&!this.Qf&&this.qf();var r,s=h.Uf(this,t);r=n?s.Gf:s.xf,h.Yf(this,t),r.jf.push(i);var e=this;return function(){h.Kf(e,t,i,n),e=null}},h.prototype.Wf=function(t,i){return h.Vf(this,t,i,!0)},h.prototype.Kf=function(t,i,n){var r,s=h.Uf(this,t),e=(r=n?s.Gf:s.xf).jf.lastIndexOf(i);if(-1===e)throw new Error("Can't remove property change listener: does not exist: property name"+JSON.stringify(t));r.jf.splice(e,1)},h.prototype.$f=function(t,i){return h.Kf(this,t,i,!0)},h.prototype.Xf=function(t,i,n){var r,s=h.Uf(this,t);if(!s.isActive){s.isActive=!0,r=n?s.Gf:s.xf;try{o(r,t,i,this)}finally{s.isActive=!1}}},h.prototype.zf=function(t,i){return h.Xf(this,t,i,!0)},h.prototype.Yf=function(s){var e,h,t=this.Jf;if(t){if(r.call(t,s))return}else{if(Array.isArray(this))return;if(!Object.isExtensible(this))throw new Error("Can't make property "+JSON.stringify(s)+" observable on "+this+" because object is not extensible");t={},Object.defineProperty(this,"Jf",{value:t,enumerable:!1,writable:!0,configurable:!0})}"object"==typeof this.Zf?e=this.Zf:(e={},Object.defineProperty(this,"Zf",{value:e,writable:!0,enumerable:!1})),e[s]=this[s];var i,n=this;do{if(h=Object.getOwnPropertyDescriptor(n,s))break;n=Object.getPrototypeOf(n)}while(n);if(h){if(!h.configurable)return;if(!h.writable&&!h.set)return}else h={value:void 0,enumerable:!0,writable:!0,configurable:!0};i="value"in(t[s]=h)?{get:function(){return h.value},set:function(t){var i,n;if(t!==h.value){if(!(n=(i=this.Ff[s]).isActive)){i.isActive=!0;try{o(i.Gf,s,h.value,this)}finally{}}if(h.value=t,e[s]=t,!n)try{o(i.xf,s,t,this)}finally{i.isActive=!1}}},enumerable:h.enumerable,configurable:!0}:{get:h.get,set:function(t){var i,n,r=this[s];if(h.set.call(this,t),(t=this[s])!==r){if(!(n=(i=this.Ff[s]).isActive)){i.isActive=!0;try{o(i.Gf,s,r,this)}finally{}}if(e[s]=t,!n)try{o(i.xf,s,t,this)}finally{i.isActive=!1}}},enumerable:h.enumerable,configurable:!0},Object.defineProperty(this,s,i)},h.Uf=function(t,i){return t.Uf?t.Uf(i):h.prototype.Uf.call(t,i)},h.Bf=function(t,i){return t.Bf?t.Bf(i):h.prototype.Bf.call(t,i)},h.Vf=function(t,i,n,r){if(Object.tc(t))return t.Vf?t.Vf(i,n,r):h.prototype.Vf.call(t,i,n,r)},h.Kf=function(t,i,n,r){if(Object.tc(t))return t.Kf?t.Kf(i,n,r):h.prototype.Kf.call(t,i,n,r)},h.Xf=function(t,i,n,r){if(Object.tc(t))return t.Xf?t.Xf(i,n,r):h.prototype.Xf.call(t,i,n,r)},h.Wf=function(t,i,n){return h.Vf(t,i,n,!0)},h.$f=function(t,i,n){return h.Kf(t,i,n,!0)},h.zf=function(t,i,n){return h.Xf(t,i,n,!0)},h.Yf=function(t,i){return t.Yf?t.Yf(i):h.prototype.Yf.call(t,i)}},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e=n(43),h=n(8),o=(u.DashFilterBitrates=null,u.DashRemoveBitrateSize=!1,u);function u(){}var a=(f.AudioAccounting=!0,f);function f(){}var c,l=(c=e.HiveConfig.DebugLogs,s(v,c),v.TrackerLogs=0,v);function v(){return null!==c&&c.apply(this,arguments)||this}var d=(E.usiz=null,E);function E(){}var w=(p.enabled=!1,p);function p(){}var g=(b.restrictedConnectivityInfo=h.Y.uf,b.hiddenHostnameValue="[Hidden]",b);function b(){}var y=(T.rc=null,T.sc=null,T);function T(){}var O=(m.detectPrivateIP=h.Y.cf,m);function m(){}var _=(R.Dash=o,R.Stats=a,R.DebugLogs=l,R.UDPBroadcast=d,R.SensitiveInfo=g,R.ClientInfo=y,R.ConnInfo=O,R.ec=w,R);function R(){}i.HiveConfig=_,"undefined"!=typeof window&&(void 0===window.HiveConfig&&(window.HiveConfig={}),window.HiveConfig.Dash=_.Dash,window.HiveConfig.Stats=_.Stats,window.HiveConfig.UDPBroadcast=_.UDPBroadcast,window.HiveConfig.DebugLogs=_.DebugLogs,window.HiveConfig.SensitiveInfo=_.SensitiveInfo,window.HiveConfig.ClientInfo=_.ClientInfo,window.HiveConfig.ConnInfo=_.ConnInfo,window.HiveConfig.ec=_.ec)},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(8),s=(e.hc="ws://127.0.0.1:8000/hive",e.oc="wss://bee.hivestreaming.com:443/v1/hivejs",e.uc="ws://127.0.0.1:8001/v1/hivejs",e.ac="wss://bee-test.hivestreaming.com:443/v1/hivejs",e.fc="wss://labs-hivejs.test.hivestreaming.net:443/v1/hivejs",e.cc="wss://labs-hivejs.prod.hivestreaming.net:443/v1/hivejs",e.lc="https://api-groot-test.hivestreaming.com/v1/auth/stream",e.vc="https://api-groot-prod.hivestreaming.com/v1/auth/stream",e.dc={iceServers:[{url:"stun:stun.hivestreaming.com:3478"}]},e.Ec=3e4,e.wc=3e5,e.pc=8e4,e.gc=1e3,e.bc=3e4,e.yc=100,e.Tc=1e4,e.Oc=!1,e.mc=!1,e.nf=r.Y.nf,e.lf=r.Y.lf,e._c=250,e);function e(){}i.Rc=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var u=n(4),o=n(21);function h(i,r,s,e){void 0===r&&(r=""),void 0===s&&(s=[]),void 0===e&&(e=!1);function t(n){if(i.hasOwnProperty(n)){var t=i[n];Array.isArray(t)?t.forEach(function(t,i){"object"==typeof t&&h(t,r+"."+n+"["+i+"]",s,e)}):"object"==typeof t?h(t,r+"."+n,s,e):"number"==typeof t&&isNaN(t)&&(s.push(r+"."+n),e||(i[n]=null))}}for(var n in i)t(n);return s}function a(t,i){var n;switch(typeof i){case"number":n=parseInt(t);break;case"boolean":n="true"===t;break;default:n=t}return n}function s(t,i,n,r,s){void 0===r&&(r=!0),void 0===s&&(s={});var e=u.defer();try{var h=new XMLHttpRequest();if(h.open(t,i,r),null!=n&&null!=n&&h.setRequestHeader("Content-Type",n),s)for(var o in s)s.hasOwnProperty(o)&&null!==s[o]&&h.setRequestHeader(o,s[o]);h.onload=function(){200==h.status?e.resolve(h.response):e.reject({status:h.status,reason:h.statusText,body:h.responseText})},h.onerror=function(t){e.reject({status:-1,reason:"Network Error"})},h.send()}catch(t){e.reject({status:-1,reason:t})}return e.promise}i.Ta=function(t,i){return void 0===i&&(i=2),1e6<t?(t/1e6).toFixed(i)+"MB":1e3<t?(t/1e3).toFixed(i)+"KB":t+"B"},i.Sc=function(t,i,n){return void 0===i&&(i=""),void 0===n&&(n=[]),h(t,i,n,!0)},i.Ac=h,i.Ic=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];for(var n=t[0],r=1;r<t.length;r++){var s=new RegExp("\\{"+(r-1)+"\\}","gm");n=n.replace(s,t[r])}return n},i.updateOptions=function(t,i){for(var n in t)if(t.hasOwnProperty(n)&&i.hasOwnProperty(n))if("function"==typeof i[n]&&"string"==typeof t[n])try{var r=window;do{var s=t[n];if("function"==typeof r[s]){i[n]=r[s];break}}while(r!=r.top&&(r=r.parent))}catch(t){}else i[n]=t[n]},i.parseParameterOptions=function(t,i,n){var r=new o(t).query(!0);for(var s in r)try{if(r.hasOwnProperty(s)&&i.hasOwnProperty(s)&&n.hasOwnProperty(i[s])){var e=i[s],h=r[s];n[e]=a(h,n[e])}}catch(t){}},i.Nc=function(i,n){var r=u.defer();return u.Me(function t(){if(!i())return r.resolve(!0);u.when(n(),t,r.reject)}),r.promise},i.Cc=function(t,i,n,r){return void 0===n&&(n=!0),void 0===r&&(r={}),s("GET",t,i,n,r)},i.kc=s,i.Dc=function(t,i,n,r,s){void 0===s&&(s=!0);var e=u.defer();try{var h=new XMLHttpRequest();if(h.open("POST",t,s),null!=n&&null!=n&&h.setRequestHeader("Content-Type",n),null!=r&&null!=r)for(var o in r)r.hasOwnProperty(o)&&null!==r[o]&&h.setRequestHeader(o,r[o]);h.onload=function(){200==h.status?e.resolve(h.response):e.reject({status:h.status,reason:h.response})},h.onerror=function(t){e.reject({status:-1,reason:"Network Error"})},h.send(i)}catch(t){e.reject({status:-1,reason:t})}return e.promise},i.jc=function(){"function"!=typeof Object.assign&&(Object.assign=function(t,i){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),r=1;r<arguments.length;r++){var s=arguments[r];if(null!=s)for(var e in s)Object.prototype.hasOwnProperty.call(s,e)&&(n[e]=s[e])}return n})},i.Sa=function(t){var i=new Uint8Array(t.byteLength);return i.set(new Uint8Array(t),0),i.buffer},i.Mc=function(t,i){var n=0,r=0,s=!1;if(i)for(;r<i.length&&!s;)t>=i.start(r)&&t<i.end(r)&&(n=i.end(r)-t,s=!0),r++;return n}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r,s=n(1),e=n(2);i.loggerId="[HiveServices] ";var h=(o.prototype.ia=function(){try{var t=[new Uint8Array([this.service>>8,255&this.service]),new Uint8Array([this.msgId]),this.msg];return new Blob(t,{type:"application/octet-binary"})}catch(t){throw s.ErrorMonitor.getInstance().logError("Error serializing message to send to the services",o.loggerId,e.Js.Zs,t),new Error(t)}},o.Pc=function(t){try{String.fromCharCode.apply(null,new Uint8Array(t));var i=String.fromCharCode.apply(null,new Uint8Array(t.slice(3))),n=new Uint8Array(t.slice(0,2)),r=new Uint8Array(t.slice(2,3));return new o((n[0]<<8)+n[1],r[0],i)}catch(t){throw s.ErrorMonitor.getInstance().logError("Error extracting message from the services",this.loggerId,e.Js.te,t),new Error(t)}},o.loggerId="[Message] ",o);function o(t,i,n){this.msgId=i,this.service=t,this.msg=n}i.Lc=h,i.logger=function(){if(r)return r;var t=window&&window.window?window.window.Hc:void 0;if(void 0!==t&&t.log&&t.debug&&t.info&&t.warn&&t.error&&(r=t),!r){var i=!(void 0===window.console),n=i?emptyFunction.bind(console):function(){};r={log:n,debug:i&&window.console.debug?window.console.debug.bind(console):n,info:i&&window.console.info?window.console.info.bind(console):n,warn:i&&window.console.warn?window.console.warn.bind(console):n,error:i&&window.console.error?window.console.error.bind(console):n}}return r}},function(t,c,i){"use strict";Object.defineProperty(c,"s",{value:!0});var l,n,s=i(4),r=i(201),v=i(36),e=i(3),d=i(23),E=i(0),h=i(203),a=i(210),w=i(5),f=i(6),p=i(1),g=i(2);c.Uc=!1,(n=l=c.Fc||(c.Fc={}))[n.Have=1]="Have",n[n.Chunk=2]="Chunk",n[n.Request=3]="Request",n[n.Cancel=4]="Cancel",n[n.Ack=5]="Ack",n[n.Close=6]="Close",n[n.DoNotHave=7]="DoNotHave",n[n.Gc=8]="OutPartRequest",n[n.xc=9]="OutPartResp",n[n.Bc=10]="UDPHandshakeReq",n[n.UDPHandshakeResponse=11]="UDPHandshakeResponse",n[n.UDPSwitchLeadershipRequest=12]="UDPSwitchLeadershipRequest",n[n.Vc=13]="UDPSwitchAck",n[n.QualityLevelMessage=14]="QualityLevelMessage",n[n.Haves=15]="Haves",n[n.qc=16]="PeerInfo",n[n.Ping=17]="Ping",n[n.Pong=18]="Pong",n[n.Qc=19]="NoPartnerResp";var o=(u.prototype.create=function(t){try{var i=null,n=E.Framework.resolve(E.Framework.v.Kc).Yc(t);return null==n?(this.logger.warn("MSG RECEIVED FROM UNKNOWN SWARM"),null):(i=new h.Wc(n,this.transport.$c,this.transport.otherGuid,this.transport),this.Xc.has(t)||this.Xc.set(t,i),this.Xc.get(t))}catch(t){p.ErrorMonitor.getInstance().logError("Error creating new dispatcher",this.loggerId,g.Yt.Kt,t)}},u.prototype.remove=function(t){this.Xc["delete"](t)},u.prototype.get=function(t){return this.Xc.get(t)},u);function u(t){this.loggerId="[DispatcherManager] ",this.Xc=new e(),this.logger=E.Framework.resolve(E.Framework.v.p).log(),this.transport=t}c.zc=o;var b=(y.prototype.init=function(t,i){this.$c=t,this.otherGuid=i,this.Jc=E.Framework.resolve(E.Framework.v.Zc)},y.prototype.tl=function(){var n=!1;return this.il.Xc.forEach(function(t,i){(t.sender.tl()||t.receiver.tl())&&(n=!0)}),n},y.prototype.reset=function(){this.il.Xc.forEach(function(t,i){t.sender.nl()})},y.prototype.close=function(t){return this.il.remove(t),0==this.il.Xc.length&&this.Jc.disconnect(this.otherGuid),s("ok")},y.prototype.rl=function(i,n,t){var r,s;try{this.sl=E.Framework.time();var e=t.toArrayBuffer(),h=e.byteLength,o=d.ol.hl.el.create(e),u=d.ol.ul(o),a=new v();a.al(i),a.fl(n),a.al(h),a.fl(u.toString()),a.append(e),a.cl(),r=a.toArrayBuffer(),s=i===l.Chunk&&E.Framework.T()?r.byteLength+w.xu.ju.qo:r.byteLength,c.Uc&&this.ll.log(n).debug(this.instance+" SEND MSG ID "+i+","+s+" HASH "+u.toString()+" TO "+this.otherGuid)}catch(t){p.ErrorMonitor.getInstance().logError("Error constructing message",this.loggerId,g.xt.Bt,{vl:l[i]})}try{var f=this.Jc.send(this.otherGuid,r,s);return f||p.ErrorMonitor.getInstance().logError("Error message dropped",this.loggerId,g.xt.Vt,{vl:l[i],otherGuid:this.otherGuid}),f}catch(t){p.ErrorMonitor.getInstance().logError("Error sending message",this.loggerId,g.xt.qt,{vl:l[i],otherGuid:this.otherGuid}),this.ll.log(n).warn("ERROR SENDING MESSAGE TO "+this.otherGuid+" "+t.stack)}},y.prototype.dl=function(){this.il.Xc.forEach(function(t){return t.dl()})},y.prototype.El=function(h){var o=this;c.Uc&&this.ll.log().debug(this.instance+" GOT MSG "+h.byteLength);try{var u=E.Framework.time();this.sl=u,this.wl(h).then(function(t){if(c.Uc&&o.ll.log().debug(o.instance+" RECEIVING "+t.byteLength+" after "+(E.Framework.time()-u)),t.byteLength>y.pl)throw new RangeError("P2P Message too big to be processed");var i=o.message;if(null===i){var n=v.wrap(t),r=n.gl();if(c.Uc&&o.ll.log().debug("MSG ID "+r),r>Object.keys(l).length)return o.ll.log().warn("MSG OF WRONG ID RECEIVED: "+r),void (o.message=null);if((i=o.message=new a.yl()).bl=r,i.swarmId=n.Tl(),i.length=n.gl(),i.hash=n.Tl(),i.receivedData=n.toArrayBuffer(),i.length>y.pl)throw new RangeError("P2P Message too big to be processed");c.Uc&&o.ll.log(i.swarmId).debug("MSG ID "+i.bl+" L "+i.length+" SWID "+i.swarmId+" H "+i.hash+" TR "+i.receivedData.byteLength)}else{if(c.Uc&&o.ll.log().debug("APPENDING TO P2P MESSAGE "+i.bl),null!=i.receivedData.byteLength&&i.receivedData.byteLength>y.pl)throw new RangeError("P2P Message too big to be processed");i.receivedData=f.appendBuffer(i.receivedData,h)}if(i.receivedData.byteLength===i.length){var s=d.ol.hl.el.create(i.receivedData);if(d.ol.ul(s).toString()!==i.hash)return void o.ll.log(i.swarmId).warn(" INTEGRITY CHECK FAILED ");var e=o.il.get(i.swarmId);e||(e=o.il.create(i.swarmId),o.ll.log(i.swarmId).debug("CREATED NEW DISPATCHER FOR "+o.otherGuid)),e&&e.sh(i),i.receivedData=null,o.message=null}})}catch(t){p.ErrorMonitor.getInstance().logError("Error receiving message",this.loggerId,g.xt.Qt,t),this.message=null}},y.prototype.wl=function(i){var t=!E.Framework.T()&&-1<navigator.userAgent.toLowerCase().indexOf("firefox"),n=s.defer();if(t){var r=new FileReader();r.onload=function(t){i=this.result,n.resolve(i)},r.onerror=n.reject,r.readAsArrayBuffer(i)}else n.resolve(i);return n.promise},y.prototype.Ol=function(){return this.sl},y.ml=r.Rl(i(211))._l("HiveMsgs"),y.Sl=0,y.pl=136+Math.ceil(1.2*w.xu.ju.qo),y);function y(){this.loggerId="[Transport] ",this.message=null,this.ll=E.Framework.resolve(E.Framework.v.p),this.il=new o(this),this.instance=y.Sl++,this.sl=E.Framework.time()}c.Al=b},function(t,i){t.exports=void 0},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(3),a=n(4),o=n(0),u=n(29),f=n(61);(e=i.Il||(i.Il={}))[e.STOP=0]="STOP",e[e.IDLE=1]="IDLE",e[e.Nl=2]="PLAY";var c=(l.prototype.close=function(t){t&&this.Cl["delete"](t),0==this.Cl.length&&this.kl.close()},l.prototype.Dl=function(t){return this.Cl.has(t)},l);function l(){this.p2pId=null,this.reportingId=null,this.Cl=new h(),this.logger=o.Framework.resolve(o.Framework.v.p).log(),this.logger.debug("INIT REPORTING"),this.kl=o.Framework.resolve(o.Framework.v.jl),this.Ml=o.Framework.resolve(o.Framework.v.Pl)}i.Ll=c;var v=(d.prototype.Hl=function(){return!(this.store&&this.store.Ul&&this.store.Ul.player)||(this.store.Ul.player.playingTimeMs||0)>=this.threshold},d.prototype.Fl=function(t){this.threshold=t},d);function d(t){this.threshold=0,this.store=t}i.Gl=v;var E=(w.prototype.xl=function(t){this.Bl=t,this.Vl.xl(this.Bl),this.ql.xl(this.Bl)},w.prototype.onStateChange=function(t){this.Ql.onStateChange(t)},w.prototype.Yl=function(){this.Wl.Kl()},w.prototype.Fl=function(t){this.filter.Fl(Number(t)||0)},w.prototype.$l=function(t){this.filter=t,this.Wl.$l(t),this.Ql.$l(t)},w);function w(t,i,n,r){this.ticket=t,this.kl=i,this.Bl=n,this.identity=r,this.Vl=o.Framework.resolve(o.Framework.v.Xl),this.Ql=o.Framework.resolve(o.Framework.v.zl),this.ql=o.Framework.resolve(o.Framework.v.Jl),this.Wl=new u.Zl(this.ql),this.tv=o.Framework.resolve(o.Framework.v.nv),this.$l(new v(this.Vl))}i.rv=E;var p,g=(s(b,p=c),b.prototype.initSession=function(t,i,n,r,s){var e=this,h=a.defer(),o=this.Ml.sv(),u=this.hv.ev(i);return u.pluginId=t,null!=r&&(u.testId=r),null!=u?o.then(function(t){return e.ov(t,u,h,n)}).fail(h.reject):h.reject("Ticket URL not valid"),h.promise},b.prototype.ov=function(s,t,e,i){var h=this;this.p2pId=s.uv(),this.reportingId=s.av();var n=this.kl.init(this.p2pId,t),r=this.hv.resolve(n.fv,t,i);n.promise.then(function(t){r.then(function(t){var i=t.sessionId;if(h.Cl.has(i))n=h.Cl.get(i),h.logger.warn("SESSION ALREADY EXISTING "+n.Vl.ticket);else{var n,r=f["default"].cv();(n=new E(t,h.kl,r,s)).Vl.init(h.reportingId,t,r,i),n.ql.init(h.reportingId,r),n.ql.lv(t),h.Cl.set(i,n),h.logger.debug("SESSION SET ",i),e.resolve(n)}}).fail(function(t){return e.reject(t||"Error resolving the ticket")}),t.onerror(function(t){e.reject("Error establishing connection to Hive Services")})}).fail(function(t){return e.reject(t)}),this.kl.connect()},b);function b(){var t=p.call(this)||this;return t.hv=o.Framework.resolve(o.Framework.v.vv),t}i.dv=g;var y,T=(s(O,y=c),O.prototype.initSession=function(t,i,n,r,s){var e=this,h=this.Ml.sv();return i.pluginId=t,null!=r&&(i.testId=r),h.then(function(t){return e.ov(t,i,null,!1,s)}).fail(a.reject)},O.prototype.ov=function(s,e,t,i,n){var h=this;this.p2pId=s.uv(),this.reportingId=s.av();var r=this.kl.init(this.p2pId,e,n);return this.kl.connect(),r.then(function(t){var i,n=e.sessionId;if(h.Cl.has(n))i=h.Cl.get(n),h.logger.warn("SESSION ALREADY EXISTING "+i.Vl.ticket);else{var r=f["default"].cv();(i=new E(e,h.kl,r,s)).Vl.init(h.reportingId,e,r,n),i.ql.init(h.reportingId,r),i.ql.lv(e),h.Cl.set(n,i),h.logger.debug("SESSION SET ",n)}return i}).fail(function(t){return a.reject(t)})},O);function O(){return null!==y&&y.apply(this,arguments)||this}i.Ev=T},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){this.monitorPort=e.Rc.wv?h.gv.pv:h.gv.bv,this.playerPort=e.Rc.wv?h.gv.yv:h.gv.Tv,this.feedbackPeriod=2e3,this.idleTimePeriod=6e4,this.useSessionCheck=e.Rc.Ov,this.debugLevel="notice",this.isSDNDebug=!1,this.hiveTechOrder=[],this.telemetryId=null,this.silent=!1,this.loggerTimestamp=s.HiveConfig.Framework.LoggerTimestamp,this.testId=null,this.pluginTimeout=o.Y.Xa,this.reportingThreshold=o.Y.wf,this.readyCheckTimeout=0,this.macReadyCheckTimeout=-1,this.onSourceSetCompleted=function(t){},this.onLoadingCompleted=function(t){},this.detectPrivateIP=o.Y.cf,this.authTokenEnabled=!0,this.dashRemoveBitrateSize=!1,this.dashFilterBitrates=null,this.staticPartnerId=null,this.staticCustomerId=null,this.audioMetrics=!0,this.logJsonSnapshots=void 0,this.onActiveSession=function(t){},this.onError=function(t){},this.onSessionStateChange=function(t){}}var s=n(43),e=n(44),h=n(45),o=n(8);i.Options=r;function u(){this.initTimeout=3e4,this.contextMatcher=void 0,this.onError=function(t){return!0},this.onActiveSession=function(t){}}i.HiveTechOptions=u;function a(){this.hivePlayerPort="playerPort",this.hiveMonitorPort="monitorPort",this.hiveSilent="silent",this.hiveDebugLevel="debugLevel",this.isSDNDebug="isSDNDebug",this.hiveDebugTimestamp="loggerTimestamp",this.hiveSetupTimeout="setupTimeout",this.hiveJavaTimeout="initTimeout",this.hiveWarnJavaTimeout="warnSlowRespTimeout",this.hiveTestId="testId",this.hiveDetectPrivateIP="detectPrivateIP",this.hiveAuthTokenEnabled="authTokenEnabled",this.hiveDashRemoveBitrateSize="dashRemoveBitrateSize",this.hiveDashFilterBitrates="dashFilterBitrates",this.hiveLogJsonSnapshots="logJsonSnapshots",this.hiveStaticPartnerId="staticPartnerId",this.hiveStaticCustomerId="staticCustomerId",this.hiveAudioMetrics="audioMetrics"}i.UrlConfigurableOptions=a;var f=(c.enabledRUM=!1,c.enableKeyCombination=!0,c.enabledErrorFilter=!0,c);function c(){}i.ErrorMonitorOptions=f;var l=(v.mv=function(t){"dashRemoveBitrateSize"in t&&t.dashRemoveBitrateSize&&window.HiveConfig&&window.HiveConfig.Dash&&(window.HiveConfig.Dash.DashRemoveBitrateSize=t.dashRemoveBitrateSize),"dashFilterBitrates"in t&&t.dashFilterBitrates&&window.HiveConfig&&window.HiveConfig.Dash&&(window.HiveConfig.Dash.DashFilterBitrates=t.dashFilterBitrates),"staticCustomerId"in t&&t.staticCustomerId&&window.HiveConfig&&window.HiveConfig.ClientInfo&&(window.HiveConfig.ClientInfo.sc=t.staticCustomerId),"staticPartnerId"in t&&t.staticPartnerId&&window.HiveConfig&&window.HiveConfig.ClientInfo&&(window.HiveConfig.ClientInfo.rc=t.staticPartnerId),"audioMetrics"in t&&!t.audioMetrics&&window.HiveConfig&&window.HiveConfig.Stats&&(window.HiveConfig.Stats.AudioAccounting=t.audioMetrics),"detectPrivateIP"in t&&"boolean"==typeof t.detectPrivateIP&&window.HiveConfig&&window.HiveConfig.ConnInfo&&(window.HiveConfig.ConnInfo.detectPrivateIP=t.detectPrivateIP),"logJsonSnapshots"in t&&t.logJsonSnapshots&&window.HiveConfig&&window.HiveConfig.DebugLogs&&(window.HiveConfig.DebugLogs.MetricSnapshotLogs=1,window.HiveConfig.DebugLogs.TrackSnapshotLogs=1,window.HiveConfig.DebugLogs.TrackerLogs=1)},v);function v(){}i._v=l,"undefined"!=typeof window&&(void 0===window.HiveConfig&&(window.HiveConfig={}),window.HiveConfig.ErrorMonitor=f)},function(n,r,s){var e,h,o;!function(t,i){"use strict";n.exports?n.exports=i(s(18),s(18),s(18)):(h=[s(18),s(18),s(18)],void 0===(o="function"==typeof (e=i)?e.apply(r,h):e)||(n.exports=o))}(0,function(o,i,a,n){"use strict";var r=n&&n.Rv;function p(t,i){var n=1<=arguments.length;if(!(this instanceof p))return n?2<=arguments.length?new p(t,i):new p(t):new p();if(void 0===t){if(n)throw new TypeError("undefined is not a valid argument for URI");t="undefined"!=typeof location?location.href+"":""}if(null===t&&n)throw new TypeError("null is not a valid argument for URI");return this.href(t),void 0!==i?this.Pa(i):this}p.version="1.19.2";var t=p.prototype,f=Object.prototype.hasOwnProperty;function u(t){return t.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function h(t){return void 0===t?"Undefined":String(Object.prototype.toString.call(t)).slice(8,-1)}function c(t){return"Array"===h(t)}function l(t,i){var n,r,s={};if("RegExp"===h(i))s=null;else if(c(i))for(n=0,r=i.length;n<r;n++)s[i[n]]=!0;else s[i]=!0;for(n=0,r=t.length;n<r;n++)(s&&void 0!==s[t[n]]||!s&&i.test(t[n]))&&(t.splice(n,1),r--,n--);return t}function v(t,i){var n,r;if(c(i)){for(n=0,r=i.length;n<r;n++)if(!v(t,i[n]))return!1;return!0}var s=h(i);for(n=0,r=t.length;n<r;n++)if("RegExp"===s){if("string"==typeof t[n]&&t[n].match(i))return!0}else if(t[n]===i)return!0;return!1}function d(t,i){if(!c(t)||!c(i))return!1;if(t.length!==i.length)return!1;t.sort(),i.sort();for(var n=0,r=t.length;n<r;n++)if(t[n]!==i[n])return!1;return!0}function E(t){return t.replace(/^\/+|\/+$/g,"")}function s(t){return escape(t)}function e(t){return encodeURIComponent(t).replace(/[!'()*]/g,s).replace(/\*/g,"%2A")}p.Sv=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,Av:null,Iv:p.Iv,Nv:p.Nv,Cv:p.Cv}},p.Iv=!1,p.Nv=!1,p.Cv=!0,p.kv=/^[a-z][a-z0-9.+-]*$/i,p.Dv=/[^a-z0-9\._-]/i,p.jv=/(xn--)/i,p.Mv=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,p.Pv=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,p.Lv=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi,p.Hv={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?«»“”„‘’]+$/,Uv:/(\([^\)]*\)|\[[^\]]*\]|\{[^}]*\}|<[^>]*>)/g},p.Fv={http:"80",Gv:"443",xv:"21",Bv:"70",Vv:"80",qv:"443"},p.Qv=["http","https"],p.Yv=/[^a-zA-Z0-9\.\-:_]/,p.Kv={a:"href",Wv:"cite",link:"href",$v:"href",Xv:"src",form:"action",zv:"src",Jv:"href",Zv:"src",td:"src",source:"src",track:"src",input:"src",nd:"src",video:"src"},p.rd=function(t){if(t&&t.nodeName){var i=t.nodeName.toLowerCase();if("input"!==i||"image"===t.type)return p.Kv[i]}},p.encode=e,p.decode=decodeURIComponent,p.sd=function(){p.encode=escape,p.decode=unescape},p.unicode=function(){p.encode=e,p.decode=decodeURIComponent},p.hd={pathname:{encode:{od:/%(24|26|2B|2C|3B|3D|3A|40)/gi,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{od:/[\/\?#]/g,map:{ud:"%2F",ad:"%3F",fd:"%23"}}},ld:{encode:{od:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/gi,map:{"%3A":":",vd:"/",dd:"?",Ed:"#",wd:"[",pd:"]","%40":"@",gd:"!","%24":"$","%26":"&",bd:"'",yd:"(",Td:")",Od:"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}},md:{encode:{od:/%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/gi,map:{gd:"!","%24":"$",bd:"'",yd:"(",Td:")",Od:"*","%2B":"+","%2C":",","%3B":";","%3D":"=","%40":"@"}},decode:{od:/[\/\?#:]/g,map:{ud:"%2F",ad:"%3F",fd:"%23",Rd:"%3A"}}}},p.Sd=function(t,i){var n=p.encode(t+"");return void 0===i&&(i=p.Cv),i?n.replace(/%20/g,"+"):n},p.Ad=function(i,t){i+="",void 0===t&&(t=p.Cv);try{return p.decode(t?i.replace(/\+/g,"%20"):i)}catch(t){return i}};function w(n,r){return function(i){try{return p[r](i+"").replace(p.hd[n][r].od,function(t){return p.hd[n][r].map[t]})}catch(t){return i}}}var g,b={encode:"encode",decode:"decode"};for(g in b)p[g+"PathSegment"]=w("pathname",b[g]),p[g+"UrnPathSegment"]=w("urnpath",b[g]);function y(e,h,o){return function(t){var i;i=o?function(t){return p[h](p[o](t))}:p[h];for(var n=(t+"").split(e),r=0,s=n.length;r<s;r++)n[r]=i(n[r]);return n.join(e)}}function T(n){return function(t,i){return void 0===t?this.Sv[n]||"":(this.Sv[n]=t||null,this._l(!i),this)}}function O(n,r){return function(t,i){return void 0===t?this.Sv[n]||"":(null!==t&&(t+="").charAt(0)===r&&(t=t.substring(1)),this.Sv[n]=t,this._l(!i),this)}}p.Id=y("/","decodePathSegment"),p.Nd=y(":","decodeUrnPathSegment"),p.Cd=y("/","encodePathSegment","decode"),p.kd=y(":","encodeUrnPathSegment","decode"),p.Dd=w("reserved","encode"),p.parse=function(t,i){var n;return i=i||{Iv:p.Iv},-1<(n=t.indexOf("#"))&&(i.Av=t.substring(n+1)||null,t=t.substring(0,n)),-1<(n=t.indexOf("?"))&&(i.query=t.substring(n+1)||null,t=t.substring(0,n)),"//"===t.substring(0,2)?(i.protocol=null,t=t.substring(2),t=p.jd(t,i)):-1<(n=t.indexOf(":"))&&(i.protocol=t.substring(0,n)||null,i.protocol&&!i.protocol.match(p.kv)?i.protocol=void 0:"//"===t.substring(n+1,n+3)?(t=t.substring(n+3),t=p.jd(t,i)):(t=t.substring(n+1),i.urn=!0)),i.path=t,i},p.Md=function(t,i){var n,r,s=(t=(t=t||"").replace(/\\/g,"/")).indexOf("/");if(-1===s&&(s=t.length),"["===t.charAt(0))n=t.indexOf("]"),i.hostname=t.substring(1,n)||null,i.port=t.substring(n+2,s)||null,"/"===i.port&&(i.port=null);else{var e=t.indexOf(":"),h=t.indexOf("/"),o=t.indexOf(":",e+1);-1!==o&&(-1===h||o<h)?(i.hostname=t.substring(0,s)||null,i.port=null):(r=t.substring(0,s).split(":"),i.hostname=r[0]||null,i.port=r[1]||null)}return i.hostname&&"/"!==t.substring(s).charAt(0)&&(s++,t="/"+t),i.Iv&&p.Pd(i.hostname,i.protocol),i.port&&p.Ld(i.port),t.substring(s)||"/"},p.jd=function(t,i){return t=p.Hd(t,i),p.Md(t,i)},p.Hd=function(t,i){var n,r=t.indexOf("/"),s=t.lastIndexOf("@",-1<r?r:t.length-1);return-1<s&&(-1===r||s<r)?(n=t.substring(0,s).split(":"),i.username=n[0]?p.decode(n[0]):null,n.shift(),i.password=n[0]?p.decode(n.join(":")):null,t=t.substring(s+1)):(i.username=null,i.password=null),t},p.Ud=function(t,i){if(!t)return{};if(!(t=t.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,"")))return{};for(var n,r,s,e={},h=t.split("&"),o=h.length,u=0;u<o;u++)n=h[u].split("="),r=p.Ad(n.shift(),i),s=n.length?p.Ad(n.join("="),i):null,f.call(e,r)?("string"!=typeof e[r]&&null!==e[r]||(e[r]=[e[r]]),e[r].push(s)):e[r]=s;return e},p._l=function(t){var i="",n=!1;return t.protocol&&(i+=t.protocol+":"),t.urn||!i&&!t.hostname||(i+="//",n=!0),i+=p.Fd(t)||"","string"==typeof t.path&&("/"!==t.path.charAt(0)&&n&&(i+="/"),i+=t.path),"string"==typeof t.query&&t.query&&(i+="?"+t.query),"string"==typeof t.Av&&t.Av&&(i+="#"+t.Av),i},p.Gd=function(t){var i="";return t.hostname?(p.Pv.test(t.hostname)?i+="["+t.hostname+"]":i+=t.hostname,t.port&&(i+=":"+t.port),i):""},p.Fd=function(t){return p.xd(t)+p.Gd(t)},p.xd=function(t){var i="";return t.username&&(i+=p.encode(t.username)),t.password&&(i+=":"+p.encode(t.password)),i&&(i+="@"),i},p.Bd=function(t,i,n){var r,s,e,h,o="";for(s in t)if(f.call(t,s))if(c(t[s]))for(r={},e=0,h=t[s].length;e<h;e++)void 0!==t[s][e]&&void 0===r[t[s][e]+""]&&(o+="&"+p.Vd(s,t[s][e],n),!0!==i&&(r[t[s][e]+""]=!0));else void 0!==t[s]&&(o+="&"+p.Vd(s,t[s],n));return o.substring(1)},p.Vd=function(t,i,n){return p.Sd(t,n)+(null!==i?"="+p.Sd(i,n):"")},p.qd=function(t,i,n){if("object"==typeof i)for(var r in i)f.call(i,r)&&p.qd(t,r,i[r]);else{if("string"!=typeof i)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");if(void 0===t[i])return void (t[i]=n);"string"==typeof t[i]&&(t[i]=[t[i]]),c(n)||(n=[n]),t[i]=(t[i]||[]).concat(n)}},p.Qd=function(t,i,n){if("object"==typeof i)for(var r in i)f.call(i,r)&&p.Qd(t,r,i[r]);else{if("string"!=typeof i)throw new TypeError("URI.setQuery() accepts an object, string as the name parameter");t[i]=void 0===n?null:n}},p.Yd=function(t,i,n){var r,s,e;if(c(i))for(r=0,s=i.length;r<s;r++)t[i[r]]=void 0;else if("RegExp"===h(i))for(e in t)i.test(e)&&(t[e]=void 0);else if("object"==typeof i)for(e in i)f.call(i,e)&&p.Yd(t,e,i[e]);else{if("string"!=typeof i)throw new TypeError("URI.removeQuery() accepts an object, string, RegExp as the first parameter");void 0!==n?"RegExp"===h(n)?!c(t[i])&&n.test(t[i])?t[i]=void 0:t[i]=l(t[i],n):t[i]!==String(n)||c(n)&&1!==n.length?c(t[i])&&(t[i]=l(t[i],n)):t[i]=void 0:t[i]=void 0}},p.Kd=function(t,i,n,r){switch(h(i)){case"String":break;case"RegExp":for(var s in t)if(f.call(t,s)&&i.test(s)&&(void 0===n||p.Kd(t,s,n)))return!0;return!1;case"Object":for(var e in i)if(f.call(i,e)&&!p.Kd(t,e,i[e]))return!1;return!0;default:throw new TypeError("URI.hasQuery() accepts a string, regular expression or object as the name parameter")}switch(h(n)){case"Undefined":return i in t;case"Boolean":return n===Boolean(c(t[i])?t[i].length:t[i]);case"Function":return!!n(t[i],i,t);case"Array":return!!c(t[i])&&(r?v:d)(t[i],n);case"RegExp":return c(t[i])?!!r&&v(t[i],n):Boolean(t[i]&&t[i].match(n));case"Number":n=String(n);case"String":return c(t[i])?!!r&&v(t[i],n):t[i]===n;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}},p.Wd=function(){for(var t=[],i=[],n=0,r=0;r<arguments.length;r++){var s=new p(arguments[r]);t.push(s);for(var e=s.$d(),h=0;h<e.length;h++)"string"==typeof e[h]&&i.push(e[h]),e[h]&&n++}if(!i.length||!n)return new p("");var o=new p("").$d(i);return""!==t[0].path()&&"/"!==t[0].path().slice(0,1)||o.path("/"+o.path()),o.normalize()},p.Xd=function(t,i){var n,r=Math.min(t.length,i.length);for(n=0;n<r;n++)if(t.charAt(n)!==i.charAt(n)){n--;break}return n<1?t.charAt(0)===i.charAt(0)&&"/"===t.charAt(0)?"/":"":("/"===t.charAt(n)&&"/"===i.charAt(n)||(n=t.substring(0,n).lastIndexOf("/")),t.substring(0,n+1))},p.zd=function(t,i,n){var r=(n=n||{}).start||p.Hv.start,s=n.end||p.Hv.end,e=n.trim||p.Hv.trim,h=n.Uv||p.Hv.Uv,o=/[a-z0-9-]=["']?$/i;for(r.lastIndex=0;;){var u=r.exec(t);if(!u)break;var a=u.index;if(n.Jd){var f=t.slice(Math.max(a-3,0),a);if(f&&o.test(f))continue}for(var c=a+t.slice(a).search(s),l=t.slice(a,c),v=-1;;){var d=h.exec(l);if(!d)break;var E=d.index+d[0].length;v=Math.max(v,E)}if(!((l=-1<v?l.slice(0,v)+l.slice(v).replace(e,""):l.replace(e,"")).length<=u[0].length||n.Zd&&n.Zd.test(l))){var w=i(l,a,c=a+l.length,t);void 0!==w?(w=String(w),t=t.slice(0,a)+w+t.slice(c),r.lastIndex=a+w.length):r.lastIndex=c}}return r.lastIndex=0,t},p.Pd=function(t,i){var n=!!t,r=!1;if(!!i&&(r=v(p.Qv,i)),r&&!n)throw new TypeError("Hostname cannot be empty, if protocol is "+i);if(t&&t.match(p.Yv)){if(!o)throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-:_] and Punycode.js is not available');if(o.tE(t).match(p.Yv))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-:_]')}},p.Ld=function(t){if(t){var i=Number(t);if(!(function(t){return/^[0-9]+$/.test(t)}(i)&&0<i&&i<65536))throw new TypeError('Port "'+t+'" is not a valid port')}},p.Ph=function(t){if(t){var i={Rv:this.Ph()};return n.iE&&"function"==typeof n.iE.Ph&&(i.iE=n.iE.Ph()),n.nE&&"function"==typeof n.nE.Ph&&(i.nE=n.nE.Ph()),n.rE&&"function"==typeof n.rE.Ph&&(i.rE=n.rE.Ph()),i}return n.Rv===this&&(n.Rv=r),this},t._l=function(t){return!0===t?this.sE=!0:void 0!==t&&!this.sE||(this.eE=p._l(this.Sv),this.sE=!1),this},t.clone=function(){return new p(this)},t.valueOf=t.toString=function(){return this._l(!1).eE},t.protocol=T("protocol"),t.username=T("username"),t.password=T("password"),t.hostname=T("hostname"),t.port=T("port"),t.query=O("query","?"),t.Av=O("fragment","#"),t.search=function(t,i){var n=this.query(t,i);return"string"==typeof n&&n.length?"?"+n:n},t.hash=function(t,i){var n=this.Av(t,i);return"string"==typeof n&&n.length?"#"+n:n},t.pathname=function(t,i){if(void 0!==t&&!0!==t)return this.Sv.urn?this.Sv.path=t?p.kd(t):"":this.Sv.path=t?p.Cd(t):"/",this._l(!i),this;var n=this.Sv.path||(this.Sv.hostname?"/":"");return t?(this.Sv.urn?p.Nd:p.Id)(n):n},t.path=t.pathname,t.href=function(t,i){var n;if(void 0===t)return this.toString();this.eE="",this.Sv=p.Sv();var r=t instanceof p,s="object"==typeof t&&(t.hostname||t.path||t.pathname);t.nodeName&&(t=t[p.rd(t)]||"",s=!1);if(!r&&s&&void 0!==t.pathname&&(t=t.toString()),"string"==typeof t||t instanceof String)this.Sv=p.parse(String(t),this.Sv);else{if(!r&&!s)throw new TypeError("invalid input");var e=r?t.Sv:t;for(n in e)"query"!==n&&f.call(this.Sv,n)&&(this.Sv[n]=e[n]);e.query&&this.query(e.query,!1)}return this._l(!i),this},t.is=function(t){var i=!1,n=!1,r=!1,s=!1,e=!1,h=!1,o=!1,u=!this.Sv.urn;switch(this.Sv.hostname&&(u=!1,n=p.Mv.test(this.Sv.hostname),r=p.Pv.test(this.Sv.hostname),e=(s=!(i=n||r))&&a&&a.has(this.Sv.hostname),h=s&&p.Dv.test(this.Sv.hostname),o=s&&p.jv.test(this.Sv.hostname)),t.toLowerCase()){case"relative":return u;case"absolute":return!u;case"domain":case"name":return s;case"sld":return e;case"ip":return i;case"ip4":case"ipv4":case"inet4":return n;case"ip6":case"ipv6":case"inet6":return r;case"idn":return h;case"url":return!this.Sv.urn;case"urn":return!!this.Sv.urn;case"punycode":return o}return null};var m=t.protocol,_=t.port,R=t.hostname;t.protocol=function(t,i){if(t&&!(t=t.replace(/:(\/\/)?$/,"")).match(p.kv))throw new TypeError('Protocol "'+t+"\" contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]");return m.call(this,t,i)},t.scheme=t.protocol,t.port=function(t,i){return this.Sv.urn?void 0===t?"":this:(void 0!==t&&(0===t&&(t=null),t&&(":"===(t+="").charAt(0)&&(t=t.substring(1)),p.Ld(t))),_.call(this,t,i))},t.hostname=function(t,i){if(this.Sv.urn)return void 0===t?"":this;if(void 0!==t){var n={Iv:this.Sv.Iv};if("/"!==p.Md(t,n))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-]');t=n.hostname,this.Sv.Iv&&p.Pd(t,this.Sv.protocol)}return R.call(this,t,i)},t.origin=function(t,i){if(this.Sv.urn)return void 0===t?"":this;if(void 0===t){var n=this.protocol();return this.hE()?(n?n+"://":"")+this.hE():""}var r=p(t);return this.protocol(r.protocol()).hE(r.hE())._l(!i),this},t.host=function(t,i){if(this.Sv.urn)return void 0===t?"":this;if(void 0===t)return this.Sv.hostname?p.Gd(this.Sv):"";if("/"!==p.Md(t,this.Sv))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-]');return this._l(!i),this},t.hE=function(t,i){if(this.Sv.urn)return void 0===t?"":this;if(void 0===t)return this.Sv.hostname?p.Fd(this.Sv):"";if("/"!==p.jd(t,this.Sv))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-]');return this._l(!i),this},t.oE=function(t,i){if(this.Sv.urn)return void 0===t?"":this;if(void 0!==t)return"@"!==t[t.length-1]&&(t+="@"),p.Hd(t,this.Sv),this._l(!i),this;var n=p.xd(this.Sv);return n?n.substring(0,n.length-1):n},t.uE=function(t,i){var n;return void 0===t?this.path()+this.search()+this.hash():(n=p.parse(t),this.Sv.path=n.path,this.Sv.query=n.query,this.Sv.Av=n.Av,this._l(!i),this)},t.aE=function(t,i){if(this.Sv.urn)return void 0===t?"":this;if(void 0===t){if(!this.Sv.hostname||this.is("IP"))return"";var n=this.Sv.hostname.length-this.domain().length-1;return this.Sv.hostname.substring(0,n)||""}var r=this.Sv.hostname.length-this.domain().length,s=this.Sv.hostname.substring(0,r),e=new RegExp("^"+u(s));if(t&&"."!==t.charAt(t.length-1)&&(t+="."),-1!==t.indexOf(":"))throw new TypeError("Domains cannot contain colons");return t&&p.Pd(t,this.Sv.protocol),this.Sv.hostname=this.Sv.hostname.replace(e,t),this._l(!i),this},t.domain=function(t,i){if(this.Sv.urn)return void 0===t?"":this;if("boolean"==typeof t&&(i=t,t=void 0),void 0===t){if(!this.Sv.hostname||this.is("IP"))return"";var n=this.Sv.hostname.match(/\./g);if(n&&n.length<2)return this.Sv.hostname;var r=this.Sv.hostname.length-this.fE(i).length-1;return r=this.Sv.hostname.lastIndexOf(".",r-1)+1,this.Sv.hostname.substring(r)||""}if(!t)throw new TypeError("cannot set domain empty");if(-1!==t.indexOf(":"))throw new TypeError("Domains cannot contain colons");if(p.Pd(t,this.Sv.protocol),!this.Sv.hostname||this.is("IP"))this.Sv.hostname=t;else{var s=new RegExp(u(this.domain())+"$");this.Sv.hostname=this.Sv.hostname.replace(s,t)}return this._l(!i),this},t.fE=function(t,i){if(this.Sv.urn)return void 0===t?"":this;if("boolean"==typeof t&&(i=t,t=void 0),void 0===t){if(!this.Sv.hostname||this.is("IP"))return"";var n=this.Sv.hostname.lastIndexOf("."),r=this.Sv.hostname.substring(n+1);return!0!==i&&a&&a.list[r.toLowerCase()]&&a.get(this.Sv.hostname)||r}var s;if(!t)throw new TypeError("cannot set TLD empty");if(t.match(/[^a-zA-Z0-9-]/)){if(!a||!a.is(t))throw new TypeError('TLD "'+t+'" contains characters other than [A-Z0-9]');s=new RegExp(u(this.fE())+"$"),this.Sv.hostname=this.Sv.hostname.replace(s,t)}else{if(!this.Sv.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");s=new RegExp(u(this.fE())+"$"),this.Sv.hostname=this.Sv.hostname.replace(s,t)}return this._l(!i),this},t.cE=function(t,i){if(this.Sv.urn)return void 0===t?"":this;if(void 0===t||!0===t){if(!this.Sv.path&&!this.Sv.hostname)return"";if("/"===this.Sv.path)return"/";var n=this.Sv.path.length-this.filename().length-1,r=this.Sv.path.substring(0,n)||(this.Sv.hostname?"/":"");return t?p.Id(r):r}var s=this.Sv.path.length-this.filename().length,e=this.Sv.path.substring(0,s),h=new RegExp("^"+u(e));return this.is("relative")||"/"!==(t=t||"/").charAt(0)&&(t="/"+t),t&&"/"!==t.charAt(t.length-1)&&(t+="/"),t=p.Cd(t),this.Sv.path=this.Sv.path.replace(h,t),this._l(!i),this},t.filename=function(t,i){if(this.Sv.urn)return void 0===t?"":this;if("string"!=typeof t){if(!this.Sv.path||"/"===this.Sv.path)return"";var n=this.Sv.path.lastIndexOf("/"),r=this.Sv.path.substring(n+1);return t?p.lE(r):r}var s=!1;"/"===t.charAt(0)&&(t=t.substring(1)),t.match(/\.?\//)&&(s=!0);var e=new RegExp(u(this.filename())+"$");return t=p.Cd(t),this.Sv.path=this.Sv.path.replace(e,t),s?this.vE(i):this._l(!i),this},t.suffix=function(t,i){if(this.Sv.urn)return void 0===t?"":this;if(void 0===t||!0===t){if(!this.Sv.path||"/"===this.Sv.path)return"";var n,r,s=this.filename(),e=s.lastIndexOf(".");return-1===e?"":(n=s.substring(e+1),r=/^[a-z0-9%]+$/i.test(n)?n:"",t?p.lE(r):r)}"."===t.charAt(0)&&(t=t.substring(1));var h,o=this.suffix();if(o)h=t?new RegExp(u(o)+"$"):new RegExp(u("."+o)+"$");else{if(!t)return this;this.Sv.path+="."+p.Cd(t)}return h&&(t=p.Cd(t),this.Sv.path=this.Sv.path.replace(h,t)),this._l(!i),this},t.$d=function(t,i,n){var r=this.Sv.urn?":":"/",s=this.path(),e="/"===s.substring(0,1),h=s.split(r);if(void 0!==t&&"number"!=typeof t&&(n=i,i=t,t=void 0),void 0!==t&&"number"!=typeof t)throw new Error('Bad segment "'+t+'", must be 0-based integer');if(e&&h.shift(),t<0&&(t=Math.max(h.length+t,0)),void 0===i)return void 0===t?h:h[t];if(null===t||void 0===h[t])if(c(i)){h=[];for(var o=0,u=i.length;o<u;o++)(i[o].length||h.length&&h[h.length-1].length)&&(h.length&&!h[h.length-1].length&&h.pop(),h.push(E(i[o])))}else!i&&"string"!=typeof i||(i=E(i),""===h[h.length-1]?h[h.length-1]=i:h.push(i));else i?h[t]=E(i):h.splice(t,1);return e&&h.unshift(""),this.path(h.join(r),n)},t.dE=function(t,i,n){var r,s,e;if("number"!=typeof t&&(n=i,i=t,t=void 0),void 0===i){if(c(r=this.$d(t,i,n)))for(s=0,e=r.length;s<e;s++)r[s]=p.decode(r[s]);else r=void 0!==r?p.decode(r):void 0;return r}if(c(i))for(s=0,e=i.length;s<e;s++)i[s]=p.encode(i[s]);else i="string"==typeof i||i instanceof String?p.encode(i):i;return this.$d(t,i,n)};var S=t.query;return t.query=function(t,i){if(!0===t)return p.Ud(this.Sv.query,this.Sv.Cv);if("function"!=typeof t)return void 0!==t&&"string"!=typeof t?(this.Sv.query=p.Bd(t,this.Sv.Nv,this.Sv.Cv),this._l(!i),this):S.call(this,t,i);var n=p.Ud(this.Sv.query,this.Sv.Cv),r=t.call(this,n);return this.Sv.query=p.Bd(r||n,this.Sv.Nv,this.Sv.Cv),this._l(!i),this},t.Qd=function(t,i,n){var r=p.Ud(this.Sv.query,this.Sv.Cv);if("string"==typeof t||t instanceof String)r[t]=void 0!==i?i:null;else{if("object"!=typeof t)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");for(var s in t)f.call(t,s)&&(r[s]=t[s])}return this.Sv.query=p.Bd(r,this.Sv.Nv,this.Sv.Cv),"string"!=typeof t&&(n=i),this._l(!n),this},t.qd=function(t,i,n){var r=p.Ud(this.Sv.query,this.Sv.Cv);return p.qd(r,t,void 0===i?null:i),this.Sv.query=p.Bd(r,this.Sv.Nv,this.Sv.Cv),"string"!=typeof t&&(n=i),this._l(!n),this},t.Yd=function(t,i,n){var r=p.Ud(this.Sv.query,this.Sv.Cv);return p.Yd(r,t,i),this.Sv.query=p.Bd(r,this.Sv.Nv,this.Sv.Cv),"string"!=typeof t&&(n=i),this._l(!n),this},t.Kd=function(t,i,n){var r=p.Ud(this.Sv.query,this.Sv.Cv);return p.Kd(r,t,i,n)},t.EE=t.Qd,t.wE=t.qd,t.pE=t.Yd,t.gE=t.Kd,t.normalize=function(){return this.Sv.urn?this.TE(!1).vE(!1).yE(!1).bE(!1)._l():this.TE(!1).mE(!1).OE(!1).vE(!1).yE(!1).bE(!1)._l()},t.TE=function(t){return"string"==typeof this.Sv.protocol&&(this.Sv.protocol=this.Sv.protocol.toLowerCase(),this._l(!t)),this},t.mE=function(t){return this.Sv.hostname&&(this.is("IDN")&&o?this.Sv.hostname=o.tE(this.Sv.hostname):this.is("IPv6")&&i&&(this.Sv.hostname=i._E(this.Sv.hostname)),this.Sv.hostname=this.Sv.hostname.toLowerCase(),this._l(!t)),this},t.OE=function(t){return"string"==typeof this.Sv.protocol&&this.Sv.port===p.Fv[this.Sv.protocol]&&(this.Sv.port=null,this._l(!t)),this},t.vE=function(t){var i,n=this.Sv.path;if(!n)return this;if(this.Sv.urn)return this.Sv.path=p.kd(this.Sv.path),this._l(!t),this;if("/"===this.Sv.path)return this;var r,s,e="";for("/"!==(n=p.Cd(n)).charAt(0)&&(i=!0,n="/"+n),"/.."!==n.slice(-3)&&"/."!==n.slice(-2)||(n+="/"),n=n.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),i&&(e=(e=n.substring(1).match(/^(\.\.\/)+/)||"")&&e[0]);-1!==(r=n.search(/\/\.\.(\/|$)/));)n=0!==r?(-1===(s=n.substring(0,r).lastIndexOf("/"))&&(s=r),n.substring(0,s)+n.substring(r+3)):n.substring(3);return i&&this.is("relative")&&(n=e+n.substring(1)),this.Sv.path=n,this._l(!t),this},t.RE=t.vE,t.yE=function(t){return"string"==typeof this.Sv.query&&(this.Sv.query.length?this.query(p.Ud(this.Sv.query,this.Sv.Cv)):this.Sv.query=null,this._l(!t)),this},t.bE=function(t){return this.Sv.Av||(this.Sv.Av=null,this._l(!t)),this},t.SE=t.yE,t.AE=t.bE,t.sd=function(){var t=p.encode,i=p.decode;p.encode=escape,p.decode=decodeURIComponent;try{this.normalize()}finally{p.encode=t,p.decode=i}return this},t.unicode=function(){var t=p.encode,i=p.decode;p.encode=e,p.decode=unescape;try{this.normalize()}finally{p.encode=t,p.decode=i}return this},t.readable=function(){var t=this.clone();t.username("").password("").normalize();var i="";if(t.Sv.protocol&&(i+=t.Sv.protocol+"://"),t.Sv.hostname&&(t.is("punycode")&&o?(i+=o.IE(t.Sv.hostname),t.Sv.port&&(i+=":"+t.Sv.port)):i+=t.host()),t.Sv.hostname&&t.Sv.path&&"/"!==t.Sv.path.charAt(0)&&(i+="/"),i+=t.path(!0),t.Sv.query){for(var n="",r=0,s=t.Sv.query.split("&"),e=s.length;r<e;r++){var h=(s[r]||"").split("=");n+="&"+p.Ad(h[0],this.Sv.Cv).replace(/&/g,"%26"),void 0!==h[1]&&(n+="="+p.Ad(h[1],this.Sv.Cv).replace(/&/g,"%26"))}i+="?"+n.substring(1)}return i+=p.Ad(t.hash(),!0)},t.Pa=function(t){var i,n,r,s=this.clone(),e=["protocol","username","password","hostname","port"];if(this.Sv.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(t instanceof p||(t=new p(t)),s.Sv.protocol)return s;if(s.Sv.protocol=t.Sv.protocol,this.Sv.hostname)return s;for(n=0;r=e[n];n++)s.Sv[r]=t.Sv[r];return s.Sv.path?(".."===s.Sv.path.substring(-2)&&(s.Sv.path+="/"),"/"!==s.path().charAt(0)&&(i=(i=t.cE())||(0===t.path().indexOf("/")?"/":""),s.Sv.path=(i?i+"/":"")+s.Sv.path,s.vE())):(s.Sv.path=t.Sv.path,s.Sv.query||(s.Sv.query=t.Sv.query)),s._l(),s},t.NE=function(t){var i,n,r,s,e,h=this.clone().normalize();if(h.Sv.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(t=new p(t).normalize(),i=h.Sv,n=t.Sv,s=h.path(),e=t.path(),"/"!==s.charAt(0))throw new Error("URI is already relative");if("/"!==e.charAt(0))throw new Error("Cannot calculate a URI relative to another relative URI");if(i.protocol===n.protocol&&(i.protocol=null),i.username!==n.username||i.password!==n.password)return h._l();if(null!==i.protocol||null!==i.username||null!==i.password)return h._l();if(i.hostname!==n.hostname||i.port!==n.port)return h._l();if(i.hostname=null,i.port=null,s===e)return i.path="",h._l();if(!(r=p.Xd(s,e)))return h._l();var o=n.path.substring(r.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../");return i.path=o+i.path.substring(r.length)||"./",h._l()},t.equals=function(t){var i,n,r,s,e,h=this.clone(),o=new p(t),u={};if(h.normalize(),o.normalize(),h.toString()===o.toString())return!0;if(r=h.query(),s=o.query(),h.query(""),o.query(""),h.toString()!==o.toString())return!1;if(r.length!==s.length)return!1;for(e in i=p.Ud(r,this.Sv.Cv),n=p.Ud(s,this.Sv.Cv),i)if(f.call(i,e)){if(c(i[e])){if(!d(i[e],n[e]))return!1}else if(i[e]!==n[e])return!1;u[e]=!0}for(e in n)if(f.call(n,e)&&!u[e])return!1;return!0},t.Iv=function(t){return this.Sv.Iv=!!t,this},t.Nv=function(t){return this.Sv.Nv=!!t,this},t.Cv=function(t){return this.Sv.Cv=!!t,this},p})},function(module,exports,__webpack_require__){var Thrift={CE:"0.9.3",Type:{STOP:0,VOID:1,BOOL:2,BYTE:3,I08:3,DOUBLE:4,I16:6,I32:8,I64:10,STRING:11,UTF7:11,STRUCT:12,MAP:13,SET:14,LIST:15,UTF8:16,UTF16:17},ra:{CALL:1,REPLY:2,EXCEPTION:3,ONEWAY:4},kE:function(t){var i=0;for(var n in t)t.hasOwnProperty(n)&&i++;return i},DE:function(t,i,n){function r(){}r.prototype=i.prototype,t.prototype=new r(),t.prototype.name=n||""}},copyList,copyMap;Thrift.jE=function(t){this.message=t},Thrift.DE(Thrift.jE,Error,"TException"),Thrift.jE.prototype.ME=function(){return this.message},Thrift.PE={LE:0,HE:1,UE:2,FE:3,GE:4,xE:5,BE:6,VE:7,qE:8,QE:9,YE:10},Thrift.KE=function(t,i){this.message=t,this.code="number"==typeof i?i:0},Thrift.DE(Thrift.KE,Thrift.jE,"TApplicationException"),Thrift.KE.prototype.read=function(t){for(;;){var i=t.WE();if(i.ftype==Thrift.Type.STOP)break;switch(i.fid){case 1:i.ftype==Thrift.Type.STRING?(i=t.$E(),this.message=i.value):i=t.XE(i.ftype);break;case 2:i.ftype==Thrift.Type.I32?(i=t.zE(),this.code=i.value):i=t.XE(i.ftype);break;default:i=t.XE(i.ftype)}t.JE()}t.ZE()},Thrift.KE.prototype.write=function(t){t.tw("TApplicationException"),this.message&&(t.iw("message",Thrift.Type.STRING,1),t.nw(this.ME()),t.rw()),this.code&&(t.iw("type",Thrift.Type.I32,2),t.sw(this.code),t.rw()),t.ew(),t.hw()},Thrift.KE.prototype.ow=function(){return this.code},Thrift.ju=Thrift.ca=function(t,i){this.url=t,this.uw=0,this.aw=0,this.fw=i&&i.fw,this.cw="",this.lw=""},Thrift.ca.prototype={vw:function(){try{return new XMLHttpRequest()}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}throw"Your browser doesn't support XHR."},flush:function(t,i){var n=this;if(t&&!i||void 0===this.url||""===this.url)return this.cw;var r,s=this.vw();if(s.overrideMimeType&&s.overrideMimeType("application/vnd.apache.thrift.json; charset=utf-8"),i&&(s.onreadystatechange=(r=i,function(){4==this.readyState&&200==this.status&&(n.ua(this.responseText),r())})),s.open("POST",this.url,!!t),s.setRequestHeader&&(s.setRequestHeader("Accept","application/vnd.apache.thrift.json; charset=utf-8"),s.setRequestHeader("Content-Type","application/vnd.apache.thrift.json; charset=utf-8")),s.send(this.cw),!t||!i){if(4!=s.readyState)throw"encountered an unknown ajax ready state: "+s.readyState;if(200!=s.status)throw"encountered a unknown request status: "+s.status;this.lw=s.responseText,this.dw=this.lw.length,this.uw=this.lw.length,this.aw=0}},Ew:function(i,t,n,r){if("undefined"==typeof jQuery||void 0===jQuery.ww)throw"Thrift.js requires jQuery 1.5+ to use asynchronous requests";var s=this;return jQuery.pw({url:this.url,data:t,type:"POST",gw:!1,contentType:"application/vnd.apache.thrift.json; charset=utf-8",bw:"text thrift",yw:{Tw:function(t){return s.ua(t),r.call(i)}},context:i,success:jQuery.Ow(n).pop()})},ua:function(t){this.lw=t,this.dw=this.lw.length,this.uw=this.lw.length,this.aw=0},isOpen:function(){return!0},open:function(){},close:function(){},read:function(t){var i=this.uw-this.aw;if(0==i)return"";var n=t;i<t&&(n=i);var r=this._w.substr(this.aw,n);return this.aw+=n,r},Rw:function(){return this.lw},write:function(t){this.cw=t},ea:function(){return this.cw}},Thrift.Sw=function(t){this.Aw(t)},Thrift.Sw.prototype={Aw:function(t){this.url=t,this.Iw=null,this.callbacks=[],this.Nw=[],this.cw="",this.lw="",this.Cw=0,this.kw=0},flush:function(t,i){var n,r=this;this.isOpen()?(this.Iw.send(this.cw),this.callbacks.push((n=i,function(t){r.ua(t),n()}))):this.Nw.push({Dw:this.cw,jw:i})},Mw:function(){var n=this;0<this.Nw.length&&(this.Nw.forEach(function(t){var i;this.Iw.send(t.Dw),this.callbacks.push((i=t.jw,function(t){n.ua(t),i()}))}),this.Nw=[])},Pw:function(t){this.Aw(this.url)},Lw:function(t){this.callbacks.length&&this.callbacks.shift()(t.data)},Hw:function(t){!1,this.Iw.close()},ua:function(t){this.lw=t,this.dw=this.lw.length,this.uw=this.lw.length,this.aw=0},isOpen:function(){return this.Iw&&this.Iw.readyState==this.Iw.OPEN},open:function(){this.Iw&&this.Iw.readyState!=this.Iw.CLOSED||(this.Iw=new WebSocket(this.url),this.Iw.onopen=this.Mw.bind(this),this.Iw.onmessage=this.Lw.bind(this),this.Iw.onerror=this.Hw.bind(this),this.Iw.onclose=this.Pw.bind(this))},close:function(){this.Iw.close()},read:function(t){var i=this.uw-this.aw;if(0==i)return"";var n=t;i<t&&(n=i);var r=this._w.substr(this.aw,n);return this.aw+=n,r},Rw:function(){return this.lw},write:function(t){this.cw=t},ea:function(){return this.cw}},Thrift.la=Thrift.Uw=function(t){this.Fw=[],this.Gw=[],this.transport=t},Thrift.Uw.Type={},Thrift.Uw.Type[Thrift.Type.BOOL]='"tf"',Thrift.Uw.Type[Thrift.Type.BYTE]='"i8"',Thrift.Uw.Type[Thrift.Type.I16]='"i16"',Thrift.Uw.Type[Thrift.Type.I32]='"i32"',Thrift.Uw.Type[Thrift.Type.I64]='"i64"',Thrift.Uw.Type[Thrift.Type.DOUBLE]='"dbl"',Thrift.Uw.Type[Thrift.Type.STRUCT]='"rec"',Thrift.Uw.Type[Thrift.Type.STRING]='"str"',Thrift.Uw.Type[Thrift.Type.MAP]='"map"',Thrift.Uw.Type[Thrift.Type.LIST]='"lst"',Thrift.Uw.Type[Thrift.Type.SET]='"set"',Thrift.Uw.xw={},Thrift.Uw.xw.tf=Thrift.Type.BOOL,Thrift.Uw.xw.i8=Thrift.Type.BYTE,Thrift.Uw.xw.i16=Thrift.Type.I16,Thrift.Uw.xw.i32=Thrift.Type.I32,Thrift.Uw.xw.i64=Thrift.Type.I64,Thrift.Uw.xw.dbl=Thrift.Type.DOUBLE,Thrift.Uw.xw.rec=Thrift.Type.STRUCT,Thrift.Uw.xw.str=Thrift.Type.STRING,Thrift.Uw.xw.map=Thrift.Type.MAP,Thrift.Uw.xw.lst=Thrift.Type.LIST,Thrift.Uw.xw.set=Thrift.Type.SET,Thrift.Uw.CE=1,Thrift.Uw.prototype={Bw:function(){return this.transport},na:function(t,i,n){this.Fw=[],this.Gw=[],this.Fw.push([Thrift.Uw.CE,'"'+t+'"',i,n])},sa:function(){var t=this.Fw.pop();this.Vw=this.Fw.pop(),this.Vw.push(t),this.qw="["+this.Vw.join(",")+"]",this.transport.write(this.qw)},tw:function(t){this.Gw.push(this.Fw.length),this.Fw.push({})},hw:function(){var t=this.Gw.pop(),i=this.Fw[t],n="{",r=!0;for(var s in i)r?r=!1:n+=",",n+=s+":"+i[s];n+="}",this.Fw[t]=n},iw:function(t,i,n){this.Gw.push(this.Fw.length),this.Fw.push({Qw:'"'+n+'"',Yw:Thrift.Uw.Type[i]})},rw:function(){var t=this.Fw.pop(),i=this.Fw.pop();this.Fw[this.Fw.length-1][i.Qw]="{"+i.Yw+":"+t+"}",this.Gw.pop()},ew:function(){},Kw:function(t,i,n){this.Gw.push(this.Fw.length),this.Fw.push([Thrift.Uw.Type[t],Thrift.Uw.Type[i],0])},Ww:function(){var t=this.Gw.pop();if(t!=this.Fw.length){(this.Fw.length-t-1)%2!=0&&this.Fw.push("");var i=(this.Fw.length-t-1)/2;this.Fw[t][this.Fw[t].length-1]=i;for(var n="}",r=!0;this.Fw.length>t+1;){var s=this.Fw.pop(),e=this.Fw.pop();r?r=!1:n=","+n,isNaN(e)||(e='"'+e+'"'),n=e+":"+s+n}n="{"+n,this.Fw[t].push(n),this.Fw[t]="["+this.Fw[t].join(",")+"]"}},$w:function(t,i){this.Gw.push(this.Fw.length),this.Fw.push([Thrift.Uw.Type[t],i])},Xw:function(){for(var t=this.Gw.pop();this.Fw.length>t+1;){var i=this.Fw[t+1];this.Fw.splice(t+1,1),this.Fw[t].push(i)}this.Fw[t]="["+this.Fw[t].join(",")+"]"},zw:function(t,i){this.Gw.push(this.Fw.length),this.Fw.push([Thrift.Uw.Type[t],i])},Jw:function(){for(var t=this.Gw.pop();this.Fw.length>t+1;){var i=this.Fw[t+1];this.Fw.splice(t+1,1),this.Fw[t].push(i)}this.Fw[t]="["+this.Fw[t].join(",")+"]"},Zw:function(t){this.Fw.push(t?1:0)},tp:function(t){this.Fw.push(t)},np:function(t){this.Fw.push(t)},sw:function(t){this.Fw.push(t)},rp:function(t){this.Fw.push(t)},sp:function(t){this.Fw.push(t)},nw:function(t){if(null===t)this.Fw.push(null);else{for(var i="",n=0;n<t.length;n++){var r=t.charAt(n);i+='"'===r?'\\"':"\\"===r?"\\\\":"\b"===r?"\\b":"\f"===r?"\\f":"\n"===r?"\\n":"\r"===r?"\\r":"\t"===r?"\\t":r}this.Fw.push('"'+i+'"')}},ep:function(t){this.nw(t)},aa:function(){this.hp=[],this.aw=[],"undefined"!=typeof JSON&&"function"==typeof JSON.parse?this.op=JSON.parse(this.transport.Rw()):"undefined"!=typeof jQuery?this.op=jQuery.up(this.transport.Rw()):this.op=eval(this.transport.Rw());var r={},version=this.op.shift();if(version!=Thrift.Uw.CE)throw"Wrong thrift protocol version: "+version;return r.fname=this.op.shift(),r.ap=this.op.shift(),r.fp=this.op.shift(),this.hp.push(this.op.shift()),r},fa:function(){},cp:function(t){var i={fname:""};return this.hp[this.hp.length-1]instanceof Array&&this.hp.push(this.hp[this.hp.length-1].shift()),i},ZE:function(){this.hp[this.hp.length-2]instanceof Array&&this.hp.pop()},WE:function(){var t={},i=-1,n=Thrift.Type.STOP;for(var r in this.hp[this.hp.length-1])if(null!==r){i=parseInt(r,10),this.aw.push(this.hp.length);var s=this.hp[this.hp.length-1][i];delete this.hp[this.hp.length-1][i],this.hp.push(s);break}if(-1!=i)for(var e in this.hp[this.hp.length-1])null!==Thrift.Uw.xw[e]&&(n=Thrift.Uw.xw[e],this.hp[this.hp.length-1]=this.hp[this.hp.length-1][e]);return t.fname="",t.ftype=n,t.fid=i,t},JE:function(){for(var t=this.aw.pop();this.hp.length>t;)this.hp.pop()},lp:function(){var t=this.hp.pop(),i=t.shift();i instanceof Array&&(this.hp.push(t),i=(t=i).shift());var n={};return n.vp=Thrift.Uw.xw[i],n.dp=Thrift.Uw.xw[t.shift()],n.size=t.shift(),this.aw.push(this.hp.length),this.hp.push(t.shift()),n},Ep:function(){this.JE()},wp:function(){var t=this.hp[this.hp.length-1],i={};return i.pp=Thrift.Uw.xw[t.shift()],i.size=t.shift(),this.aw.push(this.hp.length),this.hp.push(t.shift()),i},gp:function(){this.JE()},bp:function(t,i){return this.wp(t,i)},yp:function(){return this.gp()},Tp:function(){var t=this.zE();return null!==t&&"1"==t.value?t.value=!0:t.value=!1,t},Op:function(){return this.zE()},mp:function(){return this.zE()},zE:function(t){void 0===t&&(t=this.hp[this.hp.length-1]);var i={};if(t instanceof Array)0===t.length?i.value=void 0:i.value=t.shift();else if(t instanceof Object){for(var n in t)if(null!==n){this.hp.push(t[n]),delete t[n],i.value=n;break}}else i.value=t,this.hp.pop();return i},_p:function(){return this.zE()},Rp:function(){return this.zE()},$E:function(){return this.zE()},Sp:function(){return this.$E()},XE:function(t){var i,n;switch(t){case Thrift.Type.STOP:return null;case Thrift.Type.BOOL:return this.Tp();case Thrift.Type.BYTE:return this.Op();case Thrift.Type.I16:return this.mp();case Thrift.Type.I32:return this.zE();case Thrift.Type.I64:return this._p();case Thrift.Type.DOUBLE:return this.Rp();case Thrift.Type.STRING:return this.$E();case Thrift.Type.STRUCT:for(this.cp();(i=this.WE()).ftype!=Thrift.Type.STOP;)this.XE(i.ftype),this.JE();return this.ZE(),null;case Thrift.Type.MAP:for(i=this.lp(),n=0;n<i.size;n++)0<n&&this.hp.length>this.aw[this.aw.length-1]+1&&this.hp.pop(),this.XE(i.vp),this.XE(i.dp);return this.Ep(),null;case Thrift.Type.SET:for(i=this.bp(),n=0;n<i.size;n++)this.XE(i.pp);return this.yp(),null;case Thrift.Type.LIST:for(i=this.wp(),n=0;n<i.size;n++)this.XE(i.pp);return this.gp(),null}}},Thrift.Ap=function(t,i,n,r){Thrift.Uw.call(this,i,n,r),this.Ip=t},Thrift.DE(Thrift.Ap,Thrift.Uw,"multiplexProtocol"),Thrift.Ap.prototype.na=function(t,i,n){i===Thrift.ra.CALL||i===Thrift.ra.ONEWAY?Thrift.Uw.prototype.na.call(this,this.Ip+":"+t,i,n):Thrift.Uw.prototype.na.call(this,t,i,n)},Thrift.Np=function(){this.Cp=0},Thrift.Np.prototype.kp=function(t,i,n){i.Zl&&(i=i.Zl);var r=this;return i.prototype.Dp=function(){return r.Cp+=1,r.Cp},new i(new Thrift.Ap(t,n))},copyList=function(t,i){if(!t)return t;var n,r,s,e=n=void 0===i.shift?i:i[0],h=t.length,o=[];for(r=0;r<h;r++)s=t[r],null===n?o.push(s):n===copyMap||n===copyList?o.push(n(s,i.slice(1))):o.push(new e(s));return o},copyMap=function(t,i){if(!t)return t;var n,r,s=n=void 0===i.shift?i:i[0],e={};for(var h in t)t.hasOwnProperty(h)&&(r=t[h],e[h]=null===n?r:n===copyMap||n===copyList?n(r,i.slice(1)):new s(r));return e},Thrift.jp=copyMap,Thrift.Mp=copyList,module.exports=Thrift},function(t,i){var g,E,e,a,n,h,r,o={userAgent:!1},u={};if(void 0===f||!f)var f={};f.Pp=function(){var t,i,n,r=arguments,s=null;for(t=0;t<r.length;t+=1)for(n=(""+r[t]).split("."),s=f,i="YAHOO"==n[0]?1:0;i<n.length;i+=1)s[n[i]]=s[n[i]]||{},s=s[n[i]];return s},f.log=function(t,i,n){var r=f.Hp.Lp;return!(!r||!r.log)&&r.log(t,i,n)},f.register=function(t,i,n){var r,s,e,h,o,u=f.Ge.Up;for(u[t]||(u[t]={Fp:[],Gp:[]}),r=u[t],s=n.version,e=n._l,h=f.Ge.listeners,r.name=t,r.version=s,r._l=e,r.Fp.push(s),r.Gp.push(e),r.xp=i,o=0;o<h.length;o+=1)h[o](r);i?(i.VERSION=s,i.Bp=e):f.log("mainClass is undefined for module "+t,"warn")},f.Ge=f.Ge||{Up:[],listeners:[]},f.Ge.getVersion=function(t){return f.Ge.Up[t]||null},f.Ge.Vp=function(t){function i(t){var i=0;return parseFloat(t.replace(/\./g,function(){return 1==i++?"":"."}))}var n,r={qp:0,opera:0,Qp:0,Yp:0,chrome:0,Kp:null,Wp:0,$p:0,Xp:0,zp:0,Jp:null,Zp:0,tg:0,ig:o&&o.ng,rg:!1,os:null},s=t||o&&o.userAgent,e=u.location,h=e&&e.href;return r.rg=h&&0===h.toLowerCase().indexOf("https"),s&&(/windows|win32/i.test(s)?r.os="windows":/macintosh/i.test(s)?r.os="macintosh":/rhino/i.test(s)&&(r.os="rhino"),/KHTML/.test(s)&&(r.Yp=1),(n=s.match(/AppleWebKit\/([^\s]*)/))&&n[1]&&(r.Yp=i(n[1]),/ Mobile\//.test(s)?(r.Kp="Apple",(n=s.match(/OS ([^\s]*)/))&&n[1]&&(n=i(n[1].replace("_","."))),r.Jp=n,r.$p=r.zp=r.Xp=0,(n=s.match(/iPad|iPod|iPhone/))&&n[0]&&(r[n[0].toLowerCase()]=r.Jp)):((n=s.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/))&&(r.Kp=n[0]),/webOS/.test(s)&&(r.Kp="WebOS",(n=s.match(/webOS\/([^\s]*);/))&&n[1]&&(r.tg=i(n[1]))),/ Android/.test(s)&&(r.Kp="Android",(n=s.match(/Android ([^\s]*);/))&&n[1]&&(r.Zp=i(n[1])))),(n=s.match(/Chrome\/([^\s]*)/))&&n[1]?r.chrome=i(n[1]):(n=s.match(/AdobeAIR\/([^\s]*)/))&&(r.Wp=n[0])),r.Yp||((n=s.match(/Opera[\s\/]([^\s]*)/))&&n[1]?(r.opera=i(n[1]),(n=s.match(/Version\/([^\s]*)/))&&n[1]&&(r.opera=i(n[1])),(n=s.match(/Opera Mini[^;]*/))&&(r.Kp=n[0])):(n=s.match(/MSIE\s([^;]*)/))&&n[1]?r.qp=i(n[1]):(n=s.match(/Gecko\/([^\s]*)/))&&(r.Qp=1,(n=s.match(/rv:([^\s\)]*)/))&&n[1]&&(r.Qp=i(n[1]))))),r},f.Ge.sg=f.Ge.Vp(),(function(){if(f.Pp("util","widget","example"),"undefined"!=typeof YAHOO_config){var t,i=YAHOO_config.listener,n=f.Ge.listeners,r=!0;if(i){for(t=0;t<n.length;t++)if(n[t]==i){r=!1;break}r&&n.push(i)}}})(),f.lang=f.lang||{},E=f.lang,e=Object.prototype,a=[],n={eg:"&amp;",hg:"&lt;",og:"&gt;",ug:"&quot;",ag:"&#x27;",ud:"&#x2F;",fg:"&#x60;"},h=["toString","valueOf"],r={isArray:function(t){return"[object Array]"===e.toString.apply(t)},cg:function(t){return"boolean"==typeof t},lg:function(t){return"function"==typeof t||"[object Function]"===e.toString.apply(t)},vg:function(t){return null===t},dg:function(t){return"number"==typeof t&&isFinite(t)},tc:function(t){return t&&("object"==typeof t||E.lg(t))||!1},Eg:function(t){return"string"==typeof t},wg:function(t){return void 0===t},pg:f.Ge.sg.qp?function(t,i){var n,r,s;for(n=0;n<h.length;n+=1)s=i[r=h[n]],E.lg(s)&&s!=e[r]&&(t[r]=s)}:function(){},gg:function(t){return t.replace(/[&<>"'\/`]/g,function(t){return n[t]})},extend:function(t,i,n){if(!i||!t)throw new Error("extend failed, please check that all dependencies are included.");function r(){}var s;if(r.prototype=i.prototype,t.prototype=new r(),(t.prototype.constructor=t).bg=i.prototype,i.prototype.constructor==e.constructor&&(i.prototype.constructor=i),n){for(s in n)E.hasOwnProperty(n,s)&&(t.prototype[s]=n[s]);E.pg(t.prototype,n)}},yg:function(t,i){if(!i||!t)throw new Error("Absorb failed, verify dependencies.");var n,r,s=arguments,e=s[2];if(e&&!0!==e)for(n=2;n<s.length;n+=1)t[s[n]]=i[s[n]];else{for(r in i)!e&&r in t||(t[r]=i[r]);E.pg(t,i)}return t},Tg:function(t,i){if(!i||!t)throw new Error("Augment failed, verify dependencies.");var n,r=[t.prototype,i.prototype];for(n=2;n<arguments.length;n+=1)r.push(arguments[n]);return E.yg.apply(this,r),t},dump:function(t,i){var n,r,s=[];if(!E.tc(t))return t+"";if(t instanceof Date||"nodeType"in t&&"tagName"in t)return t;if(E.lg(t))return"f(){...}";if(i=E.dg(i)?i:3,E.isArray(t)){for(s.push("["),n=0,r=t.length;n<r;n+=1)E.tc(t[n])?s.push(0<i?E.dump(t[n],i-1):"{...}"):s.push(t[n]),s.push(", ");1<s.length&&s.pop(),s.push("]")}else{for(n in s.push("{"),t)E.hasOwnProperty(t,n)&&(s.push(n+" => "),E.tc(t[n])?s.push(0<i?E.dump(t[n],i-1):"{...}"):s.push(t[n]),s.push(", "));1<s.length&&s.pop(),s.push("}")}return s.join("")},Og:function(t,i,n,r){for(var s,e,h,o,u,a,f,c,l,v=[],d=t.length;!((s=t.lastIndexOf("{",d))<0)&&!((e=t.indexOf("}",s))<s+1);)a=null,-1<(h=(o=f=t.substring(s+1,e)).indexOf(" "))&&(a=o.substring(h+1),o=o.substring(0,h)),u=i[o],n&&(u=n(o,u,a)),E.tc(u)?u=E.isArray(u)?E.dump(u,parseInt(a,10)):(-1<(c=(a=a||"").indexOf("dump"))&&(a=a.substring(4)),"[object Object]"===(l=u.toString())||-1<c?E.dump(u,parseInt(a,10)):l):E.Eg(u)||E.dg(u)||(u="~-"+v.length+"-~",v[v.length]=f),t=t.substring(0,s)+u+t.substring(e+1),!1===r&&(d=s-1);for(s=v.length-1;0<=s;s-=1)t=t.replace(new RegExp("~-"+s+"-~"),"{"+v[s]+"}","g");return t},trim:function(i){try{return i.replace(/^\s+|\s+$/g,"")}catch(t){return i}},mg:function(){var t,i={},n=arguments,r=n.length;for(t=0;t<r;t+=1)E.yg(i,n[t],!0);return i},_g:function(t,i,n,r,s){t=t||0,i=i||{};var e,h,o=n,u=r;if(E.Eg(n)&&(o=i[n]),!o)throw new TypeError("method undefined");return E.wg(r)||E.isArray(u)||(u=[r]),e=function(){o.apply(i,u||a)},h=s?setInterval(e,t):setTimeout(e,t),{interval:s,cancel:function(){this.interval?clearInterval(h):clearTimeout(h)}}},Rg:function(t){return E.tc(t)||E.Eg(t)||E.dg(t)||E.cg(t)}},E.hasOwnProperty=e.hasOwnProperty?function(t,i){return t&&t.hasOwnProperty&&t.hasOwnProperty(i)}:function(t,i){return!E.wg(t[i])&&t.constructor.prototype[i]!==t[i]},r.yg(E,r,!0),(f.util.Lang=E).Sg=E.Tg,f.Sg=E.Tg,f.extend=E.extend,f.register("yahoo",f,{version:"2.9.0",_l:"2800"});var c,s,l,v,d,w,p,b,y,T,O,m,_,R,S,A,I=I||(c=Math,l=(s={}).hl={},v=l.Ag={extend:function(t){N.prototype=this;var i=new N();return t&&i.Ig(t),i.hasOwnProperty("init")||(i.init=function(){i.Ng.init.apply(this,arguments)}),(i.init.prototype=i).Ng=this,i},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},Ig:function(t){for(var i in t)t.hasOwnProperty(i)&&(this[i]=t[i]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},d=l.el=v.extend({init:function(t,i){t=this.Cg=t||[],this.kg=null!=i?i:4*t.length},toString:function(t){return(t||p).stringify(this)},concat:function(t){var i=this.Cg,n=t.Cg,r=this.kg,s=t.kg;if(this.Dg(),r%4)for(var e=0;e<s;e++){var h=n[e>>>2]>>>24-e%4*8&255;i[r+e>>>2]|=h<<24-(r+e)%4*8}else for(e=0;e<s;e+=4)i[r+e>>>2]=n[e>>>2];return this.kg+=s,this},Dg:function(){var t=this.Cg,i=this.kg;t[i>>>2]&=4294967295<<32-i%4*8,t.length=c.ceil(i/4)},clone:function(){var t=v.clone.call(this);return t.Cg=this.Cg.slice(0),t},random:function(t){for(var i=[],n=0;n<t;n+=4)i.push(4294967296*c.random()|0);return new d.init(i,t)}}),w=s.jg={},p=w.Mg={stringify:function(t){for(var i=t.Cg,n=t.kg,r=[],s=0;s<n;s++){var e=i[s>>>2]>>>24-s%4*8&255;r.push((e>>>4).toString(16)),r.push((15&e).toString(16))}return r.join("")},parse:function(t){for(var i=t.length,n=[],r=0;r<i;r+=2)n[r>>>3]|=parseInt(t.substr(r,2),16)<<24-r%8*4;return new d.init(n,i/2)}},b=w.Pg={stringify:function(t){for(var i=t.Cg,n=t.kg,r=[],s=0;s<n;s++){var e=i[s>>>2]>>>24-s%4*8&255;r.push(String.fromCharCode(e))}return r.join("")},parse:function(t){for(var i=t.length,n=[],r=0;r<i;r++)n[r>>>2]|=(255&t.charCodeAt(r))<<24-r%4*8;return new d.init(n,i)}},y=w.Lg={stringify:function(t){try{return decodeURIComponent(escape(b.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return b.parse(unescape(encodeURIComponent(t)))}},T=l.Hg=v.extend({reset:function(){this.Ug=new d.init(),this.Fg=0},Gg:function(t){"string"==typeof t&&(t=y.parse(t)),this.Ug.concat(t),this.Fg+=t.kg},xg:function(t){var i=this.Ug,n=i.Cg,r=i.kg,s=this.blockSize,e=r/(4*s),h=(e=t?c.ceil(e):c.max((0|e)-this.Bg,0))*s,o=c.min(4*h,r);if(h){for(var u=0;u<h;u+=s)this.Vg(n,u);var a=n.splice(0,h);i.kg-=o}return new d.init(a,o)},clone:function(){var t=v.clone.call(this);return t.Ug=this.Ug.clone(),t},Bg:0}),l.qg=T.extend({Qg:v.extend(),init:function(t){this.Qg=this.Qg.extend(t),this.reset()},reset:function(){T.reset.call(this),this.Yg()},update:function(t){return this.Gg(t),this.xg(),this},Kg:function(t){return t&&this.Gg(t),this.Wg()},blockSize:16,$g:function(n){return function(t,i){return new n.init(i).Kg(t)}},Xg:function(n){return function(t,i){return new O.zg.init(n,i).Kg(t)}}}),O=s.Jg={},s);function N(){}!function(e){function m(t,i,n,r,s,e,h){return((t=t+(i&n|~i&r)+s+h)<<e|t>>>32-e)+i}function _(t,i,n,r,s,e,h){return((t=t+(i&r|n&~r)+s+h)<<e|t>>>32-e)+i}function R(t,i,n,r,s,e,h){return((t=t+(i^n^r)+s+h)<<e|t>>>32-e)+i}function S(t,i,n,r,s,e,h){return((t=t+(n^(i|~r))+s+h)<<e|t>>>32-e)+i}for(var t=I,i=(r=t.hl).el,n=r.qg,r=t.Jg,A=[],s=0;s<64;s++)A[s]=4294967296*e.abs(e.sin(s+1))|0;r=r.ul=n.extend({Yg:function(){this.Zg=new i.init([1732584193,4023233417,2562383102,271733878])},Vg:function(t,i){for(var n=0;n<16;n++){var r=t[h=i+n];t[h]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}n=this.Zg.Cg;var s,e,h=t[i+0],o=(r=t[i+1],t[i+2]),u=t[i+3],a=t[i+4],f=t[i+5],c=t[i+6],l=t[i+7],v=t[i+8],d=t[i+9],E=t[i+10],w=t[i+11],p=t[i+12],g=t[i+13],b=t[i+14],y=t[i+15],T=n[0],O=S(O=S(O=S(O=S(O=R(O=R(O=R(O=R(O=_(O=_(O=_(O=_(O=m(O=m(O=m(O=m(O=n[1],e=m(e=n[2],s=m(s=n[3],T=m(T,O,e,s,h,7,A[0]),O,e,r,12,A[1]),T,O,o,17,A[2]),s,T,u,22,A[3]),e=m(e,s=m(s,T=m(T,O,e,s,a,7,A[4]),O,e,f,12,A[5]),T,O,c,17,A[6]),s,T,l,22,A[7]),e=m(e,s=m(s,T=m(T,O,e,s,v,7,A[8]),O,e,d,12,A[9]),T,O,E,17,A[10]),s,T,w,22,A[11]),e=m(e,s=m(s,T=m(T,O,e,s,p,7,A[12]),O,e,g,12,A[13]),T,O,b,17,A[14]),s,T,y,22,A[15]),e=_(e,s=_(s,T=_(T,O,e,s,r,5,A[16]),O,e,c,9,A[17]),T,O,w,14,A[18]),s,T,h,20,A[19]),e=_(e,s=_(s,T=_(T,O,e,s,f,5,A[20]),O,e,E,9,A[21]),T,O,y,14,A[22]),s,T,a,20,A[23]),e=_(e,s=_(s,T=_(T,O,e,s,d,5,A[24]),O,e,b,9,A[25]),T,O,u,14,A[26]),s,T,v,20,A[27]),e=_(e,s=_(s,T=_(T,O,e,s,g,5,A[28]),O,e,o,9,A[29]),T,O,l,14,A[30]),s,T,p,20,A[31]),e=R(e,s=R(s,T=R(T,O,e,s,f,4,A[32]),O,e,v,11,A[33]),T,O,w,16,A[34]),s,T,b,23,A[35]),e=R(e,s=R(s,T=R(T,O,e,s,r,4,A[36]),O,e,a,11,A[37]),T,O,l,16,A[38]),s,T,E,23,A[39]),e=R(e,s=R(s,T=R(T,O,e,s,g,4,A[40]),O,e,h,11,A[41]),T,O,u,16,A[42]),s,T,c,23,A[43]),e=R(e,s=R(s,T=R(T,O,e,s,d,4,A[44]),O,e,p,11,A[45]),T,O,y,16,A[46]),s,T,o,23,A[47]),e=S(e,s=S(s,T=S(T,O,e,s,h,6,A[48]),O,e,l,10,A[49]),T,O,b,15,A[50]),s,T,f,21,A[51]),e=S(e,s=S(s,T=S(T,O,e,s,p,6,A[52]),O,e,u,10,A[53]),T,O,E,15,A[54]),s,T,r,21,A[55]),e=S(e,s=S(s,T=S(T,O,e,s,v,6,A[56]),O,e,y,10,A[57]),T,O,c,15,A[58]),s,T,g,21,A[59]),e=S(e,s=S(s,T=S(T,O,e,s,a,6,A[60]),O,e,w,10,A[61]),T,O,o,15,A[62]),s,T,d,21,A[63]);n[0]=n[0]+T|0,n[1]=n[1]+O|0,n[2]=n[2]+e|0,n[3]=n[3]+s|0},Wg:function(){var t=this.Ug,i=t.Cg,n=8*this.Fg,r=8*t.kg;i[r>>>5]|=128<<24-r%32;var s=e.floor(n/4294967296);for(i[15+(r+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),i[14+(r+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),t.kg=4*(i.length+1),this.xg(),i=(t=this.Zg).Cg,n=0;n<4;n++)r=i[n],i[n]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8);return t},clone:function(){var t=n.clone.call(this);return t.Zg=this.Zg.clone(),t}}),t.ul=n.$g(r),t.tb=n.Xg(r)}(Math),_=(A=(m=I).hl).el,R=A.qg,S=[],A=m.Jg.ib=R.extend({Yg:function(){this.Zg=new _.init([1732584193,4023233417,2562383102,271733878,3285377520])},Vg:function(t,i){for(var n=this.Zg.Cg,r=n[0],s=n[1],e=n[2],h=n[3],o=n[4],u=0;u<80;u++){if(u<16)S[u]=0|t[i+u];else{var a=S[u-3]^S[u-8]^S[u-14]^S[u-16];S[u]=a<<1|a>>>31}a=(r<<5|r>>>27)+o+S[u],a=u<20?a+(1518500249+(s&e|~s&h)):u<40?a+(1859775393+(s^e^h)):u<60?a+((s&e|s&h|e&h)-1894007588):a+((s^e^h)-899497514),o=h,h=e,e=s<<30|s>>>2,s=r,r=a}n[0]=n[0]+r|0,n[1]=n[1]+s|0,n[2]=n[2]+e|0,n[3]=n[3]+h|0,n[4]=n[4]+o|0},Wg:function(){var t=this.Ug,i=t.Cg,n=8*this.Fg,r=8*t.kg;return i[r>>>5]|=128<<24-r%32,i[14+(64+r>>>9<<4)]=Math.floor(n/4294967296),i[15+(64+r>>>9<<4)]=n,t.kg=4*i.length,this.xg(),this.Zg},clone:function(){var t=R.clone.call(this);return t.Zg=this.Zg.clone(),t}}),m.ib=R.$g(A),m.nb=R.Xg(A);var C,k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",D="=";function j(t){var i,n,r,s="",e=0;for(i=0;i<t.length&&t.charAt(i)!=D;++i)(r=k.indexOf(t.charAt(i)))<0||(e=0==e?(s+=G(r>>2),n=3&r,1):1==e?(s+=G(n<<2|r>>4),n=15&r,2):2==e?(s+=G(n),s+=G(r>>2),n=3&r,3):(s+=G(n<<2|r>>4),s+=G(15&r),0));return 1==e&&(s+=G(n<<2)),s}function M(t,i,n){null!=t&&("number"==typeof t?this.rb(t,i,n):null==i&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,i))}function P(){return new M(null)}C="Microsoft Internet Explorer"==o.appName?(M.prototype.sb=function(t,i,n,r,s,e){for(var h=32767&i,o=i>>15;0<=--e;){var u=32767&this[t],a=this[t++]>>15,f=o*u+a*h;s=((u=h*u+((32767&f)<<15)+n[r]+(1073741823&s))>>>30)+(f>>>15)+o*a+(s>>>30),n[r++]=1073741823&u}return s},30):"Netscape"!=o.appName?(M.prototype.sb=function(t,i,n,r,s,e){for(;0<=--e;){var h=i*this[t++]+n[r]+s;s=Math.floor(h/67108864),n[r++]=67108863&h}return s},26):(M.prototype.sb=function(t,i,n,r,s,e){for(var h=16383&i,o=i>>14;0<=--e;){var u=16383&this[t],a=this[t++]>>14,f=o*u+a*h;s=((u=h*u+((16383&f)<<14)+n[r]+s)>>28)+(f>>14)+o*a,n[r++]=268435455&u}return s},28),M.prototype.eb=C,M.prototype.hb=(1<<C)-1,M.prototype.ob=1<<C;M.prototype.ub=Math.pow(2,52),M.prototype.ab=52-C,M.prototype.fb=2*C-52;var L,H,U="0123456789abcdefghijklmnopqrstuvwxyz",F=new Array();for(L="0".charCodeAt(0),H=0;H<=9;++H)F[L++]=H;for(L="a".charCodeAt(0),H=10;H<36;++H)F[L++]=H;for(L="A".charCodeAt(0),H=10;H<36;++H)F[L++]=H;function G(t){return U.charAt(t)}function x(t){var i=P();return i.cb(t),i}function B(t){var i,n=1;return 0!=(i=t>>>16)&&(t=i,n+=16),0!=(i=t>>8)&&(t=i,n+=8),0!=(i=t>>4)&&(t=i,n+=4),0!=(i=t>>2)&&(t=i,n+=2),0!=(i=t>>1)&&(t=i,n+=1),n}function V(t){this.lb=t}function q(t){this.lb=t,this.vb=t.Eb(),this.wb=32767&this.vb,this.pb=this.vb>>15,this.gb=(1<<t.eb-15)-1,this.bb=2*t.t}function Q(t,i){return new M(t,i)}function Y(t,i,n){for(var r="",s=0;r.length<i;)r+=n(String.fromCharCode.apply(String,t.concat([(4278190080&s)>>24,(16711680&s)>>16,(65280&s)>>8,255&s]))),s+=1;return r}V.prototype.yb=function(t){return t.Tb<0||0<=t.Ob(this.lb)?t.mb(this.lb):t},V.prototype._b=function(t){return t},V.prototype.reduce=function(t){t.Rb(this.lb,null,t)},V.prototype.Sb=function(t,i,n){t.Ab(i,n),this.reduce(n)},V.prototype.Ib=function(t,i){t.Nb(i),this.reduce(i)},q.prototype.yb=function(t){var i=P();return t.abs().Cb(this.lb.t,i),i.Rb(this.lb,null,i),t.Tb<0&&0<i.Ob(M.ZERO)&&this.lb.kb(i,i),i},q.prototype._b=function(t){var i=P();return t.Db(i),this.reduce(i),i},q.prototype.reduce=function(t){for(;t.t<=this.bb;)t[t.t++]=0;for(var i=0;i<this.lb.t;++i){var n=32767&t[i],r=n*this.wb+((n*this.pb+(t[i]>>15)*this.wb&this.gb)<<15)&t.hb;for(t[n=i+this.lb.t]+=this.lb.sb(0,r,t,i,0,this.lb.t);t[n]>=t.ob;)t[n]-=t.ob,t[++n]++}t.Dg(),t.jb(this.lb.t,t),0<=t.Ob(this.lb)&&t.kb(this.lb,t)},q.prototype.Sb=function(t,i,n){t.Ab(i,n),this.reduce(n)},q.prototype.Ib=function(t,i){t.Nb(i),this.reduce(i)},M.prototype.Db=function(t){for(var i=this.t-1;0<=i;--i)t[i]=this[i];t.t=this.t,t.Tb=this.Tb},M.prototype.cb=function(t){this.t=1,this.Tb=t<0?-1:0,0<t?this[0]=t:t<-1?this[0]=t+this.ob:this.t=0},M.prototype.fromString=function(t,i){var n;if(16==i)n=4;else if(8==i)n=3;else if(256==i)n=8;else if(2==i)n=1;else if(32==i)n=5;else{if(4!=i)return void this.Mb(t,i);n=2}this.t=0,this.Tb=0;for(var r,s,e=t.length,h=!1,o=0;0<=--e;){var u=8==n?255&t[e]:(r=e,void 0,null==(s=F[t.charCodeAt(r)])?-1:s);u<0?"-"==t.charAt(e)&&(h=!0):(h=!1,0==o?this[this.t++]=u:o+n>this.eb?(this[this.t-1]|=(u&(1<<this.eb-o)-1)<<o,this[this.t++]=u>>this.eb-o):this[this.t-1]|=u<<o,(o+=n)>=this.eb&&(o-=this.eb))}8==n&&0!=(128&t[0])&&(this.Tb=-1,0<o&&(this[this.t-1]|=(1<<this.eb-o)-1<<o)),this.Dg(),h&&M.ZERO.kb(this,this)},M.prototype.Dg=function(){for(var t=this.Tb&this.hb;0<this.t&&this[this.t-1]==t;)--this.t},M.prototype.Cb=function(t,i){var n;for(n=this.t-1;0<=n;--n)i[n+t]=this[n];for(n=t-1;0<=n;--n)i[n]=0;i.t=this.t+t,i.Tb=this.Tb},M.prototype.jb=function(t,i){for(var n=t;n<this.t;++n)i[n-t]=this[n];i.t=Math.max(this.t-t,0),i.Tb=this.Tb},M.prototype.Pb=function(t,i){var n,r=t%this.eb,s=this.eb-r,e=(1<<s)-1,h=Math.floor(t/this.eb),o=this.Tb<<r&this.hb;for(n=this.t-1;0<=n;--n)i[n+h+1]=this[n]>>s|o,o=(this[n]&e)<<r;for(n=h-1;0<=n;--n)i[n]=0;i[h]=o,i.t=this.t+h+1,i.Tb=this.Tb,i.Dg()},M.prototype.Lb=function(t,i){i.Tb=this.Tb;var n=Math.floor(t/this.eb);if(n>=this.t)i.t=0;else{var r=t%this.eb,s=this.eb-r,e=(1<<r)-1;i[0]=this[n]>>r;for(var h=n+1;h<this.t;++h)i[h-n-1]|=(this[h]&e)<<s,i[h-n]=this[h]>>r;0<r&&(i[this.t-n-1]|=(this.Tb&e)<<s),i.t=this.t-n,i.Dg()}},M.prototype.kb=function(t,i){for(var n=0,r=0,s=Math.min(t.t,this.t);n<s;)r+=this[n]-t[n],i[n++]=r&this.hb,r>>=this.eb;if(t.t<this.t){for(r-=t.Tb;n<this.t;)r+=this[n],i[n++]=r&this.hb,r>>=this.eb;r+=this.Tb}else{for(r+=this.Tb;n<t.t;)r-=t[n],i[n++]=r&this.hb,r>>=this.eb;r-=t.Tb}i.Tb=r<0?-1:0,r<-1?i[n++]=this.ob+r:0<r&&(i[n++]=r),i.t=n,i.Dg()},M.prototype.Ab=function(t,i){var n=this.abs(),r=t.abs(),s=n.t;for(i.t=s+r.t;0<=--s;)i[s]=0;for(s=0;s<r.t;++s)i[s+n.t]=n.sb(0,r[s],i,s,0,n.t);i.Tb=0,i.Dg(),this.Tb!=t.Tb&&M.ZERO.kb(i,i)},M.prototype.Nb=function(t){for(var i=this.abs(),n=t.t=2*i.t;0<=--n;)t[n]=0;for(n=0;n<i.t-1;++n){var r=i.sb(n,i[n],t,2*n,0,1);(t[n+i.t]+=i.sb(n+1,2*i[n],t,2*n+1,r,i.t-n-1))>=i.ob&&(t[n+i.t]-=i.ob,t[n+i.t+1]=1)}0<t.t&&(t[t.t-1]+=i.sb(n,i[n],t,2*n,0,1)),t.Tb=0,t.Dg()},M.prototype.Rb=function(t,i,n){var r=t.abs();if(!(r.t<=0)){var s=this.abs();if(s.t<r.t)return null!=i&&i.cb(0),void (null!=n&&this.Db(n));null==n&&(n=P());var e=P(),h=this.Tb,o=t.Tb,u=this.eb-B(r[r.t-1]);0<u?(r.Pb(u,e),s.Pb(u,n)):(r.Db(e),s.Db(n));var a=e.t,f=e[a-1];if(0!=f){var c=f*(1<<this.ab)+(1<a?e[a-2]>>this.fb:0),l=this.ub/c,v=(1<<this.ab)/c,d=1<<this.fb,E=n.t,w=E-a,p=null==i?P():i;for(e.Cb(w,p),0<=n.Ob(p)&&(n[n.t++]=1,n.kb(p,n)),M.ONE.Cb(a,p),p.kb(e,e);e.t<a;)e[e.t++]=0;for(;0<=--w;){var g=n[--E]==f?this.hb:Math.floor(n[E]*l+(n[E-1]+d)*v);if((n[E]+=e.sb(0,g,n,w,0,a))<g)for(e.Cb(w,p),n.kb(p,n);n[E]<--g;)n.kb(p,n)}null!=i&&(n.jb(a,i),h!=o&&M.ZERO.kb(i,i)),n.t=a,n.Dg(),0<u&&n.Lb(u,n),h<0&&M.ZERO.kb(n,n)}}},M.prototype.Eb=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var i=3&t;return 0<(i=(i=(i=(i=i*(2-(15&t)*i)&15)*(2-(255&t)*i)&255)*(2-((65535&t)*i&65535))&65535)*(2-t*i%this.ob)%this.ob)?this.ob-i:-i},M.prototype.Hb=function(){return 0==(0<this.t?1&this[0]:this.Tb)},M.prototype.exp=function(t,i){if(4294967295<t||t<1)return M.ONE;var n=P(),r=P(),s=i.yb(this),e=B(t)-1;for(s.Db(n);0<=--e;)if(i.Ib(n,r),0<(t&1<<e))i.Sb(r,s,n);else{var h=n;n=r,r=h}return i._b(n)},M.prototype.toString=function(t){if(this.Tb<0)return"-"+this.Ub().toString(t);var i;if(16==t)i=4;else if(8==t)i=3;else if(2==t)i=1;else if(32==t)i=5;else{if(4!=t)return this.Fb(t);i=2}var n,r=(1<<i)-1,s=!1,e="",h=this.t,o=this.eb-h*this.eb%i;if(0<h--)for(o<this.eb&&0<(n=this[h]>>o)&&(s=!0,e=G(n));0<=h;)o<i?(n=(this[h]&(1<<o)-1)<<i-o,n|=this[--h]>>(o+=this.eb-i)):(n=this[h]>>(o-=i)&r,o<=0&&(o+=this.eb,--h)),0<n&&(s=!0),s&&(e+=G(n));return s?e:"0"},M.prototype.Ub=function(){var t=P();return M.ZERO.kb(this,t),t},M.prototype.abs=function(){return this.Tb<0?this.Ub():this},M.prototype.Ob=function(t){var i=this.Tb-t.Tb;if(0!=i)return i;var n=this.t;if(0!=(i=n-t.t))return this.Tb<0?-i:i;for(;0<=--n;)if(0!=(i=this[n]-t[n]))return i;return 0},M.prototype.Gb=function(){return this.t<=0?0:this.eb*(this.t-1)+B(this[this.t-1]^this.Tb&this.hb)},M.prototype.mb=function(t){var i=P();return this.abs().Rb(t,null,i),this.Tb<0&&0<i.Ob(M.ZERO)&&t.kb(i,i),i},M.prototype.xb=function(t,i){var n;return n=t<256||i.Hb()?new V(i):new q(i),this.exp(t,n)},M.ZERO=x(0),M.ONE=x(1);var K=20;function W(){this.n=null,this.e=0,this.d=null,this.Bb=null,this.Vb=null,this.qb=null,this.Qb=null,this.Yb=null}W.prototype.Kb=function(t){return t.xb(this.e,this.n)},W.prototype.Wb=function(t,i){this.$b=!0,"string"!=typeof t?(this.n=t,this.e=i):null!=t&&null!=i&&0<t.length&&0<i.length?(this.n=Q(t,16),this.e=parseInt(i,16)):alert("Invalid RSA public key")},W.prototype.encrypt=function(t){var i=function(t,i){if(i<t.length+11)return alert("Message too long for RSA"),null;for(var n=new Array(),r=t.length-1;0<=r&&0<i;){var s=t.charCodeAt(r--);s<128?n[--i]=s:127<s&&s<2048?(n[--i]=63&s|128,n[--i]=s>>6|192):(n[--i]=63&s|128,n[--i]=s>>6&63|128,n[--i]=s>>12|224)}n[--i]=0;for(var e=new SecureRandom(),h=new Array();2<i;){for(h[0]=0;0==h[0];)e.Xb(h);n[--i]=h[0]}return n[--i]=2,n[--i]=0,new M(n)}(t,this.n.Gb()+7>>3);if(null==i)return null;var n=this.Kb(i);if(null==n)return null;var r=n.toString(16);return 0==(1&r.length)?r:"0"+r},W.prototype.zb=function(t,i){var n=function(t,i,n){if(t.length+2*K+2>i)throw"Message too long for RSA";var r,s="";for(r=0;r<i-t.length-2*K-2;r+=1)s+="\0";var e=rstr_sha1("")+s+"\x01"+t,h=new Array(K);new SecureRandom().Xb(h);var o=Y(h,e.length,n||rstr_sha1),u=[];for(r=0;r<e.length;r+=1)u[r]=e.charCodeAt(r)^o.charCodeAt(r);var a=Y(u,h.length,rstr_sha1),f=[0];for(r=0;r<h.length;r+=1)f[r+1]=h[r]^a.charCodeAt(r);return new M(f.concat(u))}(t,this.n.Gb()+7>>3,i);if(null==n)return null;var r=this.Kb(n);if(null==r)return null;var s=r.toString(16);return 0==(1&s.length)?s:"0"+s},W.prototype.type="RSA",void 0!==g&&g||(g={}),void 0!==g.Jb&&g.Jb||(g.Jb={}),g.Jb.Zb=new(function(){this.ty=function(t){var i=t.toString(16);return i.length%2==1&&(i="0"+i),i},this.iy=function(t){var i=t.toString(16);if("-"!=i.substr(0,1))i.length%2==1?i="0"+i:i.match(/^[0-7]/)||(i="00"+i);else{var n=i.substr(1).length;n%2==1?n+=1:i.match(/^[0-7]/)||(n+=2);for(var r="",s=0;s<n;s++)r+="f";i=new M(r,16).xor(t).add(M.ONE).toString(16).replace(/^-/,"")}return i},this.ny=function(t,i){g.Jb;var n=I.jg.Mg.parse(t),r=I.jg.sy.stringify(n).replace(/(.{64})/g,"$1\r\n");return"-----BEGIN "+i+"-----\r\n"+(r=r.replace(/\r\n$/,""))+"\r\n-----END "+i+"-----\r\n"},this.ey=function(t){var i=g.Jb,n=Object.keys(t);if(1!=n.length)throw"key of param shall be only one.";var r=n[0];if(-1==":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+r+":"))throw"undefined key: "+r;if("bool"==r)return new i.hy(t[r]);if("int"==r)return new i.oy(t[r]);if("bitstr"==r)return new i.uy(t[r]);if("octstr"==r)return new i.ay(t[r]);if("null"==r)return new i.ly(t[r]);if("oid"==r)return new i.vy(t[r]);if("enum"==r)return new i.Ey(t[r]);if("utf8str"==r)return new i.wy(t[r]);if("numstr"==r)return new i.py(t[r]);if("prnstr"==r)return new i.gy(t[r]);if("telstr"==r)return new i.by(t[r]);if("ia5str"==r)return new i.yy(t[r]);if("utctime"==r)return new i.Ty(t[r]);if("gentime"==r)return new i.Oy(t[r]);if("seq"==r){for(var s=t[r],e=[],h=0;h<s.length;h++){var o=i.Zb.ey(s[h]);e.push(o)}return new i.my({array:e})}if("set"==r){for(s=t[r],e=[],h=0;h<s.length;h++)o=i.Zb.ey(s[h]),e.push(o);return new i._y({array:e})}if("tag"==r){var u=t[r];if("[object Array]"===Object.prototype.toString.call(u)&&3==u.length){var a=i.Zb.ey(u[2]);return new i.Ry({tag:u[0],Sy:u[1],Ay:a})}var f={};if(void 0!==u.Sy&&(f.Sy=u.Sy),void 0!==u.tag&&(f.tag=u.tag),void 0===u.Ay)throw"obj shall be specified for 'tag'.";return f.Ay=i.Zb.ey(u.Ay),new i.Ry(f)}},this.Iy=function(t){return this.ey(t).Ny()}})(),g.Jb.Zb.Cy=function(t){for(var i="",n=parseInt(t.substr(0,2),16),r=(i=Math.floor(n/40)+"."+n%40,""),s=2;s<t.length;s+=2){var e=("00000000"+parseInt(t.substr(s,2),16).toString(2)).slice(-8);(r+=e.substr(1,7),"0"==e.substr(0,1))&&(i=i+"."+new M(r,2).toString(10),r="")}return i},g.Jb.Zb.ky=function(t){function o(t){var i=t.toString(16);return 1==i.length&&(i="0"+i),i}function i(t){var i="",n=new M(t,10).toString(2),r=7-n.length%7;7==r&&(r=0);for(var s="",e=0;e<r;e++)s+="0";for(n=s+n,e=0;e<n.length-1;e+=7){var h=n.substr(e,7);e!=n.length-7&&(h="1"+h),i+=o(parseInt(h,2))}return i}if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var n="",r=t.split("."),s=40*parseInt(r[0])+parseInt(r[1]);n+=o(s),r.splice(0,2);for(var e=0;e<r.length;e++)n+=i(r[e]);return n},g.Jb.Dy=function(){this.jy=function(){if(void 0===this.My||null==this.My)throw"this.hV is null or undefined.";if(this.My.length%2==1)throw"value hex must be even length: n="+"".length+",v="+this.My;var t=this.My.length/2,i=t.toString(16);if(i.length%2==1&&(i="0"+i),t<128)return i;var n=i.length/2;if(15<n)throw"ASN.1 length too long to represent by 8x: n = "+t.toString(16);return(128+n).toString(16)+i},this.Ny=function(){return null!=this.Py&&!this.Ly||(this.My=this.Hy(),this.Uy=this.jy(),this.Py=this.Fy+this.Uy+this.My,this.Ly=!1),this.Py},this.Gy=function(){return this.Ny(),this.My},this.Hy=function(){return""}},g.Jb.xy=function(t){g.Jb.xy.bg.constructor.call(this),(this.By=function(){return this.Tb},this.Vy=function(t){this.Py=null,this.Ly=!0,this.Tb=t,this.My=stohex(this.Tb)},this.qy=function(t){this.Py=null,this.Ly=!0,this.Tb=null,this.My=t},this.Hy=function(){return this.My},void 0!==t&&("string"==typeof t?this.Vy(t):void 0!==t.str?this.Vy(t.str):void 0!==t.Qy&&this.qy(t.Qy)))},f.lang.extend(g.Jb.xy,g.Jb.Dy),g.Jb.Yy=function(t){g.Jb.Yy.bg.constructor.call(this),(this.Ky=function(t){return utc=t.getTime()+6e4*t.getTimezoneOffset(),new Date(utc)},this.Wy=function(t,i,n){var r=this.$y,s=this.Ky(t),e=String(s.getFullYear());"utc"==i&&(e=e.substr(2,2));var h=e+r(String(s.getMonth()+1),2)+r(String(s.getDate()),2)+r(String(s.getHours()),2)+r(String(s.getMinutes()),2)+r(String(s.getSeconds()),2);if(!0===n){var o=s.getMilliseconds();if(0!=o){var u=r(String(o),3);h=h+"."+(u=u.replace(/[0]+$/,""))}}return h+"Z"},this.$y=function(t,i){return t.length>=i?t:new Array(i-t.length+1).join("0")+t},this.By=function(){return this.Tb},this.Vy=function(t){this.Py=null,this.Ly=!0,this.Tb=t,this.My=stohex(t)},this.Xy=function(t,i,n,r,s,e){var h=new Date(Date.UTC(t,i-1,n,r,s,e,0));this.zy(h)},this.Hy=function(){return this.My})},f.lang.extend(g.Jb.Yy,g.Jb.Dy),g.Jb.Jy=function(t){g.Jb.xy.bg.constructor.call(this),(this.Zy=function(t){this.Py=null,this.Ly=!0,this.tT=t},this.iT=function(t){this.Py=null,this.Ly=!0,this.tT.push(t)},this.tT=new Array(),void 0!==t&&void 0!==t.array&&(this.tT=t.array))},f.lang.extend(g.Jb.Jy,g.Jb.Dy),g.Jb.hy=function(){g.Jb.hy.bg.constructor.call(this),this.Fy="01",this.Py="0101ff"},f.lang.extend(g.Jb.hy,g.Jb.Dy),g.Jb.oy=function(t){g.Jb.oy.bg.constructor.call(this),this.Fy="02",this.nT=function(t){this.Py=null,this.Ly=!0,this.My=g.Jb.Zb.iy(t)},this.rT=function(t){var i=new M(String(t),10);this.nT(i)},this.sT=function(t){this.My=t},this.Hy=function(){return this.My},void 0!==t&&(void 0!==t.eT?this.nT(t.eT):void 0!==t["int"]?this.rT(t["int"]):"number"==typeof t?this.rT(t):void 0!==t.Qy&&this.sT(t.Qy))},f.lang.extend(g.Jb.oy,g.Jb.Dy),g.Jb.uy=function(t){g.Jb.uy.bg.constructor.call(this),this.Fy="03",this.hT=function(t){this.Py=null,this.Ly=!0,this.My=t},this.oT=function(t,i){if(t<0||7<t)throw"unused bits shall be from 0 to 7: u = "+t;var n="0"+t;this.Py=null,this.Ly=!0,this.My=n+i},this.uT=function(t){var i=8-(t=t.replace(/0+$/,"")).length%8;8==i&&(i=0);for(var n=0;n<=i;n++)t+="0";var r="";for(n=0;n<t.length-1;n+=8){var s=t.substr(n,8),e=parseInt(s,2).toString(16);1==e.length&&(e="0"+e),r+=e}this.Py=null,this.Ly=!0,this.My="0"+i+r},this.aT=function(t){for(var i="",n=0;n<t.length;n++)1==t[n]?i+="1":i+="0";this.uT(i)},this.fT=function(t){for(var i=new Array(t),n=0;n<t;n++)i[n]=!1;return i},this.Hy=function(){return this.My},void 0!==t&&("string"==typeof t&&t.toLowerCase().match(/^[0-9a-f]+$/)?this.hT(t):void 0!==t.Qy?this.hT(t.Qy):void 0!==t.cT?this.uT(t.cT):void 0!==t.array&&this.aT(t.array))},f.lang.extend(g.Jb.uy,g.Jb.Dy),g.Jb.ay=function(t){g.Jb.ay.bg.constructor.call(this,t),this.Fy="04"},f.lang.extend(g.Jb.ay,g.Jb.xy),g.Jb.ly=function(){g.Jb.ly.bg.constructor.call(this),this.Fy="05",this.Py="0500"},f.lang.extend(g.Jb.ly,g.Jb.Dy),g.Jb.vy=function(t){function o(t){var i=t.toString(16);return 1==i.length&&(i="0"+i),i}function e(t){var i="",n=new M(t,10).toString(2),r=7-n.length%7;7==r&&(r=0);for(var s="",e=0;e<r;e++)s+="0";for(n=s+n,e=0;e<n.length-1;e+=7){var h=n.substr(e,7);e!=n.length-7&&(h="1"+h),i+=o(parseInt(h,2))}return i}g.Jb.vy.bg.constructor.call(this),this.Fy="06",this.sT=function(t){this.Py=null,this.Ly=!0,this.Tb=null,this.My=t},this.lT=function(t){if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var i="",n=t.split("."),r=40*parseInt(n[0])+parseInt(n[1]);i+=o(r),n.splice(0,2);for(var s=0;s<n.length;s++)i+=e(n[s]);this.Py=null,this.Ly=!0,this.Tb=null,this.My=i},this.vT=function(t){if(void 0===g.Jb.wT.ET.dT[t])throw"DERObjectIdentifier oidName undefined: "+t;var i=g.Jb.wT.ET.dT[t];this.lT(i)},this.Hy=function(){return this.My},void 0!==t&&("string"==typeof t&&t.match(/^[0-2].[0-9.]+$/)?this.lT(t):void 0!==g.Jb.wT.ET.dT[t]?this.lT(g.Jb.wT.ET.dT[t]):void 0!==t.pT?this.lT(t.pT):void 0!==t.Qy?this.sT(t.Qy):void 0!==t.name&&this.vT(t.name))},f.lang.extend(g.Jb.vy,g.Jb.Dy),g.Jb.Ey=function(t){g.Jb.Ey.bg.constructor.call(this),this.Fy="0a",this.nT=function(t){this.Py=null,this.Ly=!0,this.My=g.Jb.Zb.iy(t)},this.rT=function(t){var i=new M(String(t),10);this.nT(i)},this.sT=function(t){this.My=t},this.Hy=function(){return this.My},void 0!==t&&(void 0!==t["int"]?this.rT(t["int"]):"number"==typeof t?this.rT(t):void 0!==t.Qy&&this.sT(t.Qy))},f.lang.extend(g.Jb.Ey,g.Jb.Dy),g.Jb.wy=function(t){g.Jb.wy.bg.constructor.call(this,t),this.Fy="0c"},f.lang.extend(g.Jb.wy,g.Jb.xy),g.Jb.py=function(t){g.Jb.py.bg.constructor.call(this,t),this.Fy="12"},f.lang.extend(g.Jb.py,g.Jb.xy),g.Jb.gy=function(t){g.Jb.gy.bg.constructor.call(this,t),this.Fy="13"},f.lang.extend(g.Jb.gy,g.Jb.xy),g.Jb.by=function(t){g.Jb.by.bg.constructor.call(this,t),this.Fy="14"},f.lang.extend(g.Jb.by,g.Jb.xy),g.Jb.yy=function(t){g.Jb.yy.bg.constructor.call(this,t),this.Fy="16"},f.lang.extend(g.Jb.yy,g.Jb.xy),g.Jb.Ty=function(t){g.Jb.Ty.bg.constructor.call(this,t),this.Fy="17",this.zy=function(t){this.Py=null,this.Ly=!0,this.gT=t,this.Tb=this.Wy(this.gT,"utc"),this.My=stohex(this.Tb)},this.Hy=function(){return void 0===this.gT&&void 0===this.Tb&&(this.gT=new Date(),this.Tb=this.Wy(this.gT,"utc"),this.My=stohex(this.Tb)),this.My},void 0!==t&&(void 0!==t.str?this.Vy(t.str):"string"==typeof t&&t.match(/^[0-9]{12}Z$/)?this.Vy(t):void 0!==t.Qy?this.qy(t.Qy):void 0!==t.gT&&this.zy(t.gT))},f.lang.extend(g.Jb.Ty,g.Jb.Yy),g.Jb.Oy=function(t){g.Jb.Oy.bg.constructor.call(this,t),this.Fy="18",this.bT=!1,this.zy=function(t){this.Py=null,this.Ly=!0,this.gT=t,this.Tb=this.Wy(this.gT,"gen",this.bT),this.My=stohex(this.Tb)},this.Hy=function(){return void 0===this.gT&&void 0===this.Tb&&(this.gT=new Date(),this.Tb=this.Wy(this.gT,"gen",this.bT),this.My=stohex(this.Tb)),this.My},void 0!==t&&(void 0!==t.str?this.Vy(t.str):"string"==typeof t&&t.match(/^[0-9]{14}Z$/)?this.Vy(t):void 0!==t.Qy?this.qy(t.Qy):void 0!==t.gT&&this.zy(t.gT),!0===t.yT&&(this.bT=!0))},f.lang.extend(g.Jb.Oy,g.Jb.Yy),g.Jb.my=function(t){g.Jb.my.bg.constructor.call(this,t),this.Fy="30",this.Hy=function(){for(var t="",i=0;i<this.tT.length;i++)t+=this.tT[i].Ny();return this.My=t,this.My}},f.lang.extend(g.Jb.my,g.Jb.Jy),g.Jb._y=function(t){g.Jb._y.bg.constructor.call(this,t),this.Fy="31",this.TT=!0,this.Hy=function(){for(var t=new Array(),i=0;i<this.tT.length;i++){var n=this.tT[i];t.push(n.Ny())}return 1==this.TT&&t.sort(),this.My=t.join(""),this.My},void 0!==t&&void 0!==t.OT&&0==t.OT&&(this.TT=!1)},f.lang.extend(g.Jb._y,g.Jb.Jy),g.Jb.Ry=function(t){g.Jb.Ry.bg.constructor.call(this),this.Fy="a0",this.My="",this.mT=!0,this._T=null,this.RT=function(t,i,n){this.Fy=i,this.mT=t,this._T=n,this.mT?(this.My=this._T.Ny(),this.Py=null,this.Ly=!0):(this.My=null,this.Py=n.Ny(),this.Py=this.Py.replace(/^../,i),this.Ly=!1)},this.Hy=function(){return this.My},void 0!==t&&(void 0!==t.tag&&(this.Fy=t.tag),void 0!==t.Sy&&(this.mT=t.Sy),void 0!==t.Ay&&(this._T=t.Ay,this.RT(this.mT,this.Fy,this._T)))},f.lang.extend(g.Jb.Ry,g.Jb.Dy),void 0!==g&&g||(g={}),void 0!==g.crypto&&g.crypto||(g.crypto={}),g.crypto.ST=new(function(){this.AT={sha1:"3021300906052b0e03021a05000414",IT:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",NT:"3041300d060960864801650304020205000430",CT:"3051300d060960864801650304020305000440",kT:"3020300c06082a864886f70d020205000410",DT:"3020300c06082a864886f70d020505000410",jT:"3021300906052b2403020105000414"},this.MT={DT:"cryptojs",sha1:"cryptojs",IT:"cryptojs",sha256:"cryptojs",NT:"cryptojs",CT:"cryptojs",jT:"cryptojs",PT:"cryptojs",LT:"cryptojs",HT:"cryptojs",UT:"cryptojs",FT:"cryptojs",GT:"cryptojs",xT:"cryptojs",BT:"cryptojs/jsrsa",VT:"cryptojs/jsrsa",qT:"cryptojs/jsrsa",QT:"cryptojs/jsrsa",YT:"cryptojs/jsrsa",KT:"cryptojs/jsrsa",WT:"cryptojs/jsrsa",$T:"cryptojs/jsrsa",XT:"cryptojs/jsrsa",zT:"cryptojs/jsrsa",JT:"cryptojs/jsrsa",ZT:"cryptojs/jsrsa",tO:"cryptojs/jsrsa",iO:"cryptojs/jsrsa",nO:"cryptojs/jsrsa",rO:"cryptojs/jsrsa",sO:"cryptojs/jsrsa",eO:"cryptojs/jsrsa",hO:"cryptojs/jsrsa",oO:"cryptojs/jsrsa",uO:"cryptojs/jsrsa",aO:"cryptojs/jsrsa",fO:"cryptojs/jsrsa",cO:"cryptojs/jsrsa"},this.lO={DT:I.Jg.ul,sha1:I.Jg.ib,IT:I.Jg.vO,sha256:I.Jg.dO,NT:I.Jg.EO,CT:I.Jg.wO,jT:I.Jg.pO},this.gO=function(t,i){if(void 0===this.AT[i])throw"alg not supported in Util.DIGESTINFOHEAD: "+i;return this.AT[i]+t},this.bO=function(t,i,n){var r=this.gO(t,i),s=n/4;if(r.length+22>s)throw"key is too short for SigAlg: keylen="+n+","+i;for(var e="00"+r,h="",o=s-"0001".length-e.length,u=0;u<o;u+=2)h+="ff";return"0001"+h+e},this.yO=function(t,i){return new g.crypto.OO({mO:i}).TO(t)},this._O=function(t,i){return new g.crypto.OO({mO:i}).RO(t)},this.sha1=function(t){return new g.crypto.OO({mO:"sha1",SO:"cryptojs"}).TO(t)},this.sha256=function(t){return new g.crypto.OO({mO:"sha256",SO:"cryptojs"}).TO(t)},this.AO=function(t){return new g.crypto.OO({mO:"sha256",SO:"cryptojs"}).RO(t)},this.CT=function(t){return new g.crypto.OO({mO:"sha512",SO:"cryptojs"}).TO(t)},this.IO=function(t){return new g.crypto.OO({mO:"sha512",SO:"cryptojs"}).RO(t)},this.DT=function(t){return new g.crypto.OO({mO:"md5",SO:"cryptojs"}).TO(t)},this.jT=function(t){return new g.crypto.OO({mO:"ripemd160",SO:"cryptojs"}).TO(t)},this.NO=function(t){}})(),g.crypto.OO=function(t){this.CO=function(i,t){if(null!=i&&void 0===t&&(t=g.crypto.ST.MT[i]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(i)&&"cryptojs"==t){try{this.kO=g.crypto.ST.lO[i].create()}catch(t){throw"setAlgAndProvider hash alg set fail alg="+i+"/"+t}this.DO=function(t){this.kO.update(t)},this.jO=function(t){var i=I.jg.Mg.parse(t);this.kO.update(i)},this.digest=function(){return this.kO.Kg().toString(I.jg.Mg)},this.TO=function(t){return this.DO(t),this.digest()},this.RO=function(t){return this.jO(t),this.digest()}}if(-1!=":sha256:".indexOf(i)&&"sjcl"==t){try{this.kO=new sjcl.hash.sha256()}catch(t){throw"setAlgAndProvider hash alg set fail alg="+i+"/"+t}this.DO=function(t){this.kO.update(t)},this.jO=function(t){var i=sjcl.PO.Qy.MO(t);this.kO.update(i)},this.digest=function(){var t=this.kO.Kg();return sjcl.PO.Qy.LO(t)},this.TO=function(t){return this.DO(t),this.digest()},this.RO=function(t){return this.jO(t),this.digest()}}},this.DO=function(t){throw"updateString(str) not supported for this alg/prov: "+this.HO+"/"+this.UO},this.jO=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.HO+"/"+this.UO},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.HO+"/"+this.UO},this.TO=function(t){throw"digestString(str) not supported for this alg/prov: "+this.HO+"/"+this.UO},this.RO=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.HO+"/"+this.UO},void 0!==t&&void 0!==t.mO&&(this.HO=t.mO,void 0===t.SO&&(this.UO=g.crypto.ST.MT[this.HO]),this.CO(this.HO,this.UO))},g.crypto.FO=function(t){this.CO=function(t,i){if(null==(t=t.toLowerCase())&&(t="hmacsha1"),"hmac"!=(t=t.toLowerCase()).substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+t;void 0===i&&(i=g.crypto.ST.MT[t]),this.GO=t+"/"+i;var n=t.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(n)&&"cryptojs"==i){try{var r=g.crypto.ST.lO[n];this.mac=I.Jg.zg.create(r,this.xO)}catch(t){throw"setAlgAndProvider hash alg set fail hashAlg="+n+"/"+t}this.DO=function(t){this.mac.update(t)},this.jO=function(t){var i=I.jg.Mg.parse(t);this.mac.update(i)},this.BO=function(){return this.mac.Kg().toString(I.jg.Mg)},this.VO=function(t){return this.DO(t),this.BO()},this.qO=function(t){return this.jO(t),this.BO()}}},this.DO=function(t){throw"updateString(str) not supported for this alg/prov: "+this.GO},this.jO=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.GO},this.BO=function(){throw"digest() not supported for this alg/prov: "+this.GO},this.VO=function(t){throw"digestString(str) not supported for this alg/prov: "+this.GO},this.qO=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.GO},this.QO=function(t){if("string"==typeof t){var i=t;return t.length%2!=1&&t.match(/^[0-9A-Fa-f]+$/)||(i=rstrtohex(t)),void (this.xO=I.jg.Mg.parse(i))}if("object"!=typeof t)throw"KJUR.crypto.Mac unsupported password type: "+t;i=null;if(void 0!==t.Qy){if(t.Qy.length%2!=0||!t.Qy.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+t.Qy;i=t.Qy}if(void 0!==t.YO&&(i=utf8tohex(t.YO)),void 0!==t.KO&&(i=rstrtohex(t.KO)),void 0!==t.WO&&(i=j(t.WO)),void 0!==t.$O&&(i=b64utohex(t.$O)),null==i)throw"KJUR.crypto.Mac unsupported password type: "+t;this.xO=I.jg.Mg.parse(i)},void 0!==t&&(void 0!==t.xO&&this.QO(t.xO),void 0!==t.mO&&(this.HO=t.mO,void 0===t.SO&&(this.UO=g.crypto.ST.MT[this.HO]),this.CO(this.HO,this.UO)))},g.crypto.Signature=function(t){var i=null;if(this.XO=function(){this.HO.match(/^(.+)with(.+)$/)&&(this.zO=RegExp.$1.toLowerCase(),this.JO=RegExp.$2.toLowerCase())},this.ZO=function(t,i){for(var n="",r=i/4-t.length,s=0;s<r;s++)n+="0";return n+t},this.CO=function(t,i){if(this.XO(),"cryptojs/jsrsa"!=i)throw"provider not supported: "+i;if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.zO)){try{this.kO=new g.crypto.OO({mO:this.zO})}catch(t){throw"setAlgAndProvider hash alg set fail alg="+this.zO+"/"+t}this.init=function(t,i){var n=null;try{n=void 0===i?KEYUTIL.getKey(t):KEYUTIL.getKey(t,i)}catch(t){throw"init failed:"+t}if(!0===n.tm)this.im=n,this.state="SIGN";else{if(!0!==n.$b)throw"init failed.:"+n;this.nm=n,this.state="VERIFY"}},this.rm=function(t){"string"==typeof t.sm&&"string"==typeof t.em?(this.sm=t.sm,this.em=t.em):this.im=t,this.state="SIGN"},this.hm=function(t){"string"==typeof t.om&&"string"==typeof t.em?(this.om=t.om,this.em=t.em):t instanceof g.crypto.um?this.nm=t:t instanceof W&&(this.nm=t),this.state="VERIFY"},this.am=function(t){var i=new X509();i.fm(t),this.nm=i.cm,this.state="VERIFY"},this.DO=function(t){this.kO.DO(t)},this.jO=function(t){this.kO.jO(t)},this.sign=function(){if(this.lm=this.kO.digest(),void 0!==this.sm&&void 0!==this.em){var t=new g.crypto.um({curve:this.em});this.vm=t.dm(this.lm,this.sm)}else if(this.im instanceof W&&"rsaandmgf1"==this.JO)this.vm=this.im.Em(this.lm,this.zO,this.wm);else if(this.im instanceof W&&"rsa"==this.JO)this.vm=this.im.pm(this.lm,this.zO);else if(this.im instanceof g.crypto.um)this.vm=this.im.pm(this.lm);else{if(!(this.im instanceof g.crypto.gm))throw"Signature: unsupported public key alg: "+this.JO;this.vm=this.im.pm(this.lm)}return this.vm},this.bm=function(t){return this.DO(t),this.sign()},this.dm=function(t){return this.jO(t),this.sign()},this.verify=function(t){if(this.lm=this.kO.digest(),void 0!==this.om&&void 0!==this.em)return new g.crypto.um({curve:this.em}).ym(this.lm,t,this.om);if(this.nm instanceof W&&"rsaandmgf1"==this.JO)return this.nm.Tm(this.lm,t,this.zO,this.wm);if(this.nm instanceof W&&"rsa"==this.JO)return this.nm.Om(this.lm,t);if(this.nm instanceof g.crypto.um)return this.nm.Om(this.lm,t);if(this.nm instanceof g.crypto.gm)return this.nm.Om(this.lm,t);throw"Signature: unsupported public key alg: "+this.JO}}},this.init=function(t,i){throw"init(key, pass) not supported for this alg:prov="+this.mm},this.hm=function(t){throw"initVerifyByPublicKey(rsaPubKeyy) not supported for this alg:prov="+this.mm},this.am=function(t){throw"initVerifyByCertificatePEM(certPEM) not supported for this alg:prov="+this.mm},this.rm=function(t){throw"initSign(prvKey) not supported for this alg:prov="+this.mm},this.DO=function(t){throw"updateString(str) not supported for this alg:prov="+this.mm},this.jO=function(t){throw"updateHex(hex) not supported for this alg:prov="+this.mm},this.sign=function(){throw"sign() not supported for this alg:prov="+this.mm},this.bm=function(t){throw"digestString(str) not supported for this alg:prov="+this.mm},this.dm=function(t){throw"digestHex(hex) not supported for this alg:prov="+this.mm},this.verify=function(t){throw"verify(hSigVal) not supported for this alg:prov="+this.mm},void 0!==(this._m=t)&&(void 0!==t.mO&&(this.HO=t.mO,void 0===t.SO?this.UO=g.crypto.ST.MT[this.HO]:this.UO=t.SO,this.mm=this.HO+":"+this.UO,this.CO(this.HO,this.UO),this.XO()),void 0!==t.Rm&&(this.wm=t.Rm),void 0!==t.Sm)){if(void 0!==t.Am)throw"both prvkeypem and prvkeypas parameters not supported";try{(i=new W()).Im(t.Sm),this.rm(i)}catch(t){throw"fatal error to load pem private key: "+t}}},g.crypto.ET=new function(){this.Nm={Cm:"rsaEncryption",km:"ecPublicKey",Dm:"dsa",jm:"secp256r1",Mm:"secp192k1",Pm:"secp224r1",Lm:"secp256k1",Hm:"secp521r1",Um:"secp384r1",Fm:"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}}();var $=new RegExp("");function X(t,i){for(var n="",r=i/4-t.length,s=0;s<r;s++)n+="0";return n+t}function z(t,i){var n,r=(n=t,g.crypto.ST.yO(n,i));return this.pm(r,i)}function J(t){return z.call(this,t,"sha1")}function Z(t){return z.call(this,t,"sha256")}function tt(t,i,n){for(var r="",s=0;r.length<i;)r+=hextorstr(n(rstrtohex(t+String.fromCharCode.apply(String,[(4278190080&s)>>24,(16711680&s)>>16,(65280&s)>>8,255&s])))),s+=1;return r}function it(t,i,n){var r,s=(r=rstrtohex(t),g.crypto.ST._O(r,i));return void 0===n&&(n=-1),this.Em(s,i,n)}function nt(t,i,n){return function(t,i,n){var r=new W();return r.Wb(i,n),r.Kb(t)}(t,i,n).toString(16).replace(/^1f+00/,"")}function rt(t){for(var i in g.crypto.ST.AT){var n=g.crypto.ST.AT[i],r=n.length;if(t.substring(0,r)==n)return[i,t.substring(r)]}return[]}function st(t,i){return function(t,i,n,r){var s=rt(nt(i,n,r));if(0==s.length)return!1;var e,h=s[0];return s[1]==(e=t,g.crypto.ST.yO(e,h))}(i,Q(t,16),this.n.toString(16),this.e.toString(16))}function et(t,i){var n=Q(i=(i=i.replace($,"")).replace(/[ \n]+/g,""),16);if(n.Gb()>this.n.Gb())return 0;var r=rt(this.Kb(n).toString(16).replace(/^1f+00/,""));if(0==r.length)return!1;var s,e=r[0];return r[1]==(s=t,g.crypto.ST.yO(s,e))}function ht(t,i,n,r){var s,e=(s=rstrtohex(t),g.crypto.ST._O(s,n));return void 0===r&&(r=-1),this.Tm(e,i,n,r)}$.compile("[^0-9a-f]","gi"),W.prototype.pm=function(t,i){var n=Q(g.crypto.ST.bO(t,i,this.n.Gb()),16);return X(this.Gm(n).toString(16),this.n.Gb())},W.prototype.bm=z,W.prototype.xm=J,W.prototype.Bm=Z,W.prototype.sign=z,W.prototype.Vm=J,W.prototype.qm=Z,W.prototype.Em=function(t,i,n){function r(t){return g.crypto.ST._O(t,i)}var s,e=hextorstr(t),h=e.length,o=this.n.Gb()-1,u=Math.ceil(o/8);if(-1===n||void 0===n)n=h;else if(-2===n)n=u-h-2;else if(n<-2)throw"invalid salt length";if(u<h+n+2)throw"data too long";var a="";0<n&&(a=new Array(n),new SecureRandom().Xb(a),a=String.fromCharCode.apply(String,a));var f=hextorstr(r(rstrtohex("\0\0\0\0\0\0\0\0"+e+a))),c=[];for(s=0;s<u-n-h-2;s+=1)c[s]=0;var l=String.fromCharCode.apply(String,c)+"\x01"+a,v=tt(f,l.length,r),d=[];for(s=0;s<l.length;s+=1)d[s]=l.charCodeAt(s)^v.charCodeAt(s);var E=65280>>8*u-o&255;for(d[0]&=~E,s=0;s<h;s++)d.push(f.charCodeAt(s));return d.push(188),X(this.Gm(new M(d)).toString(16),this.n.Gb())},W.prototype.Qm=it,W.prototype.Ym=it,W.Km=-1,W.Wm=-2,W.prototype.Om=function(t,i){var n=Q(i=(i=i.replace($,"")).replace(/[ \n]+/g,""),16);if(n.Gb()>this.n.Gb())return 0;var r=rt(this.Kb(n).toString(16).replace(/^1f+00/,""));return 0!=r.length&&(r[0],r[1]==t)},W.prototype.$m=et,W.prototype.Xm=st,W.prototype.verify=et,W.prototype.zm=st,W.prototype.Tm=function(t,i,n,r){var s=new M(i,16);if(s.Gb()>this.n.Gb())return!1;function e(t){return g.crypto.ST._O(t,n)}var h,o=hextorstr(t),u=o.length,a=this.n.Gb()-1,f=Math.ceil(a/8);if(-1===r||void 0===r)r=u;else if(-2===r)r=f-u-2;else if(r<-2)throw"invalid salt length";if(f<u+r+2)throw"data too long";var c=this.Kb(s).Jm();for(h=0;h<c.length;h+=1)c[h]&=255;for(;c.length<f;)c.unshift(0);if(188!==c[f-1])throw"encoded message does not end in 0xbc";var l=(c=String.fromCharCode.apply(String,c)).substr(0,f-u-1),v=c.substr(l.length,u),d=65280>>8*f-a&255;if(0!=(l.charCodeAt(0)&d))throw"bits beyond keysize not zero";var E=tt(v,l.length,e),w=[];for(h=0;h<l.length;h+=1)w[h]=l.charCodeAt(h)^E.charCodeAt(h);w[0]&=~d;var p=f-u-r-2;for(h=0;h<p;h+=1)if(0!==w[h])throw"leftmost octets not zero";if(1!==w[p])throw"0x01 marker not found";return v===hextorstr(e(rstrtohex("\0\0\0\0\0\0\0\0"+o+String.fromCharCode.apply(String,w.slice(-r)))))},W.prototype.Zm=ht,W.prototype.t_=ht,W.i_=-2,i.n_=M,i.r_=W,i.Signature=g.crypto.Signature,i.OO=g.crypto.OO,i.ol=I,i.s_=j,i.e_=function(t){var i,n=j(t),r=new Array();for(i=0;2*i<n.length;++i)r[i]=parseInt(n.substring(2*i,2*i+2),16);return r}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r,e=n(0),s=n(6);(r=i.h_||(i.h_={}))[r.o_=0]="UPPER_LAYER",r[r.u_=1]="CDN",r[r.a_=2]="CDN_PREFETCH",r[r.f_=3]="CDN_COMPENSATION",r[r.c_=4]="P2P",r[r.l_=5]="P2P_PREFETCH";var h=function(){this.v_=!1,this.d_=0,this.E_=0,this.w_=0,this.p_=0,this.g_=0,this.p2pAgenTrafficSuccessQt=0,this.b_=0,this.srcOtherRespQt=0,this.y_=0,this.T_=0,this.O_=0,this.m_=0};i.__=h;var o=(u.prototype.R_=function(){return this.type},u.prototype.S_=function(){return this.A_.S_()},u.prototype.I_=function(){return this.A_.I_()},u.prototype.N_=function(){return this.I_()+"-"+this.C_},u.prototype.k_=function(){return this.A_.D_()},u.prototype.j_=function(){return this.A_.M_()},u.prototype.P_=function(){return Math.max(1,this.L_.m_-this.L_.O_)},u.prototype.H_=function(){return Math.max(1,this.L_.m_-this.L_.T_)},u.prototype.U_=function(){return 0!=this.L_.g_?new s.ma(this.P_(),this.L_.g_):new s.ma(this.H_(),this.L_.E_)},u.prototype.getResponse=function(){return this.xhr?this.xhr.response:this.F_},u.prototype.G_=function(){return this.responseText},u.prototype.x_=function(){return this.L_.d_},u.prototype.B_=function(){throw new Error("Not implemented")},u.prototype.V_=function(){return this.A_},u);function u(t,i,n,r,s){this.q_=!1,this.type=void 0,this.L_=new h(),this.Q_=!1,this.Y_=!1,this.K_="",this.F_=new ArrayBuffer(0),this.W_=0,this.type=n,this.X_=t,this.C_=i,this.z_=s,this.A_=r,this.L_.y_=e.Framework.time()}i.J_=o},function(t,i,n){var j=n(22),M=window.hive;void 0===M&&(M=window.hive={}),void 0===M.services&&(M.services={}),void 0===M.services.protocol&&(M.services.protocol={}),void 0===M.services.protocol.tracker&&(M.services.protocol.tracker={}),M.services.protocol.tracker.TrackerPeerStreamState={1:"PLAYER",Z_:1,2:"P2P_AGENT",tR:2,3:"PREFETCHER_FIRST_TIER",iR:3,4:"PREFETCHER_SECOND_TIER",nR:4},M.services.protocol.tracker.TrackerRankType={1:"Global",Global:1,2:"InternalAs",rR:2,3:"ExternalAs",sR:3,4:"LocalityAs",eR:4},M.services.protocol.tracker.TrackerAsType={1:"Internal",hR:1,2:"External",External:2,3:"Locality",oR:"3"},M.services.protocol.tracker.TrackerPeerStreamInfo=function(t){this.state=null,this.bitrate=null,this.delta=null,this.qualityLevel=null,t&&(void 0!==t.state&&null!==t.state&&(this.state=t.state),void 0!==t.bitrate&&null!==t.bitrate&&(this.bitrate=t.bitrate),void 0!==t.delta&&null!==t.delta&&(this.delta=t.delta),void 0!==t.qualityLevel&&null!==t.qualityLevel&&(this.qualityLevel=t.qualityLevel))},M.services.protocol.tracker.TrackerPeerStreamInfo.prototype={},M.services.protocol.tracker.TrackerPeerStreamInfo.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.I32?this.state=t.zE().value:t.XE(n);break;case 2:n==j.Type.I32?this.bitrate=t.zE().value:t.XE(n);break;case 3:n==j.Type.I32?this.delta=t.zE().value:t.XE(n);break;case 4:n==j.Type.STRING?this.qualityLevel=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerPeerStreamInfo.prototype.write=function(t){t.tw("TrackerPeerStreamInfo"),null!==this.state&&void 0!==this.state&&(t.iw("state",j.Type.I32,1),t.sw(this.state),t.rw()),null!==this.bitrate&&void 0!==this.bitrate&&(t.iw("bitrate",j.Type.I32,2),t.sw(this.bitrate),t.rw()),null!==this.delta&&void 0!==this.delta&&(t.iw("delta",j.Type.I32,3),t.sw(this.delta),t.rw()),null!==this.qualityLevel&&void 0!==this.qualityLevel&&(t.iw("qualityLevel",j.Type.STRING,4),t.nw(this.qualityLevel),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.TrackerPeerInfo=function(t){this.guid=null,this.internalAs=null,this.externalAs=null,this.nat=null,this.bandwidth=null,this.watchingBitrate=null,this.privateIp=null,this.publicIp=null,this.streams=null,this.rankValue=null,this.timestamp=null,this.publicIpString=null,this.privateIpString=null,this.watchingQualityLevel=null,this.localityGroupId=null,t&&(void 0!==t.guid&&null!==t.guid&&(this.guid=t.guid),void 0!==t.internalAs&&null!==t.internalAs&&(this.internalAs=t.internalAs),void 0!==t.externalAs&&null!==t.externalAs&&(this.externalAs=t.externalAs),void 0!==t.nat&&null!==t.nat&&(this.nat=t.nat),void 0!==t.bandwidth&&null!==t.bandwidth&&(this.bandwidth=t.bandwidth),void 0!==t.watchingBitrate&&null!==t.watchingBitrate&&(this.watchingBitrate=t.watchingBitrate),void 0!==t.privateIp&&null!==t.privateIp&&(this.privateIp=t.privateIp),void 0!==t.publicIp&&null!==t.publicIp&&(this.publicIp=t.publicIp),void 0!==t.streams&&null!==t.streams&&(this.streams=t.streams),void 0!==t.rankValue&&null!==t.rankValue&&(this.rankValue=t.rankValue),void 0!==t.timestamp&&null!==t.timestamp&&(this.timestamp=t.timestamp),void 0!==t.publicIpString&&null!==t.publicIpString&&(this.publicIpString=t.publicIpString),void 0!==t.privateIpString&&null!==t.privateIpString&&(this.privateIpString=t.privateIpString),void 0!==t.watchingQualityLevel&&null!==t.watchingQualityLevel&&(this.watchingQualityLevel=t.watchingQualityLevel),void 0!==t.localityGroupId&&null!==t.localityGroupId&&(this.localityGroupId=t.localityGroupId))},M.services.protocol.tracker.TrackerPeerInfo.prototype={},M.services.protocol.tracker.TrackerPeerInfo.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.STRING?this.guid=t.Sp().value:t.XE(n);break;case 2:n==j.Type.I32?this.internalAs=t.zE().value:t.XE(n);break;case 3:n==j.Type.I32?this.externalAs=t.zE().value:t.XE(n);break;case 4:n==j.Type.I32?this.nat=t.zE().value:t.XE(n);break;case 5:n==j.Type.I32?this.bandwidth=t.zE().value:t.XE(n);break;case 6:n==j.Type.I32?this.watchingBitrate=t.zE().value:t.XE(n);break;case 7:n==j.Type.STRUCT?(this.privateIp=new InetAddress(),this.privateIp.read(t)):t.XE(n);break;case 8:n==j.Type.STRUCT?(this.publicIp=new InetAddress(),this.publicIp.read(t)):t.XE(n);break;case 9:if(n==j.Type.LIST){var s,e;this.streams=[];(e=t.wp()).pp,s=e.size;for(var h=0;h<s;++h){var o=null;(o=new M.services.protocol.tracker.TrackerPeerStreamInfo()).read(t),this.streams.push(o)}t.gp()}else t.XE(n);break;case 10:n==j.Type.DOUBLE?this.rankValue=t.Rp().value:t.XE(n);break;case 11:n==j.Type.I64?this.timestamp=t._p().value:t.XE(n);break;case 12:n==j.Type.STRING?this.publicIpString=t.$E().value:t.XE(n);break;case 13:n==j.Type.STRING?this.privateIpString=t.$E().value:t.XE(n);break;case 14:n==j.Type.STRING?this.watchingQualityLevel=t.$E().value:t.XE(n);break;case 15:n==j.Type.I32?this.localityGroupId=t.zE().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerPeerInfo.prototype.write=function(t){if(t.tw("TrackerPeerInfo"),null!==this.guid&&void 0!==this.guid&&(t.iw("guid",j.Type.STRING,1),t.ep(this.guid),t.rw()),null!==this.internalAs&&void 0!==this.internalAs&&(t.iw("internalAs",j.Type.I32,2),t.sw(this.internalAs),t.rw()),null!==this.externalAs&&void 0!==this.externalAs&&(t.iw("externalAs",j.Type.I32,3),t.sw(this.externalAs),t.rw()),null!==this.nat&&void 0!==this.nat&&(t.iw("nat",j.Type.I32,4),t.sw(this.nat),t.rw()),null!==this.bandwidth&&void 0!==this.bandwidth&&(t.iw("bandwidth",j.Type.I32,5),t.sw(this.bandwidth),t.rw()),null!==this.watchingBitrate&&void 0!==this.watchingBitrate&&(t.iw("watchingBitrate",j.Type.I32,6),t.sw(this.watchingBitrate),t.rw()),null!==this.privateIp&&void 0!==this.privateIp&&(t.iw("privateIp",j.Type.STRUCT,7),this.privateIp.write(t),t.rw()),null!==this.publicIp&&void 0!==this.publicIp&&(t.iw("publicIp",j.Type.STRUCT,8),this.publicIp.write(t),t.rw()),null!==this.streams&&void 0!==this.streams){for(var i in t.iw("streams",j.Type.LIST,9),t.$w(j.Type.STRUCT,this.streams.length),this.streams)this.streams.hasOwnProperty(i)&&(i=this.streams[i]).write(t);t.Xw(),t.rw()}null!==this.rankValue&&void 0!==this.rankValue&&(t.iw("rankValue",j.Type.DOUBLE,10),t.sp(this.rankValue),t.rw()),null!==this.timestamp&&void 0!==this.timestamp&&(t.iw("timestamp",j.Type.I64,11),t.rp(this.timestamp),t.rw()),null!==this.publicIpString&&void 0!==this.publicIpString&&(t.iw("publicIpString",j.Type.STRING,12),t.nw(this.publicIpString),t.rw()),null!==this.privateIpString&&void 0!==this.privateIpString&&(t.iw("privateIpString",j.Type.STRING,13),t.nw(this.privateIpString),t.rw()),null!==this.watchingQualityLevel&&void 0!==this.watchingQualityLevel&&(t.iw("watchingQualityLevel",j.Type.STRING,14),t.nw(this.watchingQualityLevel),t.rw()),null!==this.localityGroupId&&void 0!==this.localityGroupId&&(t.iw("localityGroupId",j.Type.I32,15),t.sw(this.localityGroupId),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.CustomerKey=function(t){this.partnerId=null,this.customerId=null,t&&(void 0!==t.partnerId&&null!==t.partnerId&&(this.partnerId=t.partnerId),void 0!==t.customerId&&null!==t.customerId&&(this.customerId=t.customerId))},M.services.protocol.tracker.CustomerKey.prototype={},M.services.protocol.tracker.CustomerKey.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.STRING?this.partnerId=t.$E().value:t.XE(n);break;case 2:n==j.Type.STRING?this.customerId=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.CustomerKey.prototype.write=function(t){t.tw("CustomerKey"),null!==this.partnerId&&void 0!==this.partnerId&&(t.iw("partnerId",j.Type.STRING,1),t.nw(this.partnerId),t.rw()),null!==this.customerId&&void 0!==this.customerId&&(t.iw("customerId",j.Type.STRING,2),t.nw(this.customerId),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.TrackerAsQuery=function(t){this.asType=null,this.asn=null,t&&(void 0!==t.asType&&null!==t.asType&&(this.asType=t.asType),void 0!==t.asn&&null!==t.asn&&(this.asn=t.asn))},M.services.protocol.tracker.TrackerAsQuery.prototype={},M.services.protocol.tracker.TrackerAsQuery.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.I32?this.asType=t.zE().value:t.XE(n);break;case 2:n==j.Type.I32?this.asn=t.zE().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerAsQuery.prototype.write=function(t){t.tw("TrackerAsQuery"),null!==this.asType&&void 0!==this.asType&&(t.iw("asType",j.Type.I32,1),t.sw(this.asType),t.rw()),null!==this.asn&&void 0!==this.asn&&(t.iw("asn",j.Type.I32,2),t.sw(this.asn),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.TrackerBitrateQuery=function(t){this.bitrate=null,this.asn=null,this.streamState=null,t&&(void 0!==t.bitrate&&null!==t.bitrate&&(this.bitrate=t.bitrate),void 0!==t.asn&&null!==t.asn&&(this.asn=t.asn),void 0!==t.streamState&&null!==t.streamState&&(this.streamState=t.streamState))},M.services.protocol.tracker.TrackerBitrateQuery.prototype={},M.services.protocol.tracker.TrackerBitrateQuery.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.I32?this.bitrate=t.zE().value:t.XE(n);break;case 2:n==j.Type.STRUCT?(this.asn=new M.services.protocol.tracker.TrackerAsQuery(),this.asn.read(t)):t.XE(n);break;case 3:n==j.Type.I32?this.streamState=t.zE().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerBitrateQuery.prototype.write=function(t){t.tw("TrackerBitrateQuery"),null!==this.bitrate&&void 0!==this.bitrate&&(t.iw("bitrate",j.Type.I32,1),t.sw(this.bitrate),t.rw()),null!==this.asn&&void 0!==this.asn&&(t.iw("asn",j.Type.STRUCT,2),this.asn.write(t),t.rw()),null!==this.streamState&&void 0!==this.streamState&&(t.iw("streamState",j.Type.I32,3),t.sw(this.streamState),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.TrackerQualityLevelQuery=function(t){this.qualityLevel=null,this.asn=null,this.streamState=null,t&&(void 0!==t.qualityLevel&&null!==t.qualityLevel&&(this.qualityLevel=t.qualityLevel),void 0!==t.asn&&null!==t.asn&&(this.asn=t.asn),void 0!==t.streamState&&null!==t.streamState&&(this.streamState=t.streamState))},M.services.protocol.tracker.TrackerQualityLevelQuery.prototype={},M.services.protocol.tracker.TrackerQualityLevelQuery.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.STRING?this.qualityLevel=t.$E().value:t.XE(n);break;case 2:n==j.Type.STRUCT?(this.asn=new M.services.protocol.tracker.TrackerAsQuery(),this.asn.read(t)):t.XE(n);break;case 3:n==j.Type.I32?this.streamState=t.zE().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerQualityLevelQuery.prototype.write=function(t){t.tw("TrackerQualityLevelQuery"),null!==this.qualityLevel&&void 0!==this.qualityLevel&&(t.iw("qualityLevel",j.Type.STRING,1),t.nw(this.qualityLevel),t.rw()),null!==this.asn&&void 0!==this.asn&&(t.iw("asn",j.Type.STRUCT,2),this.asn.write(t),t.rw()),null!==this.streamState&&void 0!==this.streamState&&(t.iw("streamState",j.Type.I32,3),t.sw(this.streamState),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.TrackerRankQuery=function(t){this.rankType=null,this.asQuery=null,t&&(void 0!==t.rankType&&null!==t.rankType&&(this.rankType=t.rankType),void 0!==t.asQuery&&null!==t.asQuery&&(this.asQuery=t.asQuery))},M.services.protocol.tracker.TrackerRankQuery.prototype={},M.services.protocol.tracker.TrackerRankQuery.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.I32?this.rankType=t.zE().value:t.XE(n);break;case 2:n==j.Type.STRUCT?(this.asQuery=new M.services.protocol.tracker.TrackerAsQuery(),this.asQuery.read(t)):t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerRankQuery.prototype.write=function(t){t.tw("TrackerRankQuery"),null!==this.rankType&&void 0!==this.rankType&&(t.iw("rankType",j.Type.I32,1),t.sw(this.rankType),t.rw()),null!==this.asQuery&&void 0!==this.asQuery&&(t.iw("asQuery",j.Type.STRUCT,2),this.asQuery.write(t),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.TrackerQuery=function(t){this.random=null,this.asns=null,this.watchers=null,this.streamers=null,this.rankings=null,this.watchersForQualityLevel=null,this.streamersForQualityLevel=null,t&&(void 0!==t.random&&null!==t.random&&(this.random=t.random),void 0!==t.asns&&null!==t.asns&&(this.asns=t.asns),void 0!==t.watchers&&null!==t.watchers&&(this.watchers=t.watchers),void 0!==t.streamers&&null!==t.streamers&&(this.streamers=t.streamers),void 0!==t.rankings&&null!==t.rankings&&(this.rankings=t.rankings),void 0!==t.watchersForQualityLevel&&null!==t.watchersForQualityLevel&&(this.watchersForQualityLevel=t.watchersForQualityLevel),void 0!==t.streamersForQualityLevel&&null!==t.streamersForQualityLevel&&(this.streamersForQualityLevel=t.streamersForQualityLevel))},M.services.protocol.tracker.TrackerQuery.prototype={},M.services.protocol.tracker.TrackerQuery.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.I32?this.random=t.zE().value:t.XE(n);break;case 2:if(n==j.Type.MAP){var s,e;this.asns={};(e=t.lp()).vp,e.dp,s=e.size;for(var h=0;h<s;++h){0<h&&t.hp.length>t.aw[t.aw.length-1]+1&&t.hp.pop();var o,u=null;(u=new M.services.protocol.tracker.TrackerAsQuery()).read(t),o=t.zE().value,this.asns[u]=o}t.Ep()}else t.XE(n);break;case 3:if(n==j.Type.MAP){var a,f;this.watchers={};(f=t.lp()).vp,f.dp,a=f.size;for(var c=0;c<a;++c){0<c&&t.hp.length>t.aw[t.aw.length-1]+1&&t.hp.pop();var l,v=null;(v=new M.services.protocol.tracker.TrackerBitrateQuery()).read(t),l=t.zE().value,this.watchers[v]=l}t.Ep()}else t.XE(n);break;case 4:if(n==j.Type.MAP){var d,E;this.streamers={};(E=t.lp()).vp,E.dp,d=E.size;for(var w=0;w<d;++w){0<w&&t.hp.length>t.aw[t.aw.length-1]+1&&t.hp.pop();var p,g=null;(g=new M.services.protocol.tracker.TrackerBitrateQuery()).read(t),p=t.zE().value,this.streamers[g]=p}t.Ep()}else t.XE(n);break;case 5:if(n==j.Type.LIST){var b,y;this.rankings=[];(y=t.wp()).pp,b=y.size;for(var T=0;T<b;++T){var O;O=t.zE().value,this.rankings.push(O)}t.gp()}else t.XE(n);break;case 6:if(n==j.Type.MAP){var m,_;this.watchersForQualityLevel={};(_=t.lp()).vp,_.dp,m=_.size;for(var R=0;R<m;++R){0<R&&t.hp.length>t.aw[t.aw.length-1]+1&&t.hp.pop();var S,A=null;(A=new M.services.protocol.tracker.TrackerQualityLevelQuery()).read(t),S=t.zE().value,this.watchersForQualityLevel[A]=S}t.Ep()}else t.XE(n);break;case 7:if(n==j.Type.MAP){var I,N;this.streamersForQualityLevel={};(N=t.lp()).vp,N.dp,I=N.size;for(var C=0;C<I;++C){0<C&&t.hp.length>t.aw[t.aw.length-1]+1&&t.hp.pop();var k,D=null;(D=new M.services.protocol.tracker.TrackerQualityLevelQuery()).read(t),k=t.zE().value,this.streamersForQualityLevel[D]=k}t.Ep()}else t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerQuery.prototype.write=function(t){if(t.tw("TrackerQuery"),null!==this.random&&void 0!==this.random&&(t.iw("random",j.Type.I32,1),t.sw(this.random),t.rw()),null!==this.asns&&void 0!==this.asns){for(var i in t.iw("asns",j.Type.MAP,2),t.Kw(j.Type.STRUCT,j.Type.I32,j.kE(this.asns)),this.asns)if(this.asns.hasOwnProperty(i)){var n=this.asns[i];n.key.write(t),t.sw(n.value)}t.Ww(),t.rw()}if(null!==this.watchers&&void 0!==this.watchers){for(var r in t.iw("watchers",j.Type.MAP,3),t.Kw(j.Type.STRUCT,j.Type.I32,j.kE(this.watchers)),this.watchers)if(this.watchers.hasOwnProperty(r)){var s=this.watchers[r];s.key.write(t),t.sw(s.value)}t.Ww(),t.rw()}if(null!==this.streamers&&void 0!==this.streamers){for(var e in t.iw("streamers",j.Type.MAP,4),t.Kw(j.Type.STRUCT,j.Type.I32,j.kE(this.streamers)),this.streamers)if(this.streamers.hasOwnProperty(e)){var h=this.streamers[e];h.key.write(t),t.sw(h.value)}t.Ww(),t.rw()}if(null!==this.rankings&&void 0!==this.rankings){for(var o in t.iw("rankings",j.Type.LIST,5),t.$w(j.Type.I32,this.rankings.length),this.rankings)this.rankings.hasOwnProperty(o)&&(o=this.rankings[o],t.sw(o));t.Xw(),t.rw()}if(null!==this.watchersForQualityLevel&&void 0!==this.watchersForQualityLevel){for(var u in t.iw("watchersForQualityLevel",j.Type.MAP,6),t.Kw(j.Type.STRUCT,j.Type.I32,j.kE(this.watchersForQualityLevel)),this.watchersForQualityLevel)if(this.watchersForQualityLevel.hasOwnProperty(u)){var a=this.watchersForQualityLevel[u];a.key.write(t),t.sw(a.value)}t.Ww(),t.rw()}if(null!==this.streamersForQualityLevel&&void 0!==this.streamersForQualityLevel){for(var f in t.iw("streamersForQualityLevel",j.Type.MAP,7),t.Kw(j.Type.STRUCT,j.Type.I32,j.kE(this.streamersForQualityLevel)),this.streamersForQualityLevel)if(this.streamersForQualityLevel.hasOwnProperty(f)){var c=this.streamersForQualityLevel[f];c.key.write(t),t.sw(c.value)}t.Ww(),t.rw()}t.ew(),t.hw()},M.services.protocol.tracker.TrackerPeerRankingKey=function(t){this.rankType=null,this.internalAs=null,this.externalAs=null,t&&(void 0!==t.rankType&&null!==t.rankType&&(this.rankType=t.rankType),void 0!==t.internalAs&&null!==t.internalAs&&(this.internalAs=t.internalAs),void 0!==t.externalAs&&null!==t.externalAs&&(this.externalAs=t.externalAs))},M.services.protocol.tracker.TrackerPeerRankingKey.prototype={},M.services.protocol.tracker.TrackerPeerRankingKey.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.I32?this.rankType=t.zE().value:t.XE(n);break;case 2:n==j.Type.I32?this.internalAs=t.zE().value:t.XE(n);break;case 3:n==j.Type.I32?this.externalAs=t.zE().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerPeerRankingKey.prototype.write=function(t){t.tw("TrackerPeerRankingKey"),null!==this.rankType&&void 0!==this.rankType&&(t.iw("rankType",j.Type.I32,1),t.sw(this.rankType),t.rw()),null!==this.internalAs&&void 0!==this.internalAs&&(t.iw("internalAs",j.Type.I32,2),t.sw(this.internalAs),t.rw()),null!==this.externalAs&&void 0!==this.externalAs&&(t.iw("externalAs",j.Type.I32,3),t.sw(this.externalAs),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.TrackerPeerRanking=function(t){this.key=null,this.ranking=null,this.groupSize=null,this.cumulatedRankValue=null,this.totalOfRankValues=null,t&&(void 0!==t.key&&null!==t.key&&(this.key=t.key),void 0!==t.ranking&&null!==t.ranking&&(this.ranking=t.ranking),void 0!==t.groupSize&&null!==t.groupSize&&(this.groupSize=t.groupSize),void 0!==t.cumulatedRankValue&&null!==t.cumulatedRankValue&&(this.cumulatedRankValue=t.cumulatedRankValue),void 0!==t.totalOfRankValues&&null!==t.totalOfRankValues&&(this.totalOfRankValues=t.totalOfRankValues))},M.services.protocol.tracker.TrackerPeerRanking.prototype={},M.services.protocol.tracker.TrackerPeerRanking.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.STRUCT?(this.key=new M.services.protocol.tracker.TrackerPeerRankingKey(),this.key.read(t)):t.XE(n);break;case 2:n==j.Type.I32?this.ranking=t.zE().value:t.XE(n);break;case 3:n==j.Type.I32?this.groupSize=t.zE().value:t.XE(n);break;case 4:n==j.Type.DOUBLE?this.cumulatedRankValue=t.Rp().value:t.XE(n);break;case 5:n==j.Type.DOUBLE?this.totalOfRankValues=t.Rp().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerPeerRanking.prototype.write=function(t){t.tw("TrackerPeerRanking"),null!==this.key&&void 0!==this.key&&(t.iw("key",j.Type.STRUCT,1),this.key.write(t),t.rw()),null!==this.ranking&&void 0!==this.ranking&&(t.iw("ranking",j.Type.I32,2),t.sw(this.ranking),t.rw()),null!==this.groupSize&&void 0!==this.groupSize&&(t.iw("groupSize",j.Type.I32,3),t.sw(this.groupSize),t.rw()),null!==this.cumulatedRankValue&&void 0!==this.cumulatedRankValue&&(t.iw("cumulatedRankValue",j.Type.DOUBLE,4),t.sp(this.cumulatedRankValue),t.rw()),null!==this.totalOfRankValues&&void 0!==this.totalOfRankValues&&(t.iw("totalOfRankValues",j.Type.DOUBLE,5),t.sp(this.totalOfRankValues),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.TrackerRequest=function(t){this.info=null,this.contentId=null,this.query=null,this.streamType=null,this.sessionId=null,this.customerKey=null,t&&(void 0!==t.info&&null!==t.info&&(this.info=t.info),void 0!==t.contentId&&null!==t.contentId&&(this.contentId=t.contentId),void 0!==t.query&&null!==t.query&&(this.query=t.query),void 0!==t.streamType&&null!==t.streamType&&(this.streamType=t.streamType),void 0!==t.sessionId&&null!==t.sessionId&&(this.sessionId=t.sessionId),void 0!==t.customerKey&&null!==t.customerKey&&(this.customerKey=t.customerKey))},M.services.protocol.tracker.TrackerRequest.prototype={},M.services.protocol.tracker.TrackerRequest.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.STRUCT?(this.info=new M.services.protocol.tracker.TrackerPeerInfo(),this.info.read(t)):t.XE(n);break;case 2:n==j.Type.STRING?this.contentId=t.$E().value:t.XE(n);break;case 3:n==j.Type.STRUCT?(this.query=new M.services.protocol.tracker.TrackerQuery(),this.query.read(t)):t.XE(n);break;case 4:n==j.Type.I32?this.streamType=t.zE().value:t.XE(n);break;case 5:n==j.Type.STRING?this.sessionId=t.$E().value:t.XE(n);break;case 6:n==j.Type.STRUCT?(this.customerKey=new M.services.protocol.tracker.CustomerKey(),this.customerKey.read(t)):t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerRequest.prototype.write=function(t){t.tw("TrackerRequest"),null!==this.info&&void 0!==this.info&&(t.iw("info",j.Type.STRUCT,1),this.info.write(t),t.rw()),null!==this.contentId&&void 0!==this.contentId&&(t.iw("contentId",j.Type.STRING,2),t.nw(this.contentId),t.rw()),null!==this.query&&void 0!==this.query&&(t.iw("query",j.Type.STRUCT,3),this.query.write(t),t.rw()),null!==this.streamType&&void 0!==this.streamType&&(t.iw("streamType",j.Type.I32,4),t.sw(this.streamType),t.rw()),null!==this.sessionId&&void 0!==this.sessionId&&(t.iw("sessionId",j.Type.STRING,5),t.nw(this.sessionId),t.rw()),null!==this.customerKey&&void 0!==this.customerKey&&(t.iw("customerKey",j.Type.STRUCT,6),this.customerKey.write(t),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.TrackerResponse=function(t){this.infos=null,this.rankings=null,this.peerInfo=null,this.sessionId=null,t&&(void 0!==t.infos&&null!==t.infos&&(this.infos=t.infos),void 0!==t.rankings&&null!==t.rankings&&(this.rankings=t.rankings),void 0!==t.peerInfo&&null!==t.peerInfo&&(this.peerInfo=t.peerInfo),void 0!==t.sessionId&&null!==t.sessionId&&(this.sessionId=t.sessionId))},M.services.protocol.tracker.TrackerResponse.prototype={},M.services.protocol.tracker.TrackerResponse.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:if(n==j.Type.LIST){var s,e;this.infos=[];(e=t.wp()).pp,s=e.size;for(var h=0;h<s;++h){var o=null;(o=new M.services.protocol.tracker.TrackerPeerInfo()).read(t),this.infos.push(o)}t.gp()}else t.XE(n);break;case 2:if(n==j.Type.LIST){var u,a;this.rankings=[];(a=t.wp()).pp,u=a.size;for(var f=0;f<u;++f){var c=null;(c=new M.services.protocol.tracker.TrackerPeerRanking()).read(t),this.rankings.push(c)}t.gp()}else t.XE(n);break;case 3:n==j.Type.STRUCT?(this.peerInfo=new M.services.protocol.tracker.TrackerPeerInfo(),this.peerInfo.read(t)):t.XE(n);break;case 4:n==j.Type.STRING?this.sessionId=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerResponse.prototype.write=function(t){if(t.tw("TrackerResponse"),null!==this.infos&&void 0!==this.infos){for(var i in t.iw("infos",j.Type.LIST,1),t.$w(j.Type.STRUCT,this.infos.length),this.infos)this.infos.hasOwnProperty(i)&&(i=this.infos[i]).write(t);t.Xw(),t.rw()}if(null!==this.rankings&&void 0!==this.rankings){for(var n in t.iw("rankings",j.Type.LIST,2),t.$w(j.Type.STRUCT,this.rankings.length),this.rankings)this.rankings.hasOwnProperty(n)&&(n=this.rankings[n]).write(t);t.Xw(),t.rw()}null!==this.peerInfo&&void 0!==this.peerInfo&&(t.iw("peerInfo",j.Type.STRUCT,3),this.peerInfo.write(t),t.rw()),null!==this.sessionId&&void 0!==this.sessionId&&(t.iw("sessionId",j.Type.STRING,4),t.nw(this.sessionId),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.TrackerStoreIndexKey=function(t){this.timestamp=null,this.contentId=null,this.asType=null,this.asn=null,this.bitrate=null,this.streamState=null,this.rankType=null,this.qualityLevel=null,t&&(void 0!==t.timestamp&&null!==t.timestamp&&(this.timestamp=t.timestamp),void 0!==t.contentId&&null!==t.contentId&&(this.contentId=t.contentId),void 0!==t.asType&&null!==t.asType&&(this.asType=t.asType),void 0!==t.asn&&null!==t.asn&&(this.asn=t.asn),void 0!==t.bitrate&&null!==t.bitrate&&(this.bitrate=t.bitrate),void 0!==t.streamState&&null!==t.streamState&&(this.streamState=t.streamState),void 0!==t.rankType&&null!==t.rankType&&(this.rankType=t.rankType),void 0!==t.qualityLevel&&null!==t.qualityLevel&&(this.qualityLevel=t.qualityLevel))},M.services.protocol.tracker.TrackerStoreIndexKey.prototype={},M.services.protocol.tracker.TrackerStoreIndexKey.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.I32?this.timestamp=t.zE().value:t.XE(n);break;case 2:n==j.Type.STRING?this.contentId=t.$E().value:t.XE(n);break;case 3:n==j.Type.I32?this.asType=t.zE().value:t.XE(n);break;case 4:n==j.Type.I32?this.asn=t.zE().value:t.XE(n);break;case 5:n==j.Type.I32?this.bitrate=t.zE().value:t.XE(n);break;case 6:n==j.Type.I32?this.streamState=t.zE().value:t.XE(n);break;case 7:n==j.Type.I32?this.rankType=t.zE().value:t.XE(n);break;case 8:n==j.Type.STRING?this.qualityLevel=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerStoreIndexKey.prototype.write=function(t){t.tw("TrackerStoreIndexKey"),null!==this.timestamp&&void 0!==this.timestamp&&(t.iw("timestamp",j.Type.I32,1),t.sw(this.timestamp),t.rw()),null!==this.contentId&&void 0!==this.contentId&&(t.iw("contentId",j.Type.STRING,2),t.nw(this.contentId),t.rw()),null!==this.asType&&void 0!==this.asType&&(t.iw("asType",j.Type.I32,3),t.sw(this.asType),t.rw()),null!==this.asn&&void 0!==this.asn&&(t.iw("asn",j.Type.I32,4),t.sw(this.asn),t.rw()),null!==this.bitrate&&void 0!==this.bitrate&&(t.iw("bitrate",j.Type.I32,5),t.sw(this.bitrate),t.rw()),null!==this.streamState&&void 0!==this.streamState&&(t.iw("streamState",j.Type.I32,6),t.sw(this.streamState),t.rw()),null!==this.rankType&&void 0!==this.rankType&&(t.iw("rankType",j.Type.I32,7),t.sw(this.rankType),t.rw()),null!==this.qualityLevel&&void 0!==this.qualityLevel&&(t.iw("qualityLevel",j.Type.STRING,8),t.nw(this.qualityLevel),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.TrackerStoreRankPeer=function(t){this.guid=null,this.rank=null,this.key=null,t&&(void 0!==t.guid&&null!==t.guid&&(this.guid=t.guid),void 0!==t.rank&&null!==t.rank&&(this.rank=t.rank),void 0!==t.key&&null!==t.key&&(this.key=t.key))},M.services.protocol.tracker.TrackerStoreRankPeer.prototype={},M.services.protocol.tracker.TrackerStoreRankPeer.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.STRING?this.guid=t.Sp().value:t.XE(n);break;case 2:n==j.Type.DOUBLE?this.rank=t.Rp().value:t.XE(n);break;case 3:n==j.Type.STRUCT?(this.key=new M.services.protocol.tracker.TrackerPeerRankingKey(),this.key.read(t)):t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerStoreRankPeer.prototype.write=function(t){t.tw("TrackerStoreRankPeer"),null!==this.guid&&void 0!==this.guid&&(t.iw("guid",j.Type.STRING,1),t.ep(this.guid),t.rw()),null!==this.rank&&void 0!==this.rank&&(t.iw("rank",j.Type.DOUBLE,2),t.sp(this.rank),t.rw()),null!==this.key&&void 0!==this.key&&(t.iw("key",j.Type.STRUCT,3),this.key.write(t),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.TrackerRequestQueueKey=function(t){this.guid=null,this.contentId=null,this.partner=null,this.customer=null,t&&(void 0!==t.guid&&null!==t.guid&&(this.guid=t.guid),void 0!==t.contentId&&null!==t.contentId&&(this.contentId=t.contentId),void 0!==t.partner&&null!==t.partner&&(this.partner=t.partner),void 0!==t.customer&&null!==t.customer&&(this.customer=t.customer))},M.services.protocol.tracker.TrackerRequestQueueKey.prototype={},M.services.protocol.tracker.TrackerRequestQueueKey.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.STRING?this.guid=t.Sp().value:t.XE(n);break;case 2:n==j.Type.STRING?this.contentId=t.$E().value:t.XE(n);break;case 3:n==j.Type.STRING?this.partner=t.$E().value:t.XE(n);break;case 4:n==j.Type.STRING?this.customer=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerRequestQueueKey.prototype.write=function(t){t.tw("TrackerRequestQueueKey"),null!==this.guid&&void 0!==this.guid&&(t.iw("guid",j.Type.STRING,1),t.ep(this.guid),t.rw()),null!==this.contentId&&void 0!==this.contentId&&(t.iw("contentId",j.Type.STRING,2),t.nw(this.contentId),t.rw()),null!==this.partner&&void 0!==this.partner&&(t.iw("partner",j.Type.STRING,3),t.nw(this.partner),t.rw()),null!==this.customer&&void 0!==this.customer&&(t.iw("customer",j.Type.STRING,4),t.nw(this.customer),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.TrackerRequestQueueMessage=function(t){this.timestamp=null,this.request=null,this.response=null,this.guid=null,this.contentId=null,this.partner=null,this.customer=null,t&&(void 0!==t.timestamp&&null!==t.timestamp&&(this.timestamp=t.timestamp),void 0!==t.request&&null!==t.request&&(this.request=t.request),void 0!==t.response&&null!==t.response&&(this.response=t.response),void 0!==t.guid&&null!==t.guid&&(this.guid=t.guid),void 0!==t.contentId&&null!==t.contentId&&(this.contentId=t.contentId),void 0!==t.partner&&null!==t.partner&&(this.partner=t.partner),void 0!==t.customer&&null!==t.customer&&(this.customer=t.customer))},M.services.protocol.tracker.TrackerRequestQueueMessage.prototype={},M.services.protocol.tracker.TrackerRequestQueueMessage.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.I64?this.timestamp=t._p().value:t.XE(n);break;case 2:n==j.Type.STRUCT?(this.request=new M.services.protocol.tracker.TrackerRequest(),this.request.read(t)):t.XE(n);break;case 3:n==j.Type.STRUCT?(this.response=new M.services.protocol.tracker.TrackerResponse(),this.response.read(t)):t.XE(n);break;case 4:n==j.Type.STRING?this.guid=t.Sp().value:t.XE(n);break;case 5:n==j.Type.STRING?this.contentId=t.$E().value:t.XE(n);break;case 6:n==j.Type.STRING?this.partner=t.$E().value:t.XE(n);break;case 7:n==j.Type.STRING?this.customer=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerRequestQueueMessage.prototype.write=function(t){t.tw("TrackerRequestQueueMessage"),null!==this.timestamp&&void 0!==this.timestamp&&(t.iw("timestamp",j.Type.I64,1),t.rp(this.timestamp),t.rw()),null!==this.request&&void 0!==this.request&&(t.iw("request",j.Type.STRUCT,2),this.request.write(t),t.rw()),null!==this.response&&void 0!==this.response&&(t.iw("response",j.Type.STRUCT,3),this.response.write(t),t.rw()),null!==this.guid&&void 0!==this.guid&&(t.iw("guid",j.Type.STRING,4),t.ep(this.guid),t.rw()),null!==this.contentId&&void 0!==this.contentId&&(t.iw("contentId",j.Type.STRING,5),t.nw(this.contentId),t.rw()),null!==this.partner&&void 0!==this.partner&&(t.iw("partner",j.Type.STRING,6),t.nw(this.partner),t.rw()),null!==this.customer&&void 0!==this.customer&&(t.iw("customer",j.Type.STRING,7),t.nw(this.customer),t.rw()),t.ew(),t.hw()}},function(t,i,o){"use strict";Object.defineProperty(i,"s",{value:!0});var h=o(55),v=o(4),u=o(3),n=o(123);i.uR=n.uR;var a=o(0),f=o(20);i.Options=f.Options,i.UrlConfigurableOptions=f.UrlConfigurableOptions;var c=o(125);i.TechName=c.TechName;var d=o(28);i.HiveSession=d.HiveSession,i.HivePluginReference=d.HivePluginReference,i.HiveSessionError=d.HiveSessionError,i.HiveSessionErrorCode=d.HiveSessionErrorCode,i.MainStatusCode=d.MainStatusCode;var l=o(43),r=o(46);i.HiveRequestFactory=r.HiveRequestFactory;var s=o(127),E=o(75),w=o(128),e=o(129),p=o(47);i.HiveSessionInternal=p.HiveSessionInternal;var g=o(15);i.BasicUtils=g;var b=o(15),y=o(130),T=o(29);i.PlayerEvents=T.PlayerEvents;var O=o(134),m=o(136),_=o(92);i.StatsJS=_.StatsJS;var R=o(61),S=o(1),A=o(2),I=o(62);i.Ticket=I.Ticket;var N=o(44),C=o(14),k=o(32);i.aR=k.aR;var D=o(8);i.Y=D.Y;var j=o(175);i.fR=j.fR;var M,P,L=o(6),H=D.Y.Wa,U=D.Y.Ka,F=D.Y.Ya;F&&o(13).HiveConfig,(P=M=M||{}).HTML5="html5",P.NATIVE="native_hls",P.FLASH="flash",i.cR=M;var G=(x.prototype.options=function(){return this.options_},x.prototype.logger=function(){return this.activeSession?this.logger_.log(this.activeSession.id):this.logger_.log()},x.prototype.loggerLevel=function(t){if("string"==typeof t&&this.logger_.lR(t),this.logger)return this.logger_.level},x.prototype.getPluginId=function(){return this.pluginId},x.prototype.getPluginId4Java=function(){return this.pluginId4Java},x.prototype.getCoreVersion=function(){return H},x.prototype.updateCommsForInitSessions=function(){for(var t=0,i=this.initializedSessions;t<i.length;t++){var n=i[t];n.tech.setPlugin(this),"HiveJS"===n.tech.getName()&&n.tech.vR&&n.tech.vR.setPlugin(this)}},x.prototype.validateHiveTechs=function(t){var i=new _.StatsJS(this,t);if(this.hiveTechs.set(_.StatsJS.dR,i),F){var n=o(176).HiveJS;this.hiveTechs.set(n.dR,new n(this,t,i))}if(U){var r=o(241).HiveJava;this.hiveTechs.set(r.dR,new r(this,t))}var s=t.hiveTechOrder;if(!s||s instanceof Array)if(s&&0<s.length)for(var e=s.length;e--;){var h=s[e];"string"!=typeof h||-1==this.defaultHiveTechOrder.indexOf(h)?(!1,s.splice(e,1)):"string"==typeof h&&this.hiveTechs.has(h)||!1}else s=this.defaultHiveTechOrder;else!1,s=this.defaultHiveTechOrder;t.hiveTechOrder=s},x.prototype.resolveTicketPromise=function(r){var s=this;this.logger().notice(this.loggerId+"resolving "+r);var i=v.defer();if(!r)return i.reject(d.HiveSessionError.getHiveSessionError("",d.HiveSessionErrorCode.TICKET_ERROR,"No ticket provided.")),i.promise;this.extractErrorMonitorTags(r);var t=this.getOrderedTechs().values();0==t.length&&(S.ErrorMonitor.getInstance().logError("Error initializing all Techs",this.loggerId,A.ie.se),i.reject(d.HiveSessionError.getHiveSessionError(r,d.HiveSessionErrorCode.NO_TECH_AVAILABLE)));var e,h,o=!1,u=!1,a=0,f=null;return b.Nc(function(){return!o&&!u&&a<t.length&&!e},function(){var n=t[a++];return n.resetTech(),(n.needsReportingInstance()&&!h?s.verifyTicket(r,s.options().testId):v.resolve(null)).then(function(t){null!=t&&(h=t).Fl(s.options().reportingThreshold);var i=n.getInitSessionTimeout();return n.initSession(r,h).timeout(i,"["+n.getName()+"] Error: initialization timed out after "+i+"ms").then(function(t){f=t,s.onInitializeSession(f,n),o=!0,!n.needsReportingInstance()&&h&&h.ql.reset(),S.ErrorMonitor.getInstance().rt({sessionId:f.id}),t.notifyStateChange(p.ER.INITIALIZED),s.logger().notice(s.loggerId+"initializing Session:["+f.id+"] Ticket:"+f.ticket.toString()+" HiveTech:["+f.tech.getName()+"]"),v.resolve(!0)},function(t){t instanceof Error&&(t=new d.HiveTechError(d.wR.TIMEOUT_ERROR,t.message),n.onTechTimeout(t)),t.ticketUrl=r,u=!n.onError(t),s.logger().debug(s.loggerId+"tech "+n.getName()+": "+t.message),v.resolve(!0)})},function(t){e=t,v.resolve(!0)})}).then(function(){e?i.reject(d.HiveSessionError.getHiveSessionError(r,d.HiveSessionErrorCode.TICKET_ERROR,e)):u?i.reject(d.HiveSessionError.getHiveSessionError(r,d.HiveSessionErrorCode.TECH_ERROR)):o?i.resolve(f):(S.ErrorMonitor.getInstance().logError("Error initializing all Techs",s.loggerId,A.ie.se),i.reject(d.HiveSessionError.getHiveSessionError(r,d.HiveSessionErrorCode.NO_TECH_AVAILABLE)))})["catch"](function(t){S.ErrorMonitor.getInstance().logError("Error resolving ticket promise",s.loggerId,A.ie.re,t),i.reject(d.HiveSessionError.getHiveSessionError(r,d.HiveSessionErrorCode.GENERIC_ERROR,t.toString()))}).done(),i.promise},x.prototype.authenticate=function(f){var c=this,t=D.Y["if"]?C.Rc.lc:C.Rc.vc;if(!this.validateTokens(f))return v.reject({code:"Init Error",reason:JSON.stringify({code:"C_INVALID_DATA",description:"There are missing data in among the videoId, JWT or manifest lists"})});var l=new Date().getTime();return b.Dc(t,JSON.stringify(f)).then(function(t){var i=Date.now();c.logger().warn("[Timing] Authentication request to service",i-l);var u=JSON.parse(t);c.logger().debug("Response: ",u),c.options().hiveTechOrder=u.techs;var n=v.defer(),r=c.getOrderedTechs().values(),a=!1,s=0,e=[];return b.Nc(function(){return 0<e.length?(n.resolve(e),!1):!a&&s<r.length||(S.ErrorMonitor.getInstance().logError("Error initializing all Techs",c.loggerId,A.ie.se),n.reject({code:"Init Error",reason:JSON.stringify({code:"C_"+d.HiveSessionErrorCode[d.HiveSessionErrorCode.NO_TECH_AVAILABLE],description:"No Tech successfully initialized"})}),!1)},function(){var o=r[s++];return o.resetTech(),v.allSettled(u.validated.map(function(t){var h=t.videoId;if(0===f.filter(function(t){return t.videoId===h}).length)return S.ErrorMonitor.getInstance().logError("No Token found for the specific videoId",c.loggerId,A.ie.ee,{videoId:h}),v.reject(!1);var i=t.manifests;return c.logger().debug("Manifests: ",i),v.allSettled(i.map(function(r){var t,i=o.getInitSessionTimeout(),s=Date.now();if(o.needsReportingInstance()){var n=I.Ticket.pR(u.partnerId,u.customerId,u.validated[0].videoId);n.gR(r.uri),n.bR=l,n.yR=new Date().getTime(),t=R["default"].getInstance().initSession(c.pluginId,n,!1,"",u.connectionEndpoint)}else t=v.resolve(null);var e=Date.now();return t.then(function(n){var t=Date.now();return c.logger().warn("[Timing] Init RI for "+o.getName(),t-s),n&&c.updatePlayerInfo(n),o.initSession(u.ticketEndpoint+"/"+r.jwt,n).timeout(i).then(function(t){c.onInitializeSession(t,o),a=!0,"HiveJava"===o.getName()&&t.ticket.TR(u.partnerId,u.customerId,h),!o.needsReportingInstance()&&n&&n.ql.reset(),S.ErrorMonitor.getInstance().rt({sessionId:t.id}),c.logger().notice(c.loggerId+"initializing Session:["+t.id+"] Ticket:"+t.ticket.toString()+" HiveTech:["+t.tech.getName()+"]"),t.ticket.originalManifest=r.uri;var i=Date.now();return c.logger().warn("[Timing] Init Tech Successful for "+o.getName(),i-e),t})}).fail(function(t){return t=c.handleTechError(t,o,e),v.reject(t)})})).then(function(t){return c.extractResolved(t,!1)})})).then(function(t){var i=c.extractResolved(t,[],!1);i instanceof Array&&(e=i)})}).done(),n.promise}).fail(function(t){return c.logger().debug("Authentication Failed",t),v.reject(t)})},x.prototype.handleTechError=function(t,i,n){this.logger().debug(this.loggerId+" init Session failed:",t.message),t instanceof Error&&(t=new d.HiveTechError(d.wR.TIMEOUT_ERROR,t.message),i.onTechTimeout(t)),this.logger().debug(this.loggerId+"tech "+i.getName()+": "+t.message);var r=Date.now();return this.logger().warn("[Timing] Init Tech Failed for "+i.getName(),r-n),t},x.prototype.validateTokens=function(t){return 0!==t.length&&t.every(function(t,i,n){return t.jwt&&t.videoId&&0<t.manifests.length})},x.prototype.extractResolved=function(t,i,n){void 0===n&&(n=!0);for(var r=[],s=0,e=t;s<e.length;s++){var h=e[s];"fulfilled"===h.state&&(n?r.push(h.value):r=r.concat(h.value))}return 0<r.length?r:v.reject(i)},x.prototype.verifyTicket=function(i,t){var n=this;return R["default"].getInstance().initSession(this.pluginId,i,!1,t).then(function(t){return n.logger().debug(n.loggerId+"verified ticket "+i),n.updatePlayerInfo(t),t})["catch"](function(t){return v.reject("Ticket not verified, error: "+t.message)})},x.prototype.getOrderedTechs=function(){for(var t=JSON.parse(JSON.stringify(this.options().hiveTechOrder)),i=new u(),n=0,r=t;n<r.length;n++){var s=r[n];this.hiveTechs.has(s)&&i.set(s,this.hiveTechs.get(s))}return i},x.prototype.extractErrorMonitorTags=function(t){var i=S.ErrorMonitor.getInstance();try{var n=I.Ticket.OR(t);n.mR()&&n._R()&&n.RR()?i.setTags([n.mR(),n._R(),n.RR()]):i.logError("Ticket not valid, we could not resolve the triple partnerId/CustomerId/ContentId",this.loggerId,A.ie.he,{partnerId:n.mR(),customerId:n._R(),contentId:n.RR()})}catch(t){this.logger().warn(this.loggerId+" "+t.message,t),i.notify(t)}},x.prototype.updatePlayerInfo=function(t){var i={commVersion:H,pluginName:this.getPluginName(),pluginVersion:this.getPluginVersion(),playerTech:this.getPlayerTech(),playerVersion:this.getPlayerVersion(),telemetryId:this.getTelemetryId()};t.ql.updatePlayerInfo(i)},x.prototype.addTechEvent=function(t){this.activeSession&&this.activeSession.tech?(t.sessionId=this.activeSession.id,this.activeSession.tech.handleTechEvent(this.activeSession,t)):this.techEvents.push(t)},x.prototype.flushTechEvents=function(){var t=this.techEvents;return this.techEvents=new Array(),t},x.prototype.beforeUnloadClose=function(){this.destroyHivePlugin(!1)},x.prototype.registerCloseSession=function(){var t=window;this.beforeUnloadClose=this.beforeUnloadClose.bind(this),t.addEventListener?t.addEventListener("beforeunload",this.beforeUnloadClose,!1):t.attachEvent("onbeforeunload",this.beforeUnloadClose)},x.prototype.unRegisterCloseSession=function(){var t=window;t.removeEventListener?t.removeEventListener("beforeunload",this.beforeUnloadClose,!1):t.detachEvent("onbeforeunload",this.beforeUnloadClose)},x.prototype.closeHiveSession=function(t,i){void 0===i&&(i=!0),this.logger().debug("Manually Closing Session"+(t?" because: "+t:"")),this.eventBinder.SR(),r.HiveRequestFactory.clearPluginState(this.pluginId),this.resetSession(!0,i)},x.prototype.destroyHivePlugin=function(t){return void 0===t&&(t=!0),this.unRegisterCloseSession(),this.eventBinder.SR(!0),this.closeHiveSession("Invoked Plugin Destroy",t),e.VisibilityChangeListener.getInstance(this.logger()).cleanListeners(),a.Framework.P(),this.options_.onLoadingCompleted=null,this.options_.onSourceSetCompleted=null,this.options_.onActiveSession=null,this.options_.onError=null,S.ErrorMonitor.getInstance().ot(),a.Framework._},x.prototype.resetSession=function(t,i){var n=this;void 0===i&&(i=!0),this.onCloseSession(t,i),!1===t?this.activeSession&&this.initializedSessions.every(function(t){return t.id!==n.activeSession.id})&&this.initializedSessions.unshift(this.activeSession):this.initializedSessions.length=0,this.stopPeriodicFeedback(),this.activeSession=null,this.lastEvent=null,this.totalBufferingTime=0,this.lastBufferingStart=0},x.prototype.onInitializeSession=function(t,i){t.tech=i,this.initializedSessions.push(t)},x.prototype.onActivateSession=function(t,i){var n=this;if(void 0===i&&(i=!1),null==this.activeSession){for(var r=t||this.getPlayerSource(),s=0;s<this.initializedSessions.length;s++){var e=this.initializedSessions[s];if(e.isActive(r,i)){if(this.activeSession=e,this.activeSession.reportingInstance?this.activeSession.reportingInstance.kl.AR(this.activeSession.ticket):this.resetInitializedSessions(),this.activeSession.tech.onActiveSession(this.activeSession),this.activeSession.notifyStateChange(p.ER.ACTIVE),this.logger().notice(this.loggerId+"activating Session:["+this.activeSession.id+"] Ticket:"+this.activeSession.ticket.toString()+" HiveTech:["+this.activeSession.tech.getName()+"]"),this.options().onActiveSession)try{this.options().onActiveSession(e.toHiveSession())}catch(t){S.ErrorMonitor.getInstance().logError(this.loggerId+" exception in user-defined Generic onActiveSession callback: "+t,this.loggerId,A.ie.oe)}break}}if(this.activeSession)return this.initializedSessions.forEach(function(t){t!=n.activeSession&&t.getReportingInstance().then(function(t){return t.Yl()})}),!(this.initializedSessions.length=0);S.ErrorMonitor.getInstance().logError("No matching session found",this.loggerId,A.ie.ne,{playerSource:r,initializedSessions:this.initializedSessions.map(function(t){return t.manifest})}),this.resetSession()}return!1},x.prototype.getActiveSession=function(){if(this.activeSession)return this.activeSession.toHiveSession()},x.prototype.resetInitializedSessions=function(){this.initializedSessions.forEach(function(t){t.reportingInstance&&t.close(!0)})},x.prototype.isSessionActive=function(){if(null!=this.activeSession){if(this.activeSession.isActive(this.getPlayerSource()))return!0;var t="Session src mismatch: "+this.getPlayerSource()+" != "+this.activeSession.manifest;this.logger().warn(this.loggerId+t),this.closeHiveSession(t)}return!1},x.prototype.onCloseSession=function(i,n){var r=this;void 0===i&&(i=!1),void 0===n&&(n=!0),null!=this.activeSession?(this.logger().notice(this.loggerId+"Stopping session ["+this.activeSession.id+"]"),this.activeSession.close(i,n)):0<this.initializedSessions.length?this.initializedSessions.forEach(function(t){r.logger().notice(r.loggerId+"Attempt to stopping session ["+t.id+"]"),t.close(i,n)}):R["default"].getInstance().close()},x.prototype.startPeriodicFeedback=function(){var t=this;null==this.periodicFeedbackEvent&&(this.periodicFeedbackEvent=setInterval(function(){t.sendStatsFeedback(!0)},this.options().feedbackPeriod),this.sendStatsFeedback())},x.prototype.stopPeriodicFeedback=function(){clearInterval(this.periodicFeedbackEvent),this.periodicFeedbackEvent=null},x.prototype.getPlayingTime=function(t){return void 0===t&&(t=!1),this.playingStateCounter.Qu(void 0,t?this.options().feedbackPeriod:void 0)},x.prototype.sendStatsFeedback=function(t){var i=this;if(void 0===t&&(t=!1),this.isSessionActive()){if(!this.isActive())return void this.resetSession();var n=this.getWindowSize(),r=new s.HivePlayerStats(this.getCurrentTime(),this.getBufferLen(),this.totalBufferingTime,n.width,n.height,this.isFullscreen(),this.getPlayingTime(t));this.activeSession.updateIdleState(this.statsChecker.check(r)),this.activeSession.tech.handleStats(this.activeSession,r).fail(function(t){i.logger().warn(i.loggerId+"stats handling failed",t),i.stopPeriodicFeedback()})}},x.prototype.registerGenericEvents=function(){var n=this;try{e.VisibilityChangeListener.getInstance(this.logger()).setVisibilityChangeListener(function(t){var i=n.getPotentialSession();i&&!i.isIdle()&&(n.onEventFeedback(t?T.PlayerEvents.VISIBLE:T.PlayerEvents.HIDDEN),n.logger().debug(t?"visible":"hidden"))})}catch(t){S.ErrorMonitor.getInstance().logError("error setting up the visibilityChange listener",this.loggerId,A.ie.ue,{error:t})}},x.prototype.onStartBuffering=function(t,i){void 0===i&&(i=!1),(i||this.isSessionActive())&&this.lastBufferingStart<=0&&(this.lastBufferingStart=Date.now(),null!=t&&!t||this.onEventFeedback(T.PlayerEvents.BUFFERING))},x.prototype.onEndBuffering=function(){var t=0==this.totalBufferingTime;if(0<this.lastBufferingStart){var i=Date.now()-this.lastBufferingStart;return this.totalBufferingTime+=i,this.logger().debug(this.loggerId+"reporting new buffering event of "+i),this.lastBufferingStart=0,t&&this.sendStatsFeedback(),!0}return!1},x.prototype.onError=function(t,i,n){void 0===n&&(n=!0),this.onEventFeedback(T.PlayerEvents.ERROR,{code:-1,"player-code":t}),n&&this.closeHiveSession(i)},x.prototype.onEventFeedback=function(t,i){var n=this,r=this.getPotentialSession();if(null!=r&&(r==this.activeSession||r.tech.getName()!==c.IR[c.IR.HiveJava])){switch(t){case T.PlayerEvents.PLAYING:this.playingStateCounter.start();break;case T.PlayerEvents.PAUSED:case T.PlayerEvents.SKIP:case T.PlayerEvents.BUFFERING:case T.PlayerEvents.STOPPED:this.playingStateCounter.stop()}r.tech.handleEvent(r,t,i).fail(function(t){n.logger().warn(n.loggerId+"error in forwarding player event to tech",t)})}},x.prototype.filterEvent=function(t,i){t!==this.lastEvent&&this.onEventFeedback(t,i),this.lastEvent=t},x.prototype.getPotentialSession=function(){return this.activeSession?this.activeSession:this.initializedSessions&&0<this.initializedSessions.length?this.initializedSessions[0]:void 0},x.prototype.initStatusCode=function(){this.statusCode=0},x.prototype.setStatusCode=function(t,i){this.initStatusCode(),this.statusCode+=t<<28,i&&0===t&&(this.statusCode+=1<<4*(6-c.IR[i.getName()])),0<t&&S.ErrorMonitor.getInstance().logError("Status Code Error",this.loggerId,A.ie.ae,{code:d.NR(t)},["Plugin Error Code",d.NR(t)])},x.prototype.getStatusCode=function(){return this.statusCode},x.prototype.getTelemetryId=function(){return this.options().telemetryId},x.prototype.getPluginName=function(){return D.Y.$a},x.prototype.getPluginVersion=function(){return D.Y.za},x);function x(t){this.defaultHiveTechOrder=[c.IR[c.IR.HiveJava],c.IR[c.IR.HiveJS],c.IR[c.IR.StatsJS]],this.hiveTechs=new u(),this.techEvents=new Array(),this.initializedSessions=new Array(),this.activeSession=null,this.totalBufferingTime=0,this.lastBufferingStart=0,this.loggerId="[HiveComm] ",this.statusCode=0,this.playingStateCounter=new L.Ku(),this.eventBinder=new j.fR(this),this.pluginId=h.CR(),a.Framework.m("peer0",new O.kR(),new m.DR()),this.pluginId4Java=E.SessionStorageUtil.getItem("hivePluginId"),this.pluginId4Java||(this.pluginId4Java=Math.abs(Math.floor(68719476736*Math.random())).toString(16),E.SessionStorageUtil.setItem("hivePluginId",this.pluginId4Java));var i=S.ErrorMonitor.getInstance(D.Y.za);this.options_=new f.Options(),this.validateHiveTechs(t),b.updateOptions(t,this.options_),b.parseParameterOptions(window.location.href,new f.UrlConfigurableOptions(),this.options_),f._v.mv(this.options_),this.logger_=a.Framework.resolve(a.Framework.v.p),l.HiveConfig.Framework.LoggerTimestamp=this.options().loggerTimestamp,this.options().isSDNDebug&&(this.options().debugLevel="debug"),this.logger_.lR(this.options().debugLevel),i.nt(this.logger_.log()),this.options().onError&&i.et(this.options().onError);var n=a.Framework.resolve(a.Framework.v.Pl),r=a.Framework.resolve(a.Framework.v.jR);n.sv().then(function(t){i.setUser(t.uv()),i.rt({reportingGuid:t.av()}),i.rt({p2pId:t.uv()})});var s={};new y.MR(this),r.getConnectivityInfo().then(function(t){s={pIPAddr:t.getNetworkChanged().getPrivateIp()},i.rt({privateIp:s.pIPAddr})}),window.Hc=this.logger_.log(),this.registerCloseSession(),this.pluginReference=new d.HivePluginReference(this);var e=this.options().idleTimePeriod>this.options().feedbackPeriod?this.options().idleTimePeriod:N.Rc.du;this.statsChecker=new w.StatsChecker(e),this.registerGenericEvents()}i.Plugin=G,"undefined"!=typeof window&&(window.HiveRequestFactory=r.HiveRequestFactory),i.PR=A.ie,i.logError=function(t,i,n,r,s){var e=S.ErrorMonitor.getInstance();e.logError.apply(e,arguments)}},function(t,i,n){t.exports=function s(e,h,o){function u(n,t){if(!h[n]){if(!e[n]){if(a)return a(n,!0);var i=new Error("Cannot find module '"+n+"'");throw i.code="MODULE_NOT_FOUND",i}var r=h[n]={exports:{}};e[n][0].call(r.exports,function(t){var i=e[n][1][t];return u(i||t)},r,r.exports,s,e,h,o)}return h[n].exports}for(var a=!1,t=0;t<o.length;t++)u(o[t]);return u}({1:[function(t,i,n){var r=t("./kernel");n.F=r.F;var s=t("./type_binding");n.LR=s.LR;var e=t("./type_binding_scope");n.HR=e.HR},{"./kernel":2,"./type_binding":4,"./type_binding_scope":5}],2:[function(t,i,n){var r=t("./type_binding_scope"),s=t("./lookup"),e=function(){function t(){this.UR=new s.FR()}return t.prototype.bind=function(t){this.UR.add(t.GR,t)},t.prototype.xR=function(i){try{this.UR.remove(i)}catch(t){throw new Error("Could not resolve service "+i)}},t.prototype.U=function(){this.UR=new s.FR()},t.prototype.resolve=function(t){if(!this.UR.BR(t))return null;var i=this.UR.get(t)[0];if(i.scope===r.HR.VR&&null!==i.gw)return i.gw;var n=this.qR(i.QR);return i.gw=n},t.prototype.YR=function(t){var i,n,r,s,e,h;return e=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,h=/([^\s,]+)/g,i=t.toString().replace(e,""),n=i.indexOf("(")+1,r=i.indexOf(")"),null===(s="function"==typeof Map&&-1!==i.indexOf("class")&&-1===i.indexOf("constructor")?null:i.slice(n,r).match(h))&&(s=[]),s},t.prototype.qR=function(t){var i=this.YR(t);if(0===i.length)return new t();for(var n=[],r=null,s=0;s<i.length;s++){var e=i[s];r=this.resolve(e),n.push(r)}return this.KR(t,n)},t.prototype.KR=function(t,i){return new(Function.prototype.bind.apply(t,[null].concat(i)))()},t}();n.F=e},{"./lookup":3,"./type_binding_scope":5}],3:[function(t,i,n){var s=function(t,i){this.key=t,this.value=new Array(),this.value.push(i)},r=function(){function t(){this.WR=new Array()}return t.prototype.$R=function(t){for(var i=-1,n=0;n<this.WR.length;n++){var r=this.WR[n];r.key===t&&(i=n)}return i},t.prototype.add=function(t,i){if(null==t)throw new Error("Argument Null");if(null==i)throw new Error("Argument Null");var n=this.$R(t);if(-1!==n){var r=this.WR[n];r.key===t&&r.value.push(i)}else this.WR.push(new s(t,i))},t.prototype.get=function(t){if(null==t)throw new Error("Argument Null");var i=this.$R(t);if(-1===i)throw new Error("Key Not Found");var n=this.WR[i];return n.key===t?n.value:void 0},t.prototype.remove=function(t){if(null==t)throw new Error("Argument Null");var i=this.$R(t);if(-1===i)throw new Error("Key Not Found");this.WR.splice(i,1)},t.prototype.BR=function(t){if(null==t)throw new Error("Argument Null");var i=this.$R(t);return-1!==i},t}();n.FR=r},{}],4:[function(t,i,n){var r=t("./type_binding_scope"),s=function(t,i,n){if(this.GR=t,this.QR=i,this.gw=null,void 0===n)this.scope=r.HR.XR;else{if(!r.HR[n])throw new Error("Invalid scope type "+n);this.scope=n}};n.LR=s},{"./type_binding_scope":5}],5:[function(t,i,n){var r;!function(t){t[t.XR=0]="Transient",t[t.VR=1]="Singleton"}(r=r||{}),n.HR=r},{}]},{},[1])(1)},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){this.savings=0,this.cdnRequests=0,this.cdnResponses=0,this.cdnResponseErrors=0,this.cdnResponseBytes=0,this.p2pRequests=0,this.p2pResponses=0,this.p2pResponseErrors=0,this.p2pResponseBytes=0,this.p2pPartnerTotalSentBytes=0,this.partners={}}i.HiveClientStats=r;function s(){this.uuid="",this.sentBytes=0,this.receivedBytes=0,this.successTransfers=0,this.failedTransfers=0,this.rateReceived=0,this.lastUpdated=0}i.HivePartnerStats=s;function e(){}var h,o,u,a;i.HiveSession=e,(o=h=i.HiveSessionErrorCode||(i.HiveSessionErrorCode={}))[o.GENERIC_ERROR=0]="GENERIC_ERROR",o[o.NO_TECH_AVAILABLE=1]="NO_TECH_AVAILABLE",o[o.NO_TECH_RESOLVED=2]="NO_TECH_RESOLVED",o[o.TECH_ERROR=3]="TECH_ERROR",o[o.TICKET_ERROR=4]="TICKET_ERROR",(a=u=u||{})[a["Generic Undefined Error"]=0]="Generic Undefined Error",a[a["No Tech available to resolve the ticket"]=1]="No Tech available to resolve the ticket",a[a["No available Tech could resolved the ticket"]=2]="No available Tech could resolved the ticket",a[a["Stopped resolving session on last tech onError"]=3]="Stopped resolving session on last tech onError",a[a["The ticket could not be resolved"]=4]="The ticket could not be resolved";var f=(c.getHiveSessionErrorMessage=function(t){return u[t]},c.getHiveSessionError=function(t,i,n){var r=new c();return r.ticketUrl=t,r.code=i,r.message=c.getHiveSessionErrorMessage(i),r.detailedMessage=n,r},c.HiveSessionErrorCode=h,c);function c(){}i.HiveSessionError=f;function l(t,i){this.code=t,this.message=i}var v,d,E;i.HiveTechError=l,(v=i.wR||(i.wR={}))[v.NOT_READY=0]="NOT_READY",v[v.PLUGIN_ERROR=1]="PLUGIN_ERROR",v[v.SESSION_ERROR=2]="SESSION_ERROR",v[v.TICKET_ERROR=3]="TICKET_ERROR",v[v.VERSION_ERROR=4]="VERSION_ERROR",v[v.TIMEOUT_ERROR=5]="TIMEOUT_ERROR",(E=d=i.MainStatusCode||(i.MainStatusCode={}))[E.OK=0]="OK",E[E.HIVE_NOT_ALLOWED=1]="HIVE_NOT_ALLOWED",E[E.TICKET_NOT_RESOLVED=2]="TICKET_NOT_RESOLVED",E[E.TIMEOUT_RESOLVING_TICKET=3]="TIMEOUT_RESOLVING_TICKET",i.NR=function(t){switch(t){case d.OK:return"OK";case d.HIVE_NOT_ALLOWED:return"HIVE_NOT_ALLOWED";case d.TICKET_NOT_RESOLVED:return"TICKET_NOT_RESOLVED";case d.TIMEOUT_RESOLVING_TICKET:return"TIMEOUT_RESOLVING_TICKET";default:return}};var w=(p.prototype.getPluginStatusCode=function(){return this.hivePlugin.getStatusCode()},p);function p(t){this.hivePlugin=t}i.HivePluginReference=w},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e=n(76),h=n(60),o=n(4),u=n(0),a=n(14),f=n(16),c=n(13),l=n(77),v=n(131),d=n(132),E=n(133),w=(p.zR="hive-client-track",p.JR="trackevent",p.ZR="NULLID",p.tS="",p);function p(){}var g,b="[TRACK] ";(g=i.PlayerEvents||(i.PlayerEvents={}))[g.PLAYING=0]="PLAYING",g[g.BUFFERING=1]="BUFFERING",g[g.PAUSED=2]="PAUSED",g[g.SKIP=3]="SKIP",g[g.STOPPED=4]="STOPPED",g[g.ERROR=5]="ERROR",g[g.WINDOW_SIZE=6]="WINDOW_SIZE",g[g.FULLSCREEN=7]="FULLSCREEN",g[g.VISIBLE=8]="VISIBLE",g[g.HIDDEN=9]="HIDDEN",g[g.iS=10]="MUTED",g[g.nS=11]="LANGUAGE_SWITCH";function y(){}i.rS=y;var T,O=function(){this.type=2},m=(T=v.sS,s(_,T),_.prototype.eS=function(i,t){var n;this.sessions.forEach(function(t){t.sessionId==i&&(n=t)}),n||((n=new E.hS()).sessionId=i,n.events=[],this.sessions.push(n)),n.events.push(t)},_);function _(){var t=T.call(this)||this;return t.sessions=new Array(),t}var R=(S.prototype.oS=function(t){this.client=t},S.prototype.init=function(t,i){this.uS=t,this.xl(i),this.logger.debug(b+"INIT ID: "+t)},S.prototype.xl=function(t){this.Bl=t},S.prototype.updatePlayerInfo=function(t){this.aS=t},S.prototype.lv=function(t){var i=new N(t,this);this.fS.push(i),this.cS=null,this.client.lS(!0)},S.prototype.manifestRequested=function(t,i,n){if(!this.cS)for(var r=0;r<this.fS.length;r++){var s=this.fS[r];if(s.ticket.sessionId===t){this.logger.debug(b+"Activating Track for session "+t),this.cS=s;break}}if(this.cS)if(this.cS.ticket.sessionId==t){if(!this.cS.vS){var e=new k(t,i,n);this.cS.dS(e),this.client.lS()}}else this.logger.warn(b+"ignoring manifest not matching event "+this.cS.ticket.sessionId+" != "+t)},S.prototype.ES=function(t,i,n){null!=this.cS&&(this.cS.vS||this.cS.wS.push(new G(t,i,n)))},S.prototype.pS=function(t,i,n){this.gS.push(new P(t,i,n)),this.client.lS()},S.prototype.handleTechEvent=function(t,i,n){this.bS.push(new U(t,i,n)),this.client.lS()},S.prototype.yS=function(t){var i=this;t&&t.forEach(function(t){i.bS.push(t)})},S.prototype.TS=function(){var t=new d.qc();c.HiveConfig.ClientInfo.rc&&c.HiveConfig.ClientInfo.sc?(t.partnerId=c.HiveConfig.ClientInfo.rc,t.customerId=c.HiveConfig.ClientInfo.sc):this.cS&&(t.partnerId=this.cS.ticket.mR(),t.customerId=this.cS.ticket._R()),t.version=this.Bl.name+"_"+this.Bl.version;var i=new h.OS();return i.mS(navigator.userAgent),t.os=i._S().name+" "+i._S().version,this.aS&&(t.commVersion=this.aS.commVersion,t.pluginName=this.aS.pluginName,t.pluginVersion=this.aS.pluginVersion,t.playerTech=this.aS.playerTech,t.playerVersion=this.aS.playerVersion,this.aS.telemetryId&&(t.telemetryId=this.aS.telemetryId)),t},S.prototype.RS=function(){return this.cS?this.cS:this.fS&&0<this.fS.length?this.fS[this.fS.length-1]:void 0},S.prototype.IS=function(t){var n=this;if(void 0===t&&(t=!0),0==this.fS.length&&0==this.gS.length)return t?o.reject("nothing to send"):(this.logger.debug(b+" NOTHING TO SEND"),null);var r=new l.NS();r.app=w.zR,r.createdAt=u.Framework.time(),r.guid=this.uS,r.name=w.JR;var i=this.RS();if(i){var s=i.ticket.CS().replace(/[\[\]]/g,"");r.tags=[s],r.tags.push(i.ticket.mR()),r.tags.push(i.ticket._R())}else r.tags=new Array();var e=new m();if(e.peer=this.TS(),this.fS.forEach(function(t){t.vS||e.eS(t.ticket.sessionId,t)}),this.gS.forEach(function(t){e.eS(t.sessionId,t)}),this.bS.forEach(function(t){e.eS(t.sessionId,t)}),r.data=e,t)return this.kS.getConnectivityInfo().then(function(t){var i=n.DS(t);return e.eS("null",i),r}).fail(function(t){return r});var h=this.DS(this.kS.jS());return e.eS("null",h),r},S.prototype.DS=function(t){var i=new O();i.ts=u.Framework.time();var n=t.getNetworkChanged();return n.getPublicIp()&&(i.pubIp=n.getPublicIp()),n.getPrivateIp()&&(i.privIp=e.SensitiveInfoUtils.getPrivateIp(n)),t.getHostName()&&(i.hostname=e.SensitiveInfoUtils.getHostname(t)),n.getCidr()&&(i.netmask=n.getCidr()),n.getNic()&&(i.nic=n.getNic()),n.getNicName()&&(i.nicName=n.getNicName()),n.getMacAddress()&&(i.mac=n.getMacAddress()),i},S.prototype.MS=function(){return navigator.userAgent},S.prototype.reset=function(){this.fS=new Array(),this.gS=new Array(),this.bS=new Array()},S.prototype.PS=function(t){},S);function S(){this.logger=u.Framework.resolve(u.Framework.v.p).log(),this.kS=u.Framework.resolve(u.Framework.v.jR),this.fS=new Array(),this.gS=new Array(),this.bS=new Array()}i.LS=R;var A=(I.prototype.lS=function(t){void 0===t&&(t=!1);var i=t?a.Rc.pc:a.Rc.wc;this.HS?i<this.US-new Date().getTime()&&(u.Framework.clearTimeout(this.HS),this.US=null,this.FS(i)):this.FS(i)},I.prototype.Kl=function(){this.HS&&(u.Framework.clearTimeout(this.HS),this.US=this.HS=null)},I.prototype.FS=function(t,i){var n=this;void 0===i&&(i=!1),this.HS=u.Framework.setTimeout(function(){n.GS()},t,i),this.US=new Date().getTime()+t},I.prototype.GS=function(t){var i=this;void 0===t&&(t=!0),this.HS=null,this.US=null;var n=this.ql.IS(t);t?(this.logger.debug(b+"TAKING A TRACK SNAPSHOT"),n.then(function(t){return i.forward(t)}).fail(function(t){i.logger.debug(b+" ERROR GENERATING/SENDING THE TRACK SNAPSHOT: ",t)})["finally"](function(){return i.ql.reset()}).done()):(this.logger.debug(b+"FLUSHING TRACK SNAPSHOT"),this.forward(n),this.ql.reset())},I.prototype.forward=function(t){if(!this.filter||this.filter.Hl()){if(this.client&&this.client.xS()&&t){var i=JSON.stringify(t);switch(this.BS){case 0:default:this.logger.debug(b+"TRACK EVENT");break;case 1:this.logger.debug(b+"TRACK EVENT:"+i)}var n=new f.Lc(HiveStreamingServices.VS,2,i);this.client.xS().send(n)}}else this.logger.debug(b+"SKIPPING SNAPSHOT")},I.prototype.qS=function(t){void 0===t&&(t=!0),t?(this.Kl(),this.FS(a.Rc.gc,!0)):this.GS(!1)},I.prototype.$l=function(t){this.filter=t},I);function I(t){this.BS=isNaN(c.HiveConfig.DebugLogs.TrackSnapshotLogs)?0:c.HiveConfig.DebugLogs.TrackSnapshotLogs,this.ql=t,this.logger=u.Framework.resolve(u.Framework.v.p).log(),this.client=u.Framework.resolve(u.Framework.v.jl),this.ql.oS(this)}i.Zl=A;var N=(C.prototype.dS=function(t){this.manifests.push(t)},C.prototype.toJSON=function(){var n={type:0,ticket:{}};n.ticket.url=this.ticket.QS(),n.ticket.reqTs=this.ticket.bR,n.ticket.respTs=this.ticket.yR,n.ticket.userAgent=this.ql.MS(),null!=this.ticket.testId&&(n.ticket.testId=this.ticket.testId),n.manifests=[],this.manifests.forEach(function(t){var i={};i.url=t.url,i.respTs=t.yR,i.respCode=t.respCode,n.manifests.push(i)});var i=-1,r=-1,s=-1;return this.wS.forEach(function(t){0<t.YS&&(-1==i&&(i=t.ts,r=t.YS),s=t.YS)}),-1!=i&&(n.playTs=i),-1!=s&&(n.buffTime=s),-1!=r&&(n.initBuffTime=r),n},C);function C(t,i){this.createdAt=new Date().getTime(),this.vS=!1,this.ticket=t,this.manifests=new Array(),this.wS=new Array(),this.ql=i}i.KS=N;var k=function(t,i,n){this.eventId=t,this.url=i,this.yR=new Date().getTime(),this.respCode=n},D=(j.prototype.toJSON=function(){var t={};return t.type=this.WS+this.event,t.ts=this.ts,this.$S&&(t.parameters=this.$S),t},j);function j(t,i,n,r){this.ts=new Date().getTime(),this.sessionId=t,this.sessionId||(this.sessionId="null"),this.event=i,this.$S=n,r&&(this.ts=r)}var M,P=(s(L,M=D),L);function L(t,i,n,r){var s=M.call(this,t,i,n,r)||this;return s.WS=100,s}var H,U=(s(F,H=D),F);function F(t,i,n,r){var s=H.call(this,t,i,n,r)||this;return s.WS=200,s}i.XS=U;var G=function(t,i,n){this.ts=new Date().getTime(),this.playingPoint=t,this.zS=i,this.YS=n}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r,s,e=n(43),h=n(3);(s=r=i.JS||(i.JS={}))[s.off=0]="off",s[s.error=1]="error",s[s.warn=2]="warn",s[s.notice=3]="notice",s[s.info=4]="info",s[s.debug=5]="debug",s[s.trace=6]="trace";var o=(u.prototype.lR=function(t,i){e.HiveConfig.Framework.HiveDebugLevel&&null!=r[e.HiveConfig.Framework.HiveDebugLevel]?this.level=r[e.HiveConfig.Framework.HiveDebugLevel]:null!=r[t]?this.level=r[t]:!1,this.ZS(i)},u.prototype.ZS=function(t){var i={log:this.tA(this.logger.log,r.error,t),error:this.tA(this.logger.error,r.error,t),warn:this.tA(this.logger.warn,r.warn,t),notice:this.tA(this.logger.info,r.notice,t),info:this.tA(this.logger.info,r.info,t),debug:this.tA(this.logger.debug,r.debug,t),trace:this.tA(this.logger.trace,r.trace,t)};t?this.iA.set(t,i):this.nA=i},u.prototype.tA=function(t,i,n){if(!(this.level>=i))return function(){};try{return e.HiveConfig.Framework.LoggerTimestamp?n?Function.prototype.bind.call(t,console,"S["+n+"] %s",this.timestamp):Function.prototype.bind.call(t,console,"%s",this.timestamp):n?Function.prototype.bind.call(t,console,"S["+n+"]"):Function.prototype.bind.call(t,console)}catch(t){}},u.prototype.log=function(t){return t?(this.iA.has(t)||this.lR(r[this.level],t),this.iA.get(t)):this.nA},u);function u(){this.timestamp=function(){},this.iA=new h(),this.level=r.debug,this.timestamp.toString=function(){var t=new Date();return"["+(("0"+t.getUTCHours()).slice(-2)+":"+("0"+t.getUTCMinutes()).slice(-2)+":"+("0"+t.getUTCSeconds()).slice(-2)+":"+("00"+t.getUTCMilliseconds()).slice(-3))+"]"},this.logger="undefined"==typeof console?{log:function(){}}:console,this.logger.trace||(this.logger.trace=this.logger.log),this.logger.debug||(this.logger.debug=this.logger.log),this.logger.info||(this.logger.info=this.logger.log),this.logger.warn||(this.logger.warn=this.logger.log),this.logger.error||(this.logger.error=this.logger.log),this.lR(r[this.level])}i.rA=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(7),f=n(23),s=(e.sA=function(t){return new e(t.eA,t.hA,!0,t.id,t.duration,t.qualityLevel,!0)},e.prototype.S_=function(){return this.oA},e.prototype.uA=function(){return this.aA},e.prototype.getDuration=function(){return this.duration},e.prototype.getQualityLevel=function(){return this.qualityLevel},e.prototype.M_=function(){return this.fA},e.prototype.cA=function(){return this.lA},e.prototype.I_=function(){return this.vA},e.prototype.D_=function(){return this.url},e.prototype.toString=function(){return r.xa[this.S_()]+"-"+this.I_()},e);function e(t,i,n,r,s,e,h,o){var u=(o||t).replace(/http(s)?:\/\//,""),a=f.ol.ib(u).toString(f.ol.jg.Mg);this.url=t,this.oA=i,this.lA=n,this.aA=r,this.duration=s,this.qualityLevel=e,this.fA=h,this.vA=[a,r,e?e.id:null].join("-")}i.dA=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.getInstance=function(){return this.instance||(this.instance=new s()),this.instance},s.prototype.register=function(t,i,n){n=n||t.getPluginId();var r=this.EA(n);r.plugin=t,i&&r.sessions.push(i)},s.prototype.unregister=function(t,i){var n=t.getPluginId(),r=this.EA(n),s=r.sessions.length;r.plugin?s?(r.sessions=r.sessions.filter(function(t){return t.id!==i.id}),s===r.sessions.length?t.logger().warn(this.loggerId+" Attempt to unregister a not found session (pluginId = "+n+", sessionId = "+i.id+")"):t.logger().debug(this.loggerId+" Unregistered session (pluginId = "+n+", sessionId = "+i.id+")")):t.logger().warn(this.loggerId+" Attempt to unregister a session for plugin with no sessions (pluginId = "+n+", sessionId = "+i.id+")"):!1},s.prototype.clear=function(){this.store={}},s.prototype.EA=function(t){var i=this.store[t];return i||(i={plugin:null,sessions:[]},this.store[t]=i),i},s.prototype.wA=function(){var t=Object.keys(this.store);if(!t.length)return null;var i=this.store[t[0]].plugin;return i?i.getPluginId():null},s.prototype.pA=function(t){return this.EA(t).plugin},s.prototype.gA=function(t){return this.EA(t).sessions},s);function s(){this.loggerId="[SessionRegistry] ",this.store={}}i.aR=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var s=n(152),e=n(170),r=(h.bA=function(t,i,n){return this.yA(t,i,n)||-1!=t.indexOf(h.TA)},h.yA=function(t,i,n){var r=-1!=t.toLowerCase().indexOf(h.OA.toLowerCase())||-1!=t.toLowerCase().indexOf(h.mA.toLowerCase());if(n){if(n.test(t))return!0;!r&&i&&i.warn(this.loggerId+"Context matcher set to "+n+" failed against "+t)}return r},h._A=function(t,i){var n=i.replace("_definst_/","").match(new RegExp(t.replace(".mpd","")+h.RA));return n&&0<n.length},h.SA=function(t,i,n,r){return 0<t.indexOf(h.mA)?new e.AA(i,n,r):new s.IA(i,n,r)},h.loggerId="[DASH] ",h.NA=1,h.CA=2,h.kA=2e3,h.DA=3e4,h.jA=1e4,h.MA=!0,h.PA=!0,h.LA=500,h.HA=16,h.UA=3,h.FA=10,h.DASH_METADATA_MIN_FRAGMENTS=3,h.OA="(format=mpd-time-csf)",h.mA=".mpd",h.RA="_.*.mpd",h.TA=".m4s",h.GA=".ism/",h);function h(){}i.Dash=r},function(t,i,n){"use strict";n(10);var s=n(153),r=n(11),e=n(59),h=n(12);function o(t,n,r,i){if(!(this instanceof o))return new o(t,n,r,i);n=n||Object.equals,r=r||Object.compare,i=i||Function._e,this.Re=n,this._f=r,this.Ae=i,this.store=new s(null,function(t,i){return n(t.key,i.key)},function(t,i){return r(t.key,i.key)}),this.length=0,this.hiveAddEach(t)}(t.exports=o).SortedMap=o,Object.hiveAddEach(o.prototype,r.prototype),Object.hiveAddEach(o.prototype,e.prototype),Object.hiveAddEach(o.prototype,h.prototype),o.prototype.Ne=function(t){return new this.constructor(t,this.Re,this._f,this.Ae)},o.prototype.log=function(t,r,i,n){r=r||this.Ce,this.store.log(t,function(t,i,n){r(t.value,i,n)},i,n)},o.prototype.Ce=function(t,i){i(" key: "+t.key),i(" value: "+t.value)}},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(103),o=n(186),u=(e=o.xA,s(a,e),a.prototype.send=function(){if(this.readyState!==this.OPENED)throw new Error("The object's state must be OPENED.");if(!this.pluginId){var t=Object.keys(a.BA);0<t.length&&(this.pluginId=a.BA[t[0]])}h["default"].getInstance().request(this,this.pluginId)},a.prototype.abort=function(){h["default"].getInstance().abort(this,this.pluginId)},a.Sl=0,a);function a(t){var i=e.call(this,t)||this;return i.DONE=4,i.LOADING=3,i.HEADERS_RECEIVED=2,i.OPENED=1,i.UNSENT=0,i.internal=!1,i.id=a.Sl++,i}i.VA=u},function(t,i,n){var r,s,e;s=[n(202)],void 0===(e="function"==typeof (r=function(u){"use strict";var d=function(t,i,n){if(void 0===t&&(t=d.qA),void 0===i&&(i=d.QA),void 0===n&&(n=d.YA),!n){if((t|=0)<0)throw RangeError("Illegal capacity");i=!!i,n=!!n}this.buffer=0===t?e:new ArrayBuffer(t),this.view=0===t?null:new Uint8Array(this.buffer),this.offset=0,this.KA=-1,this.WA=t,this.$A=void 0!==i&&!!i,this.XA=!!n};d.VERSION="4.1.0",d.zA=!0,d.JA=!1,d.qA=16,d.QA=d.JA,d.YA=!1,d.ZA=u||null;var h=d.prototype;h.tI,Object.defineProperty(h,"tI",{value:!0,enumerable:!1,configurable:!1});var e=new ArrayBuffer(0),n=String.fromCharCode;function o(t){var i=0;return function(){return i<t.length?t.charCodeAt(i++):null}}function a(){var t=[],i=[];return function(){if(0===arguments.length)return i.join("")+n.apply(String,t);1024<t.length+arguments.length&&(i.push(n.apply(String,t)),t.length=0),Array.prototype.push.apply(t,arguments)}}function r(t,i,n,r,s){var e,h,o=8*s-r-1,u=(1<<o)-1,a=u>>1,f=-7,c=n?s-1:0,l=n?-1:1,v=t[i+c];for(c+=l,e=v&(1<<-f)-1,v>>=-f,f+=o;0<f;e=256*e+t[i+c],c+=l,f-=8);for(h=e&(1<<-f)-1,e>>=-f,f+=r;0<f;h=256*h+t[i+c],c+=l,f-=8);if(0===e)e=1-a;else{if(e===u)return h?NaN:1/0*(v?-1:1);h+=Math.pow(2,r),e-=a}return(v?-1:1)*h*Math.pow(2,e-r)}function s(t,i,n,r,s,e){var h,o,u,a=8*e-s-1,f=(1<<a)-1,c=f>>1,l=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,v=r?0:e-1,d=r?1:-1,E=i<0||0===i&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(o=isNaN(i)?1:0,h=f):(h=Math.floor(Math.log(i)/Math.LN2),i*(u=Math.pow(2,-h))<1&&(h--,u*=2),2<=(i+=1<=h+c?l/u:l*Math.pow(2,1-c))*u&&(h++,u/=2),f<=h+c?(o=0,h=f):1<=h+c?(o=(i*u-1)*Math.pow(2,s),h+=c):(o=i*Math.pow(2,c-1)*Math.pow(2,s),h=0));8<=s;t[n+v]=255&o,v+=d,o/=256,s-=8);for(h=h<<s|o,a+=s;0<a;t[n+v]=255&h,v+=d,h/=256,a-=8);t[n+v-d]|=128*E}d.iI=function(){return Uint8Array},d.nI=function(t,i,n){return new d(t,i,n)},d.concat=function(t,i,n,r){"boolean"!=typeof i&&"string"==typeof i||(r=n,n=i,i=void 0);for(var s,e=0,h=0,o=t.length;h<o;++h)d.rI(t[h])||(t[h]=d.wrap(t[h],i)),0<(s=t[h].WA-t[h].offset)&&(e+=s);if(0===e)return new d(0,n,r);var u,a=new d(e,n,r);for(h=0;h<o;)(s=(u=t[h++]).WA-u.offset)<=0||(a.view.set(u.view.subarray(u.offset,u.WA),a.offset),a.offset+=s);return a.WA=a.offset,a.offset=0,a},d.rI=function(t){return!0===(t&&t.tI)},d.type=function(){return ArrayBuffer},d.wrap=function(t,i,n,r){if("string"!=typeof i&&(r=n,n=i,i=void 0),"string"==typeof t)switch(void 0===i&&(i="utf8"),i){case"base64":return d.sI(t,n);case"hex":return d.eI(t,n);case"binary":return d.hI(t,n);case"utf8":return d.oI(t,n);case"debug":return d.uI(t,n);default:throw Error("Unsupported encoding: "+i)}if(null===t||"object"!=typeof t)throw TypeError("Illegal buffer");var s;if(d.rI(t))return(s=h.clone.call(t)).KA=-1,s;if(t instanceof Uint8Array)s=new d(0,n,r),0<t.length&&(s.buffer=t.buffer,s.offset=t.byteOffset,s.WA=t.byteOffset+t.byteLength,s.view=new Uint8Array(t.buffer));else if(t instanceof ArrayBuffer)s=new d(0,n,r),0<t.byteLength&&(s.buffer=t,s.offset=0,s.WA=t.byteLength,s.view=0<t.byteLength?new Uint8Array(t):null);else{if("[object Array]"!==Object.prototype.toString.call(t))throw TypeError("Illegal buffer");(s=new d(t.length,n,r)).WA=t.length;for(var e=0;e<t.length;++e)s.view[e]=t[e]}return s},h.aI=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+t>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+"+t+") <= "+this.buffer.byteLength)}var r=this.slice(i,i+t);return n&&(this.offset+=t),r},h.fI=h.append,h.cI=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=1;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=1,this.view[i]=t,n&&(this.offset+=1),this},h.tp=h.cI,h.lI=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var n=this.view[t];return 128==(128&n)&&(n=-(255-n+1)),i&&(this.offset+=1),n},h.Op=h.lI,h.vI=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=1;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=1,this.view[i]=t,n&&(this.offset+=1),this},h.dI=h.vI,h.EI=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var n=this.view[t];return i&&(this.offset+=1),n},h.wI=h.EI,h.pI=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=2;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=2,this.$A?(this.view[i+1]=(65280&t)>>>8,this.view[i]=255&t):(this.view[i]=(65280&t)>>>8,this.view[i+1]=255&t),n&&(this.offset+=2),this},h.gI=h.pI,h.bI=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+2) <= "+this.buffer.byteLength)}var n=0;return this.$A?(n=this.view[t],n|=this.view[t+1]<<8):(n=this.view[t]<<8,n|=this.view[t+1]),32768==(32768&n)&&(n=-(65535-n+1)),i&&(this.offset+=2),n},h.yI=h.bI,h.TI=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=2;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=2,this.$A?(this.view[i+1]=(65280&t)>>>8,this.view[i]=255&t):(this.view[i]=(65280&t)>>>8,this.view[i+1]=255&t),n&&(this.offset+=2),this},h.OI=h.TI,h.mI=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+2) <= "+this.buffer.byteLength)}var n=0;return this.$A?(n=this.view[t],n|=this.view[t+1]<<8):(n=this.view[t]<<8,n|=this.view[t+1]),i&&(this.offset+=2),n},h._I=h.mI,h.RI=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=4;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=4,this.$A?(this.view[i+3]=t>>>24&255,this.view[i+2]=t>>>16&255,this.view[i+1]=t>>>8&255,this.view[i]=255&t):(this.view[i]=t>>>24&255,this.view[i+1]=t>>>16&255,this.view[i+2]=t>>>8&255,this.view[i+3]=255&t),n&&(this.offset+=4),this},h.al=h.RI,h.SI=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+4) <= "+this.buffer.byteLength)}var n=0;return this.$A?(n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0):(n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0),n|=0,i&&(this.offset+=4),n},h.gl=h.SI,h.AI=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=4;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=4,this.$A?(this.view[i+3]=t>>>24&255,this.view[i+2]=t>>>16&255,this.view[i+1]=t>>>8&255,this.view[i]=255&t):(this.view[i]=t>>>24&255,this.view[i+1]=t>>>16&255,this.view[i+2]=t>>>8&255,this.view[i+3]=255&t),n&&(this.offset+=4),this},h.II=h.AI,h.NI=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+4) <= "+this.buffer.byteLength)}var n=0;return this.$A?(n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0):(n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0),i&&(this.offset+=4),n},h.CI=h.NI,u&&(h.kI=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("number"==typeof t)t=u.rb(t);else if("string"==typeof t)t=u.fromString(t);else if(!(t&&t instanceof u))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t?t=u.rb(t):"string"==typeof t&&(t=u.fromString(t)),i+=8;var r=this.buffer.byteLength;r<i&&this.resize((r*=2)>i?r:i),i-=8;var s=t.low,e=t.high;return this.$A?(this.view[i+3]=s>>>24&255,this.view[i+2]=s>>>16&255,this.view[i+1]=s>>>8&255,this.view[i]=255&s,i+=4,this.view[i+3]=e>>>24&255,this.view[i+2]=e>>>16&255,this.view[i+1]=e>>>8&255,this.view[i]=255&e):(this.view[i]=e>>>24&255,this.view[i+1]=e>>>16&255,this.view[i+2]=e>>>8&255,this.view[i+3]=255&e,i+=4,this.view[i]=s>>>24&255,this.view[i+1]=s>>>16&255,this.view[i+2]=s>>>8&255,this.view[i+3]=255&s),n&&(this.offset+=8),this},h.DI=h.kI,h.jI=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}var n=0,r=0;this.$A?(n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0,t+=4,r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0):(r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0,t+=4,n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0);var s=new u(n,r,!1);return i&&(this.offset+=8),s},h.MI=h.jI,h.LI=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("number"==typeof t)t=u.rb(t);else if("string"==typeof t)t=u.fromString(t);else if(!(t&&t instanceof u))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t?t=u.rb(t):"string"==typeof t&&(t=u.fromString(t)),i+=8;var r=this.buffer.byteLength;r<i&&this.resize((r*=2)>i?r:i),i-=8;var s=t.low,e=t.high;return this.$A?(this.view[i+3]=s>>>24&255,this.view[i+2]=s>>>16&255,this.view[i+1]=s>>>8&255,this.view[i]=255&s,i+=4,this.view[i+3]=e>>>24&255,this.view[i+2]=e>>>16&255,this.view[i+1]=e>>>8&255,this.view[i]=255&e):(this.view[i]=e>>>24&255,this.view[i+1]=e>>>16&255,this.view[i+2]=e>>>8&255,this.view[i+3]=255&e,i+=4,this.view[i]=s>>>24&255,this.view[i+1]=s>>>16&255,this.view[i+2]=s>>>8&255,this.view[i+3]=255&s),n&&(this.offset+=8),this},h.HI=h.LI,h.UI=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}var n=0,r=0;this.$A?(n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0,t+=4,r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0):(r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0,t+=4,n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0);var s=new u(n,r,!0);return i&&(this.offset+=8),s},h.FI=h.UI),h.GI=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("number"!=typeof t)throw TypeError("Illegal value: "+t+" (not a number)");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=4;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=4,s(this.view,t,i,this.$A,23,4),n&&(this.offset+=4),this},h.xI=h.GI,h.BI=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+4) <= "+this.buffer.byteLength)}var n=r(this.view,t,this.$A,23,4);return i&&(this.offset+=4),n},h.VI=h.BI,h.qI=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("number"!=typeof t)throw TypeError("Illegal value: "+t+" (not a number)");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=8;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=8,s(this.view,t,i,this.$A,52,8),n&&(this.offset+=8),this},h.sp=h.qI,h.QI=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}var n=r(this.view,t,this.$A,52,8);return i&&(this.offset+=8),n},h.Rp=h.QI,d.YI=5,d.KI=function(t){return(t>>>=0)<128?1:t<16384?2:t<1<<21?3:t<1<<28?4:5},d.WI=function(t){return((t|=0)<<1^t>>31)>>>0},d.$I=function(t){return t>>>1^-(1&t)|0},h.XI=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var r,s=d.KI(t);i+=s;var e=this.buffer.byteLength;for(e<i&&this.resize((e*=2)>i?e:i),i-=s,t>>>=0;128<=t;)r=127&t|128,this.view[i++]=r,t>>>=7;return this.view[i++]=t,n?(this.offset=i,this):s},h.zI=function(t,i){return this.XI(d.WI(t),i)},h.JI=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var n,r=0,s=0;do{if(!this.XA&&t>this.WA){var e=Error("Truncated");throw e.ZI=!0,e}n=this.view[t++],r<5&&(s|=(127&n)<<7*r),++r}while(0!=(128&n));return s|=0,i?(this.offset=t,s):{value:s,length:r}},h.tN=function(t){var i=this.JI(t);return"object"==typeof i?i.value=d.$I(i.value):i=d.$I(i),i},u&&(d.iN=10,d.nN=function(t){"number"==typeof t?t=u.rb(t):"string"==typeof t&&(t=u.fromString(t));var i=t.rN()>>>0,n=t.sN(28).rN()>>>0,r=t.sN(56).rN()>>>0;return 0==r?0==n?i<16384?i<128?1:2:i<1<<21?3:4:n<16384?n<128?5:6:n<1<<21?7:8:r<128?9:10},d.eN=function(t){return"number"==typeof t?t=u.rb(t,!1):"string"==typeof t?t=u.fromString(t,!1):!1!==t.hN&&(t=t.oN()),t.shiftLeft(1).xor(t.aN(63)).uN()},d.fN=function(t){return"number"==typeof t?t=u.rb(t,!1):"string"==typeof t?t=u.fromString(t,!1):!1!==t.hN&&(t=t.oN()),t.sN(1).xor(t.and(u.ONE).oN().Ub()).oN()},h.cN=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("number"==typeof t)t=u.rb(t);else if("string"==typeof t)t=u.fromString(t);else if(!(t&&t instanceof u))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t?t=u.rb(t,!1):"string"==typeof t?t=u.fromString(t,!1):!1!==t.hN&&(t=t.oN());var r=d.nN(t),s=t.rN()>>>0,e=t.sN(28).rN()>>>0,h=t.sN(56).rN()>>>0;i+=r;var o=this.buffer.byteLength;switch(o<i&&this.resize((o*=2)>i?o:i),i-=r,r){case 10:this.view[i+9]=h>>>7&1;case 9:this.view[i+8]=9!==r?128|h:127&h;case 8:this.view[i+7]=8!==r?e>>>21|128:e>>>21&127;case 7:this.view[i+6]=7!==r?e>>>14|128:e>>>14&127;case 6:this.view[i+5]=6!==r?e>>>7|128:e>>>7&127;case 5:this.view[i+4]=5!==r?128|e:127&e;case 4:this.view[i+3]=4!==r?s>>>21|128:s>>>21&127;case 3:this.view[i+2]=3!==r?s>>>14|128:s>>>14&127;case 2:this.view[i+1]=2!==r?s>>>7|128:s>>>7&127;case 1:this.view[i]=1!==r?128|s:127&s}return n?(this.offset+=r,this):r},h.lN=function(t,i){return this.cN(d.eN(t),i)},h.vN=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var n=t,r=0,s=0,e=0,h=0;if(h=this.view[t++],r=127&h,128&h&&(h=this.view[t++],r|=(127&h)<<7,(128&h||this.XA&&void 0===h)&&(h=this.view[t++],r|=(127&h)<<14,(128&h||this.XA&&void 0===h)&&(h=this.view[t++],r|=(127&h)<<21,(128&h||this.XA&&void 0===h)&&(h=this.view[t++],s=127&h,(128&h||this.XA&&void 0===h)&&(h=this.view[t++],s|=(127&h)<<7,(128&h||this.XA&&void 0===h)&&(h=this.view[t++],s|=(127&h)<<14,(128&h||this.XA&&void 0===h)&&(h=this.view[t++],s|=(127&h)<<21,(128&h||this.XA&&void 0===h)&&(h=this.view[t++],e=127&h,(128&h||this.XA&&void 0===h)&&(h=this.view[t++],e|=(127&h)<<7,128&h||this.XA&&void 0===h))))))))))throw Error("Buffer overrun");var o=u.LO(r|s<<28,s>>>4|e<<24,!1);return i?(this.offset=t,o):{value:o,length:t-n}},h.dN=function(t){var i=this.vN(t);return i&&i.value instanceof u?i.value=d.fN(i.value):i=d.fN(i),i}),h.fl=function(t,i){var n=void 0===i;n&&(i=this.offset);var r,s=t.length;if(!this.XA){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");for(r=0;r<s;++r)if(0===t.charCodeAt(r))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}s=c.EN(o(t))[1],i+=s+1;var e=this.buffer.byteLength;return e<i&&this.resize((e*=2)>i?e:i),i-=s+1,c.wN(o(t),function(t){this.view[i++]=t}.bind(this)),this.view[i++]=0,n?(this.offset=i,this):s},h.Tl=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var n,r=t,s=-1;return c.pN(function(){if(0===s)return null;if(t>=this.WA)throw RangeError("Illegal range: Truncated data, "+t+" < "+this.WA);return 0===(s=this.view[t++])?null:s}.bind(this),n=a(),!0),i?(this.offset=t,n()):{string:n(),length:t-r}},h.gN=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var r,s=i;r=c.EN(o(t),this.XA)[1],i+=4+r;var e=this.buffer.byteLength;if(e<i&&this.resize((e*=2)>i?e:i),i-=4+r,this.$A?(this.view[i+3]=r>>>24&255,this.view[i+2]=r>>>16&255,this.view[i+1]=r>>>8&255,this.view[i]=255&r):(this.view[i]=r>>>24&255,this.view[i+1]=r>>>16&255,this.view[i+2]=r>>>8&255,this.view[i+3]=255&r),i+=4,c.wN(o(t),function(t){this.view[i++]=t}.bind(this)),i!==s+4+r)throw RangeError("Illegal range: Truncated data, "+i+" == "+(i+4+r));return n?(this.offset=i,this):i-s},h.bN=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+4) <= "+this.buffer.byteLength)}var n,r=0,s=t;this.$A?(r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0):(r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0);var e,h=(t+=4)+r;return c.pN(function(){return t<h?this.view[t++]:null}.bind(this),e=a(),this.XA),n=e(),i?(this.offset=t,n):{string:n,length:t-s}},d.yN="c",d.TN="b",h.ON=function(t,i){var n,r=void 0===i;if(r&&(i=this.offset),!this.XA){if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var s=i;n=c.EN(o(t))[1],i+=n;var e=this.buffer.byteLength;return e<i&&this.resize((e*=2)>i?e:i),i-=n,c.wN(o(t),function(t){this.view[i++]=t}.bind(this)),r?(this.offset=i,this):i-s},h.nw=h.ON,d.mN=function(t){return c.EN(o(t))[0]},d._N=function(t){return c.EN(o(t))[1]},d.RN=d._N,h.SN=function(t,i,n){"number"==typeof i&&(n=i,i=void 0);var r=void 0===n;if(r&&(n=this.offset),void 0===i&&(i=d.yN),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal length: "+t+" (not an integer)");if(t|=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}var s,e=0,h=n;if(i===d.yN){if(s=a(),c.AN(function(){return e<t&&n<this.WA?this.view[n++]:null}.bind(this),function(t){++e,c.IN(t,s)}),e!==t)throw RangeError("Illegal range: Truncated data, "+e+" == "+t);return r?(this.offset=n,s()):{string:s(),length:n-h}}if(i!==d.TN)throw TypeError("Unsupported metrics: "+i);if(!this.XA){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+t>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+"+t+") <= "+this.buffer.byteLength)}var o=n+t;if(c.pN(function(){return n<o?this.view[n++]:null}.bind(this),s=a(),this.XA),n!==o)throw RangeError("Illegal range: Truncated data, "+n+" == "+o);return r?(this.offset=n,s()):{string:s(),length:n-h}},h.$E=h.SN,h.NN=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var r,s,e=i;r=c.EN(o(t),this.XA)[1],s=d.KI(r),i+=s+r;var h=this.buffer.byteLength;if(h<i&&this.resize((h*=2)>i?h:i),i-=s+r,i+=this.XI(r,i),c.wN(o(t),function(t){this.view[i++]=t}.bind(this)),i!==e+r+s)throw RangeError("Illegal range: Truncated data, "+i+" == "+(i+r+s));return n?(this.offset=i,this):i-e},h.CN=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var n,r=this.JI(t),s=t;t+=r.length,r=r.value;var e=t+r,h=a();return c.pN(function(){return t<e?this.view[t++]:null}.bind(this),h,this.XA),n=h(),i?(this.offset=t,n):{string:n,length:t-s}},h.append=function(t,i,n){"number"!=typeof i&&"string"==typeof i||(n=i,i=void 0);var r=void 0===n;if(r&&(n=this.offset),!this.XA){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}t instanceof d||(t=d.wrap(t,i));var s=t.WA-t.offset;if(s<=0)return this;n+=s;var e=this.buffer.byteLength;return e<n&&this.resize((e*=2)>n?e:n),n-=s,this.view.set(t.view.subarray(t.offset,t.WA),n),t.offset+=s,r&&(this.offset+=s),this},h.kN=function(t,i){return t.append(this,i),this},h.assert=function(t){return this.XA=!t,this},h.DN=function(){return this.buffer.byteLength},h.clear=function(){return this.offset=0,this.WA=this.buffer.byteLength,this.KA=-1,this},h.clone=function(t){var i=new d(0,this.$A,this.XA);return t?(i.buffer=new ArrayBuffer(this.buffer.byteLength),i.view=new Uint8Array(i.buffer)):(i.buffer=this.buffer,i.view=this.view),i.offset=this.offset,i.KA=this.KA,i.WA=this.WA,i},h.compact=function(t,i){if(void 0===t&&(t=this.offset),void 0===i&&(i=this.WA),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal end: Not an integer");if(i>>>=0,t<0||i<t||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+i+" <= "+this.buffer.byteLength)}if(0===t&&i===this.buffer.byteLength)return this;var n=i-t;if(0==n)return this.buffer=e,this.view=null,0<=this.KA&&(this.KA-=t),this.offset=0,this.WA=0,this;var r=new ArrayBuffer(n),s=new Uint8Array(r);return s.set(this.view.subarray(t,i)),this.buffer=r,this.view=s,0<=this.KA&&(this.KA-=t),this.offset=0,this.WA=n,this},h.jN=function(t,i){if(void 0===t&&(t=this.offset),void 0===i&&(i=this.WA),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal end: Not an integer");if(i>>>=0,t<0||i<t||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+i+" <= "+this.buffer.byteLength)}if(t===i)return new d(0,this.$A,this.XA);var n=i-t,r=new d(n,this.$A,this.XA);return r.offset=0,r.WA=n,0<=r.KA&&(r.KA-=t),this.Db(r,0,t,i),r},h.Db=function(t,i,n,r){var s,e;if(!this.XA&&!d.rI(t))throw TypeError("Illegal target: Not a ByteBuffer");if(i=(e=void 0===i)?t.offset:0|i,n=(s=void 0===n)?this.offset:0|n,r=void 0===r?this.WA:0|r,i<0||i>t.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+i+" <= "+t.buffer.byteLength);if(n<0||r>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+n+" <= "+this.buffer.byteLength);var h=r-n;return 0==h?t:(t.MN(i+h),t.view.set(this.view.subarray(n,r),i),s&&(this.offset+=h),e&&(t.offset+=h),this)},h.MN=function(t){var i=this.buffer.byteLength;return i<t?this.resize((i*=2)>t?i:t):this},h.fill=function(t,i,n){var r=void 0===i;if(r&&(i=this.offset),"string"==typeof t&&0<t.length&&(t=t.charCodeAt(0)),void 0===i&&(i=this.offset),void 0===n&&(n=this.WA),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal begin: Not an integer");if(i>>>=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal end: Not an integer");if(n>>>=0,i<0||n<i||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+i+" <= "+n+" <= "+this.buffer.byteLength)}if(n<=i)return this;for(;i<n;)this.view[i++]=t;return r&&(this.offset=i),this},h.cl=function(){return this.WA=this.offset,this.offset=0,this},h.mark=function(t){if(t=void 0===t?this.offset:t,!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return this.KA=t,this},h.order=function(t){if(!this.XA&&"boolean"!=typeof t)throw TypeError("Illegal littleEndian: Not a boolean");return this.$A=!!t,this},h.PN=function(t){return this.$A=void 0===t||!!t,this},h.LN=function(t){return this.$A=void 0!==t&&!t,this},h.prepend=function(t,i,n){"number"!=typeof i&&"string"==typeof i||(n=i,i=void 0);var r=void 0===n;if(r&&(n=this.offset),!this.XA){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}t instanceof d||(t=d.wrap(t,i));var s=t.WA-t.offset;if(s<=0)return this;var e=s-n;if(0<e){var h=new ArrayBuffer(this.buffer.byteLength+e),o=new Uint8Array(h);o.set(this.view.subarray(n,this.buffer.byteLength),s),this.buffer=h,this.view=o,this.offset+=e,0<=this.KA&&(this.KA+=e),this.WA+=e,n+=e}else new Uint8Array(this.buffer);return this.view.set(t.view.subarray(t.offset,t.WA),n-s),t.offset=t.WA,r&&(this.offset-=s),this},h.HN=function(t,i){return t.prepend(this,i),this},h.UN=function(t){"function"!=typeof t&&(t=emptyFunction.bind(console)),t(this.toString()+"\n-------------------------------------------------------------------\n"+this.FN(!0))},h.GN=function(){return this.WA-this.offset},h.reset=function(){return 0<=this.KA?(this.offset=this.KA,this.KA=-1):this.offset=0,this},h.resize=function(t){if(!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal capacity: "+t+" (not an integer)");if((t|=0)<0)throw RangeError("Illegal capacity: 0 <= "+t)}if(this.buffer.byteLength<t){var i=new ArrayBuffer(t),n=new Uint8Array(i);n.set(this.view),this.buffer=i,this.view=n}return this},h.reverse=function(t,i){if(void 0===t&&(t=this.offset),void 0===i&&(i=this.WA),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal end: Not an integer");if(i>>>=0,t<0||i<t||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+i+" <= "+this.buffer.byteLength)}return t===i||Array.prototype.reverse.call(this.view.subarray(t,i)),this},h.XE=function(t){if(!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal length: "+t+" (not an integer)");t|=0}var i=this.offset+t;if(!this.XA&&(i<0||i>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+t+" <= "+this.buffer.byteLength);return this.offset=i,this},h.slice=function(t,i){if(void 0===t&&(t=this.offset),void 0===i&&(i=this.WA),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal end: Not an integer");if(i>>>=0,t<0||i<t||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+i+" <= "+this.buffer.byteLength)}var n=this.clone();return n.offset=t,n.WA=i,n},h.toBuffer=function(t){var i=this.offset,n=this.WA;if(!this.XA){if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: Not an integer");if(i>>>=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal limit: Not an integer");if(n>>>=0,i<0||n<i||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+i+" <= "+n+" <= "+this.buffer.byteLength)}if(!t&&0===i&&n===this.buffer.byteLength)return this.buffer;if(i===n)return e;var r=new ArrayBuffer(n-i);return new Uint8Array(r).set(new Uint8Array(this.buffer).subarray(i,n),0),r},h.toArrayBuffer=h.toBuffer,h.toString=function(t,i,n){if(void 0===t)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.KA+",limit="+this.WA+",capacity="+this.DN()+")";switch("number"==typeof t&&(n=i=t="utf8"),t){case"utf8":return this.xN(i,n);case"base64":return this.toBase64(i,n);case"hex":return this.BN(i,n);case"binary":return this.VN(i,n);case"debug":return this.FN();case"columns":return this.qN();default:throw Error("Unsupported encoding: "+t)}};var f=function(){for(var t={},s=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],h=[],i=0,n=s.length;i<n;++i)h[s[i]]=i;return t.encode=function(t,i){for(var n,r;null!==(n=t());)i(s[n>>2&63]),r=(3&n)<<4,null!==(n=t())?(i(s[63&((r|=n>>4&15)|n>>4&15)]),r=(15&n)<<2,null!==(n=t())?(i(s[63&(r|n>>6&3)]),i(s[63&n])):(i(s[63&r]),i(61))):(i(s[63&r]),i(61),i(61))},t.decode=function(t,i){var n,r,s;function e(t){throw Error("Illegal character code: "+t)}for(;null!==(n=t());)if(void 0===(r=h[n])&&e(n),null!==(n=t())&&(void 0===(s=h[n])&&e(n),i(r<<2>>>0|(48&s)>>4),null!==(n=t()))){if(void 0===(r=h[n])){if(61===n)break;e(n)}if(i((15&s)<<4>>>0|(60&r)>>2),null!==(n=t())){if(void 0===(s=h[n])){if(61===n)break;e(n)}i((3&r)<<6>>>0|s)}}},t.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)},t}();h.toBase64=function(t,i){if(void 0===t&&(t=this.offset),void 0===i&&(i=this.WA),i|=0,(t|=0)<0||i>this.DN||i<t)throw RangeError("begin, end");var n;return f.encode(function(){return t<i?this.view[t++]:null}.bind(this),n=a()),n()},d.sI=function(t,i){if("string"!=typeof t)throw TypeError("str");var n=new d(t.length/4*3,i),r=0;return f.decode(o(t),function(t){n.view[r++]=t}),n.WA=r,n},d.btoa=function(t){return d.hI(t).toBase64()},d.atob=function(t){return d.sI(t).VN()},h.VN=function(t,i){if(void 0===t&&(t=this.offset),void 0===i&&(i=this.WA),i|=0,(t|=0)<0||i>this.DN()||i<t)throw RangeError("begin, end");if(t===i)return"";for(var n=[],r=[];t<i;)n.push(this.view[t++]),1024<=n.length&&(r.push(String.fromCharCode.apply(String,n)),n=[]);return r.join("")+String.fromCharCode.apply(String,n)},d.hI=function(t,i){if("string"!=typeof t)throw TypeError("str");for(var n,r=0,s=t.length,e=new d(s,i);r<s;){if(255<(n=t.charCodeAt(r)))throw RangeError("illegal char code: "+n);e.view[r++]=n}return e.WA=s,e},h.FN=function(t){for(var i,n=-1,r=this.buffer.byteLength,s="",e="",h="";n<r;){if(-1!==n&&(i=this.view[n],s+=i<16?"0"+i.toString(16).toUpperCase():i.toString(16).toUpperCase(),t&&(e+=32<i&&i<127?String.fromCharCode(i):".")),++n,t&&0<n&&n%16==0&&n!==r){for(;s.length<51;)s+=" ";h+=s+e+"\n",s=e=""}n===this.offset&&n===this.WA?s+=n===this.KA?"!":"|":n===this.offset?s+=n===this.KA?"[":"<":n===this.WA?s+=n===this.KA?"]":">":s+=n===this.KA?"'":t||0!==n&&n!==r?" ":""}if(t&&" "!==s){for(;s.length<51;)s+=" ";h+=s+e+"\n"}return t?h:s},d.uI=function(t,i,n){for(var r,s,e=t.length,h=new d((e+1)/3|0,i,n),o=0,u=0,a=!1,f=!1,c=!1,l=!1,v=!1;o<e;){switch(r=t.charAt(o++)){case"!":if(!n){if(f||c||l){v=!0;break}f=c=l=!0}h.offset=h.KA=h.WA=u,a=!1;break;case"|":if(!n){if(f||l){v=!0;break}f=l=!0}h.offset=h.WA=u,a=!1;break;case"[":if(!n){if(f||c){v=!0;break}f=c=!0}h.offset=h.KA=u,a=!1;break;case"<":if(!n){if(f){v=!0;break}f=!0}h.offset=u,a=!1;break;case"]":if(!n){if(l||c){v=!0;break}l=c=!0}h.WA=h.KA=u,a=!1;break;case">":if(!n){if(l){v=!0;break}l=!0}h.WA=u,a=!1;break;case"'":if(!n){if(c){v=!0;break}c=!0}h.KA=u,a=!1;break;case" ":a=!1;break;default:if(!n&&a){v=!0;break}if(s=parseInt(r+t.charAt(o++),16),!n&&(isNaN(s)||s<0||255<s))throw TypeError("Illegal str: Not a debug encoded string");h.view[u++]=s,a=!0}if(v)throw TypeError("Illegal str: Invalid symbol at "+o)}if(!n){if(!f||!l)throw TypeError("Illegal str: Missing offset or limit");if(u<h.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+u+" < "+e)}return h},h.BN=function(t,i){if(t=void 0===t?this.offset:t,i=void 0===i?this.WA:i,!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal end: Not an integer");if(i>>>=0,t<0||i<t||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+i+" <= "+this.buffer.byteLength)}for(var n,r=new Array(i-t);t<i;)(n=this.view[t++])<16?r.push("0",n.toString(16)):r.push(n.toString(16));return r.join("")},d.eI=function(t,i,n){if(!n){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");if(t.length%2!=0)throw TypeError("Illegal str: Length not a multiple of 2")}for(var r,s=t.length,e=new d(s/2|0,i),h=0,o=0;h<s;h+=2){if(r=parseInt(t.substring(h,h+2),16),!n&&(!isFinite(r)||r<0||255<r))throw TypeError("Illegal str: Contains non-hex characters");e.view[o++]=r}return e.WA=o,e};var c=function(){var r={QN:1114111,YN:function(t,i){var n=null;for("number"==typeof t&&(n=t,t=function(){return null});null!==n||null!==(n=t());)n<128?i(127&n):(n<2048?i(n>>6&31|192):(n<65536?i(n>>12&15|224):(i(n>>18&7|240),i(n>>12&63|128)),i(n>>6&63|128)),i(63&n|128)),n=null},AN:function(t,i){for(var n,r,s,e,h=function(t){t=t.slice(0,t.indexOf(null));var i=Error(t.toString());throw i.name="TruncatedError",i.bytes=t,i};null!==(n=t());)if(0==(128&n))i(n);else if(192==(224&n))null===(r=t())&&h([n,r]),i((31&n)<<6|63&r);else if(224==(240&n))null!==(r=t())&&null!==(s=t())||h([n,r,s]),i((15&n)<<12|(63&r)<<6|63&s);else{if(240!=(248&n))throw RangeError("Illegal starting byte: "+n);null!==(r=t())&&null!==(s=t())&&null!==(e=t())||h([n,r,s,e]),i((7&n)<<18|(63&r)<<12|(63&s)<<6|63&e)}},KN:function(t,i){for(var n,r=null;null!==(n=null!==r?r:t());)55296<=n&&n<=57343&&null!==(r=t())&&56320<=r&&r<=57343?(i(1024*(n-55296)+r-56320+65536),r=null):i(n);null!==r&&i(r)},IN:function(t,i){var n=null;for("number"==typeof t&&(n=t,t=function(){return null});null!==n||null!==(n=t());)n<=65535?i(n):(i(55296+((n-=65536)>>10)),i(n%1024+56320)),n=null},wN:function(t,i){r.KN(t,function(t){r.YN(t,i)})},pN:function(t,i){r.AN(t,function(t){r.IN(t,i)})},WN:function(t){return t<128?1:t<2048?2:t<65536?3:4},$N:function(t){for(var i,n=0;null!==(i=t());)n+=i<128?1:i<2048?2:i<65536?3:4;return n},EN:function(t){var i=0,n=0;return r.KN(t,function(t){++i,n+=t<128?1:t<2048?2:t<65536?3:4}),[i,n]}};return r}();return h.xN=function(i,n){if(void 0===i&&(i=this.offset),void 0===n&&(n=this.WA),!this.XA){if("number"!=typeof i||i%1!=0)throw TypeError("Illegal begin: Not an integer");if(i>>>=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal end: Not an integer");if(n>>>=0,i<0||n<i||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+i+" <= "+n+" <= "+this.buffer.byteLength)}var t;try{c.pN(function(){return i<n?this.view[i++]:null}.bind(this),t=a())}catch(t){if(i!==n)throw RangeError("Illegal range: Truncated data, "+i+" != "+n)}return t()},d.oI=function(t,i,n){if(!n&&"string"!=typeof t)throw TypeError("Illegal str: Not a string");var r=new d(c.EN(o(t),!0)[1],i,n),s=0;return c.wN(o(t),function(t){r.view[s++]=t}),r.WA=s,r},d})?r.apply(i,s):r)||(t.exports=e)},function(t,i){var n,r,s=t.exports={};function e(){throw new Error("setTimeout has not been defined")}function h(){throw new Error("clearTimeout has not been defined")}function o(i){if(n===setTimeout)return setTimeout(i,0);if((n===e||!n)&&setTimeout)return n=setTimeout,setTimeout(i,0);try{return n(i,0)}catch(t){try{return n.call(null,i,0)}catch(t){return n.call(this,i,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:e}catch(t){n=e}try{r="function"==typeof clearTimeout?clearTimeout:h}catch(t){r=h}}();var u,a=[],f=!1,c=-1;function l(){f&&u&&(f=!1,u.length?a=u.concat(a):c=-1,a.length&&v())}function v(){if(!f){var t=o(l);f=!0;for(var i=a.length;i;){for(u=a,a=[];++c<i;)u&&u[c].XN();c=-1,i=a.length}u=null,f=!1,(function(i){if(r===clearTimeout)return clearTimeout(i);if((r===h||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(i);try{r(i)}catch(t){try{return r.call(null,i)}catch(t){return r.call(this,i)}}})(t)}}function d(t,i){this.zN=t,this.array=i}function E(){}s.Me=function(t){var i=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)i[n-1]=arguments[n];a.push(new d(t,i)),1!==a.length||f||o(v)},d.prototype.XN=function(){this.zN.apply(null,this.array)},s.title="browser",s.JN=!0,s.Ge={},s.ZN=[],s.version="",s.Fp={},s.on=E,s.addListener=E,s.tC=E,s.off=E,s.removeListener=E,s.iC=E,s.nh=E,s.nC=E,s.rC=E,s.listeners=function(t){return[]},s.sC=function(t){throw new Error("process.binding is not supported")},s.eC=function(){return"/"},s.hC=function(t){throw new Error("process.chdir is not supported")},s.oC=function(){return 0}},function(t,i,n){"use strict";var h=n(39);t.exports=Object,Object.empty=Object.freeze(Object.create(null)),Object.tc=function(t){return Object(t)===t},Object.uC=function(t){return t&&"function"==typeof t.valueOf&&(t=t.valueOf()),t};var r=new h();Object.hash=function(t){return t&&"function"==typeof t.hash?""+t.hash():Object(t)===t?(r.has(t)||r.set(t,Math.random().toString(36).slice(2)),r.get(t)):""+t};var s=Object.prototype.hasOwnProperty;Object.aC=function(t,i){return s.call(t,i)},Object.has=function(t,i){if("object"!=typeof t)throw new Error("Object.has can't accept non-object: "+typeof t);if(t&&"function"==typeof t.has)return t.has(i);if("string"==typeof i)return i in t&&t[i]!==Object.prototype[i];throw new Error("Key must be a string for Object.has on plain objects")},Object.get=function(t,i,n){if("object"!=typeof t)throw new Error("Object.get can't accept non-object: "+typeof t);return t&&"function"==typeof t.get?t.get(i,n):Object.has(t,i)?t[i]:n},Object.set=function(t,i,n){t&&"function"==typeof t.set?t.set(i,n):t[i]=n},Object.hiveAddEach=function(n,i){if(i)if("function"!=typeof i.forEach||i.hasOwnProperty("forEach"))if("number"==typeof i.length)for(var t=0;t<i.length;t++)n[t]=i[t];else Object.keys(i).forEach(function(t){n[t]=i[t]});else!0===i.isMap?i.forEach(function(t,i){n[i]=t}):i.forEach(function(t){n[t[0]]=t[1]});return n},Object.forEach=function(t,i,n){for(var r,s=Object.keys(t),e=0;r=s[e];e++)i.call(n,t[r],r,t)},Object.map=function(t,i,n){for(var r,s=Object.keys(t),e=0,h=[];r=s[e];e++)h.push(i.call(n,t[r],r,t));return h},Object.values=function(t){return Object.map(t,Function.identity)},Object.concat=function(){for(var t={},i=0;i<arguments.length;i++)Object.hiveAddEach(t,arguments[i]);return t},Object.from=Object.concat,Object.is=function(t,i){return t===i?0!==t||1/t==1/i:t!=t&&i!=i},Object.equals=function(t,i,n,r){if(n=n||Object.equals,(t=Object.uC(t))===(i=Object.uC(i)))return!0;if(Object.tc(t)){if((r=r||new h()).has(t))return!0;r.set(t,!0)}if(Object.tc(t)&&"function"==typeof t.equals)return t.equals(i,n,r);if(Object.tc(i)&&"function"==typeof i.equals)return i.equals(t,n,r);if(Object.tc(t)&&Object.tc(i)&&Object.getPrototypeOf(t)===Object.prototype&&Object.getPrototypeOf(i)===Object.prototype){for(var s in t)if(!n(t[s],i[s],n,r))return!1;for(var s in i)if(!(s in t&&n(i[s],t[s],n,r)))return!1;return!0}return t!=t&&i!=i||(!t||!i)&&t===i},Object.compare=function(t,i){if((t=Object.uC(t))===(i=Object.uC(i)))return 0;var n=typeof t,r=typeof i;return"number"==n&&"number"==r?t-i:"string"==n&&"string"==r?t<i?-1/0:1/0:t&&"function"==typeof t.compare?t.compare(i):i&&"function"==typeof i.compare?-i.compare(t):0},Object.clone=function(t,i,n){if(t=Object.uC(t),n=n||new h(),void 0===i)i=1/0;else if(0===i)return t;if(Object.tc(t)){if(!n.has(t))if(t&&"function"==typeof t.clone)n.set(t,t.clone(i,n));else{var r=Object.getPrototypeOf(t);if(null!==r&&r!==Object.prototype)throw new Error("Can't clone "+t);var s=Object.create(r);for(var e in n.set(t,s),t)s[e]=Object.clone(t[e],i-1,n)}return n.get(t)}return t},Object.clear=function(t){if(t&&"function"==typeof t.clear)t.clear();else for(var i=Object.keys(t),n=i.length;n;)delete t[i[--n]];return t}},function(T,t){!function(){"use strict";if("undefined"==typeof ses||!ses.ok||ses.ok()){"undefined"!=typeof ses&&(ses.fC=E);var i=!1;if("function"==typeof WeakMap){var n=WeakMap;if(!("undefined"!=typeof navigator&&/Firefox/.test(navigator.userAgent))){var t=new n(),r=Object.freeze({});if(t.set(r,1),1===t.get(r))return T.exports=WeakMap;i=!0}}Object.prototype.hasOwnProperty;var s=Object.getOwnPropertyNames,e=Object.defineProperty,h=Object.isExtensible,o="weakmap:",u=o+"ident:"+Math.random()+"___";if("undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues&&"function"==typeof ArrayBuffer&&"function"==typeof Uint8Array){var a=new ArrayBuffer(25),f=new Uint8Array(a);crypto.getRandomValues(f),u=o+"rand:"+Array.prototype.map.call(f,function(t){return(t%36).toString(36)}).join("")+"___"}if(e(Object,"getOwnPropertyNames",{value:function(t){return s(t).filter(w)}}),"getPropertyNames"in Object){var c=Object.cC;e(Object,"getPropertyNames",{value:function(t){return c(t).filter(w)}})}!function(){var i=Object.freeze;e(Object,"freeze",{value:function(t){return p(t),i(t)}});var n=Object.seal;e(Object,"seal",{value:function(t){return p(t),n(t)}});var r=Object.preventExtensions;e(Object,"preventExtensions",{value:function(t){return p(t),r(t)}})}();var l=!1,v=0,d=function(){this instanceof d||b();var s=[],e=[],h=v++;return Object.create(d.prototype,{lC:{value:g(function(t,i){var n,r=p(t);return r?h in r?r[h]:i:0<=(n=s.indexOf(t))?e[n]:i})},vC:{value:g(function(t){var i=p(t);return i?h in i:0<=s.indexOf(t)})},dC:{value:g(function(t,i){var n,r=p(t);return r?r[h]=i:0<=(n=s.indexOf(t))?e[n]=i:(n=s.length,e[n]=i,s[n]=t),this})},EC:{value:g(function(t){var i,n,r=p(t);return r?h in r&&delete r[h]:!((i=s.indexOf(t))<0)&&(n=s.length-1,s[i]=void 0,e[i]=e[n],s[i]=s[n],s.length=n,e.length=n,!0)})}})};d.prototype=Object.create(Object.prototype,{get:{value:function(t,i){return this.lC(t,i)},writable:!0,configurable:!0},has:{value:function(t){return this.vC(t)},writable:!0,configurable:!0},set:{value:function(t,i){return this.dC(t,i)},writable:!0,configurable:!0},"delete":{value:function(t){return this.EC(t)},writable:!0,configurable:!0}}),"function"==typeof n?(i&&"undefined"!=typeof Proxy&&(Proxy=void 0),y.prototype=d.prototype,T.exports=y,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})):("undefined"!=typeof Proxy&&(Proxy=void 0),T.exports=d)}function E(t){t.wC&&t.wC(E)}function w(t){return!(t.substr(0,o.length)==o&&"___"===t.substr(t.length-3))}function p(t){if(t!==Object(t))throw new TypeError("Not an object: "+t);var i=t[u];if(i&&i.key===t)return i;if(h(t)){i={key:t};try{return e(t,u,{value:i,writable:!1,enumerable:!1,configurable:!1}),i}catch(t){return}}}function g(t){return t.prototype=null,Object.freeze(t)}function b(){l||"undefined"==typeof console||(l=!0,!1)}function y(){this instanceof d||b();var t,r=new n(),s=void 0,e=!1;return t=i?function(t,i){return r.set(t,i),r.has(t)||(s=s||new d()).set(t,i),this}:function(i,n){if(e)try{r.set(i,n)}catch(t){(s=s||new d()).dC(i,n)}else r.set(i,n);return this},Object.create(d.prototype,{lC:{value:g(function(t,i){return s?r.has(t)?r.get(t):s.lC(t,i):r.get(t,i)})},vC:{value:g(function(t){return r.has(t)||!!s&&s.vC(t)})},dC:{value:g(t)},EC:{value:g(function(t){var i=!!r["delete"](t);return s&&s.EC(t)||i})},wC:{value:g(function(t){if(t!==E)throw new Error("bogus call to permitHostObjects___");e=!0})}})}}()},function(t,i,n){"use strict";var r=n(39),s=n(58),e=new r();function h(){throw new Error("Can't construct. RangeChanges is a mixin.")}(t.exports=h).prototype.pC=function(){return e.has(this)||e.set(this,s()),e.get(this)},h.prototype.gC=function(t){var i=this.pC();return t=t||"",i.has(t)||i.set(t,{isActive:!1,xf:[],Gf:[]}),i.get(t)},h.prototype.bC=function(t,i,n){!this.Qf&&this.qf&&this.qf();var r=this.gC(i);(n?r.Gf:r.xf).push(t),Object.defineProperty(this,"yC",{value:!0,writable:!0,configurable:!0,enumerable:!1});var s=this;return function(){s&&(s.TC(t,i,n),s=null)}},h.prototype.TC=function(t,i,n){var r,s=this.gC(i),e=(r=n?s.Gf:s.xf).lastIndexOf(t);if(-1===e)throw new Error("Can't remove range change listener: does not exist: token "+JSON.stringify(i));r.splice(e,1)},h.prototype.OC=function(s,e,h,o){var t=this.pC(),u="Range"+(o?"WillChange":"Change");t.forEach(function(t,i){if(!t.isActive){var n;t.isActive=!0,n=o?t.Gf:t.xf;var r="handle"+(i.slice(0,1).toUpperCase()+i.slice(1))+u;try{n.slice().forEach(function(t){if(!(n.indexOf(t)<0))if(t[r])t[r](s,e,h,this,o);else{if(!t.call)throw new Error("Handler "+t+" has no method "+r+" and is not callable");t.call(this,s,e,h,this,o)}},this)}finally{t.isActive=!1}}},this)},h.prototype.mC=function(t,i){return this.bC(t,i,!0)},h.prototype._C=function(t,i){return this.TC(t,i,!0)},h.prototype.RC=function(t,i,n){return this.OC(t,i,n,!0)}},function(t,i){function n(){throw new Error("Can't construct. GenericSet is a mixin.")}(t.exports=n).prototype.SC=!0,n.prototype.AC=function(t){var i=this.Ne(this);return i.hiveAddEach(t),i},n.prototype.IC=function(i){return this.Ne(this.filter(function(t){return i.has(t)}))},n.prototype.NC=function(t){var i=this.Ne(this);return i.Of(t),i},n.prototype.CC=function(t){var i=this.AC(t),n=this.IC(t);return i.NC(n)},n.prototype.kC=function(t){return+this["delete"](t)},n.prototype.equals=function(t,n){var r=this;return t&&"function"==typeof t.reduce&&this.length===t.length&&t.reduce(function(t,i){return t&&r.has(i,n)},!0)},n.prototype.toJSON=function(){return this.toArray()},n.prototype.contains=function(t){return this.has(t)},n.prototype.remove=function(t){return this["delete"](t)},n.prototype.toggle=function(t){this.has(t)?this["delete"](t):this.hiveAdd(t)}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.DC="CACHE",s.jC="CENTRAL_FRAGMENT",s.jR="CONNECTIVITY_INFO_PROVIDER",s.MC="CONTEXT_RESOLVER",s.PC="DCACHE",s.LC="FALLBACK_REQUESTER",s.HC="FRAGMENT_METADATA_METRICS_PROVIDER",s.UC="HTTP_MANAGER",s.FC="HTTP_REQUEST",s.Pl="IDENTITY_PROVIDER",s.GC="IN_PARTNERSHIP",s.xC="IN_PREFETCHER_PARTNERSHIP",s.BC="IP_SPOOFING",s.VC="LIVE_CACHE",s.qC="LOCALITY_CLIENT",s.QC="LOCALITY_SCORE",s.p="LOGGER",s.YC="MEMBERSHIP",s.NETWORK="NETWORK",s.KC="PEER_NODE_INFO",s.WC="OBJECT_INDEX",s.$C="OUT_PARTNERSHIP",s.XC="OUT_PREFETCHER_PARTNERSHIP",s.zC="P2P_REQUESTER",s.JC="P2P_VIDEO_PREFETCHER",s.ZC="PARTNERSHIP",s.Kc="PEER",s.tk="PEER_CONNECTIVITY_INFO",s.ik="PICKER",s.nk="PREFETCH_MANAGER",s.rk="REPORTING",s.sk="REQUEST_TRACKER",s.ek="RESPONDER",s.Zc="RTC_MANAGER",s.hk="SCORE_UPDATER",s.uk="SERVER_MANAGER",s.jl="SERVICES_CLIENT",s.ak="SNAP_STATS_MANAGER",s.zl="STATS_CLIENT",s.nv="STATS_NODE_INFO",s.Xl="STATS_STORE",s.fk="STREAM_INFO_METRICS_PROVIDER",s.vv="TICKET_RESOLVER",s.l="TIMER",s.ck="TRACKER_CLIENT",s.lk="TRACKER_MANAGER",s.vk="TRACK_CLIENT",s.Jl="TRACK_MANAGER",s.dk="TRANSPORT",s.Ek="UDP_BROADCASTER",s.wk="UDP_DISCOVERY",s.sf="UDP_LEADER_ELECTION",s.pk="VOD_CACHE",s.gk="QUALITY_LEVEL_TRACKER",s.bk="QUALITY_LEVEL_METRICS_PROVIDER",s);function s(){}i.v=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.LoggerTimestamp=!0,s);function s(){}var e=(h.MetricSnapshotLogs=0,h.TrackSnapshotLogs=0,h);function h(){}var o=(u.Framework=r,u.DebugLogs=e,u);function u(){}i.HiveConfig=o,"undefined"!=typeof window&&(void 0===window.HiveConfig&&(window.HiveConfig={}),window.HiveConfig.Framework=o.Framework,window.HiveConfig.DebugLogs=o.DebugLogs)},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.wv="undefined"!=typeof location&&"https:"===location.protocol,s.Ov=!0,s.yk=1e4,s.du=6e4,s.Tk="X-Hive-TestId",s);function s(){}i.Rc=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.Ok="127.0.0.1",s.Tv=8999,s.yv=8998,s.bv=8899,s.pv=8898,s.mk="//{0}:{1}/?callback={2}{3}hivePluginId={4}",s._k="//{0}:{1}/?callback={2}",s.Ov=!0,s.Rk=/((http|https):\/\/(.*):([0-9]*)\/([0-9a-z-]*).ism\/)(.*)/,s.Sk="2013.1.1",s.Ak="2018.1",s);function s(){}i.gv=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(1),s=(e.prototype.createXMLHttpRequest=function(){if(!this.pluginId){if(0===Object.keys(e.handlers).length)return e.logError("No registered default HiveRequestFactory tech",e.loggerId),new XMLHttpRequest();this.pluginId=Object.keys(e.handlers)[0]}var t=e.handlers[this.pluginId];if(!t)return e.logError("no registered HiveRequestFactory tech for plugin",{pluginId:this.pluginId}),new XMLHttpRequest();var i=t.delegate;return t.manifestRequested?i.createRequest(this.pluginId):(t.manifestRequested=!0,i.createManifestRequest(this.pluginId))},e.register=function(t){var i=t.getName(),n=t.getPluginId();this.handlers[n]||(this.handlers[n]={tech:i,delegate:t,manifestRequested:!1})},e.clear=function(){this.handlers={}},e.clearPlugin=function(t){this.handlers[t]&&delete this.handlers[t]},e.clearPluginState=function(t){this.handlers[t]&&(this.handlers[t].manifestRequested=!1)},e.logError=function(t,i){this.errorLogged||(this.errorLogged=!0,r.ErrorMonitor.getInstance().logError(t,i))},e.loggerId="[HiveRequestFactory]",e.handlers={},e.errorLogged=!1,e);function e(t){this.pluginId=t}i.HiveRequestFactory=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r,s,e=n(4),h=n(1),o=n(28),u=n(2);(s=r=i.ER||(i.ER={})).INITIALIZED="INITIALIZED",s.ACTIVE="ACTIVE",s.IDLE="IDLE",s.CLOSED="CLOSED";var a=(f.prototype.isActive=function(t,i){return void 0===i&&(i=!1),null!==this.tech&&this.tech.isActive(t,this,i)},f.prototype.updateIdleState=function(t){if(this.idle!=t){this.idle=t,this.tech&&this.tech.onStateChange(this,t);var i=this.idle?r.IDLE:r.ACTIVE;this.notifyStateChange(i)}},f.prototype.getTechName=function(){return this.tech&&this.tech.getName()||void 0},f.prototype.isIdle=function(){return this.idle},f.prototype.close=function(t,i){void 0===i&&(i=!0),this.idle=!0,null!=this.tech&&this.tech.closeSession(this,t,i),this.notifyStateChange(r.CLOSED)},f.prototype.toString=function(){return this.ticket.toString()},f.prototype.toHiveSession=function(){var t=new o.HiveSession();return t.id=this.id,t.ticketUrl=this.ticketUrl,t.manifest=this.manifest,t.tech=this.tech.getName(),t},f.prototype.getReportingInstance=function(){return this.deferReportingInstance.promise},f.prototype.setReportingInstance=function(t){this.reportingInstance=t,this.deferReportingInstance.resolve(this.reportingInstance)},f.prototype.notifyStateChange=function(t){if(this.stateChangeCb)try{this.stateChangeCb({id:this.id,state:t,time:Date.now()})}catch(t){h.ErrorMonitor.getInstance().logError(this.loggerId+" exception in user-defined Generic onSessionStateChange callback: "+t,this.loggerId,u.ie.fe)}},f.prototype.supportsXhrInterception=function(){return!!this.tech&&this.tech.supportsXhrInterception()},f);function f(t,i,n,r,s){this.loggerId="[HiveSessionInternal]",this.idle=!1,this.ticketUrl=t,this.ticket=i,this.manifest=n,"function"==typeof s&&(this.stateChangeCb=s),this.deferReportingInstance=e.defer(),this.reportingInstance=r,this.reportingInstance&&this.deferReportingInstance.resolve(this.reportingInstance)}i.HiveSessionInternal=a},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.from=function(t){return new s(t.id,t.bitrate)},s.prototype.Ob=function(t){return this.id===t.id?0:this.Ik-t.Ik},s.prototype.Nk=function(){this.Ck=[this.bitrate]},s);function s(t,i,n,r,s){this.id=t,this.bitrate=i,this.Ik=null,this.Ck=[i],this.width=n,this.height=r,this.label=s}i.QualityLevel=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(77),o=n(0),r=n(16),s=n(3),e=n(13),u=(a.oS=function(t,i,n){this.client=t,this.kk=i,this.guid=n},a.Dk=function(t,i,n,r,s){var e=new h.NS();e.app=t||"CustomSnapshot",e.guid=r||this.guid,e.createdAt=o.Framework.time(),e.name=n,e.tags=i||this.kk,e.data="string"==typeof s?JSON.parse(s):s,this.send(e)},a.send=function(t){var i=new r.Lc(HiveStreamingServices.VS,2,JSON.stringify(t));this.client&&this.jk&&this.client.xS().send(i)},a.Mk=function(t,i,n,r,s,e){try{var h=t+(i?i.join():"")+n+r,o=this.Pk.has(h)?this.Pk.get(h):[];o.push("string"==typeof s?JSON.parse(s):s),o.length>=e?(this.Dk(t,i,n,r,{buffer:o}),this.Pk["delete"](h)):this.Pk.set(h,o)}catch(t){}},a.jk=e.HiveConfig.ec.enabled,a.Pk=new s(),a);function a(){}i.Lk=u},function(t,i,n){"use strict";function r(t,i){for(var n=0;n<i.length;n++){var r=i[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.defineProperty(i,"s",{value:!0});var s=(function(t,i,n){return i&&r(t.prototype,i),n&&r(t,n),t}(e,[{key:"test",get:function(){return this.Hk}},{key:"converter",get:function(){return this.Uk}}]),e);function e(t,i){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,e),this.Hk=t,this.Uk=i}i["default"]=s},function(t,i,n){"use strict";function r(t,i){for(var n=0;n<i.length;n++){var r=i[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,s),this.init()}Object.defineProperty(i,"s",{value:!0});var e=new(function(t,i,n){return i&&r(t.prototype,i),n&&r(t,n),t}(s,[{key:"init",value:function(){this.Fk="BaseURL",this.Gk="SegmentBase",this.xk="SegmentTemplate",this.Bk="SegmentList",this.Vk="SegmentURL",this.qk="SegmentTimeline",this.Qk="segmentProfiles",this.Yk="AdaptationSet",this.Kk="Representation",this.Wk="RepresentationIndex",this.$k="SubRepresentation",this.Xk="Initialization",this.zk="initialization",this.MPD="MPD",this.zo="Period",this.Jk="AssetIdentifier",this.Zk="EventStream",this.tD="id",this.iD="profiles",this.nD="serviceLocation",this.rD="range",this.sD="index",this.eD="media",this.hD="byteRange",this.oD="indexRange",this.uD="mediaRange",this.aD="value",this.fD="contentType",this.cD="mimeType",this.lD="BitstreamSwitching",this.vD="bitstreamSwitching",this.dD="codecs",this.ED="dependencyId",this.wD="mediaStreamStructureId",this.pD="Metrics",this.gD="metrics",this.rk="Reporting",this.bD="width",this.yD="height",this.TD="sar",this.OD="frameRate",this.mD="audioSamplingRate",this._D="maximumSAPPeriod",this.RD="startWithSAP",this.SD="maxPlayoutRate",this.AD="codingDependency",this.ID="scanType",this.ND="FramePacking",this.CD="AudioChannelConfiguration",this.kD="ContentProtection",this.DD="EssentialProperty",this.jD="SupplementalProperty",this.MD="InbandEventStream",this.PD="Accessibility",this.LD="Role",this.HD="Rating",this.UD="ContentComponent",this.FD="Subset",this.GD="lang",this.xD="Viewpoint",this.BD="Role_asArray",this.VD="Accessibility_asArray",this.qD="AudioChannelConfiguration_asArray",this.QD="ContentProtection_asArray",this.YD="main",this.KD="dynamic",this.WD="static",this.$D="mediaPresentationDuration",this.XD="minimumUpdatePeriod",this.zD="codecPrivateData",this.JD="bandwidth",this.ZD="sourceURL",this.tj="timescale",this.ij="duration",this.nj="startNumber",this.rj="presentationTimeOffset",this.sj="availabilityStartTime",this.ej="availabilityEndTime",this.hj="timeShiftBufferDepth",this.oj="maxSegmentDuration",this.uj="presentationTime",this.aj="minBufferTime",this.fj="maxSubsegmentDuration",this.cj="start",this.lj="availabilityTimeOffset",this.vj="availabilityTimeComplete",this.dj="cenc:default_KID",this.Ej="dvb:priority",this.wj="dvb:weight",this.pj="suggestedPresentationDelay",this.gj="ServiceDescription",this.bj="Scope",this.yj="Latency",this.Tj="PlaybackRate"}}]),s)();i["default"]=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(172),s=(e.bA=function(t,i,n){return this.yA(t,i,n)||-1!=t.indexOf(e.TA)},e.yA=function(t,i,n){var r=-1!=t.toLowerCase().indexOf(e.OA.toLowerCase())||-1!=t.toLowerCase().indexOf(e.Oj.toLowerCase())||-1!=t.toLowerCase().indexOf(e.mj.toLowerCase());if(n){if(n.test(t))return!0;!r&&i&&i.warn(this.loggerId+"Context matcher set to "+n+" failed against "+t)}return r},e.SA=function(t,i){return new r._j(t,i)},e.loggerId="[HLS] ",e.Rj=1,e.Sj=2,e.Aj=3e4,e.Ij=4e3,e.Nj=500,e.Cj=!0,e.kj=1e4,e.Dj=16,e.jj=3,e.OA=".m3u8",e.Oj="(format=m3u8-aapl-v3)",e.mj="(video,format=m3u8-aapl-v3,audiotrack=audio)",e.TA=".ts",e);function e(){}i.Mj=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.Pj=55,s.Lj=6e5,s.Hj=5,s.Uj=10,s.Fj=2,s.Gj=10,s.xj="dist",s.Bj="../scenarios/BrokenUdp",s.Vj=null,s.qj=null,s.Qj=null,s.Yj=!0,s.Kj=!0,s.Wj=6e4,s);function s(){}i.$j=r;var e=(h.Xj="BwEmulation",h);function h(){}i.zj=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var a,r,v,s,f=n(66),c=n(3),l=n(24),d=n(0),E=n(5),e=n(7),w=n(9),p=n(1),g=n(2),b=n(185);(r=a=i.Jj||(i.Jj={}))[r.Z_=0]="PLAYER",r[r.Zj=1]="LAN",r[r.tM=2]="SITE",(s=v=v||{})[s.Zj=0]="LAN",s[s.tM=1]="SITE",s[s.AS=2]="AS",s[s.Qa=3]="OTHER";var h=function(){this.iM=!1,this.oA=null,this.prefetchDelay=-1,this.nM=0};i.rM=h;var o=(u.prototype.init=function(t){this.logger=d.Framework.resolve(d.Framework.v.p).log(t.sessionId),this.sM=t.eM,this.hM=t.hM,this.oM=t.oM,this.gw=t.gw,this.pluginId=t.reportingInstance.ticket.pluginId,this.tv=t.tv,this.partnership=t.partnership,this.uM=t.uM,this.aM=t.aM},u.prototype.AR=function(){this.isActive=!0},u.prototype.fM=function(t,i){this.context=t,this.cM=i,this.uM.fM(i)},u.prototype.lM=function(t){return this.vM.has(t.id)},u.prototype.dM=function(){return this.cM},u.prototype.EM=function(i,t,n){var r=this;try{var s=new f();this.vM.forEach(function(t,i){s.hiveAdd(i)});var e=new f();if(e.hiveAddEach(i.keys()),this.cM.wM()){var h=this.cM.wM().getQualityLevel();if(e.hiveAdd(h.id),e.forEach(function(t){s["delete"](t)}),n){var o=[];s.forEach(function(t){r.vM.has(t)&&r.vM.get(t).pM==a.tM&&(o.push(t),e.hiveAdd(t))}),o.forEach(function(t){s["delete"](t)})}var u=new c();e.forEach(function(t){r.vM.has(t)&&r.vM.get(t).pM==a.tM?u.set(t,a.tM):u.set(t,i.get(t))}),this.gM(s),this.bM(u,t)}}catch(t){p.ErrorMonitor.getInstance().logError("Error updating the prefetch sessions",this.loggerId,g.Is.Ns,t)}},u.prototype.bM=function(t,r){var s=this;t.forEach(function(t,i){var n=s.cM.yM().get(i);n&&s.TM(n,t,r)})},u.prototype.gM=function(t){var n=this;t.forEach(function(t){var i=n.vM.get(t).qualityLevel;n.tv.OM(i),n.logger.debug(n.loggerId+"Remove unwanted quality level "+t),n.vM["delete"](t)})},u.prototype.TM=function(t,i,n){this.vM.has(t.id)?this.mM(t,n):this.vM.has(t.id)||this._M(t,i,n)},u.prototype.mM=function(t,i){try{var n=this.vM.get(t.id);n.type=i,n.type!=a.tM&&(n.prefetchDelay=-1),this.tv.RM(t,n)}catch(t){p.ErrorMonitor.getInstance().logError("Error configuring already existing prefetch sessions",this.loggerId,g.Is.Cs,t)}},u.prototype._M=function(t,i,n){var r=this;try{var s=new h();s.oA=null,s.type=n,s.qualityLevel=t,s.pM=i,this.vM.set(t.id,s),this.vM.forEach(function(t,i){r.logger.debug(r.loggerId+"ABT "+i+" S "+a[t.type]+" PREF REASON "+a[t.pM])}),this.tv.RM(t,s)}catch(t){p.ErrorMonitor.getInstance().logError("Error constructing a new prefetch session",this.loggerId,g.Is.ks,t)}},u.prototype.SM=function(n){var r=this;if(this.vM.has(n.getQualityLevel().id)){var t=this.vM.get(n.getQualityLevel().id);0<t.prefetchDelay&&t.AM&&(t.prefetchDelay=n.getDuration()-(d.Framework.time()-t.AM)-t.nM,t.nM=50),t.oA=n,this.IM(n.getQualityLevel()),this.vM.forEach(function(t,i){t&&t.type!=a.Z_&&i!=n.getQualityLevel().id&&r.NM(t,r.vM.get(i).qualityLevel)})}},u.prototype.NM=function(t,i){if(t.type!=a.Z_){var n=this.cM.wM();if(null!=n){var r=this.cM.CM(n.uA(),i,e.xa.Va);null==r?(this.logger.debug(this.loggerId+"PREFETCHING "+i+" MISSING METADATA "),this.iM(i)):(t.oA=r,this.IM(r.getQualityLevel()))}else this.logger.debug(this.loggerId+"PLAYER NOT PLAYING "),this.iM(i)}},u.prototype.kM=function(t){var i=this.vM.get(t.id);i&&i.iM&&(null!=i.oA?(this.logger.debug(this.loggerId+"RESTART PREFETCHING ON AVAILABLE METADATA"),i.iM=!1,this.IM(i.qualityLevel)):(i.iM=!1,this.NM(i,t)))},u.prototype.DM=function(t){var n=this;t?this.kM(t):this.vM.forEach(function(t,i){n.kM(n.vM.get(i).qualityLevel)})},u.prototype.IM=function(t){var i=this.cM.wM();if(i){var n=this.vM.get(t.id);if(n){if(n.oA&&i.getQualityLevel().id===t.id){var r=this.jM(n.oA.uA(),t);this.tv.setDelta(r)}this.MM(n)}}else p.ErrorMonitor.getInstance().logError("Error attempting prefetch before having a player request",this.loggerId,g.Is.js)},u.prototype.MM=function(t){if(t.oA){var i=this.PM(t.oA);if(null!=i)this.LM(i,t);else{var n=t.qualityLevel;this.logger.debug(this.loggerId+"PREFETCHING "+n.id+" STOPPED BECAUSE OF MISSING METADATA "),this.vM.get(n.id).iM=!0,this.iM(n)}}else t.iM=!0,this.iM(t.qualityLevel)},u.prototype.LM=function(h,t){var o=this,i=this.HM(h,t.type);if(i.jk)try{this.UM.has(h.I_())&&d.Framework.clearTimeout(this.UM.get(h.I_()));var n=i.type==l.h_.a_,r=1;if(n){var s=Math.max(0,t.prefetchDelay);r=this.uM.FM(t.type,h.getQualityLevel(),h.uA(),s)}this.logger.debug(this.loggerId+"PREFETCHING "+h.D_()+" CDN PREFETCH "+n+" IN "+r+" MSECS");var u=this.vM.get(h.getQualityLevel().id);u.oA=h;var e=d.Framework.setTimeout(function(){o.UM["delete"](h.I_());var s=new b.GM(o.pluginId);s.url=h.D_(),u.AM=d.Framework.time(),o.xM=0;var e=o.hM.BM(s,h,o.context,i.type);e&&(e.Q_=t.type==a.tM||t.type==a.Zj,s.onerror=s.onload=function(){if(e.R_()==l.h_.a_&&(!s.status||s.status<200||299<s.status)){var t=o.vM.get(h.getQualityLevel().id);s=null;var i=t.oA.getDuration(),n=t.oA.getDuration()+E.xu.Nu.uo,r=Math.floor(d.Framework.random()*(n-i))+i;t.prefetchDelay=r-(d.Framework.time()-t.AM),t.nM=0,o.IM(t.oA.getQualityLevel())}})},r);this.UM.set(h.I_(),e)}catch(t){p.ErrorMonitor.getInstance().logError("Error requesting for prefetch",this.loggerId,g.Is.Ls,t)}},u.prototype.VM=function(){var n=this;this.UM.forEach(function(t,i){n.logger.debug(n.loggerId+"Clearing delayed prefetch timer id "+t),d.Framework.clearTimeout(t),n.UM["delete"](i)}),this.isActive=!1},u.prototype.iM=function(t){this.vM.has(t.id)&&(this.vM.get(t.id).iM=!0,this.cM.qM(t))},u.prototype.PM=function(t){try{var i=this.vM.get(t.getQualityLevel().id),n=t,r=this.QM(n);return r&&r.I_()!=t.I_()?r:r&&r.I_()==i.oA.I_()?t:null}catch(t){return p.ErrorMonitor.getInstance().logError("Error forwarding to next segment",this.loggerId,g.Is.Ms,t),null}},u.prototype.QM=function(t){if(null==t)return null;var i=this.gw.YM(),n=t;if(i)for(;null!=n&&-1!=i.indexOf(n.I_());)if(!(n=this.cM.KM(n)))return n;return n},u.prototype.HM=function(t,i){try{var n=this.WM(t),r=n?l.h_.l_:l.h_.a_,s=!1;s=i!=a.Z_?!this.UM.has(t.I_())||r!=l.h_.a_:r==l.h_.l_;var e=this.cM.$M(),h=this.XM(t.uA(),t.getQualityLevel(),r),o=i==a.tM;return this.logger.debug(this.loggerId+"PREFETCHING "+l.h_[r]+" (LAN LEADER: "+this.tv.zM()+" SITE LEADER: "+o+") CHECKS FOR "+t.I_()+" [HAVES:"+n+" NOTBUFFERING:"+e+" DISTANCE:"+h.valid+"("+h.JM+")]"),{jk:s&&e&&h.valid&&this.isActive,type:r}}catch(t){return p.ErrorMonitor.getInstance().logError("Error checking if allowed to prefetch",this.loggerId,g.Is.Ps,t),{jk:!1,type:l.h_.a_}}},u.prototype.XM=function(t,i,n){try{var r=this.cM.ZM(t,i);return r<=this.cM.tP()?{JM:r,valid:!0}:{JM:r,valid:!1}}catch(t){return p.ErrorMonitor.getInstance().logError("Error checking the player distance",this.loggerId,g.Is.Hs,t),{JM:0,valid:!1}}},u.prototype.jM=function(t,i){var n=this.cM.wM();if(null==n)return-1;var r=n.uA();return this.cM.iP(r,i,t,i)},u.prototype.WM=function(t){var i=t.I_(),n=t.getDuration(),r=t.uA(),s=t.getQualityLevel();if(this.sM.contains(i)){var e=this.sM.nP(i),h=this.sM.rP(i);if(h.length>=E.xu.Nu.lo){if(E.xu.Nu.Eo){var o=[];o[v.Zj]=[],o[v.tM]=[],o[v.AS]=[],o[v.Qa]=[];var u=this.tv.sP(),a=this.tv.eP();h.forEach(function(t){if(t.hP.peerInfo.type!=w.pf.bf){var i=t.hP.peerInfo.internalAs;if(0!=u&&i&&u==i)o[v.tM].push(t);else{if(E.xu.Nu.Ao){var n=t.hP.peerInfo.externalAs;if(0!=a&&a===n)return void o[v.AS].push(t)}t.hP.peerInfo.type==w.pf.gf&&o[v.Qa].push(t)}}else o[v.Zj].push(t)});var f=null,c=!1,l=!0;return 0<o[v.Zj].length&&(c=this.oP?!this.uP(o[v.Zj],i):(f=v.Zj,!0)),!this.tv.zM()&&this.tv.aP()||0<o[v.tM].length&&(f=v.tM,c=!0),!this.tv.fP()&&this.tv.cP()&&0<o[v.AS].length&&(f=v.AS,c=!0),0<o[v.Qa].length&&(this.tv.lP()||!(this.tv.fP()||this.tv.cP()&&E.xu.Nu.Ao))&&(f=v.Qa,c=!0),c&&f>=E.xu.Nu.Io&&(l=this.vP(o[f],e,n,r,s)),!(!c||!l||(this.logger.debug("down from "+v[f]+" with haves : "+o[v.Zj].length+" "+o[v.tM].length+" "+o[v.AS].length+" "+o[v.Qa].length),0))}return!0}}return!1},u.prototype.vP=function(t,e,h,o,u){var a=this;return t.some(function(t){var i=t.dP();if(0<i){var n=e.size/i,r=a.cM.ZM(o,u),s=!1;return r<h?(s=n<=r*E.xu.Nu.No,a.logger.debug("can download from "+t.guid+" size: "+e.size+" rate: "+i+" dTime: "+n+" fDistance: "+r*E.xu.Nu.No)):(s=n<=h*E.xu.Nu.No,a.logger.debug("can download from "+t.guid+" size: "+e.size+" rate: "+i+" dTime: "+n+" fDuration: "+h*E.xu.Nu.No)),s}})},u.prototype.uP=function(t,i){try{return this.tv.EP().length>E.xu.Nu._o&&(this.tv.wP(),t.length==E.xu.Nu.mo&&t[0].guid==this.tv.pP().uuid&&d.Framework.random()>E.xu.Nu.Ro&&this.xM<E.xu.Nu.So&&(this.logger.debug("SKIP PREFETCH CYCLE "+this.xM+" TO OFFLOAD LEADER"),this.xM++,!0))}catch(t){return p.ErrorMonitor.getInstance().logError("Error deciding to offload the leader",this.loggerId,g.Is.Us,t),!1}},u.prototype.gP=function(t,i){try{t.bP=t.X_.id,t.X_=i,this.logger.debug(this.loggerId+"UPGRADE "+l.h_[t.R_()]+" REQ "+t.C_+" FOR "+t.A_.I_()),t.R_()==l.h_.l_?(t.L_.p2pAgenTrafficSuccessQt=t.W_,t.Y_?(t.type=l.h_.c_,this.oM.yP(t)||(this.logger.debug(this.loggerId+"SET REQUEST TIMED-OUT WAS 0. CDN COMPENSATION"),this.oM.TP(t.OP,"TIMED-OUT"))):(t.type=l.h_.o_,this.logger.debug(this.loggerId+"THE HIVE REQ "+t.I_()+" ARRIVED BEFORE THE P2P_PREFETCH INITIALIZED. CHANGE REQUEST TYPE TO "+l.h_[t.R_()]))):t.R_()==l.h_.a_&&(t.type=l.h_.o_)}catch(t){p.ErrorMonitor.getInstance().logError("Error upgrading prefetch",this.loggerId,g.Is.Fs,t)}},u);function u(){this.loggerId="[Prefetcher] ",this.oP=!0,this.xM=0,this.isActive=!0,this.UM=new c(),this.vM=new c()}i.mP=o},function(t,i,n){var r=n(115),s=n(116),e=s;e._P=r,e.CR=s,t.exports=e},function(t,i){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,i,n){"use strict";t.exports=o;n(10);var r=n(11),s=n(72),e=n(12),h=n(40);function o(t,i,n){if(!(this instanceof o))return new o(t,i,n);var r=this.head=new this.Node();(r.next=r).RP=r,this.Re=i||Object.equals,this.Ae=n||Function._e,this.length=0,this.hiveAddEach(t)}function u(t){this.head=t,this.SP=t.next}function a(t){this.value=t,this.RP=null,this.next=null}o.AP=o,Object.hiveAddEach(o.prototype,r.prototype),Object.hiveAddEach(o.prototype,s.prototype),Object.hiveAddEach(o.prototype,e.prototype),Object.hiveAddEach(o.prototype,h.prototype),o.prototype.Ne=function(t){return new this.constructor(t,this.Re,this.Ae)},o.prototype.find=function(t,i,n){i=i||this.Re;for(var r=this.head,s=this.IP(n,r.next);s!==r;){if(i(s.value,t))return s;s=s.next}},o.prototype.findLast=function(t,i,n){i=i||this.Re;for(var r=this.head,s=this.IP(n,r.RP);s!==r;){if(i(s.value,t))return s;s=s.RP}},o.prototype.has=function(t,i){return!!this.find(t,i)},o.prototype.get=function(t,i){var n=this.find(t,i);return n?n.value:this.Ae(t)},o.prototype["delete"]=function(t,i){var n=this.findLast(t,i);if(n){if(this.yC){var r=[],s=[t];this.RC(r,s,n.index)}return n["delete"](),this.length--,this.yC&&(this.NP(n.next,n.index),this.OC(r,s,n.index)),!0}return!1},o.prototype.kC=function(t,i){i=i||this.Re;for(var n=this.head,r=n.next,s=0;r!==n;)i(t,r.value)&&(r["delete"](),s++),r=r.next;return this.length-=s,s},o.prototype.clear=function(){var t,i;this.yC&&(i=this.toArray(),t=[],this.RC(t,i,0)),this.head.next=this.head.RP=this.head,this.length=0,this.yC&&this.OC(t,i,0)},o.prototype.hiveAdd=function(t){var i=new this.Node(t);return this.yC&&(i.index=this.length,this.RC([t],[],i.index)),this.head.CP(i),this.length++,this.yC&&this.OC([t],[],i.index),!0},o.prototype.push=function(){var t=this.head;if(this.yC){var i=Array.prototype.slice.call(arguments),n=[],r=this.length;this.RC(i,n,r);var s=this.head.RP}for(var e=0;e<arguments.length;e++){var h=arguments[e],o=new this.Node(h);t.CP(o)}this.length+=arguments.length,this.yC&&(this.NP(s.next,void 0===s.index?0:s.index+1),this.OC(i,n,r))},o.prototype.unshift=function(){if(this.yC){var t=Array.prototype.slice.call(arguments),i=[];this.RC(t,i,0)}for(var n=this.head,r=0;r<arguments.length;r++){var s=arguments[r],e=new this.Node(s);n.kP(e),n=e}this.length+=arguments.length,this.yC&&(this.NP(this.head.next,0),this.OC(t,i,0))},o.prototype.pop=function(){var t,i=this.head;if(i.RP!==i){if(t=i.RP.value,this.yC){var n=[],r=[t],s=this.length-1;this.RC(n,r,s)}i.RP["delete"](),this.length--,this.yC&&this.OC(n,r,s)}return t},o.prototype.shift=function(){var t,i=this.head;if(i.RP!==i){if(t=i.next.value,this.yC){var n=[],r=[t];this.RC(n,r,0)}i.next["delete"](),this.length--,this.yC&&(this.NP(this.head.next,0),this.OC(n,r,0))}return t},o.prototype.DP=function(){if(this.head!==this.head.next)return this.head.next.value},o.prototype.jP=function(t){this.head!==this.head.next?this.head.next.value=t:this.push(t)},o.prototype.kf=function(){return this.DP()},o.prototype.IP=function(t,i){var n=this.head;if("number"!=typeof t)return t||i;var r=t;if(0<=r)for(t=n.next;r&&(r--,(t=t.next)!=n););else for(t=n;r<0&&(r++,(t=t.RP)!=n););return t},o.prototype.slice=function(t,i){var n=[],r=this.head;for(t=this.IP(t,r.next),i=this.IP(i,r);t!==i&&t!==r;)n.push(t.value),t=t.next;return n},o.prototype.splice=function(t,i){return this.MP(t,i,Array.prototype.slice.call(arguments,2))},o.prototype.MP=function(t,i,n){var r=t;t=this.IP(t,this.head),null==i&&(i=1/0),n=Array.from(n);for(var s,e,h=[],o=t;i--&&0<=i&&o!==this.head;)h.push(o.value),o=o.next;this.yC&&(s=t===this.head?this.length:t.RP===this.head?0:t.index,e=t.RP,this.RC(n,h,s));o=t;var u=0;for(o=t;u<h.length;u++,o=o.next)o["delete"]();null==r&&o===this.head&&(o=this.head.next);for(u=0;u<n.length;u++){var a=new this.Node(n[u]);o.CP(a)}return this.length+=n.length-h.length,this.yC&&(t===this.head?this.NP(this.head.next,0):this.NP(e.next,e.index+1),this.OC(n,h,s)),h},o.prototype.reverse=function(){if(this.yC){var t=this.toArray(),i=t.reversed();this.RC(i,t,0)}var n=this.head;do{var r=n.next;n.next=n.RP,n.RP=r,n=n.next}while(n!==this.head);return this.yC&&this.OC(i,t,0),this},o.prototype.sort=function(){this.MP(0,this.length,this.Nf())},o.prototype.reduce=function(t,i){for(var n=arguments[2],r=this.head,s=r.next;s!==r;)i=t.call(n,i,s.value,s,this),s=s.next;return i},o.prototype.reduceRight=function(t,i){for(var n=arguments[2],r=this.head,s=r.RP;s!==r;)i=t.call(n,i,s.value,s,this),s=s.RP;return i},o.prototype.NP=function(t,i){for(;t!==this.head;)t.index=i++,t=t.next},o.prototype.qf=function(){this.head.index=-1,this.NP(this.head.next,0),this.yC=!0},o.prototype.Df=function(){return new u(this.head)},u.prototype.PP=null,Object.defineProperty(u.prototype,"LP",{get:function(){return this.PP||(this.PP={done:!1,value:null})}}),u.prototype.next=function(){if(this.SP===this.head)this.LP.done=!0,this.LP.value=void 0;else{var t=this.SP.value;this.SP=this.SP.next,this.LP.value=t}return this.LP},(o.prototype.Node=a).prototype["delete"]=function(){this.RP.next=this.next,this.next.RP=this.RP},a.prototype.CP=function(t){var i=this.RP;(((this.RP=t).RP=i).next=t).next=this},a.prototype.kP=function(t){var i=this.next;(((this.next=t).next=i).RP=t).RP=this}},function(t,i,n){"use strict";n(10);var r=n(11),s=n(59),e=n(12);function h(t,i){if(!(this instanceof h))return new h(t,i);i=i||Function._e,this.Ae=i,this.store=Object.create(null),this.length=0,this.hiveAddEach(t)}(t.exports=h).HP=h,Object.hiveAddEach(h.prototype,r.prototype),Object.hiveAddEach(h.prototype,s.prototype),Object.hiveAddEach(h.prototype,e.prototype),h.prototype.Ne=function(t){return new this.constructor(t,this.Ae)},h.prototype.UP=function(t){if("string"!=typeof t)throw new TypeError("key must be a string but Got "+t)},Object.defineProperty(h.prototype,"FP",{writable:!0}),Object.defineProperty(h.prototype,"GP",{get:function(){return this.hasOwnProperty("$__proto__")&&void 0!==this.xP}}),Object.defineProperty(h.prototype,"xP",{get:function(){return this.FP},set:function(t){this.FP=t}}),h.prototype.get=function(t,i){return this.UP(t),"__proto__"===t?this.GP?this.xP:1<arguments.length?i:this.Ae(t):t in this.store?this.store[t]:1<arguments.length?i:this.Ae(t)},h.prototype.set=function(t,i){this.UP(t);var n="__proto__"===t;return(n?this.GP:t in this.store)?(this.BP&&this.VP(t,n?this.xP:this.store[t]),n?this.xP=i:this.store[t]=i,this.BP&&this.qP(t,i),!1):(this.BP&&this.VP(t,void 0),this.length++,n?this.xP=i:this.store[t]=i,this.BP&&this.qP(t,i),!0)},h.prototype.has=function(t){return this.UP(t),"__proto__"===t?this.GP:t in this.store},h.prototype["delete"]=function(t){return this.UP(t),"__proto__"===t?!!this.GP&&(this.BP&&this.VP(t,this.xP),this.xP=void 0,this.length--,this.BP&&this.qP(t,void 0),!0):t in this.store&&(this.BP&&this.VP(t,this.store[t]),delete this.store[t],this.length--,this.BP&&this.qP(t,void 0),!0)},h.prototype.clear=function(){var t;for(t in this.GP&&(this.BP&&this.VP("__proto__",this.xP),this.xP=void 0,this.BP&&this.qP("__proto__",void 0)),this.store)this.BP&&this.VP(t,this.store[t]),delete this.store[t],this.BP&&this.qP(t,void 0);this.length=0},h.prototype.reduce=function(t,i,n){this.GP&&(i=t.call(n,i,"$__proto__","__proto__",this));var r=this.store;for(var s in this.store)i=t.call(n,i,r[s],s,this);return i},h.prototype.reduceRight=function(n,t,r){var s=this,e=this.store;return t=Object.keys(this.store).reduceRight(function(t,i){return n.call(r,t,e[i],i,s)},t),this.GP?n.call(r,t,this.xP,"__proto__",s):t},h.prototype.kf=function(){var t;for(t in this.store)return this.store[t];return this.xP},h.prototype.toJSON=function(){return this.mf()}},function(t,i,n){"use strict";var r=n(38),s=n(120),e=n(12);function h(){throw new Error("Can't construct. GenericMap is a mixin.")}function o(t,i){this.key=t,this.value=i}t.exports=h,r.hiveAddEach(h.prototype,s.prototype),r.hiveAddEach(h.prototype,e.prototype),h.prototype.isMap=!0,h.prototype.hiveAddEach=function(i){if(i&&r(i)===i)if("function"==typeof i.forEach)!0===i.isMap?i.forEach(function(t,i){this.set(i,t)},this):i.forEach(function(t){this.set(t[0],t[1])},this);else if("number"==typeof i.length)for(var t=0;t<i.length;t++)this.hiveAdd(i[t],t);else r.keys(i).forEach(function(t){this.set(t,i[t])},this);else if(i&&"number"==typeof i.length)for(t=0;t<i.length;t++)this.hiveAdd(i[t],t);return this},h.prototype.get=function(t,i){var n=this.store.get(new this.QP(t));return n?n.value:1<arguments.length?i:this.Ae(t)},h.prototype.set=function(t,i){var n=new this.QP(t,i),r=this.store.get(n),s=!1;return r?(this.BP&&this.VP(t,r.value),r.value=i):(this.BP&&this.VP(t,void 0),this.store.hiveAdd(n)&&(this.length++,s=!0)),this.BP&&this.qP(t,i),s},h.prototype.hiveAdd=function(t,i){return this.set(i,t)},h.prototype.has=function(t){return this.store.has(new this.QP(t))},h.prototype["delete"]=function(t){var i=new this.QP(t);if(this.store.has(i)){var n=this.store.get(i).value;return this.BP&&this.VP(t,n),this.store["delete"](i),this.length--,this.BP&&this.qP(t,void 0),!0}return!1},h.prototype.clear=function(){var t;this.BP&&(this.forEach(function(t,i){this.VP(i,t)},this),t=this.keys()),this.store.clear(),this.length=0,this.BP&&t.forEach(function(t){this.qP(t)},this)},h.prototype.reduce=function(n,t,r){return this.store.reduce(function(t,i){return n.call(r,t,i.value,i.key,this)},t,this)},h.prototype.reduceRight=function(n,t,r){return this.store.reduceRight(function(t,i){return n.call(r,t,i.value,i.key,this)},t,this)},h.prototype.keys=function(){return this.map(function(t,i){return i})},h.prototype.values=function(){return this.map(Function.identity)},h.prototype.entries=function(){return this.map(function(t,i){return[i,t]})},h.prototype.items=function(){return this.entries()},h.prototype.equals=function(i,n){return n=n||r.equals,this===i||(i&&"function"==typeof i.every?i.length===this.length&&i.every(function(t,i){return n(this.get(i),t)},this):r.keys(i).length===this.length&&r.keys(i).every(function(t){return n(this.get(t),i[t])},this))},h.prototype.toJSON=function(){return this.entries()},(h.prototype.QP=o).prototype.equals=function(t){return r.equals(this.key,t.key)&&r.equals(this.value,t.value)},o.prototype.compare=function(t){return r.compare(this.key,t.key)}},function(T,O,m){var _;!function(s,c){"use strict";var t="undefined",i="model",n="name",r="type",e="vendor",h="version",o="architecture",u="console",a="mobile",f="tablet",l="smarttv",v="wearable",d={extend:function(t,i){var n={};for(var r in t)i[r]&&i[r].length%2==0?n[r]=i[r].concat(t[r]):n[r]=t[r];return n},has:function(t,i){return"string"==typeof t&&-1!==i.toLowerCase().indexOf(t.toLowerCase())},YP:function(t){return t.toLowerCase()},KP:function(t){return"string"==typeof t?t.replace(/[^\d\.]/g,"").split(".")[0]:c},trim:function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},E={WP:function(t,i){for(var n,r,s,e,h,o,u=0;u<i.length&&!h;){var a=i[u],f=i[u+1];for(n=r=0;n<a.length&&!h;)if(h=a[n++].exec(t))for(s=0;s<f.length;s++)o=h[++r],"object"==typeof (e=f[s])&&0<e.length?2==e.length?"function"==typeof e[1]?this[e[0]]=e[1].call(this,o):this[e[0]]=e[1]:3==e.length?"function"!=typeof e[1]||e[1].exec&&e[1].test?this[e[0]]=o?o.replace(e[1],e[2]):c:this[e[0]]=o?e[1].call(this,o,e[2]):c:4==e.length&&(this[e[0]]=o?e[3].call(this,o.replace(e[1],e[2])):c):this[e]=o||c;u+=2}},str:function(t,i){for(var n in i)if("object"==typeof i[n]&&0<i[n].length){for(var r=0;r<i[n].length;r++)if(d.has(i[n][r],t))return"?"===n?c:n}else if(d.has(i[n],t))return"?"===n?c:n;return t}},w={JN:{$P:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419",ad:"/"}}},XP:{zP:{JP:{ZP:["SD","KF"]}},tL:{JP:{iL:"7373KT"},vendor:{nL:"APA",rL:"Sprint"}}},os:{sL:{version:{eL:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",hL:["NT 5.1","NT 5.2"],oL:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],uL:"ARM"}}}},p={JN:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[n,h],[/(opios)[\/\s]+([\w\.]+)/i],[[n,"Opera Mini"],h],[/\s(opr)\/([\w\.]+)/i],[[n,"Opera"],h],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[n,h],[/(konqueror)\/([\w\.]+)/i],[[n,"Konqueror"],h],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[n,"IE"],h],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[n,"Edge"],h],[/(yabrowser)\/([\w\.]+)/i],[[n,"Yandex"],h],[/(puffin)\/([\w\.]+)/i],[[n,"Puffin"],h],[/(focus)\/([\w\.]+)/i],[[n,"Firefox Focus"],h],[/(opt)\/([\w\.]+)/i],[[n,"Opera Touch"],h],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[n,"UCBrowser"],h],[/(comodo_dragon)\/([\w\.]+)/i],[[n,/_/g," "],h],[/(windowswechat qbcore)\/([\w\.]+)/i],[[n,"WeChat(Win) Desktop"],h],[/(micromessenger)\/([\w\.]+)/i],[[n,"WeChat"],h],[/(brave)\/([\w\.]+)/i],[[n,"Brave"],h],[/(qqbrowserlite)\/([\w\.]+)/i],[n,h],[/(QQ)\/([\d\.]+)/i],[n,h],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[n,h],[/(BIDUBrowser)[\/\s]?([\w\.]+)/i],[n,h],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[n,h],[/(MetaSr)[\/\s]?([\w\.]+)/i],[n],[/(LBBROWSER)/i],[n],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[h,[n,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[h,[n,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[n,h],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[h,[n,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[n,/(.+)/,"$1 WebView"],h],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[n,/(.+(?:g|us))(.+)/,"$1 $2"],h],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[h,[n,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[n,"Sailfish Browser"],h],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[n,h],[/(dolfin)\/([\w\.]+)/i],[[n,"Dolphin"],h],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[n,"Chrome"],h],[/(coast)\/([\w\.]+)/i],[[n,"Opera Coast"],h],[/fxios\/([\w\.-]+)/i],[h,[n,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[h,[n,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[h,n],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[n,"GSA"],h],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[n,[h,E.str,w.JN.$P.version]],[/(webkit|khtml)\/([\w\.]+)/i],[n,h],[/(navigator|netscape)\/([\w\.-]+)/i],[[n,"Netscape"],h],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[n,h]],aL:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[o,"amd64"]],[/(ia32(?=;))/i],[[o,d.YP]],[/((?:i[346]|x)86)[;\)]/i],[[o,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[o,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[o,/ower/,"",d.YP]],[/(sun4\w)[;\)]/i],[[o,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[o,d.YP]]],XP:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[i,e,[r,f]],[/applecoremedia\/[\w\.]+ \((ipad)/],[i,[e,"Apple"],[r,f]],[/(apple\s{0,1}tv)/i],[[i,"Apple TV"],[e,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[e,i,[r,f]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[i,[e,"Amazon"],[r,f]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[i,E.str,w.XP.zP.JP],[e,"Amazon"],[r,a]],[/android.+aft([bms])\sbuild/i],[i,[e,"Amazon"],[r,l]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[i,e,[r,a]],[/\((ip[honed|\s\w*]+);/i],[i,[e,"Apple"],[r,a]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[e,i,[r,a]],[/\(bb10;\s(\w+)/i],[i,[e,"BlackBerry"],[r,a]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[i,[e,"Asus"],[r,f]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[e,"Sony"],[i,"Xperia Tablet"],[r,f]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[i,[e,"Sony"],[r,a]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[e,i,[r,u]],[/android.+;\s(shield)\sbuild/i],[i,[e,"Nvidia"],[r,u]],[/(playstation\s[34portablevi]+)/i],[i,[e,"Sony"],[r,u]],[/(sprint\s(\w+))/i],[[e,E.str,w.XP.tL.vendor],[i,E.str,w.XP.tL.JP],[r,a]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[e,[i,/_/g," "],[r,a]],[/(nexus\s9)/i],[i,[e,"HTC"],[r,f]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p)/i],[i,[e,"Huawei"],[r,a]],[/(microsoft);\s(lumia[\s\w]+)/i],[e,i,[r,a]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[i,[e,"Microsoft"],[r,u]],[/(kin\.[onetw]{3})/i],[[i,/\./g," "],[e,"Microsoft"],[r,a]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[i,[e,"Motorola"],[r,a]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[i,[e,"Motorola"],[r,f]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[e,d.trim],[i,d.trim],[r,l]],[/hbbtv.+maple;(\d+)/i],[[i,/^/,"SmartTV"],[e,"Samsung"],[r,l]],[/\(dtv[\);].+(aquos)/i],[i,[e,"Sharp"],[r,l]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[e,"Samsung"],i,[r,f]],[/smart-tv.+(samsung)/i],[e,[r,l],i],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[e,"Samsung"],i,[r,a]],[/sie-(\w*)/i],[i,[e,"Siemens"],[r,a]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[e,"Nokia"],i,[r,a]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[i,[e,"Acer"],[r,f]],[/android.+([vl]k\-?\d{3})\s+build/i],[i,[e,"LG"],[r,f]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[e,"LG"],i,[r,f]],[/(lg) netcast\.tv/i],[e,i,[r,l]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[i,[e,"LG"],[r,a]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[e,i,[r,f]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[i,[e,"Lenovo"],[r,f]],[/(lenovo)[_\s-]?([\w-]+)/i],[e,i,[r,a]],[/linux;.+((jolla));/i],[e,i,[r,a]],[/((pebble))app\/[\d\.]+\s/i],[e,i,[r,v]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[e,i,[r,a]],[/crkey/i],[[i,"Chromecast"],[e,"Google"]],[/android.+;\s(glass)\s\d/i],[i,[e,"Google"],[r,v]],[/android.+;\s(pixel c)[\s)]/i],[i,[e,"Google"],[r,f]],[/android.+;\s(pixel( [23])?( xl)?)[\s)]/i],[i,[e,"Google"],[r,a]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[i,/_/g," "],[e,"Xiaomi"],[r,a]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[i,/_/g," "],[e,"Xiaomi"],[r,f]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[i,[e,"Meizu"],[r,a]],[/(mz)-([\w-]{2,})/i],[[e,"Meizu"],i,[r,a]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})\s+build/i],[i,[e,"OnePlus"],[r,a]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[i,[e,"RCA"],[r,f]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[i,[e,"Dell"],[r,f]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[i,[e,"Verizon"],[r,f]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[e,"Barnes & Noble"],i,[r,f]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[i,[e,"NuVision"],[r,f]],[/android.+;\s(k88)\sbuild/i],[i,[e,"ZTE"],[r,f]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[i,[e,"Swiss"],[r,a]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[i,[e,"Swiss"],[r,f]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[i,[e,"Zeki"],[r,f]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[e,"Dragon Touch"],i,[r,f]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[i,[e,"Insignia"],[r,f]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[i,[e,"NextBook"],[r,f]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[e,"Voice"],i,[r,a]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[e,"LvTel"],i,[r,a]],[/android.+;\s(PH-1)\s/i],[i,[e,"Essential"],[r,a]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[i,[e,"Envizen"],[r,f]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[e,i,[r,f]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[i,[e,"MachSpeed"],[r,f]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[e,i,[r,f]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[i,[e,"Rotor"],[r,f]],[/android.+(KS(.+))\s+build/i],[i,[e,"Amazon"],[r,f]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[e,i,[r,f]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[r,d.YP],e,i],[/[\s\/\(](smart-?tv)[;\)]/i],[[r,l]],[/(android[\w\.\s\-]{0,9});.+build/i],[i,[e,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[h,[n,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)/i],[[n,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[n,h],[/rv\:([\w\.]{1,9}).+(gecko)/i],[h,n]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[n,h],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[n,[h,E.str,w.os.sL.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[n,"Windows"],[h,E.str,w.os.sL.version]],[/\((bb)(10);/i],[[n,"BlackBerry"],h],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[n,h],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[n,"Symbian"],h],[/\((series40);/i],[n],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[n,"Firefox OS"],h],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[n,h],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[n,"Chromium OS"],h],[/(sunos)\s?([\w\.\d]*)/i],[[n,"Solaris"],h],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[n,h],[/(haiku)\s(\w+)/i],[n,h],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[h,/_/g,"."],[n,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[n,"Mac OS"],[h,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[n,h]]},g=function(t,i){if("object"==typeof t&&(i=t,t=c),!(this instanceof g))return new g(t,i).fL();var n=t||(s&&s.navigator&&s.navigator.userAgent?s.navigator.userAgent:""),r=i?d.extend(p,i):p;return this.cL=function(){var t={name:c,version:c};return E.WP.call(t,n,r.JN),t.KP=d.KP(t.version),t},this.lL=function(){var t={vL:c};return E.WP.call(t,n,r.aL),t},this.dL=function(){var t={vendor:c,JP:c,type:c};return E.WP.call(t,n,r.XP),t},this.EL=function(){var t={name:c,version:c};return E.WP.call(t,n,r.engine),t},this._S=function(){var t={name:c,version:c};return E.WP.call(t,n,r.os),t},this.fL=function(){return{sg:this.wL(),JN:this.cL(),engine:this.EL(),os:this._S(),XP:this.dL(),aL:this.lL()}},this.wL=function(){return n},this.mS=function(t){return n=t,this},this};g.VERSION="0.7.20",g.pL={gL:n,bL:"major",VERSION:h},g.yL={TL:o},g.OL={mL:i,VENDOR:e,_L:r,RL:u,SL:a,AL:l,IL:f,NL:v,CL:"embedded"},g.kL={gL:n,VERSION:h},g.DL={gL:n,VERSION:h},typeof O!=t?(typeof T!=t&&T.exports&&(O=T.exports=g),O.OS=g):(_=function(){return g}.call(O,m,O,T))===c||(T.exports=_);var b=s&&(s.jQuery||s.jL);if(typeof b!=t&&!b.sg){var y=new g();b.sg=y.fL(),b.sg.get=function(){return y.wL()},b.sg.set=function(t){y.mS(t);var i=y.fL();for(var n in i)b.sg[n]=i[n]}}}("object"==typeof window?window:this)},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(78),o=n(0),u=(e=h["default"],s(a,e),a);function a(){return e.call(this,"STATS",o.Framework.v.rk)||this}i["default"]=new u()},function(t,i,n){"use strict";var s=this&&this.ML||function(){return(s=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var s in i=arguments[n])Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s]);return t}).apply(this,arguments)};Object.defineProperty(i,"s",{value:!0});var r=n(55),e=n(21),h=n(23),o=(u.pR=function(t,i,n){var r=new u();return r.partnerId=t,r.customerId=i,r.contentId=n,r},u.OR=function(t){var i=new u(t),n=e(t),r=n.path().split("/").slice(3);return i.partnerId=r[0],i.customerId=r[1],i.contentId=r[2],i.PL=r[3],i.searchParams=s({},i.searchParams,n.query(!0)),i},u.prototype.LL=function(t){this.contentId=t.ContentId,this.partnerId=t.SiteId,this.customerId=t.CROId,this.HL=t.Signature,this.UL=t.SourceURL,this.searchParams=s({},this.searchParams,t.SourceURLParams)},u.prototype.TR=function(t,i,n){this.partnerId=t,this.customerId=i,this.contentId=n},u.prototype.FL=function(){var t=this.contentId+this.partnerId+this.customerId+this.UL,i=new h.r_();i.Wb("b6614c3e4cd1d14eed6b39ef2bf6b9a3e3d6dfcd26699d7270d887923bcbf83efb3dadb717c0bafb1d48dce361eb369b7cc46e57405ebfbdd86c3175532fe56cc77f473d345b2cb6feafb5ab0e24f364a3d259f27e4a2fd97468265bddfd3ddd3ac64251db650ca0280af2b2c45e8b1c8f040f2c433ac0a157d2b3fd91517253","010001");var n=h.s_(this.HL);return i.$m(t,n)},u.prototype.mR=function(){return this.partnerId},u.prototype._R=function(){return this.customerId},u.prototype.RR=function(){return this.contentId},u.prototype.GL=function(){return this.PL},u.prototype.QS=function(){return this.ticketUrl},u.prototype.xL=function(){return this.UL},u.prototype.BL=function(t){this.UL=t},u.prototype.VL=function(){return this.qL||(this.qL=this.UL?e(this.UL).query(this.searchParams).valueOf():null),this.qL},u.prototype.gR=function(t){this.qL=t},u.prototype.QL=function(){return this.searchParams},u.prototype.CS=function(){return"["+this.partnerId+"/"+this.customerId+"/"+this.contentId+"]"},u.prototype.YL=function(){return[this.partnerId,this.customerId,this.contentId]},u.prototype.KL=function(){return this.UL+"-["+this.partnerId+"/"+this.customerId+"/"+this.contentId+"]"},u.prototype.toString=function(){return this.CS()},u);function u(t){this.testId=null,this.originalManifest=null,this.ticketUrl=t,this.sessionId=r.CR(),this.ticketUrl&&(this.WL=-1<t.indexOf("api-test"))}i.Ticket=o},function(t,i,n){"use strict";var r;Object.defineProperty(i,"s",{value:!0}),(r=i.$L||(i.$L={}))[r.XL=0]="CREATED",r[r.zL=1]="STARTED",r[r.JL=2]="SUCCEEDED",r[r.ZL=3]="ABORTED",r[r.tH=4]="FAILED"},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(t,i,n,r,s,e){this.id=t,this.qualityLevel=i,this.duration=n,this.url=r,this.eA=s,this.hA=e}i.iH=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(34),s=n(31),h=n(0),a=n(183),e=n(7),u=n(24),f=n(54),o=n(5),d=n(2),E=n(1),c=n(48),l=n(187),v=(w.prototype.nH=function(t,i){try{var n=0,r=0;if(this.rH.length<i)return!0;for(var s=this.rH.keys().reverse(),e=s[0],h=this.rH.get(e).getQualityLevel(),o=s.slice(1),u=0;u<o.length;u++){var a=o[u],f=this.rH.get(a),c=f.sH,l=f.getQualityLevel(),v=Math.abs(c-e);if(l.id!==h.id)return!1;if(v<t){if(++r>=i)return!1}else{if(++n>i)return!0;r=Math.max(0,r-1),e=c,h=l}}return!1}catch(t){return E.ErrorMonitor.getInstance().logError("Error calculating if the player is in buffering mode",this.eH,d.dr.Er,t),!1}},w.prototype.hH=function(t,i){if(this.oH(i)){var n=this.wM();if(n){var r=t.getQualityLevel(),s=n.getQualityLevel();0<r.Ob(s)?this.aH.uH(!0):r.Ob(s)<0&&this.aH.uH(!1)}else this.aH.uH(!0);if(this.rH.length>o.xu.Cu.Co){var e=this.rH.keys()[0];this.rH["delete"](e)}this.rH.set(h.Framework.time(),t)}return this.fH(t,i)},w.prototype.fH=function(t,i){var n=new a.cH();try{if(this.lH.lM(t.getQualityLevel())){if(this.dH.vH(t.I_())){n.EH=!0;var r=this.dH.wH(t.I_());this.pH(i,r,n)}if(this.dH.gH(t.I_()))for(var s=this.dH.bH(t.I_()),e=0,h=s;e<h.length;e++){var o=h[e];this.pH(i,o.R_(),n),n.yH=!0}}else{var u=f.Jj.Z_;this.tv.zM()&&(u=f.Jj.Zj),this.lH.TM(t.getQualityLevel(),u,u)}return n}catch(t){return E.ErrorMonitor.getInstance().logError("Error configuring the request directive",this.eH,d.dr.wr,t),new a.cH()}},w.prototype.pH=function(t,i,n){t!=u.h_.a_&&t!=u.h_.l_||i!=u.h_.o_&&i!=u.h_.l_&&i!=u.h_.a_||(n.TH=!0)},w.prototype.oH=function(t){return t!=u.h_.l_&&t!=u.h_.a_},w.prototype.OH=function(t,i,n){var r=[];try{for(var s=this.dH.bH(i.I_()),e=0,h=s;e<h.length;e++){var o=h[e];o.R_()!=u.h_.o_&&(this.lH.gP(o,t),r.push(o.bP))}return r}catch(t){return E.ErrorMonitor.getInstance().logError("Error attempting to upgrade prefetch",this.eH,d.dr.pr,t),[]}},w.prototype.mH=function(t){this.dH.mH(t)},w.prototype._H=function(t,i){this.dH._H(t,i)},w.prototype.RH=function(t){this.dH.RH(t)},w.prototype.SH=function(t){this.dH.AH(t)},w.prototype.IH=function(t){this.dH.NH()||this.lH.IM(t)},w.prototype.wM=function(){var t=this.rH.keys();return 0<t.length?this.rH.get(t[t.length-1]):null},w.prototype.CH=function(){var t=this.rH.keys();if(0<t.length)return t[t.length-1]},w.prototype.kH=function(t){var i=c.QualityLevel.from(t.qualityLevel);this.IH(i)},w.prototype.DH=function(t){switch(t.S_()){case e.xa.Ba:this.jH(t);break;case e.xa.Va:this._H(t.I_(),t.N_()),this.jH(t)}},w.prototype.jH=function(t){var i=this.metadata.MH(t.k_());i&&this.PH.add(i,t.x_())},w.prototype.wP=function(){return this.ticket},w.prototype.LH=function(){return this.lH},w.prototype.HH=function(){return this.metadata.HH()},w.prototype.UH=function(){return this.FH},w.prototype.GH=function(){return this.xH},w.prototype.getMetadata=function(){return this.metadata},w.prototype.getStreamProtocol=function(){return this.metadata.getStreamProtocol()},w.prototype.S_=function(t){return this.metadata.S_(t)},w.prototype.M_=function(t){var i=this.S_(t);if(i==e.xa.Va||i==e.xa.Ba)return!0},w.prototype.CM=function(t,i,n){var r=this.metadata.BH(t,i);return null!=r?new s.dA(r.eA,n,!0,t,r.duration,i,!0,this.getContextId()):null},w.prototype.KM=function(i){try{var t=i.D_(),n=this.metadata.VH(t);return null!=n?this.V_(n.eA):null}catch(t){return E.ErrorMonitor.getInstance().logError("Error getting the next entity",this.eH,d.dr.kn,{detailedError:t,url:i.D_()}),null}},w.prototype.qH=function(t){this.metadata.qH(t)},w.prototype.yM=function(){return this.metadata.yM()},w.prototype.QH=function(){return this.YH},w);function w(t,i){this.eH="[VideoContext] ",this.rH=new r(),this.logger=h.Framework.resolve(h.Framework.v.p).log(i.sessionId),this.PH=i.reportingInstance.Vl.PH,this.ticket=t,this.UL=t.VL(),this.tv=i.tv,this.aH=i.KH,this.dH=i.dH,this.lH=i.WH,this.lH.fM(this,this),this.YH=new l.$H()}i.XH=v},function(t,i,n){"use strict";t.exports=h;n(10);var s=n(184),r=n(41),e=n(12);function h(t,i,n,r){if(!(this instanceof h))return new h(t,i,n,r);s.call(this,t,i,n,r)}((h.SortedArraySet=h).prototype=Object.create(s.prototype)).constructor=h,Object.hiveAddEach(h.prototype,r.prototype),Object.hiveAddEach(h.prototype,e.prototype),h.prototype.zH=!0,h.prototype.hiveAdd=function(t){return!this.has(t)&&(s.prototype.hiveAdd.call(this,t),!0)},h.prototype.reduce=function(r,t){var s=this,e=arguments[2];return this.array.reduce(function(t,i,n){return r.call(e,t,i,n,s)},t)},h.prototype.reduceRight=function(r,t){var s=this,e=arguments[2];return this.array.reduceRight(function(t,i,n){return r.call(e,t,i,n,s)},t)}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.JH=function(t,i){var n=t.tU.ZH(!1),r=i.tU.ZH(!1);return r<n?1:n<r?0:-1},s);function s(){}i.iU=r;var e=(h.JH=function(t,i){var n=t.nU.ZH(!1),r=i.nU.ZH(!1);return r<n?1:n<r?0:-1},h);function h(){}i.rU=e},function(t,i){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);t.exports=function(){return n(r),r}}else{var s=new Array(16);t.exports=function(){for(var t,i=0;i<16;i++)0==(3&i)&&(t=4294967296*Math.random()),s[i]=t>>>((3&i)<<3)&255;return s}}},function(t,i){for(var s=[],n=0;n<256;++n)s[n]=(n+256).toString(16).substr(1);t.exports=function(t,i){var n=i||0,r=s;return[r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]]].join("")}},function(t,i,n){"use strict";n(71);var r=n(11),e=n(72),s=n(39);t.exports=Array;var u=Array.prototype.splice,a=Array.prototype.slice;function h(t,i){Array.prototype[t]||Object.defineProperty(Array.prototype,t,{value:i,writable:!0,configurable:!0,enumerable:!1})}function o(t,i,n){this.array=t,this.start=null==i?0:i,this.end=n}Array.empty=[],Object.freeze&&Object.freeze(Array.empty),Array.from=Array.from||function(t){var i=[];return i.hiveAddEach(t),i},Array.If=function(t){for(var i=[],n=1/0,r=0;r<t.length;r++){var s=t[r];t[r]=s.toArray(),s.length<n&&(n=s.length)}for(r=0;r<t.length;r++){s=t[r];for(var e=0;e<s.length;e++)e<n&&e in s&&(i[e]=i[e]||[],i[e][r]=s[e])}return i},h("hiveAddEach",r.prototype.hiveAddEach),h("deleteEach",r.prototype.Of),h("toArray",r.prototype.toArray),h("toObject",r.prototype.mf),h("all",r.prototype.all),h("any",r.prototype.Th),h("min",r.prototype.min),h("max",r.prototype.max),h("sum",r.prototype.Ju),h("average",r.prototype.Rf),h("only",r.prototype.only),h("flatten",r.prototype.Sf),h("zip",r.prototype.Af),h("enumerate",r.prototype.enumerate),h("group",r.prototype.group),h("sorted",r.prototype.Nf),h("reversed",r.prototype.reversed),h("constructClone",function(t){var i=new this.constructor();return i.hiveAddEach(t),i}),h("has",function(t,i){return-1!==this.find(t,i)}),h("set",function(t,i){return this[t]=i,!0}),h("hiveAdd",function(t){return this.push(t),!0}),h("delete",function(t,i){var n=this.find(t,i);return-1!==n&&(this.splice(n,1),!0)}),h("deleteAll",function(t,i){i=i||this.Re||Object.equals;for(var n=0,r=0;r<this.length;)i(t,this[r])?(this.MP(r,1),n++):r++;return n}),h("find",function(t,i){i=i||this.Re||Object.equals;for(var n=0;n<this.length;n++)if(n in this&&i(t,this[n]))return n;return-1}),h("findLast",function(t,i){i=i||this.Re||Object.equals;var n=this.length;do if(--n in this&&i(this[n],t))return n;while(0<n);return-1}),h("swap",function(t,i,n){var r,s,e,h,o;if(t>this.length&&(this.length=t),void 0===n)return void 0!==i?u.call(this,t,i):void 0!==t?u.call(this,t):[];if(r=[t,i],Array.isArray(n)||(n=a.call(n)),e=0,(s=n.length)<1e3){for(;e<s;e++)r[e+2]=n[e];return u.apply(this,r)}for(o=u.apply(this,r);e<s;){for(r=[t+e,0],h=2;h<1002&&e<s;h++,e++)r[h]=n[e];u.apply(this,r)}return o}),h("peek",function(){return this[0]}),h("poke",function(t){0<this.length&&(this[0]=t)}),h("peekBack",function(){if(0<this.length)return this[this.length-1]}),h("pokeBack",function(t){0<this.length&&(this[this.length-1]=t)}),h("one",function(){for(var t in this)if(Object.aC(this,t))return this[t]}),Array.prototype.clear||h("clear",function(){return this.length=0,this}),h("compare",function(t,i){var n,r,s;if(i=i||Object.compare,this===t)return 0;if(!t||!Array.isArray(t))return e.prototype.compare.call(this,t,i);for(r=Math.min(this.length,t.length),n=0;n<r;n++)if(n in this){if(!(n in t))return-1;if(s=i(this[n],t[n]))return s}else if(n in t)return 1;return this.length-t.length}),h("equals",function(t,i){i=i||Object.equals;var n=0,r=this.length;if(this===t)return!0;if(!t||!Array.isArray(t))return e.prototype.equals.call(this,t);if(r!==t.length)return!1;for(;n<r;++n)if(n in this){if(!(n in t))return!1;if(!i(this[n],t[n]))return!1}else if(n in t)return!1;return!0}),h("clone",function(t,i){if(null==t)t=1/0;else if(0===t)return this;if((i=i||new s()).has(this))return i.get(this);var n=new Array(this.length);for(var r in i.set(this,n),this)n[r]=Object.clone(this[r],t-1,i);return n}),h("iterate",function(t,i){return new o(this,t,i)}),h("Iterator",o),o.prototype.PP=null,Object.defineProperty(o.prototype,"LP",{get:function(){return this.PP||(this.PP={done:!1,value:null})}}),o.prototype.next=function(){return this.start===(null==this.end?this.array.length:this.end)?(this.LP.done=!0,this.LP.value=void 0):this.LP.value=this.array[this.start++],this.LP}},function(t,i){t.exports=Function,Function._e=function(){},Function.identity=function(t){return t},Function.Cf=function(n,r){r=r||Object.compare,n=n||Function.identity;function t(t,i){return r(n(t),n(i))}return t.compare=r,t.Cf=n,t},Function.get=function(i){return function(t){return Object.get(t,i)}}},function(t,i,n){var e=n(38);function r(){throw new Error("Can't construct. GenericOrder is a mixin.")}(t.exports=r).prototype.equals=function(t,i){if(i=i||this.Re||e.equals,this===t)return!0;return!t?!1:this.length===t.length&&this.Af(t).every(function(t){return i(t[0],t[1])})},r.prototype.compare=function(t,r){if(r=r||this._f||e.compare,this===t)return 0;if(!t)return 1;var s=Math.min(this.length,t.length),i=this.Af(t).reduce(function(t,i,n){return 0===t?s<=n?t:r(i[0],i[1]):t},0);return 0===i?this.length-t.length:i},r.prototype.toJSON=function(){return this.toArray()}},function(t,i,n){"use strict";n(10);var r=n(57),s=n(121),e=n(11),h=n(41),o=n(12),u=n(40),a=n(122);function f(t,n,i,r){if(!(this instanceof f))return new f(t,n,i,r);n=n||Object.equals,i=i||Object.hash,r=r||Function._e,this.Re=n,this.Se=i,this.Ae=r,this.order=new this.sU(void 0,n),this.store=new this.eU(void 0,function(t,i){return n(t.value,i.value)},function(t){return i(t.value)}),this.length=0,this.hiveAddEach(t)}(t.exports=f).Set=f,Object.hiveAddEach(f.prototype,e.prototype),Object.hiveAddEach(f.prototype,h.prototype),Object.hiveAddEach(f.prototype,o.prototype),Object.hiveAddEach(f.prototype,u.prototype),Object.defineProperty(f.prototype,"size",e.Ie),f.prototype.sU=r,f.prototype.eU=s,f.prototype.Ne=function(t){return new this.constructor(t,this.Re,this.Se,this.Ae)},f.prototype.has=function(t){var i=new this.order.Node(t);return this.store.has(i)},f.prototype.get=function(t,i){if(i)throw new Error("Set#get does not support second argument: equals");var n=new this.order.Node(t);return(n=this.store.get(n))?n.value:this.Ae(t)},f.prototype.hiveAdd=function(t){var i=new this.order.Node(t);if(this.store.has(i))return!1;var n=this.length;return this.yC&&this.RC([t],[],n),this.order.hiveAdd(t),i=this.order.head.RP,this.store.hiveAdd(i),this.length++,this.yC&&this.OC([t],[],n),!0},f.prototype["delete"]=function(t,i){if(i)throw new Error("Set#delete does not support second argument: equals");var n=new this.order.Node(t);return!!this.store.has(n)&&(n=this.store.get(n),this.yC&&this.RC([],[t],n.index),this.store["delete"](n),this.order.splice(n,1),this.length--,this.yC&&this.OC([],[t],n.index),!0)},f.prototype.pop=function(){if(this.length){var t=this.order.head.RP.value;return this["delete"](t),t}},f.prototype.shift=function(){if(this.length){var t=this.order.head.next.value;return this["delete"](t),t}},f.prototype.kf=function(){if(0<this.length)return this.store.kf().value},f.prototype.clear=function(){var t;this.yC&&(t=this.toArray(),this.RC([],t,0)),this.store.clear(),this.order.clear(),this.length=0,this.yC&&this.OC([],t,0)},f.prototype.reduce=function(n,t){var r=arguments[2],i=this.order,s=0;return i.reduce(function(t,i){return n.call(r,t,i,s++,this)},t,this)},f.prototype.reduceRight=function(n,t){var r=arguments[2],i=this.order,s=this.length-1;return i.reduceRight(function(t,i){return n.call(r,t,i,s--,this)},t,this)},f.prototype.Df=function(){return this.order.Df()},f.prototype.values=function(){return new a(this)},f.prototype.log=function(){var t=this.store;return t.log.apply(t,arguments)},f.prototype.qf=function(){this.order.qf()}},function(t,i,n){"use strict";function r(){}(t.exports=r).hU={IC:"+",oU:"-",uU:"+",aU:"+",fU:".",cU:"'",lU:"+",vU:"|"},r.dU={IC:"\u254b",oU:"\u2501",uU:"\u253b",aU:"\u2533",fU:"\u256d",cU:"\u2570",lU:"\u2523",vU:"\u2503"},r.EU={IC:"\u254b",oU:"\u2501",uU:"\u253b",aU:"\u2533",fU:"\u250f",cU:"\u2517",lU:"\u2523",vU:"\u2503"}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.getItem=function(t){try{return window.sessionStorage?window.sessionStorage.getItem(t):null}catch(t){return null}},s.setItem=function(t,i){try{return!!window.sessionStorage&&(window.sessionStorage.setItem(t,i),!0)}catch(t){return!1}},s.removeItem=function(t){try{window.sessionStorage&&window.sessionStorage.removeItem(t)}catch(t){return null}},s);function s(){}i.SessionStorageUtil=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(13),s=(e.getPrivateIp=function(t){var i=t.getPrivateIp();return r.HiveConfig.SensitiveInfo.restrictedConnectivityInfo&&i&&(i=i.replace(/[0-9]*$/,"0")),i},e.getHostname=function(t){return r.HiveConfig.SensitiveInfo.restrictedConnectivityInfo?r.HiveConfig.SensitiveInfo.hiddenHostnameValue:t.getHostName()},e);function e(){}i.SensitiveInfoUtils=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){}i.NS=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=n(8),e=(h.prototype.getInstance=function(){return r.Framework.resolve(this.tag)},h.prototype.getName=function(){return this.name},h.prototype.getVersion=function(){return this.version},h.prototype.cv=function(){return o.wU(this)},h);function h(t,i){this.version=s.Y.Wa,this.name=t,this.tag=i}i["default"]=e;var o=(u.wU=function(t){return new u(t.getName(),t.getVersion())},u);function u(t,i){this.name=t,this.version=i}i.pU=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var f=n(76),r=n(3),h=n(22);n(137),n(138);var c=n(0),s=n(14),o=n(16),u=n(19),e=n(13),a=n(1),l=n(15),v="[SNAP] ",d=function(){this.metrics=new hive.snapshots.Metrics(),this.gU=new hive.snapshots.Traffic(),this.bU=new r(),this.yU=new r(),this.TU=new r(),this.OU=new r(),this.player=new hive.snapshots.Player()};i.mU=d;var E=(w.prototype.init=function(t,i,n,r){this.logger=c.Framework.resolve(c.Framework.v.p).log(r),this.kS=c.Framework.resolve(c.Framework.v.jR),this._U=c.Framework.resolve(c.Framework.v.fk),this.PH=c.Framework.resolve(c.Framework.v.HC),this.logger.debug(v+"INIT STATS STORE - ID: "+t),this.uS=t,this.ticket=i,this.xl(n)},w.prototype.RU=function(t){this.testId=t},w.prototype.SU=function(t){this.AU=t},w.prototype.IU=function(t){this.NU=t},w.prototype.CU=function(t){this.kU=t},w.prototype.xl=function(t){this.Bl=t},w.prototype.DU=function(t){this.tv=t},w.prototype.jU=function(){this.Ul=new d(),this.uS=null,this.ticket=null,this.reset()},w.prototype.reset=function(){this.MU=new d(),this.PU(this.MU.gU),this.LU(this.MU),this.responseInfo.source=[]},w.prototype.PU=function(t){t.reqN=0,t.respFallbackN=0,t.respFallbackErrN=0,t.respP2pN=0,t.reqOtherN=0,t.respFallbackOtherN=0,t.respFallbackOthertErrN=0,t.srcReqN=0,t.srcRespN=0,t.srcRespErrN=0,t.srcReqQt=0,t.srcRespQt=0,t.srcOverQt=0,t.srcOtherReqN=0,t.srcOtherRespN=0,t.srcOtherRespErrN=0,t.srcOtherReqQt=0,t.srcOtherRespQt=0,t.srcOtherOverQt=0,t.p2pSubReqN=0,t.p2pSubRespN=0,t.p2pSubRespPartN=0,t.p2pSubRespErrN=0,t.p2pSubRespExpN=0,t.p2pSubReqQt=0,t.p2pSubRespQt=0,t.p2pDirectQt=0,t.p2pRelayQt=0,t.p2pNatQt=0,t.p2pUdpbQt=0,t.fallAgentRespN=0,t.fallAgentPredHitN=0,t.fallAgentFailedRespN=0,t.fallAgenTrafficSuccessQt=0,t.p2pAgentPredHitN=0,t.p2pAgentPredMissN=0,t.p2pAgentPredPartialHitN=0,t.p2pAgenTrafficSuccessQt=0,t.p2pAgenTrafficFailureQt=0},w.prototype.LU=function(t){t.metrics.videoBufN=0,t.metrics.videoBufQt=0,t.metrics.clientBufferMs=0,t.metrics.lookupNotFound=0,t.metrics.lookupTotal=0,t.metrics.lookupLatency=0,t.metrics.lookupReqAccept=0,t.metrics.lookupReqEstablished=0,t.metrics.lookupFailed=0,t.player.bufferingN=0,t.player.bufferingMs=0,t.player.playingTimeMs=0},w.prototype.jf=function(t){var n=this;void 0===t&&(t=!0);var r=new hive.snapshots.MetricSnapshot();r.timestamp=c.Framework.time(),r.guid=this.uS,r.sessionId=this.ticket.sessionId,r.eventId=new EventId(),r.eventId.partnerId=this.ticket.mR(),r.eventId.customerId=this.ticket._R(),r.eventId.contentId=this.ticket.RR();try{var i=new hive.snapshots.ClientInfo();i.clientType=this.HU();var s=this.Bl.version.split(".");if(i.majorVersion=parseInt(s[0]),i.minorVersion=parseInt(s[1]),i.patchVersion=parseInt(s[2]),r.client=i,null!=this.testId){var e=new TestInfo();e.testId=this.testId,r.testInfo=e}}catch(t){this.logger.warn(v+"error setting Snapshot ClientInfo",t)}if(this.tv){var h=new hive.snapshots.AgentInfo();h.firstTierBitrates=this.tv.UU().map(function(t){return t.bitrate}),h.secondTierBitrates=this.tv.FU().map(function(t){return t.bitrate}),r.agentInfo=h}r.streamInfo=this._U.GU(),r.fragments=this.PH.GU(),r.traffic=[];var o=new hive.snapshots.TrafficKey();if(r.traffic.push({key:o,value:this.MU.gU}),this.MU.bU.forEach(function(t,i){var n=new hive.snapshots.TrafficKey();n.qualityLevelId=i,r.traffic.push({key:n,value:t})}),r.metrics=this.MU.metrics,this.AU&&(r.metrics.clientBufferMs=this.AU.min()),this.NU&&(r.metrics.trackerLatency=this.NU.min()),this.kU&&(r.metrics.sourceLatency=this.kU.min()),r.player=this.MU.player,0<this.responseInfo.source.length&&(r.responseInfo=this.responseInfo),this.xU){var u=this.xU.BU();this.MU.metrics.prtOutN=u.VU+u.qU,this.MU.metrics.prtInN=u.QU+u.YU;var a=this.xU.KU();a.forEach(function(t,i){n.WU(i,t,r)}),this.MU.OU.filter(function(t,i){return!a.has(i)}).forEach(function(t,i){n.WU(i,t,r)})}return r.connInfo=new hive.snapshots.ConnectivityInfo(),t?this.kS.getConnectivityInfo().then(function(t){return r.connInfo.privateIp=f.SensitiveInfoUtils.getPrivateIp(t.getNetworkChanged()),n.$U(n.XU(r))}).fail(function(t){return n.$U(n.XU(r))}):(r.connInfo.privateIp=f.SensitiveInfoUtils.getPrivateIp(this.kS.jS().getNetworkChanged()),this.$U(r))},w.prototype.XU=function(t){return t.connInfo.internalAs=this.zU,t.connInfo.externalAs=this.JU,t.connInfo.publicIp=this.ZU,t},w.prototype.$U=function(t,i){void 0===i&&(i=[]);var n=l.Sc(t,"snapshot");return n.length&&a.ErrorMonitor.getInstance().logError("NaN found in MetricSnapshot",v,{keysWithNaN:n,snapshot:t}),i.length=0,i.push.apply(i,n),t},w.prototype.HU=function(){var t;switch(this.Bl.name){case"JS":t=ClientType.tF;break;case"PROXY":t=ClientType.iF;break;default:t=ClientType.nF}return t},w.prototype.WU=function(t,i,n){var r=this.MU.yU.get(t);i.traffic=r,n.partners||(n.partners=[]);var s=new hive.snapshots.PartnerKey();s.partnerGuid=t,n.partners.push({key:s,value:i})},w.prototype.rF=function(t,i){0<t&&(this.MU.metrics.videoBufN++,this.MU.metrics.videoBufQt+=t,this.MU.player.bufferingN++,this.MU.player.bufferingMs+=t),this.MU.player.playerBufferMs=i},w.prototype.sF=function(t){0<t&&(this.MU.player.playingTimeMs+=t,this.Ul.player.playingTimeMs+=t)},w.prototype.eF=function(){return this.MU.gU},w.prototype.hF=function(){return this.Ul.gU},w.prototype.oF=function(t){return this.Ul.bU.has(t.id)||this.Ul.bU.set(t.id,new hive.snapshots.Traffic()),this.Ul.bU.get(t.id)},w.prototype.uF=function(t){if(!this.MU.bU.has(t.id)){var i=new hive.snapshots.Traffic();this.PU(i),this.MU.bU.set(t.id,i)}return this.MU.bU.get(t.id)},w.prototype.aF=function(){var t=new hive.snapshots.PartnerTraffic();return t.p2pSuccReq=0,t.p2pFailReq=0,t.p2pPartReq=0,t.p2pSuccReceived=0,t.p2pSuccReceivedLow=0,t.p2pFailReceived=0,t.p2pSuccResp=0,t.p2pFailResp=0,t.p2pPartResp=0,t.p2pSuccSent=0,t.p2pSuccSentLow=0,t.p2pFailSent=0,t},w.prototype.fF=function(t,i){return i.yU.has(t)||i.yU.set(t,this.aF()),i.yU.get(t)},w.prototype.cF=function(t){return this.fF(t,this.MU)},w.prototype.lF=function(t){return this.fF(t,this.Ul)},w.prototype.vF=function(t){this.kS=t},w.prototype.dF=function(t){this.xU=t},w.prototype.PS=function(t){},w.prototype.EF=function(i){var n=!1;this.responseInfo.source.forEach(function(t){t.statusCode==i&&(t.count++,n=!0)}),n||this.responseInfo.source.push(new hive.snapshots.ResponseInfo({statusCode:i,count:1}))},w);function w(){this.ticket=null,this.zU=0,this.JU=0,this.testId=null,this.responseInfo=new hive.snapshots.ServiceResponseInfo(),this.jU()}i.eU=E;var p=(g.prototype.init=function(t,i){this.logger=c.Framework.resolve(c.Framework.v.p).log(i),this.logger.debug(v+"INIT CLIENT STATS"),this.store=t,this.wF()},g.prototype.wF=function(){var t=this;-1<this.pF&&c.Framework.clearInterval(this.pF),this.pF=c.Framework.setInterval(function(){t.snapshot()},s.Rc.Ec)},g.prototype.onStateChange=function(t){this.state=t},g.prototype.gF=function(){if(this.store)return this.snapshot(!1)},g.prototype.reset=function(t){c.Framework.clearInterval(this.pF),this.store&&(!1===t?this.store.reset():this.store.jU())},g.prototype.snapshot=function(t){var i=this;void 0===t&&(t=!0);var n=this.store.jf(t);t?(this.logger.debug(v+"TAKING SNAPSHOT"),n.then(function(t){return i.forward(t)}).fail(function(t){i.logger.warn(v+"ERROR FORWARDING SNAPSHOT",t)})["finally"](function(){i.store.reset()})):(this.logger.debug(v+"FLUSHING SNAPSHOT"),this.forward(n))},g.prototype.forward=function(t){var i=this;if(this.state!==u.Il.IDLE&&this.state!==u.Il.STOP)if(!this.filter||this.filter.Hl()){if(this.client&&this.client.xS()){switch(this.bF){case 0:default:this.logger.debug(v+"SENDING SNAPSHOT");break;case 1:this.logger.debug(v+"SENDING SNAPSHOT "+JSON.stringify(t));break;case 2:this.logger.debug(v+"SENDING SNAPSHOT",t);break;case 3:this.logger.debug(v+"SENDING SNAPSHOT "+JSON.stringify(t),t)}this.protocol.na("SNAPSHOT",h.ra.ONEWAY,0),t.write(this.protocol),this.protocol.sa();var n=this.transport.ea(),r=this.ha(n,",",4),s=n.slice(r+1,n.length-1),e=new o.Lc(HiveStreamingServices.VS,1,s);this.client.xS().send(e).fail(function(t){i.logger.warn(v+"PROBLEM: ",t)})}}else this.logger.debug(v+"SKIPPING SNAPSHOT");else this.logger.debug(v+"not send - state "+u.Il[this.state])},g.prototype.ha=function(t,i,n){return t.split(i,n).join(i).length},g.prototype.$l=function(t){this.filter=t},g);function g(){this.bF=isNaN(e.HiveConfig.DebugLogs.MetricSnapshotLogs)?0:e.HiveConfig.DebugLogs.MetricSnapshotLogs,this.state=u.Il.Nl,this.client=c.Framework.resolve(c.Framework.v.jl),this.transport=new h.ca(),this.protocol=new h.la(this.transport)}i.Zl=p},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var h=n(4),o=n(21),u=n(139),e=n(0),a=n(14),f=n(16),c=n(8).Y["if"],l=(v.prototype.init=function(t,n){var r=this;if(this.yF)this.yF.then(function(){var t={partnerId:n.mR(),customerId:n._R(),contentId:n.RR(),secret:n.GL()},i=new f.Lc(HiveStreamingServices.TF,1,JSON.stringify(t));r.connection.send(i)});else{var i=h.defer(),s=a.Rc.oc;n.WL&&(c?s=a.Rc.ac:(this.logger.warn("[HiveComm] Error trying to resolve test ticket against production services - use production ticket or test plugin"),i.reject(new Error("test ticket in production"))));var e=new o(s).qd({"connection-id":t,partner_id:n.mR(),customer_id:n._R(),content_id:n.RR(),ticket:n.GL()}).toString();this.connection=new u.OF(e,a.Rc.bc,a.Rc.yc,a.Rc.Tc),this.connection.onconnect(function(){r.logger.debug("HIVE SERVICES CONNECTED"),i.resolve(r.connection)}),this.connection.onerror(function(){r.logger.warn("Hive Services Connection failed"),i.reject(r.connection)}),this.yF=i.promise}return{fv:this.connection,promise:this.yF}},v.prototype.connect=function(){this.connection&&this.connection.connect(!0)},v.prototype.AR=function(t){},v.prototype.xS=function(){return this.connection},v.prototype.close=function(){this.connection&&(this.yF=null,this.connection.close(!1))},v);function v(){this.logger=e.Framework.resolve(e.Framework.v.p).log(),this.logger.debug("INIT SERVICE CLIENT")}i.mF=l;var d,E=(s(w,d=l),w.prototype.init=function(t,i,n){var r=this;if(this.yF)return this.yF;var s=h.defer(),e=new o(n).qd({"connection-id":t}).toString();return this.logger.debug(this.loggerId+" Connecting to serviceEndpoint "+e),this.connection=new u.OF(e,a.Rc.bc,a.Rc.yc,a.Rc.Tc),this.connection.onconnect(function(){r.logger.debug("HIVE SERVICES CONNECTED"),s.resolve(r.connection)}),this.connection.on(HiveStreamingServices.TF,0,function(t){r.logger.debug("FAKED RESOLVING")}),this.connection.onerror(function(){r.logger.warn("Hive Services Connection failed"),s.reject(r.connection)}),this.yF=s.promise,this.yF},w);function w(){var t=null!==d&&d.apply(this,arguments)||this;return t.loggerId="[ServicesClientViaToken]",t}i._F=E},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0}),n(140);var s=n(4),r=n(3),e=n(0),h=n(62),o=n(141),u=(a.prototype.resolve=function(t,i){var n=this,r=s.defer();return t&&(t.on(HiveStreamingServices.TF,0,function(t){n.RF(t)}),t.on(HiveStreamingServices.TF,2,function(t){n.RF(t)}),this.SF.set(i,new o.AF(r))),r.promise},a.prototype.RF=function(t){var r=this,s=new Date().getTime(),e=JSON.parse(t.msg),h=!1;this.SF.forEach(function(t,i){if(r.IF(i,e)){h=!0;var n=r.verifyTicket(i,e);n?(n.bR=t.bR,n.yR=s,t.NF.resolve(n)):t.NF.reject("Ticket verification failed"),r.SF["delete"](n)}}),h||this.logger.warn("no pending ticket matching: "+t.msg)},a.prototype.ev=function(t){return new RegExp("^https?://api(?:-test)?.hivestreaming.com/v1/events/(?:wildcard/)?").test(t)?h.Ticket.OR(t):null},a.prototype.IF=function(t,i){return t.mR()===i.SiteId&&t._R()===i.CROId&&t.RR()===i.ContentId},a.prototype.verifyTicket=function(t,i){return t.LL(i),t.FL()?t:null},a);function a(){this.SF=new r(),this.logger=(e.Framework.resolve(e.Framework.v.p)||console).log(),this.logger.debug("INIT TICKET RESOLVER")}i.CF=u},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e=n(55),o=n(4),h=n(0),u=n(14),a=n(142),f=(c.prototype.kF=function(){var t=this,i=o.defer(),n=indexedDB.open(this.DF);return n.onupgradeneeded=function(){n.result.createObjectStore(t.jF,{keyPath:"id"})},n.onsuccess=function(){var t=n.result;i.resolve(t)},n.onerror=function(t){i.reject(t)},i.promise},c.prototype.sv=function(){var s=this;if(this.MF)return this.MF;var e=o.defer();if(this.uS)e.resolve(new a.PF(this.uS));else if(u.Rc.nf&&this.indexedDB){var h=setTimeout(function(){s.logger.warn("[HiveComm] timeout retrieving persistent ID - generating random one"),s.uS=s.LF(),s.logger.debug("[HiveComm] Generated UUID: "+s.uS),e.resolve(new a.PF(s.uS))},4e3);try{this.kF().then(function(n){var r=n.transaction(s.jF,"readwrite").objectStore(s.jF).get("MYID");r.onsuccess=function(){if(clearTimeout(h),s.uS)e.resolve(new a.PF(s.uS));else if(null!=r.result&&u.Rc.nf){var t=r.result.value;s.logger.debug("[HiveComm] Retrieved persistent UUID: "+t),s.uS=t,n.close(),e.resolve(new a.PF(s.uS))}else{var i=s.LF();s.HF(n,i),e.resolve(new a.PF(s.uS))}},r.onerror=function(t){clearTimeout(h),s.uS||(s.logger.warn("[HiveComm] error retrieving persistent UUID: "+t),s.uS=s.LF(),s.logger.debug("[HiveComm] Generated UUID: "+s.uS)),e.resolve(new a.PF(s.uS))}}).fail(function(t){clearTimeout(h),s.uS||(s.logger.warn("[HiveComm] error opening indexedDB - generating random id. Error: "+t),s.uS=s.LF(),s.logger.debug("[HiveComm] Generated UUID: "+s.uS)),e.resolve(new a.PF(s.uS))})}catch(t){this.uS=this.LF(),this.logger.debug("[HiveComm] Persistence error - Generate UUID: "+this.uS,t),e.resolve(new a.PF(this.uS))}}else this.uS=this.LF(),this.logger.debug("[HiveComm] Persistence disabled - Generate UUID: "+this.uS),e.resolve(new a.PF(this.uS));return this.MF=e.promise,this.MF},c.prototype.HF=function(t,i){var n=this,r=t.transaction(this.jF,"readwrite");r.objectStore(this.jF).put({id:"MYID",value:i}),r.oncomplete=function(){n.logger.debug("[HiveComm] completed UUID persistence"),t.close()},this.logger.debug("[HiveComm] Generated UUID: "+i),this.uS=i},c.prototype.LF=function(){return e.CR()},c);function c(){this.jF="IdentityStore",this.DF="IdentityDB",this.uS=null,this.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,h.Framework&&h.Framework.resolve(h.Framework.v.p)?this.logger=h.Framework.resolve(h.Framework.v.p).log():this.logger=console}i.UF=f;var l,v=(s(d,l=f),d.prototype.sv=function(){var s=this;if(this.FF)return this.FF;var e=o.defer();return l.prototype.sv.call(this).then(function(t){var i=s.LF(),n=t.av(),r=new a.PF(i,n);e.resolve(r)}).fail(function(t){var i=s.LF(),n=new a.PF(i);e.resolve(n)}),this.FF=e.promise,this.FF},d);function d(){return l.call(this)||this}i.GF=v},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.xF=function(t){this.hostname=t},s.prototype.getHostName=function(){return this.hostname},s.prototype.BF=function(t){this.nc=t},s.prototype.getNetworkChanged=function(){return this.nc},s);function s(){}i.VF=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),f=n(48),c=n(7),s=(e.prototype.add=function(t,i){var n,r=i.id,s=i.bitrate,e=i.width,h=i.height,o=i.label,u=new f.QualityLevel(r,s,e,h,o);switch(t){case c.xa.Va:n=this.qF;break;case c.xa.Ba:n=this.QF;break;default:return u}var a=n.find(function(t){return t.id===r});return a?((u=a).bitrate!==s&&(u.bitrate=s,u.Ck.push(s)),u.width!==e&&(u.width=e),u.height!==h&&(u.height=h),u.label!==o&&(u.label=o)):(n.push(u),this.YF(n)),u},e.prototype.get=function(i){return this.qF.find(function(t){return t.id===i})},e.prototype.getAll=function(t){switch(t){case c.xa.Va:return this.qF;case c.xa.Ba:return this.QF;default:return this.QF.concat(this.qF)}},e.prototype.KF=function(t){return this.getAll(t).reduce(function(t,i){return t.set(i.id,i.Ik),t},new r())},e.prototype.reset=function(){this.qF=[],this.QF=[]},e.prototype.YF=function(t){t.sort(function(t,i){return t.bitrate-i.bitrate}).forEach(function(t,i){return t.Ik=i})},e);function e(){this.qF=[],this.QF=[]}i.WF=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=hive.snapshots.QualityLevel,s=(e.prototype.$F=function(t){this.XF=t},e.prototype.GU=function(){if(!this.XF)return[];var t=this.XF.getAll(),i=t.map(function(t){var i=new r();return i.id=t.id,i.width=t.width||null,i.height=t.height||null,i.label=t.label||null,i.bitrates=t.Ck.filter(function(t){return null!=t}),i});return t.forEach(function(t){return t.Nk()}),i},e);function e(){}i.zF=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(6),s=(e.prototype.JF=function(t){this.watchingQualityLevel=t},e.prototype.ZF=function(){return this.watchingQualityLevel},e.prototype.tG=function(){return this.iG},e);function e(){this.iG=new r.ma()}i.nG=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=hive.snapshots.FragmentMetadata,s=n(7),e=(h.prototype.add=function(t,i){var n=new r();switch(n.url=t.eA,n.size=i,n.duration=t.duration,n.qualityLevelId=t.qualityLevel.id,t.hA){case s.xa.Ba:n.contentType=ContentType.Ba;break;case s.xa.Va:n.contentType=ContentType.Va;break;default:n.contentType=null}this.metrics.push(n)},h.prototype.GU=function(){var t=this.metrics;return this.metrics=[],t},h);function h(){this.metrics=[]}i.rG=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=(e.prototype.init=function(t,i){this.sG=t,this.eG=i},e.prototype.hG=function(t){this.eG=t},e.prototype.$F=function(t){this.oG.$F(t)},e.prototype.GU=function(){var t=this.sG,i=this.eG,n=new hive.snapshots.StreamInfo();return n.url=t.VL(),n.streamProtocol=i.getStreamProtocol(),n.streamType=i.UH()?StreamType.LIVE:StreamType.VOD,n.qualityLevels=this.oG.GU(),n},e);function e(){this.oG=r.Framework.resolve(r.Framework.v.bk)}i.uG=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=n(0),e=n(143),h=n(1),o=(u.prototype.aG=function(){var t=new e.fG();this.cG.BF(t)},u.prototype.jS=function(){return this.cG},u.prototype.getConnectivityInfo=function(){var i=this;if(!this.connInfo)return r.reject("ConnInfo helper undefined");var n=setTimeout(function(){return i.logger.warn(i.loggerId+"Get connectivity info expired"),i.cG?r.resolve(i.cG):r.reject("expired")},2e3);try{return this.connInfo.getConnectivityInfo().then(function(t){return clearTimeout(n),i.cG=t}).fail(function(t){return i.logger.debug(i.loggerId+" get connectivity info failed with error 1: ",t),i.cG?i.cG:r.reject(t)})}catch(t){return this.logger.debug(this.loggerId+" get connectivity info failed with error 2:",t),r.reject(t)}},u.prototype.lG=function(t,i,n){},u.prototype.vG=function(t){},u);function u(){this.loggerId="[PreloadConnectivityInfoProvider] ",this.connInfo=window.myConnInfo,this.logger=s.Framework.resolve(s.Framework.v.p).log(),this.cG=s.Framework.resolve(s.Framework.v.tk),this.connInfo||h.ErrorMonitor.getInstance().logError("helper undefined",this.loggerId),this.aG()}i.dG=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.EG=function(t){this.publicIp=t},s.prototype.getPublicIp=function(){return this.publicIp},s.prototype.wG=function(t){this.macAddress=t},s.prototype.getMacAddress=function(){return this.macAddress},s.prototype.pG=function(t){this.nic=t},s.prototype.getNic=function(){return this.nic},s.prototype.gG=function(t){this.nicName=t},s.prototype.getNicName=function(){return this.nicName},s.prototype.bG=function(t){this.privateIp=t},s.prototype.getPrivateIp=function(){return this.privateIp},s.prototype.yG=function(t){this.netmask=t},s.prototype.getNetmask=function(){return this.netmask},s.prototype.TG=function(t){this.cidr=t},s.prototype.getCidr=function(){return null},s);function s(){}i.OG=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var s=n(4),r=n(3),e=n(0),h=n(90),o=n(144),u=n(13),c=n(14),a=n(49),f=(l.prototype.aG=function(){var t=new h.OG();this.cG.BF(t)},l.prototype.mG=function(){var t=this;e.Framework.setInterval(function(){t.privateIps=[],t._G=[],t.RG=new r(),t.publicIp=null,t.SG=null,t.getConnectivityInfo()},12e4)},l.prototype.getConnectivityInfo=function(){return this.SG||(this.SG=this.AG()),this.SG},l.prototype.jS=function(){return this.cG},l.prototype.AG=function(){var n=this,r=s.defer();if(this.IG=e.Framework.setTimeout(function(){r.reject({NG:!0,message:"expired"})},4e3),u.HiveConfig.ConnInfo.detectPrivateIP&&this.CG())try{this.kG=new RTCPeerConnection(null),this.DG=this.kG.createDataChannel("sendChannel",{reliable:!1}),this.jG=new RTCPeerConnection(null),this.jG.ondatachannel=function(t){n.MG=t.channel,n.MG.onopen=function(t){if("open"===n.MG.readyState){if(n.jG.close(),n.kG.close(),n.jG=null,n.kG=null,n.logger.debug("Collected ips ["+n.RG.map(function(t,i){return i+":"+t.PG}).join(", ")+"]"),c.Rc.mc&&!n.LG&&(setTimeout(function(){a.Lk.Dk(null,null,"local_ice",null,n.HG)},5e3),n.LG=!0),0<n.RG.length&&c.Rc.Oc){var i=n.RG.entries().sort(function(t,i){return i[1].PG-t[1].PG});i=i.splice(0,1)[0],n.RG.clear(),n.RG.set(i[0],i[1])}n.FG.UG().then(function(t){n._G=t,0<n._G.length&&(n.logger.debug("Already known matching ips ["+n._G.join(",")+"]"),n._G.forEach(function(t){0<n.RG.keys().indexOf(t)&&(n.privateIps.push(t),n.RG["delete"](t))})),n.privateIps=n.privateIps.concat(n.RG.keys())}).fail(function(t){n.logger.warn("Get Previous working ips failed with error "+t.message),n.privateIps=n.privateIps.concat(n.RG.keys())})["finally"](function(){n.logger.debug("Final private ip list ["+n.privateIps.join(",")+"]"),r.resolve(n.GG())})}}},this.kG.onicecandidate=function(t){t.candidate&&(n.xG(t.candidate.candidate),n.jG&&n.jG.addIceCandidate(t.candidate)["catch"](function(t){r.reject({NG:!0,message:t.message}),e.Framework.clearTimeout(n.IG),!1}))},this.jG.onicecandidate=function(t){t.candidate&&(n.xG(t.candidate.candidate),n.kG&&n.kG.addIceCandidate(t.candidate)["catch"](function(t){r.reject({NG:!0,message:t.message}),e.Framework.clearTimeout(n.IG),!1}))},this.kG.createOffer().then(function(t){return n.kG.setLocalDescription(t)}).then(function(){return n.jG.setRemoteDescription(n.kG.localDescription)}).then(function(){return n.jG.createAnswer()}).then(function(t){return n.jG.setLocalDescription(t)}).then(function(){return n.kG.setRemoteDescription(n.jG.localDescription)})["catch"](function(t){r.reject({NG:!0,message:t.message}),e.Framework.clearTimeout(n.IG),!1})}catch(t){r.reject({NG:!0,message:t.message})}else{e.Framework.clearTimeout(this.IG);var t=u.HiveConfig.ConnInfo.detectPrivateIP?"webrtc datachannel not supported":"private IP detection disabled";r.reject({NG:!1,message:t})}return r.promise},l.prototype.CG=function(){try{return"function"==typeof RTCPeerConnection.prototype.createDataChannel}catch(t){return!1}},l.prototype.xG=function(t){var i="candidate:",n=t.indexOf(i)+i.length,r=t.substr(n).split(" "),s=r[0],e=r[1],h=r[2],o=r[3],u=r[4],a=r[5],f={BG:e,type:r[7],VG:s,protocol:h,address:u,port:a,PG:o};c.Rc.mc&&!this.LG&&this.HG.push(f),this.qG(f)},l.prototype.qG=function(t){var i=/([0-9]{1,3}(\.[0-9]{1,3}){3})/.exec(t.address);if(i){var n=i[0],r=this.RG.get(n);(isNaN(r)||t.PG>r)&&this.RG.set(n,t)}},l.prototype.GG=function(){var t=new h.OG();return 0<this.privateIps.length&&t.bG(this.privateIps[0]),this.publicIp&&t.EG(this.publicIp),this.cG.BF(t),this.cG},l.prototype.lG=function(t,i,n){if(this.publicIp=t,this.QG(),0===n&&1<this.privateIps.length)this.privateIps.shift();else if(c.Rc.lf&&0!==n&&-1==this._G.indexOf(this.privateIps[0]))this._G.unshift(this.privateIps[0]),this.FG.YG(this._G.slice(0,2));else if(c.Rc.lf&&0!==n&&0<this._G.indexOf(this.privateIps[0])){var r=this._G.indexOf(this.privateIps[0]);this._G=this._G.splice(r,1),this._G.unshift(this.privateIps[0]),this.FG.YG(this._G.slice(0,2))}this.GG()},l.prototype.QG=function(){var t=this.privateIps.indexOf(this.publicIp);-1<t&&this.privateIps.splice(t,1)},l.prototype.vG=function(t){},l);function l(){this.kG=null,this.jG=null,this.DG=null,this.MG=null,this.RG=new r(),this.publicIp=null,this.privateIps=[],this.failed=!1,this.IG=null,this.HG=[],this.LG=!1,this.logger=e.Framework.resolve(e.Framework.v.p).log(),this.cG=e.Framework.resolve(e.Framework.v.tk),this.FG=new o.KG(),this._G=[],this.aG(),this.mG()}i.WG=f},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(61),s=n(4),e=n(47),h=n(46),o=n(15),u=n(148),a=n(19),f=n(26),c=n(1),l=n(30),v=n(0),d=n(93),E=n(94),w=n(149),p=n(7),g=n(63),b=n(150),y=(T.prototype.getName=function(){return T.dR},T.prototype.id=function(){return"["+T.dR+"] "},T.prototype.getVersion=function(){return this.plugin.getPluginVersion()},T.prototype.needsReportingInstance=function(){return!0},T.prototype.isReady=function(){return s.resolve(!0)},T.prototype.initSession=function(t,i){var n=this.$G(t,i.ticket,i.ticket.VL(),i);return f.aR.getInstance().register(this.plugin,n),h.HiveRequestFactory.register(this),window&&window.activateXHRInterceptor&&window.activateXHRInterceptor(this.plugin.loggerLevel()>l.JS.info,this.plugin.getPluginId()),s.resolve(n)},T.prototype.getInitSessionTimeout=function(){return this.options().initTimeout},T.prototype.isActive=function(t,i,n){var r=i.manifest.toLowerCase().indexOf("/manifest");if(-1<r&&(!n||t===i.manifest)){var s=i.manifest.substring(0,r);if(-1<t.indexOf(s))return!0}else if(t==i.manifest)return!0;return!1},T.prototype.closeSession=function(t,i,n){void 0===n&&(n=!0),t.reportingInstance&&r["default"].getInstance().Dl(t.id)&&(this.plugin.logger().debug("[StatsJS] stopping session ["+t.id+"] complete close: "+i),t.reportingInstance.Wl.qS(n),t.reportingInstance.Ql.gF(),t.reportingInstance.Ql.reset(i)),i?r["default"].getInstance().close(t.id):this.onStateChange(t,!0)},T.prototype.onStateChange=function(t,i){var n=i?a.Il.IDLE:a.Il.Nl;this.plugin.logger().notice("[HiveComm] client state: "+a.Il[n]),t.reportingInstance&&t.reportingInstance.onStateChange(n)},T.prototype.handleStats=function(t,i){var n=0;return this.XG<i.totalBuffering&&(n=i.totalBuffering-this.XG,this.XG=i.totalBuffering),t.getReportingInstance().then(function(){t.reportingInstance.Vl.rF(n,i.bufferLength),t.reportingInstance.Vl.sF(i.zG),t.reportingInstance.ql.ES(i.playingPoint,i.bufferLength,i.totalBuffering)}).done(),s.resolve(!0)},T.prototype.handleEvent=function(t,i,n){return t.getReportingInstance().then(function(){t.reportingInstance.ql.pS(t.ticket.sessionId,i,n)}).done(),s.resolve(!0)},T.prototype.handleTechEvent=function(t,i){return t.getReportingInstance().then(function(){t.reportingInstance.ql.yS([i])}).done(),s.resolve(!0)},T.prototype.onError=function(t){var i=!0;if(null!=this.options().onError)try{!1===this.options_.onError(t)&&(i=!1)}catch(t){c.ErrorMonitor.getInstance().logError("exception in user-defined onError callback",this.id(),t)}return i},T.prototype.onActiveSession=function(r){var s=this;this.JG(),r.getReportingInstance().then(function(t){s.ZG=t;var i={getStreamProtocol:function(){return s.plugin.getStreamProtocol()},UH:function(){}};s.tx.init(s.ZG,r.id),s.tx.fM(s.ZG.ticket,s.options_&&s.options_.contextMatcher),r.authenticationToken&&s.tx.j.qH(r.authenticationToken),s.ZG.Vl._U.init(r.ticket,i),s.plugin.updatePlayerInfo(s.ZG),s.ZG.Ql.init(s.ZG.Vl,r.id),s.plugin.options().testId&&s.ZG.Vl.RU(s.plugin.options().testId),s.ZG.ql.manifestRequested(r.ticket.sessionId,s.plugin.getPlayerSource(),200),s.ix.init(s.ZG);var n=s.plugin.flushTechEvents();if(n&&0<n.length&&s.ZG.ql.yS(n),null!=s.options_.onActiveSession)try{s.options_.onActiveSession(r.toHiveSession())}catch(t){c.ErrorMonitor.getInstance().logError("exception in user-defined onActiveSession callback",s.id(),t)}}).done()},T.prototype.onTechTimeout=function(){},T.prototype.resetTech=function(){},T.prototype.setPlugin=function(t){this.plugin=t},T.prototype.options=function(){return this.options_},T.prototype.JG=function(){this.XG=0},T.prototype.$G=function(t,i,n,r){var s=new e.HiveSessionInternal(t,i,n,r,this.plugin.options().onSessionStateChange);return s.SDN=!1,s.id=i.sessionId,s},T.prototype.getPluginId=function(){return this.plugin.getPluginId()},T.prototype.createManifestRequest=function(t){var r=this,i=v.Framework.resolve(v.Framework.v.FC),s=new w.nx(i,t);return s.sx=function(t,i){if(t===g.$L.JL){r.plugin.logger().debug("Intercepted Manifest Request "+i);var n=r.tx.j;n.ex(s),r.ZG.Vl._U.hG(n),r.ZG.Vl._U.$F(n.yM())}else c.ErrorMonitor.getInstance().logError("Error intercepting manifest request",i)},i},T.prototype.createRequest=function(t){var i=this,n=this.tx.j,r=v.Framework.resolve(v.Framework.v.FC),s=new E.VA(r,n.getMetadata());return s.sx=function(t){n.hH(s).then(function(){if(i.ix.hx(s),t===g.$L.JL)switch(s.S_()){case p.xa.Ba:n.jH(s);break;case p.xa.Va:n.ox(s),n.ux(s),n.jH(s)}})},r},T.prototype.supportsXhrInterception=function(){return Boolean(this.options_.enableXhrInterception)},T.dR="StatsJS",T);function T(t,i){this.plugin=t,this.options_=new u.StatsJSOptions(),this.tx=new b.ax(),this.ix=new d.lx(),void 0!==i[T.dR]&&o.updateOptions(i[T.dR],this.options_),o.parseParameterOptions(window.location.href,new u.StatsJSUrlConfigurableOptions(),this.options_)}i.StatsJS=y},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(63),s=n(7),e=(h.prototype.init=function(t){this.tv=t.tv,this.Vl=t.Vl},h.prototype.vx=function(t){},h.prototype.uH=function(t){t?this.Vl.MU.metrics.bitrateUpN++:this.Vl.MU.metrics.bitrateDwnN++},h.prototype.hx=function(i){var t=this.tv.tG().ga();switch(isNaN(t)||(this.Vl.MU.metrics.srcThroughput=t),this.Ex(i).forEach(function(t){t.srcReqN++,t.srcRespQt+=i.x_()}),i.B_()){case r.$L.JL:this.wx(i,NaN);break;case r.$L.ZL:case r.$L.tH:this.px(i,NaN)}},h.prototype.wx=function(t,i){this.Ex(t).forEach(function(t){t.srcRespN++,t.respFallbackN++})},h.prototype.px=function(t,i){this.Ex(t).forEach(function(t){t.srcRespErrN++,t.respFallbackErrN++})},h.prototype.Ex=function(t){var i=[this.Vl.eF()];if(t.S_()===s.xa.Va){var n=t.V_().getQualityLevel(),r=this.Vl.uF(n);i.push(r)}return i},h);function h(){}i.lx=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(63),r=n(7),s=n(31),e=n(0),o=n(6),u=n(6),a=(f.prototype.loadstart=function(t){this.status=h.$L.zL,this.gx=e.Framework.time()},f.prototype.onload=function(t){this.status=h.$L.JL},f.prototype.onerror=function(t){this.status=h.$L.tH},f.prototype.onloadend=function(t){this.bx(),this.size=t.total,this.yx=e.Framework.time(),this.A_=this.Tx(),this.sx&&this.sx(this.status,this.url)},f.prototype.Tx=function(){if(!this.Ox)return null;var t=this.Ox.S_(this.url);if(t!==r.xa.Va&&t!==r.xa.Ba)return null;var i=this.Ox.MH(this.url);return s.dA.sA(i)},f.prototype.mx=function(){this.xhr.addEventListener("loadstart",this.loadstart.bind(this)),this.xhr.addEventListener("load",this.onload.bind(this)),this.xhr.addEventListener("error",this.onerror.bind(this)),this.xhr.addEventListener("loadend",this.onloadend.bind(this))},f.prototype.bx=function(){this.xhr.removeEventListener("loadstart",this.loadstart),this.xhr.removeEventListener("load",this.onload),this.xhr.removeEventListener("error",this.onerror),this.xhr.removeEventListener("loadend",this.onloadend)},f.prototype.k_=function(){return this.url},f.prototype.B_=function(){return this.status},f.prototype.x_=function(){return this.size},f.prototype.U_=function(){return new o.ma(this.yx-this.gx,this.size)},f.prototype.getResponse=function(){return this.xhr.response},f.prototype.G_=function(){return"arraybuffer"===this.xhr.responseType?u.Ia(this.xhr.response):this.xhr.response},f.prototype.S_=function(){return this.A_?this.A_.S_():r.xa.Qa},f.prototype.V_=function(){return this.A_},f);function f(r,t){var s=this;this.xhr=r,this.Ox=t,this.status=h.$L.XL;var e=r.open;r.open=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];t[0];var n=t[1];s.url=n,e.apply(r,t)},this.mx()}i.VA=a},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(32),o=n(1),r=(s.getInstance=function(){return this.instance||(this.instance=new s()),this.instance},s.prototype.AR=function(t,i,n){var r=h.aR.getInstance().pA(t),s=h.aR.getInstance().gA(t);if(!r)return o.ErrorMonitor.getInstance().logError("Tech or Plugin are not defined",this.loggerId),!1;var e={plugin:r,url:i,onActivateSession:n};return this._x(s,!0,e)||this._x(s,!1,e)},s.prototype._x=function(t,i,n){for(var r=n.plugin,s=n.url,e=n.onActivateSession,h=!1,o=0,u=t;o<u.length;o++){var a=u[o],f=void 0;(i?(f=a.ticket.VL())===s:(f=a.ticket.xL(),-1!==s.indexOf(a.ticket.xL())))?(r.logger().debug(this.loggerId+"Intercepted Manifest Request "+s),e&&e(a),r.onActivateSession(s,i),h=!0):r.logger().warn(this.loggerId+"Manifest url mismatches manifest url in ticket. Expected: "+f+", Actual: "+s)}return h},s);function s(){this.loggerId="[SessionActivator] "}i.Rx=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(93),s=n(7),e=(h.prototype.hH=function(i){var n=this;return this.metadata.hH(i).then(function(t){return n.metadata.S_(i.k_())===s.xa.qa&&n.ex(i),t})},h.prototype.ex=function(t){this.metadata.parse(t.k_(),t.G_(),!1)},h.prototype.DH=function(t){},h.prototype.jH=function(t){var i=this.metadata.MH(t.k_());i&&this.PH.add(i,t.x_())},h.prototype.ox=function(t){this.reportingInstance.tv.tG().wa(t.U_())},h.prototype.ux=function(t){var i=t.V_(),n=this.reportingInstance.tv.ZF(),r=i.getQualityLevel();n?0<r.Ob(n)?this.ix.uH(!0):r.Ob(n)<0&&this.ix.uH(!1):this.ix.uH(!0),this.reportingInstance.tv.JF(r)},h.prototype.getMetadata=function(){return this.metadata},h.prototype.getStreamProtocol=function(){return this.metadata.getStreamProtocol()},h.prototype.UH=function(){return this.FH},h.prototype.qH=function(t){this.metadata.qH(t)},h.prototype.yM=function(){return this.metadata.yM()},h);function h(t){this.reportingInstance=t,this.ix=new r.lx(),this.PH=t.Vl.PH,this.UL=t.ticket.VL(),this.ix.init(t)}i.XH=e},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(34),o=n(154),u=n(164),a=n(99),p=n(0),f=n(165),c=n(7),w=n(64),l=n(166),v=n(167),g=n(33),d=n(13),b=n(1),y=n(2),E=n(168),T=n(6),O=n(169),m=n(101),_=(e=m.Sx,s(R,e),R.prototype.getStreamProtocol=function(){return StreamProtocol.DASH},R.prototype.Ax=function(t){var i="";return-1!==t.indexOf("/")&&(-1!==t.indexOf("?")&&(t=t.substring(0,t.indexOf("?"))),i=t.substring(0,t.lastIndexOf("/")+1)),i},R.prototype.HH=function(i){return this.Ix.filter(function(t){return!i||t.type===i}).map(function(t){return t.qualityLevel})},R.prototype.reset=function(){this.Ix=[]},R.prototype.parse=function(t,i,n){var o=this;try{this.reset(),this.UL=t,this.manifest=this.Nx.parse(i);var u=this.manifest.hasOwnProperty("Location")?this.Ax(this.manifest.Location):this.Ax(t);this.manifest.hasOwnProperty("BaseURL")&&(u+=this.manifest.BaseURL),this.live="static"!==this.manifest.type;var a=this.manifest.Period_asArray[0];return a.AdaptationSet_asArray,a.AdaptationSet.forEach(function(t){var e=-1!=(t.mimeType?t.mimeType:t.Representation_asArray[0].mimeType).indexOf("audio")?c.xa.Ba:c.xa.Va;e===c.xa.Va&&t.ContentProtection&&o.Cx(t.ContentProtection);var h=t.SegmentTemplate;t.Representation_asArray&&t.Representation_asArray.forEach(function(t){var i=new f.Representation(),n=o.XF.add(e,{id:t.id,bitrate:parseInt(t.bandwidth),width:t.width,height:t.height,label:t.label}),r=t.SegmentTemplate?t.SegmentTemplate:h;if(i.type=e,i.qualityLevel=n,i.timescale=parseInt(r.timescale)||1e3,i.kx=t.id,i.initialization=u+""+r.initialization,i.initialization=i.initialization.replace(R.Dx,""+i.qualityLevel.bitrate),i.initialization=i.initialization.replace(R.jx,""+i.kx),i.initialization=T.Ha(i.initialization),i.Mx=u+""+r.media,i.Mx=i.Mx.replace(R.Dx,""+i.qualityLevel.bitrate),i.Mx=i.Mx.replace(R.jx,""+i.kx),i.Mx=T.Ha(i.Mx),i.Px=o.Lx(T.La(i.Mx)),i.Mx.match(R.Hx)){if(i.Ux=parseInt(r.duration),!i.Ux)throw new Error("Expected duration on SegmentTemplate for Number-based template");i.startNumber=parseInt(r.startNumber)||0,i.Fx=parseInt(a.start)||0,o.Gx=!0}else{var s=o.xx(r.SegmentTimeline_asArray[0].S_asArray,i.Mx,i.qualityLevel,e);i.Bx=s.Vx,i.qx=s.Qx}o.Ix.push(i)})}),this.Kx.Yx?this.Wx(i,n):i}catch(t){throw b.ErrorMonitor.getInstance().logError("Error parsing the metadata",this.loggerId,y.Un.Fn,t),new Error(t)}},R.prototype.Lx=function(t){var i=t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&"),n=i.match(/\\\$Number%(\d+)d\\\$/);return n&&(i=i.replace("\\$Number%"+n[1]+"d\\$","(\\d{"+parseInt(n[1])+"})")),i=(i=i.replace("\\$Time\\$","([0-9]*)")).replace("\\$Number\\$","([0-9]*)"),new RegExp(i,"i")},R.prototype.xx=function(t,u,a,f){try{var c,l=new h(),v=new h(),d=0,E=0;return t.forEach(function(t){if(t.d){t.t?d=parseInt(t.t):d+=E;var i=parseInt(t.d),n=u.replace(R.$x,d+""),r=new w.iH(d,a,i,n,n,f);c&&(c.next=r),l.set(T.La(n),r),v.set(d,r),c=r;var s=0;t.r&&(s=parseInt(t.r));for(var e=0;e<s;e++){d+=i;var h=u.replace(R.$x,d+""),o=new w.iH(d,a,i,h,h,f);c&&(c.next=o),l.set(T.La(h),o),v.set(d,o),c=o}E=i}}),{Vx:l,Qx:v}}catch(t){throw b.ErrorMonitor.getInstance().logError("Error extracting segment maps",this.loggerId,y.Un.Gn,t),new Error(t)}},R.prototype.Cx=function(t){try{if(t){if(t.CryptoPeriod){var i=t.CryptoPeriod;this.Xx&&!this.Xx.zx()&&this.Xx instanceof l.Jx||(this.Xx=new l.Jx(i.keyUriTemplate,i.IV,this.authenticationToken))}else this.Xx&&this.Xx instanceof v.Zx||(this.Xx=new v.Zx());this.Xx&&g.Dash.MA&&this.Xx.init()}}catch(t){throw b.ErrorMonitor.getInstance().logError("Error initializing the protection",this.loggerId,y.Un.xn,t),new Error(t)}},R.prototype.tB=function(i){return i=T.La(i),this.Ix.find(function(t){return t.Px.test(i)})},R.prototype.MH=function(t){t=T.La(t);try{var i=this.tB(t);if(i){var n=void 0;if(i.Bx&&(n=i.Bx.get(t)))return n;var r=t.match(i.Px);if(r){var s=parseInt(r[1]);return this.BH(s,i.qualityLevel)}}throw new Error("No representation for "+t)}catch(t){return b.ErrorMonitor.getInstance().logError("Error getting the segment info",this.loggerId,y.Un.Bn,t),null}},R.prototype.S_=function(i){try{if(g.Dash.yA(i,void 0,this.iB))return c.xa.qa;if(this.nB(i))return c.xa.Qa;var t=this.MH(i);return null!=t?t.hA:-1!=i.indexOf("audio")?c.xa.Ba:c.xa.Qa}catch(t){return b.ErrorMonitor.getInstance().logError("Error getting the entity type based on a url",this.loggerId,y.In.Nn,{detailedError:t,url:i}),c.xa.Qa}},R.prototype.rB=function(t){t=T.La(t);try{return this.tB(t).timescale}catch(t){return b.ErrorMonitor.getInstance().logError("Error getting the representation for timescale",this.loggerId,y.Un.Vn,t),1e4}},R.prototype.nB=function(i){return i=T.La(i),this.Ix.some(function(t){return T.La(t.initialization)===i})},R.prototype.VH=function(t){t=T.La(t);var i=this.MH(t);return null!=i?i.next:null},R.prototype.sB=function(t,i){var n=this.Ix.find(function(t){return t.qualityLevel.id===i.id});if(n){if(n.qx)return 1;var r=p.Framework.time(),s=this.manifest.availabilityStartTime.getTime()+(this.manifest.Period.start||0)+(t-n.startNumber+1)*n.Ux*n.timescale;return Math.max(1,s-r)}return 1},R.prototype.iP=function(t,i,n,r){try{var s=this.Ix.find(function(t){return t.qualityLevel.id===r.id});if(s){if(s.qx&&s.qx.has(t)&&s.qx.has(n)){for(var e=s.qx.get(t),h=s.qx.get(n),o=0,u=e;u&&u!=h;)o+=u.duration,u=u.next;return Math.round(o/(s.timescale/1e3))}if(s.Ux)return(n-t)*s.Ux*s.timescale}return 0}catch(t){return b.ErrorMonitor.getInstance().logError("Error extracting the segment distance",this.loggerId,y.Un.Vn,t),0}},R.prototype.eB=function(t){try{t instanceof Uint8Array&&(t=t.buffer);var i=u.hB(t),n=i.fetch("tfhd"),r=i.fetch("trun"),s=n?n.default_sample_duration:0;if(r){var e=0;return r.oB.forEach(function(t){e+=t.sample_duration}),isNaN(e)&&0<s&&(e=s*r.oB.length),e}}catch(t){return b.ErrorMonitor.getInstance().logError("Error extracting duration from the buffer",this.loggerId,y.Un.qn,t),0}},R.prototype.Wx=function(t,i){var n=this.uB();if(!i&&(this.live||n||d.HiveConfig.Dash.DashRemoveBitrateSize))try{var r=t.match(/^<\?xml\s[^?]+\?>/),s=new a["default"]({escapeMode:!0,useDoubleQuotes:!0,arrayAccessForm:"property"}),e=s.aB(t);this.live&&this.fB(e),(n||d.HiveConfig.Dash.DashRemoveBitrateSize)&&this.cB(e,n,d.HiveConfig.Dash.DashRemoveBitrateSize);var h=s.lB(e);return r&&(h=r[0]+h),h}catch(t){this.logger.error(t)}return t},R.prototype.fB=function(c){var l=this,v=Math.max(1,g.Dash.DASH_METADATA_MIN_FRAGMENTS),d=Math.max(1,g.Dash.FA),E=[],w=!1;return c.MPD&&c.MPD.Period&&c.MPD.Period.AdaptationSet&&c.MPD.Period.AdaptationSet.forEach(function(t){if(!w)if(t.SegmentTemplate&&t.SegmentTemplate._media&&t.SegmentTemplate._media.match(R.Hx)){w=!0;var i=p.Framework.time();c.MPD.Period._start=c.MPD.Period._start||"PT0S";var n=c.MPD.Period._start,r=O["default"](n),s=parseInt(t.SegmentTemplate._timescale)||1e3,e=parseInt(t.SegmentTemplate._duration)*s,h=Math.max(0,Math.floor((i-(new Date(c.MPD._availabilityStartTime).getTime()+1e3*r))/e)-g.Dash.UA),o=Math.ceil(1e3*g.Dash.HA/e),u=Math.max(0,Math.min(h,o)),a=0<u?u*e/1e3:0;try{c.MPD.Period._start="PT"+(r+a)+"S",l.logger.debug("Trimmed "+a+" from period start "+n+" => "+c.MPD.Period._start)}catch(t){l.logger.warn("Could not modify period: "+t)}}else if(l.vB(t)&&t.Representation_asArray){var f=l.dB(t.SegmentTemplate,d,v);t.Representation_asArray.forEach(function(t){f.bandwidth=parseInt(t._bandwidth)||0,E.push(f)})}else t.Representation_asArray&&0<t.Representation_asArray.length&&t.Representation_asArray.forEach(function(t){if(l.EB(t)){var i=l.dB(t.SegmentTemplate,d,v);i.bandwidth=parseInt(t._bandwidth)||0,E.push(i)}})}),c},R.prototype.EB=function(t){return t&&("video/mp4"===t._mimeType||"video"===t._contentType||t.SegmentTemplate&&t.SegmentTemplate._media&&-1<t.SegmentTemplate._media.indexOf("video"))},R.prototype.dB=function(t,i,n){for(var r=0,s=0,e=t.SegmentTimeline.S_asArray,h=i*parseInt(t._timescale),o=0,u=0,a=0;a<e.length&&0<n;a++)n<(l=(c=e[o=a])._r?parseInt(c._r):1)?(u=n,n=0):(n-=l,u=l);for(var f=e.length-1;0<=f&&0<h&&o<=f;f--){var c,l=(c=e[f])._r?parseInt(c._r):1,v=0;if(!c._d)throw new Error("missing segment duration");var d=l*(v=parseInt(c._d));if((o<f||f==o&&0==u)&&d<=h)h-=d,e.splice(f,1),r+=l,s+=d;else{var E=Math.ceil(h/v);f==o&&(E=Math.min(E,l-u));var w=v*E;c._r=l-E+"",h-=w,r+=E,s+=w}}return this.logger.debug("DASH trimmed "+r+" segments for total duration: "+s),{count:r,wB:s}},R.prototype.vB=function(t){return!!t&&!!("video/mp4"===t._mimeType||"video"===t._contentType||t.SegmentTemplate&&t.SegmentTemplate._media&&-1<t.SegmentTemplate._media.indexOf("video"))&&!!t.SegmentTemplate.SegmentTimeline},R.prototype.uB=function(){var t=d.HiveConfig.Dash.DashFilterBitrates;if(t)try{return("string"==typeof t?t.split(","):t).map(function(t){return parseInt(t)}).filter(function(t){return!isNaN(t)})}catch(t){b.ErrorMonitor.getInstance().logError("Error parsing DashFilterBitrates",this.loggerId,y.Un.zn,t)}},R.prototype.cB=function(t,s,e){var h=this;if(t.MPD&&t.MPD.Period){var o=this.XF.KF(c.xa.Va),u=[];t.MPD.Period.AdaptationSet.forEach(function(t){if(t.Representation_asArray&&(h.vB(t)||t.Representation_asArray.every(function(t){return h.EB(t)}))){var i=t.Representation_asArray;i.sort(function(t,i){return o.get(t.pB)-o.get(i.pB)});for(var n=i.length-1;0<=n;n--){e&&(delete i[n]._width,delete i[n]._height);var r=o.get(i[n].pB);s&&!s.includes(r)?i.splice(n,1):u.push(i[n].pB)}h.logger.debug("DASH filtered-in quality levels: "+u.reverse().join(", ")+" - removed size: "+e)}})}},R.prototype.BH=function(n,i){try{var t=this.Ix.find(function(t){return t.qualityLevel.id===i.id});if(t&&t.qx&&t.qx.has(n))return t.qx.get(n);if(t&&t.Ux){var r=t.Mx.replace(R.Hx,function(t,i){return E.gB(i||"%d",n)}),s=new w.iH(n,t.qualityLevel,t.Ux*t.timescale,r,r,t.type),e=t.Mx.replace(R.Hx,function(t,i){return E.gB(i||"%d",n+1)});return s.next=new w.iH(n+1,t.qualityLevel,t.Ux*t.timescale,r,e,t.type),s}return null}catch(t){return b.ErrorMonitor.getInstance().logError("Error getting the segment",this.loggerId,y.Un.tr,t),null}},R.Dx="$Bandwidth$",R.$x="$Time$",R.jx="$RepresentationID$",R.Hx=/\$Number([^$]+)?\$/,R);function R(t,i,n){var r=e.call(this,t,n)||this;return r.loggerId="[DASH METADATA] ",r.Gx=!1,r.logger=p.Framework&&p.Framework.resolve(p.Framework.v.p)?p.Framework.resolve(p.Framework.v.p).log(i):console,r.Nx=o["default"]().create(),r.reset(),r}i.bB=_},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var u,e,r,s,h=(u=void 0,e=[],r={},s={},u={extend:function(t,i,n,r){!r[t]&&i&&(r[t]={instance:i,yB:n})},TB:o,OB:function(t,i,n){for(var r in e){var s=e[r];if(s.context===t&&s.name===i)return void (e[r].instance=n)}e.push({name:i,context:t,instance:n})},mB:function(n){var t=a(n._B,r);return t||(t=function(t){var i=void 0;return void 0===t&&(t={}),{getInstance:function(){return(i=i||o(t,n._B))||(i=c(n,t,arguments),e.push({name:n._B,context:t,instance:i})),i}}},r[n._B]=t),t},RB:function(t){return a(t,r)},SB:function(t,i){f(t,i,r)},AB:function(i){var t=a(i._B,s);return t||(t=function(t){return void 0===t&&(t={}),{create:function(){return c(i,t,arguments)}}},s[i._B]=t),t},IB:function(t){return a(t,s)},NB:function(t,i){f(t,i,s)}});function o(t,i){for(var n in e){var r=e[n];if(r.context===t&&r.name===i)return r.instance}return null}function a(t,i){return i[t]}function f(t,i,n){t in n&&(n[t]=i)}function c(t,i,n){var r=void 0,s=t._B,e=i[s];if(e){var h=e.instance;if(!e.yB)return h.apply({context:i,CB:u},n);for(var o in r=t.apply({context:i},n),h=h.apply({context:i,CB:u,parent:r},n))r.hasOwnProperty(o)&&(r[o]=h[o])}else r=t.apply({context:i},n);return r.kB=function(){return s},r}i["default"]=h},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0}),i["default"]=function(m){m=m||{},(function(){void 0===m.escapeMode&&(m.escapeMode=!0),void 0===m.DB&&(m.DB="_"),(m.arrayAccessForm=m.arrayAccessForm||"none",m.jB=m.jB||"text",void 0===m.MB&&(m.MB=!0)),(m.PB=m.PB||[],void 0===m.LB&&(m.LB=!0)),void 0===m.HB&&(m.HB=!0),(m.UB=m.UB||[],void 0===m.useDoubleQuotes&&(m.useDoubleQuotes=!1)),(m.FB=m.FB||[],m.GB=m.GB||[],void 0===m.xB&&(m.xB=!1)),void 0===m.BB&&(m.BB=!1)})();var _={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};function R(t){var i=t.localName;return null==i&&(i=t.VB),null!=i&&""!=i||(i=t.nodeName),i}function u(t){return"string"==typeof t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):t}function S(t,i,n,r){for(var s=0;s<t.length;s++){var e=t[s];if("string"==typeof e){if(e==r)break}else if(e instanceof RegExp){if(e.test(r))break}else if("function"==typeof e&&e(i,n,r))break}return s!=t.length}function A(t,i,n){switch(m.arrayAccessForm){case"property":t[i]instanceof Array?t[i+"_asArray"]=t[i]:t[i+"_asArray"]=[t[i]]}!(t[i]instanceof Array)&&0<m.PB.length&&S(m.PB,t,i,n)&&(t[i]=[t[i]])}function I(t){var i=t.split(/[-T:+Z]/g),n=new Date(i[0],i[1]-1,i[2]),r=i[5].split(".");if(n.setHours(i[3],i[4],r[0]),1<r.length&&n.setMilliseconds(r[1]),i[6]&&i[7]){var s=60*i[6]+Number(i[7]);s=0+("-"==(/\d\d-\d\d:\d\d$/.test(t)?"-":"+")?-1*s:s),n.setMinutes(n.getMinutes()-s-n.getTimezoneOffset())}else-1!==t.indexOf("Z",t.length-1)&&(n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())));return n}function N(t,i){if(t.nodeType==_.DOCUMENT_NODE){for(var n=new Object(),r=t.childNodes,s=0;s<r.length;s++)(h=r[s]).nodeType==_.ELEMENT_NODE&&(m.BB?n=N(h):(n={})[o=R(h)]=N(h));return n}if(t.nodeType==_.ELEMENT_NODE){(n=new Object()).__cnt=0;var e=[];for(r=t.childNodes,s=0;s<r.length;s++){var h,o=R(h=r[s]);if(h.nodeType!=_.COMMENT_NODE){var u=i+"."+o;if(b=n,y=h.nodeType,T=o,O=u,!(y==_.ELEMENT_NODE&&0<m.FB.length)||S(m.FB,b,T,O))if(n.__cnt++,null==n[o]){var a=N(h,u);("#text"!=o||/[^\s]/.test(a))&&((f={})[o]=a,e.push(f));n[o]=a,A(n,o,u)}else{null!=n[o]&&(n[o]instanceof Array||(n[o]=[n[o]],A(n,o,u)));var f;a=N(h,u);("#text"!=o||/[^\s]/.test(a))&&((f={})[o]=a,e.push(f));n[o][n[o].length]=a}}}n.__children=e;for(var c=R(t),l=0;l<t.attributes.length;l++){var v=t.attributes[l];n.__cnt++;var d=v.value;if(Array.isArray(m.qB))for(var E=0,w=m.qB.length;E<w;E++){var p=m.qB[E];p.test(v,c)&&(d=p.converter(v.value))}n[m.DB+v.name]=d}var g=function(t){return t.prefix}(t);return null!=g&&""!=g&&(n.__cnt++,n.__prefix=g),null!=n["#text"]&&(n.__text=n["#text"],n.__text instanceof Array&&(n.__text=n.__text.join("\n")),m.HB&&(n.__text=n.__text.trim()),delete n["#text"],"property"==m.arrayAccessForm&&delete n["#text_asArray"],n.__text=function(t,i,n){if(0<m.UB.length){var r=n.split(".#")[0];return S(m.UB,t,i,r)?I(t):t}return t}(n.__text,o,i+"."+o)),null!=n["#cdata-section"]&&(n.__cdata=n["#cdata-section"],delete n["#cdata-section"],"property"==m.arrayAccessForm&&delete n["#cdata-section_asArray"]),0==n.__cnt&&"text"==m.jB?n="":1==n.__cnt&&null!=n.__text?n=n.__text:1!=n.__cnt||null==n.__cdata||m.xB?1<n.__cnt&&null!=n.__text&&m.LB&&(m.HB&&""==n.__text||""==n.__text.trim())&&delete n.__text:n=n.__cdata,delete n.__cnt,!m.MB||null==n.__text&&null==n.__cdata||(n.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),n}if(t.nodeType==_.TEXT_NODE||t.nodeType==_.CDATA_SECTION_NODE)return t.nodeValue;var b,y,T,O}function a(t,i,n,r){var s="<"+(null!=t&&null!=t.__prefix?t.__prefix+":":"")+i;if(null!=n)for(var e=0;e<n.length;e++){var h=n[e],o=t[h];m.escapeMode&&(o=u(o)),s+=" "+h.substr(m.DB.length)+"=",m.useDoubleQuotes?s+='"'+o+'"':s+="'"+o+"'"}return s+=r?"/>":">"}function f(t,i){return"</"+(null!=t.__prefix?t.__prefix+":":"")+i+">"}function c(t,i){return!!("property"==m.arrayAccessForm&&function(t,i){return-1!==t.indexOf(i,t.length-i.length)}(i.toString(),"_asArray")||0==i.toString().indexOf(m.DB)||0==i.toString().indexOf("__")||t[i]instanceof Function)}function l(t){var i=0;if(t instanceof Object)for(var n in t)c(t,n)||i++;return i}function v(t){var i=[];if(t instanceof Object)for(var n in t)-1==n.toString().indexOf("__")&&0==n.toString().indexOf(m.DB)&&i.push(n);return i}function d(t){var i="";return t instanceof Object?i+=function(t){var i="";return null!=t.__cdata&&(i+="<![CDATA["+t.__cdata+"]]>"),null!=t.__text&&(m.escapeMode?i+=u(t.__text):i+=t.__text),i}(t):null!=t&&(m.escapeMode?i+=u(t):i+=t),i}function E(t,i){return""===t?i:t+"."+i}function w(t,i,n,r){var s="";if(0==t.length)s+=a(t,i,n,!0);else for(var e=0;e<t.length;e++)s+=a(t[e],i,v(t[e]),!1),s+=p(t[e],E(r,i)),s+=f(t[e],i);return s}function p(t,i){var n,r,s,e="";if(0<l(t))for(var h in t)if(!c(t,h)&&(""==i||(n=t,s=E(i,r=h),0==m.GB.length||""==s||S(m.GB,n,r,s)))){var o=t[h],u=v(o);null==o||null==o?e+=a(o,h,u,!0):o instanceof Object?o instanceof Array?e+=w(o,h,u,i):o instanceof Date?(e+=a(o,h,u,!1),e+=o.toISOString(),e+=f(o,h)):0<l(o)||null!=o.__text||null!=o.__cdata?(e+=a(o,h,u,!1),e+=p(o,E(i,h)),e+=f(o,h)):e+=a(o,h,u,!0):(e+=a(o,h,u,!1),e+=d(o),e+=f(o,h))}return e+=d(t)}this.QB=function(t){var i;window.ActiveXObject||window;if(void 0===t)return null;if(window.DOMParser){var n=new window.DOMParser();try{0<(i=n.parseFromString(t,"text/xml")).getElementsByTagNameNS("*","parsererror").length&&(i=null)}catch(t){i=null}}else 0==t.indexOf("<?")&&(t=t.substr(t.indexOf("?>")+2)),(i=new ActiveXObject("Microsoft.XMLDOM")).async="false",i.YB(t);return i},this.KB=function(t){return void 0===t||null==t?[]:t instanceof Array?t:[t]},this.WB=function(t){return t instanceof Date?t.toISOString():"number"==typeof t?new Date(t).toISOString():null},this.$B=function(t){return"string"==typeof t?I(t):t},this.XB=function(t){return N(t)},this.aB=function(t){var i=this.QB(t);return null!=i?this.XB(i):null},this.lB=function(t){return p(t,"")},this.zB=function(t){var i=this.lB(t);return this.QB(i)},this.getVersion=function(){return"1.2.0"}}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=function(t,i,n){return i&&s(t.prototype,i),n&&s(t,n),t};function s(t,i){for(var n=0;n<i.length;n++){var r=i[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var e,h=n(162),o=(e=h)&&e.s?e:{"default":e},u=(r(a,[{key:"name",get:function(){return this.JB}},{key:"children",get:function(){return this.ZB}},{key:"properties",get:function(){return this.tV}}]),a);function a(t,i,n){var r=this;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,a),this.JB=t||"",this.tV=[],this.ZB=n||[],Array.isArray(i)&&i.forEach(function(t){r.tV.push(new o["default"](t))})}i["default"]=u},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=(e.prototype.xL=function(){return this.UL},e.prototype.iV=function(){return this.iB},e.prototype.isLive=function(){return this.live},e.prototype.qH=function(t){this.authenticationToken=t},e.prototype.yM=function(){return this.XF},e);function e(t,i){this.live=!1,this.XF=r.Framework.resolve(r.Framework.v.gk),this.Kx=t,this.iB=i}i.Sx=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var s=n(33),e=n(52),r=(h.prototype.fM=function(t,i){var n=null,r=t.VL();return e.Mj.bA(r,this.logger,i?i.hls:void 0)?this.j=n=this.nV(t,i):s.Dash.bA(r,this.logger,i?i.dash:void 0)?this.j=n=this.rV(t,i):this.logger.warn("COULD NOT FIND A CONTEXT FOR "+r),null!=n&&this.sV(this.j),n},h.prototype.sV=function(t){},h);function h(){}i.eV=r},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(78),o=n(0),u=(e=h["default"],s(a,e),a);function a(){return e.call(this,"JS",o.Framework.v.Kc)||this}i["default"]=new u()},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(6),f=n(24),s=n(7),c=n(0),l=n(5),v=n(2),d=n(1),e=n(49),h=n(3),o=(E.prototype.hV=function(t,i){try{var n=void 0,r=t.A_.getDuration(),s=t.size,e=-1,h=0,o=-1;if(this.oV.isValid()&&(e=Math.max(10,this.oV.pa(s))),h=-1<e?Math.max(0,r-e*l.xu.Su.Zh):.5*r,E.uV){var u=t.partner.dP();0<u&&(o=i/u*l.xu.Su.io),n=t.type===f.h_.l_?r*l.xu.Su.to:-1<o&&o<=h?h:-1<o&&o<=r*l.xu.Su.no?r*l.xu.Su.no:0}else t.type==f.h_.l_&&(h*=2),n=Math.max(this.aV(),h);if(l.xu.Fu.wu){var a=this.fV.has(t.I_())?this.fV.get(t.I_()):this.cV(t);a.push([c.Framework.time(),i,e,h,o,t.type,n]),this.fV.set(t.I_(),a)}return this.logger.debug("TIMER DETAILS duration: "+r+" left/total: "+i+"/"+s+" cdn: "+e+" remaining: "+h+" p2p: "+o+" timeout: "+n),n}catch(t){return d.ErrorMonitor.getInstance().logError("Error calculating the p2p timeout",this.loggerId,v.cr.lr,t),0}},E.prototype.lV=function(t,i){return 5e3},E.prototype.vV=function(t){try{return this.oV.isValid()?Math.min(this.oV.pa(t),this.dV()):this.EV()}catch(t){return d.ErrorMonitor.getInstance().logError("Error calculating the delivery delay",this.loggerId,v.cr.vr,t),this.EV()}},E.prototype.wV=function(t){if(t.S_()===s.xa.Va)switch(t.R_()){case f.h_.u_:case f.h_.o_:case f.h_.a_:case f.h_.f_:this.oV.wa(t.U_());break;case f.h_.c_:case f.h_.l_:this.pV.wa(t.U_())}if(l.xu.Fu.wu){var i=this.fV.has(t.I_())?this.fV.get(t.I_()):this.cV(t);i.push([c.Framework.time(),t.R_()]),e.Lk.Mk(null,null,"p2p_timer",this.tv.getReportingGuid(),i,10)}},E.prototype.aV=function(){return E.gV},E.prototype.EV=function(){return E.bV},E.prototype.dV=function(){return E.yV},E.prototype.cV=function(t){return[[t.I_(),t.A_.getDuration(),t.size]]},E.uV=!0,E.gV=500,E.yV=1500,E.bV=500,E);function E(t){this.loggerId="[TIMER HANDLER] ",this.oV=new r.ma(),this.pV=new r.ma(),this.fV=new h(),this.logger=c.Framework.resolve(c.Framework.v.p).log(),this.tv=t}i.TV=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var v,r,d=n(2),E=n(2),s=n(0),w=n(15),p=n(1),g=E.de,b=n(7);(r=v=v||{})[r.OV=0]="INFO",r[r.mV=1]="WARN",r[r.ERROR=2]="ERROR";var e=(y.prototype._V=function(){var t=this.metadata.HH(b.xa.Va),i=t.length,n=this.metadata.isLive();if(0===i||void 0!==n)for(var r=0;r<y.RV.length;r++){var s=y.RV[r],e=s[0],h=s[1],o=s[2];if(i<=e){if(-1===this.SV.indexOf(h)){var u=t.map(function(t){return w.Ta(t.bitrate)+"/s"}).join(", "),a=y.AV+w.Ic(d.me[h],n?"Live":"VOD",i,u);switch(o){case v.OV:this.logger.info(a);break;case v.mV:this.logger.warn(a);break;default:this.logger.error(a);var f=0===i?g.ye:g.Te;p.ErrorMonitor.getInstance().logError(d.me[f],y.AV,f,{isLive:n,qualityLevels:t})}this.SV.push(h)}break}}if(-1===this.SV.indexOf(g.Ee)){var c=!1;for(r=0;r<t.length;r++){var l=t[r];if(l.bitrate>y.NV){c=!0,a=y.AV+w.Ic(d.me[E.de.Ee],w.Ta(l.bitrate),w.Ta(y.NV)),this.logger.warn(a);break}}c&&this.SV.push(g.Ee)}},y.prototype.reset=function(){this.SV.length=0},y.AV="[StreamHealthChecker] ",y.NV=35e5,y.RV=[[0,g.we,v.ERROR],[4,g.pe,v.OV],[7,g.ge,v.mV],[1/0,g.be,v.ERROR]],y);function y(t){this.SV=[],this.metadata=t,this.logger=s.Framework.resolve(s.Framework.v.p).log()}i.CV=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(1),e=(s.prototype.size=function(){var t=this.end-this.start+1;return Number.isInteger(t)||(r.ErrorMonitor.getInstance().logError("Segment Size is a Float",{size:t}),t=Math.round(t)),0==this.end&&0==this.start?0:t},s.prototype.kV=function(){return 0==this.start&&(this.end==this.total-1||this.end==this.total&&0==this.total)},s.prototype.DV=function(){return this.end==this.total-1||this.end==this.total&&0==this.total},s.prototype.jV=function(t){return t.start<=this.start&&this.start<=t.end},s.prototype.toString=function(){return"R[S="+this.start+",E="+this.end+",T="+this.total+"]"},s);function s(t,i,n){this.start=t,this.end=i,this.total=n}i.MV=e;var h=(o.PV=function(t){return t.split("-")},o.LV=function(t){var i=t.split("=",4),n=i[1].substr(0,i[1].indexOf(",")),r=i[2].substr(0,i[2].indexOf(",")),s=i[3].substr(0,i[3].indexOf("]"));return new e(+n,+r,+s)},o);function o(){}i.HV=h},function(t,i,n){"use strict";var r;Object.defineProperty(i,"s",{value:!0}),(r=i.UV||(i.UV={}))[r.FV=0]="ALL",r[r.AS=1]="AS",r[r.tM=2]="SITE"},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e,r,h=n(0),o=n(17),u=n(5),a=n(9),f=n(4),s=n(3),c=n(66),l=n(212),v=n(1),d=(E.prototype.init=function(t){this.GV=t,this.logger=h.Framework.resolve(h.Framework.v.p).log(t.sessionId),this.tv=t.tv,this.xV=t.xV,this.uM=t.uM},E.prototype.BV=function(t,i){var n=this,r=f.defer();try{if(this.VV){var s=null;t.privateIpString&&(s=t.privateIpString);var e=new l.qV(t.guid,t.rankValue,s,t.isLeader);if(this.QV.has(e.uuid)){var h=this.QV.get(e.uuid);h.udpScore==e.udpScore&&h.YV==e.YV?r.resolve():(this.QV.set(e.uuid,e),this.KV(),this.WV(e).then(function(){r.resolve()}).fail(function(t){n.QV["delete"](e.uuid),n.KV(),r.reject(t)}))}else i?(e.$V=i,this.logger.info(this.loggerId+" NEW MEMBER GUID "+e.uuid+" RANKING "+e.udpScore+" LEADER "+e.YV),this.QV.set(e.uuid,e),this.KV(),this.WV(e).then(function(){n.XV(n.QV.get(e.uuid)),r.resolve()}).fail(function(t){n.QV["delete"](e.uuid),n.KV(),r.reject(t)})):this.zV(e).then(function(t){e.$V=t,n.logger.info(n.loggerId+" NEW MEMBER GUID "+e.uuid+" RANKING "+e.udpScore+" LEADER "+e.YV),n.QV.set(e.uuid,e),n.KV(),n.WV(e).then(function(){r.resolve()}).fail(function(t){n.QV["delete"](e.uuid),n.KV(),r.reject(t)})}).fail(function(t){r.reject(t)})}else r.reject("LEADER ELECTION NOT STARTED YET")}catch(t){r.reject("TRIGGER LEADER ELECTION ERROR "+t)}return r.promise},E.prototype.XV=function(t){var i=new a.yf(a.pf.bf,null);i.guid=t.uuid,i.isLeader=t.YV,i.rankValue=t.udpScore;var n=[i];this.xV.JV(n,!1)},E.prototype.zV=function(n){var r=this,s=f.defer();return this.ZV.has(n.uuid)||this.tq.has(n.uuid)?s.reject(e.iq):(this.ZV.set(n.uuid,Date.now()),this.Jc.connect(n.uuid).then(function(t){var i=t.il.get(r.GV.swarmId);null==i?(i=t.il.create(r.GV.swarmId),r.nq(i).then(function(){s.resolve(t)}).fail(function(t){s.reject(t)}).done()):r.rq.get(n.uuid)?s.resolve(t):(r.ZV["delete"](n.uuid),r.nq(i).then(function(){s.resolve(t)}).fail(function(t){s.reject(t)}).done())}).fail(function(t){r.ZV["delete"](n.uuid),s.reject(t)}).done()),s.promise},E.prototype.nq=function(t){var i=this,n=f.defer(),r=new o.Al.ml.UDPHandshakeMessage();r.uuid=this.sq.uuid,r.udpScore=this.sq.udpScore,r.isLeader=this.sq.YV,r.streamId=this.sq.streamId,this.logger.debug(this.loggerId+"MSG uuid "+r.uuid+" rankValue "+r.udpScore+" isLeader "+r.isLeader+" stream id "+r.streamId);var s=h.Framework.setTimeout(function(){i.eq(t.otherGuid)},u.xu.UDPBroadcast.iu);return this.tq.set(t.otherGuid,{hq:s,defer:n}),t.rl(o.Fc.Bc,r),n.promise},E.prototype.eq=function(t){if(this.tq.has(t)){this.logger.debug(this.loggerId+" HANDSHAKE REQ EXPIRED TO "+t);var i=this.tq.get(t);this.tq["delete"](t),i.defer.reject("EXPIRED")}},E.prototype.oq=function(t,i){try{this.logger.debug(this.loggerId+"HANDSHAKE RESP RECEIVED FROM "+i.otherGuid);var n=i.otherGuid,r=this.tq.get(n);h.Framework.clearTimeout(r.hq),this.tq["delete"](n),r.defer.resolve(i)}catch(t){v.ErrorMonitor.getInstance().logError("HANDSHAKE RESPONSE RECEIVED FAILED",this.loggerId,t)}},E.prototype.uq=function(t,i){var n=this;try{var r=new a.yf(a.pf.bf,null,t.isLeader);if(r.guid=t.uuid,r.rankValue=t.udpScore,t.streamId===this.tv.getContextId()){var s=i.il.get(this.GV.swarmId);this.rq.set(t.uuid,t.uuid),this.aq(s,"OK"),this.BV(r,i).then(function(){}).fail(function(t){v.ErrorMonitor.getInstance().logError("LEADER ELECTION FAILED",n.loggerId,t)})}}catch(t){v.ErrorMonitor.getInstance().logError("HANDSHAKE REQUEST FAILED",this.loggerId,t)}},E.prototype.aq=function(t,i){var n=new o.Al.ml.UDPHandshakeResponse();n.accept=i,t.rl(o.Fc.UDPHandshakeResponse,n),this.logger.debug(this.loggerId+"SEND HANDSHAKE RESPONSE TO "+t.otherGuid)},E.prototype.WV=function(t){var i=this,n=f.defer();if(this.fq()){var r=!1;this.logger.info(this.loggerId+"I HAVE THE HIGHEST SCORE"),t.YV&&!this.cq.has(t.uuid)&&(r=!0,this.logger.info(this.loggerId+"SEND SWITCH REQUEST TO "+t.uuid),this.lq(t).then(function(){n.resolve()}).fail(function(t){3==t.vq?(i.logger.debug(i.loggerId+" SWITCH REQUEST WAS CANCELED."),n.resolve()):(t.vq=2)&&n.reject(t)})),this.sq.YV||null==this.dq||this.dq.uuid==t.uuid||this.cq.has(this.dq.uuid)||(this.logger.info("SEND SWITCH REQUEST TO THE ALREADY KNOWN LEADER"),r=!0,this.lq(this.dq).then(function(){n.resolve()}).fail(function(t){3==t.vq?(i.logger.debug(i.loggerId+" SWITCH REQUEST WAS CANCELED."),n.resolve()):(t.vq=2)&&n.reject(t)})),null!=this.dq||t.YV||this.sq.YV||0!=this.cq.length||(this.logger.info(this.loggerId+"BECOME LEADER"),this.Eq()),r||n.resolve()}else this.wq(t)&&(this.logger.info(this.loggerId+"PEER "+t.uuid+" HAS THE HIGHEST SCORE"),this.pq(),this.sq.YV&&t.YV&&this.stepDown(),this.gq(t)),n.resolve();return n.promise},E.prototype.gq=function(t){try{this.logger.info(this.loggerId+"UPDATE THE LEADERSHIP"),null!=this.dq&&this.QV.has(this.dq.uuid)&&(this.QV.get(this.dq.uuid).YV=!1),this.QV.has(t.uuid)?(this.QV.get(t.uuid).udpScore=t.udpScore,this.dq=t,this.QV.get(t.uuid).YV=!0):(this.logger.warn(this.loggerId+"SET A LEADER THAT IS NOT A LAN MEMBER LIST. SHOULD NEVER HAPPEN"),this.QV.set(t.uuid,t),this.dq=t),this.tv.bq(t),this.logger.info(this.loggerId+"NEW KNOWN LEADER "+this.tv.pP().uuid)}catch(t){v.ErrorMonitor.getInstance().logError(t,this.loggerId)}},E.prototype.stepDown=function(){this.logger.info(this.loggerId+"STEP DOWN"),this.sq.YV=!1,this.tv.yq(!1),u.xu.Nu.Eo&&(this.uM.Tq(),this.uM.Oq(!1))},E.prototype.pq=function(){for(var t=0,i=this.cq.keys();t<i.length;t++){var n=i[t],r=this.cq.get(n);this.cq["delete"](n),h.Framework.clearTimeout(r.hq),r.defer.reject({vq:3,message:"CANCELED PENDING RESPONSES"})}},E.prototype.wq=function(t){return t.uuid==this.mq[0].uuid},E.prototype.fq=function(){return l.qV.Ob(this.sq,this.mq[0])<0},E.prototype.KV=function(){var t=new c(this.QV.values()),i=t.Nf(l.qV.Ob);t.push(this.sq),this.tv._q(i);var n=new c(this.QV.values());this.mq=n.Nf(l.qV.Ob)},E.prototype.Rq=function(t){this.Sq(t)},E.prototype.Sq=function(t){this.logger.info(this.loggerId+"EVALUATE THE SWITCH REQUEST FROM "+t.uuid);var i=void 0;this.QV.has(t.uuid)?i=this.QV.get(t.uuid):this.logger.warn("I RECEIVED A SWITCH REQUEST FROM AN UNKNOWN MEMBER. THIS SHOULD NEVER HAPPEN"),i&&(this.sq.YV?this.fq()?this.Aq(i,!1):(this.stepDown(),this.pq(),this.gq(i),this.Aq(i,!0)):this.wq(i)?(this.gq(i),this.Aq(i,!0)):this.Aq(i,!1))},E.prototype.Aq=function(t,i){var n=this;this.Iq(t.$V,i).then(function(){}).fail(function(t){v.ErrorMonitor.getInstance().logError("SEND SWITCH RESPONSE ERROR",n.loggerId,t)}).done()},E.prototype.Iq=function(t,i){var n=f.defer(),r=new o.Al.ml.UDPSwitchLeadershipAck();return r.ok=i,t.il.get(this.GV.swarmId).rl(o.Fc.Vc,r),n.promise},E.prototype.lq=function(i){var n=this,r=f.defer();return this.Nq(i.$V).then(function(t){n.Cq(t,i),r.resolve()}).fail(function(t){r.reject(t)}).done(),r.promise},E.prototype.Cq=function(t,i){try{t?(this.QV.get(i.uuid).YV=!1,this.dq=this.sq,this.Eq()):(this.pq(),this.QV.get(i.uuid).YV=!0,this.stepDown(),this.gq(i))}catch(t){v.ErrorMonitor.getInstance().logError("HANDLE LEADERSHIP SWITCH RESPONSE ERROR",this.loggerId,t)}},E.prototype.kq=function(t,i){if(this.cq.has(i)){var n=this.cq.get(i);h.Framework.clearTimeout(n.hq),this.cq["delete"](i),n.defer.resolve(t.ok)}else this.logger.warn(this.loggerId+" SWITCH LEADERSHIP RESPONSE RECEIVED FROM UNKNOWN PEER "+i)},E.prototype.Nq=function(t){var i=this,n=f.defer(),r=new o.Al.ml.UDPSwitchLeadershipRequest();r.uuid=this.sq.uuid,r.udpScore=this.sq.udpScore,this.logger.debug(this.loggerId+"SWITCH LEADERSHIP REQUEST TO "+t.otherGuid);var s=h.Framework.setTimeout(function(){i.Dq(t.otherGuid)},u.xu.UDPBroadcast.tu);this.cq.set(t.otherGuid,{hq:s,defer:n});var e=t.il.get(this.GV.swarmId);return h.Framework.setTimeout(function(){e.rl(o.Fc.UDPSwitchLeadershipRequest,r)},1),n.promise},E.prototype.Dq=function(t){if(this.cq.has(t)){this.logger.info(this.loggerId+" SWITCH LEADERSHIP EXPIRED TO "+t);var i=this.cq.get(t);this.cq["delete"](t),i.defer.reject({vq:2,message:"EXPIRED"})}},E.prototype.Eq=function(){this.logger.info(this.loggerId+"BECOMING LAN LEADER"),null!=this.dq&&this.QV.has(this.dq.uuid)&&(this.QV.get(this.dq.uuid).YV=!1),this.sq.YV=!0,this.dq=this.sq,this.tv.yq(!0),this.tv.bq(this.sq),u.xu.Nu.Eo&&(this.uM.Tq(),this.uM.Oq(!0))},E.prototype.PS=function(t){this.sq=new l.qV(this.tv.getId(),this.tv.jq(),"",!1,this.tv.getContextId()),this.VV=!0,this.logger.info(this.loggerId+" UDP LEADER ELECTION STARTED")},E.prototype.Mq=function(t){this.QV["delete"](t),this.KV(),0==this.QV.length?(this.sq.YV=!1,this.dq=null,this.tv.yq(!1),this.tv.Pq(!1),this.uM.Tq(),this.uM.Oq(!1)):this.fq()?this.Eq():0<this.mq.length&&this.gq(this.mq[0])},E);function E(){this.VV=!1,this.loggerId="[UDPLeaderElection] ",this.Jc=h.Framework.resolve(h.Framework.v.Zc),this.QV=new s(),this.cq=new s(),this.tq=new s(),this.ZV=new s(),this.rq=new s(),this.mq=[]}i.Lq=d,(r=e=i.Hq||(i.Hq={}))[r.Uq=0]="FAILURE",r[r.iq=1]="ALREADY_PENDING"},function(t,i){},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0}),n(25);var v,e,d,h,o=n(4),u=n(3),E=n(0),w=n(205),p=n(5),a=n(17),f=n(9),c=n(206),l=n(8),g=n(1),b=n(2),y=n(48),T=hive.services.protocol.tracker.TrackerPeerInfo,O=hive.services.protocol.tracker.TrackerPeerStreamInfo,m=l.Y.sf;(e=v=i.Fq||(i.Fq={}))[e.Gq=1]="ACCEPT",e[e.xq=2]="REJECT",(h=d=i.Bq||(i.Bq={}))[h.FV=0]="ALL",h[h.Vq=1]="IN",h[h.qq=2]="OUT";var _,R=(_=c.Qq,s(S,_),S.prototype.init=function(t){_.prototype.init.call(this,t),this.GV=t,this.xV=t.xV,this.uM=t.uM,this.Yq=t.Yq,this.Kq.init(t),this.Wq.init(t)},S.prototype.start=function(t){try{this.logger.info(this.loggerId+"PARTNERSHIP STARTED "+t.getContextId()),this.context=t,this.contextId=t.getContextId(),this.$q(p.xu.mu.Uh),this.Xq(p.xu.Nu.yo),this.zq(p.xu._u.Bh),this.active=!0}catch(t){g.ErrorMonitor.getInstance().logError("Error in partnership initialization",this.loggerId,b.Ni.Ci,t)}},S.prototype.stop=function(){return E.Framework.clearInterval(this.Jq),E.Framework.clearInterval(this.Zq),E.Framework.clearInterval(this.tQ),this.context=null,this.contextId=null,this.active=!1,this.iQ()},S.prototype.PS=function(t){this.logger.info("PARTNERSHIP SERVER CONNECTED"),this.uS=t,this.connected=!0,null==this.tv.getId()&&this.tv.setId(this.uS)},S.prototype.nQ=function(){this.connected=!1},S.prototype.rQ=function(i){try{this.sQ(i)||this.eQ.has(i.peerInfo.guid)||this.ZV.has(i.peerInfo.guid)||i.peerInfo.guid==this.uS?this.hQ(i):this.oQ(i),this.uQ(i)&&this.aQ(i)}catch(t){g.ErrorMonitor.getInstance().logError("Error in discoering new lan peer",this.loggerId,b.Ni.ki,{detailedError:t,otherGuid:i.peerInfo.guid})}},S.prototype.hQ=function(t){if(this.fQ.has(t.peerInfo.guid)){var i=this.fQ.get(t.peerInfo.guid);this.fQ["delete"](t.peerInfo.guid),this.QU.set(t.peerInfo.guid,i),this.tv.Pq(!0)}},S.prototype.aQ=function(t){if(this.VU.has(t.peerInfo.guid)){var i=this.VU.get(t.peerInfo.guid);this.VU["delete"](t.peerInfo.guid),this.qU.set(t.peerInfo.guid,i)}},S.prototype.$q=function(t){var i=this;-1!=this.Jq&&E.Framework.clearInterval(this.Jq),this.Jq=E.Framework.setInterval(function(){i.cQ(!1)},t)},S.prototype.cQ=function(t){var i=this;t&&this.Jq&&(E.Framework.clearInterval(this.Jq),this.$q(p.xu.mu.Uh));try{if(this.connected){this.logger.debug(this.loggerId+"ADDING NEW PEERS IF POSSIBLE, NOW "+this.fQ.length+"/"+p.xu.mu.Hh+","+this.QU.length+"/infinity OUT RND "+this.VU.length+" OUT LAN "+this.qU.length);var n=[].concat(this.eQ.keys()).concat(this.ZV.keys()),r=this.xV.lQ(!0),s=void 0;s=this.tv.zM()||this.tv.lP()?this.Wq.vQ(p.xu.mu.Hh,this.fQ.values(),n,r):this.Kq.vQ(p.xu.mu.Hh,this.fQ.values(),n,r),this.dQ=s.EQ(),s.wQ().forEach(function(t){i.oQ(t)})}else this.logger.warn(this.loggerId+"NOT RUNNING IN PARTNER CHOICE, SRV DISCONNECTED")}catch(t){g.ErrorMonitor.getInstance().logError("Error in choosing in partners",this.loggerId,b.Ni.Di,t)}},S.prototype.oQ=function(s){var e=this,h=s.peerInfo.guid,t=s.peerInfo.privateIpString,i=s.peerInfo.publicIpString;this.logger.debug(this.loggerId+"IN PARTNER ADD PROCESS "+h),this.sQ(s)||this.eQ.has(h)||this.ZV.has(h)||this.Yq.pQ(h,t,i)||(this.ZV.set(h,Date.now()),this.Jc.connect(h).then(function(t){var n=t.il.get(e.GV.swarmId);if(null==n&&(n=t.il.create(e.GV.swarmId)),n){var r=e.ZV.get(h);e.ZV["delete"](h),e.active&&e.gQ(n).then(function(t){if(e.bQ(n,s,t.msg,r),e.TQ.yQ(!1,!1),e.Yq.OQ(h,s.peerInfo.privateIpString,s.peerInfo.publicIpString),e.mQ(n),0<e.dQ.length&&!s._Q()){var i=e.dQ[0];e.RQ(i.guid),i.AQ.SQ(d.qq),e.dQ.splice(0,1)}}).fail(function(t){t&&"NOT ACCEPTED"!=t&&g.ErrorMonitor.getInstance().logError("Error in requesting partnership",e.loggerId,b.Ni.Pi,{otherGuid:h}),e.TQ.yQ(!1,!0),e.IQ(h)})}}).fail(function(t){g.ErrorMonitor.getInstance().logError("Error in creating new p2p connection",e.loggerId,b.Ni.Mi,{otherGuid:h}),e.TQ.yQ(!0,!0),e.ZV["delete"](h),e.xV.Mq(h)}).done())},S.prototype.NQ=function(i,t){var n=this;try{var r=i.guid,s=null,e=null;if(i.privateIpString&&(e=i.privateIpString),i.publicIpString&&(s=i.publicIpString),this.CQ(r))this.logger.info(this.loggerId+"ALREADY OUT PARTNER "+r);else{var h=i.contextId,o=t.il.get(this.GV.swarmId);if(this.contextId!==h||p.xu._u.xh!==i.p2pProtocolVersion||this.Yq.pQ(r,e,s))this.logger.info(this.loggerId+"PARTNERSHIP CANNOT BE ESTABLISHED WITH "+r+" CONTEXT ID "+h+" protocol version "+i.p2pProtocolVersion),this.kQ(o,v.xq);else{var u=this.DQ(i),a=void 0,f=void 0;if(u){if(this.xV.JV([u],!1),!(a=(f=this.xV.jQ(r))._Q()||this.VU.length<p.xu.mu.Gh)){this.logger.debug(this.loggerId+" got out part req from "+r+" - reached max "+this.VU.length+"/"+p.xu.mu.Gh);var c=void 0;(c=this.tv.zM()||this.tv.lP()?this.PQ.MQ(this.tv,u,this.VU.values()):this.LQ.MQ(this.VU.values()))&&(this.logger.debug(this.loggerId+" chocking "+c.guid),this.VU["delete"](c.guid),c.AQ.SQ(d.Vq),a=!0)}}else a=!1;if(a){var l=new w.Partner(r,this.TQ,o,this.logger,!1,f);i.reportingGuid&&l.HQ(i.reportingGuid),this.xV.UQ.has(r)?this.qU.set(r,l):this.VU.set(r,l),this.logger.info(this.loggerId+"ADDED OUT PART "+r),this.kQ(o,v.Gq),this.Yq.OQ(r,e,s),E.Framework.setTimeout(function(){n.FQ(r)},500),this.TQ.GQ()}else this.logger.info(this.loggerId+" cannot establish partnership to "+r+" - reached max "+this.VU.length+"/"+p.xu.mu.Gh),this.kQ(o,v.xq)}}}catch(t){g.ErrorMonitor.getInstance().logError("Error receiving out partnership request",this.loggerId,b.Ni.Li,{detailedError:t,otherGuid:i.guid})}},S.prototype.DQ=function(i){try{var t=new T();t.guid=i.guid,i.internalAs&&(t.internalAs=i.internalAs),i.externalAs&&(t.externalAs=i.externalAs),i.publicIpString&&(t.publicIpString=i.publicIpString),i.privateIpString&&(t.privateIpString=i.privateIpString);var n=!1,r=this.xV.jQ(i.guid);if(r&&(n=r.peerInfo.isLeader),i.streamCharacteristics){var s=[];i.streamCharacteristics.forEach(function(t){var i=new O();i.state=t.streamState,i.bitrate=t.qualityLevel.bitrate,i.qualityLevel=t.qualityLevel.id,i.delta=t.delta,s.push(i)}),t.streams=s}return new f.yf(f.pf.gf,t,n)}catch(t){return g.ErrorMonitor.getInstance().logError("Error constructing discovered peer info",this.loggerId,b.Ni.Hi,{detailedError:t,otherGuid:i.guid}),null}},S.prototype.kQ=function(i,t){var r=this;this.logger.debug(this.loggerId+"SEND PART RESPONSE TO "+i.otherGuid);try{var n=new a.Al.ml.OutPartnershipResponse();if(n.accept=t,n.accept===v.Gq){this.tv.sP()&&(n.internalAs=this.tv.sP()),this.tv.eP()&&(n.externalAs=this.tv.eP()),this.tv.getPublicIp()&&(n.publicIpString=this.tv.getPublicIp()),this.tv.getPrivateIp()&&(n.privateIpString=this.tv.getPrivateIp()),n.reportingGuid=this.tv.getReportingGuid();var s=this.tv.xQ(),e=[];s.forEach(function(t,i){var n=new a.Al.ml.StreamCharacteristics();n.qualityLevel=new a.Al.ml.QualityLevel(),n.qualityLevel.id=t.qualityLevel.id,n.qualityLevel.bitrate=t.qualityLevel.bitrate,n.streamState=t.type,n.delta=null!=r.tv.getDelta()?r.tv.getDelta():-1,e.push(n)}),0<e.length&&n.setStreamCharacteristics(e)}i.rl(a.Fc.xc,n)}catch(t){g.ErrorMonitor.getInstance().logError("Error constructing partnership response message",this.loggerId,b.Ni.Ui,{detailedError:t,otherGuid:i.otherGuid})}},S.prototype.bQ=function(t,i,n,r){var s=t.otherGuid;if(n.externalAs&&(i.peerInfo.externalAs=n.externalAs),n.internalAs&&(i.peerInfo.internalAs=n.internalAs),n.publicIpString&&(i.peerInfo.publicIpString=n.publicIpString),n.privateIpString&&(i.peerInfo.privateIpString=n.privateIpString),n.streamCharacteristics){var e=[];n.streamCharacteristics.forEach(function(t){var i=new O();i.state=t.streamState,i.bitrate=t.qualityLevel.bitrate,i.qualityLevel=t.qualityLevel.id,i.delta=t.delta,e.push(i)}),i.peerInfo.streams=e}try{var h=new w.Partner(s,this.TQ,t,this.logger,!0,i,r);return n.reportingGuid&&(h.reportingGuid=n.reportingGuid,t.receiver.setReportingGuid(n.reportingGuid),t.sender.setReportingGuid(n.reportingGuid)),i.peerInfo.type==f.pf.bf?(this.QU.set(s,h),this.tv.BQ(!0),this.tv.VQ(!0),this.tv.Pq(!0)):(0!=this.tv.eP()&&this.tv.eP()===i.peerInfo.externalAs&&this.tv.BQ(!0),0!=this.tv.sP()&&this.tv.sP()===i.peerInfo.internalAs&&this.tv.VQ(!0),this.fQ.set(s,h)),this.logger.debug(this.loggerId+s+" IS NOW IN PARTNER"),h}catch(t){g.ErrorMonitor.getInstance().logError("Error adding a new partner object in the list",this.loggerId,b.Ni.Fi,{detailedError:t,otherGuid:s})}},S.prototype.Mq=function(i){try{this.logger.info(this.loggerId+"GOT PEER DISC "+i),this.qQ(i)&&(this.logger.info(this.loggerId+"IN PRT DISC "+i),this.RQ(i)),this.CQ(i)&&(this.logger.info(this.loggerId+"OUT PRT DISC "+i),this.VU["delete"](i),this.qU["delete"](i))}catch(t){g.ErrorMonitor.getInstance().logError("Error removing disconected partner from the list",this.loggerId,b.Ni.Gi,{detailedError:t,otherGuid:i})}},S.prototype.RQ=function(i){try{this.logger.debug(this.loggerId+"IN PARTNER REMOVE "+i);var t=this.QQ(i);if(this.eM.YQ(t),this.fQ["delete"](i),this.QU["delete"](i),0<this.QU.length)this.tv.BQ(!0),this.tv.VQ(!0);else{var n=this.tv.sP(),r=this.tv.eP(),s=!1,e=!1;0!=n||0!=r?(this.fQ.forEach(function(t){0<n&&n===t.hP.peerInfo.internalAs&&(s=!0),0<r&&r===t.hP.peerInfo.externalAs&&(e=!0)}),this.tv.VQ(s),this.tv.BQ(e)):(this.tv.VQ(!1),this.tv.BQ(!1))}}catch(t){g.ErrorMonitor.getInstance().logError("Error removing the in partner",this.loggerId,b.Ni.xi,{detailedError:t,otherGuid:i})}},S.prototype.KQ=function(i,t){try{this.logger.debug(this.loggerId+"CLOSE RECEIVED FROM "+i+" TYPE "+d[t.getType()]),t.getType()!=d.FV&&t.getType()!=d.qq||(this.VU.has(i)&&this.VU["delete"](i),this.qU.has(i)&&this.qU["delete"](i)),t.getType()!=d.FV&&t.getType()!=d.Vq||this.RQ(i)}catch(t){g.ErrorMonitor.getInstance().logError("Error when close received",this.loggerId,b.Ni.Bi,{detailedError:t,otherGuid:i})}},S.prototype.gQ=function(i){var r=this,n=o.defer();try{var t=new a.Al.ml.OutPartnershipRequest();t.guid=this.uS,t.contextId=this.contextId,t.p2pProtocolVersion=p.xu._u.xh,t.reportingGuid=this.tv.getReportingGuid(),this.tv.sP()&&(t.internalAs=this.tv.sP()),this.tv.eP()&&(t.externalAs=this.tv.eP()),this.tv.getPrivateIp()&&(t.privateIpString=this.tv.getPrivateIp()),this.tv.getPublicIp()&&(t.publicIpString=this.tv.getPublicIp());var s=this.tv.xQ(),e=[];s.forEach(function(t,i){var n=new a.Al.ml.StreamCharacteristics();n.qualityLevel=new a.Al.ml.QualityLevel(),n.qualityLevel.id=t.qualityLevel.id,n.qualityLevel.bitrate=t.qualityLevel.bitrate,n.streamState=t.type,n.delta=null!=r.tv.getDelta()?r.tv.getDelta():-1,e.push(n)}),0<e.length&&t.setStreamCharacteristics(e),this.logger.debug(this.loggerId+"SEND PART REQ TO "+i.otherGuid+" WITH ID "+t.contextId+" internalAS "+t.internalAs+" externalAs "+t.externalAs+" private ip "+t.privateIpString+" public ip "+t.publicIpString+" rGuid "+this.tv.getReportingGuid());var h=E.Framework.setTimeout(function(){r.WQ(n,i.otherGuid)},p.xu.mu.Lh);this.eQ.set(i.otherGuid,{hq:h,defer:n}),i.rl(a.Fc.Gc,t)}catch(t){g.ErrorMonitor.getInstance().logError("Error sending partnership request",this.loggerId,b.Ni.Vi,{detailedError:t,otherGuid:i.otherGuid}),n.reject(t)}return n.promise},S.prototype.$Q=function(t,i){var n=i.otherGuid,r=this.eQ.get(n);r?(E.Framework.clearTimeout(r.hq),this.eQ["delete"](n),t.accept===v.Gq?r.defer.resolve({transport:i,msg:t}):r.defer.reject("NOT ACCEPTED")):g.ErrorMonitor.getInstance().logError("Error receiving out partnership response from an unknown peer",this.loggerId,b.Ni.Yi,{otherGuid:n})},S.prototype.WQ=function(t,i){if(this.eQ.has(i)){g.ErrorMonitor.getInstance().logError("Error partnership request expired",this.loggerId,b.Ni.qi,{otherGuid:i});var n=this.eQ.get(i);this.eQ["delete"](i),n.defer.reject("EXPIRED")}else g.ErrorMonitor.getInstance().logError("Error partnership request expired for unknown peer",this.loggerId,b.Ni.Qi,{otherGuid:i})},S.prototype.iQ=function(){var i=this,n=o.defer(),r=this.fQ.values();this.QU.forEach(function(t,i){r.push(t)});var t=r.slice().map(function(t){return t.AQ.close()});return o.all(t).then(function(t){n.resolve("resolved")}).fail(function(t){g.ErrorMonitor.getInstance().logError("Error closing partnership",i.loggerId,b.Ni.Ki),n.reject("could not close")}),n.promise},S.prototype.IQ=function(t){this.Jc.disconnect(t)},S.prototype.Xq=function(t){var i=this;-1!=this.Zq&&E.Framework.clearInterval(this.Zq),this.Zq=E.Framework.setInterval(function(){i.XQ()},t)},S.prototype.XQ=function(){try{if(this.tv.aP()&&!this.tv.zM()&&m){var t=this.tv.pP(),i=this.context.wM().getQualityLevel();if(i&&this.qQ(t.uuid)){var n=this.QQ(t.uuid);this.zQ(n.AQ,i)}}}catch(t){g.ErrorMonitor.getInstance().logError("Error announcing quality level",this.loggerId,b.Ni.Wi,t)}},S.prototype.zQ=function(i,t){try{var n=new a.Al.ml.QualityLevelMessage();n.guid=this.uS,n.qualityLevel=new a.Al.ml.QualityLevel(),n.qualityLevel.id=t.id,n.qualityLevel.bitrate=t.bitrate,this.logger.debug(this.loggerId+"ANNOUNCE QUALITY LEVEL "+n.qualityLevel.id+" TO PEER GUID "+i.otherGuid),i.rl(a.Fc.QualityLevelMessage,n)}catch(t){g.ErrorMonitor.getInstance().logError("Error constructing quality level announcement",this.loggerId,b.Ni.$i,{detailedError:t,otherGuid:i.otherGuid})}},S.prototype.JQ=function(i){try{if(this.logger.debug(this.loggerId+"RECEIVED QUALITY LEVEL "+i.qualityLevel.id+" FROM PEER GUID "+i.guid),this.xV.UQ.has(i.getGuid())){var t=y.QualityLevel.from(i.qualityLevel);this.xV.UQ.get(i.guid).ZQ(t),this.uM.tY()}}catch(t){g.ErrorMonitor.getInstance().logError("Error receiving quality level info",this.loggerId,b.Ni.Xi,{detailedError:t,otherGuid:i.guid})}},S.prototype.iY=function(i){try{var t=i.guid,n=this.QQ(t);n&&this.nY(n,i),(n=this.rY(t))&&this.nY(n,i),this.Yq.OQ(t,i.privateIpString,i.publicIpString)}catch(t){g.ErrorMonitor.getInstance().logError("Error receiving peer info",this.loggerId,b.Ni.zi,{detailedError:t,otherGuid:i.guid})}},S.prototype.nY=function(t,i){var n=t.hP.peerInfo;if(i.privateIpString&&(n.privateIpString=i.privateIpString),i.publicIpString&&(n.publicIpString=i.publicIpString),i.externalAs&&(n.externalAs=i.externalAs),i.internalAs&&(n.internalAs=i.internalAs),i.streamCharacteristics){var r=[];i.streamCharacteristics.forEach(function(t){var i=new O();i.bitrate=t.qualityLevel.bitrate,i.qualityLevel=t.qualityLevel.id,i.delta=t.delta,i.state=t.streamState,r.push(i)}),n.streams=r}},S.prototype.zq=function(t){var i=this;this.tQ&&E.Framework.clearInterval(this.tQ),this.tQ=E.Framework.setInterval(function(){i.sY()},t)},S.prototype.sY=function(){var r=this;try{if(this.tv.getPrivateIp()||this.tv.getPublicIp()||this.tv.sP()||this.tv.eP()){var t=this.eY(),n=new a.Al.ml.PeerInfoMessage();n.guid=this.tv.getId(),this.tv.getPrivateIp()&&(n.privateIpString=this.tv.getPrivateIp()),this.tv.getPublicIp()&&(n.publicIpString=this.tv.getPublicIp()),this.tv.eP()&&(n.externalAs=this.tv.eP()),this.tv.sP()&&(n.internalAs=this.tv.sP());var i=this.tv.xQ(),s=[];i.forEach(function(t,i){var n=new a.Al.ml.StreamCharacteristics();n.qualityLevel=new a.Al.ml.QualityLevel(),n.qualityLevel.id=t.qualityLevel.id,n.qualityLevel.bitrate=t.qualityLevel.bitrate,n.streamState=t.type,n.delta=null!=r.tv.getDelta()?r.tv.getDelta():-1,s.push(n)}),0<s.length&&n.setStreamCharacteristics(s),t.forEach(function(t,i){t.AQ.rl(a.Fc.qc,n)})}}catch(t){g.ErrorMonitor.getInstance().logError("Error announcing peer info to all partners",this.loggerId,b.Ni.Ji,t)}},S.prototype.eY=function(){try{var n=new u();return this.VU.forEach(function(t,i){n.has(i)||n.set(i,t)}),this.qU.forEach(function(t,i){n.has(i)||n.set(i,t)}),this.QU.forEach(function(t,i){n.has(i)||n.set(i,t)}),this.fQ.forEach(function(t,i){n.has(i)||n.set(i,t)}),n}catch(t){return g.ErrorMonitor.getInstance().logError("Error collecting all partners",this.loggerId,b.Ni.Zi,t),new u()}},S);function S(){var t=_.call(this)||this;return t.loggerId="[Partnership] ",t.eQ=new u(),t.ZV=new u(),t.Jq=-1,t.Zq=-1,t.tQ=-1,t.connected=!1,t.Jc=E.Framework.resolve(E.Framework.v.Zc),t.Kq=E.Framework.resolve(E.Framework.v.GC),t.LQ=E.Framework.resolve(E.Framework.v.$C),t.Wq=E.Framework.resolve(E.Framework.v.xC),t.PQ=E.Framework.resolve(E.Framework.v.XC),t}i.hY=R},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.oY=!0,s.uY=3e4,s.aY=6e4,s.fY=3e4,s);function s(){}i.cY=r;var e=(h.uu="site",h.au="externalAs",h.fu="availableSendRate",h.cu="remoteAddress",h.lu="localAddress",h);function h(){}i.lY=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var E=n(113),w=n(5),p=n(0),g=n(1),b=n(2),r=(s.prototype.init=function(t){this.tv=t.tv},s.prototype.vQ=function(t,i,n,r){try{var s=[],e=[],h=Math.round(t*(1-w.xu.mu.Fh)),o=Math.max(i.length-h,0),u=t-i.length+o;if(0<o){var a=i.filter(function(t){return!t.AQ.transport.tl()}),f=p.Framework.time(),c=a.filter(function(t){return f-t.vY>w.xu._u.Kh}),l=Math.min(c.length,o);e=this.dY(l,c);var v=[],d=[];e.forEach(function(t){v.push(t.guid),d.push(t.tU.ZH(!1))})}return 0<u&&(s=this.EY(u,i,n,r)),this.logger.debug("[PART] A/R: "+u+"/"+o+" ["+s.map(function(t){return t.peerInfo.guid.substring(0,8)})+"/"+e.map(function(t){return t.guid.substring(0,8)})+"] P:["+i.map(function(t){return t.guid.substring(0,8)})+"] M:["+r.map(function(t){return t.peerInfo.guid.substring(0,8)})+"]"),new E.wY(s,e)}catch(t){return g.ErrorMonitor.getInstance().logError("Error updating in partners",this.eH,b.tn["in"],t),new E.wY([],[])}},s);function s(){this.eH="[BaseInPartnerSelection] ",this.logger=p.Framework.resolve(p.Framework.v.p).log()}i.pY=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.EQ=function(){return this.gY},s.prototype.wQ=function(){return this.bY},s);function s(t,i){this.bY=t,this.gY=i}i.wY=r},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(26),o=n(245),u=n(246),a=(e=h.Plugin,s(f,e),f.prototype.initSession=function(t,i,n){var r=this;return this.yY||this.logger().warn(this.TY+" The HiveOzRequestImplementation was not set on the player. Unable to use the full techs Stats and WebRTC functionalities."),this.closeHiveSession("Starting a new session"),this.OY(i,n),this.resolveTicketPromise(t).timeout(this.options().pluginTimeout,"The plugin timedout after "+this.options().pluginTimeout+" ms.").then(function(t){return r.mY(),t.toHiveSession()},function(t){throw h.logError("Error resolving ticket promise",r.loggerId,h.PR.re,t),r.closeHiveSession(),t})},f.prototype.closeHiveSession=function(t,i){void 0===i&&(i=!0),e.prototype.closeHiveSession.call(this,t,i),this.player=void 0,this.video=void 0,this.yY=!1},f.prototype.getRequestImplementation=function(){return this.yY=!0,u["default"].bind(this)},f.prototype.mY=function(){var t={enter_buffering:this._Y,leave_buffering:this.RY,switchVideoRepresentation:this.SY,error:this.AY,destroyed:{IY:this.NY,CY:!0}},i={loadedmetadata:this.kY,canplay:this.DY,playing:this.jY,pause:this.MY,seek:this.PY,ended:this.LY};this.eventBinder=new o["default"](this,this.player,"addListener"),this.eventBinder.HY(this.video,"addEventListener","removeEventListener"),this.eventBinder.mY(this.player,t),this.eventBinder.mY(this.video,i)},f.prototype._Y=function(){this.logger().debug(this.TY+" buffering start event"),this.onStartBuffering()},f.prototype.RY=function(){this.logger().debug(this.TY+" buffering end event"),this.onEndBuffering()},f.prototype.SY=function(){var t=this.player.getSelectedVideoQuality();this.logger().debug(this.TY+" switchVideoRepresentation event - new quality: "+t)},f.prototype.NY=function(){this.logger().debug(this.TY+" player destroyed event"),this.destroyHivePlugin()},f.prototype.AY=function(t){var i=t.type,n=t.description,r=t.UY;this.logger().debug(this.TY+" player error event - Type: "+i+", description: "+n+(r?", extra: "+JSON.stringify(r):"")),this.onError(i,n)},f.prototype.kY=function(){this.logger().debug(this.TY+" loadedmetadata event"),this.onActivateSession(),this.startPeriodicFeedback(),this.onStartBuffering(!1)},f.prototype.DY=function(){this.logger().debug(this.TY+" canplay event"),this.onEndBuffering()},f.prototype.jY=function(){this.logger().debug(this.TY+" playing event"),this.onEventFeedback(h.PlayerEvents.PLAYING,{currentTime:this.getCurrentTime()})},f.prototype.MY=function(){this.logger().debug(this.TY+" pause event"),this.onEventFeedback(h.PlayerEvents.PAUSED)},f.prototype.PY=function(){this.logger().debug(this.TY+" seek event"),this.onEventFeedback(h.PlayerEvents.SKIP)},f.prototype.LY=function(){this.logger().debug(this.TY+" ended event"),this.onEventFeedback(h.PlayerEvents.STOPPED)},f.prototype.createXMLHttpRequest=function(){try{var t=this.getPotentialSession();return t&&t.supportsXhrInterception()?new h.HiveRequestFactory(this.getPluginId()).createXMLHttpRequest():new XMLHttpRequest()}catch(t){return new XMLHttpRequest()}},f.prototype.getPlayerSource=function(){if(this.FY("player"))return this.player.getMpdUrl()},f.prototype.getCurrentTime=function(){if(this.FY("video"))return Math.round(1e3*this.video.currentTime)},f.prototype.getBufferLen=function(){if(this.FY("video"))return Math.round(1e3*h.BasicUtils.Mc(this.video.currentTime,this.video.buffered))},f.prototype.getWindowSize=function(){return this.FY("video")?{width:this.video.clientWidth,height:this.video.clientHeight}:{width:0,height:0}},f.prototype.isFullscreen=function(){return!!this.FY("video")&&null!=document.fullscreenElement&&document.fullscreenElement==this.video},f.prototype.isLive=function(){return!0},f.prototype.isActive=function(){return Boolean(this.player)},f.prototype.getStreamProtocol=function(){return StreamProtocol.DASH},f.prototype.getPlayerTech=function(){return h.cR.HTML5},f.prototype.getPlayerVersion=function(){return"vFacebookOz"},f.prototype.OY=function(t,i){if(this.player=t,this.video=i,!this.FY("player")||!this.FY("video"))throw new Error(this.TY+" The plugin has to be instantiated with valid player and video elements.")},f.prototype.FY=function(t){return!!this[t]||(h.logError("The plugin is missing a required dependency: '"+t+"' is "+this[t],this.TY,h.PR.ce),!1)},f);function f(){var t=null!==e&&e.apply(this,arguments)||this;return t.TY="[HiveOz]",t.yY=!1,t}window.HiveOz=i.HiveOz=a},function(t,i,n){var d,E,w=n(68),p=n(69),g=0,b=0;t.exports=function(t,i,n){var r=i&&n||0,s=i||[],e=(t=t||{}).GY||d,h=void 0!==t.xY?t.xY:E;if(null==e||null==h){var o=w();null==e&&(e=d=[1|o[0],o[1],o[2],o[3],o[4],o[5]]),null==h&&(h=E=16383&(o[6]<<8|o[7]))}var u=void 0!==t.BY?t.BY:new Date().getTime(),a=void 0!==t.VY?t.VY:b+1,f=u-g+(a-b)/1e4;if(f<0&&void 0===t.xY&&(h=h+1&16383),(f<0||g<u)&&void 0===t.VY&&(a=0),1e4<=a)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");g=u,E=h;var c=(1e4*(268435455&(u+=122192928e5))+(b=a))%4294967296;s[r++]=c>>>24&255,s[r++]=c>>>16&255,s[r++]=c>>>8&255,s[r++]=255&c;var l=u/4294967296*1e4&268435455;s[r++]=l>>>8&255,s[r++]=255&l,s[r++]=l>>>24&15|16,s[r++]=l>>>16&255,s[r++]=h>>>8|128,s[r++]=255&h;for(var v=0;v<6;++v)s[r+v]=e[v];return i||p(s)}},function(t,i,n){var h=n(68),o=n(69);t.exports=function(t,i,n){var r=i&&n||0;"string"==typeof t&&(i="binary"===t?new Array(16):null,t=null);var s=(t=t||{}).random||(t.qY||h)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,i)for(var e=0;e<16;++e)i[r+e]=s[e];return i||o(s)}},function(t,s,e){(function(t){var i=void 0!==t&&t||"undefined"!=typeof self&&self||window,n=Function.prototype.apply;function r(t,i){this.pB=t,this.QY=i}s.setTimeout=function(){return new r(n.call(setTimeout,i,arguments),clearTimeout)},s.setInterval=function(){return new r(n.call(setInterval,i,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(t){t&&t.close()},r.prototype.YY=r.prototype.KY=function(){},r.prototype.close=function(){this.QY.call(i,this.pB)},s.WY=function(t,i){clearTimeout(t.$Y),t.XY=i},s.zY=function(t){clearTimeout(t.$Y),t.XY=-1},s.JY=s.active=function(t){clearTimeout(t.$Y);var i=t.XY;0<=i&&(t.$Y=setTimeout(function(){t.ZY&&t.ZY()},i))},e(118),s.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,s.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,e(56))},function(t,i,n){(function(t,d){!function(n,r){"use strict";if(!n.setImmediate){var s,e,i,h,o=1,u={},a=!1,f=n.document,t=Object.getPrototypeOf&&Object.getPrototypeOf(n);t=t&&t.setTimeout?t:n,s="[object process]"==={}.toString.call(n.process)?function(t){d.Me(function(){l(t)})}:function(){if(n.postMessage&&!n.tK){var t=!0,i=n.onmessage;return n.onmessage=function(){t=!1},n.postMessage("","*"),n.onmessage=i,t}}()?(h="setImmediate$"+Math.random()+"$",n.addEventListener?n.addEventListener("message",v,!1):n.attachEvent("onmessage",v),function(t){n.postMessage(h+t,"*")}):n.MessageChannel?((i=new MessageChannel()).port1.onmessage=function(t){l(t.data)},function(t){i.port2.postMessage(t)}):f&&"onreadystatechange"in f.createElement("script")?(e=f.documentElement,function(t){var i=f.createElement("script");i.onreadystatechange=function(){l(t),i.onreadystatechange=null,e.removeChild(i),i=null},e.appendChild(i)}):function(t){setTimeout(l,0,t)},t.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var i=new Array(arguments.length-1),n=0;n<i.length;n++)i[n]=arguments[n+1];var r={iK:t,nK:i};return u[o]=r,s(o),o++},t.clearImmediate=c}function c(t){delete u[t]}function l(t){if(a)setTimeout(l,0,t);else{var i=u[t];if(i){a=!0;try{!function(t){var i=t.iK,n=t.nK;switch(n.length){case 0:i();break;case 1:i(n[0]);break;case 2:i(n[0],n[1]);break;case 3:i(n[0],n[1],n[2]);break;default:i.apply(r,n)}}(i)}finally{c(t),a=!1}}}}function v(t){t.source===n&&"string"==typeof t.data&&0===t.data.indexOf(h)&&l(+t.data.slice(h.length))}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(56),n(37))},function(t,i){if(!RegExp.escape){var n=/[-[\]{}()*+?.\\^$|,#\s]/g;RegExp.escape=function(t){return t.replace(n,"\\$&")}}},function(t,i,n){"use strict";var r=n(39),s=n(57);function e(){throw new Error("Can't construct. MapChanges is a mixin.")}t.exports=e;Object.prototype.hasOwnProperty;var h=new r(),o=null;e.prototype.rK=function(){return h.has(this)||(o=o||n(58),h.set(this,o())),h.get(this)},e.prototype.sK=function(t){var i=this.rK();return t=t||"",i.has(t)||i.set(t,{Gf:new s(),xf:new s()}),i.get(t)},e.prototype.eK=function(t,i,n){!this.Qf&&this.qf&&this.qf();var r=this.sK(i);(n?r.Gf:r.xf).push(t),Object.defineProperty(this,"BP",{value:!0,writable:!0,configurable:!0,enumerable:!1});var s=this;return function(){s&&(s.hK(t,i,n),s=null)}},e.prototype.hK=function(t,i,n){var r=this.sK(i),s=(n?r.Gf:r.xf).findLast(t);if(!s)throw new Error("Can't remove map change listener: does not exist: token "+JSON.stringify(i));s["delete"]()},e.prototype.qP=function(s,e,h){var t=this.rK(),o="Map"+(h?"WillChange":"Change");t.forEach(function(t,i){if(!t.isActive){var n;t.isActive=!0,n=h?t.Gf:t.xf;var r="handle"+(i.slice(0,1).toUpperCase()+i.slice(1))+o;try{n.forEach(function(t){if(t[r])t[r](e,s,this);else{if(!t.call)throw new Error("Handler "+t+" has no method "+r+" and is not callable");t.call(t,e,s,this)}},this)}finally{t.isActive=!1}}},this)},e.prototype.oK=function(t,i){return this.eK(t,i,!0)},e.prototype.uK=function(t,i){return this.hK(t,i,!0)},e.prototype.VP=function(t,i){return this.qP(t,i,!0)}},function(t,i,n){"use strict";n(10);var r=n(58),s=n(57),e=n(11),h=n(41),c=n(74),o=n(12);Object.prototype.hasOwnProperty;function u(t,i,n,r){if(!(this instanceof u))return new u(t,i,n,r);i=i||Object.equals,n=n||Object.hash,r=r||Function._e,this.Re=i,this.Se=n,this.Ae=r;var s=this;this.aK=new this.fK(null,function(){return new s.cK()}),this.length=0,this.hiveAddEach(t)}(t.exports=u).lK=u,Object.hiveAddEach(u.prototype,e.prototype),Object.hiveAddEach(u.prototype,h.prototype),Object.hiveAddEach(u.prototype,o.prototype),u.prototype.fK=r,u.prototype.cK=s,u.prototype.Ne=function(t){return new this.constructor(t,this.Re,this.Se,this.Ae)},u.prototype.has=function(t){var i=this.Se(t);return this.aK.get(i).has(t)},u.prototype.get=function(t,i){if(i)throw new Error("FastSet#get does not support second argument: equals");var n=this.Se(t),r=this.aK;return r.has(n)?r.get(n).get(t):this.Ae(t)},u.prototype["delete"]=function(t,i){if(i)throw new Error("FastSet#delete does not support second argument: equals");var n=this.Se(t),r=this.aK;if(r.has(n)){var s=r.get(n);if(s["delete"](t))return this.length--,0===s.length&&r["delete"](n),!0}return!1},u.prototype.clear=function(){this.aK.clear(),this.length=0},u.prototype.hiveAdd=function(t){var i=this.Se(t),n=this.aK;return n.has(i)||n.set(i,new this.cK(null,this.Re)),!n.get(i).has(t)&&(n.get(i).hiveAdd(t),this.length++,!0)},u.prototype.reduce=function(n,t){var r=arguments[2],i=this.aK,s=0;return i.reduce(function(t,i){return i.reduce(function(t,i){return n.call(r,t,i,s++,this)},t,this)},t,this)},u.prototype.kf=function(){if(0<this.length)return this.aK.kf().kf()},u.prototype.Df=function(){return this.aK.values().Sf().Df()},u.prototype.log=function(o,u,a,f){o=o||c.EU,u=u||this.Ce,a||(a=emptyFunction,f=console),a=a.bind(f);var r=this.aK,s=r.keys();s.forEach(function(t,i){var n,e;e=i===s.length-1?(n=o.cU," "):(n=0===i?o.aU:o.lU,o.vU);var h=r.get(t);a.call(f,n+o.oU+o.aU+" "+t),h.forEach(function(t,i){var n,r,s;r=i===h.head.RP?(n=o.cU," "):(n=o.lU,o.vU),u(i,function(t){s?a.call(f,e+" "+r+"  "+t):(a.call(f,e+" "+n+o.oU+o.oU+t),s=!0)},function(t){a.call(f,e+" "+o.vU+"  "+t)})})})},u.prototype.Ce=function(t,i){var n=t.value;Object(n)===n?JSON.stringify(n,null,4).split("\n").forEach(function(t){i(" "+t)}):i(" "+n)}},function(t,i,n){"use strict";t.exports=u;var o=n(38),r=n(11);function u(t){if(!(this instanceof u))return new u(t);if(Array.isArray(t)||"string"==typeof t)return u.Df(t);if((t=o(t))instanceof u)return t;if(t.next)this.next=function(){return t.next()};else if(t.Df){var i=t.Df();this.next=function(){return i.next()}}else{if("[object Function]"!==o.prototype.toString.call(t))throw new TypeError("Can't iterate "+t);this.next=t}}u.prototype.forEach=r.prototype.forEach,u.prototype.map=r.prototype.map,u.prototype.filter=r.prototype.filter,u.prototype.every=r.prototype.every,u.prototype.some=r.prototype.some,u.prototype.Th=r.prototype.Th,u.prototype.all=r.prototype.all,u.prototype.min=r.prototype.min,u.prototype.max=r.prototype.max,u.prototype.Ju=r.prototype.Ju,u.prototype.Rf=r.prototype.Rf,u.prototype.Sf=r.prototype.Sf,u.prototype.Af=r.prototype.Af,u.prototype.enumerate=r.prototype.enumerate,u.prototype.Nf=r.prototype.Nf,u.prototype.group=r.prototype.group,u.prototype.reversed=r.prototype.reversed,u.prototype.toArray=r.prototype.toArray,u.prototype.mf=r.prototype.mf,u.prototype.iterator=r.prototype.iterator,u.prototype.PP=null,o.defineProperty(u.prototype,"_iterationObject",{get:function(){return this.PP||(this.PP={done:!1,value:void 0})}}),u.prototype.Ne=function(t){var i=[];return i.hiveAddEach(t),i},u.prototype.vK=function(i){var n=u(this),r=arguments[1],s=0;if("[object Function]"!=o.prototype.toString.call(i))throw new TypeError();return new n.constructor(function(){if(!0!==n.LP.done){var t=i.call(r,n.next().value,s++,n);n.LP.value=t}return n.LP})},u.prototype.dK=function(i){var n=u(this),r=arguments[1],s=0;if("[object Function]"!=o.prototype.toString.call(i))throw new TypeError();return new n.constructor(function(){for(var t;;){if(!0===(t=n.next()).done)return t;if(i.call(r,t.value,s++,n))return t}})},u.prototype.reduce=function(t){var i,n=u(this),r=arguments[1],s=arguments[2],e=0;if("[object Function]"!=o.prototype.toString.call(t))throw new TypeError();if(!0===(i=n.next()).done){if(1<arguments.length)return arguments[1];throw TypeError("cannot reduce a value from an empty iterator with no initial value")}for(r=1<arguments.length?t.call(s,r,i.value,e,n):i.value,e++;;){if(!0===(i=n.next()).done)return r;r=t.call(s,r,i.value,e,n),e++}},u.prototype.concat=function(){return u.concat(Array.prototype.concat.apply(this,arguments))},u.prototype.EK=function(t){var i,n,r=u(this),s=arguments[1],e=!1,h=0;if("[object Function]"!=o.prototype.toString.call(t))throw new TypeError();for(;!0!==(n=r.next()).done;){if(!t.call(s,n.value,h,r)){e=!0,i=n.value;break}h++}return e?r.constructor([i]).concat(r):r.constructor([])},u.prototype.wK=function(i){var n=u(this),r=arguments[1],s=0;if("[object Function]"!=o.prototype.toString.call(i))throw new TypeError();return new n.constructor(function(){if(!0!==n.LP.done){var t=n.next().value;i.call(r,t,s++,n)?n.LP.value=t:(n.LP.done=!0,n.LP.value=void 0)}return n.LP})},u.prototype.pK=function(){return u.If(Array.prototype.concat.apply(this,arguments))},u.prototype.gK=function(t){return u.count(t).pK(this)},u.Df=function(t){var i;return i=0,new u(function(){if("object"==typeof t)for(;!(i in t);){if(i>=t.length){this.LP.done=!0,this.LP.value=void 0;break}i+=1}else i>=t.length&&(this.LP.done=!0,this.LP.value=void 0);return this.LP.done||(this.LP.value=t[i],i+=1),this.LP})},u.bK=function(n,r){var s;return arguments.length<2&&(r=1/0),new u(function(){var t,i;return s&&(i=s()),s&&!0!==i.done||(i=0<r?(r--,t=u.Df(n),(s=t.next.bind(t))()):(this.LP.done=!0,this.LP)),i})},u.concat=function(n){var r;return n=u(n),new u(function(){var t,i;return r&&(i=r()),i&&!0!==i.done?i:!1===(i=n.next()).done?(t=u(i.value),(r=t.next.bind(t))()):i})},u.If=function(r){return 0===(r=u(r).map(u)).length?new u([]):new u(function(){var i,n,t=r.map(function(t){return!0===(n=t.next()).done&&(i=!0),n.value});return i?(this.LP.done=!0,this.LP.value=void 0):this.LP.value=t,this.LP})},u.Af=function(){return u.If(Array.prototype.slice.call(arguments))},u.chain=function(){return u.concat(Array.prototype.slice.call(arguments))},u.range=function(i,n,r){return arguments.length<3&&(r=1),arguments.length<2&&(n=i,i=0),i=i||0,r=r||1,new u(function(){n<=i&&(this.LP.done=!0,this.LP.value=void 0);var t=i;return i+=r,this.LP.value=t,this.LP})},u.count=function(t,i){return u.range(t,1/0,i)},u.repeat=function(t,i){return new u.range(i).vK(function(){return t})}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=(e.prototype.destroy=function(){this.abort(),this.loader=null,this.xhr=null},e.prototype.abort=function(){var t=this.loader||this.xhr;t&&4!==t.readyState&&(this.stats.aborted=!0,t.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},e.prototype.load=function(t,i,n){this.context=t,this.config=i,this.callbacks=n,this.stats={trequest:performance.now(),retry:0},this.retryDelay=i.retryDelay,this.yK()},e.prototype.yK=function(){this.xhr=this.loader=new XMLHttpRequest();var t=this.context,i=this.stats;i.tfirst=0,i.loaded=0,this.xhrSetup?this.xhr=this.xhrSetup(this.xhr,t)||this.xhr:(!1,r.Framework.h()&&(this.xhr=r.Framework.resolve(r.Framework.v.FC)),this.xhr||(this.xhr=new XMLHttpRequest()),this.xhr.open("GET",t.url,!0),t.rangeEnd&&this.xhr.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),this.xhr.responseType=t.responseType),this.xhr.readyState||this.xhr.open("GET",t.url,!0),t.rangeEnd&&this.xhr.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),this.xhr.onreadystatechange=this.readystatechange.bind(this),this.xhr.onprogress=this.loadprogress.bind(this),this.xhr.responseType=t.responseType,this.config.timeout&&(this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout)),this.xhr.send()},e.prototype.readystatechange=function(t){var i=t.currentTarget,n=i.readyState,r=this.stats,s=this.context,e=this.config;if(!r.aborted&&2<=n)if(window.clearTimeout(this.requestTimeout),0===r.tfirst&&(r.tfirst=Math.max(performance.now(),r.trequest)),4===n){var h=i.status,o=i.getAllResponseHeaders()||"";o=o.replace(/[\r\n]{2,}Access-Control-Allow-Origin:\*/,"\naccess-control-allow-origin: *");var u=i.responseURL||i.url,a=i.statusText||(200===h?"OK":""),f=o.trim().split(/[\r\n]+/),c={};if(o&&f.forEach(function(t){var i=t.split(": "),n=i.shift(),r=i.join(": ");c[n]=r}),200<=h&&h<300){r.tload=Math.max(r.tfirst,performance.now());var l=void 0,v=void 0;v="arraybuffer"===s.responseType?(l=i.response).byteLength:(l=i.responseText).length,r.loaded=r.total=v;var d={url:u,code:h,text:a,responseHeaders:o,TK:c,data:l};this.callbacks.onSuccess(d,r,s)}else void 0===e.retryDelay||void 0===e.mK||r.retry>=e._K||400<=h&&h<499?(!1,d={url:u,code:h,text:a,responseHeaders:o,TK:c,data:"arraybuffer"===s.responseType?i.response:i.responseText},this.callbacks.onError(d,s)):(!1,this.destroy(),this.retryTimeout=window.setTimeout(this.yK.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,e.mK),r.retry++)}else e.timeout&&(this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),e.timeout))},e.prototype.loadtimeout=function(){!1,this.callbacks.onTimeout(this.stats,this.context)},e.prototype.loadprogress=function(t){var i=this.stats;i.loaded=t.loaded,t.lengthComputable&&(i.total=t.total);var n=this.callbacks.onProgress;n&&n(i,this.context,null)},e);function e(t){this.loggerId="[HiveXhrLoader] ",(this.RK=t)&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}i.uR=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(27),s=(e.prototype.apply=function(t){t.apply(this.context)},e);function e(t){this.id=t,this.context=new r.F()}i.D=s},function(t,i,n){"use strict";var r;Object.defineProperty(i,"s",{value:!0}),(r=i.IR||(i.IR={}))[r.HiveJS=0]="HiveJS",r[r.HiveJava=1]="HiveJava",r[r.StatsJS=2]="StatsJS";var s=(e.StatsJS="StatsJS",e.HiveJava="HiveJava",e.HiveJS="HiveJS",e);function e(){}i.TechName=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.getInstance=function(){return void 0===this.instance&&(this.instance=new s()),this.instance},s.prototype.J=function(t,i){this.SK.push(t),this.callbacks.push(i)},s.prototype.AK=function(n){for(var t=function(t){var i=!0;r.SK[t].forEach(function(t){null!=n[t]&&n[t]||(i=!1)}),i&&r.callbacks[t]()},r=this,i=0;i<this.SK.length;i++)t(i)},s);function s(){var i=this;if(this.SK=[],this.callbacks=[],s.instance)throw new Error("Error: Instantiation failed: Use KeyHandlerHiveComm.getInstance() instead of new.");var n={};document.addEventListener("keydown",function(t){n[t.keyCode]=!0,i.AK(n)},!0),document.addEventListener("keyup",function(t){n={}},!0)}i.Z=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(Object.defineProperty(s.prototype,"fullscreen",{get:function(){return this._fullscreen},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"totalBuffering",{get:function(){return this._totalBuffering},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bufferLength",{get:function(){return this._bufferLength},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"playingPoint",{get:function(){return this._playingPoint},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"zG",{get:function(){return this._playingTime},enumerable:!0,configurable:!0}),s.prototype.replaceNaNs=function(){isNaN(this.playingPoint)&&(this._playingPoint=0),isNaN(this.bufferLength)&&(this._bufferLength=0),isNaN(this.totalBuffering)&&(this._totalBuffering=0),isNaN(this.zG)&&(this._playingTime=0)},s);function s(t,i,n,r,s,e,h){this._playingPoint=t,this._bufferLength=i,this._totalBuffering=n,this._width=r,this._height=s,this._fullscreen=e,this._playingTime=h,this.replaceNaNs()}i.HivePlayerStats=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.check=function(t){var i=Date.now();return this.isEqual(this.previousStats,t)||(this.lastStatsChange=i),this.previousStats=t,i-this.lastStatsChange>=this.maxPeriod},s.prototype.isEqual=function(t,i){return!(!t||!i)&&[i.playingPoint-t.playingPoint,i.bufferLength-t.bufferLength,i.totalBuffering-t.totalBuffering].reduce(function(t,i){return t&&Math.abs(i)<10},!0)},s);function s(t){this.maxPeriod=t}i.StatsChecker=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.getInstance=function(t){return t&&(this.logger=t),void 0===this.instance&&(this.instance=new s()),this.instance},s.prototype.callListeners=function(){var i=this,n=!document[this.hidden];this.listeners.forEach(function(t){t.call(i,n)})},s.prototype.setVisibilityChangeListener=function(t){this.listeners.push(t)},s.prototype.cleanListeners=function(){document.removeEventListener(this.visibilityChange,this.callListeners,!1),this.listeners.length=0},s);function s(){if(s.instance)throw new Error("Error: Instantiation failed: Use VisibilityChangeListener.getInstance() instead of new.");void 0!==document.hidden?(this.hidden="hidden",this.visibilityChange="visibilitychange"):void 0!==document.msHidden?(this.hidden="msHidden",this.visibilityChange="msvisibilitychange"):void 0!==document.webkitHidden&&(this.hidden="webkitHidden",this.visibilityChange="webkitvisibilitychange"),void 0!==document.addEventListener&&void 0!==document[this.hidden]?document.addEventListener(this.visibilityChange,this.callListeners.bind(this),!1):s.logger&&s.logger.debug("warn - visibilityChange listener not supported"),this.listeners=[]}i.VisibilityChangeListener=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(45),s=n(44),e=n(15),h=n(1),o=(u.prototype.IK=function(){var t=this;this.plugin.options().silent&&(HiveConfig&&(HiveConfig.ConnInfo.detectPrivateIP=!0),void 0===this.NK&&(this.url="//"+r.gv.Ok+":"+this.CK+"/feedback",this.plugin.logger().info("starting periodic alive ping to hive tester ["+this.url+"]"),this.NK=setInterval(function(){t.kK()},s.Rc.yk)))},u.prototype.kK=function(){var i=this,t=this.plugin.getActiveSession(),n=void 0;t&&(n="S["+t.id+"]");var r=this.plugin.getCurrentTime();r>this.DK?(this.plugin.logger().info("sending hive tester ping ["+r+" > "+this.DK+"]"),e.Cc(this.url).then(function(t){},function(t){h.ErrorMonitor.getInstance().logError("error sending hive tester ping",n,{error:t}),clearInterval(i.NK)})):this.plugin.logger().warn("not sending hive tester ping ["+r+" <= "+this.DK+"]"),this.DK=r},u);function u(t){this.CK=s.Rc.wv?9989:9988,this.DK=-1,this.plugin=t,this.IK()}i.MR=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){}i.sS=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){}i.qc=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){}i.hS=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(27),s=n(30),e=n(42),h=n(135),o=(u.prototype.apply=function(t){t.bind(new r.LR(e.v.l,h.jK,r.HR.VR)),t.bind(new r.LR(e.v.p,s.rA))},u);function u(){}i.kR=o},function(t,e,h){"use strict";(function(t){Object.defineProperty(e,"s",{value:!0});var i=h(73),n=h(3),r=(s.prototype.init=function(){this.MK=void 0},s.prototype.T=function(){return!1},s.prototype.PK=function(t,i,n){},s.prototype.M=function(){return null},s.prototype.time=function(){return+new Date()},s.prototype.setTimeout=function(t,i,n){var r=this;void 0===n&&(n=!1);var s=this.LK.setTimeout(function(){r.HK["delete"](s),t(),0===r.HK.length&&r.MK&&(r.MK(),r.MK=void 0)},i);return this.HK.set(s,n),s},s.prototype.clearTimeout=function(t){return this.HK["delete"](t),this.LK.clearTimeout(t),!0},s.prototype.setInterval=function(t,i){var n=this.LK.setInterval(function(){t()},i);return this.UK.hiveAdd(n),n},s.prototype.clearInterval=function(t){return this.UK["delete"](t),this.LK.clearInterval(t),!0},s.prototype.H=function(n,t){var r=this;void 0===n&&(n=!1),void 0===t&&(t=void 0),this.HK.forEach(function(t,i){!n&&t||r.clearTimeout(i)}),this.UK.forEach(function(t){return r.clearInterval(t)}),0===this.HK.length&&t?t():this.MK=t},s);function s(){this.HK=new n(),this.UK=new i(),this.LK=void 0!==t?t:window}e.jK=r}).call(this,h(56))},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r,s,e=n(27),h=n(30),o=n(42),u=n(19),a=n(29),f=n(79),c=n(80),l=n(81),v=n(82),d=n(83),E=n(8),w=n(84),p=n(85),g=n(86),b=n(87),y=n(88),T=E.Y.hf,O=E.Y.vf;T?r=n(89).dG:s=n(91).WG;var m=(_.prototype.apply=function(t){O?(t.bind(new e.LR(o.v.rk,u.Ev,e.HR.VR)),t.bind(new e.LR(o.v.jl,c._F,e.HR.VR))):(t.bind(new e.LR(o.v.rk,u.dv,e.HR.VR)),t.bind(new e.LR(o.v.jl,c.mF,e.HR.VR))),t.bind(new e.LR(o.v.vv,l.CF,e.HR.VR)),t.bind(new e.LR(o.v.Pl,v.GF,e.HR.VR)),t.bind(new e.LR(o.v.p,h.rA,e.HR.VR)),T?t.bind(new e.LR(o.v.jR,r,e.HR.VR)):t.bind(new e.LR(o.v.jR,s,e.HR.VR)),t.bind(new e.LR(o.v.tk,d.VF,e.HR.VR)),"undefined"!=typeof HiveOriginalXMLHttpRequest?t.bind(new e.LR(o.v.FC,HiveOriginalXMLHttpRequest)):t.bind(new e.LR(o.v.FC,XMLHttpRequest)),t.bind(new e.LR(o.v.Xl,f.eU,e.HR.XR)),t.bind(new e.LR(o.v.zl,f.Zl,e.HR.XR)),t.bind(new e.LR(o.v.Jl,a.LS,e.HR.XR)),t.bind(new e.LR(o.v.vk,a.Zl,e.HR.XR)),t.bind(new e.LR(o.v.gk,w.WF,e.HR.XR)),t.bind(new e.LR(o.v.bk,p.zF,e.HR.XR)),t.bind(new e.LR(o.v.nv,g.nG,e.HR.XR)),t.bind(new e.LR(o.v.fk,y.uG,e.HR.XR)),t.bind(new e.LR(o.v.HC,b.rG,e.HR.XR))},_);function _(){}i.DR=m},function(t,i,n){var g=n(22),b=window.hive;void 0===b&&(b=window.hive={}),void 0===b.snapshots&&(b.snapshots={}),b.snapshots.Traffic=function(t){this.reqN=null,this.respFallbackN=null,this.respFallbackErrN=null,this.respP2pN=null,this.reqOtherN=null,this.respFallbackOtherN=null,this.respFallbackOthertErrN=null,this.srcReqN=null,this.srcRespN=null,this.srcRespErrN=null,this.srcReqQt=null,this.srcRespQt=null,this.srcOverQt=null,this.srcOtherReqN=null,this.srcOtherRespN=null,this.srcOtherRespErrN=null,this.srcOtherReqQt=null,this.srcOtherRespQt=null,this.srcOtherOverQt=null,this.p2pSubReqN=null,this.p2pSubRespN=null,this.p2pSubRespPartN=null,this.p2pSubRespErrN=null,this.p2pSubRespExpN=null,this.p2pSubReqQt=null,this.p2pSubRespQt=null,this.p2pDirectQt=null,this.p2pRelayQt=null,this.p2pNatQt=null,this.p2pUdpbQt=null,this.fallAgentRespN=null,this.fallAgentPredHitN=null,this.fallAgentFailedRespN=null,this.fallAgentPredMissN=null,this.fallAgentPredPartialHitN=null,this.fallAgenTrafficSuccessQt=null,this.fallAgenTrafficFailureQt=null,this.p2pAgentPredHitN=null,this.p2pAgentPredMissN=null,this.p2pAgentPredPartialHitN=null,this.p2pAgenTrafficSuccessQt=null,this.p2pAgenTrafficFailureQt=null,this.respP2pOtherN=null,this.lCacheRespN=null,this.lCacheRespQt=null,this.p2pOutSiteLowPrio=null,t&&(void 0!==t.reqN&&null!==t.reqN&&(this.reqN=t.reqN),void 0!==t.respFallbackN&&null!==t.respFallbackN&&(this.respFallbackN=t.respFallbackN),void 0!==t.respFallbackErrN&&null!==t.respFallbackErrN&&(this.respFallbackErrN=t.respFallbackErrN),void 0!==t.respP2pN&&null!==t.respP2pN&&(this.respP2pN=t.respP2pN),void 0!==t.reqOtherN&&null!==t.reqOtherN&&(this.reqOtherN=t.reqOtherN),void 0!==t.respFallbackOtherN&&null!==t.respFallbackOtherN&&(this.respFallbackOtherN=t.respFallbackOtherN),void 0!==t.respFallbackOthertErrN&&null!==t.respFallbackOthertErrN&&(this.respFallbackOthertErrN=t.respFallbackOthertErrN),void 0!==t.srcReqN&&null!==t.srcReqN&&(this.srcReqN=t.srcReqN),void 0!==t.srcRespN&&null!==t.srcRespN&&(this.srcRespN=t.srcRespN),void 0!==t.srcRespErrN&&null!==t.srcRespErrN&&(this.srcRespErrN=t.srcRespErrN),void 0!==t.srcReqQt&&null!==t.srcReqQt&&(this.srcReqQt=t.srcReqQt),void 0!==t.srcRespQt&&null!==t.srcRespQt&&(this.srcRespQt=t.srcRespQt),void 0!==t.srcOverQt&&null!==t.srcOverQt&&(this.srcOverQt=t.srcOverQt),void 0!==t.srcOtherReqN&&null!==t.srcOtherReqN&&(this.srcOtherReqN=t.srcOtherReqN),void 0!==t.srcOtherRespN&&null!==t.srcOtherRespN&&(this.srcOtherRespN=t.srcOtherRespN),void 0!==t.srcOtherRespErrN&&null!==t.srcOtherRespErrN&&(this.srcOtherRespErrN=t.srcOtherRespErrN),void 0!==t.srcOtherReqQt&&null!==t.srcOtherReqQt&&(this.srcOtherReqQt=t.srcOtherReqQt),void 0!==t.srcOtherRespQt&&null!==t.srcOtherRespQt&&(this.srcOtherRespQt=t.srcOtherRespQt),void 0!==t.srcOtherOverQt&&null!==t.srcOtherOverQt&&(this.srcOtherOverQt=t.srcOtherOverQt),void 0!==t.p2pSubReqN&&null!==t.p2pSubReqN&&(this.p2pSubReqN=t.p2pSubReqN),void 0!==t.p2pSubRespN&&null!==t.p2pSubRespN&&(this.p2pSubRespN=t.p2pSubRespN),void 0!==t.p2pSubRespPartN&&null!==t.p2pSubRespPartN&&(this.p2pSubRespPartN=t.p2pSubRespPartN),void 0!==t.p2pSubRespErrN&&null!==t.p2pSubRespErrN&&(this.p2pSubRespErrN=t.p2pSubRespErrN),void 0!==t.p2pSubRespExpN&&null!==t.p2pSubRespExpN&&(this.p2pSubRespExpN=t.p2pSubRespExpN),void 0!==t.p2pSubReqQt&&null!==t.p2pSubReqQt&&(this.p2pSubReqQt=t.p2pSubReqQt),void 0!==t.p2pSubRespQt&&null!==t.p2pSubRespQt&&(this.p2pSubRespQt=t.p2pSubRespQt),void 0!==t.p2pDirectQt&&null!==t.p2pDirectQt&&(this.p2pDirectQt=t.p2pDirectQt),void 0!==t.p2pRelayQt&&null!==t.p2pRelayQt&&(this.p2pRelayQt=t.p2pRelayQt),void 0!==t.p2pNatQt&&null!==t.p2pNatQt&&(this.p2pNatQt=t.p2pNatQt),void 0!==t.p2pUdpbQt&&null!==t.p2pUdpbQt&&(this.p2pUdpbQt=t.p2pUdpbQt),void 0!==t.fallAgentRespN&&null!==t.fallAgentRespN&&(this.fallAgentRespN=t.fallAgentRespN),void 0!==t.fallAgentPredHitN&&null!==t.fallAgentPredHitN&&(this.fallAgentPredHitN=t.fallAgentPredHitN),void 0!==t.fallAgentFailedRespN&&null!==t.fallAgentFailedRespN&&(this.fallAgentFailedRespN=t.fallAgentFailedRespN),void 0!==t.fallAgentPredMissN&&null!==t.fallAgentPredMissN&&(this.fallAgentPredMissN=t.fallAgentPredMissN),void 0!==t.fallAgentPredPartialHitN&&null!==t.fallAgentPredPartialHitN&&(this.fallAgentPredPartialHitN=t.fallAgentPredPartialHitN),void 0!==t.fallAgenTrafficSuccessQt&&null!==t.fallAgenTrafficSuccessQt&&(this.fallAgenTrafficSuccessQt=t.fallAgenTrafficSuccessQt),void 0!==t.fallAgenTrafficFailureQt&&null!==t.fallAgenTrafficFailureQt&&(this.fallAgenTrafficFailureQt=t.fallAgenTrafficFailureQt),void 0!==t.p2pAgentPredHitN&&null!==t.p2pAgentPredHitN&&(this.p2pAgentPredHitN=t.p2pAgentPredHitN),void 0!==t.p2pAgentPredMissN&&null!==t.p2pAgentPredMissN&&(this.p2pAgentPredMissN=t.p2pAgentPredMissN),void 0!==t.p2pAgentPredPartialHitN&&null!==t.p2pAgentPredPartialHitN&&(this.p2pAgentPredPartialHitN=t.p2pAgentPredPartialHitN),void 0!==t.p2pAgenTrafficSuccessQt&&null!==t.p2pAgenTrafficSuccessQt&&(this.p2pAgenTrafficSuccessQt=t.p2pAgenTrafficSuccessQt),void 0!==t.p2pAgenTrafficFailureQt&&null!==t.p2pAgenTrafficFailureQt&&(this.p2pAgenTrafficFailureQt=t.p2pAgenTrafficFailureQt),void 0!==t.respP2pOtherN&&null!==t.respP2pOtherN&&(this.respP2pOtherN=t.respP2pOtherN),void 0!==t.lCacheRespN&&null!==t.lCacheRespN&&(this.lCacheRespN=t.lCacheRespN),void 0!==t.lCacheRespQt&&null!==t.lCacheRespQt&&(this.lCacheRespQt=t.lCacheRespQt),void 0!==t.p2pOutSiteLowPrio&&null!==t.p2pOutSiteLowPrio&&(this.p2pOutSiteLowPrio=t.p2pOutSiteLowPrio))},b.snapshots.Traffic.prototype={},b.snapshots.Traffic.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I32?this.reqN=t.zE().value:t.XE(n);break;case 2:n==g.Type.DOUBLE?this.respFallbackN=t.Rp().value:t.XE(n);break;case 3:n==g.Type.I32?this.respFallbackErrN=t.zE().value:t.XE(n);break;case 4:n==g.Type.DOUBLE?this.respP2pN=t.Rp().value:t.XE(n);break;case 5:n==g.Type.I32?this.reqOtherN=t.zE().value:t.XE(n);break;case 6:n==g.Type.I32?this.respFallbackOtherN=t.zE().value:t.XE(n);break;case 7:n==g.Type.I32?this.respFallbackOthertErrN=t.zE().value:t.XE(n);break;case 8:n==g.Type.I32?this.srcReqN=t.zE().value:t.XE(n);break;case 9:n==g.Type.I32?this.srcRespN=t.zE().value:t.XE(n);break;case 10:n==g.Type.I32?this.srcRespErrN=t.zE().value:t.XE(n);break;case 11:n==g.Type.I64?this.srcReqQt=t._p().value:t.XE(n);break;case 12:n==g.Type.I64?this.srcRespQt=t._p().value:t.XE(n);break;case 13:n==g.Type.I64?this.srcOverQt=t._p().value:t.XE(n);break;case 14:n==g.Type.I32?this.srcOtherReqN=t.zE().value:t.XE(n);break;case 15:n==g.Type.I32?this.srcOtherRespN=t.zE().value:t.XE(n);break;case 16:n==g.Type.I32?this.srcOtherRespErrN=t.zE().value:t.XE(n);break;case 17:n==g.Type.I64?this.srcOtherReqQt=t._p().value:t.XE(n);break;case 18:n==g.Type.I64?this.srcOtherRespQt=t._p().value:t.XE(n);break;case 19:n==g.Type.I64?this.srcOtherOverQt=t._p().value:t.XE(n);break;case 20:n==g.Type.I32?this.p2pSubReqN=t.zE().value:t.XE(n);break;case 21:n==g.Type.I32?this.p2pSubRespN=t.zE().value:t.XE(n);break;case 22:n==g.Type.DOUBLE?this.p2pSubRespPartN=t.Rp().value:t.XE(n);break;case 23:n==g.Type.DOUBLE?this.p2pSubRespErrN=t.Rp().value:t.XE(n);break;case 24:n==g.Type.I32?this.p2pSubRespExpN=t.zE().value:t.XE(n);break;case 25:n==g.Type.I64?this.p2pSubReqQt=t._p().value:t.XE(n);break;case 26:n==g.Type.I64?this.p2pSubRespQt=t._p().value:t.XE(n);break;case 27:n==g.Type.I64?this.p2pDirectQt=t._p().value:t.XE(n);break;case 28:n==g.Type.I64?this.p2pRelayQt=t._p().value:t.XE(n);break;case 29:n==g.Type.I64?this.p2pNatQt=t._p().value:t.XE(n);break;case 30:n==g.Type.I64?this.p2pUdpbQt=t._p().value:t.XE(n);break;case 31:n==g.Type.I32?this.fallAgentRespN=t.zE().value:t.XE(n);break;case 32:n==g.Type.I32?this.fallAgentPredHitN=t.zE().value:t.XE(n);break;case 33:n==g.Type.I32?this.fallAgentFailedRespN=t.zE().value:t.XE(n);break;case 34:n==g.Type.I32?this.fallAgentPredMissN=t.zE().value:t.XE(n);break;case 35:n==g.Type.I32?this.fallAgentPredPartialHitN=t.zE().value:t.XE(n);break;case 36:n==g.Type.I64?this.fallAgenTrafficSuccessQt=t._p().value:t.XE(n);break;case 37:n==g.Type.I64?this.fallAgenTrafficFailureQt=t._p().value:t.XE(n);break;case 38:n==g.Type.I32?this.p2pAgentPredHitN=t.zE().value:t.XE(n);break;case 39:n==g.Type.I32?this.p2pAgentPredMissN=t.zE().value:t.XE(n);break;case 40:n==g.Type.I32?this.p2pAgentPredPartialHitN=t.zE().value:t.XE(n);break;case 41:n==g.Type.I64?this.p2pAgenTrafficSuccessQt=t._p().value:t.XE(n);break;case 42:n==g.Type.I64?this.p2pAgenTrafficFailureQt=t._p().value:t.XE(n);break;case 43:n==g.Type.I32?this.respP2pOtherN=t.zE().value:t.XE(n);break;case 44:n==g.Type.I32?this.lCacheRespN=t.zE().value:t.XE(n);break;case 45:n==g.Type.I64?this.lCacheRespQt=t._p().value:t.XE(n);break;case 46:n==g.Type.I64?this.p2pOutSiteLowPrio=t._p().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.Traffic.prototype.write=function(t){t.tw("Traffic"),null!==this.reqN&&void 0!==this.reqN&&(t.iw("reqN",g.Type.I32,1),t.sw(this.reqN),t.rw()),null!==this.respFallbackN&&void 0!==this.respFallbackN&&(t.iw("respFallbackN",g.Type.DOUBLE,2),t.sp(this.respFallbackN),t.rw()),null!==this.respFallbackErrN&&void 0!==this.respFallbackErrN&&(t.iw("respFallbackErrN",g.Type.I32,3),t.sw(this.respFallbackErrN),t.rw()),null!==this.respP2pN&&void 0!==this.respP2pN&&(t.iw("respP2pN",g.Type.DOUBLE,4),t.sp(this.respP2pN),t.rw()),null!==this.reqOtherN&&void 0!==this.reqOtherN&&(t.iw("reqOtherN",g.Type.I32,5),t.sw(this.reqOtherN),t.rw()),null!==this.respFallbackOtherN&&void 0!==this.respFallbackOtherN&&(t.iw("respFallbackOtherN",g.Type.I32,6),t.sw(this.respFallbackOtherN),t.rw()),null!==this.respFallbackOthertErrN&&void 0!==this.respFallbackOthertErrN&&(t.iw("respFallbackOthertErrN",g.Type.I32,7),t.sw(this.respFallbackOthertErrN),t.rw()),null!==this.srcReqN&&void 0!==this.srcReqN&&(t.iw("srcReqN",g.Type.I32,8),t.sw(this.srcReqN),t.rw()),null!==this.srcRespN&&void 0!==this.srcRespN&&(t.iw("srcRespN",g.Type.I32,9),t.sw(this.srcRespN),t.rw()),null!==this.srcRespErrN&&void 0!==this.srcRespErrN&&(t.iw("srcRespErrN",g.Type.I32,10),t.sw(this.srcRespErrN),t.rw()),null!==this.srcReqQt&&void 0!==this.srcReqQt&&(t.iw("srcReqQt",g.Type.I64,11),t.rp(this.srcReqQt),t.rw()),null!==this.srcRespQt&&void 0!==this.srcRespQt&&(t.iw("srcRespQt",g.Type.I64,12),t.rp(this.srcRespQt),t.rw()),null!==this.srcOverQt&&void 0!==this.srcOverQt&&(t.iw("srcOverQt",g.Type.I64,13),t.rp(this.srcOverQt),t.rw()),null!==this.srcOtherReqN&&void 0!==this.srcOtherReqN&&(t.iw("srcOtherReqN",g.Type.I32,14),t.sw(this.srcOtherReqN),t.rw()),null!==this.srcOtherRespN&&void 0!==this.srcOtherRespN&&(t.iw("srcOtherRespN",g.Type.I32,15),t.sw(this.srcOtherRespN),t.rw()),null!==this.srcOtherRespErrN&&void 0!==this.srcOtherRespErrN&&(t.iw("srcOtherRespErrN",g.Type.I32,16),t.sw(this.srcOtherRespErrN),t.rw()),null!==this.srcOtherReqQt&&void 0!==this.srcOtherReqQt&&(t.iw("srcOtherReqQt",g.Type.I64,17),t.rp(this.srcOtherReqQt),t.rw()),null!==this.srcOtherRespQt&&void 0!==this.srcOtherRespQt&&(t.iw("srcOtherRespQt",g.Type.I64,18),t.rp(this.srcOtherRespQt),t.rw()),null!==this.srcOtherOverQt&&void 0!==this.srcOtherOverQt&&(t.iw("srcOtherOverQt",g.Type.I64,19),t.rp(this.srcOtherOverQt),t.rw()),null!==this.p2pSubReqN&&void 0!==this.p2pSubReqN&&(t.iw("p2pSubReqN",g.Type.I32,20),t.sw(this.p2pSubReqN),t.rw()),null!==this.p2pSubRespN&&void 0!==this.p2pSubRespN&&(t.iw("p2pSubRespN",g.Type.I32,21),t.sw(this.p2pSubRespN),t.rw()),null!==this.p2pSubRespPartN&&void 0!==this.p2pSubRespPartN&&(t.iw("p2pSubRespPartN",g.Type.DOUBLE,22),t.sp(this.p2pSubRespPartN),t.rw()),null!==this.p2pSubRespErrN&&void 0!==this.p2pSubRespErrN&&(t.iw("p2pSubRespErrN",g.Type.DOUBLE,23),t.sp(this.p2pSubRespErrN),t.rw()),null!==this.p2pSubRespExpN&&void 0!==this.p2pSubRespExpN&&(t.iw("p2pSubRespExpN",g.Type.I32,24),t.sw(this.p2pSubRespExpN),t.rw()),null!==this.p2pSubReqQt&&void 0!==this.p2pSubReqQt&&(t.iw("p2pSubReqQt",g.Type.I64,25),t.rp(this.p2pSubReqQt),t.rw()),null!==this.p2pSubRespQt&&void 0!==this.p2pSubRespQt&&(t.iw("p2pSubRespQt",g.Type.I64,26),t.rp(this.p2pSubRespQt),t.rw()),null!==this.p2pDirectQt&&void 0!==this.p2pDirectQt&&(t.iw("p2pDirectQt",g.Type.I64,27),t.rp(this.p2pDirectQt),t.rw()),null!==this.p2pRelayQt&&void 0!==this.p2pRelayQt&&(t.iw("p2pRelayQt",g.Type.I64,28),t.rp(this.p2pRelayQt),t.rw()),null!==this.p2pNatQt&&void 0!==this.p2pNatQt&&(t.iw("p2pNatQt",g.Type.I64,29),t.rp(this.p2pNatQt),t.rw()),null!==this.p2pUdpbQt&&void 0!==this.p2pUdpbQt&&(t.iw("p2pUdpbQt",g.Type.I64,30),t.rp(this.p2pUdpbQt),t.rw()),null!==this.fallAgentRespN&&void 0!==this.fallAgentRespN&&(t.iw("fallAgentRespN",g.Type.I32,31),t.sw(this.fallAgentRespN),t.rw()),null!==this.fallAgentPredHitN&&void 0!==this.fallAgentPredHitN&&(t.iw("fallAgentPredHitN",g.Type.I32,32),t.sw(this.fallAgentPredHitN),t.rw()),null!==this.fallAgentFailedRespN&&void 0!==this.fallAgentFailedRespN&&(t.iw("fallAgentFailedRespN",g.Type.I32,33),t.sw(this.fallAgentFailedRespN),t.rw()),null!==this.fallAgentPredMissN&&void 0!==this.fallAgentPredMissN&&(t.iw("fallAgentPredMissN",g.Type.I32,34),t.sw(this.fallAgentPredMissN),t.rw()),null!==this.fallAgentPredPartialHitN&&void 0!==this.fallAgentPredPartialHitN&&(t.iw("fallAgentPredPartialHitN",g.Type.I32,35),t.sw(this.fallAgentPredPartialHitN),t.rw()),null!==this.fallAgenTrafficSuccessQt&&void 0!==this.fallAgenTrafficSuccessQt&&(t.iw("fallAgenTrafficSuccessQt",g.Type.I64,36),t.rp(this.fallAgenTrafficSuccessQt),t.rw()),null!==this.fallAgenTrafficFailureQt&&void 0!==this.fallAgenTrafficFailureQt&&(t.iw("fallAgenTrafficFailureQt",g.Type.I64,37),t.rp(this.fallAgenTrafficFailureQt),t.rw()),null!==this.p2pAgentPredHitN&&void 0!==this.p2pAgentPredHitN&&(t.iw("p2pAgentPredHitN",g.Type.I32,38),t.sw(this.p2pAgentPredHitN),t.rw()),null!==this.p2pAgentPredMissN&&void 0!==this.p2pAgentPredMissN&&(t.iw("p2pAgentPredMissN",g.Type.I32,39),t.sw(this.p2pAgentPredMissN),t.rw()),null!==this.p2pAgentPredPartialHitN&&void 0!==this.p2pAgentPredPartialHitN&&(t.iw("p2pAgentPredPartialHitN",g.Type.I32,40),t.sw(this.p2pAgentPredPartialHitN),t.rw()),null!==this.p2pAgenTrafficSuccessQt&&void 0!==this.p2pAgenTrafficSuccessQt&&(t.iw("p2pAgenTrafficSuccessQt",g.Type.I64,41),t.rp(this.p2pAgenTrafficSuccessQt),t.rw()),null!==this.p2pAgenTrafficFailureQt&&void 0!==this.p2pAgenTrafficFailureQt&&(t.iw("p2pAgenTrafficFailureQt",g.Type.I64,42),t.rp(this.p2pAgenTrafficFailureQt),t.rw()),null!==this.respP2pOtherN&&void 0!==this.respP2pOtherN&&(t.iw("respP2pOtherN",g.Type.I32,43),t.sw(this.respP2pOtherN),t.rw()),null!==this.lCacheRespN&&void 0!==this.lCacheRespN&&(t.iw("lCacheRespN",g.Type.I32,44),t.sw(this.lCacheRespN),t.rw()),null!==this.lCacheRespQt&&void 0!==this.lCacheRespQt&&(t.iw("lCacheRespQt",g.Type.I64,45),t.rp(this.lCacheRespQt),t.rw()),null!==this.p2pOutSiteLowPrio&&void 0!==this.p2pOutSiteLowPrio&&(t.iw("p2pOutSiteLowPrio",g.Type.I64,46),t.rp(this.p2pOutSiteLowPrio),t.rw()),t.ew(),t.hw()},b.snapshots.FragmentMetadata=function(t){this.url=null,this.size=null,this.duration=null,this.qualityLevelId=null,this.contentType=null,t&&(void 0!==t.url&&null!==t.url&&(this.url=t.url),void 0!==t.size&&null!==t.size&&(this.size=t.size),void 0!==t.duration&&null!==t.duration&&(this.duration=t.duration),void 0!==t.qualityLevelId&&null!==t.qualityLevelId&&(this.qualityLevelId=t.qualityLevelId),void 0!==t.contentType&&null!==t.contentType&&(this.contentType=t.contentType))},b.snapshots.FragmentMetadata.prototype={},b.snapshots.FragmentMetadata.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.STRING?this.url=t.$E().value:t.XE(n);break;case 2:n==g.Type.I32?this.size=t.zE().value:t.XE(n);break;case 3:n==g.Type.I32?this.duration=t.zE().value:t.XE(n);break;case 4:n==g.Type.STRING?this.qualityLevelId=t.$E().value:t.XE(n);break;case 5:n==g.Type.I32?this.contentType=t.zE().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.FragmentMetadata.prototype.write=function(t){t.tw("FragmentMetadata"),null!==this.url&&void 0!==this.url&&(t.iw("url",g.Type.STRING,1),t.nw(this.url),t.rw()),null!==this.size&&void 0!==this.size&&(t.iw("size",g.Type.I32,2),t.sw(this.size),t.rw()),null!==this.duration&&void 0!==this.duration&&(t.iw("duration",g.Type.I32,3),t.sw(this.duration),t.rw()),null!==this.qualityLevelId&&void 0!==this.qualityLevelId&&(t.iw("qualityLevelId",g.Type.STRING,4),t.nw(this.qualityLevelId),t.rw()),null!==this.contentType&&void 0!==this.contentType&&(t.iw("contentType",g.Type.I32,5),t.sw(this.contentType),t.rw()),t.ew(),t.hw()},b.snapshots.QualityLevel=function(t){this.id=null,this.bitrates=null,this.width=null,this.height=null,this.label=null,t&&(void 0!==t.id&&null!==t.id&&(this.id=t.id),void 0!==t.bitrates&&null!==t.bitrates&&(this.bitrates=t.bitrates),void 0!==t.width&&null!==t.width&&(this.width=t.width),void 0!==t.height&&null!==t.height&&(this.height=t.height),void 0!==t.label&&null!==t.label&&(this.label=t.label))},b.snapshots.QualityLevel.prototype={},b.snapshots.QualityLevel.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.STRING?this.id=t.$E().value:t.XE(n);break;case 2:if(n==g.Type.LIST){var s,e;this.bitrates=[];(e=t.wp()).pp,s=e.size;for(var h=0;h<s;++h){var o;o=t.zE().value,this.bitrates.push(o)}t.gp()}else t.XE(n);break;case 3:n==g.Type.I32?this.width=t.zE().value:t.XE(n);break;case 4:n==g.Type.I32?this.height=t.zE().value:t.XE(n);break;case 5:n==g.Type.STRING?this.label=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.QualityLevel.prototype.write=function(t){if(t.tw("QualityLevel"),null!==this.id&&void 0!==this.id&&(t.iw("id",g.Type.STRING,1),t.nw(this.id),t.rw()),null!==this.bitrates&&void 0!==this.bitrates){for(var i in t.iw("bitrates",g.Type.LIST,2),t.$w(g.Type.I32,this.bitrates.length),this.bitrates)this.bitrates.hasOwnProperty(i)&&(i=this.bitrates[i],t.sw(i));t.Xw(),t.rw()}null!==this.width&&void 0!==this.width&&(t.iw("width",g.Type.I32,3),t.sw(this.width),t.rw()),null!==this.height&&void 0!==this.height&&(t.iw("height",g.Type.I32,4),t.sw(this.height),t.rw()),null!==this.label&&void 0!==this.label&&(t.iw("label",g.Type.STRING,5),t.nw(this.label),t.rw()),t.ew(),t.hw()},b.snapshots.Metrics=function(t){this.upBW=null,this.downBW=null,this.memN=null,this.prtInN=null,this.prtOutN=null,this.initVideoBufQt=null,this.videoAvgBufQt=null,this.videoBufQt=null,this.videoBufN=null,this.initAudioBufQt=null,this.audioAvgBufQt=null,this.audioBufQt=null,this.audioBufN=null,this.bitrateUpN=null,this.bitrateDwnN=null,this.delay=null,this.delayEnforcement=null,this.lookupReqEstablished=null,this.lookupReqAccept=null,this.fallbackAvgTp=null,this.srcThroughput=null,this.diskReadTimeout=null,this.diskReadRate=null,this.diskStoreRate=null,this.diskRemoveRate=null,this.diskCacheSize=null,this.clientBufferMs=null,this.lookupTotal=null,this.lookupNotFound=null,this.lookupFailed=null,this.lookupLatency=null,this.trackerFailed=null,this.trackerLatency=null,this.snapshotFailed=null,this.snapshotLatency=null,this.sourceLatency=null,t&&(void 0!==t.upBW&&null!==t.upBW&&(this.upBW=t.upBW),void 0!==t.downBW&&null!==t.downBW&&(this.downBW=t.downBW),void 0!==t.memN&&null!==t.memN&&(this.memN=t.memN),void 0!==t.prtInN&&null!==t.prtInN&&(this.prtInN=t.prtInN),void 0!==t.prtOutN&&null!==t.prtOutN&&(this.prtOutN=t.prtOutN),void 0!==t.initVideoBufQt&&null!==t.initVideoBufQt&&(this.initVideoBufQt=t.initVideoBufQt),void 0!==t.videoAvgBufQt&&null!==t.videoAvgBufQt&&(this.videoAvgBufQt=t.videoAvgBufQt),void 0!==t.videoBufQt&&null!==t.videoBufQt&&(this.videoBufQt=t.videoBufQt),void 0!==t.videoBufN&&null!==t.videoBufN&&(this.videoBufN=t.videoBufN),void 0!==t.initAudioBufQt&&null!==t.initAudioBufQt&&(this.initAudioBufQt=t.initAudioBufQt),void 0!==t.audioAvgBufQt&&null!==t.audioAvgBufQt&&(this.audioAvgBufQt=t.audioAvgBufQt),void 0!==t.audioBufQt&&null!==t.audioBufQt&&(this.audioBufQt=t.audioBufQt),void 0!==t.audioBufN&&null!==t.audioBufN&&(this.audioBufN=t.audioBufN),void 0!==t.bitrateUpN&&null!==t.bitrateUpN&&(this.bitrateUpN=t.bitrateUpN),void 0!==t.bitrateDwnN&&null!==t.bitrateDwnN&&(this.bitrateDwnN=t.bitrateDwnN),void 0!==t.delay&&null!==t.delay&&(this.delay=t.delay),void 0!==t.delayEnforcement&&null!==t.delayEnforcement&&(this.delayEnforcement=t.delayEnforcement),void 0!==t.lookupReqEstablished&&null!==t.lookupReqEstablished&&(this.lookupReqEstablished=t.lookupReqEstablished),void 0!==t.lookupReqAccept&&null!==t.lookupReqAccept&&(this.lookupReqAccept=t.lookupReqAccept),void 0!==t.fallbackAvgTp&&null!==t.fallbackAvgTp&&(this.fallbackAvgTp=t.fallbackAvgTp),void 0!==t.srcThroughput&&null!==t.srcThroughput&&(this.srcThroughput=t.srcThroughput),void 0!==t.diskReadTimeout&&null!==t.diskReadTimeout&&(this.diskReadTimeout=t.diskReadTimeout),void 0!==t.diskReadRate&&null!==t.diskReadRate&&(this.diskReadRate=t.diskReadRate),void 0!==t.diskStoreRate&&null!==t.diskStoreRate&&(this.diskStoreRate=t.diskStoreRate),void 0!==t.diskRemoveRate&&null!==t.diskRemoveRate&&(this.diskRemoveRate=t.diskRemoveRate),void 0!==t.diskCacheSize&&null!==t.diskCacheSize&&(this.diskCacheSize=t.diskCacheSize),void 0!==t.clientBufferMs&&null!==t.clientBufferMs&&(this.clientBufferMs=t.clientBufferMs),void 0!==t.lookupTotal&&null!==t.lookupTotal&&(this.lookupTotal=t.lookupTotal),void 0!==t.lookupNotFound&&null!==t.lookupNotFound&&(this.lookupNotFound=t.lookupNotFound),void 0!==t.lookupFailed&&null!==t.lookupFailed&&(this.lookupFailed=t.lookupFailed),void 0!==t.lookupLatency&&null!==t.lookupLatency&&(this.lookupLatency=t.lookupLatency),void 0!==t.trackerFailed&&null!==t.trackerFailed&&(this.trackerFailed=t.trackerFailed),void 0!==t.trackerLatency&&null!==t.trackerLatency&&(this.trackerLatency=t.trackerLatency),void 0!==t.snapshotFailed&&null!==t.snapshotFailed&&(this.snapshotFailed=t.snapshotFailed),void 0!==t.snapshotLatency&&null!==t.snapshotLatency&&(this.snapshotLatency=t.snapshotLatency),void 0!==t.sourceLatency&&null!==t.sourceLatency&&(this.sourceLatency=t.sourceLatency))},b.snapshots.Metrics.prototype={},b.snapshots.Metrics.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I32?this.upBW=t.zE().value:t.XE(n);break;case 2:n==g.Type.I32?this.downBW=t.zE().value:t.XE(n);break;case 3:n==g.Type.I32?this.memN=t.zE().value:t.XE(n);break;case 4:n==g.Type.I32?this.prtInN=t.zE().value:t.XE(n);break;case 5:n==g.Type.I32?this.prtOutN=t.zE().value:t.XE(n);break;case 6:n==g.Type.I64?this.initVideoBufQt=t._p().value:t.XE(n);break;case 7:n==g.Type.DOUBLE?this.videoAvgBufQt=t.Rp().value:t.XE(n);break;case 8:n==g.Type.I64?this.videoBufQt=t._p().value:t.XE(n);break;case 9:n==g.Type.I32?this.videoBufN=t.zE().value:t.XE(n);break;case 10:n==g.Type.I32?this.initAudioBufQt=t.zE().value:t.XE(n);break;case 11:n==g.Type.DOUBLE?this.audioAvgBufQt=t.Rp().value:t.XE(n);break;case 12:n==g.Type.I64?this.audioBufQt=t._p().value:t.XE(n);break;case 13:n==g.Type.I32?this.audioBufN=t.zE().value:t.XE(n);break;case 14:n==g.Type.I32?this.bitrateUpN=t.zE().value:t.XE(n);break;case 15:n==g.Type.I32?this.bitrateDwnN=t.zE().value:t.XE(n);break;case 16:n==g.Type.I32?this.delay=t.zE().value:t.XE(n);break;case 17:n==g.Type.I32?this.delayEnforcement=t.zE().value:t.XE(n);break;case 18:n==g.Type.I32?this.lookupReqEstablished=t.zE().value:t.XE(n);break;case 19:n==g.Type.I32?this.lookupReqAccept=t.zE().value:t.XE(n);break;case 20:n==g.Type.DOUBLE?this.fallbackAvgTp=t.Rp().value:t.XE(n);break;case 21:n==g.Type.DOUBLE?this.srcThroughput=t.Rp().value:t.XE(n);break;case 22:n==g.Type.I32?this.diskReadTimeout=t.zE().value:t.XE(n);break;case 23:n==g.Type.DOUBLE?this.diskReadRate=t.Rp().value:t.XE(n);break;case 24:n==g.Type.DOUBLE?this.diskStoreRate=t.Rp().value:t.XE(n);break;case 25:n==g.Type.DOUBLE?this.diskRemoveRate=t.Rp().value:t.XE(n);break;case 26:n==g.Type.I64?this.diskCacheSize=t._p().value:t.XE(n);break;case 27:n==g.Type.I32?this.clientBufferMs=t.zE().value:t.XE(n);break;case 28:n==g.Type.I32?this.lookupTotal=t.zE().value:t.XE(n);break;case 29:n==g.Type.I32?this.lookupNotFound=t.zE().value:t.XE(n);break;case 30:n==g.Type.I32?this.lookupFailed=t.zE().value:t.XE(n);break;case 31:n==g.Type.I32?this.lookupLatency=t.zE().value:t.XE(n);break;case 32:n==g.Type.I32?this.trackerFailed=t.zE().value:t.XE(n);break;case 33:n==g.Type.I32?this.trackerLatency=t.zE().value:t.XE(n);break;case 34:n==g.Type.I32?this.snapshotFailed=t.zE().value:t.XE(n);break;case 35:n==g.Type.I32?this.snapshotLatency=t.zE().value:t.XE(n);break;case 36:n==g.Type.I32?this.sourceLatency=t.zE().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.Metrics.prototype.write=function(t){t.tw("Metrics"),null!==this.upBW&&void 0!==this.upBW&&(t.iw("upBW",g.Type.I32,1),t.sw(this.upBW),t.rw()),null!==this.downBW&&void 0!==this.downBW&&(t.iw("downBW",g.Type.I32,2),t.sw(this.downBW),t.rw()),null!==this.memN&&void 0!==this.memN&&(t.iw("memN",g.Type.I32,3),t.sw(this.memN),t.rw()),null!==this.prtInN&&void 0!==this.prtInN&&(t.iw("prtInN",g.Type.I32,4),t.sw(this.prtInN),t.rw()),null!==this.prtOutN&&void 0!==this.prtOutN&&(t.iw("prtOutN",g.Type.I32,5),t.sw(this.prtOutN),t.rw()),null!==this.initVideoBufQt&&void 0!==this.initVideoBufQt&&(t.iw("initVideoBufQt",g.Type.I64,6),t.rp(this.initVideoBufQt),t.rw()),null!==this.videoAvgBufQt&&void 0!==this.videoAvgBufQt&&(t.iw("videoAvgBufQt",g.Type.DOUBLE,7),t.sp(this.videoAvgBufQt),t.rw()),null!==this.videoBufQt&&void 0!==this.videoBufQt&&(t.iw("videoBufQt",g.Type.I64,8),t.rp(this.videoBufQt),t.rw()),null!==this.videoBufN&&void 0!==this.videoBufN&&(t.iw("videoBufN",g.Type.I32,9),t.sw(this.videoBufN),t.rw()),null!==this.initAudioBufQt&&void 0!==this.initAudioBufQt&&(t.iw("initAudioBufQt",g.Type.I32,10),t.sw(this.initAudioBufQt),t.rw()),null!==this.audioAvgBufQt&&void 0!==this.audioAvgBufQt&&(t.iw("audioAvgBufQt",g.Type.DOUBLE,11),t.sp(this.audioAvgBufQt),t.rw()),null!==this.audioBufQt&&void 0!==this.audioBufQt&&(t.iw("audioBufQt",g.Type.I64,12),t.rp(this.audioBufQt),t.rw()),null!==this.audioBufN&&void 0!==this.audioBufN&&(t.iw("audioBufN",g.Type.I32,13),t.sw(this.audioBufN),t.rw()),null!==this.bitrateUpN&&void 0!==this.bitrateUpN&&(t.iw("bitrateUpN",g.Type.I32,14),t.sw(this.bitrateUpN),t.rw()),null!==this.bitrateDwnN&&void 0!==this.bitrateDwnN&&(t.iw("bitrateDwnN",g.Type.I32,15),t.sw(this.bitrateDwnN),t.rw()),null!==this.delay&&void 0!==this.delay&&(t.iw("delay",g.Type.I32,16),t.sw(this.delay),t.rw()),null!==this.delayEnforcement&&void 0!==this.delayEnforcement&&(t.iw("delayEnforcement",g.Type.I32,17),t.sw(this.delayEnforcement),t.rw()),null!==this.lookupReqEstablished&&void 0!==this.lookupReqEstablished&&(t.iw("lookupReqEstablished",g.Type.I32,18),t.sw(this.lookupReqEstablished),t.rw()),null!==this.lookupReqAccept&&void 0!==this.lookupReqAccept&&(t.iw("lookupReqAccept",g.Type.I32,19),t.sw(this.lookupReqAccept),t.rw()),null!==this.fallbackAvgTp&&void 0!==this.fallbackAvgTp&&(t.iw("fallbackAvgTp",g.Type.DOUBLE,20),t.sp(this.fallbackAvgTp),t.rw()),null!==this.srcThroughput&&void 0!==this.srcThroughput&&(t.iw("srcThroughput",g.Type.DOUBLE,21),t.sp(this.srcThroughput),t.rw()),null!==this.diskReadTimeout&&void 0!==this.diskReadTimeout&&(t.iw("diskReadTimeout",g.Type.I32,22),t.sw(this.diskReadTimeout),t.rw()),null!==this.diskReadRate&&void 0!==this.diskReadRate&&(t.iw("diskReadRate",g.Type.DOUBLE,23),t.sp(this.diskReadRate),t.rw()),null!==this.diskStoreRate&&void 0!==this.diskStoreRate&&(t.iw("diskStoreRate",g.Type.DOUBLE,24),t.sp(this.diskStoreRate),t.rw()),null!==this.diskRemoveRate&&void 0!==this.diskRemoveRate&&(t.iw("diskRemoveRate",g.Type.DOUBLE,25),t.sp(this.diskRemoveRate),t.rw()),null!==this.diskCacheSize&&void 0!==this.diskCacheSize&&(t.iw("diskCacheSize",g.Type.I64,26),t.rp(this.diskCacheSize),t.rw()),null!==this.clientBufferMs&&void 0!==this.clientBufferMs&&(t.iw("clientBufferMs",g.Type.I32,27),t.sw(this.clientBufferMs),t.rw()),null!==this.lookupTotal&&void 0!==this.lookupTotal&&(t.iw("lookupTotal",g.Type.I32,28),t.sw(this.lookupTotal),t.rw()),null!==this.lookupNotFound&&void 0!==this.lookupNotFound&&(t.iw("lookupNotFound",g.Type.I32,29),t.sw(this.lookupNotFound),t.rw()),null!==this.lookupFailed&&void 0!==this.lookupFailed&&(t.iw("lookupFailed",g.Type.I32,30),t.sw(this.lookupFailed),t.rw()),null!==this.lookupLatency&&void 0!==this.lookupLatency&&(t.iw("lookupLatency",g.Type.I32,31),t.sw(this.lookupLatency),t.rw()),null!==this.trackerFailed&&void 0!==this.trackerFailed&&(t.iw("trackerFailed",g.Type.I32,32),t.sw(this.trackerFailed),t.rw()),null!==this.trackerLatency&&void 0!==this.trackerLatency&&(t.iw("trackerLatency",g.Type.I32,33),t.sw(this.trackerLatency),t.rw()),null!==this.snapshotFailed&&void 0!==this.snapshotFailed&&(t.iw("snapshotFailed",g.Type.I32,34),t.sw(this.snapshotFailed),t.rw()),null!==this.snapshotLatency&&void 0!==this.snapshotLatency&&(t.iw("snapshotLatency",g.Type.I32,35),t.sw(this.snapshotLatency),t.rw()),null!==this.sourceLatency&&void 0!==this.sourceLatency&&(t.iw("sourceLatency",g.Type.I32,36),t.sw(this.sourceLatency),t.rw()),t.ew(),t.hw()},b.snapshots.PartnerTraffic=function(t){this.p2pSuccReq=null,this.p2pFailReq=null,this.p2pPartReq=null,this.p2pSuccReceived=null,this.p2pSuccReceivedLow=null,this.p2pFailReceived=null,this.p2pSuccResp=null,this.p2pFailResp=null,this.p2pPartResp=null,this.p2pSuccSent=null,this.p2pSuccSentLow=null,this.p2pFailSent=null,t&&(void 0!==t.p2pSuccReq&&null!==t.p2pSuccReq&&(this.p2pSuccReq=t.p2pSuccReq),void 0!==t.p2pFailReq&&null!==t.p2pFailReq&&(this.p2pFailReq=t.p2pFailReq),void 0!==t.p2pPartReq&&null!==t.p2pPartReq&&(this.p2pPartReq=t.p2pPartReq),void 0!==t.p2pSuccReceived&&null!==t.p2pSuccReceived&&(this.p2pSuccReceived=t.p2pSuccReceived),void 0!==t.p2pSuccReceivedLow&&null!==t.p2pSuccReceivedLow&&(this.p2pSuccReceivedLow=t.p2pSuccReceivedLow),void 0!==t.p2pFailReceived&&null!==t.p2pFailReceived&&(this.p2pFailReceived=t.p2pFailReceived),void 0!==t.p2pSuccResp&&null!==t.p2pSuccResp&&(this.p2pSuccResp=t.p2pSuccResp),void 0!==t.p2pFailResp&&null!==t.p2pFailResp&&(this.p2pFailResp=t.p2pFailResp),void 0!==t.p2pPartResp&&null!==t.p2pPartResp&&(this.p2pPartResp=t.p2pPartResp),void 0!==t.p2pSuccSent&&null!==t.p2pSuccSent&&(this.p2pSuccSent=t.p2pSuccSent),void 0!==t.p2pSuccSentLow&&null!==t.p2pSuccSentLow&&(this.p2pSuccSentLow=t.p2pSuccSentLow),void 0!==t.p2pFailSent&&null!==t.p2pFailSent&&(this.p2pFailSent=t.p2pFailSent))},b.snapshots.PartnerTraffic.prototype={},b.snapshots.PartnerTraffic.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I64?this.p2pSuccReq=t._p().value:t.XE(n);break;case 2:n==g.Type.I64?this.p2pFailReq=t._p().value:t.XE(n);break;case 3:n==g.Type.I64?this.p2pPartReq=t._p().value:t.XE(n);break;case 4:n==g.Type.I64?this.p2pSuccReceived=t._p().value:t.XE(n);break;case 5:n==g.Type.I64?this.p2pSuccReceivedLow=t._p().value:t.XE(n);break;case 10:n==g.Type.I64?this.p2pFailReceived=t._p().value:t.XE(n);break;case 6:n==g.Type.I64?this.p2pSuccResp=t._p().value:t.XE(n);break;case 11:n==g.Type.I64?this.p2pFailResp=t._p().value:t.XE(n);break;case 7:n==g.Type.I64?this.p2pPartResp=t._p().value:t.XE(n);break;case 8:n==g.Type.I64?this.p2pSuccSent=t._p().value:t.XE(n);break;case 9:n==g.Type.I64?this.p2pSuccSentLow=t._p().value:t.XE(n);break;case 12:n==g.Type.I64?this.p2pFailSent=t._p().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.PartnerTraffic.prototype.write=function(t){t.tw("PartnerTraffic"),null!==this.p2pSuccReq&&void 0!==this.p2pSuccReq&&(t.iw("p2pSuccReq",g.Type.I64,1),t.rp(this.p2pSuccReq),t.rw()),null!==this.p2pFailReq&&void 0!==this.p2pFailReq&&(t.iw("p2pFailReq",g.Type.I64,2),t.rp(this.p2pFailReq),t.rw()),null!==this.p2pPartReq&&void 0!==this.p2pPartReq&&(t.iw("p2pPartReq",g.Type.I64,3),t.rp(this.p2pPartReq),t.rw()),null!==this.p2pSuccReceived&&void 0!==this.p2pSuccReceived&&(t.iw("p2pSuccReceived",g.Type.I64,4),t.rp(this.p2pSuccReceived),t.rw()),null!==this.p2pSuccReceivedLow&&void 0!==this.p2pSuccReceivedLow&&(t.iw("p2pSuccReceivedLow",g.Type.I64,5),t.rp(this.p2pSuccReceivedLow),t.rw()),null!==this.p2pFailReceived&&void 0!==this.p2pFailReceived&&(t.iw("p2pFailReceived",g.Type.I64,10),t.rp(this.p2pFailReceived),t.rw()),null!==this.p2pSuccResp&&void 0!==this.p2pSuccResp&&(t.iw("p2pSuccResp",g.Type.I64,6),t.rp(this.p2pSuccResp),t.rw()),null!==this.p2pFailResp&&void 0!==this.p2pFailResp&&(t.iw("p2pFailResp",g.Type.I64,11),t.rp(this.p2pFailResp),t.rw()),null!==this.p2pPartResp&&void 0!==this.p2pPartResp&&(t.iw("p2pPartResp",g.Type.I64,7),t.rp(this.p2pPartResp),t.rw()),null!==this.p2pSuccSent&&void 0!==this.p2pSuccSent&&(t.iw("p2pSuccSent",g.Type.I64,8),t.rp(this.p2pSuccSent),t.rw()),null!==this.p2pSuccSentLow&&void 0!==this.p2pSuccSentLow&&(t.iw("p2pSuccSentLow",g.Type.I64,9),t.rp(this.p2pSuccSentLow),t.rw()),null!==this.p2pFailSent&&void 0!==this.p2pFailSent&&(t.iw("p2pFailSent",g.Type.I64,12),t.rp(this.p2pFailSent),t.rw()),t.ew(),t.hw()},b.snapshots.PartnerMetrics=function(t){this.rateReceived=null,this.rateSent=null,this.handshakeDelay=null,t&&(void 0!==t.rateReceived&&null!==t.rateReceived&&(this.rateReceived=t.rateReceived),void 0!==t.rateSent&&null!==t.rateSent&&(this.rateSent=t.rateSent),void 0!==t.handshakeDelay&&null!==t.handshakeDelay&&(this.handshakeDelay=t.handshakeDelay))},b.snapshots.PartnerMetrics.prototype={},b.snapshots.PartnerMetrics.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.DOUBLE?this.rateReceived=t.Rp().value:t.XE(n);break;case 2:n==g.Type.DOUBLE?this.rateSent=t.Rp().value:t.XE(n);break;case 3:n==g.Type.I64?this.handshakeDelay=t._p().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.PartnerMetrics.prototype.write=function(t){t.tw("PartnerMetrics"),null!==this.rateReceived&&void 0!==this.rateReceived&&(t.iw("rateReceived",g.Type.DOUBLE,1),t.sp(this.rateReceived),t.rw()),null!==this.rateSent&&void 0!==this.rateSent&&(t.iw("rateSent",g.Type.DOUBLE,2),t.sp(this.rateSent),t.rw()),null!==this.handshakeDelay&&void 0!==this.handshakeDelay&&(t.iw("handshakeDelay",g.Type.I64,3),t.rp(this.handshakeDelay),t.rw()),t.ew(),t.hw()},b.snapshots.ConnectivityInfo=function(t){this.upBW=null,this.downBW=null,this.externalAs=null,this.internalAs=null,this.publicIp=null,this.privateIp=null,t&&(void 0!==t.upBW&&null!==t.upBW&&(this.upBW=t.upBW),void 0!==t.downBW&&null!==t.downBW&&(this.downBW=t.downBW),void 0!==t.externalAs&&null!==t.externalAs&&(this.externalAs=t.externalAs),void 0!==t.internalAs&&null!==t.internalAs&&(this.internalAs=t.internalAs),void 0!==t.publicIp&&null!==t.publicIp&&(this.publicIp=t.publicIp),void 0!==t.privateIp&&null!==t.privateIp&&(this.privateIp=t.privateIp))},b.snapshots.ConnectivityInfo.prototype={},b.snapshots.ConnectivityInfo.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I32?this.upBW=t.zE().value:t.XE(n);break;case 2:n==g.Type.I32?this.downBW=t.zE().value:t.XE(n);break;case 3:n==g.Type.I32?this.externalAs=t.zE().value:t.XE(n);break;case 4:n==g.Type.I32?this.internalAs=t.zE().value:t.XE(n);break;case 5:n==g.Type.STRING?this.publicIp=t.$E().value:t.XE(n);break;case 6:n==g.Type.STRING?this.privateIp=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.ConnectivityInfo.prototype.write=function(t){t.tw("ConnectivityInfo"),null!==this.upBW&&void 0!==this.upBW&&(t.iw("upBW",g.Type.I32,1),t.sw(this.upBW),t.rw()),null!==this.downBW&&void 0!==this.downBW&&(t.iw("downBW",g.Type.I32,2),t.sw(this.downBW),t.rw()),null!==this.externalAs&&void 0!==this.externalAs&&(t.iw("externalAs",g.Type.I32,3),t.sw(this.externalAs),t.rw()),null!==this.internalAs&&void 0!==this.internalAs&&(t.iw("internalAs",g.Type.I32,4),t.sw(this.internalAs),t.rw()),null!==this.publicIp&&void 0!==this.publicIp&&(t.iw("publicIp",g.Type.STRING,5),t.nw(this.publicIp),t.rw()),null!==this.privateIp&&void 0!==this.privateIp&&(t.iw("privateIp",g.Type.STRING,6),t.nw(this.privateIp),t.rw()),t.ew(),t.hw()},b.snapshots.Partner=function(t){this.connInfo=null,this.traffic=null,this.metrics=null,this.inPart=null,this.outPart=null,this.udp=null,t&&(void 0!==t.connInfo&&null!==t.connInfo&&(this.connInfo=t.connInfo),void 0!==t.traffic&&null!==t.traffic&&(this.traffic=t.traffic),void 0!==t.metrics&&null!==t.metrics&&(this.metrics=t.metrics),void 0!==t.inPart&&null!==t.inPart&&(this.inPart=t.inPart),void 0!==t.outPart&&null!==t.outPart&&(this.outPart=t.outPart),void 0!==t.udp&&null!==t.udp&&(this.udp=t.udp))},b.snapshots.Partner.prototype={},b.snapshots.Partner.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.STRUCT?(this.connInfo=new b.snapshots.ConnectivityInfo(),this.connInfo.read(t)):t.XE(n);break;case 2:n==g.Type.STRUCT?(this.traffic=new b.snapshots.PartnerTraffic(),this.traffic.read(t)):t.XE(n);break;case 3:n==g.Type.STRUCT?(this.metrics=new b.snapshots.PartnerMetrics(),this.metrics.read(t)):t.XE(n);break;case 4:n==g.Type.BOOL?this.inPart=t.Tp().value:t.XE(n);break;case 5:n==g.Type.BOOL?this.outPart=t.Tp().value:t.XE(n);break;case 6:n==g.Type.BOOL?this.udp=t.Tp().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.Partner.prototype.write=function(t){t.tw("Partner"),null!==this.connInfo&&void 0!==this.connInfo&&(t.iw("connInfo",g.Type.STRUCT,1),this.connInfo.write(t),t.rw()),null!==this.traffic&&void 0!==this.traffic&&(t.iw("traffic",g.Type.STRUCT,2),this.traffic.write(t),t.rw()),null!==this.metrics&&void 0!==this.metrics&&(t.iw("metrics",g.Type.STRUCT,3),this.metrics.write(t),t.rw()),null!==this.inPart&&void 0!==this.inPart&&(t.iw("inPart",g.Type.BOOL,4),t.Zw(this.inPart),t.rw()),null!==this.outPart&&void 0!==this.outPart&&(t.iw("outPart",g.Type.BOOL,5),t.Zw(this.outPart),t.rw()),null!==this.udp&&void 0!==this.udp&&(t.iw("udp",g.Type.BOOL,6),t.Zw(this.udp),t.rw()),t.ew(),t.hw()},b.snapshots.StreamInfo=function(t){this.url=null,this.streamType=null,this.streamProtocol=null,this.duration=null,this.qualityLevels=null,t&&(void 0!==t.url&&null!==t.url&&(this.url=t.url),void 0!==t.streamType&&null!==t.streamType&&(this.streamType=t.streamType),void 0!==t.streamProtocol&&null!==t.streamProtocol&&(this.streamProtocol=t.streamProtocol),void 0!==t.duration&&null!==t.duration&&(this.duration=t.duration),void 0!==t.qualityLevels&&null!==t.qualityLevels&&(this.qualityLevels=t.qualityLevels))},b.snapshots.StreamInfo.prototype={},b.snapshots.StreamInfo.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.STRING?this.url=t.$E().value:t.XE(n);break;case 2:n==g.Type.I32?this.streamType=t.zE().value:t.XE(n);break;case 3:n==g.Type.I32?this.streamProtocol=t.zE().value:t.XE(n);break;case 4:n==g.Type.I32?this.duration=t.zE().value:t.XE(n);break;case 5:if(n==g.Type.LIST){var s,e;this.qualityLevels=[];(e=t.wp()).pp,s=e.size;for(var h=0;h<s;++h){var o=null;(o=new b.snapshots.QualityLevel()).read(t),this.qualityLevels.push(o)}t.gp()}else t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.StreamInfo.prototype.write=function(t){if(t.tw("StreamInfo"),null!==this.url&&void 0!==this.url&&(t.iw("url",g.Type.STRING,1),t.nw(this.url),t.rw()),null!==this.streamType&&void 0!==this.streamType&&(t.iw("streamType",g.Type.I32,2),t.sw(this.streamType),t.rw()),null!==this.streamProtocol&&void 0!==this.streamProtocol&&(t.iw("streamProtocol",g.Type.I32,3),t.sw(this.streamProtocol),t.rw()),null!==this.duration&&void 0!==this.duration&&(t.iw("duration",g.Type.I32,4),t.sw(this.duration),t.rw()),null!==this.qualityLevels&&void 0!==this.qualityLevels){for(var i in t.iw("qualityLevels",g.Type.LIST,5),t.$w(g.Type.STRUCT,this.qualityLevels.length),this.qualityLevels)this.qualityLevels.hasOwnProperty(i)&&(i=this.qualityLevels[i]).write(t);t.Xw(),t.rw()}t.ew(),t.hw()},b.snapshots.ClientInfo=function(t){this.clientType=null,this.majorVersion=null,this.minorVersion=null,this.patchVersion=null,t&&(void 0!==t.clientType&&null!==t.clientType&&(this.clientType=t.clientType),void 0!==t.majorVersion&&null!==t.majorVersion&&(this.majorVersion=t.majorVersion),void 0!==t.minorVersion&&null!==t.minorVersion&&(this.minorVersion=t.minorVersion),void 0!==t.patchVersion&&null!==t.patchVersion&&(this.patchVersion=t.patchVersion))},b.snapshots.ClientInfo.prototype={},b.snapshots.ClientInfo.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I32?this.clientType=t.zE().value:t.XE(n);break;case 2:n==g.Type.BYTE?this.majorVersion=t.Op().value:t.XE(n);break;case 3:n==g.Type.BYTE?this.minorVersion=t.Op().value:t.XE(n);break;case 4:n==g.Type.I16?this.patchVersion=t.mp().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.ClientInfo.prototype.write=function(t){t.tw("ClientInfo"),null!==this.clientType&&void 0!==this.clientType&&(t.iw("clientType",g.Type.I32,1),t.sw(this.clientType),t.rw()),null!==this.majorVersion&&void 0!==this.majorVersion&&(t.iw("majorVersion",g.Type.BYTE,2),t.tp(this.majorVersion),t.rw()),null!==this.minorVersion&&void 0!==this.minorVersion&&(t.iw("minorVersion",g.Type.BYTE,3),t.tp(this.minorVersion),t.rw()),null!==this.patchVersion&&void 0!==this.patchVersion&&(t.iw("patchVersion",g.Type.I16,4),t.np(this.patchVersion),t.rw()),t.ew(),t.hw()},b.snapshots.AgentInfo=function(t){this.firstTierBitrates=null,this.secondTierBitrates=null,t&&(void 0!==t.firstTierBitrates&&null!==t.firstTierBitrates&&(this.firstTierBitrates=t.firstTierBitrates),void 0!==t.secondTierBitrates&&null!==t.secondTierBitrates&&(this.secondTierBitrates=t.secondTierBitrates))},b.snapshots.AgentInfo.prototype={},b.snapshots.AgentInfo.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:if(n==g.Type.SET){var s,e;this.firstTierBitrates=[];(e=t.bp()).pp,s=e.size;for(var h=0;h<s;++h){var o;o=t.zE().value,this.firstTierBitrates.push(o)}t.yp()}else t.XE(n);break;case 2:if(n==g.Type.SET){var u,a;this.secondTierBitrates=[];(a=t.bp()).pp,u=a.size;for(var f=0;f<u;++f){var c;c=t.zE().value,this.secondTierBitrates.push(c)}t.yp()}else t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.AgentInfo.prototype.write=function(t){if(t.tw("AgentInfo"),null!==this.firstTierBitrates&&void 0!==this.firstTierBitrates){for(var i in t.iw("firstTierBitrates",g.Type.SET,1),t.zw(g.Type.I32,this.firstTierBitrates.length),this.firstTierBitrates)this.firstTierBitrates.hasOwnProperty(i)&&(i=this.firstTierBitrates[i],t.sw(i));t.Jw(),t.rw()}if(null!==this.secondTierBitrates&&void 0!==this.secondTierBitrates){for(var n in t.iw("secondTierBitrates",g.Type.SET,2),t.zw(g.Type.I32,this.secondTierBitrates.length),this.secondTierBitrates)this.secondTierBitrates.hasOwnProperty(n)&&(n=this.secondTierBitrates[n],t.sw(n));t.Jw(),t.rw()}t.ew(),t.hw()},b.snapshots.TrafficKey=function(t){this.bitrate=null,this.AS=null,this.partnerGuid=null,this.qualityLevelId=null,t&&(void 0!==t.bitrate&&null!==t.bitrate&&(this.bitrate=t.bitrate),void 0!==t.AS&&null!==t.AS&&(this.AS=t.AS),void 0!==t.partnerGuid&&null!==t.partnerGuid&&(this.partnerGuid=t.partnerGuid),void 0!==t.qualityLevelId&&null!==t.qualityLevelId&&(this.qualityLevelId=t.qualityLevelId))},b.snapshots.TrafficKey.prototype={},b.snapshots.TrafficKey.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I32?this.bitrate=t.zE().value:t.XE(n);break;case 2:n==g.Type.I32?this.AS=t.zE().value:t.XE(n);break;case 3:n==g.Type.STRING?this.partnerGuid=t.$E().value:t.XE(n);break;case 4:n==g.Type.STRING?this.qualityLevelId=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.TrafficKey.prototype.write=function(t){t.tw("TrafficKey"),null!==this.bitrate&&void 0!==this.bitrate&&(t.iw("bitrate",g.Type.I32,1),t.sw(this.bitrate),t.rw()),null!==this.AS&&void 0!==this.AS&&(t.iw("AS",g.Type.I32,2),t.sw(this.AS),t.rw()),null!==this.partnerGuid&&void 0!==this.partnerGuid&&(t.iw("partnerGuid",g.Type.STRING,3),t.nw(this.partnerGuid),t.rw()),null!==this.qualityLevelId&&void 0!==this.qualityLevelId&&(t.iw("qualityLevelId",g.Type.STRING,4),t.nw(this.qualityLevelId),t.rw()),t.ew(),t.hw()},b.snapshots.PartnerKey=function(t){this.bitrate=null,this.AS=null,this.partnerGuid=null,this.qualityLevelId=null,t&&(void 0!==t.bitrate&&null!==t.bitrate&&(this.bitrate=t.bitrate),void 0!==t.AS&&null!==t.AS&&(this.AS=t.AS),void 0!==t.partnerGuid&&null!==t.partnerGuid&&(this.partnerGuid=t.partnerGuid),void 0!==t.qualityLevelId&&null!==t.qualityLevelId&&(this.qualityLevelId=t.qualityLevelId))},b.snapshots.PartnerKey.prototype={},b.snapshots.PartnerKey.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I32?this.bitrate=t.zE().value:t.XE(n);break;case 2:n==g.Type.I32?this.AS=t.zE().value:t.XE(n);break;case 3:n==g.Type.STRING?this.partnerGuid=t.$E().value:t.XE(n);break;case 4:n==g.Type.STRING?this.qualityLevelId=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.PartnerKey.prototype.write=function(t){t.tw("PartnerKey"),null!==this.bitrate&&void 0!==this.bitrate&&(t.iw("bitrate",g.Type.I32,1),t.sw(this.bitrate),t.rw()),null!==this.AS&&void 0!==this.AS&&(t.iw("AS",g.Type.I32,2),t.sw(this.AS),t.rw()),null!==this.partnerGuid&&void 0!==this.partnerGuid&&(t.iw("partnerGuid",g.Type.STRING,3),t.nw(this.partnerGuid),t.rw()),null!==this.qualityLevelId&&void 0!==this.qualityLevelId&&(t.iw("qualityLevelId",g.Type.STRING,4),t.nw(this.qualityLevelId),t.rw()),t.ew(),t.hw()},b.snapshots.Player=function(t){this.bufferingN=null,this.bufferingMs=null,this.initBufferingN=null,this.initBufferingMs=null,this.seekBufferingN=null,this.seekBufferingMs=null,this.playerBufferMs=null,this.playingTimeMs=null,t&&(void 0!==t.bufferingN&&null!==t.bufferingN&&(this.bufferingN=t.bufferingN),void 0!==t.bufferingMs&&null!==t.bufferingMs&&(this.bufferingMs=t.bufferingMs),void 0!==t.initBufferingN&&null!==t.initBufferingN&&(this.initBufferingN=t.initBufferingN),void 0!==t.initBufferingMs&&null!==t.initBufferingMs&&(this.initBufferingMs=t.initBufferingMs),void 0!==t.seekBufferingN&&null!==t.seekBufferingN&&(this.seekBufferingN=t.seekBufferingN),void 0!==t.seekBufferingMs&&null!==t.seekBufferingMs&&(this.seekBufferingMs=t.seekBufferingMs),void 0!==t.playerBufferMs&&null!==t.playerBufferMs&&(this.playerBufferMs=t.playerBufferMs),void 0!==t.playingTimeMs&&null!==t.playingTimeMs&&(this.playingTimeMs=t.playingTimeMs))},b.snapshots.Player.prototype={},b.snapshots.Player.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I16?this.bufferingN=t.mp().value:t.XE(n);break;case 2:n==g.Type.I32?this.bufferingMs=t.zE().value:t.XE(n);break;case 3:n==g.Type.I16?this.initBufferingN=t.mp().value:t.XE(n);break;case 4:n==g.Type.I32?this.initBufferingMs=t.zE().value:t.XE(n);break;case 5:n==g.Type.I16?this.seekBufferingN=t.mp().value:t.XE(n);break;case 6:n==g.Type.I32?this.seekBufferingMs=t.zE().value:t.XE(n);break;case 36:n==g.Type.I32?this.playerBufferMs=t.zE().value:t.XE(n);break;case 37:n==g.Type.I32?this.playingTimeMs=t.zE().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.Player.prototype.write=function(t){t.tw("Player"),null!==this.bufferingN&&void 0!==this.bufferingN&&(t.iw("bufferingN",g.Type.I16,1),t.np(this.bufferingN),t.rw()),null!==this.bufferingMs&&void 0!==this.bufferingMs&&(t.iw("bufferingMs",g.Type.I32,2),t.sw(this.bufferingMs),t.rw()),null!==this.initBufferingN&&void 0!==this.initBufferingN&&(t.iw("initBufferingN",g.Type.I16,3),t.np(this.initBufferingN),t.rw()),null!==this.initBufferingMs&&void 0!==this.initBufferingMs&&(t.iw("initBufferingMs",g.Type.I32,4),t.sw(this.initBufferingMs),t.rw()),null!==this.seekBufferingN&&void 0!==this.seekBufferingN&&(t.iw("seekBufferingN",g.Type.I16,5),t.np(this.seekBufferingN),t.rw()),null!==this.seekBufferingMs&&void 0!==this.seekBufferingMs&&(t.iw("seekBufferingMs",g.Type.I32,6),t.sw(this.seekBufferingMs),t.rw()),null!==this.playerBufferMs&&void 0!==this.playerBufferMs&&(t.iw("playerBufferMs",g.Type.I32,36),t.sw(this.playerBufferMs),t.rw()),null!==this.playingTimeMs&&void 0!==this.playingTimeMs&&(t.iw("playingTimeMs",g.Type.I32,37),t.sw(this.playingTimeMs),t.rw()),t.ew(),t.hw()},b.snapshots.ResponseInfo=function(t){this.statusCode=null,this.count=null,t&&(void 0!==t.statusCode&&null!==t.statusCode&&(this.statusCode=t.statusCode),void 0!==t.count&&null!==t.count&&(this.count=t.count))},b.snapshots.ResponseInfo.prototype={},b.snapshots.ResponseInfo.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I16?this.statusCode=t.mp().value:t.XE(n);break;case 2:n==g.Type.I32?this.count=t.zE().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.ResponseInfo.prototype.write=function(t){t.tw("ResponseInfo"),null!==this.statusCode&&void 0!==this.statusCode&&(t.iw("statusCode",g.Type.I16,1),t.np(this.statusCode),t.rw()),null!==this.count&&void 0!==this.count&&(t.iw("count",g.Type.I32,2),t.sw(this.count),t.rw()),t.ew(),t.hw()},b.snapshots.ServiceResponseInfo=function(t){this.source=null,t&&void 0!==t.source&&null!==t.source&&(this.source=g.Mp(t.source,[b.snapshots.ResponseInfo]))},b.snapshots.ServiceResponseInfo.prototype={},b.snapshots.ServiceResponseInfo.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:if(n==g.Type.LIST){var s,e;this.source=[];(e=t.wp()).pp,s=e.size;for(var h=0;h<s;++h){var o=null;(o=new b.snapshots.ResponseInfo()).read(t),this.source.push(o)}t.gp()}else t.XE(n);break;case 0:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.ServiceResponseInfo.prototype.write=function(t){if(t.tw("ServiceResponseInfo"),null!==this.source&&void 0!==this.source){for(var i in t.iw("source",g.Type.LIST,1),t.$w(g.Type.STRUCT,this.source.length),this.source)this.source.hasOwnProperty(i)&&(i=this.source[i]).write(t);t.Xw(),t.rw()}t.ew(),t.hw()},b.snapshots.MetricSnapshot=function(t){this.timestamp=null,this.guid=null,this.eventId=null,this.streamInfo=null,this.metrics=null,this.traffic=null,this.snapshotInfo=null,this.agentInfo=null,this.connInfo=null,this.partners=null,this.player=null,this.client=null,this.sessionId=null,this.responseInfo=null,this.testInfo=null,this.clientId=null,this.fragments=null,t&&(void 0!==t.timestamp&&null!==t.timestamp&&(this.timestamp=t.timestamp),void 0!==t.guid&&null!==t.guid&&(this.guid=t.guid),void 0!==t.eventId&&null!==t.eventId&&(this.eventId=t.eventId),void 0!==t.streamInfo&&null!==t.streamInfo&&(this.streamInfo=t.streamInfo),void 0!==t.metrics&&null!==t.metrics&&(this.metrics=t.metrics),void 0!==t.traffic&&null!==t.traffic&&(this.traffic=t.traffic),void 0!==t.snapshotInfo&&null!==t.snapshotInfo&&(this.snapshotInfo=t.snapshotInfo),void 0!==t.agentInfo&&null!==t.agentInfo&&(this.agentInfo=t.agentInfo),void 0!==t.connInfo&&null!==t.connInfo&&(this.connInfo=t.connInfo),void 0!==t.partners&&null!==t.partners&&(this.partners=t.partners),void 0!==t.player&&null!==t.player&&(this.player=t.player),void 0!==t.client&&null!==t.client&&(this.client=t.client),void 0!==t.sessionId&&null!==t.sessionId&&(this.sessionId=t.sessionId),void 0!==t.responseInfo&&null!==t.responseInfo&&(this.responseInfo=t.responseInfo),void 0!==t.testInfo&&null!==t.testInfo&&(this.testInfo=t.testInfo),void 0!==t.clientId&&null!==t.clientId&&(this.clientId=t.clientId),void 0!==t.fragments&&null!==t.fragments&&(this.fragments=t.fragments))},b.snapshots.MetricSnapshot.prototype={},b.snapshots.MetricSnapshot.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I64?this.timestamp=t._p().value:t.XE(n);break;case 2:n==g.Type.STRING?this.guid=t.$E().value:t.XE(n);break;case 3:n==g.Type.STRUCT?(this.eventId=new EventId(),this.eventId.read(t)):t.XE(n);break;case 4:n==g.Type.STRUCT?(this.streamInfo=new b.snapshots.StreamInfo(),this.streamInfo.read(t)):t.XE(n);break;case 5:n==g.Type.STRUCT?(this.metrics=new b.snapshots.Metrics(),this.metrics.read(t)):t.XE(n);break;case 6:if(n==g.Type.MAP){var s,e;this.traffic={};(e=t.lp()).vp,e.dp,s=e.size;for(var h=0;h<s;++h){0<h&&t.hp.length>t.aw[t.aw.length-1]+1&&t.hp.pop();var o=null,u=null;(o=new b.snapshots.TrafficKey()).read(t),(u=new b.snapshots.Traffic()).read(t),this.traffic[o]=u}t.Ep()}else t.XE(n);break;case 7:n==g.Type.STRUCT?(this.snapshotInfo=new SnapshotInfo(),this.snapshotInfo.read(t)):t.XE(n);break;case 8:n==g.Type.STRUCT?(this.agentInfo=new b.snapshots.AgentInfo(),this.agentInfo.read(t)):t.XE(n);break;case 9:n==g.Type.STRUCT?(this.connInfo=new b.snapshots.ConnectivityInfo(),this.connInfo.read(t)):t.XE(n);break;case 10:if(n==g.Type.MAP){var a,f;this.partners={};(f=t.lp()).vp,f.dp,a=f.size;for(var c=0;c<a;++c){0<c&&t.hp.length>t.aw[t.aw.length-1]+1&&t.hp.pop();var l=null,v=null;(l=new b.snapshots.PartnerKey()).read(t),(v=new b.snapshots.Partner()).read(t),this.partners[l]=v}t.Ep()}else t.XE(n);break;case 11:n==g.Type.STRUCT?(this.player=new b.snapshots.Player(),this.player.read(t)):t.XE(n);break;case 12:n==g.Type.STRUCT?(this.client=new b.snapshots.ClientInfo(),this.client.read(t)):t.XE(n);break;case 13:n==g.Type.STRING?this.sessionId=t.$E().value:t.XE(n);break;case 14:n==g.Type.STRUCT?(this.responseInfo=new b.snapshots.ServiceResponseInfo(),this.responseInfo.read(t)):t.XE(n);break;case 15:n==g.Type.STRUCT?(this.testInfo=new TestInfo(),this.testInfo.read(t)):t.XE(n);break;case 16:n==g.Type.I64?this.clientId=t._p().value:t.XE(n);break;case 17:if(n==g.Type.LIST){var d,E;this.fragments=[];(E=t.wp()).pp,d=E.size;for(var w=0;w<d;++w){var p=null;(p=new b.snapshots.FragmentMetadata()).read(t),this.fragments.push(p)}t.gp()}else t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.MetricSnapshot.prototype.write=function(t){if(t.tw("MetricSnapshot"),null!==this.timestamp&&void 0!==this.timestamp&&(t.iw("timestamp",g.Type.I64,1),t.rp(this.timestamp),t.rw()),null!==this.guid&&void 0!==this.guid&&(t.iw("guid",g.Type.STRING,2),t.nw(this.guid),t.rw()),null!==this.eventId&&void 0!==this.eventId&&(t.iw("eventId",g.Type.STRUCT,3),this.eventId.write(t),t.rw()),null!==this.streamInfo&&void 0!==this.streamInfo&&(t.iw("streamInfo",g.Type.STRUCT,4),this.streamInfo.write(t),t.rw()),null!==this.metrics&&void 0!==this.metrics&&(t.iw("metrics",g.Type.STRUCT,5),this.metrics.write(t),t.rw()),null!==this.traffic&&void 0!==this.traffic){for(var i in t.iw("traffic",g.Type.MAP,6),t.Kw(g.Type.STRUCT,g.Type.STRUCT,g.kE(this.traffic)),this.traffic)if(this.traffic.hasOwnProperty(i)){var n=this.traffic[i];n.key.write(t),n.value.write(t)}t.Ww(),t.rw()}if(null!==this.snapshotInfo&&void 0!==this.snapshotInfo&&(t.iw("snapshotInfo",g.Type.STRUCT,7),this.snapshotInfo.write(t),t.rw()),null!==this.agentInfo&&void 0!==this.agentInfo&&(t.iw("agentInfo",g.Type.STRUCT,8),this.agentInfo.write(t),t.rw()),null!==this.connInfo&&void 0!==this.connInfo&&(t.iw("connInfo",g.Type.STRUCT,9),this.connInfo.write(t),t.rw()),null!==this.partners&&void 0!==this.partners){for(var r in t.iw("partners",g.Type.MAP,10),t.Kw(g.Type.STRUCT,g.Type.STRUCT,g.kE(this.partners)),this.partners)if(this.partners.hasOwnProperty(r)){var s=this.partners[r];s.key.write(t),s.value.write(t)}t.Ww(),t.rw()}if(null!==this.player&&void 0!==this.player&&(t.iw("player",g.Type.STRUCT,11),this.player.write(t),t.rw()),null!==this.client&&void 0!==this.client&&(t.iw("client",g.Type.STRUCT,12),this.client.write(t),t.rw()),null!==this.sessionId&&void 0!==this.sessionId&&(t.iw("sessionId",g.Type.STRING,13),t.nw(this.sessionId),t.rw()),null!==this.responseInfo&&void 0!==this.responseInfo&&(t.iw("responseInfo",g.Type.STRUCT,14),this.responseInfo.write(t),t.rw()),null!==this.testInfo&&void 0!==this.testInfo&&(t.iw("testInfo",g.Type.STRUCT,15),this.testInfo.write(t),t.rw()),null!==this.clientId&&void 0!==this.clientId&&(t.iw("clientId",g.Type.I64,16),t.rp(this.clientId),t.rw()),null!==this.fragments&&void 0!==this.fragments){for(var e in t.iw("fragments",g.Type.LIST,17),t.$w(g.Type.STRUCT,this.fragments.length),this.fragments)this.fragments.hasOwnProperty(e)&&(e=this.fragments[e]).write(t);t.Xw(),t.rw()}t.ew(),t.hw()},b.snapshots.JsonMetricSnapshot=function(t){this.timestamp=null,this.guid=null,this.eventId=null,this.streamInfo=null,this.metrics=null,this.traffic=null,this.snapshotInfo=null,this.agentInfo=null,this.connInfo=null,this.partners=null,this.player=null,this.client=null,this.sessionId=null,this.responseInfo=null,this.testInfo=null,this.clientId=null,t&&(void 0!==t.timestamp&&null!==t.timestamp&&(this.timestamp=t.timestamp),void 0!==t.guid&&null!==t.guid&&(this.guid=t.guid),void 0!==t.eventId&&null!==t.eventId&&(this.eventId=t.eventId),void 0!==t.streamInfo&&null!==t.streamInfo&&(this.streamInfo=t.streamInfo),void 0!==t.metrics&&null!==t.metrics&&(this.metrics=t.metrics),void 0!==t.traffic&&null!==t.traffic&&(this.traffic=t.traffic),void 0!==t.snapshotInfo&&null!==t.snapshotInfo&&(this.snapshotInfo=t.snapshotInfo),void 0!==t.agentInfo&&null!==t.agentInfo&&(this.agentInfo=t.agentInfo),void 0!==t.connInfo&&null!==t.connInfo&&(this.connInfo=t.connInfo),void 0!==t.partners&&null!==t.partners&&(this.partners=t.partners),void 0!==t.player&&null!==t.player&&(this.player=t.player),void 0!==t.client&&null!==t.client&&(this.client=t.client),void 0!==t.sessionId&&null!==t.sessionId&&(this.sessionId=t.sessionId),void 0!==t.responseInfo&&null!==t.responseInfo&&(this.responseInfo=t.responseInfo),void 0!==t.testInfo&&null!==t.testInfo&&(this.testInfo=t.testInfo),void 0!==t.clientId&&null!==t.clientId&&(this.clientId=t.clientId))},b.snapshots.JsonMetricSnapshot.prototype={},b.snapshots.JsonMetricSnapshot.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I64?this.timestamp=t._p().value:t.XE(n);break;case 2:n==g.Type.STRING?this.guid=t.$E().value:t.XE(n);break;case 3:n==g.Type.STRUCT?(this.eventId=new EventId(),this.eventId.read(t)):t.XE(n);break;case 4:n==g.Type.STRUCT?(this.streamInfo=new b.snapshots.StreamInfo(),this.streamInfo.read(t)):t.XE(n);break;case 5:n==g.Type.STRUCT?(this.metrics=new b.snapshots.Metrics(),this.metrics.read(t)):t.XE(n);break;case 6:if(n==g.Type.MAP){var s,e;this.traffic={};(e=t.lp()).vp,e.dp,s=e.size;for(var h=0;h<s;++h){0<h&&t.hp.length>t.aw[t.aw.length-1]+1&&t.hp.pop();var o,u=null;o=t.$E().value,(u=new b.snapshots.Traffic()).read(t),this.traffic[o]=u}t.Ep()}else t.XE(n);break;case 7:n==g.Type.STRUCT?(this.snapshotInfo=new SnapshotInfo(),this.snapshotInfo.read(t)):t.XE(n);break;case 8:n==g.Type.STRUCT?(this.agentInfo=new b.snapshots.AgentInfo(),this.agentInfo.read(t)):t.XE(n);break;case 9:n==g.Type.STRUCT?(this.connInfo=new b.snapshots.ConnectivityInfo(),this.connInfo.read(t)):t.XE(n);break;case 10:if(n==g.Type.MAP){var a,f;this.partners={};(f=t.lp()).vp,f.dp,a=f.size;for(var c=0;c<a;++c){0<c&&t.hp.length>t.aw[t.aw.length-1]+1&&t.hp.pop();var l,v=null;l=t.$E().value,(v=new b.snapshots.Partner()).read(t),this.partners[l]=v}t.Ep()}else t.XE(n);break;case 11:n==g.Type.STRUCT?(this.player=new b.snapshots.Player(),this.player.read(t)):t.XE(n);break;case 12:n==g.Type.STRUCT?(this.client=new b.snapshots.ClientInfo(),this.client.read(t)):t.XE(n);break;case 13:n==g.Type.STRING?this.sessionId=t.$E().value:t.XE(n);break;case 14:n==g.Type.STRUCT?(this.responseInfo=new b.snapshots.ServiceResponseInfo(),this.responseInfo.read(t)):t.XE(n);break;case 15:n==g.Type.STRUCT?(this.testInfo=new TestInfo(),this.testInfo.read(t)):t.XE(n);break;case 16:n==g.Type.STRING?this.clientId=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.JsonMetricSnapshot.prototype.write=function(t){if(t.tw("JsonMetricSnapshot"),null!==this.timestamp&&void 0!==this.timestamp&&(t.iw("timestamp",g.Type.I64,1),t.rp(this.timestamp),t.rw()),null!==this.guid&&void 0!==this.guid&&(t.iw("guid",g.Type.STRING,2),t.nw(this.guid),t.rw()),null!==this.eventId&&void 0!==this.eventId&&(t.iw("eventId",g.Type.STRUCT,3),this.eventId.write(t),t.rw()),null!==this.streamInfo&&void 0!==this.streamInfo&&(t.iw("streamInfo",g.Type.STRUCT,4),this.streamInfo.write(t),t.rw()),null!==this.metrics&&void 0!==this.metrics&&(t.iw("metrics",g.Type.STRUCT,5),this.metrics.write(t),t.rw()),null!==this.traffic&&void 0!==this.traffic){for(var i in t.iw("traffic",g.Type.MAP,6),t.Kw(g.Type.STRING,g.Type.STRUCT,g.kE(this.traffic)),this.traffic)if(this.traffic.hasOwnProperty(i)){var n=this.traffic[i];t.nw(i),n.write(t)}t.Ww(),t.rw()}if(null!==this.snapshotInfo&&void 0!==this.snapshotInfo&&(t.iw("snapshotInfo",g.Type.STRUCT,7),this.snapshotInfo.write(t),t.rw()),null!==this.agentInfo&&void 0!==this.agentInfo&&(t.iw("agentInfo",g.Type.STRUCT,8),this.agentInfo.write(t),t.rw()),null!==this.connInfo&&void 0!==this.connInfo&&(t.iw("connInfo",g.Type.STRUCT,9),this.connInfo.write(t),t.rw()),null!==this.partners&&void 0!==this.partners){for(var r in t.iw("partners",g.Type.MAP,10),t.Kw(g.Type.STRING,g.Type.STRUCT,g.kE(this.partners)),this.partners)if(this.partners.hasOwnProperty(r)){var s=this.partners[r];t.nw(r),s.write(t)}t.Ww(),t.rw()}null!==this.player&&void 0!==this.player&&(t.iw("player",g.Type.STRUCT,11),this.player.write(t),t.rw()),null!==this.client&&void 0!==this.client&&(t.iw("client",g.Type.STRUCT,12),this.client.write(t),t.rw()),null!==this.sessionId&&void 0!==this.sessionId&&(t.iw("sessionId",g.Type.STRING,13),t.nw(this.sessionId),t.rw()),null!==this.responseInfo&&void 0!==this.responseInfo&&(t.iw("responseInfo",g.Type.STRUCT,14),this.responseInfo.write(t),t.rw()),null!==this.testInfo&&void 0!==this.testInfo&&(t.iw("testInfo",g.Type.STRUCT,15),this.testInfo.write(t),t.rw()),null!==this.clientId&&void 0!==this.clientId&&(t.iw("clientId",g.Type.STRING,16),t.nw(this.clientId),t.rw()),t.ew(),t.hw()}},function(t,i,n){var u=n(22),r=(window.StreamType={1:"LIVE",LIVE:1,2:"VOD",VOD:2},window.StreamProtocol={1:"DASH",DASH:1,2:"HDS",HDS:2,3:"HLS",HLS:3,4:"SS",SS:4},window.ClientType={1:"JAVA",FK:1,2:"STATS_ONLY",nF:2,3:"JS_DIRECT",tF:3,4:"JS_PROXY",iF:4},window.ContentType={1:"AUDIO",Ba:1,2:"VIDEO",Va:2},window.EventId=function(t){this.partnerId=null,this.customerId=null,this.contentId=null,this.tags=null,t&&(void 0!==t.partnerId&&null!==t.partnerId&&(this.partnerId=t.partnerId),void 0!==t.customerId&&null!==t.customerId&&(this.customerId=t.customerId),void 0!==t.contentId&&null!==t.contentId&&(this.contentId=t.contentId),void 0!==t.tags&&null!==t.tags&&(this.tags=t.tags))});r.prototype={},r.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==u.Type.STOP)break;switch(r){case 1:n==u.Type.STRING?this.partnerId=t.$E().value:t.XE(n);break;case 2:n==u.Type.STRING?this.customerId=t.$E().value:t.XE(n);break;case 3:n==u.Type.STRING?this.contentId=t.$E().value:t.XE(n);break;case 4:if(n==u.Type.LIST){var s,e;this.tags=[];(e=t.wp()).pp,s=e.size;for(var h=0;h<s;++h){var o;o=t.$E().value,this.tags.push(o)}t.gp()}else t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},r.prototype.write=function(t){if(t.tw("EventId"),null!==this.partnerId&&void 0!==this.partnerId&&(t.iw("partnerId",u.Type.STRING,1),t.nw(this.partnerId),t.rw()),null!==this.customerId&&void 0!==this.customerId&&(t.iw("customerId",u.Type.STRING,2),t.nw(this.customerId),t.rw()),null!==this.contentId&&void 0!==this.contentId&&(t.iw("contentId",u.Type.STRING,3),t.nw(this.contentId),t.rw()),null!==this.tags&&void 0!==this.tags){for(var i in t.iw("tags",u.Type.LIST,4),t.$w(u.Type.STRING,this.tags.length),this.tags)this.tags.hasOwnProperty(i)&&(i=this.tags[i],t.nw(i));t.Xw(),t.rw()}t.ew(),t.hw()};var s=window.SnapshotInfo=function(t){this.timestamp=null,this.apiServer=null,this.clientIp=null,t&&(void 0!==t.timestamp&&null!==t.timestamp&&(this.timestamp=t.timestamp),void 0!==t.apiServer&&null!==t.apiServer&&(this.apiServer=t.apiServer),void 0!==t.clientIp&&null!==t.clientIp&&(this.clientIp=t.clientIp))};s.prototype={},s.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==u.Type.STOP)break;switch(r){case 1:n==u.Type.I64?this.timestamp=t._p().value:t.XE(n);break;case 2:n==u.Type.STRING?this.apiServer=t.$E().value:t.XE(n);break;case 3:n==u.Type.STRING?this.clientIp=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},s.prototype.write=function(t){t.tw("SnapshotInfo"),null!==this.timestamp&&void 0!==this.timestamp&&(t.iw("timestamp",u.Type.I64,1),t.rp(this.timestamp),t.rw()),null!==this.apiServer&&void 0!==this.apiServer&&(t.iw("apiServer",u.Type.STRING,2),t.nw(this.apiServer),t.rw()),null!==this.clientIp&&void 0!==this.clientIp&&(t.iw("clientIp",u.Type.STRING,3),t.nw(this.clientIp),t.rw()),t.ew(),t.hw()};var e=window.TestInfo=function(t){this.testId=null,t&&void 0!==t.testId&&null!==t.testId&&(this.testId=t.testId)};e.prototype={},e.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==u.Type.STOP)break;switch(r){case 1:n==u.Type.STRING?this.testId=t.$E().value:t.XE(n);break;case 0:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},e.prototype.write=function(t){t.tw("TestInfo"),null!==this.testId&&void 0!==this.testId&&(t.iw("testId",u.Type.STRING,1),t.nw(this.testId),t.rw()),t.ew(),t.hw()};var h=window.InetAddress=function(t){this.address=null,this.port=null,t&&(void 0!==t.address&&null!==t.address&&(this.address=t.address),void 0!==t.port&&null!==t.port&&(this.port=t.port))};h.prototype={},h.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==u.Type.STOP)break;switch(r){case 1:n==u.Type.STRING?this.address=t.Sp().value:t.XE(n);break;case 2:n==u.Type.I32?this.port=t.zE().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},h.prototype.write=function(t){t.tw("InetAddress"),null!==this.address&&void 0!==this.address&&(t.iw("address",u.Type.STRING,1),t.ep(this.address),t.rw()),null!==this.port&&void 0!==this.port&&(t.iw("port",u.Type.I32,2),t.sw(this.port),t.rw()),t.ew(),t.hw()}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=n(16),e=n(14),h=(o.prototype.GK=function(){return Date.now()>=this.xK},o);function o(t,i){this.msg=t,this.xK=Date.now()+i,this.BK=r.defer()}var u=(a.prototype.sh=function(t){var i=t.service+"_"+t.msgId,n=this.AQ[i];null!=n?n(t):s.logger().error(s.loggerId+"Could not find a dispatcher for ",t,i,this.AQ)},a.prototype.on=function(t,i,n){this.AQ[t+"_"+i]=n},a.prototype.onerror=function(t){this.VK.push(t)},a.prototype.onconnect=function(t){this.qK.push(t)},a.prototype.QK=function(){var n=this;if(window.WebSocket){var t=new WebSocket(this.YK);return t.binaryType="arraybuffer",t.onopen=function(t){n.KK(),s.logger().debug(s.loggerId+"HiveServicesConnection established to "+n.YK),n.WK=new n.$K().getTime(),n.XK(),n.qK.forEach(function(t){return t(n)}),n.zK(),n.JK()},t.onclose=function(t){n.close(n.ZK),n.connect()},t.onmessage=function(t){n.sh(s.Lc.Pc(t.data))},t.onerror=function(i){n.close(!0),n.VK.forEach(function(t){return t(i.toString())})},t}this.VK.forEach(function(t){return t("WebSocket not defined")})},a.prototype.isOpen=function(){return null!=this.Vv&&this.Vv.readyState==this.Vv.OPEN},a.prototype.connect=function(t){var i=this;t&&(this.ZK=!0),this.ZK&&1!=this.isOpen()&&(0<this.tW||(-1<this.WK&&new this.$K().getTime()-this.WK>this.iW?(this.nW=e.Rc._c,this.WK=-1):this.nW=Math.min(2*this.nW,this.iW),this.tW=window.setTimeout(function(){i.tW=-1,s.logger().debug(s.loggerId+"Connection attempt to "+i.YK+" [t:"+i.nW+" hb:"+i.rW+"]"),i.Vv=i.QK(),i.nW=Math.max(i.nW,e.Rc._c)},this.nW)))},a.prototype.KK=function(){-1<this.tW&&(clearTimeout(this.tW),this.tW=-1)},a.prototype.close=function(t){this.ZK=null!=t&&t,s.logger().debug(s.loggerId+"Closing connection [reconnect:"+this.ZK+"]"),this.KK(),null!=this.Vv&&(this.Vv.close(),this.Vv=null)},a.prototype.XK=function(){for(;0<this.sW.length;){var i=this.sW.pop();try{i.GK()?i.BK.reject(new Error("Message expired")):(this.zK(),this.Vv.send(i.msg.ia()))}catch(t){if(t.code===DOMException.INVALID_STATE_ERR){this.sW.push(i);break}s.logger().error(s.loggerId+"Failed to send the message, dropped: ",t.code,t.name),i.BK.reject(t)}}this.JK()},a.prototype.zK=function(){this.eW&&(clearTimeout(this.eW),this.eW=null)},a.prototype.JK=function(){var t=this;this.rW&&!this.eW&&(this.eW=window.setInterval(function(){t.send(new s.Lc(HiveStreamingServices.hW,0,""))},this.oW))},a.prototype.send=function(t,i){if(void 0===i&&(i=this.uW),this.sW.length>=this.aW)throw new Error("HiveServices connection cannot queue more messages");var n=new h(t,i);return this.sW.push(n),this.Vv?this.XK():s.logger().warn(s.loggerId+" The websocket is closed, messages are being queued"),n.BK.promise},a.prototype.fW=function(t){this.rW=t,this.rW&&this.JK()},a.prototype.isConnected=function(){return null!=this.Vv},a);function a(t,i,n,r,s,e,h){void 0===i&&(i=3e4),void 0===n&&(n=100),void 0===r&&(r=3e4),void 0===s&&(s=15e3),void 0===e&&(e=Date),void 0===h&&(h=!1),this.nW=1,this.tW=-1,this.WK=-1,this.AQ={},this.VK=[],this.qK=[],this.rW=!1,this.ZK=!0,this.YK=t,this.sW=Array(),this.iW=i,this.aW=n,this.uW=r,this.oW=s,this.$K=e,this.rW=h||/MSIE 10/i.test(navigator.userAgent)||/MSIE 9/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)||/Edge./i.test(navigator.userAgent)}i.OF=u},function(t,i){window.HiveStreamingServices={1:"REMOTE_EXECUTOR",cW:1,2:"PEER_FORWARDER",lW:2,3:"PEER_INDEX",vW:3,4:"PEER_BROADCAST",dW:4,5:"PEER_FILTER",EW:5,6:"PEER_LOGGING",wW:6,7:"HIVEJS_TRACKER",pW:7,8:"PEER_SYSTEM",gW:8,9:"HIVEJS_SNAPSHOTS",VS:9,10:"HIVEJS_TICKETS",TF:10,11:"HIVEJS_KEEPALIVE",hW:11,12:"HIVEJS_FORWARDING",bW:12,13:"INTERNAL_TICKET",yW:13,14:"LOCALITY_SERVICE",TW:14}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(t){this.bR=new Date().getTime(),this.NF=t}i.AF=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.uv=function(){return this.p2pId},s.prototype.av=function(){return this.reportingId?this.reportingId:this.p2pId},s);function s(t,i){this.p2pId=t,this.reportingId=i}i.PF=r},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(90),o=(e=h.OG,s(u,e),u.prototype.getCidr=function(){return this.cidr?this.cidr:null},u);function u(){return null!==e&&e.apply(this,arguments)||this}i.fG=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(145),o=n(4),r=n(0),u=n(14),s=(e.prototype.kF=function(){var i=o.defer(),n=this.indexedDB.open("PrivateIPDB");return n.onupgradeneeded=function(){n.result.createObjectStore("PrivateIPStore",{keyPath:"id"})},n.onsuccess=function(){var t=n.result;i.resolve(t)},n.onerror=function(t){i.reject(t)},i.promise},e.prototype.UG=function(){var r=this;if(this.OW)return this.OW;var s=setTimeout(function(){r.logger.warn("Private list retrieval timeout"),e.reject({message:"Private list timeout"})},4e3),e=o.defer();return u.Rc.lf&&this.indexedDB?this.kF().then(function(i){var n=i.transaction("PrivateIPStore","readwrite").objectStore("PrivateIPStore").get("iplist");n.onsuccess=function(){clearTimeout(s);var t=[];h.mW(n.result)||h.mW(n.result.value)||(t=n.result.value.split("|")),e.resolve(t),i.close()},n.onerror=function(t){clearTimeout(s),r.logger.warn("I got an error on indexed db "+t.message),e.reject({message:"Error on indexedDB "+t.message})}}).fail(function(t){clearTimeout(s),r.logger.warn("DB is not open with error"+t.message),e.reject({message:"DB is not open with error "+t.message})}):(clearTimeout(s),e.reject({message:"DB is not ready or enabled"})),this.OW=e.promise,this.OW},e.prototype.YG=function(n){var r=this;if(u.Rc.lf&&this.indexedDB){var s=n.join("|");this.kF().then(function(t){var i=t.transaction("PrivateIPStore","readwrite");i.objectStore("PrivateIPStore").put({id:"iplist",value:s}),i.oncomplete=function(){r.logger.debug("Storing site matched ips ["+n.join(",")+"]"),t.close()}}).fail(function(t){r.logger.warn("DB is not open with error "+t.message)})}},e);function e(){this.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,this.logger=r.Framework.resolve(r.Framework.v.p).log()}i.KG=s},function(t,I,N){(function(h){var i=Object.getOwnPropertyDescriptors||function(t){for(var i=Object.keys(t),n={},r=0;r<i.length;r++)n[i[r]]=Object.getOwnPropertyDescriptor(t,i[r]);return n},o=/%[sdj%]/g;I.format=function(t){if(!b(t)){for(var i=[],n=0;n<arguments.length;n++)i.push(u(arguments[n]));return i.join(" ")}n=1;for(var r=arguments,s=r.length,e=String(t).replace(o,function(t){if("%%"===t)return"%";if(s<=n)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),h=r[n];n<s;h=r[++n])p(h)||!a(h)?e+=" "+h:e+=" "+u(h);return e},I._W=function(t,i){if(void 0!==h&&!0===h.RW)return t;if(void 0===h)return function(){return I._W(t,i).apply(this,arguments)};var n=!1;return function(){if(!n){if(h.SW)throw new Error(i);h.AW?console.trace(i):!1,n=!0}return t.apply(this,arguments)}};var t,r={};function u(t,i){var n={IW:[],NW:e};return 3<=arguments.length&&(n.kW=arguments[2]),4<=arguments.length&&(n.DW=arguments[3]),w(i)?n.jW=i:i&&I.MW(n,i),y(n.jW)&&(n.jW=!1),y(n.kW)&&(n.kW=2),y(n.DW)&&(n.DW=!1),y(n.PW)&&(n.PW=!0),n.DW&&(n.NW=s),l(n,t,n.kW)}function s(t,i){var n=u.LW[i];return n?"\x1b["+u.DW[n][0]+"m"+t+"\x1b["+u.DW[n][1]+"m":t}function e(t,i){return t}function l(i,n,r){if(i.PW&&n&&_(n.inspect)&&n.inspect!==I.inspect&&(!n.constructor||n.constructor.prototype!==n)){var t=n.inspect(r,i);return b(t)||(t=l(i,t,r)),t}var s=function(t,i){if(y(i))return t.NW("undefined","undefined");if(b(i)){var n="'"+JSON.stringify(i).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.NW(n,"string")}if(g(i))return t.NW(""+i,"number");if(w(i))return t.NW(""+i,"boolean");if(p(i))return t.NW("null","null")}(i,n);if(s)return s;var e=Object.keys(n),h=function(t){var n={};return t.forEach(function(t,i){n[t]=!0}),n}(e);if(i.jW&&(e=Object.getOwnPropertyNames(n)),m(n)&&(0<=e.indexOf("message")||0<=e.indexOf("description")))return v(n);if(0===e.length){if(_(n)){var o=n.name?": "+n.name:"";return i.NW("[Function"+o+"]","special")}if(T(n))return i.NW(RegExp.prototype.toString.call(n),"regexp");if(O(n))return i.NW(Date.prototype.toString.call(n),"date");if(m(n))return v(n)}var u,a="",f=!1,c=["{","}"];E(n)&&(f=!0,c=["[","]"]),_(n)&&(a=" [Function"+(n.name?": "+n.name:"")+"]");return T(n)&&(a=" "+RegExp.prototype.toString.call(n)),O(n)&&(a=" "+Date.prototype.toUTCString.call(n)),m(n)&&(a=" "+v(n)),0!==e.length||f&&0!=n.length?r<0?T(n)?i.NW(RegExp.prototype.toString.call(n),"regexp"):i.NW("[Object]","special"):(i.IW.push(n),u=f?function(i,n,r,s,t){for(var e=[],h=0,o=n.length;h<o;++h)R(n,String(h))?e.push(d(i,n,r,s,String(h),!0)):e.push("");return t.forEach(function(t){t.match(/^\d+$/)||e.push(d(i,n,r,s,t,!0))}),e}(i,n,r,h,e):e.map(function(t){return d(i,n,r,h,t,f)}),i.IW.pop(),function(t,i,n){return 60<t.reduce(function(t,i){return 0<=i.indexOf("\n")&&0,t+i.replace(/\u001b\[\d\d?m/g,"").length+1},0)?n[0]+(""===i?"":i+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+i+" "+t.join(", ")+" "+n[1]}(u,a,c)):c[0]+a+c[1]}function v(t){return"["+Error.prototype.toString.call(t)+"]"}function d(t,i,n,r,s,e){var h,o,u;if((u=Object.getOwnPropertyDescriptor(i,s)||{value:i[s]}).get?o=u.set?t.NW("[Getter/Setter]","special"):t.NW("[Getter]","special"):u.set&&(o=t.NW("[Setter]","special")),R(r,s)||(h="["+s+"]"),o||(t.IW.indexOf(u.value)<0?-1<(o=p(n)?l(t,u.value,null):l(t,u.value,n-1)).indexOf("\n")&&(o=e?o.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+o.split("\n").map(function(t){return"   "+t}).join("\n")):o=t.NW("[Circular]","special")),y(h)){if(e&&s.match(/^\d+$/))return o;h=(h=JSON.stringify(""+s)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(h=h.substr(1,h.length-2),t.NW(h,"name")):(h=h.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),t.NW(h,"string"))}return h+": "+o}function E(t){return Array.isArray(t)}function w(t){return"boolean"==typeof t}function p(t){return null===t}function g(t){return"number"==typeof t}function b(t){return"string"==typeof t}function y(t){return void 0===t}function T(t){return a(t)&&"[object RegExp]"===n(t)}function a(t){return"object"==typeof t&&null!==t}function O(t){return a(t)&&"[object Date]"===n(t)}function m(t){return a(t)&&("[object Error]"===n(t)||t instanceof Error)}function _(t){return"function"==typeof t}function n(t){return Object.prototype.toString.call(t)}function f(t){return t<10?"0"+t.toString(10):t.toString(10)}I.HW=function(i){if(y(t)&&(t=h.Ge.UW||""),i=i.toUpperCase(),!r[i])if(new RegExp("\\b"+i+"\\b","i").test(t)){var n=h.FW;r[i]=function(){var t=I.format.apply(I,arguments)}}else r[i]=function(){};return r[i]},(I.inspect=u).DW={bold:[1,22],GW:[3,23],xW:[4,24],inverse:[7,27],BW:[37,39],VW:[90,39],qW:[30,39],blue:[34,39],QW:[36,39],green:[32,39],YW:[35,39],red:[31,39],KW:[33,39]},u.LW={WW:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",gT:"magenta",$W:"red"},I.isArray=E,I.cg=w,I.vg=p,I.mW=function(t){return null==t},I.dg=g,I.Eg=b,I.XW=function(t){return"symbol"==typeof t},I.wg=y,I.zW=T,I.tc=a,I.JW=O,I.ZW=m,I.lg=_,I.t$=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},I.isBuffer=N(146);var c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function R(t,i){return Object.prototype.hasOwnProperty.call(t,i)}I.log=function(){},I.DE=N(147),I.MW=function(t,i){if(!i||!a(i))return t;for(var n=Object.keys(i),r=n.length;r--;)t[n[r]]=i[n[r]];return t};var S="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function A(t,i){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return i(t)}I.i$=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(S&&e[S]){var t;if("function"!=typeof (t=e[S]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,S,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var n,r,t=new Promise(function(t,i){n=t,r=i}),i=[],s=0;s<arguments.length;s++)i.push(arguments[s]);i.push(function(t,i){t?r(t):n(i)});try{e.apply(this,i)}catch(t){r(t)}return t}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),S&&Object.defineProperty(t,S,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,i(e))},I.i$.n$=S,I.r$=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function t(){for(var t=[],i=0;i<arguments.length;i++)t.push(arguments[i]);var n=t.pop();if("function"!=typeof n)throw new TypeError("The last argument must be of type Function");function r(){return n.apply(s,arguments)}var s=this;e.apply(this,t).then(function(t){h.Me(r,null,t)},function(t){h.Me(A,t,r)})}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,i(e)),t}}).call(this,N(37))},function(t,i){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.jN&&"function"==typeof t.fill&&"function"==typeof t.wI}},function(t,i){"function"==typeof Object.create?t.exports=function(t,i){t.s$=i,t.prototype=Object.create(i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,i){t.s$=i;function n(){}n.prototype=i.prototype,t.prototype=new n(),t.prototype.constructor=t}},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(20),o=n(26),u=(e=h.HiveTechOptions,s(a,e),a);function a(){var t=null!==e&&e.apply(this,arguments)||this;return t.enableXhrInterception=o.Y.Ef,t}i.StatsJSOptions=u;function f(){this.hiveEnableXhrInterception="enableXhrInterception"}i.StatsJSUrlConfigurableOptions=f},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(94),o=n(1),u=n(32),a=n(95),f=(e=h.VA,s(c,e),c);function c(n,t){var r=e.call(this,n,null)||this;r.pluginId=t,r.pluginId||(r.pluginId=u.aR.getInstance().wA());var s=n.send;return n.send=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];a.Rx.getInstance().AR(r.pluginId,r.url)||o.ErrorMonitor.getInstance().logError("Failed to initialize session on player request"),s.apply(n,t)},r}i.nx=f},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(0),o=n(151),u=n(171),a=n(102),f=(e=a.eV,s(c,e),c.prototype.init=function(t,i){this.reportingInstance=t,this.logger=h.Framework.resolve(h.Framework.v.p).log(i)},c.prototype.nV=function(t,i){return new u.e$(this.reportingInstance,i?i.hls:void 0)},c.prototype.rV=function(t,i){return new o.h$(this.reportingInstance,i?i.dash:void 0)},c);function c(){return null!==e&&e.apply(this,arguments)||this}i.ax=f},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(96),o=n(33),u=(e=h.XH,s(a,e),a.prototype.ex=function(t){e.prototype.ex.call(this,t),void 0===this.FH&&(this.FH=this.metadata.isLive())},a);function a(t,i){var n=e.call(this,t)||this;return n.metadata=o.Dash.SA(n.UL,{Yx:!1},null,i),n}i.h$=u},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,u=n(97),a=n(64),h=n(33),f=n(4),c=n(7),o=(e=u.bB,s(l,e),l.prototype.hH=function(i){var n=this,t=this.S_(i.k_());if(t!==c.xa.Va&&t!==c.xa.Ba)return f.resolve(!1);var o=this.MH(i.k_());if(!o||o.next)return f.resolve(!1);var r=f.defer(),s=f.defer();if(this.Xx)h.Dash.MA?this.Xx.o$().then(function(t){t?n.Xx.decrypt(i.getResponse()).then(function(t){s.resolve(n.eB(t))}).fail(function(t){return s.reject(!0)}):s.reject(!1)}):s.reject(!1);else try{var e=this.eB(i.getResponse());s.resolve(e)}catch(t){this.logger.warn("error extracting duration",t),s.reject(!0)}return s.promise.then(function(e){if(!isNaN(e)){var h=o.id+e;n.logger.debug("found next fragment: "+o.id+" -> "+h+" duration: "+e),n.Ix.forEach(function(t){if(t.type===o.hA){var i=t.Mx.replace(u.bB.$x,o.id+""),n=t.Mx.replace(u.bB.$x,h+""),r=t.Bx.get(i);if(!t.Bx.has(n)&&r){r.duration=e;var s=new a.iH(h,t.qualityLevel,e,n,n,r.hA);r.next=s,t.Bx.set(n,s),t.qx.set(h,s)}}})}r.resolve(!1)}).fail(function(t){n.logger.debug("could not extract duration from "+i.k_()+" [reevaluate: "+t+"]"),r.resolve(t)}),r.promise},l);function l(){return null!==e&&e.apply(this,arguments)||this}i.IA=o},function(t,i,n){"use strict";t.exports=u;n(10);var r=n(11),s=n(41),e=n(12),h=n(40),o=n(74);function u(t,i,n,r){if(!(this instanceof u))return new u(t,i,n,r);this.Re=i||Object.equals,this._f=n||Object.compare,this.Ae=r||Function._e,this.root=null,this.length=0,this.hiveAddEach(t)}function a(t){this.value=t,this.left=null,this.right=null,this.length=1}function f(t,i,n){if(this.set=t,this.RP=null,this.end=n,i){var r=this.set.u$(i);r&&(this.set.a$(r.value),this.RP=r.f$())}}u.c$=u,Object.hiveAddEach(u.prototype,r.prototype),Object.hiveAddEach(u.prototype,s.prototype),Object.hiveAddEach(u.prototype,e.prototype),Object.hiveAddEach(u.prototype,h.prototype),u.prototype.zH=!0,u.prototype.Ne=function(t){return new this.constructor(t,this.Re,this._f,this.Ae)},u.prototype.has=function(t,i){if(i)throw new Error("SortedSet#has does not support second argument: equals");return!!this.root&&(this.a$(t),this.Re(t,this.root.value))},u.prototype.get=function(t,i){if(i)throw new Error("SortedSet#get does not support second argument: equals");return this.root&&(this.a$(t),this.Re(t,this.root.value))?this.root.value:this.Ae(t)},u.prototype.hiveAdd=function(t){var i=new this.Node(t);if(!this.root)return this.yC&&this.RC([t],[],0),this.root=i,this.length++,this.yC&&this.OC([t],[],0),!0;if(this.a$(t),this.Re(t,this.root.value))return!1;var n=this._f(t,this.root.value);if(0===n)throw new Error("SortedSet cannot contain incomparable but inequal values: "+t+" and "+this.root.value);return this.yC&&this.RC([t],[],this.root.index),n<0?(i.right=this.root,i.left=this.root.left,this.root.left=null):(i.left=this.root,i.right=this.root.right,this.root.right=null),this.root.l$(),i.l$(),this.root=i,this.length++,this.yC&&this.OC([t],[],this.root.index),!0},u.prototype["delete"]=function(t,i){if(i)throw new Error("SortedSet#delete does not support second argument: equals");if(this.root&&(this.a$(t),this.Re(t,this.root.value))){var n=this.root.index;if(this.yC&&this.RC([],[t],n),this.root.left){var r=this.root.right;this.root=this.root.left,this.a$(t),this.root.right=r}else this.root=this.root.right;return this.length--,this.root&&this.root.l$(),this.yC&&this.OC([],[t],n),!0}return!1},u.prototype.indexOf=function(t,i){if(i)throw new Error("SortedSet#indexOf does not support second argument: startIndex");return this.root&&(this.a$(t),this.Re(t,this.root.value))?this.root.index:-1},u.prototype.find=function(t,i,n){if(i)throw new Error("SortedSet#find does not support second argument: equals");if(n)throw new Error("SortedSet#find does not support third argument: index");if(this.root&&(this.a$(t),this.Re(t,this.root.value)))return this.root},u.prototype.v$=function(t){if(this.root){for(t=t||this.root;t.right;)t=t.right;return t}},u.prototype.d$=function(t){if(this.root){for(t=t||this.root;t.left;)t=t.left;return t}},u.prototype.E$=function(t){if(this.root)return this.a$(t),0<this._f(this.root.value,t)?this.root.f$():this.root},u.prototype.w$=function(t){if(this.root)return this.a$(t),0<=this._f(this.root.value,t)?this.root.f$():this.root},u.prototype.u$=function(t){if(this.root)return this.a$(t),0<=this._f(this.root.value,t)?this.root:this.root.p$()},u.prototype.g$=function(t){if(this.root)return this.a$(t),this._f(this.root.value,t)<=0?this.root.p$():this.root},u.prototype.pop=function(){if(this.root){var t=this.v$();return this["delete"](t.value),t.value}},u.prototype.shift=function(){if(this.root){var t=this.d$();return this["delete"](t.value),t.value}},u.prototype.push=function(){this.hiveAddEach(arguments)},u.prototype.unshift=function(){this.hiveAddEach(arguments)},u.prototype.slice=function(t,i){t=t||0,i=i||this.length,t<0&&(t+=this.length),i<0&&(i+=this.length);var n=[];if(this.root)for(this.b$(t);this.root.index<i&&(n.push(this.root.value),this.root.right);)this.a$(this.root.p$().value);return n},u.prototype.splice=function(t,i){return this.MP(t,i,Array.prototype.slice.call(arguments,2))},u.prototype.MP=function(t,i,n){if(void 0===t&&void 0===i)return[];(t=t||0)<0&&(t+=this.length),void 0===i&&(i=1/0);var r=[];if(this.root){this.b$(t);for(var s=0;s<i;s++){r.push(this.root.value);var e=this.root.p$();if(this["delete"](this.root.value),!e)break;this.a$(e.value)}}return this.hiveAddEach(n),r},u.prototype.a$=function(t){var i,n,r,s,e,h;if(this.root){for(i=n=r=new this.Node(),h=new this.Node(),e=this.root;;){var o=this._f(t,e.value);if(o<0){if(!e.left)break;if(this._f(t,e.left.value)<0&&(s=e.left,e.left=s.right,e.l$(),s.right=e,s.l$(),!(e=s).left))break;(s=new a()).right=e,s.left=h.left,h.left=s,r.left=e,r.l$(),e=(r=e).left}else{if(!(0<o))break;if(!e.right)break;if(0<this._f(t,e.right.value)&&(s=e.right,e.right=s.left,e.l$(),s.left=e,s.l$(),!(e=s).right))break;(s=new a()).left=e,s.right=h.right,h.right=s,n.right=e,n.l$(),e=(n=e).right}}for(n.right=e.left,n.l$(),r.left=e.right,r.l$(),e.left=i.right,e.right=i.left;h.left;)h.left.right.l$(),h.left=h.left.left;for(;h.right;)h.right.left.l$(),h.right=h.right.right;e.l$(),this.root=e}},u.prototype.b$=function(t){if(this.root){for(var i=this.root,n=this.root.index;n!==t;)if(t<n&&i.left)n-=1+((i=i.left).right?i.right.length:0);else{if(!(n<t&&i.right))break;n+=1+((i=i.right).left?i.left.length:0)}return this.a$(i.value),this.root.index===t}return!1},u.prototype.reduce=function(t,i,n){return this.root&&(i=this.root.reduce(t,i,0,n,this)),i},u.prototype.reduceRight=function(t,i,n){return this.root&&(i=this.root.reduceRight(t,i,this.length-1,n,this)),i},u.prototype.min=function(t){var i=this.d$(t);if(i)return i.value},u.prototype.max=function(t){var i=this.v$(t);if(i)return i.value},u.prototype.kf=function(){return this.min()},u.prototype.clear=function(){var t;this.yC&&(t=this.toArray(),this.RC([],t,0)),this.root=null,this.length=0,this.yC&&this.OC([],t,0)},u.prototype.Df=function(t,i){return new this.Iterator(this,t,i)},u.prototype.Iterator=f,u.prototype.summary=function(){return this.root?this.root.summary():"()"},u.prototype.log=function(t,i,n,r){t=t||o.dU,i=i||this.Ce,n||(n=emptyFunction,r=console),n=n.bind(r),this.root&&this.root.log(t,i,n,n)},u.prototype.Ce=function(t,i,n){i(" "+t.value)},u.y$=o,(u.prototype.Node=a).prototype.reduce=function(t,i,n,r,s,e){if(e=e||0,this.left){var h=this.left.length;i=this.left.reduce(t,i,n,r,s,e+1),n+=h}return i=t.call(r,i,this.value,n,s,this,e),n+=1,this.right&&(i=this.right.reduce(t,i,n,r,s,e+1)),i},a.prototype.reduceRight=function(t,i,n,r,s,e){return e=e||0,this.right&&(i=this.right.reduce(t,i,n,r,s,e+1),n-=this.right.length),i=t.call(r,i,this.value,this.value,s,this,e),n-=1,this.left&&(i=this.left.reduce(t,i,n,r,s,e+1)),i},a.prototype.l$=function(){this.length=1+(this.left?this.left.length:0)+(this.right?this.right.length:0),this.index=this.left?this.left.length:0},a.prototype.T$=function(){var t=1;if(t+=this.left?this.left.T$():0,t+=this.right?this.right.T$():0,this.length!==t)throw new Error("Integrity check failed: "+this.summary());return t},a.prototype.p$=function(){var t=this;if(t.right){for(t=t.right;t.left;)t=t.left;return t}},a.prototype.f$=function(){var t=this;if(t.left){for(t=t.left;t.right;)t=t.right;return t}},a.prototype.summary=function(){var t=this.value||"-";return t+=" <"+this.length,this.left||this.right?"("+t+" "+(this.left?this.left.summary():"()")+", "+(this.right?this.right.summary():"()")+")":"("+t+")"},a.prototype.log=function(i,t,n,r){var s,e,h,o,u=this;s=this.left&&this.right?i.IC:this.left?i.uU:this.right?i.aU:i.oU,this.left&&this.left.log(i,t,function(t){e?r(i.vU+" "+t):(e=!0,r(i.fU+i.oU+t))},function(t){r("  "+t)}),t(this,function(t){h?n((u.right?i.vU:" ")+t):(h=!0,n(s+t))},function(t){r((u.left?i.vU:" ")+t)}),this.right&&this.right.log(i,t,function(t){o?n("  "+t):(o=!0,n(i.cU+i.oU+t))},function(t){n(i.vU+" "+t)})},f.prototype.PP=null,Object.defineProperty(f.prototype,"LP",{get:function(){return this.PP||(this.PP={done:!1,value:null})}}),f.prototype.next=function(){var t;return(t=this.RP?this.set.g$(this.RP.value):this.set.d$())?void 0!==this.end&&0<=this.set._f(t.value,this.end)?(this.LP.done=!0,this.LP.value=void 0):(this.RP=t,this.LP.value=t.value):(this.LP.done=!0,this.LP.value=void 0),this.LP}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=s(n(98)),u=s(n(155)),a=s(n(99)),f=s(n(156)),c=s(n(157)),l=s(n(159)),v=s(n(160)),d=s(n(161)),E=s(n(163));function s(t){return t&&t.s?t:{"default":t}}function e(t){t=t||{};var i=this.context,n=t.debug,r=void 0,e=void 0,s=void 0,h=void 0,o=void 0;return r={parse:function(t){var i=void 0,n=window.performance.now();if(!(i=h.aB(t)))throw new Error("parsing the manifest failed");var r=window.performance.now();o.XN(i);var s=window.performance.now();return e&&"function"==typeof e.info&&e.info("Parsing complete: ( xml2json: "+(r-n).toPrecision(3)+"ms, objectiron: "+(s-r).toPrecision(3)+"ms, total: "+((s-n)/1e3).toPrecision(3)+"s)"),i.protocol="DASH",i},O$:function(){return s},m$:function(){return o}},e=n&&n._$(r),s=[new c["default"](),new l["default"](),new v["default"](),new f["default"]()],h=new a["default"]({escapeMode:!1,DB:"",arrayAccessForm:"property",jB:"object",HB:!1,MB:!0,BB:!0,qB:s}),o=u["default"](i).create({R$:new d["default"](),period:new E["default"]()}),r}e._B="DashParser",i["default"]=r["default"].AB(e)},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r,l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=n(98),e=(r=s)&&r.s?r:{"default":r};function h(f){function u(t,i){for(var n in t)i.hasOwnProperty(n)||(i[n]=t[n])}function a(t,i,n){for(var r=0,s=t.length;r<s;++r){var e=t[r];if(i[e.name])if(n[e.name]){if(e.mg){var h=i[e.name],o=n[e.name];"object"===(void 0===h?"undefined":l(h))&&"object"===(void 0===o?"undefined":l(o))?u(h,o):n[e.name]=h+o}}else n[e.name]=i[e.name]}}function c(t,i){for(var n=0,r=t.children.length;n<r;++n){var s=t.children[n],e=i[s.name+"_asArray"];if(e)for(var h=0,o=e.length;h<o;++h){var u=e[h];a(t.properties,i,u),c(s,u)}}}return{XN:function(t){if(null===t||"object"!==(void 0===t?"undefined":l(t)))return t;if("period"in f)for(var i=f.period,n=t.Period_asArray,r=0,s=n.length;r<s;++r){var e=n[r];if(c(i,e),"adaptationset"in f){var h=e.AdaptationSet_asArray;if(h)for(var o=f.R$,u=0,a=h.length;u<a;++u)c(o,h[u])}}return t}}}h._B="ObjectIron";var o=e["default"].AB(h);i["default"]=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=s(n(50)),e=s(n(51));function s(t){return t&&t.s?t:{"default":t}}function h(t,i,n){return i in t?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t}var o=(function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}(u,r["default"]),u);function u(){return function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,u),function(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?t:i}(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,function(t,i){var n,r=(h(n={},e["default"].MPD,[e["default"].tD,e["default"].iD]),h(n,e["default"].zo,[e["default"].tD]),h(n,e["default"].Fk,[e["default"].nD,e["default"].hD]),h(n,e["default"].Gk,[e["default"].oD]),h(n,e["default"].Xk,[e["default"].rD]),h(n,e["default"].Wk,[e["default"].rD]),h(n,e["default"].Bk,[e["default"].oD]),h(n,e["default"].lD,[e["default"].rD]),h(n,e["default"].Vk,[e["default"].uD,e["default"].oD]),h(n,e["default"].xk,[e["default"].oD,e["default"].eD,e["default"].sD,e["default"].zk,e["default"].vD]),h(n,e["default"].Jk,[e["default"].aD,e["default"].tD]),h(n,e["default"].Zk,[e["default"].aD]),h(n,e["default"].Yk,[e["default"].iD,e["default"].cD,e["default"].Qk,e["default"].dD,e["default"].fD]),h(n,e["default"].ND,[e["default"].aD,e["default"].tD]),h(n,e["default"].CD,[e["default"].aD,e["default"].tD]),h(n,e["default"].kD,[e["default"].aD,e["default"].tD]),h(n,e["default"].DD,[e["default"].aD,e["default"].tD]),h(n,e["default"].jD,[e["default"].aD,e["default"].tD]),h(n,e["default"].MD,[e["default"].aD,e["default"].tD]),h(n,e["default"].PD,[e["default"].aD,e["default"].tD]),h(n,e["default"].LD,[e["default"].aD,e["default"].tD]),h(n,e["default"].HD,[e["default"].aD,e["default"].tD]),h(n,e["default"].xD,[e["default"].aD,e["default"].tD]),h(n,e["default"].UD,[e["default"].fD]),h(n,e["default"].Kk,[e["default"].tD,e["default"].ED,e["default"].wD]),h(n,e["default"].FD,[e["default"].tD]),h(n,e["default"].pD,[e["default"].gD]),h(n,e["default"].rk,[e["default"].aD,e["default"].tD]),n);if(r.hasOwnProperty(i)){var s=r[i];return void 0!==s&&0<=s.indexOf(t.name)}return!1},function(t){return String(t)}))}i["default"]=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=h(n(50)),s=h(n(158)),e=h(n(51));function h(t){return t&&t.s?t:{"default":t}}var o=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,u=(function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}(a,r["default"]),a);function a(){return function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,a),function(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?t:i}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,function(t){for(var i=[e["default"].aj,e["default"].$D,e["default"].XD,e["default"].hj,e["default"].oj,e["default"].fj,e["default"].pj,e["default"].cj,s["default"].S$,e["default"].ij],n=i.length,r=0;r<n;r++)if(t.nodeName===i[r])return o.test(t.value);return!1},function(t){var i=o.exec(t),n=31536e3*parseFloat(i[3]||0)+2592e3*parseFloat(i[5]||0)+86400*parseFloat(i[7]||0)+3600*parseFloat(i[9]||0)+60*parseFloat(i[11]||0)+parseFloat(i[13]||0);return void 0!==i[1]&&(n=-n),n}))}i["default"]=u},function(t,i,n){"use strict";function r(t,i){for(var n=0;n<i.length;n++){var r=i[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,s),this.init()}Object.defineProperty(i,"s",{value:!0});var e=new(function(t,i,n){return i&&r(t.prototype,i),n&&r(t,n),t}(s,[{key:"init",value:function(){this.A$="stream",this.Va="video",this.Ba="audio",this.I$="text",this.N$="fragmentedText",this.C$="embeddedText",this.k$="muxed",this.D$="image",this.j$="stpp",this.M$="ttml",this.P$="vtt",this.L$="wvtt",this.H$="abrDynamic",this.U$="abrBola",this.F$="abrThroughput",this.G$="slidingWindow",this.x$="ewma",this.B$="Invalid Arguments",this.V$="Missing config parameter(s)",this.q$="Location",this.Q$="initialize",this.Y$="showing",this.K$="hidden",this.W$="CC1",this.$$="CC3",this.UTF8="utf-8",this.X$="schemeIdUri",this.S$="starttime",this.z$="urn:dvb:dash:lowlatency:scope:2019",this.J$="urn:dvb:dash:lowlatency:critical:2019",this.Z$="XML",this.ARRAY_BUFFER="ArrayBuffer"}}]),s)();i["default"]=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r,s=n(50),e=(r=s)&&r.s?r:{"default":r},h=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/,o=(function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}(u,e["default"]),u);function u(){return function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,u),function(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?t:i}(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,function(t){return h.test(t.value)},function(t){var i=h.exec(t),n=void 0;if(n=Date.UTC(parseInt(i[1],10),parseInt(i[2],10)-1,parseInt(i[3],10),parseInt(i[4],10),parseInt(i[5],10),i[6]&&parseInt(i[6],10)||0,i[7]&&1e3*parseFloat(i[7])||0),i[9]&&i[10]){var r=60*parseInt(i[9],10)+parseInt(i[10],10);n+=("+"===i[8]?-1:1)*r*60*1e3}return new Date(n)}))}i["default"]=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r,s=n(50),e=(r=s)&&r.s?r:{"default":r},h=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,o=(function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}(u,e["default"]),u);function u(){return function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,u),function(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?t:i}(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,function(t){return h.test(t.value)},function(t){return parseFloat(t)}))}i["default"]=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=e(n(100)),s=e(n(51));function e(t){return t&&t.s?t:{"default":t}}var h=(function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}(o,r["default"]),o);function o(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,o);var t=[s["default"].iD,s["default"].bD,s["default"].yD,s["default"].TD,s["default"].OD,s["default"].mD,s["default"].cD,s["default"].Qk,s["default"].dD,s["default"]._D,s["default"].RD,s["default"].SD,s["default"].AD,s["default"].ID,s["default"].ND,s["default"].CD,s["default"].kD,s["default"].DD,s["default"].jD,s["default"].MD];return function(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?t:i}(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,s["default"].Yk,t,[new r["default"](s["default"].Kk,t,[new r["default"](s["default"].$k,t)])]))}i["default"]=h},function(t,i,n){"use strict";function r(t,i){for(var n=0;n<i.length;n++){var r=i[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.defineProperty(i,"s",{value:!0});var s=(function(t,i,n){return i&&r(t.prototype,i),n&&r(t,n),t}(e,[{key:"name",get:function(){return this.JB}},{key:"merge",get:function(){return this.tX}}]),e);function e(t){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,e);var i;this.JB=t,this.tX=(i=t)&&i.length&&i.charAt(0)===i.charAt(0).toUpperCase()}i["default"]=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=e(n(100)),s=e(n(51));function e(t){return t&&t.s?t:{"default":t}}var h=(function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}(o,r["default"]),o);function o(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,o);var t=[s["default"].Gk,s["default"].xk,s["default"].Bk];return function(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?t:i}(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,s["default"].zo,t,[new r["default"](s["default"].Yk,t,[new r["default"](s["default"].Kk,t)])]))}i["default"]=h},function(t,i,n){if(void 0===r)var r={};r.hB=function(t){return new s(t).parse()},r.iX={},r.iX.nX=function(t,i){var n=i||"utf-8";if("undefined"!=typeof TextDecoder)return new TextDecoder(n).decode(t);var r=[],s=0;if("utf-8"===n)for(;s<t.byteLength;){var e=t.getUint8(s++);e<128||(e<224?e=(31&e)<<6:(e<240?e=(15&e)<<12:(e=(7&e)<<18,e|=(63&t.getUint8(s++))<<12),e|=(63&t.getUint8(s++))<<6),e|=63&t.getUint8(s++)),r.push(String.fromCharCode(e))}else for(;s<t.byteLength;)r.push(String.fromCharCode(t.getUint8(s++)));return r.join("")},i.hB=r.hB,i.iX=r.iX,r.rX=function(t){this.offset=void 0===t?0:t};var s=function(t){this.sX=new DataView(t),this.eX=new r.rX(),this.hX=[]};s.prototype.fetch=function(t){var i=this.oX(t,!0);return i.length?i[0]:null},s.prototype.oX=function(t,i){var n=[];return s.uX.call(this,t,n,i),n},s.prototype.parse=function(){for(this.eX.offset=0,this.hX=[];this.eX.offset<this.sX.byteLength;){var t=e.parse(this);if(void 0===t.type)break;this.hX.push(t)}return this},s.uX=function(t,i,n){for(var r in this.type&&this.type==t&&i.push(this),this.hX){if(i.length&&n)return;s.uX.call(this.hX[r],t,i,n)}};var e=function(){this.eX=new r.rX()};e.parse=function(t){var i=new e();return i.aX=t.eX.offset,i.fX=t.fX?t.fX:t,i.sX=t.sX,i.cX=t,i.lX(),t.eX.offset=i.sX.byteOffset+i.sX.byteLength,i},e.prototype.vX=function(t){var i=null;switch(t){case 8:i=this.sX.getInt8(this.eX.offset-this.sX.byteOffset);break;case 16:i=this.sX.getInt16(this.eX.offset-this.sX.byteOffset);break;case 32:i=this.sX.getInt32(this.eX.offset-this.sX.byteOffset);break;case 64:var n=this.sX.getInt32(this.eX.offset-this.sX.byteOffset),r=this.sX.getInt32(this.eX.offset-this.sX.byteOffset+4);i=n*Math.pow(2,32)+r}return this.eX.offset+=t>>3,i},e.prototype.dX=function(t){var i=null;switch(t){case 8:i=this.sX.getUint8(this.eX.offset-this.sX.byteOffset);break;case 16:i=this.sX.getUint16(this.eX.offset-this.sX.byteOffset);break;case 24:i=((n=this.sX.getUint16(this.eX.offset-this.sX.byteOffset))<<8)+(r=this.sX.getUint8(this.eX.offset-this.sX.byteOffset+2));break;case 32:i=this.sX.getUint32(this.eX.offset-this.sX.byteOffset);break;case 64:var n=this.sX.getUint32(this.eX.offset-this.sX.byteOffset),r=this.sX.getUint32(this.eX.offset-this.sX.byteOffset+4);i=n*Math.pow(2,32)+r}return this.eX.offset+=t>>3,i},e.prototype.EX=function(t){for(var i="",n=0;n<t;n++){var r=this.dX(8);i+=String.fromCharCode(r)}return i},e.prototype.wX=function(){for(var t="";;){var i=this.dX(8);if(0==i)break;t+=String.fromCharCode(i)}return t},e.prototype.pX=function(t){return this.dX(t/2)+this.dX(t/2)/Math.pow(2,t/2)},e.prototype.lX=function(){if(this.eX.offset=this.aX,this.aX+8>this.sX.buffer.byteLength)this.fX.gX=!0;else{switch(this.size=this.dX(32),this.type=this.EX(4),1==this.size&&(this.bX=this.dX(64)),"uuid"==this.type&&(this.yX=this.EX(16)),this.size){case 0:this.sX=new DataView(this.sX.buffer,this.aX,this.sX.byteLength-this.eX.offset);break;case 1:this.aX+this.size>this.sX.buffer.byteLength?(this.gX=!0,this.fX.gX=!0):this.sX=new DataView(this.sX.buffer,this.aX,this.bX);break;default:this.aX+this.size>this.sX.buffer.byteLength?(this.gX=!0,this.fX.gX=!0):this.sX=new DataView(this.sX.buffer,this.aX,this.size)}!this.gX&&this.TX[this.type]&&this.TX[this.type].call(this)}},e.prototype.OX=function(){this.version=this.dX(8),this.flags=this.dX(24)},e.prototype.TX={},["moov","trak","tref","mdia","minf","stbl","edts","dinf","mvex","moof","traf","mfra","udta","meco","strk","vttc"].forEach(function(t){e.prototype.TX[t]=function(){for(this.hX=[];this.eX.offset-this.sX.byteOffset<this.sX.byteLength;)this.hX.push(e.parse(this))}}),e.prototype.TX.mX=function(){this.OX(),this._X=this.dX(32),this.entries=[];for(var t=1;t<=this._X;t++){var i={};1==this.version?(i.RX=this.dX(64),i.SX=this.vX(64)):(i.RX=this.dX(32),i.SX=this.vX(32)),i.AX=this.vX(16),i.IX=this.vX(16),this.entries.push(i)}},e.prototype.TX.NX=function(){this.OX(),this.CX=this.wX(),this.value=this.wX(),this.timescale=this.dX(32),this.kX=this.dX(32),this.DX=this.dX(32),this.id=this.dX(32),this.jX=new DataView(this.sX.buffer,this.eX.offset,this.sX.byteLength-(this.eX.offset-this.aX))},e.prototype.TX.MX=e.prototype.TX.XE=function(){this.data=new DataView(this.sX.buffer,this.eX.offset,this.sX.byteLength-(this.eX.offset-this.aX))},e.prototype.TX.PX=e.prototype.TX.LX=function(){for(this.HX=this.EX(4),this.UX=this.dX(32),this.FX=[];this.eX.offset-this.sX.byteOffset<this.sX.byteLength;)this.FX.push(this.EX(4))},e.prototype.TX.GX=function(){this.OX(),this.xX=this.dX(32),this.BX=this.EX(4),this.ld=[this.dX(32),this.dX(32),this.dX(32)],this.name=this.wX()},e.prototype.TX.VX=function(){this.data=new DataView(this.sX.buffer,this.eX.offset,this.sX.byteLength-(this.eX.offset-this.aX))},e.prototype.TX.qX=function(){this.OX(),1==this.version?(this.QX=this.dX(64),this.YX=this.dX(64),this.timescale=this.dX(32),this.duration=this.dX(64)):(this.QX=this.dX(32),this.YX=this.dX(32),this.timescale=this.dX(32),this.duration=this.dX(32));var t=this.dX(16);this.pad=t>>15,this.language=String.fromCharCode(96+(t>>10&31),96+(t>>5&31),96+(31&t)),this.xX=this.dX(16)},e.prototype.TX.KX=function(){this.OX(),this.WX=this.dX(32)},e.prototype.TX.$X=function(){this.OX(),1==this.version?(this.QX=this.dX(64),this.YX=this.dX(64),this.timescale=this.dX(32),this.duration=this.dX(64)):(this.QX=this.dX(32),this.YX=this.dX(32),this.timescale=this.dX(32),this.duration=this.dX(32)),this.rate=this.pX(32),this.volume=this.pX(16),this.XX=this.dX(16),this.zX=[this.dX(32),this.dX(32)],this.matrix=[];for(var t=0;t<9;t++)this.matrix.push(this.pX(32));this.xX=[];for(t=0;t<6;t++)this.xX.push(this.dX(32));this.JX=this.dX(32)},e.prototype.TX.ZX=function(){var t=new DataView(this.sX.buffer,this.eX.offset,this.sX.byteLength-(this.eX.offset-this.aX));this.tz=r.iX.nX(t)},e.prototype.TX.iz=function(){this.OX(),this.nz=this.dX(32),this.timescale=this.dX(32),0==this.version?(this.rz=this.dX(32),this.sz=this.dX(32)):(this.rz=this.dX(64),this.sz=this.dX(64)),this.ld=this.dX(16),this.ez=this.dX(16),this.hz=[];for(var t=0;t<this.ez;t++){var i={},n=this.dX(32);i.oz=n>>31&1,i.uz=2147483647&n,i.az=this.dX(32);var r=this.dX(32);i.fz=r>>31&1,i.cz=r>>28&7,i.lz=268435455&r,this.hz.push(i)}},e.prototype.TX.vz=function(){this.OX(),this.dz=this.dX(32),this.Ez=[];for(var t=0;t<this.dz;t++){var i={};i.wz=this.dX(32),i.pz=[];for(var n=0;n<i.wz;n++){var r={};r.level=this.dX(8),r.gz=this.dX(24),i.pz.push(r)}this.Ez.push(i)}},e.prototype.TX.bz=function(){this.OX(),1==this.version?this.yz=this.dX(64):this.yz=this.dX(32)},e.prototype.TX.tfhd=function(){this.OX(),this.Tz=this.dX(32),1&this.flags&&(this.Oz=this.dX(64)),2&this.flags&&(this.mz=this.dX(32)),8&this.flags&&(this.default_sample_duration=this.dX(32)),16&this.flags&&(this._z=this.dX(32)),32&this.flags&&(this.Rz=this.dX(32))},e.prototype.TX.Sz=function(){this.OX(),1==this.version?(this.QX=this.dX(64),this.YX=this.dX(64),this.Tz=this.dX(32),this.XX=this.dX(32),this.duration=this.dX(64)):(this.QX=this.dX(32),this.YX=this.dX(32),this.Tz=this.dX(32),this.XX=this.dX(32),this.duration=this.dX(32)),this.zX=[this.dX(32),this.dX(32)],this.Az=this.dX(16),this.Iz=this.dX(16),this.volume=this.pX(16),this.Nz=this.dX(16),this.matrix=[];for(var t=0;t<9;t++)this.matrix.push(this.pX(32));this.width=this.dX(32),this.height=this.dX(32)},e.prototype.TX.trun=function(){this.OX(),this.Cz=this.dX(32),1&this.flags&&(this.kz=this.vX(32)),4&this.flags&&(this.Dz=this.dX(32)),this.oB=[];for(var t=0;t<this.Cz;t++){var i={};256&this.flags&&(i.sample_duration=this.dX(32)),512&this.flags&&(i.jz=this.dX(32)),1024&this.flags&&(i.Mz=this.dX(32)),2048&this.flags&&(0==this.version?i.Pz=this.dX(32):i.Pz=this.vX(32)),this.oB.push(i)}},e.prototype.TX.Lz=function(){var t=new DataView(this.sX.buffer,this.eX.offset,this.sX.byteLength-(this.eX.offset-this.aX));this.Hz=r.iX.nX(t)},e.prototype.TX.Uz=function(){var t=new DataView(this.sX.buffer,this.eX.offset,this.sX.byteLength-(this.eX.offset-this.aX));this.config=r.iX.nX(t)},e.prototype.TX.Fz=function(){}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){}i.Representation=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e=n(4),r=n(0),h=n(1),o=n(2),u=function(t,i){this.name=t,this.iv=i},s=(a.prototype.init=function(){var i=this;try{this.Gz();var n=e.defer();this.xz().then(function(){return n.resolve(!0)}).fail(function(t){h.ErrorMonitor.getInstance().logError("Error initializing key",i.loggerId,o.Tn.mn,t),n.resolve(!1)}),this.Bz=n.promise}catch(t){h.ErrorMonitor.getInstance().logError("Error initializing AES Manager",this.loggerId,o.Tn.On,t)}},a.prototype.o$=function(){return this.Bz?this.Bz:e.resolve(!1)},a.prototype.xz=function(){var i=this;if(this.Vz)return this.Vz;var n=e.defer();return this.qz().then(function(t){window.crypto.subtle.importKey("raw",t,i.Qz,!1,["decrypt"]).then(function(t){n.resolve(t)},function(t){n.reject("error importing key: "+t.toString())})}).fail(function(t){return n.reject(t)}),this.Vz=n.promise,this.Vz},a.prototype.Gz=function(){for(var t=2,i=this.Yz.length,n=[];t<i;t+=2)n.push(parseInt(this.Yz.substr(t,2),16));this.iv=new Uint8Array(n)},a.prototype.decrypt=function(i){var n=this,r=e.defer(),s=new u(this.Qz,this.iv);return this.Vz.then(function(t){window.crypto.subtle.decrypt(s,t,i).then(function(t){r.resolve(t)})})["catch"](function(t){h.ErrorMonitor.getInstance().logError("Error decrypting arraybuffer",n.loggerId,o.Tn.Rn,t),n.failed=!0,n.Bz=e.resolve(!1),r.reject(t)}),r.promise},a.prototype.qz=function(){var i=this,n=e.defer(),r=new XMLHttpRequest();return r.responseType="arraybuffer",r.open("GET",this.Kz),this.Wz&&r.setRequestHeader("Authorization",this.Wz),r.onload=function(){if(200===r.status){var t=new Uint8Array(r.response);n.resolve(t)}else h.ErrorMonitor.getInstance().logError("Error downloading key",i.loggerId,o.Tn.Sn,r.status),n.reject("error downloading key - status: "+r.status)},r.onerror=function(){h.ErrorMonitor.getInstance().logError("Error downloading key",i.logger,o.Tn.An),n.reject("error downloading key")},r.send(),n.promise},a.prototype.zx=function(){return this.failed},a);function a(t,i,n){this.loggerId="[DASH AES Manager] ",this.Qz="AES-CBC",this.failed=!1,this.logger=r.Framework&&r.Framework.resolve(r.Framework.v.p)?r.Framework.resolve(r.Framework.v.p).log():console,this.Kz=t,this.Yz=i,this.logger.debug(this.loggerId+"Starting Dash AES Manager"),n&&(this.Wz=n)}i.Jx=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=(e.prototype.init=function(){},e.prototype.o$=function(){return r.resolve(!1)},e.prototype.decrypt=function(t){return r.reject("unsupported")},e.prototype.zx=function(){return!1},e);function e(){}i.Zx=s},function(i,n,r){var s;!function(){"use strict";var d={$z:/[^s]/,Xz:/[^t]/,zz:/[^T]/,Jz:/[^v]/,number:/[diefg]/,Zz:/[bcdiefguxX]/,json:/[j]/,tJ:/[^j]/,text:/^[^\x25]+/,iJ:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,nJ:/^\.([a-z_][a-z_\d]*)/i,rJ:/^\[(\d+)\]/,sign:/^[+-]/};function E(t){return function(t,i){var n,r,s,e,h,o,u,a,f,c=1,l=t.length,v="";for(r=0;r<l;r++)if("string"==typeof t[r])v+=t[r];else if("object"==typeof t[r]){if((e=t[r]).keys)for(n=i[c],s=0;s<e.keys.length;s++){if(null==n)throw new Error(E('[sprintf] Cannot access property "%s" of undefined value "%s"',e.keys[s],e.keys[s-1]));n=n[e.keys[s]]}else n=e.sJ?i[e.sJ]:i[c++];if(d.zz.test(e.type)&&d.Jz.test(e.type)&&n instanceof Function&&(n=n()),d.Zz.test(e.type)&&"number"!=typeof n&&isNaN(n))throw new TypeError(E("[sprintf] expecting number but found %T",n));switch(d.number.test(e.type)&&(a=0<=n),e.type){case"b":n=parseInt(n,10).toString(2);break;case"c":n=String.fromCharCode(parseInt(n,10));break;case"d":case"i":n=parseInt(n,10);break;case"j":n=JSON.stringify(n,null,e.width?parseInt(e.width):0);break;case"e":n=e.precision?parseFloat(n).toExponential(e.precision):parseFloat(n).toExponential();break;case"f":n=e.precision?parseFloat(n).toFixed(e.precision):parseFloat(n);break;case"g":n=e.precision?String(Number(n.toPrecision(e.precision))):parseFloat(n);break;case"o":n=(parseInt(n,10)>>>0).toString(8);break;case"s":n=String(n),n=e.precision?n.substring(0,e.precision):n;break;case"t":n=String(!!n),n=e.precision?n.substring(0,e.precision):n;break;case"T":n=Object.prototype.toString.call(n).slice(8,-1).toLowerCase(),n=e.precision?n.substring(0,e.precision):n;break;case"u":n=parseInt(n,10)>>>0;break;case"v":n=n.valueOf(),n=e.precision?n.substring(0,e.precision):n;break;case"x":n=(parseInt(n,10)>>>0).toString(16);break;case"X":n=(parseInt(n,10)>>>0).toString(16).toUpperCase()}d.json.test(e.type)?v+=n:(!d.number.test(e.type)||a&&!e.sign?f="":(f=a?"+":"-",n=n.toString().replace(d.sign,"")),o=e.eJ?"0"===e.eJ?"0":e.eJ.charAt(1):" ",u=e.width-(f+n).length,h=e.width&&0<u?o.repeat(u):"",v+=e.align?f+n+h:"0"===o?f+h+n:h+f+n)}return v}(function(t){if(u[t])return u[t];var i,n=t,r=[],s=0;for(;n;){if(null!==(i=d.text.exec(n)))r.push(i[0]);else if(null!==(i=d.iJ.exec(n)))r.push("%");else{if(null===(i=d.placeholder.exec(n)))throw new SyntaxError("[sprintf] unexpected placeholder");if(i[2]){s|=1;var e=[],h=i[2],o=[];if(null===(o=d.key.exec(h)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(e.push(o[1]);""!==(h=h.substring(o[0].length));)if(null!==(o=d.nJ.exec(h)))e.push(o[1]);else{if(null===(o=d.rJ.exec(h)))throw new SyntaxError("[sprintf] failed to parse named argument key");e.push(o[1])}i[2]=e}else s|=2;if(3===s)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");r.push({placeholder:i[0],sJ:i[1],keys:i[2],sign:i[3],eJ:i[4],align:i[5],width:i[6],precision:i[7],type:i[8]})}n=n.substring(i[0].length)}return u[t]=r}(t),arguments)}function t(t,i){return E.apply(null,[t].concat(i||[]))}var u=Object.create(null);n.gB=E,n.hJ=t,"undefined"!=typeof window&&(window.gB=E,window.hJ=t,void 0===(s=function(){return{gB:E,hJ:t}}.call(n,r,n,i))||(i.exports=s))}()},function(t,i,n){var r,s,e;s=[i],void 0===(e="function"==typeof (r=function(t){"use strict";var i,n;Object.defineProperty(t,"s",{value:!0});var r={YEAR:31536e3,MONTH:2628e3,DAY:86400,HOUR:3600,MINUTE:60,SECOND:1},u="years",a="months",f="days",c="hours",l="minutes",v="seconds",d=((i={}).oJ=0,i.uJ=0,i.aJ=0,i),E=((n={}).fJ=0,n.cJ=0,n.lJ=0,n),s=function(t){return/^-?P((([0-9]+Y([0-9]+M)?([0-9]+D)?|([0-9]+M)([0-9]+D)?|([0-9]+D))(T(([0-9]+H)([0-9]+M)?([0-9]+(\.[0-9]+)?S)?|([0-9]+M)([0-9]+(\.[0-9]+)?S)?|([0-9]+(\.[0-9]+)?S)))?)|(T(([0-9]+H)([0-9]+M)?([0-9]+(\.[0-9]+)?S)?|([0-9]+M)([0-9]+(\.[0-9]+)?S)?|([0-9]+(\.[0-9]+)?S))))$/.test(t)},w=function(t){return"string"==typeof t&&0<t.length},p=function(t){return"-"===t[0]},g=function(t){return t.slice(1)},o=function(t,i){var n=b(i);return function(t,i){return r[t.toUpperCase()]*i}(t,n)},b=function(t){var i=parseFloat(t);return isNaN(i)?0:i},e=function(t){var i=p(t),n=i?g(t):t,r=n.split("T"),s=g(r[0]),e=r[1],h=0;return w(s)&&(h+=function(t){var i=/^(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)D)?$/g.exec(t)||[],n=i[1],r=i[2],s=i[3];return o("year",n)+o("month",r)+o("day",s)}(s)),w(e)&&(h+=function(t){var i=/^(?:(\d+)H)?(?:(\d+)M)?(?:(\d+(?:\.\d+)?)S)?$/g.exec(t)||[],n=i[1],r=i[2],s=i[3];return o("hour",n)+o("minute",r)+o("second",s)}(e)),i?-h:h},h=t.vJ=function(t){var i,n=p(t),r=n?g(t):t,s=r.split("T"),e=g(s[0]),h=s[1],o=((i={}).dJ=n,i);return o=w(e)?Object.assign(o,function(t){var i,n=/^(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)D)?$/g.exec(t)||[],r=n[1],s=n[2],e=n[3];return(i={})[u]=b(r),i[a]=b(s),i[f]=b(e),i}(e)):Object.assign(o,d),o=w(h)?Object.assign(o,function(t){var i,n=/^(?:(\d+)H)?(?:(\d+)M)?(?:(\d+(?:\.\d+)?)S)?$/g.exec(t)||[],r=n[1],s=n[2],e=n[3];return(i={})[c]=b(r),i[l]=b(s),i[v]=b(e),i}(h)):Object.assign(o,E)};t["default"]=function(t,i){return function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if("string"==typeof t)return s(t)?i?h(t):e(t):null;throw new TypeError("expected input to be a string")}(t,i)}})?r.apply(i,s):r)||(t.exports=e)},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(97),o=n(4),u=(e=h.bB,s(a,e),a.prototype.hH=function(t){return o.resolve(!1)},a);function a(){return null!==e&&e.apply(this,arguments)||this}i.AA=u},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(96),o=n(52),u=(e=h.XH,s(a,e),a.prototype.ex=function(t){e.prototype.ex.call(this,t),this.metadata.EJ.has(t.k_())&&void 0===this.FH&&(this.FH=this.metadata.isLive())},a);function a(t,i){var n=e.call(this,t)||this;return n.metadata=o.Mj.SA({Yx:!1},i),n}i.e$=u},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(4),l=n(1),u=n(173),o=n(3),a=n(174),v=n(64),f=n(0),d=n(6),c=n(52),E=n(2),w=n(101),p=n(23),g=n(7),b=(e=w.Sx,s(y,e),y.prototype.getStreamProtocol=function(){return StreamProtocol.HLS},y.prototype.parse=function(i,n){try{var t=new u.wJ();if(t.push(n),t.manifest.playlists)this.pJ(i,t.manifest);else if(t.manifest.segments){var r=this.gJ(i,t.manifest);if(r&&r.bJ&&(this.live=!r.bJ.endList),this.live&&this.Kx.Yx){var s=this.yJ(t.manifest,n),e=s.TJ,h=s.OJ,o=s.mJ;return this.logger.debug("HLS manifest trimmed "+h+" segments ("+o+"s) - new segments:["+r._J.map(function(t){return t.id+":"+t.duration})+"]"),e}}else l.ErrorMonitor.getInstance().logError("Error parsing metadata",this.loggerId,E.sr.Fn,{detailedError:"Manifest has no bitrates or playlist has no segments",url:i});return n}catch(t){return l.ErrorMonitor.getInstance().logError("Error parsing metadata",this.loggerId,E.sr.Fn,{detailedError:t,url:i}),n}},y.prototype.BH=function(t,i){return this.RJ.has(i.id)?this.RJ.get(i.id).qx.get(t):null},y.prototype.HH=function(){return this.EJ.values().map(function(t){return t.qualityLevel})},y.prototype.MH=function(t){return null==this.Bx?null:this.Bx.get(t)},y.prototype.VH=function(i){try{var t=this.Bx.get(i);if(t){var n=t.qualityLevel;return this.RJ.get(n.id).qx.get(t.id+1)}return null}catch(t){return l.ErrorMonitor.getInstance().logError("Error getting the next segment info",this.loggerId,E.sr.Bn,{detailedError:t,url:i}),null}},y.prototype.S_=function(i){try{return c.Mj.yA(i,void 0,this.iB)?g.xa.qa:null!=this.MH(i)?g.xa.Va:g.xa.Qa}catch(t){return l.ErrorMonitor.getInstance().logError("Error getting the entityType",this.loggerId,E.ir.Nn,{detailedError:t,url:i}),g.xa.Qa}},y.prototype.SJ=function(t){return this.EJ.has(t)},y.prototype.AJ=function(){this.EJ=new o(),this.Bx=new o(),this.RJ=new o()},y.prototype.pJ=function(a,t){var f=this;this.UL=a,this.manifest=t,this.AJ(),this.IJ=!0,this.manifest.playlists.forEach(function(t){var i=t.uri,n=t.attributes,r=d.Ma(a,i),s=n.BANDWIDTH,e=n.NJ;Number.isInteger(s)||(l.ErrorMonitor.getInstance().logError("Segment Bitrate is a Float",{bitrate:s}),s=Math.round(s));var h=e?e.width:null,o=e?e.height:null,u=n.gL||null;f.CJ(r,s,h,o,u)})},y.prototype.CJ=function(t,i,n,r,s){var e=t.split("?")[0],h=p.ol.ib(e).toString(p.ol.jg.Mg),o=new a.kJ();o.qualityLevel=this.XF.add(g.xa.Va,{id:h,bitrate:i,width:n,height:r,label:s}),o.DJ=t,this.EJ.set(t,o),this.RJ.set(h,o)},y.prototype.gJ=function(e,t){var h=this;try{this.IJ||0!==this.XF.getAll().length||(this.AJ(),this.CJ(e,null,null,null,null));var o=this.EJ.get(e);if(!o)return void l.ErrorMonitor.getInstance().logError("Playlist url does not match any playlist in the master file",this.loggerId,E.sr.er,{url:e});var u=null!=t.mediaSequence?t.mediaSequence:0,a=[],i=u-1,f=o.qx.get(i),c=[];return t.segments.forEach(function(t){var i=d.Ma(e,t.uri),n=Math.round(1e3*t.duration),r=o.qualityLevel,s=new v.iH(u,r,n,t.uri,i,g.xa.Va);h.Bx.has(i)||c.push(s),h.Bx.set(i,s),o.qx.set(u,s),a.push(s),f&&(f.next=s),f=s,u++}),o.update(t.mediaSequence,t.discontinuitySequence,t.endList,t.targetDuration,a),{bJ:o,_J:c}}catch(t){return l.ErrorMonitor.getInstance().logError("Error updating the playlist",this.loggerId,E.sr.ur,t),null}},y.prototype.yJ=function(t,i){try{for(var n=i.split("\n"),r=Math.max(1,c.Mj.jj),s=null,e=0,h=0,o=t.segments.length-1;r-1<o&&(s=t.segments[o],!(e>=c.Mj.Dj));o--)h++,e+=s.duration;var u="";if(s){for(o=0;o<n.length&&(u=u+n[o]+"\n",n[o].trim()!==s.uri);o++);this.logger.debug("HLS trimmed "+h+" segments for total duration: "+e)}else u=n.join("\n")+"\n",this.logger.debug("HLS trimming disabled (minFragments = "+r+", segments.length = "+t.segments.length+")");return{TJ:u,OJ:h,mJ:e}}catch(t){throw l.ErrorMonitor.getInstance().logError("Error trimming the playlist",this.loggerId,E.sr.ar,t),new Error(t)}},y.prototype.hH=function(t){return h.resolve(!1)},y);function y(t,i){var n=e.call(this,t,i)||this;return n.loggerId="[HLS METADATA] ",n.EJ=new o(),n.IJ=!1,n.logger=(f.Framework.resolve(f.Framework.v.p)||console).log(),n}i._j=b},function(t,i,n){var r=function(){var e={Ay:{}};e.Ay.create=Object.create||function(t){function i(){}return i.prototype=t,new i()},e.Ay.jJ=function(t,i,n){for(var r in t)hasOwnProp.call(t,r)&&i.call(n||this,r,t[r])},e.Ay.mg=function(t,i){if(!i)return t;for(var n in i)hasOwnProp.call(i,n)&&(t[n]=i[n]);return t},e.Ay.MJ=function(t,i){var n,r,s;for(n in t=e.Ay.jN(t),i)hasOwnProp.call(i,n)&&(r=t[n],s=i[n],e.Ay.PJ(r)&&e.Ay.PJ(s)?t[n]=e.Ay.MJ(r,s):t[n]=i[n]);return t},e.Ay.jN=function(t){return e.Ay.mg({},t)},e.Ay.PJ=function(t){return!!t&&"object"==typeof t&&"[object Object]"===t.toString()&&t.constructor===Object},e.Ay.isArray=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};e.mergeOptions=function(t,i){var n,r,s;for(n in t=e.Ay.jN(t),i)i.hasOwnProperty(n)&&(r=t[n],s=i[n],e.Ay.PJ(r)&&e.Ay.PJ(s)?t[n]=e.util.mergeOptions(r,s):t[n]=i[n]);return t},(t=function(){this.init=function(){var e={};this.on=function(t,i){e[t]||(e[t]=[]),e[t].push(i)},this.off=function(t,i){var n;return!!e[t]&&(n=e[t].indexOf(i),e[t].splice(n,1),-1<n)},this.trigger=function(t){var i,n,r,s;if(i=e[t])for(s=Array.prototype.slice.call(arguments,1),r=i.length,n=0;n<r;++n)i[n].apply(this,s)},this.dispose=function(){e={}}}}).prototype.LJ=function(i){this.on("data",function(t){i.push(t)})},e.HJ=t;function h(t){for(var i,n=t.split(a),r=n.length,s={};r--;)""!==n[r]&&((i=/([^=]*)=(.*)/.exec(n[r]).slice(1))[0]=i[0].replace(/^\s+|\s+$/g,""),i[1]=i[1].replace(/^\s+|\s+$/g,""),i[1]=i[1].replace(/^['"](.*)['"]$/g,"$1"),s[i[0]]=i[1]);return s}var i,o,u,a=new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))'),t=e.HJ;return(i=function(){var n="";i.prototype.init.call(this),this.push=function(t){var i;for(i=(n+=t).indexOf("\n");-1<i;i=n.indexOf("\n"))this.trigger("data",n.substring(0,i)),n=n.substring(i+1)}}).prototype=new t(),(o=function(){o.prototype.init.call(this)}).prototype=new t(),o.prototype.push=function(t){var i,n;if(0!==(t=t.replace(/^\s+|\s+$/g,"")).length)if("#"===t[0])if(0===t.indexOf("#EXT"))if(t=t.replace("\r",""),i=/^#EXTM3U/.exec(t))this.trigger("data",{type:"tag",UJ:"m3u"});else{if(i=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(t))return n={type:"tag",UJ:"inf"},i[1]&&(n.duration=parseFloat(i[1])),i[2]&&(n.title=i[2]),void this.trigger("data",n);if(i=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(t))return n={type:"tag",UJ:"targetduration"},i[1]&&(n.duration=parseInt(i[1],10)),void this.trigger("data",n);if(i=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(t))return n={type:"tag",UJ:"totalduration"},i[1]&&(n.duration=parseInt(i[1],10)),void this.trigger("data",n);if(i=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(t))return n={type:"tag",UJ:"version"},i[1]&&(n.version=parseInt(i[1],10)),void this.trigger("data",n);if(i=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(t))return n={type:"tag",UJ:"media-sequence"},i[1]&&(n.number=parseInt(i[1],10)),void this.trigger("data",n);if(i=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(t))return n={type:"tag",UJ:"discontinuity-sequence"},i[1]&&(n.number=parseInt(i[1],10)),void this.trigger("data",n);if(i=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(t))return n={type:"tag",UJ:"playlist-type"},i[1]&&(n.playlistType=i[1]),void this.trigger("data",n);if(i=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(t))return n={type:"tag",UJ:"byterange"},i[1]&&(n.length=parseInt(i[1],10)),i[2]&&(n.offset=parseInt(i[2],10)),void this.trigger("data",n);if(i=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(t))return n={type:"tag",UJ:"allow-cache"},i[1]&&(n.jk=!/NO/.test(i[1])),void this.trigger("data",n);if(i=/^#EXT-X-STREAM-INF:?(.*)$/.exec(t))return n={type:"tag",UJ:"stream-inf"},i[1]&&(n.attributes=h(i[1]),n.attributes.NJ&&(r=n.attributes.NJ.split("x"),s={},r[0]&&(s.width=parseInt(r[0],10)),r[1]&&(s.height=parseInt(r[1],10)),n.attributes.NJ=s),n.attributes.BANDWIDTH&&(n.attributes.BANDWIDTH=parseInt(n.attributes.BANDWIDTH,10)),n.attributes.FJ&&(n.attributes.FJ=parseInt(n.attributes.FJ,10))),void this.trigger("data",n);var r,s;if(i=/^#EXT-X-ENDLIST/.exec(t))this.trigger("data",{type:"tag",UJ:"endlist"});else if(i=/^#EXT-X-DISCONTINUITY/.exec(t))this.trigger("data",{type:"tag",UJ:"discontinuity"});else{if(i=/^#EXT-X-KEY:?(.*)$/.exec(t))return n={type:"tag",UJ:"key"},i[1]&&(n.attributes=h(i[1]),n.attributes.IV&&("0x"===n.attributes.IV.substring(0,2)&&(n.attributes.IV=n.attributes.IV.substring(2)),n.attributes.IV=n.attributes.IV.match(/.{8}/g),n.attributes.IV[0]=parseInt(n.attributes.IV[0],16),n.attributes.IV[1]=parseInt(n.attributes.IV[1],16),n.attributes.IV[2]=parseInt(n.attributes.IV[2],16),n.attributes.IV[3]=parseInt(n.attributes.IV[3],16),n.attributes.IV=new Uint32Array(n.attributes.IV))),void this.trigger("data",n);this.trigger("data",{type:"tag",data:t.slice(4,t.length)})}}else this.trigger("data",{type:"comment",text:t.slice(1)});else this.trigger("data",{type:"uri",uri:t})},(u=function(){var t,n=this,r=[],s={};u.prototype.init.call(this),this.GJ=new i(),this.xJ=new o(),this.GJ.LJ(this.xJ),this.manifest={allowCache:!0},this.xJ.on("data",function(i){({tag:function(){({"allow-cache":function(){this.manifest.allowCache=i.jk,"allowed"in i||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var t={};"length"in i&&((s.byterange=t).length=i.length,"offset"in i||(this.trigger("info",{message:"defaulting offset to zero"}),i.offset=0)),"offset"in i&&((s.byterange=t).offset=i.offset)},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),0<=i.duration&&(s.duration=i.duration),this.manifest.segments=r},key:function(){i.attributes?"NONE"!==i.attributes.BJ?i.attributes.Rv?(i.attributes.BJ||this.trigger("warn",{message:"defaulting key method to AES-128"}),t={method:i.attributes.BJ||"AES-128",uri:i.attributes.Rv},void 0!==i.attributes.IV&&(t.iv=i.attributes.IV)):this.trigger("warn",{message:"ignoring key declaration without URI"}):t=null:this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(i.number)?this.manifest.mediaSequence=i.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+i.number})},"discontinuity-sequence":function(){isFinite(i.number)?this.manifest.discontinuitySequence=i.number:this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+i.number})},"playlist-type":function(){/VOD|EVENT/.test(i.playlistType)?this.manifest.playlistType=i.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+i.bJ})},"stream-inf":function(){this.manifest.playlists=r,i.attributes?(s.attributes||(s.attributes={}),s.attributes=e.mergeOptions(s.attributes,i.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},discontinuity:function(){s.discontinuity=!0},targetduration:function(){!isFinite(i.duration)||i.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+i.duration}):this.manifest.targetDuration=i.duration},totalduration:function(){!isFinite(i.duration)||i.duration<0?this.trigger("warn",{message:"ignoring invalid total duration: "+i.duration}):this.manifest.totalDuration=i.duration}}[i.UJ]||function(){}).call(n)},uri:function(){s.uri=i.uri,r.push(s),!this.manifest.targetDuration||"duration"in s||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),s.duration=this.manifest.targetDuration),t&&(s.key=t),s={}},comment:function(){}})[i.type].call(n)})}).prototype=new t(),u.prototype.push=function(t){this.GJ.push(t)},u.prototype.end=function(){this.GJ.push("\n")},e.VJ=i,e.qJ=o,e.wJ=u,e}();t.exports=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=(e.prototype.update=function(t,i,n,r,s){this.mediaSequence=t,this.discontinuitySequence=i,this.endList=n,this.targetDuration=r,this.segments=s,this.updated=!0},e);function e(){this.qx=new r()}i.kJ=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var s=n(3),r=(d.prototype.HY=function(t,i,n){return this.QJ.has(t)||(this.YJ(t,i,n),this.QJ.set(t,{KJ:d.WJ++,$J:i,XJ:n,events:{}})),this},d.prototype.YJ=function(t,i,n){if(!t[i])throw new Error(d.loggerId+"- method "+i+" is undefined in event target.");if(!t[n])throw new Error(d.loggerId+"- method "+n+" is undefined in event target.")},d.prototype.mY=function(t,i){if(!i){var n=this.QJ.keys(),r=n.length;if(1!==r)throw new Error(d.loggerId+"Incorrect use of non-targeted registerEvents; "+r+" registered");i=t,t=n[0]}var s=this.QJ.get(t);if(!s)throw new Error(d.loggerId+"- target not registered");for(var e=s.$J,h=s.KJ,o=[],u=0,a=Object.keys(i);u<a.length;u++){var f=a[u],c=i[f],l=void 0;if(l="function"==typeof c?c=c.bind(this.plugin):c.IY=c.IY.bind(this.plugin),!s.events[f])try{var v=this.registerEvent(t,e,f,l,c);s.events[f]=v,o.push(f)}catch(t){this.plugin.logger().warn(d.loggerId+" error binding event '"+f+"' on target #"+h+": "+t.toString())}}return this.plugin&&this.plugin.logger().debug(d.loggerId+"Registering events ["+o.join(", ")+"] on target #"+h),0<o.length},d.prototype.registerEvent=function(t,i,n,r,s){return t[i](n,r),s},d.prototype.SR=function(l){var v=this;void 0===l&&(l=!1),this.QJ.forEach(function(t,i){for(var n=t.XJ,r=t.events,s=t.KJ,e=[],h=0,o=Object.keys(r);h<o.length;h++){var u=o[h],a=r[u],f=void 0,c=void 0;if("function"==typeof a?f=a:(f=a.IY,c=a.CY),l||!c)try{v.zJ(i,n,u,f),delete r[u],e.push(u)}catch(t){v.plugin.logger().warn(d.loggerId+" error unbinding event '"+u+"' on target #"+s+": "+t.toString())}}l&&v.QJ["delete"](i),v.plugin&&v.plugin.logger().debug(d.loggerId+"Unregistering events ["+e.join(", ")+"] on target #"+s+" [destroy: "+l+"]")})},d.prototype.zJ=function(t,i,n,r){t[i](n,r)},d.prototype.reset=function(){var r=this;this.QJ.forEach(function(t,i){var n=t.KJ;r.QJ["delete"](i),r.plugin&&r.plugin.logger().debug(d.loggerId+"Reset on target #"+n)})},d.loggerId="[HiveEventsBinder] ",d.WJ=0,d);function d(t,i,n,r){this.QJ=new s(),this.plugin=t,i&&this.HY(i,n,r)}i.fR=r},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(4),o=n(60),u=n(0),a=n(177),f=n(103),c=n(19),l=n(92),v=n(239),d=n(28),E=n(47),w=n(46),p=n(15),g=n(240),b=n(1),y=n(30),T=n(35),O=n(32),m=(e=l.StatsJS,s(_,e),_.prototype.getName=function(){return _.dR},_.prototype.getVersion=function(){return this.plugin.getPluginVersion()},_.prototype.needsReportingInstance=function(){return!0},_.prototype.isReady=function(){return f["default"].getInstance?navigator&&navigator.userAgent&&this.JJ(navigator.userAgent)?h.resolve(!0):h.reject(new d.HiveTechError(d.wR.NOT_READY,"WebRTC DataChannels not supported by browser")):h.reject(new d.HiveTechError(d.wR.NOT_READY,"Not included in the page"))},_.prototype.initSession=function(s,e){var h=this;return this.isReady().then(function(){var t=e.ticket;h.JG();var i=t.VL();0===i.indexOf("//")&&(i=location.protocol+i);var n=h.$G(s,t,i,e),r=h.plugin.getPluginId();return O.aR.getInstance().register(h.plugin,n),w.HiveRequestFactory.register(h),window&&window.activateXHRInterceptor&&window.activateXHRInterceptor(h.plugin.loggerLevel()>y.JS.info,r),n})},_.prototype.isActive=function(t,i,n){void 0===n&&(n=!1);var r=i.manifest.toLowerCase(),s=t.toLowerCase(),e=r.indexOf(".ism/manifest");if(-1<e&&(!n||t===i.manifest)){var h=r.substring(0,e);if(-1<s.indexOf(h))return-1<s.indexOf(".ism/manifest(format=mpd-time-csf)")?this.ZJ?(i.ticket.BL(t),!0):this.tZ(i,"The player does not use HiveRequest, downgrading to StatsJS"):this.tZ(i,"Protocol not supported by HiveJS tech, downgrading to StatsJS")}else if(s===r)return!!this.ZJ||this.tZ(i,"The player does not use HiveRequest, downgrading to StatsJS");return!1},_.prototype.closeSession=function(t,i,n){window&&window.deactivateXHRInterceptor&&window.deactivateXHRInterceptor(),e.prototype.closeSession.call(this,t,i,n);var r=f["default"].getInstance();i?(w.HiveRequestFactory.clearPlugin(this.plugin.getPluginId()),O.aR.getInstance().unregister(this.plugin,t),r&&(r.onStateChange(this.plugin.getPluginId(),c.Il.STOP),r.iZ())):r&&r.onStateChange(this.plugin.getPluginId(),c.Il.IDLE)},_.prototype.tZ=function(t,i){return t.tech=this.vR,w.HiveRequestFactory.register(this.vR),this.ZJ&&this.ZJ.resolve(),this.ZJ=void 0,this.plugin.logger().warn("[HiveJS] "+i),this.onError(new d.HiveTechError(d.wR.SESSION_ERROR,i)),window&&window.deactivateXHRInterceptor&&window.deactivateXHRInterceptor(),!0},_.prototype.nZ=function(t){this.ZJ=t},_.prototype.resetTech=function(){},_.prototype.onActiveSession=function(r){var s=this;u.Framework.h().apply(new a.rZ(!0));var e=f["default"].getInstance();if(e.onStateChange(this.plugin.getPluginId(),c.Il.STOP),this.sZ()&&e.eZ(!0),e.start(r.reportingInstance,this.options_).then(function(t){if(s.JG(),s.ZG=r.reportingInstance,s.ZG.renderStatsCallback=s.options_.renderStatsCallback,s.ZG.xl(f["default"].cv()),s.ZG.Ql.init(s.ZG.Vl,r.ticket.sessionId),s.plugin.options().testId&&s.ZG.Vl.RU(s.plugin.options().testId),r.authenticationToken){var i=e.hZ(s.plugin.getPluginId());i&&i.oZ.j.qH(r.authenticationToken)}s.ZJ&&e.request(s.ZJ,s.plugin.getPluginId()),s.ZG.ql.manifestRequested(r.ticket.sessionId,s.plugin.getPlayerSource(),200);var n=s.plugin.flushTechEvents();n&&0<n.length&&s.ZG.ql.yS(n),s.plugin.updatePlayerInfo(s.ZG)}),null!=this.options().onActiveSession)try{this.options().onActiveSession(r.toHiveSession())}catch(t){b.ErrorMonitor.getInstance().logError("exception in user-defined onActiveSession callback","[HiveJS]",t)}},_.prototype.onStateChange=function(t,i){},_.prototype.$G=function(t,i,n,r){var s=new E.HiveSessionInternal(t,i,n,r,this.plugin.options().onSessionStateChange);return s.SDN=!0,s.id=s.ticket.sessionId,s},_.prototype.uZ=function(){},_.prototype.sZ=function(){var t=new o.OS();return t.mS(navigator.userAgent),"Android"==t._S().name},_.prototype.JJ=function(t){try{var i=new o.OS(t).cL();return"Mobile Safari"!==i.name&&("Safari"===i.name?12<=parseInt(i.KP,10):"function"==typeof RTCPeerConnection.prototype.createDataChannel)}catch(t){return!1}},_.prototype.getPluginId=function(){return this.plugin.getPluginId()},_.prototype.createManifestRequest=function(t){return new g.nx(t)},_.prototype.createRequest=function(t){return new T.VA(t)},_.prototype.supportsXhrInterception=function(){return!0},_.dR="HiveJS",_);function _(t,i,n){var r=e.call(this,t,i)||this;return r.options_=new v.HiveJSOptions(),null!=i[_.dR]&&p.updateOptions(i[_.dR],r.options_),r.vR=n,r}i.HiveJS=m},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(27),s=n(42),e=n(30),h=n(19),o=n(80),u=n(81),a=n(82),f=n(79),c=n(29),l=n(178),v=n(179),d=n(181),E=n(191),w=n(194),p=n(195),g=n(196),b=n(197),y=n(198),T=n(110),O=n(213),m=n(214),_=n(215),R=n(54),S=n(17),A=n(216),I=n(220),N=n(221),C=n(222),k=n(223),D=n(225),j=n(226),M=n(227),P=n(83),L=n(228),H=n(229),U=n(230),F=n(8),G=n(231),x=n(232),B=n(233),V=n(234),q=n(236),Q=n(237),Y=n(108),K=n(89),W=n(91),$=n(84),X=n(85),z=n(86),J=n(87),Z=n(88),tt=F.Y.rf,it=F.Y.sf,nt=F.Y.hf,rt=F.Y.vf,st=(et.prototype.apply=function(t){this.aZ?nt&&t.bind(new r.LR(s.v.jR,K.dG,r.HR.VR)):(rt?(t.bind(new r.LR(s.v.rk,h.Ev,r.HR.VR)),t.bind(new r.LR(s.v.jl,o._F,r.HR.VR))):(t.bind(new r.LR(s.v.rk,h.dv,r.HR.VR)),t.bind(new r.LR(s.v.jl,o.mF,r.HR.VR))),t.bind(new r.LR(s.v.vv,u.CF,r.HR.VR)),t.bind(new r.LR(s.v.Pl,a.GF,r.HR.VR)),t.bind(new r.LR(s.v.p,e.rA,r.HR.VR)),t.bind(new r.LR(s.v.zl,f.Zl,r.HR.XR)),t.bind(new r.LR(s.v.Jl,c.LS,r.HR.XR)),t.bind(new r.LR(s.v.vk,c.Zl,r.HR.XR)),t.bind(new r.LR(s.v.gk,$.WF,r.HR.XR)),t.bind(new r.LR(s.v.bk,X.zF,r.HR.XR)),t.bind(new r.LR(s.v.nv,z.nG,r.HR.XR)),t.bind(new r.LR(s.v.fk,Z.uG,r.HR.XR)),t.bind(new r.LR(s.v.HC,J.rG,r.HR.XR)),nt?t.bind(new r.LR(s.v.jR,K.dG,r.HR.VR)):t.bind(new r.LR(s.v.jR,W.WG,r.HR.VR))),t.bind(new r.LR(s.v.qC,V.fZ,r.HR.XR)),t.bind(new r.LR(s.v.ak,G.lx,r.HR.XR)),t.bind(new r.LR(s.v.tk,P.VF,r.HR.VR)),t.bind(new r.LR(s.v.Kc,l.Hu,r.HR.VR)),t.bind(new r.LR(s.v.PC,v.cZ,r.HR.XR)),t.bind(new r.LR(s.v.MC,d.ax,r.HR.XR)),t.bind(new r.LR(s.v.DC,w.Cache,r.HR.XR)),t.bind(new r.LR(s.v.VC,E.lZ,r.HR.XR)),t.bind(new r.LR(s.v.LC,p.vZ,r.HR.XR)),"undefined"!=typeof HiveOriginalXMLHttpRequest?t.bind(new r.LR(s.v.FC,HiveOriginalXMLHttpRequest)):t.bind(new r.LR(s.v.FC,XMLHttpRequest)),t.bind(new r.LR(s.v.lk,j.dZ,r.HR.VR)),t.bind(new r.LR(s.v.ck,g.EZ,r.HR.XR)),t.bind(new r.LR(s.v.Zc,A.wZ,r.HR.VR)),t.bind(new r.LR(s.v.uk,I.pZ,r.HR.VR)),t.bind(new r.LR(s.v.jC,M.gZ,r.HR.XR)),t.bind(new r.LR(s.v.WC,b.bZ,r.HR.XR)),t.bind(new r.LR(s.v.YC,y.Mu,r.HR.XR)),t.bind(new r.LR(s.v.ZC,T.hY,r.HR.XR)),t.bind(new r.LR(s.v.GC,x.yZ,r.HR.XR)),t.bind(new r.LR(s.v.$C,H.TZ,r.HR.XR)),t.bind(new r.LR(s.v.xC,U.OZ,r.HR.XR)),t.bind(new r.LR(s.v.XC,U.mZ,r.HR.XR)),t.bind(new r.LR(s.v.BC,L.Ru,r.HR.XR)),t.bind(new r.LR(s.v.zC,O._Z,r.HR.XR)),t.bind(new r.LR(s.v.ek,m.RZ,r.HR.XR)),t.bind(new r.LR(s.v.hk,_.SZ,r.HR.XR)),t.bind(new r.LR(s.v.ik,k.AZ,r.HR.XR)),t.bind(new r.LR(s.v.JC,R.mP,r.HR.XR)),t.bind(new r.LR(s.v.nk,D.IZ,r.HR.XR)),t.bind(new r.LR(s.v.dk,S.Al,r.HR.XR)),t.bind(new r.LR(s.v.sk,N.Cu,r.HR.XR)),t.bind(new r.LR(s.v.QC,B.NZ,r.HR.XR)),tt&&(t.bind(new r.LR(s.v.wk,Q.CZ,r.HR.XR)),t.bind(new r.LR(s.v.Ek,q.kZ,r.HR.XR))),it&&t.bind(new r.LR(s.v.sf,Y.Lq,r.HR.XR)),t.bind(new r.LR(s.v.KC,C.DZ,r.HR.XR))},et);function et(t){this.aZ=!1,t&&(this.aZ=t)}i.rZ=st},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e=n(4),r=n(23),h=n(0),o=n(5),s=n(19),u=n(3),a=n(53),f=n(49),c=n(8),l=n(1),v=n(2),d=c.Y.rf,E=c.Y.sf,w=c.Y.ef,p=(g.prototype.init=function(t,i,n){try{w?this.jZ(!1):i?this.jZ(!1):this.jZ(!0),this.tv.MZ(t),this.tv.setReportingGuid(this.reportingInstance.identity.av()),this.tv.PZ(i),this.gw.init(o.xu.Cache.jo,o.xu.Cache.Mo);var r=this.oZ.fM(t,n&&n.contextMatcher);this.tv.setContextId(this.oZ.j.getContextId()),this.reportingInstance.Vl._U.init(t,r),this.reportingInstance.Vl._U.$F(r.yM()),this.LZ.start(this.oZ,this.xV),(d||h.Framework.T()&&a.$j.Yj)&&this.UZ.HZ(this.xV);var s=[this.FZ,this.xV,this.partnership,this.LZ,this.reportingInstance.Vl,this.reportingInstance.ql,this.Yq];(d||h.Framework.T()&&a.$j.Yj)&&s.push(this.UZ),(E||h.Framework.T()&&a.$j.Kj)&&s.push(this.GZ),this.Jc.start(this.swarmId,s),this.reportingInstance.Vl.dF(this.partnership),this.reportingInstance.Vl.DU(this.tv)}catch(t){throw l.ErrorMonitor.getInstance().logError("Error initializing swarm object",this.loggerId,v.Ws.Xs,t),new Error(t)}},g.prototype.jZ=function(t){t&&"undefined"!=typeof navigator&&navigator.hardwareConcurrency?(this.tv.xZ(navigator.hardwareConcurrency),this.tv.BZ(navigator.hardwareConcurrency)):(this.tv.xZ(1),this.tv.BZ(1)),this.logger.debug(this.loggerId+"My score "+this.tv.jq())},g.prototype.VZ=function(t){return r.ol.ib(t).toString(r.ol.jg.Mg)},g.prototype.request=function(t){this.qZ(),this.hM.request(t)},g.prototype.QZ=function(){this.state!==s.Il.STOP?(this.xV.stop(),this.partnership.stop(),this.uM.YZ(),this.uM.KZ(),this.LZ.WZ(),this.UZ&&this.UZ.$Z(),this.reportingInstance.onStateChange(s.Il.IDLE),this.gw.XZ(),this.aM.zZ(),this.hM.JZ(),this.KH.ZZ(),h.Framework.clearTimeout(this.requestTimeout)):this.logger.debug("Ignoring changing state from Stop to Idle")},g.prototype.onStateChange=function(t,i){try{if(this.state!=t){switch(this.logger.info("Switching state "+s.Il[this.state]+" -> "+s.Il[t]),t){case s.Il.STOP:this.QZ(),this.Jc.stop(i);break;case s.Il.IDLE:this.QZ();break;case s.Il.Nl:this.xV.start(),this.partnership.start(this.oZ.j),this.uM.t0(),this.LZ.i0(),this.UZ&&this.UZ.n0(),this.reportingInstance.onStateChange(s.Il.Nl),this.KH.r0()}this.state=t}}catch(t){l.ErrorMonitor.getInstance().logError("Error changing peer status",this.loggerId,v.Ws.zs,t)}},g.prototype.qZ=function(){var t=this;try{h.Framework.clearTimeout(this.requestTimeout),this.onStateChange(s.Il.Nl),this.requestTimeout=h.Framework.setTimeout(function(){t.onStateChange(s.Il.IDLE)},o.xu.Hu.du)}catch(t){l.ErrorMonitor.getInstance().logError("Error requesting timeout",this.loggerId,v.Ws.xs,t)}},g);function g(t){this.state=s.Il.Nl,this.requestTimeout=-1;try{this.logger=h.Framework.resolve(h.Framework.v.p).log(t.ticket.sessionId),this.loggerId="[SWARM] ",this.Jc=h.Framework.resolve(h.Framework.v.Zc),this.sessionId=t.ticket.sessionId,this.reportingInstance=t,this.hM=h.Framework.resolve(h.Framework.v.PC),this.gw=h.Framework.resolve(h.Framework.v.DC),this.xV=h.Framework.resolve(h.Framework.v.YC),this.s0=h.Framework.resolve(h.Framework.v.LC),this.eM=h.Framework.resolve(h.Framework.v.WC),this.partnership=h.Framework.resolve(h.Framework.v.ZC),this.uploadScore=h.Framework.resolve(h.Framework.v.hk),this.e0=h.Framework.resolve(h.Framework.v.ek),this.LZ=h.Framework.resolve(h.Framework.v.ck),this.oM=h.Framework.resolve(h.Framework.v.zC),this.oZ=h.Framework.resolve(h.Framework.v.MC),this.dH=h.Framework.resolve(h.Framework.v.sk),this.tv=h.Framework.resolve(h.Framework.v.KC),this.WH=h.Framework.resolve(h.Framework.v.JC),this.uM=h.Framework.resolve(h.Framework.v.nk),this.aM=h.Framework.resolve(h.Framework.v.jC),this.Yq=h.Framework.resolve(h.Framework.v.BC),this.KH=h.Framework.resolve(h.Framework.v.ak),this.h0=h.Framework.resolve(h.Framework.v.QC),this.FZ=h.Framework.resolve(h.Framework.v.qC),(d||h.Framework.T()&&a.$j.Yj)&&(this.o0=h.Framework.resolve(h.Framework.v.Ek),this.UZ=h.Framework.resolve(h.Framework.v.wk)),(E||h.Framework.T()&&a.$j.Kj)&&(this.GZ=h.Framework.resolve(h.Framework.v.sf)),this.swarmId=this.VZ(t.ticket.CS()),this.KH.init(this),this.s0.init(this),this.aM.init(this),this.Yq.init(this),this.partnership.init(this),this.e0.init(this),this.LZ.init(this),this.oM.init(this),this.oZ.init(this),this.hM.init(this),this.xV.init(this),this.WH.init(this),this.uM.init(this),this.dH.init(this),this.h0.init(this),this.FZ.init(this),(E||h.Framework.T()&&a.$j.Kj)&&this.GZ.init(this),(d||h.Framework.T()&&a.$j.Yj)&&this.UZ.init(this)}catch(t){throw l.ErrorMonitor.getInstance().logError("Error constructing swarm object",this.loggerId,v.Ws.$s,t),new Error(t)}}i.u0=p;var b=(y.prototype.start=function(t,i){this.logger=h.Framework.resolve(h.Framework.v.p).log(t.ticket.sessionId);var n=t.ticket,r=n.pluginId;if(this.a0.has(r))this.logger.warn("SESSION ALREADY ACTIVE "+r);else{f.Lk.oS(t.Wl.client,n.YL(),t.identity.av());var s=new p(t);s.init(n,this.f0,i),this.kS.getConnectivityInfo().then(function(t){var i=t.getNetworkChanged().getPrivateIp();i&&s.tv.bG(i)}).done(),t.Vl.vF(this.kS),this.logger.info("PEER CONTEXT STARTED"),this.a0.set(r,s),this.c0.set(s.swarmId,r)}return 1!=this.a0.length&&!this.l0||h.Framework.T()||(this.v0.init(),this.l0=!1),e.resolve(n.xL())},y.prototype.iZ=function(){this.l0=!0},y.prototype.Yc=function(t){if(this.c0.has(t)){var i=this.c0.get(t);return this.a0.get(i)}return null},y.prototype.hZ=function(t){return this.a0.get(t)},y.prototype.d0=function(t){return this.a0.has(t)?this.a0.get(t).hM:null},y.prototype.request=function(t,i){this.hZ(i).request(t)},y.prototype.onStateChange=function(t,i){var n=this.hZ(t);n&&(n.onStateChange(i,n.swarmId),i===s.Il.STOP&&this.a0["delete"](t))},y.prototype.abort=function(t,i){var n=this.d0(i);n&&n.abort(t)},y.prototype.eZ=function(t){this.f0=t},y.prototype.E0=function(t,i){this.kS.vG(t)},y);function y(){this.a0=new u(),this.c0=new u(),this.l0=!1,this.v0=h.Framework.resolve(h.Framework.v.lk),this.kS=h.Framework.resolve(h.Framework.v.jR),this.f0=!1}i.Hu=b},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(4),a=n(24),f=n(6),e=n(5),h=n(0),c=n(7),o=n(180),u=n(6),l=n(1),v=n(2),d=(E.prototype.init=function(t){this.logger=h.Framework.resolve(h.Framework.v.p).log(t.sessionId),this.eM=t.eM,this.gw=t.gw,this.partnership=t.partnership,this.Vl=t.reportingInstance.Vl,this.sessionId=t.reportingInstance.ticket.sessionId,this.s0=t.s0,this.oM=t.oM,this.w0=t.oZ,this.tv=t.tv,this.aM=t.aM,this.KH=t.KH,this.p0=t.uM,this.renderStats=new o.g0(t.reportingInstance),this.Vl.SU(this.b0)},E.prototype.request=function(t){try{var i=t.url;this.logger.info("HIVE REQ "+i),t.y0=h.Framework.time();var n=this.w0.T0(t),r=n.V_(t.url);this.KH.vx(r),this.BM(t,r,n,a.h_.o_)}catch(t){l.ErrorMonitor.getInstance().logError("Error on player request",this.loggerId,v.Bs.Vs,t)}},E.prototype.BM=function(n,t,i,r){var s=this;if(t.M_()){if(t.S_()!=c.xa.Va)return this.O0(n,t,i,r);var e=i.hH(t,r);if(e.TH)return this.logger.debug("DO NOT CONTINUE WITH THE REQUEST "+t.I_()+". ALREADY REQUESTED  "+e.EH+" PENDING REQUEST "+e.yH),null;if(e.yH&&r==a.h_.o_){var h=this.m0(n,t,i,r);return 0<h.length?(h.forEach(function(t){var i=s._0.get(t);s._0.set(n.id,i),s._0["delete"](t)}),null):(this.logger.info("PREFETCH UPGRADE FAILED. THIS SHOULD NOT HAPPEN. CHECK FOR MULTIPLE PLAYER REQUESTS FOR THE SAME FRAGMENT"),this.O0(n,t,i,r))}return this.O0(n,t,i,r)}var o=f._a.next(),u=new a.J_(n,o,r,t,i);return this._0.set(n.id,u),u.type=a.h_.u_,this.R0(u),u},E.prototype.O0=function(t,i,n,r){var s=this,e=f._a.next(),h=new a.J_(t,e,r,i,n);if(this._0.set(t.id,h),i.S_()==c.xa.Va&&(n.mH(h),r!==a.h_.a_&&r!==a.h_.l_)){var o=i.getQualityLevel(),u=this.tv.ZF();o&&(this.tv.JF(o),this.p0.Oq(this.tv.lP()||this.tv.zM()),u&&o.id===u.id||(this.S0=!0,this.A0=0),this.S0&&this.A0++,this.A0===this.I0&&(this.partnership.XQ(),this.S0=!1,this.A0=0))}return this.N0(i.I_()).then(function(t){s.KH.C0(h,t),s.k0(h,t),n._H(h.I_(),h.N_()),n.IH(i.getQualityLevel())})["catch"](function(){s.D0(i,h),h.S_()==c.xa.Va&&(n.SH(h),h.type==a.h_.o_&&s.b0.add(0))}),h},E.prototype.m0=function(t,i,n,r){return n.OH(t,i,r)},E.prototype.N0=function(t){return this.gw.get(t)},E.prototype.D0=function(t,i){this.eM.contains(t.I_())?(this.logger.debug("OBJ IDX CONTAINS "+i.I_()),i.R_()==a.h_.a_&&(i.type=a.h_.l_),this.v_(i)):i.R_()!=a.h_.l_?this.R0(i):(l.ErrorMonitor.getInstance().logError("P2P PREFETCH FAILED BECAUSE OBJECT INDEX DOES NOT CONTAIN REQUEST ENTITY",this.loggerId,{vA:i.I_()}),i.z_._H(i.I_(),i.N_()))},E.prototype.JZ=function(){var i=this;this._0.forEach(function(t){return i.abort(t.X_)})},E.prototype.abort=function(t){if(this._0.has(t.id)){var i=this._0.get(t.id);try{var n=i.N_();this.logger.debug("REQUEST "+n+" ABORTED "),this.oM.Ze(n)?this.oM.j0(n):this.s0.Ze(n)&&this.s0.j0(n),this._0["delete"](t.id)}catch(t){l.ErrorMonitor.getInstance().logError("Error occurred while aborting the request",this.loggerId,v.Bs.qs,t)}}},E.prototype.v_=function(t){t.type==a.h_.o_&&(t.type=a.h_.c_),t.type==a.h_.l_&&(t.Y_=!0),this.oM.request(t)},E.prototype.M0=function(t){if(0!=t.W_&&(t.L_.E_=t.W_,this.logger.info("ALREADY DOWNLOADED "+t.L_.E_+" BYTES"),t.L_.w_=t.W_),!e.xu.Du.Vo&&t.W_&&(t.L_.E_=0),this.KH.P0(t),t.type!=a.h_.l_)t.type=a.h_.f_,this.R0(t);else if(t.S_()==c.xa.Va){t.z_.RH(t.I_()),t.z_._H(t.I_(),t.N_());var i=t.A_;i.getQualityLevel()&&t.z_.IH(i.getQualityLevel())}},E.prototype.L0=function(t){var i=this;this.logger.info("SUCCESS FROM P2P FOR "+t.k_()+" [REQ "+t.C_+"] ["+a.h_[t.type]+"] AFTER "+t.H_()+" [bw:"+t.U_().Ta()+"]"),this.H0(t),this.U0(t,this.oH(t.type)),this.aM.F0(t);var n=this.s0.G0().ga();this.KH.x0(t,n),this.B0(t).then(function(){t.z_.DH(t),i.V0()})["finally"](function(){i.oH(t.type)&&i.q0(t),i._0["delete"](t.X_.id)})},E.prototype.Q0=function(t){if(t.type!=a.h_.l_)t.type=a.h_.o_,this.R0(t);else if(t.S_()==c.xa.Va){t.z_.RH(t.I_()),t.z_._H(t.I_(),t.N_());var i=t.A_;i.getQualityLevel()&&t.z_.IH(i.getQualityLevel())}},E.prototype.R0=function(t){t.z_.QH().Y0(t.X_),this.KH.hx(t),this.s0.request(t)},E.prototype.K0=function(t){this.V0();var i=this.s0.G0().ga();this.KH.px(t,i),t.S_()==c.xa.Va&&(t.z_.RH(t.I_()),t.z_._H(t.I_(),t.N_())),this.W0(t)},E.prototype.$0=function(t){var i=this;this.H0(t),this.U0(t,this.oH(t.type)),t.type==a.h_.f_&&this.logger.debug("CDN COMPENSATION TIME "+(t.L_.m_-t.X_.y0)+" / "+(t.L_.m_-t.L_.y_)+" P2P TIME "+(t.L_.O_-t.L_.T_)),-1==[c.xa.qa,c.xa.Qa].indexOf(t.S_())&&this.aM.F0(t);var n=this.s0.G0().ga();this.KH.wx(t,n),this.B0(t).then(function(){t.S_()==c.xa.qa&&t.z_.ex(t),-1==[c.xa.qa,c.xa.Qa].indexOf(t.S_())&&t.z_.DH(t),i.V0()})["catch"](function(t){i.logger.error(t)})["finally"](function(){i.oH(t.type)&&i.q0(t),i._0["delete"](t.X_.id)})},E.prototype.H0=function(t){t.type==a.h_.l_&&(t.L_.p2pAgenTrafficSuccessQt=t.L_.E_),t.type==a.h_.a_&&(t.L_.b_=t.L_.g_,t.Q_&&(t.L_.srcOtherRespQt=t.L_.g_)),t.L_.d_=t.L_.g_+t.L_.E_,t.X_.total=t.L_.d_},E.prototype.U0=function(t,i){if(this.X0(t),t.X_.total=t.size,i){var n=f.createEvent(ProgressEvent,"progress",{lengthComputable:!0,total:t.L_.d_,loaded:t.L_.d_,currentTarget:t.X_});t.X_.dispatchEvent(n),t.A_.cA()||(t.X_.response=t.G_(),t.X_.responseText=t.G_())}},E.prototype.q0=function(t){var i=t.X_,n=h.Framework.T()?i.total:t.F_?t.F_.byteLength:0;this.logger.info("RESPOND TO THE PLAYER "+t.I_()+" SIZE "+n),i.status=200,i.statusText="OK",i.readyState=4,"string"==typeof i.response&&"arraybuffer"===i.responseType&&(i.response=f.Ua(i.response)),"text"!=i.responseType&&""!=i.responseType&&delete i.responseText,t.A_.cA()&&(i.response=h.Framework.T()?null:f.Sa(t.F_));var r=f.createEvent(Event,"readystatechange",{currentTarget:i}),s=f.createEvent(ProgressEvent,"load",{bubbles:!1,cancelable:!1,lengthComputable:!1,total:n,currentTarget:i,loaded:n}),e=f.createEvent(ProgressEvent,"loadend",{bubbles:!1,cancelable:!1,lengthComputable:!1,loaded:n,total:0,currentTarget:i});i.dispatchEvent(r),i.dispatchEvent(s),i.dispatchEvent(e)},E.prototype.W0=function(t){this._0["delete"](t.X_.id);var i=t.X_,n={bubbles:!1,cancelable:!1,lengthComputable:!1,loaded:i.total,total:0,currentTarget:i};t.xhr.status&&0<t.xhr.status?(i.status=t.xhr.status,i.K_=t.K_):i.status=404,i.readyState=4,i.dispatchEvent(f.createEvent(Event,"readystatechange",n)),i.dispatchEvent(f.createEvent(ProgressEvent,"load",n)),i.dispatchEvent(f.createEvent(ProgressEvent,"loadend",n))},E.prototype.B0=function(t){var i=this;return t.A_.M_()?this.gw.put(t).then(function(){return i.partnership.z0(t.A_,t.L_.d_,t.partner)})["catch"](function(t){s.resolve(!0)}):s.resolve(!0)},E.prototype.k0=function(t,i){var n=this;t.F_=i.data,t.K_=i.headers,t.J0=i.J0,t.L_=i.L_,t.size=i.length;var r=t.z_.GH().vV(i.length);this.logger.info("SCHEDULE DELIVERY OF "+t.I_()+" IN "+r+" SIZE "+(h.Framework.T()?i.length:t.F_.byteLength)+" BYTES"),h.Framework.setTimeout(function(){n.Z0(t)},r)},E.prototype.Z0=function(t){this.logger.debug("DELIVERY OF "+t.I_()),this.U0(t,!0),this._0["delete"](t.X_.id);var i=t.X_.y0-t.L_.m_;this.logger.info("FRAGMENT PREFETCHED "+i+" MSECS BEFORE PLAYER REQUEST"),0<i&&t.S_()==c.xa.Va&&this.b0.add(i);var n=0;n=0<t.L_.T_?t.X_.y0-t.L_.T_:t.X_.y0-t.L_.O_,this.logger.info("FRAGMENT REQUESTED "+n+" MSECS BEFORE PLAYER REQUEST"),this.q0(t)},E.prototype.oH=function(t){return t!=a.h_.l_&&t!=a.h_.a_},E.prototype.X0=function(t){if(t.type!==a.h_.f_)t.K_=t.X_.K_=t.K_;else{var i="\nContent-Range: bytes=0-"+(t.size-1)+"/"+t.size+"\n";i+="Content-Length: "+t.size+"\n",t.K_=t.X_.K_=i}null==t.K_?t.K_="access-control-allow-origin: *":-1==t.K_.toLowerCase().indexOf("access-control-allow-origin")&&(t.K_=t.K_.trim()+"\naccess-control-allow-origin: *\n")},E.prototype.V0=function(){!h.Framework.T()&&this.renderStats&&this.renderStats.render()},E);function E(){this._0=new r(),this.S0=!1,this.A0=0,this.loggerId="[HiveCache] ",this.I0=5,this.b0=new u.ta()}i.cZ=d},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var u=n(28),r=(s.prototype.t1=function(t){t.uuid=this.reportingInstance.Vl.uS;var i=this.reportingInstance.Vl.Ul.gU,n=this.i1(i.p2pSubRespQt),r=this.i1(i.srcRespQt);t.cdnRequests+=this.i1(i.srcReqN),t.cdnResponses+=this.i1(i.srcRespN),t.cdnResponseErrors+=this.i1(i.srcRespErrN),t.cdnResponseBytes+=this.i1(i.srcRespQt),t.p2pRequests+=this.i1(i.p2pSubReqN),t.p2pResponses+=this.i1(i.p2pSubRespN),t.p2pResponseErrors+=this.i1(i.p2pSubRespErrN),t.p2pResponseBytes+=this.i1(i.p2pSubRespQt),t.savings=this.i1(n/(r+n)*100)},s.prototype.i1=function(t){return t||0},s.prototype.n1=function(e){var h=this;e.uuid=this.reportingInstance.Vl.uS;var t=this.reportingInstance.Vl.Ul.yU,o=this.reportingInstance.Vl.Ul.TU;t.forEach(function(t,i){e.partners[i]||(e.partners[i]=new u.HivePartnerStats());var n=e.partners[i];n.uuid=i;var r=h.i1(t.p2pSuccSent);n.sentBytes+=r,e.p2pPartnerTotalSentBytes+=r;var s=h.i1(t.p2pSuccReceived);n.receivedBytes+=s,n.successTransfers+=h.i1(t.p2pSuccReq),n.failedTransfers+=h.i1(t.p2pFailReq),o.has(i)&&(n.rateReceived=o.get(i).rateReceived),n.lastUpdated=Date.now()})},s.prototype.render=function(){var t=this.reportingInstance.renderStatsCallback;if(t){var i=new u.HiveClientStats();this.t1(i),this.n1(i);try{t(i)}catch(t){}}},s);function s(t){this.reportingInstance=t}i.g0=r},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(182),o=n(189),u=n(0),a=n(102),f=(e=a.eV,s(c,e),c.prototype.init=function(t){this.logger=u.Framework.resolve(u.Framework.v.p).log(t.sessionId),this.GV=t,this.partnership=t.partnership},c.prototype.nV=function(t,i){return new o.e$(t,this.GV,i?i.hls:void 0)},c.prototype.rV=function(t,i){return new h.h$(t,this.GV,i?i.dash:void 0)},c.prototype.sV=function(i){var n=this;null!=this.partnership?this.partnership.stop().then(function(t){n.partnership.start(i)}):this.partnership.start(i)},c.prototype.T0=function(t){if(null==this.j)this.logger.warn("FIRST REQUEST, COULD NOT FIND RIGHT CONTEXT "+t.url);else if(!this.j.s1(t))return this.logger.warn("REQUEST DOES NOT BELONG TO THE CURRENT CONTEXT "+t.url),null;return this.j},c);function c(){var t=null!==e&&e.apply(this,arguments)||this;return t.partnership=null,t}i.ax=f},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(65),o=n(33),u=n(188),c=n(7),l=n(31),a=n(35),f=n(0),v=n(1),d=n(2),E=n(6),w=n(105),p=(e=h.XH,s(g,e),g.prototype.V_=function(i){var t=c.xa.Qa,n=0,r=null,s=0,e=!0,h=!1,o=0;try{if(t=this.S_(i),this.metadata.nB(i))e=!0;else if(t!=c.xa.qa){var u=this.metadata.MH(i);if(null!=u){n=u.duration,r=u.qualityLevel,s=u.id,h=this.M_(i);var a=this.metadata.rB(i)/1e3;o=Math.round(n/a)}else{this.qM(),this.logger.warn("could not extract segment info for "+i);var f=this.metadata.tB(i);f?(this.logger.warn("representation is",f),this.logger.warn("representation holds",f.Bx.map(function(t,i){return i+" => "+t.id}))):this.logger.warn("no representation found for "+i)}}else e=!1;return new l.dA(i,t,e,s,o,r,h,this.getContextId())}catch(t){return v.ErrorMonitor.getInstance().logError("Error getting the entity characteristics based on a url",this.loggerId,d.In.Cn,{detailedError:t,url:i}),new l.dA(i,c.xa.Qa,!1,0,0,null,!1,this.getContextId())}},g.prototype.$M=function(){return e.prototype.nH.call(this,o.Dash.NA,o.Dash.CA)},g.prototype.s1=function(i){try{var t=i.url,n=E.La(t);return E.La(this.metadata.xL()),n===E.La(this.UL)||!(null==this.metadata||!this.metadata.nB(t))||!(o.Dash.yA(t,this.logger,this.metadata.iV())&&this.metadata.xL()!==t&&!o.Dash._A(this.metadata.xL(),t))}catch(t){return v.ErrorMonitor.getInstance().logError("Error identifying if is current context",this.loggerId,d.In.Dn,{detailedError:t,url:i.url}),!1}},g.prototype.ex=function(i){try{this.e1=f.Framework.time();var t=i.G_(),n=i.X_.url,r=this.metadata.parse(n,t,i.X_.internal);this.h1._V(),void 0===this.FH&&(this.FH=this.metadata.isLive()),i.X_.responseText=r,i.X_.response=r,this.o1()}catch(t){v.ErrorMonitor.getInstance().logError("Error parsing received metadata",this.loggerId,d.In.jn,{detailedError:t,url:i.X_.url}),i.G_()&&(i.X_.responseText=i.G_(),i.X_.response=i.G_())}try{this.lH.DM()}catch(t){v.ErrorMonitor.getInstance().logError("Error starting prefetcher after fetching metadata",this.loggerId,d.In.Mn,{detailedError:t,url:i.X_.url})}this.u1()},g.prototype.DH=function(i){var n=this;try{e.prototype.DH.call(this,i),i.S_()!==c.xa.Va&&i.S_()!==c.xa.Ba||(i.S_()===c.xa.Va&&this.xH.wV(i),this.metadata.hH(i).then(function(t){t&&n.u1(),i.S_()==c.xa.Va&&n.lH.SM(i.A_)}).done())}catch(t){v.ErrorMonitor.getInstance().logError("Error when received a fragment",this.loggerId,d.In.Pn,t)}},g.prototype.getContextId=function(){return this.ticket.KL()},g.prototype.hH=function(t,i){var n=t;return n.sH=f.Framework.time(),e.prototype.hH.call(this,n,i)},g.prototype.iP=function(t,i,n,r){return this.metadata.iP(t,i,n,r)},g.prototype.u1=function(){var n=this;try{this.metadata.Xx?this.metadata.Xx.o$().then(function(t){if(t)n.a1=!0,n.logger.debug("Protection evaluation: can decrypt");else{var i="Protection evaluation: cannot decrypt ["+(o.Dash.MA?"error":"disabled")+"]";o.Dash.PA?(n.a1=!0,n.logger.debug(i+", metadata prefetch enabled")):n.logger.warn(i+", metadata prefetch DISABLED")}}).done():this.logger.debug("Protection evaluation: not encrypted")}catch(t){if(v.ErrorMonitor.getInstance().logError("Error evaluating the protection",this.loggerId,d.In.Ln,t),o.Dash.PA){var i="Protection evaluation: cannot decrypt ["+(o.Dash.MA?"error":"disabled")+"]";this.a1=!0,this.logger.debug(i+", metadata prefetch enabled")}}},g.prototype.qM=function(){this.a1&&(null==this.f1&&this.metadata.isLive()?this.c1():this.logger.debug("DASH PRE-FETCHING METADATA ALREADY SCHEDULED OR NOT LIVE"))},g.prototype.o1=function(){this.a1&&null!=this.f1&&(f.Framework.clearTimeout(this.f1),this.f1=null)},g.prototype.c1=function(){var t=this,i=(null!=this.e1?this.e1:0)+o.Dash.kA,n=Math.max(1,i-f.Framework.time()+o.Dash.LA);this.logger.debug("DASH PREFETCHING METADATA "+this.metadata.xL()+" IN "+n),this.f1=f.Framework.setTimeout(function(){t.l1(t.metadata.xL(),f.Framework.time())},n)},g.prototype.l1=function(t,i){var n=this.e1;if(null==n&&(n=0),i<n&&this.c1(),this.metadata&&this.metadata.Gx)this.f1=null,this.e1=f.Framework.time();else{var r=new a.VA(this.ticket.pluginId);r.open("GET",t),r.internal=!0,r.send(),this.f1=null,this.e1=f.Framework.time()}},g.prototype.ZM=function(t,i){try{var n=this.wM(),r=this.CH(),s=n.uA(),e=this.metadata.iP(s,n.getQualityLevel(),t,i),h=f.Framework.time()-r;return Math.max(0,e-h)}catch(t){return v.ErrorMonitor.getInstance().logError("Error calculating the distance duration",this.loggerId,d.In.Hn,t),0}},g.prototype.sB=function(t,i){return this.metadata.sB(t,i)},g.prototype.v1=function(){return o.Dash.jA},g.prototype.tP=function(){return o.Dash.DA},g);function g(t,i,n){var r=e.call(this,t,i)||this;return r.loggerId="[Dash Context] ",r.a1=!0,r.xH=new u.d1(i.tv),r.metadata=o.Dash.SA(r.UL,{Yx:!0},i.sessionId,n),r.h1=new w.CV(r.metadata),r}i.h$=p},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){this.EH=!1,this.yH=!1,this.TH=!1}i.cH=r},function(t,i,n){"use strict";t.exports=h;n(10);var r=n(11),s=n(12),e=n(40);function h(t,i,n,r){if(!(this instanceof h))return new h(t,i,n,r);Array.isArray(t)?t=(this.array=t).splice(0,t.length):this.array=[],this.Re=i||Object.equals,this._f=n||Object.compare,this.Ae=r||Function._e,this.length=0,this.hiveAddEach(t)}function o(t,i,n){for(var r=0,s=t.length-1;r<=s;){var e=r+s>>1,h=n(i,t[e]);if(0<h)r=1+e;else{if(!(h<0))return e;s=e-1}}return-(r+1)}function u(t,i,n,r){var s=o(t,i,n);if(s<0)return-1;for(;0<s&&r(i,t[s-1]);)s--;return r(i,t[s])?s:-1}function a(t,i,n,r){var s=o(t,i,n);if(s<0)return-1;for(;s<t.length-1&&r(i,t[s+1]);)s++;return r(i,t[s])?s:-1}h.E1=h,Object.hiveAddEach(h.prototype,r.prototype),Object.hiveAddEach(h.prototype,s.prototype),Object.hiveAddEach(h.prototype,e.prototype),h.prototype.zH=!0,h.prototype.Ne=function(t){return new this.constructor(t,this.Re,this._f,this.Ae)},h.prototype.has=function(t,i){if(i)throw new Error("SortedSet#has does not support second argument: equals");var n=o(this.array,t,this._f);return 0<=n&&this.Re(this.array[n],t)},h.prototype.get=function(t,i){if(i)throw new Error("SortedArray#get does not support second argument: equals");var n=u(this.array,t,this._f,this.Re);return-1!==n?this.array[n]:this.Ae(t)},h.prototype.hiveAdd=function(t){var i=function(t,i,n){var r=o(t,i,n);if(r<0)return-r-1;for(var s=t.length-1;r<s&&0===n(i,t[r+1]);)r++;return r}(this.array,t,this._f);return this.yC&&this.RC([t],[],i),this.array.splice(i,0,t),this.length++,this.yC&&this.OC([t],[],i),!0},h.prototype["delete"]=function(t,i){if(i)throw new Error("SortedArray#delete does not support second argument: equals");var n=u(this.array,t,this._f,this.Re);return-1!==n&&(this.yC&&this.RC([],[t],n),this.array.splice(n,1),this.length--,this.yC&&this.OC([],[t],n),!0)},h.prototype.kC=function(t,i){if(i){var n=this.array.kC(t,i);return this.length-=n,n}var r=u(this.array,t,this._f,this.Re);if(-1===r)return 0;for(var s=r;this.Re(t,this.array[s]);)s++;var e=this.slice(r,s);return this.yC&&this.RC([],e,r),this.array.splice(r,e.length),this.length-=e.length,this.yC&&this.OC([],e,r),e.length},h.prototype.indexOf=function(t){return u(this.array,t,this._f,this.Re)},h.prototype.lastIndexOf=function(t){return a(this.array,t,this._f,this.Re)},h.prototype.find=function(t,i,n){if(i)throw new Error("SortedArray#find does not support second argument: equals");if(n)throw new Error("SortedArray#find does not support third argument: index");return u(this.array,t,this._f,this.Re)},h.prototype.findLast=function(t,i,n){if(i)throw new Error("SortedArray#findLast does not support second argument: equals");if(n)throw new Error("SortedArray#findLast does not support third argument: index");return a(this.array,t,this._f,this.Re)},h.prototype.push=function(){this.hiveAddEach(arguments)},h.prototype.unshift=function(){this.hiveAddEach(arguments)},h.prototype.pop=function(){var t=this.array.pop();return this.length=this.array.length,t},h.prototype.shift=function(){var t=this.array.shift();return this.length=this.array.length,t},h.prototype.slice=function(){return this.array.slice.apply(this.array,arguments)},h.prototype.splice=function(t,i){return this.MP(t,i,Array.prototype.slice.call(arguments,2))},h.prototype.MP=function(t,i,n){if(void 0===t&&void 0===i)return[];(t=t||0)<0&&(t+=this.length),void 0===i&&(i=1/0);var r=this.slice(t,t+i);return this.yC&&this.RC(n,r,t),this.array.splice(t,i),this.length-=r.length,this.yC&&this.OC([],r,t),this.hiveAddEach(n),r},h.prototype.reduce=function(r,t){var s=arguments[2];return this.array.reduce(function(t,i,n){return r.call(s,t,i,n,this)},t,this)},h.prototype.reduceRight=function(){var r=arguments[2];return this.array.reduceRight(function(t,i,n){return callback.call(r,t,i,n,this)},basis,this)},h.prototype.min=function(){if(this.length)return this.array[0]},h.prototype.max=function(){if(this.length)return this.array[this.length-1]},h.prototype.kf=function(){return this.array.kf()},h.prototype.clear=function(){var t;this.yC&&(t=this.array.slice(),this.RC([],t,0)),this.length=0,this.array.clear(),this.yC&&this.OC([],t,0)},h.prototype.equals=function(t,i){return this.array.equals(t,i)},h.prototype.compare=function(t,i){return this.array.compare(t,i)},h.prototype.Df=function(t,i){return new this.Iterator(this.array,t,i)},h.prototype.toJSON=function(){return this.toArray()},h.prototype.Iterator=Array.prototype.Iterator},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(35),o=(e=h.VA,s(u,e),u);function u(){return null!==e&&e.apply(this,arguments)||this}i.GM=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(6),r=n(1),s=(e.prototype.addEventListener=function(t,i,n){this.events[t]=this.events[t]||[],this.events[t].push(i)},e.prototype.removeEventListener=function(t,i,n){this.events[t]&&(this.events[t]=this.events[t].filter(function(t){return t!==i}))},e.prototype.dispatchEvent=function(i){var n=this;this.events[i.type]&&this.events[i.type].forEach(function(t){try{"function"==typeof t?t.call(n,i):"function"==typeof t.handleEvent&&t.handleEvent(i)}catch(t){r.ErrorMonitor.getInstance().logError(n.loggerId+"Error in callback handler '"+i.type+"'",{error:t})}});var t=this["on"+i.type];if("function"==typeof t)try{t.call(this,i)}catch(t){r.ErrorMonitor.getInstance().logError(this.loggerId+"Error in callback handler '"+i.type+"'",{error:t})}return!1},e.prototype.msCachingEnabled=function(){return void 0!==this.msCaching},e.prototype.overrideMimeType=function(t){this.mimeType=t},e.register=function(t,i){e.BA[t]=i},e.prototype.w1=function(t){this.pluginId||(this.pluginId=e.BA[t])},e.prototype.open=function(t,i,n,r,s){void 0===n&&(n=!0),void 0===r&&(r=null),void 0===s&&(s=null),this.url=i.trim(),this.method=t,this.username=r,this.password=s,this.async=n,this.readyState=this.OPENED;var e=h.createEvent(Event,"readystatechange",{currentTarget:this});this.dispatchEvent(e)},e.prototype.setRequestHeader=function(t,i){if(this.readyState!==this.OPENED)throw new Error("The object's state must be OPENED.");this.g1.push({key:t,value:i})},e.prototype.getResponseHeader=function(t){var i=this.getAllResponseHeaders();if(i){var n={};return i.split(/[\r\n]+/).forEach(function(t){var i=t.match(/^([^:]+): ?(.+)$/);i&&(n[i[1]]=i[2])}),n[t.toLowerCase()]}return null},e.prototype.getAllResponseHeaders=function(){return this.K_},e.prototype.onload=function(t){},e.prototype.onloadend=function(t){},e.prototype.onerror=function(t){},e.prototype.onprogress=function(t){},e.prototype.onreadystatechange=function(t){},e.prototype.onabort=function(t){},e.prototype.onloadstart=function(t){},e.prototype.ontimeout=function(t){},e.BA={},e.Sl=0,e);function e(t){this.loggerId="[HiveXHR] ",this.DONE=4,this.LOADING=3,this.HEADERS_RECEIVED=2,this.OPENED=1,this.UNSENT=0,this.username=null,this.password=null,this.g1=[],this.responseType="",this.readyState=this.UNSENT,this.status=0,this.async=!0,this.timeout=0,this.events={},t&&(this.pluginId=t)}i.xA=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),e=n(21),s=n(8),h=(o.prototype.Y0=function(t){t.url=this.b1(t.url),t.g1=this.T1(t.g1)},o.prototype.O1=function(){this.m1=new r(),this._1=new r()},o.prototype.b1=function(t){var i=this,n=new e(t),r=n.search(!0);this.R1(r);var s=n.search("");return this.m1.keys().forEach(function(t){r[t]=i.m1.get(t)}),Object.keys(r).forEach(function(t){s.qd(t,r[t])}),s.toString()},o.prototype.R1=function(i){var n=this;Object.keys(i).forEach(function(t){(s.Y.Ja.includes(t)||s.Y.Ja.includes("*"))&&n.m1.set(t,i[t])})},o.prototype.T1=function(i){var n=this;this.S1(i);var r=[];return Object.keys(i).forEach(function(t){r[t]=i[t]}),this._1.keys().forEach(function(t){r[t]=n._1.get(t)}),r},o.prototype.S1=function(i){var n=this;Object.keys(i).forEach(function(t){(s.Y.Za.includes(t)||s.Y.Za.includes("*"))&&n._1.set(t,i[t])})},o.prototype.A1=function(){return this.m1},o.prototype.I1=function(){return this._1},o);function o(){this.m1=new r(),this._1=new r()}i.$H=h},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(104),o=(e=h.TV,s(u,e),u);function u(){return null!==e&&e.apply(this,arguments)||this}i.d1=o},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(3),o=n(65),u=n(52),a=n(190),f=n(0),c=n(35),l=n(7),v=n(31),d=n(21),E=n(1),w=n(2),p=n(105),g=(e=o.XH,s(b,e),b.prototype.getContextId=function(){return this.ticket.KL()},b.prototype.s1=function(i){try{var t=i.url=this.N1(i.url);return t===this.UL?(this.C1&&this.logger.debug("SAME MANIFEST "+t+","+this.UL),!0):null!=this.metadata&&this.metadata.SJ(t)?(this.C1&&this.logger.debug("CORRECT PLAYLIST "+t+","+this.UL),!0):null!=this.metadata&&null!=this.metadata.MH(t)?(this.C1&&this.logger.debug("CORRECT SEGMENT "+t+","+this.UL),!0):(u.Mj.yA(t,this.logger,this.metadata.iV())&&this.metadata.xL()!==t&&this.C1&&this.logger.debug("FIRST REQUEST FOR MANIFEST "+t+","+this.UL),!1)}catch(t){return E.ErrorMonitor.getInstance().logError("Error getting the current context of the HiveRequest",this.loggerId,w.ir.Dn,{detailedError:t,url:i.url}),!1}},b.prototype.N1=function(t){return d(t).RE().toString()},b.prototype.V_=function(i){var t=0,n=null,r=0,s=!0,e=!1;try{var h=this.S_(i);if(h!=l.xa.qa){var o=this.metadata.MH(i);null!=o&&(t=o.duration,n=o.qualityLevel,r=o.id,e=this.M_(i))}else s=!1,null!=this.metadata&&this.metadata.EJ.has(i)&&(n=this.metadata.EJ.get(i).qualityLevel,this.e1.set(n.id,f.Framework.time()));return new v.dA(i,h,s,r,t,n,e,this.getContextId())}catch(t){return E.ErrorMonitor.getInstance().logError("Error getting the entityCharacteristics from the url",this.loggerId,w.ir.Cn,{detailedError:t,url:i}),new v.dA(i,l.xa.Qa,!1,0,0,null,!1,this.getContextId())}},b.prototype.ex=function(i){try{var t=i.G_(),n=i.k_(),r=this.metadata.parse(n,t);if(this.metadata.EJ.has(n)){var s=this.metadata.EJ.get(n);this.h1._V(),void 0===this.FH&&(this.FH=!s.endList),this.lH.DM(s.qualityLevel)}i.X_.response=r,i.X_.responseText=r}catch(t){E.ErrorMonitor.getInstance().logError("Error receiving the metadata",this.loggerId,w.ir.nr,{detailedError:t,url:i.k_()}),i.G_()&&(i.X_.responseText=i.G_(),i.X_.response=i.G_())}},b.prototype.DH=function(t){e.prototype.DH.call(this,t),t.S_()!=l.xa.qa&&t.S_()!=l.xa.Qa&&(this.xH.wV(t),t.S_()==l.xa.Va&&this.lH.SM(t.A_))},b.prototype.hH=function(t,i){var n=t;return n.sH=f.Framework.time(),e.prototype.hH.call(this,n,i)},b.prototype.qM=function(t){u.Mj.Cj&&(null==this.f1.get(t.id)&&this.metadata.isLive()?this.c1(t):this.logger.debug("HLS PRE-FETCHING METADATA ALREADY SCHEDULED OR MISSING HLS INFO"))},b.prototype.c1=function(t){var i=this;try{var n=this.metadata.RJ.get(t.id);if(null!=n){var r=this.e1.has(t.id),s=this.e1.get(t.id),e=(r?s:0)+(null!=n.segments?n.segments[n.segments.length-1].duration:u.Mj.Ij),h=Math.max(1,e-f.Framework.time()+u.Mj.Nj);this.logger.info("HLS PREFETCHING METADATA "+n.DJ+" QUALITY LEVEL "+t.id+" IN "+h);var o=f.Framework.setTimeout(function(){i.l1(t,n.DJ,f.Framework.time())},h);this.f1.set(t.id,o)}else this.logger.warn("NO STREAM WITH QL "+t.id)}catch(t){E.ErrorMonitor.getInstance().logError("Error scheduling metadata prefetch",this.loggerId,w.ir.rr,t)}},b.prototype.l1=function(t,i,n){var r=this.e1.get(t.id);if(null==r&&(r=0),n<r)this.c1(t);else{var s=new c.VA(this.ticket.pluginId);s.open("GET",i),s.internal=!0,s.send(),this.f1["delete"](t.id),this.e1.set(t.id,f.Framework.time())}},b.prototype.o1=function(){var n=this;this.f1.keys().forEach(function(t){var i=n.f1.get(t);f.Framework.clearTimeout(i),n.f1["delete"](t)})},b.prototype.$M=function(){return e.prototype.nH.call(this,u.Mj.Rj,u.Mj.Sj)},b.prototype.iP=function(t,i,n,r){return n-t},b.prototype.tP=function(){return u.Mj.Aj},b.prototype.v1=function(){return u.Mj.kj},b.prototype.ZM=function(t,i){try{var n=this.wM(),r=this.CH(),s=n.uA(),e=0;if(s<t)for(var h=this.metadata.BH(s,i);h&&h.id<t;)e+=h.duration,h=h.next;var o=f.Framework.time()-r;return Math.max(0,e-o)}catch(t){return E.ErrorMonitor.getInstance().logError("Error getting the distance duration",this.loggerId,w.ir.Hn,t),0}},b.prototype.sB=function(t,i){return 1},b);function b(t,i,n){var r=e.call(this,t,i)||this;return r.loggerId="[HLS Context] ",r.C1=!1,r.e1=new h(),r.f1=new h(),r.xH=new a.D1(i.tv),r.metadata=u.Mj.SA({Yx:!0},n),r.h1=new p.CV(r.metadata),r}i.e$=g},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(104),o=(e=h.TV,s(u,e),u);function u(){return null!==e&&e.apply(this,arguments)||this}i.D1=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),c=n(4),s=n(0),l=n(192),v=n(106),d=n(193),E=n(1),w=n(2),e=(h.prototype.init=function(t,i){this.j1=t,this.M1=i},h.prototype.put=function(t){var i=c.defer();try{var n=t.I_(),r=t.K_,s=t.F_,e=t.L_.d_-1,h=t.L_.d_;-1==this.P1&&this.L1();var o=null,u=!1;if(this.H1.has(n)){o=this.H1.get(n);var a=new v.MV(0,e,h);u=!0,o.content.forEach(function(t,i){v.HV.LV(i).jV(a)&&(u=!1)})}else{var f=new v.MV(0,e,h).toString();o=new d.U1(t.A_),t.partner&&(o.J0=t.partner.hP.peerInfo),o.content.set(f,new l.F1(h,s,t.L_,t.R_())),this.H1.set(n,o),u=!0,this.G1.unshift(n)}null==o.headers&&null!=r&&(o.headers=r),u?i.resolve(!0):i.reject(!1)}catch(t){E.ErrorMonitor.getInstance().logError("Error adding fragment in LiveCache",this.loggerId,w.ii.Xt,t),i.reject("CACHE PUT ERROR "+t)}return i.promise},h.prototype.get=function(t){var i=c.defer();try{var n=this.H1.get(t);if(null!=n){var r=null;n.content.forEach(function(t,i){if(v.HV.LV(i).kV())return(r=t).headers=n.headers,void (r.J0=n.J0)}),i.resolve(r)}else i.reject(!1)}catch(t){E.ErrorMonitor.getInstance().logError("Error getting fragment from LiveCache",this.loggerId,w.ii.zt,t),i.reject("CACHE GET ERROR "+t)}return i.promise},h.prototype.YM=function(){try{return this.H1.keys()}catch(t){return E.ErrorMonitor.getInstance().logError("Error getting keys from LiveCache",this.loggerId,w.ii.Zt,t),[]}},h.prototype.B1=function(){var i=c.defer();try{i.resolve(this.H1.values())}catch(t){E.ErrorMonitor.getInstance().logError("Error getting elements from LiveCache",this.loggerId,w.ii.ti,t),i.reject("CACHE GET ELEMENTS ERROR "+t)}return i.promise},h.prototype.contains=function(t){var i=c.defer();try{this.H1.has(t)?i.resolve(!0):i.resolve(!1)}catch(t){E.ErrorMonitor.getInstance().logError("Error checking if LiveCache contains the fragment",this.loggerId,w.ii.Jt,t),i.reject("CACHE CONTAINS ERROR "+t)}return i.promise},h.prototype.L1=function(){var t=this;this.V1(),this.logger.debug(this.loggerId+"Starting cache periodic purge"),this.P1=s.Framework.setInterval(function(){t.P()},this.M1)},h.prototype.V1=function(){-1!=this.P1&&(this.logger.debug(this.loggerId+" Stopping cache periodic purge"),s.Framework.clearInterval(this.P1),this.P1=-1)},h.prototype.P=function(){var r=this;try{var s=0,e=0,t=0;this.logger.debug(this.loggerId+" RUNNING GC"),this.G1.every(function(t,i){var n=r.H1.get(t).size();return s+n>r.j1?(e=i,!1):(s+=n,!0)})||(t=this.G1.length-e,this.G1.splice(e,this.G1.length-1).forEach(function(t){r.H1["delete"](t)})),this.logger.debug(this.loggerId+" GC DONE - REMOVED: "+t+" - CURRENT ITEMS: "+this.H1.length+" SIZE: "+s+" "),0===this.H1.length&&(this.logger.debug(this.loggerId+" Cache contains no items, stopping purge timer"),this.V1())}catch(t){E.ErrorMonitor.getInstance().logError("Error purging LiveCache",this.loggerId,w.ii.ni,t)}},h.prototype.XZ=function(){this.H1=new r(),this.G1=[]},h.prototype.q1=function(){var n=this;this.H1.forEach(function(t,i){n.logger.debug("EID="+i),t.content.forEach(function(t,i){n.logger.debug("\tRANGE ",i)})})},h);function h(){this.loggerId="[LIVE CACHE] ",this.H1=new r(),this.P1=-1,this.G1=[],this.logger=s.Framework.resolve(s.Framework.v.p).log()}i.lZ=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(t,i,n,r){this.length=t,this.data=i,this.L_=n,this.Q1=r}i.F1=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(106),s=n(3),e=(h.prototype.size=function(){var n=0;return this.content.forEach(function(t,i){n+=r.HV.LV(i).size()}),n},h);function h(t){this.headers=null,this.J0=null,this.totalSize=0,this.Y1=!1,this.A_=t,this.content=new s()}i.U1=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=n(4),e=n(2),h=n(1),o=(u.prototype.init=function(t,i){try{this.K1.init(t,i)}catch(t){h.ErrorMonitor.getInstance().logError("Error initializing cache",this.loggerId,e.Wt.$t,t)}},u.prototype.put=function(t){var i=this,n=s.defer();try{this.K1.put(t).then(function(){n.resolve(!0)})["catch"](function(t){t&&h.ErrorMonitor.getInstance().logError("Error adding new fragment in cache",i.loggerId,e.Wt.Xt,t),n.reject(!1)})}catch(t){h.ErrorMonitor.getInstance().logError("Error adding new fragment in cache",this.loggerId,e.Wt.Xt,t),n.reject(!1)}return n.promise},u.prototype.get=function(i){var n=this,r=s.defer();try{this.contains(i).then(function(t){t?n.K1.get(i).then(function(t){r.resolve(t)})["catch"](function(t){t&&h.ErrorMonitor.getInstance().logError("Error getting the fragment from cache",n.loggerId,e.Wt.zt,t),r.reject(!1)}):r.reject(!1)})["catch"](function(t){t&&h.ErrorMonitor.getInstance().logError("Error getting the fragment from cache",n.loggerId,e.Wt.zt,t),r.reject(!1)})}catch(t){h.ErrorMonitor.getInstance().logError("Error getting the fragment from cache",this.loggerId,e.Wt.zt,t),r.reject(!1)}return r.promise},u.prototype.contains=function(t){var i=this,n=s.defer(),r=!1;try{this.K1.contains(t).then(function(t){r=t}).fail(function(t){i.logger.error(t)})["finally"](function(){n.resolve(r)})}catch(t){h.ErrorMonitor.getInstance().logError("Error checking if cache contains the fragment",this.loggerId,e.Wt.Jt,t),n.resolve(!1)}return n.promise},u.prototype.YM=function(){try{return this.K1.YM()}catch(t){return h.ErrorMonitor.getInstance().logError("Error getting the keys from cache",this.loggerId,e.Wt.Zt,t),[]}},u.prototype.B1=function(){var i=this,n=s.defer(),r=[];try{this.K1.B1().then(function(t){r=t}).fail(function(t){i.logger.error(t)})["finally"](function(){n.resolve(r)})}catch(t){h.ErrorMonitor.getInstance().logError("Error getting the elements from cache ",this.loggerId,e.Wt.ti,t),n.resolve(r)}return n.promise},u.prototype.XZ=function(){this.K1.XZ()},u);function u(){this.loggerId="[CACHE] ",this.logger=r.Framework.resolve(r.Framework.v.p).log(),this.K1=r.Framework.resolve(r.Framework.v.VC)}i.Cache=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(24),e=n(6),u=n(6),a=n(5),f=n(0),c=n(7),l=n(1),v=n(2),h=n(6),o=(d.prototype.init=function(t){this.logger=f.Framework.resolve(f.Framework.v.p).log(t.sessionId),this.gw=t.hM,this.tv=t.tv,this.tv&&(this.bandwidth=this.tv.tG()),this.Vl=t.reportingInstance.Vl,this.Vl.CU(this.W1)},d.prototype.request=function(n){var r=this,s=f.Framework.resolve(f.Framework.v.FC),e=!1,h=n.N_(),o=n.X_,t=n.X_.url;n.xhr=s,n.L_.O_=f.Framework.time(),this.logger.debug("FRL ISSUE REQ FOR FRAGMENT "+n.A_.toString()+"-"+n.L_.E_+" ["+c.xa[n.S_()]+"] TO FALLBACK "),n.A_.cA()&&(s.responseType="arraybuffer"),this.X1(n.type)&&o.range&&n.S_()!=c.xa.qa&&s.setRequestHeader("Range","bytes="+o.range),a.xu.Du.Vo&&this.z1(n.type)&&0!=n.L_.E_&&(this.logger.info("SET RANGE bytes="+n.L_.E_+"-"),s.setRequestHeader("Range","bytes="+n.L_.E_+"-")),o.g1.forEach(function(t){"range"!==t.key.toLowerCase()&&s.setRequestHeader(t.key,t.value)}),o.async&&0<o.timeout&&(s.timeout=o.timeout),o.mimeType&&s.overrideMimeType(o.mimeType),o.withCredentials&&(s.withCredentials=o.withCredentials),s.onloadstart=function(t){var i=u.createEvent(Event,"loadstart",t,o);o.dispatchEvent(i)},s.onabort=function(t){if(!e){var i=u.createEvent(Event,"abort",t,o);o.dispatchEvent(i)}},s.ontimeout=function(t){if(!e){r.error(n,h,10);var i=u.createEvent(ProgressEvent,"timeout",t,o);o.dispatchEvent(i),l.ErrorMonitor.getInstance().logError("Error on fallback request because of timeout",r.loggerId,v.Gs.xs)}},s.onreadystatechange=function(t){if(o&&(s.readyState===XMLHttpRequest.HEADERS_RECEIVED&&(o.K_=s.getAllResponseHeaders(),o.status=s.status,o.statusText=s.statusText),s.readyState<XMLHttpRequest.DONE||s.readyState===XMLHttpRequest.DONE&&0===s.status)){0===s.status&&(o.status=s.status,o.statusText=s.statusText),o.readyState=s.readyState;var i=u.createEvent(Event,"readystatechange",t,o);o.dispatchEvent(i)}},s.onprogress=function(t){if(!r.z1(n.type)){var i=u.createEvent(ProgressEvent,"progress",t,o);o.dispatchEvent(i),s.total=t.total}n.L_.g_=t.total,n.size=t.total},s.onload=function(t){if(e=!0,o.status=s.status,t&&0!=t.total&&(n.L_.g_=t.total),n.K_=s.getAllResponseHeaders(),s.status<200||299<s.status)return r.logger.debug("FRL SERVER RETURNED ERROR CODE "+s.status),void r.error(n,h);n.A_.cA()?r.X1(n.type)?n.F_=s.response:r.z1(n.type)&&(a.xu.Du.Vo?n.F_=f.Framework.T()?null:u.appendBuffer(n.F_,s.response):n.F_=s.response):n.responseText=s.responseText,r.J1["delete"](h),n.L_.m_=f.Framework.time(),r.Z1(n),r.t2(n),r.gw.$0(n),s=null},s.onerror=function(){e||r.error(n,h)},this.J1.set(h,n),s.open("GET",t,o.async,o.username,o.password),s.send()},d.prototype.error=function(t,i,n){this.Vl&&-1==a.xu.Iu.oo.indexOf(t.xhr.status)&&(n&&0<n?this.Vl.EF(n):t.xhr.status&&0<t.xhr.status?this.Vl.EF(t.xhr.status):this.Vl.EF(404));var r="COULD NOT DOWNLOAD "+t.k_()+" status: "+t.xhr.status;t.type==s.h_.a_?this.logger.debug(r):this.logger.warn(r),this.i2(t),this.J1["delete"](i),this.gw.K0(t)},d.prototype.Ze=function(t){return this.J1.has(t)},d.prototype.X1=function(t){return t==s.h_.a_||t==s.h_.u_||t==s.h_.o_},d.prototype.z1=function(t){return t==s.h_.f_},d.prototype.j0=function(t){var i=this.J1.get(t);this.J1["delete"](t),i&&i.xhr&&i.xhr.abort()},d.prototype.t2=function(t){t.A_.S_()==c.xa.Va&&this.W1.add(t.P_()),this.logger.info("SUCCESS FROM FALLBACK FOR "+t.k_()+" ["+s.h_[t.type]+"]["+t.L_.g_+"] AFTER "+t.P_()+" [curr:"+t.U_().Ta()+" avg:"+this.bandwidth.Ta()+"]")},d.prototype.i2=function(t){},d.prototype.G0=function(){return this.bandwidth},d.prototype.Z1=function(t){t.S_()===c.xa.Va&&this.bandwidth.wa(t.U_())},d);function d(){this.loggerId="[FallbackRequester] ",this.J1=new r(),this.bandwidth=new e.ma(),this.W1=new h.ta()}i.vZ=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(4);n(25);var u=n(0),e=n(5),a=n(54),f=n(65),o=n(9),r=n(107),c=hive.services.protocol.tracker.CustomerKey,l=n(13),s=n(8),v=n(1),d=n(2),E=n(6),w=s.Y.sf,p=(g.prototype.init=function(t){this.logger=u.Framework.resolve(u.Framework.v.p).log(t.sessionId),this.sessionId=t.sessionId,this.s0=t.s0,this.tv=t.tv,this.WH=t.WH,this.p0=t.uM,this.v0.n2(t.sessionId,this),this.s2=r.UV.FV,this.Vl=t.reportingInstance.Vl,this.Vl.IU(this.e2)},g.prototype.start=function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];this.context=t,this.streamId=t.j.getContextId(),this.ticket=t.j.wP(),this.listeners=i},g.prototype.i0=function(){var t=this;this.WZ(),this.h2=u.Framework.setInterval(function(){t.o2()},e.xu.Au.eo),this.o2()},g.prototype.WZ=function(){this.h2&&u.Framework.clearInterval(this.h2)},g.prototype.u2=function(){var i=this,n=h.defer(),r=new hive.services.protocol.tracker.TrackerRequest(),s=this.context.j,t=s.UH()?StreamType.LIVE:StreamType.VOD;r.sessionId=this.sessionId;var e=new c();return l.HiveConfig.ClientInfo.rc&&l.HiveConfig.ClientInfo.sc?(e.partnerId=l.HiveConfig.ClientInfo.rc,e.customerId=l.HiveConfig.ClientInfo.sc):(e.partnerId=this.ticket.mR(),e.customerId=this.ticket._R()),r.customerKey=e,r.streamType=t,r.contentId=this.tv.getContextId(),this.kS.getConnectivityInfo().then(function(t){i.a2=t.getNetworkChanged().getPrivateIp(),i.tv.bG(i.a2)}).fail(function(t){v.ErrorMonitor.getInstance().logError("Error getting connectivity info",i.loggerId,d.gr.yr)})["finally"](function(){try{var t=new hive.snapshots.ConnectivityInfo();t.publicIp=i.ZU,t.privateIp=i.a2,r.info=i.f2(t,s),r.query=i.c2(s,r.info),n.resolve(r)}catch(t){v.ErrorMonitor.getInstance().logError("Error collecting the data for the tracker request",i.loggerId,d.gr.Tr,t),n.reject("ERROR")}}).done(),n.promise},g.prototype.l2=function(){var t=new Array();return this.s2==r.UV.FV?t.push(hive.services.protocol.tracker.TrackerRankType.Global):this.s2==r.UV.AS?t.push(hive.services.protocol.tracker.TrackerRankType.sR):this.s2==r.UV.tM?t.push(hive.services.protocol.tracker.TrackerRankType.rR):this.logger.warn("Wrong locality mode"),t},g.prototype.c2=function(t,i){var r=this,s=new hive.services.protocol.tracker.TrackerQuery();try{return s.random=e.xu.Pu.su,i.externalAs&&!this.JU&&(this.JU=i.externalAs),i.internalAs&&!this.v2&&(this.v2=i.internalAs),s.rankings=this.l2(),s.asns=[],0<this.JU&&this.d2(s.asns,hive.services.protocol.tracker.TrackerAsType.External,this.JU,e.xu.Pu.eu),0<this.v2&&(this.d2(s.asns,hive.services.protocol.tracker.TrackerAsType.hR,this.v2,e.xu.Pu.hu),s.watchersForQualityLevel=[],t.HH().forEach(function(t){var i=r.E2(hive.services.protocol.tracker.TrackerAsType.hR,r.v2,t,-1);s.watchersForQualityLevel.push({key:i,value:1})}),s.streamersForQualityLevel=[],this.tv.xQ().forEach(function(t,i){var n=r.E2(hive.services.protocol.tracker.TrackerAsType.hR,r.v2,t.qualityLevel,t.type==a.Jj.tM?hive.services.protocol.tracker.TrackerPeerStreamState.iR:-1);s.streamersForQualityLevel.push({key:n,value:e.xu.Pu.ou})})),s}catch(t){throw v.ErrorMonitor.getInstance().logError("Error preparing tracker query",this.loggerId,d.gr.Or,t),new Error(t)}},g.prototype.E2=function(t,i,n,r){var s=new hive.services.protocol.tracker.TrackerQualityLevelQuery(),e=new hive.services.protocol.tracker.TrackerAsQuery();return e.asType=t,e.asn=i,s.qualityLevel=n.id,s.asn=e,-1!=r&&s.streamState,s},g.prototype.d2=function(t,i,n,r){var s=new hive.services.protocol.tracker.TrackerAsQuery();s.asType=i,s.asn=n,t.push({key:s,value:r})},g.prototype.f2=function(t,i){var r=new hive.services.protocol.tracker.TrackerPeerInfo();try{if(u.Framework.T()?r.guid=this.uS:r.guid=btoa(this.uS),r.timestamp=u.Framework.time(),r.nat=void 0,this.tv.eP()&&(r.externalAs=this.tv.eP()),this.tv.sP()&&(r.internalAs=this.tv.sP()),null!=t){r.publicIpString=t.publicIp;var n=new InetAddress();n.address=t.publicIp,r.publicIp=n,r.privateIpString=t.privateIp;var s=new InetAddress();s.address=t.privateIp,r.privateIp=s}var e=Math.round(this.tv.tG().ga()/8);if(r.bandwidth=isNaN(e)?null:e,!this.tv.zM()&&this.tv.aP()&&w?r.rankValue=1:r.rankValue=this.tv.w2(),this.context.j instanceof f.XH){r.streams=new Array();var h=i.wM();null!=h&&(r.watchingQualityLevel=h.getQualityLevel().id);var o=i.LH();this.tv.xQ().forEach(function(t,i){if(t.oA){var n=new hive.services.protocol.tracker.TrackerPeerStreamInfo();switch(n.qualityLevel=t.qualityLevel.id,t.type){case a.Jj.Z_:n.state=hive.services.protocol.tracker.TrackerPeerStreamState.tR;break;case a.Jj.Zj:n.state=hive.services.protocol.tracker.TrackerPeerStreamState.nR;break;case a.Jj.tM:n.state=hive.services.protocol.tracker.TrackerPeerStreamState.iR}n.delta=o.jM(t.oA.uA(),t.qualityLevel),r.streams.push(n)}})}return r}catch(t){throw v.ErrorMonitor.getInstance().logError("Error preparing tracker info",this.loggerId,d.gr.Rr,t),new Error(t)}},g.prototype.o2=function(){var n=this;this.g2=u.Framework.time(),this.logger.debug(this.loggerId+" PREPARE REQUEST"),this.u2().then(function(t){var i=n.loggerId+"SENDING TRACKER REQUEST [ privateIp:"+t.info.privateIpString+" rank:"+t.info.rankValue+"]";switch(n.b2){case 0:default:n.logger.debug(i);break;case 1:n.logger.debug(i+" "+JSON.stringify(t));break;case 2:n.logger.debug(i,t);break;case 3:n.logger.debug(i+" "+JSON.stringify(t),t)}n.v0.T2(t)},function(t){v.ErrorMonitor.getInstance().logError("Error preparing the tracker request",n.loggerId,d.gr.br)})["catch"](function(t){v.ErrorMonitor.getInstance().logError("Error sending tracker request",n.loggerId,d.gr.Sr,t)})},g.prototype.O2=function(t){this.s2=t},g.prototype.m2=function(){var t=Math.max(0,u.Framework.time()-this.g2);0<t&&t<e.xu.Pu.TIMEOUT&&this.e2.add(t)},g.prototype.U0=function(t){var i=this;try{switch(this.m2(),this.b2){case 1:this.logger.debug(this.loggerId+this.context.j.wP()+" Tracker Response: "+JSON.stringify(t));break;case 2:this.logger.debug(this.loggerId+this.context.j.wP()+" Tracker Response: ",t);break;case 3:this.logger.debug(this.loggerId+this.context.j.wP()+" Tracker Response: "+JSON.stringify(t),t)}this.JU=t.peerInfo.externalAs,this.v2=t.peerInfo.internalAs,this.ZU=t.peerInfo.publicIpString,this.a2=t.peerInfo.privateIpString,this.localityGroupId=t.peerInfo.localityGroupId,this.tv.EG(this.ZU),this.tv._2(this.v2),this.tv.R2(this.JU),this.kS.lG(this.ZU,this.a2,this.v2),this.logger.debug(this.loggerId+"Reporting from tracker public IP:"+this.ZU+" private IP: "+this.a2+" ExtAs:"+this.JU+" inAs:"+this.v2+" localityGroupId:"+this.localityGroupId),!this.tv.zM()&&this.tv.aP()&&w?this.p0.Oq(!1):this.p0.S2(t.rankings,t.infos);var n=this.A2(t);this.listeners.forEach(function(t){return t.JV(n,i.I2)}),this.I2=!1}catch(t){v.ErrorMonitor.getInstance().logError("Error handling the response",this.loggerId,d.gr.Ar,t)}},g.prototype.A2=function(t){for(var i=[],n=0,r=t.infos;n<r.length;n++){var s=r[n],e=new o.yf(o.pf.gf,s);i.push(e)}return i},g.prototype.Mq=function(t){},g.prototype.PS=function(t){this.uS=t,this.logger.info(this.loggerId+"CONNECTED "+this.uS),this.p0.N2(),this.i0()},g.prototype.nQ=function(){},g);function g(){this.b2=isNaN(l.HiveConfig.DebugLogs.TrackerLogs)?0:l.HiveConfig.DebugLogs.TrackerLogs,this.loggerId="[TRACKER] ",this.JU=0,this.v2=0,this.localityGroupId=0,this.C2=/([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{0,4}){5})/,this.I2=!0,this.Jc=u.Framework.resolve(u.Framework.v.Zc),this.kS=u.Framework.resolve(u.Framework.v.jR),this.v0=u.Framework.resolve(u.Framework.v.lk),this.e2=new E.ta()}i.EZ=p},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(0),e=n(6),h=n(1),o=n(2),u=function(t,i){this.id=t,this.size=i};i.Element=u;var a=(f.prototype.put=function(t,i){try{var n=t.fragmentId,r=t.size;this.D2.has(n)||(this.D2.set(n,new u(n,r)),this.j2.set(n,new Array())),this.j2.get(n).push(i)}catch(t){throw h.ErrorMonitor.getInstance().logError("Error adding new have in object index",this.loggerId,o.Qs.Ys,t),new Error(t)}},f.prototype.contains=function(t){return this.j2.has(t)},f.prototype.rP=function(t){return this.j2.get(t)},f.prototype.nP=function(t){return this.D2.get(t)},f.prototype.YQ=function(n){var r=this;try{this.j2.forEach(function(t,i){e.Aa(t,n,!1),0===t.length&&(r.j2["delete"](i),r.D2["delete"](i))})}catch(t){h.ErrorMonitor.getInstance().logError("Error removing haves send from a specific peer",this.loggerId,o.Qs.Ks,t)}},f.prototype.q1=function(){var n=this;this.j2.forEach(function(t,i){n.logger.debug("OBJIDX FR "+i+" PS "+t.map(function(t){return t.AQ.transport.otherGuid}).reduce(function(t,i){return t+","+i}))})},f);function f(){this.loggerId="[ObjectIndex] ",this.D2=new r(),this.j2=new r(),this.logger=s.Framework.resolve(s.Framework.v.p).log()}i.bZ=a},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(5),e=n(0),h=n(6),o=n(9),u=n(199),a=n(53),f=n(108),c=n(8),l=n(1),v=n(2),d=c.Y.sf,E=(w.prototype.init=function(t){this.logger=e.Framework.resolve(e.Framework.v.p).log(t.sessionId),this.partnership=t.partnership,this.tv=t.tv,this.h0=t.h0,this.M2=t.KH,(d||e.Framework.T()&&a.$j.Kj)&&(this.GZ=t.GZ),this.start()},w.prototype.start=function(){this.P2=!0},w.prototype.stop=function(){this.P2=!1},w.prototype.JV=function(t,i){var n=this;try{if(this.P2){var r=[];t.forEach(function(i){var t=null;i.guid!=n.uS&&(i.type==o.pf.gf?t=n.L2(i):d||e.Framework.T()&&a.$j.Kj?(t=n.H2(i),n.GZ.BV(i).then(function(){n.partnership.rQ(n.UQ.get(i.guid))}).fail(function(t){t&&t!=f.Hq.iq&&(n.UQ["delete"](i.guid),l.ErrorMonitor.getInstance().logError("Error electing lan leader",n.loggerId,v.si.hi))})):t=n.H2(i)),t&&r.push(t.peerInfo.guid)}),this.U2(),this.handleStats(),i&&this.partnership.cQ(i),0<r.length&&this.logger.debug("DISCOVERED NEW "+r.length+"/"+t.length+": ["+r.join(", ")+"]")}}catch(t){l.ErrorMonitor.getInstance().logError("Error discovering peers",this.loggerId,v.si.ei,t)}},w.prototype.handleStats=function(){var t=this.F2.length+this.UQ.length;this.M2.G2(t)},w.prototype.U2=function(){try{this.F2.length>s.xu.Mu.nu&&this.B2(this.F2,s.xu.Mu.nu),this.UQ.length>=s.xu.Mu.ru&&this.V2(this.UQ)}catch(t){l.ErrorMonitor.getInstance().logError("Error clearing membership views",this.loggerId,v.si.oi,t)}},w.prototype.B2=function(t,i){for(var n=t.values().sort(function(t,i){return t.peerInfo.timestamp-i.peerInfo.timestamp});t.length>i;){var r=n.splice(0,1)[0];this.partnership.sQ(r)||t["delete"](r.peerInfo.guid)}},w.prototype.V2=function(t){var i=t.keys()[e.Framework.random()*t.length];t["delete"](i)},w.prototype.H2=function(t){var i=null;try{if(this.F2.has(t.guid)?(i=this.F2.get(t.guid),this.F2["delete"](t.guid),this.UQ.set(t.guid,i)):this.UQ.has(t.guid)&&(i=this.UQ.get(t.guid)),!i)return i=new u.q2(t),this.UQ.set(t.guid,i),i;i.Q2(t)}catch(t){return l.ErrorMonitor.getInstance().logError("Error adding peer to lan view",this.loggerId,v.si.ui,t),null}},w.prototype.L2=function(t){var i=null;try{if(this.UQ.has(t.guid))this.H2(t);else{if(!this.F2.has(t.guid))return i=new u.q2(t),this.F2.set(t.guid,i),this.h0.Y2(i),i;(i=this.F2.get(t.guid)).Q2(t),this.h0.Y2(i)}}catch(t){return l.ErrorMonitor.getInstance().logError("Error adding peer to random view",this.loggerId,v.si.ai,t),null}},w.prototype.lQ=function(t,i){var n=[];try{return this.P2&&(n=d||e.Framework.T()&&a.$j.Kj?h.Ca(this.F2.values()):(n=this.F2.values(),this.UQ.forEach(function(t,i){n.push(t)}),h.Ca(n))),t?n:i?n.slice(0,i):n.slice(0,2*s.xu.mu.Hh)}catch(t){return l.ErrorMonitor.getInstance().logError("Error sampling membership",this.loggerId,v.si.fi,t),[]}},w.prototype.jQ=function(t){return this.F2.has(t)?this.F2.get(t):this.UQ.has(t)?this.UQ.get(t):null},w.prototype.PS=function(t){this.logger.info("MEMBERSHIP SERVER CONNECTED"),this.uS=t,this.tv.setId(this.uS)},w.prototype.nQ=function(){},w.prototype.Mq=function(t){this.logger.debug("Peer "+t+" disconnected"),this.F2["delete"](t),this.UQ["delete"](t),this.handleStats()},w);function w(){this.loggerId="[Membership] ",this.uS=null,this.F2=new r(),this.UQ=new r()}i.Mu=E},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(9),s=n(200),e=(h.prototype._Q=function(){return this.peerInfo.type===r.pf.bf},h.prototype.K2=function(t){this.W2=new s.X2([t])},h.prototype.z2=function(){return this.W2},h.prototype.J2=function(){return this.h0},h.prototype.Z2=function(t){isNaN(t)||(this.h0=t)},h.prototype.Q2=function(t){this.peerInfo.type==r.pf.gf&&t.type==r.pf.bf?this.peerInfo.type=r.pf.bf:this.peerInfo.type==r.pf.gf&&t.type==r.pf.gf||this.peerInfo.type==r.pf.bf&&t.type==r.pf.bf?this.t3(this.peerInfo,t):this.peerInfo.type==r.pf.bf&&t.type==r.pf.gf&&(this.t3(this.peerInfo,t),this.peerInfo.type=r.pf.bf)},h.prototype.ZQ=function(t){this.peerInfo.watchingQualityLevel=t},h.prototype.t3=function(t,i){t.internalAs=this.i3(t.internalAs,i.internalAs),t.externalAs=this.i3(t.externalAs,i.externalAs),t.nat=this.i3(t.nat,i.nat),t.bandwidth=this.i3(t.bandwidth,i.bandwidth),t.watchingQualityLevel=this.i3(t.watchingQualityLevel,i.watchingQualityLevel),t.privateIpString=this.i3(t.privateIpString,i.privateIpString),t.publicIpString=this.i3(t.publicIpString,i.publicIpString),t.rankValue=this.i3(t.rankValue,i.rankValue),t.timestamp=this.i3(t.timestamp,i.timestamp),i.isLeader&&(t.isLeader=this.i3(t.isLeader,i.isLeader)),i.streams&&(t.streams=i.streams)},h.prototype.i3=function(t,i){return t?i&&t!=i&&(t=i):i&&(t=i),t},h);function h(t){this.h0=0,this.peerInfo=t}i.q2=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(c.prototype.n3=function(){return this.r3||this.s3(),this.r3},c.prototype.s3=function(){for(var t=[],i=0;i<this.columns;i++){for(var n=[],r=0;r<this.rows;r++)n.push(this.matrix[r][i]);t.push(n)}this.r3=new c(t)},c.prototype.e3=function(t){for(var i=t.h3(),n=[],r=0;r<this.rows;r++){for(var s=[],e=0;e<this.columns;e++){var h=this.matrix[r][e]/i[r][e];s.push(h||0)}n.push(s)}return new c(n)},c.prototype.multiply=function(t){for(var i=t.h3(),n=t.o3(),r=t.u3(),s=[],e=0;e<this.rows;e++){for(var h=this.matrix[e],o=[],u=0;u<r;u++){for(var a=0,f=0;f<n;f++)a+=h[f]*i[f][u];o.push(a)}s.push(o)}return new c(s)},c.prototype.a3=function(t){for(var i=[],n=0;n<this.rows;n++){for(var r=[],s=0;s<this.columns;s++)r.push(this.matrix[n][s]*t);i.push(r)}return new c(i)},c.prototype.f3=function(t){for(var i=[],n=0;n<this.rows;n++){for(var r=[],s=0;s<this.columns;s++)r.push(this.matrix[n][s]+t);i.push(r)}return new c(i)},c.prototype.c3=function(){for(var t=[],i=0;i<this.rows;i++){for(var n=[],r=0;r<this.columns;r++)n.push(Math.exp(this.matrix[i][r]));t.push(n)}return new c(t)},c.prototype.l3=function(t){for(var i=[],n=0;n<this.rows;n++){var r=this.matrix[n];i.push([t]);for(var s=0;s<r.length;s++)i[n].push(r[s])}return new c(i)},c.prototype.h3=function(){return this.matrix},c.prototype.o3=function(){return this.rows},c.prototype.u3=function(){return this.columns},c);function c(t){this.matrix=[],this.rows=0,this.columns=0,this.matrix=t,this.rows=this.matrix.length,this.columns=this.matrix[0].length}i.X2=r},function(s,e,l){(function(i){var t,n,r;n=[l(36)],void 0===(r="function"==typeof (t=function(T,t){"use strict";var s={};return s.v3=T,s.ZA=T.ZA||null,s.VERSION="4.1.3",s.d3={},s.d3.E3=0,s.d3.w3=1,s.d3.g3=2,s.d3.b3=3,s.d3.y3=4,s.d3.T3=5,s.O3=[s.d3.E3,s.d3.w3,s.d3.T3],s.m3={int32:{name:"int32",_3:s.d3.E3,defaultValue:0},uint32:{name:"uint32",_3:s.d3.E3,defaultValue:0},sint32:{name:"sint32",_3:s.d3.E3,defaultValue:0},int64:{name:"int64",_3:s.d3.E3,defaultValue:s.ZA?s.ZA.ZERO:void 0},uint64:{name:"uint64",_3:s.d3.E3,defaultValue:s.ZA?s.ZA.R3:void 0},sint64:{name:"sint64",_3:s.d3.E3,defaultValue:s.ZA?s.ZA.ZERO:void 0},bool:{name:"bool",_3:s.d3.E3,defaultValue:!1},"double":{name:"double",_3:s.d3.w3,defaultValue:0},string:{name:"string",_3:s.d3.g3,defaultValue:""},bytes:{name:"bytes",_3:s.d3.g3,defaultValue:null},fixed32:{name:"fixed32",_3:s.d3.T3,defaultValue:0},sfixed32:{name:"sfixed32",_3:s.d3.T3,defaultValue:0},fixed64:{name:"fixed64",_3:s.d3.w3,defaultValue:s.ZA?s.ZA.R3:void 0},sfixed64:{name:"sfixed64",_3:s.d3.w3,defaultValue:s.ZA?s.ZA.ZERO:void 0},"float":{name:"float",_3:s.d3.T3,defaultValue:0},"enum":{name:"enum",_3:s.d3.E3,defaultValue:0},message:{name:"message",_3:s.d3.g3,defaultValue:null},group:{name:"group",_3:s.d3.b3,defaultValue:null}},s.S3=[s.m3.int32,s.m3.sint32,s.m3.sfixed32,s.m3.uint32,s.m3.fixed32,s.m3.int64,s.m3.sint64,s.m3.sfixed64,s.m3.uint64,s.m3.fixed64,s.m3.bool,s.m3.string,s.m3.bytes],s.A3=1,s.I3=536870911,s.N3=!1,s.C3=!0,s.D3=!0,s.ST=function(){var s={};return s.j3=!("object"!=typeof i||i+""!="[object process]"||i.JN),s.M3=function(){for(var t=[function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],i=null,n=0;n<t.length;n++){try{i=t[n]()}catch(t){continue}break}if(!i)throw Error("XMLHttpRequest is not supported");return i},s.fetch=function(t,n){if(n&&"function"!=typeof n&&(n=null),s.j3){var i=l(18);if(n)i.P3(t,function(t,i){n(t?null:""+i)});else try{return i.L3(t)}catch(t){return null}}else{var r=s.M3();if(r.open("GET",t,!!n),r.setRequestHeader("Accept","text/plain"),"function"==typeof r.overrideMimeType&&r.overrideMimeType("text/plain"),!n)return r.send(null),200==r.status||0==r.status&&"string"==typeof r.responseText?r.responseText:null;if(r.onreadystatechange=function(){4==r.readyState&&(200==r.status||0==r.status&&"string"==typeof r.responseText?n(r.responseText):n(null))},4==r.readyState)return;r.send(null)}},s.H3=function(t){return t.replace(/_([a-zA-Z])/g,function(t,i){return i.toUpperCase()})},s}(),s.Lang={U3:/[\s\{\}=;:\[\],'"\(\)<>]/g,F3:/^(?:required|optional|repeated|map)$/,_L:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,gL:/^[a-zA-Z_][a-zA-Z_0-9]*$/,G3:/^[a-zA-Z][a-zA-Z_0-9]*$/,x3:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,B3:/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,V3:/^-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+|([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?)|inf|nan)$/,q3:/^(?:[1-9][0-9]*|0)$/,Q3:/^0[xX][0-9a-fA-F]+$/,Y3:/^0[0-7]+$/,K3:/^([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?|inf|nan)$/,BOOL:/^(?:true|false)$/i,tD:/^(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,W3:/^\-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,X3:/\s/,STRING:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")|(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,z3:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,J3:/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g},s.Z3=function(r,h){function i(t){this.source=t+"",this.index=0,this.line=1,this.stack=[],this.t4=null}var t={},n=i.prototype;function s(t){this.i4=new i(t),this.n4=!1}n.EX=function(){var t='"'===this.t4?h.z3:h.J3;t.lastIndex=this.index-1;var i=t.exec(this.source);if(!i)throw Error("unterminated string");return this.index=t.lastIndex,this.stack.push(this.t4),this.t4=null,i[1]},n.next=function(){if(0<this.stack.length)return this.stack.shift();if(this.index>=this.source.length)return null;if(null!==this.t4)return this.EX();var t,i,n;do{for(t=!1;h.X3.test(n=this.source.charAt(this.index));)if("\n"===n&&++this.line,++this.index===this.source.length)return null;if("/"===this.source.charAt(this.index))if(++this.index,"/"===this.source.charAt(this.index)){for(;"\n"!==this.source.charAt(++this.index);)if(this.index==this.source.length)return null;++this.index,++this.line,t=!0}else{if("*"!==(n=this.source.charAt(this.index)))return"/";do{if("\n"===n&&++this.line,++this.index===this.source.length)return null;i=n,n=this.source.charAt(this.index)}while("*"!==i||"/"!==n);++this.index,t=!0}}while(t);if(this.index===this.source.length)return null;var r=this.index;if(h.U3.lastIndex=0,!h.U3.test(this.source.charAt(r++)))for(;r<this.source.length&&!h.U3.test(this.source.charAt(r));)++r;var s=this.source.substring(this.index,this.index=r);return'"'!==s&&"'"!==s||(this.t4=s),s},n.DP=function(){if(0===this.stack.length){var t=this.next();if(null===t)return null;this.stack.push(t)}return this.stack[0]},n.XE=function(t){var i=this.next();if(i!==t)throw Error("illegal '"+i+"', '"+t+"' expected")},n.r4=function(t){return this.DP()===t&&(this.next(),!0)},n.toString=function(){return"Tokenizer ("+this.index+"/"+this.source.length+" at line "+this.line+")"},t.s4=i;var e=s.prototype;function o(t,i){var n=-1,r=1;if("-"==t.charAt(0)&&(r=-1,t=t.substring(1)),h.q3.test(t))n=parseInt(t);else if(h.Q3.test(t))n=parseInt(t.substring(2),16);else{if(!h.Y3.test(t))throw Error("illegal id value: "+(r<0?"-":"")+t);n=parseInt(t.substring(1),8)}if(n=r*n|0,!i&&n<0)throw Error("illegal id value: "+(r<0?"-":"")+t);return n}function u(t){var i=1;if("-"==t.charAt(0)&&(i=-1,t=t.substring(1)),h.q3.test(t))return i*parseInt(t,10);if(h.Q3.test(t))return i*parseInt(t.substring(2),16);if(h.Y3.test(t))return i*parseInt(t.substring(1),8);if("inf"===t)return i*(1/0);if("nan"===t)return NaN;if(h.K3.test(t))return i*parseFloat(t);throw Error("illegal number value: "+(i<0?"-":"")+t)}function a(t,i,n){void 0===t[i]?t[i]=n:(Array.isArray(t[i])||(t[i]=[t[i]]),t[i].push(n))}return e.parse=function(){var t,i={name:"[ROOT]","package":null,messages:[],e4:[],imports:[],options:{},services:[]},n=!0;try{for(;t=this.i4.next();)switch(t){case"package":if(!n||null!==i["package"])throw Error("unexpected 'package'");if(t=this.i4.next(),!h.x3.test(t))throw Error("illegal package name: "+t);this.i4.XE(";"),i["package"]=t;break;case"import":if(!n)throw Error("unexpected 'import'");"public"===(t=this.i4.DP())&&this.i4.next(),t=this.EX(),this.i4.XE(";"),i.imports.push(t);break;case"syntax":if(!n)throw Error("unexpected 'syntax'");this.i4.XE("="),"proto3"===(i.h4=this.EX())&&(this.n4=!0),this.i4.XE(";");break;case"message":this.o4(i,null),n=!1;break;case"enum":this.u4(i),n=!1;break;case"option":this.a4(i);break;case"service":this.f4(i);break;case"extend":this.c4(i);break;default:throw Error("unexpected '"+t+"'")}}catch(t){throw t.message="Parse error at line "+this.i4.line+": "+t.message,t}return delete i.name,i},s.parse=function(t){return new s(t).parse()},e.EX=function(){var t,i,n="";do{if("'"!==(i=this.i4.next())&&'"'!==i)throw Error("illegal string delimiter: "+i);n+=this.i4.next(),this.i4.XE(i),t=this.i4.DP()}while('"'===t||'"'===t);return n},e.l4=function(t){var i=this.i4.DP();if('"'===i||"'"===i)return this.EX();if(this.i4.next(),h.V3.test(i))return u(i);if(h.BOOL.test(i))return"true"===i.toLowerCase();if(t&&h.x3.test(i))return i;throw Error("illegal value: "+i)},e.a4=function(t,i){var n=this.i4.next(),r=!1;if("("===n&&(r=!0,n=this.i4.next()),!h.x3.test(n))throw Error("illegal option name: "+n);var s=n;r&&(this.i4.XE(")"),s="("+s+")",n=this.i4.DP(),h.B3.test(n)&&(s+=n,this.i4.next())),this.i4.XE("="),this.v4(t,s),i||this.i4.XE(";")},e.v4=function(t,i){var n=this.i4.DP();if("{"!==n)a(t.options,i,this.l4(!0));else for(this.i4.XE("{");"}"!==(n=this.i4.next());){if(!h.gL.test(n))throw Error("illegal option name: "+i+"."+n);this.i4.r4(":")?a(t.options,i+"."+n,this.l4(!0)):this.v4(t,i+"."+n)}},e.f4=function(t){var i=this.i4.next();if(!h.gL.test(i))throw Error("illegal service name at line "+this.i4.line+": "+i);var n={name:i,d4:{},options:{}};for(this.i4.XE("{");"}"!==(i=this.i4.next());)if("option"===i)this.a4(n);else{if("rpc"!==i)throw Error("illegal service token: "+i);this.E4(n)}this.i4.r4(";"),t.services.push(n)},e.E4=function(t){var i=this.i4.next();if(!h.gL.test(i))throw Error("illegal rpc service method name: "+i);var n=i,r={request:null,response:null,w4:!1,g4:!1,options:{}};if(this.i4.XE("("),"stream"===(i=this.i4.next()).toLowerCase()&&(r.w4=!0,i=this.i4.next()),!h.x3.test(i))throw Error("illegal rpc service request type: "+i);if(r.request=i,this.i4.XE(")"),"returns"!==(i=this.i4.next()).toLowerCase())throw Error("illegal rpc service request type delimiter: "+i);if(this.i4.XE("("),"stream"===(i=this.i4.next()).toLowerCase()&&(r.g4=!0,i=this.i4.next()),r.response=i,this.i4.XE(")"),"{"===(i=this.i4.DP())){for(this.i4.next();"}"!==(i=this.i4.next());){if("option"!==i)throw Error("illegal rpc service token: "+i);this.a4(r)}this.i4.r4(";")}else this.i4.XE(";");void 0===t.d4&&(t.d4={}),t.d4[n]=r},e.o4=function(t,i){var n=!!i,r=this.i4.next(),s={name:"",fields:[],e4:[],messages:[],options:{},b4:{}};if(!h.gL.test(r))throw Error("illegal "+(n?"group":"message")+" name: "+r);for(s.name=r,n&&(this.i4.XE("="),i.id=o(this.i4.next()),s.y4=!0),"["===(r=this.i4.DP())&&i&&this.T4(i),this.i4.XE("{");"}"!==(r=this.i4.next());)if(h.F3.test(r))this.O4(s,r);else if("oneof"===r)this.m4(s);else if("enum"===r)this.u4(s);else if("message"===r)this.o4(s);else if("option"===r)this.a4(s);else if("extensions"===r)this._4(s);else if("extend"===r)this.c4(s);else{if(!h.x3.test(r))throw Error("illegal message token: "+r);if(!this.n4)throw Error("illegal field rule: "+r);this.O4(s,"optional",r)}return this.i4.r4(";"),t.messages.push(s),s},e.O4=function(t,i,n){if(!h.F3.test(i))throw Error("illegal message field rule: "+i);var r,s={rule:i,type:"",name:"",options:{},id:0};if("map"===i){if(n)throw Error("illegal type: "+n);if(this.i4.XE("<"),r=this.i4.next(),!h._L.test(r)&&!h.x3.test(r))throw Error("illegal message field type: "+r);if(s.keytype=r,this.i4.XE(","),r=this.i4.next(),!h._L.test(r)&&!h.x3.test(r))throw Error("illegal message field: "+r);if(s.type=r,this.i4.XE(">"),r=this.i4.next(),!h.gL.test(r))throw Error("illegal message field name: "+r);s.name=r,this.i4.XE("="),s.id=o(this.i4.next()),"["===(r=this.i4.DP())&&this.T4(s),this.i4.XE(";")}else if("group"===(n=void 0!==n?n:this.i4.next())){var e=this.o4(t,s);if(!/^[A-Z]/.test(e.name))throw Error("illegal group name: "+e.name);s.type=e.name,s.name=e.name.toLowerCase(),this.i4.r4(";")}else{if(!h._L.test(n)&&!h.x3.test(n))throw Error("illegal message field type: "+n);if(s.type=n,r=this.i4.next(),!h.gL.test(r))throw Error("illegal message field name: "+r);s.name=r,this.i4.XE("="),s.id=o(this.i4.next()),"["===(r=this.i4.DP())&&this.T4(s),this.i4.XE(";")}return t.fields.push(s),s},e.m4=function(t){var i=this.i4.next();if(!h.gL.test(i))throw Error("illegal oneof name: "+i);var n,r=i,s=[];for(this.i4.XE("{");"}"!==(i=this.i4.next());)(n=this.O4(t,"optional",i)).R4=r,s.push(n.id);this.i4.r4(";"),t.b4[r]=s},e.T4=function(t){this.i4.XE("[");for(var i=!0;"]"!==this.i4.DP();)i||this.i4.XE(","),this.a4(t,!0),i=!1;this.i4.next()},e.u4=function(t){var i={name:"",values:[],options:{}},n=this.i4.next();if(!h.gL.test(n))throw Error("illegal name: "+n);for(i.name=n,this.i4.XE("{");"}"!==(n=this.i4.next());)if("option"===n)this.a4(i);else{if(!h.gL.test(n))throw Error("illegal name: "+n);this.i4.XE("=");var r={name:n,id:o(this.i4.next(),!0)};"["===(n=this.i4.DP())&&this.T4({options:{}}),this.i4.XE(";"),i.values.push(r)}this.i4.r4(";"),t.e4.push(i)},e._4=function(t){var i=this.i4.next(),n=[];"min"===i?n.push(r.A3):"max"===i?n.push(r.I3):n.push(u(i)),this.i4.XE("to"),"min"===(i=this.i4.next())?n.push(r.A3):"max"===i?n.push(r.I3):n.push(u(i)),this.i4.XE(";"),t.extensions=n},e.c4=function(t){var i=this.i4.next();if(!h.x3.test(i))throw Error("illegal extend reference: "+i);var n={KY:i,fields:[]};for(this.i4.XE("{");"}"!==(i=this.i4.next());)if(h.F3.test(i))this.O4(n,i);else{if(!h.x3.test(i))throw Error("illegal extend token: "+i);if(!this.n4)throw Error("illegal field rule: "+i);this.O4(n,"optional",i)}return this.i4.r4(";"),t.messages.push(n),n},e.toString=function(){return"Parser at line "+this.i4.line},t.wJ=s,t}(s,s.Lang),s.Reflect=function(E){function f(t,i,n){this.S4=t,this.parent=i,this.name=n,this.className}var h={},t=f.prototype;function o(t,i,n,r,s){f.call(this,t,i,n),this.className="Namespace",this.children=[],this.options=r||{},this.h4=s||"proto2"}t.A4=function(){for(var t=this.name,i=this;null!=(i=i.parent);)t=i.name+"."+t;return t},t.toString=function(t){return(t?this.className+" ":"")+this.A4()},t._l=function(){throw Error(this.toString(!0)+" cannot be built directly")},h.I4=f;var i=o.prototype=Object.create(f.prototype);function c(t,i,n,r){if(this.type=t,this.N4=i,this.C4=n,this.h4=r,n&&E.S3.indexOf(t)<0)throw Error("Invalid map key type: "+t.name)}i.D4=function(t){if(null==(t=t||null))return this.children.slice();for(var i=[],n=0,r=this.children.length;n<r;++n)this.children[n]instanceof t&&i.push(this.children[n]);return i},i.j4=function(t){var i;if(i=this.M4(t.name))if(i instanceof l.P4&&i.name!==i.L4&&null===this.M4(i.L4))i.name=i.L4;else{if(!(t instanceof l.P4&&t.name!==t.L4&&null===this.M4(t.L4)))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+t.name);t.name=t.L4}this.children.push(t)},i.M4=function(t){for(var i="number"==typeof t?"id":"name",n=0,r=this.children.length;n<r;++n)if(this.children[n][i]===t)return this.children[n];return null},i.resolve=function(t,i){var n,r="string"==typeof t?t.split("."):t,s=this,e=0;if(""===r[e]){for(;null!==s.parent;)s=s.parent;e++}do{do{if(!(s instanceof h.H4)){s=null;break}if(!(n=s.M4(r[e]))||!(n instanceof h.I4)||i&&!(n instanceof h.H4)){s=null;break}s=n,e++}while(e<r.length);if(null!=s)break;if(null!==this.parent)return this.parent.resolve(t,i)}while(null!=s);return s},i.U4=function(t){for(var i=[],n=t;i.unshift(n.name),null!==(n=n.parent););for(var r=1;r<=i.length;r++){var s=i.slice(i.length-r);if(t===this.resolve(s,t instanceof h.H4))return s.join(".")}return t.A4()},i._l=function(){for(var t,i={},n=this.children,r=0,s=n.length;r<s;++r)(t=n[r])instanceof o&&(i[t.name]=t._l());return Object.defineProperty&&Object.defineProperty(i,"F4",{value:this.G4()}),i},i.G4=function(){for(var t={},i=Object.keys(this.options),n=0,r=i.length;n<r;++n){var s=i[n],e=this.options[i[n]];t[s]=e}return t},i.x4=function(t){return void 0===t?this.options:void 0!==this.options[t]?this.options[t]:null},h.H4=o;var n=c.prototype;function e(t,i){if(t&&"number"==typeof t.low&&"number"==typeof t.high&&"boolean"==typeof t.hN&&t.low==t.low&&t.high==t.high)return new E.ZA(t.low,t.high,void 0===i?t.hN:i);if("string"==typeof t)return E.ZA.fromString(t,i||!1,10);if("number"==typeof t)return E.ZA.rb(t,i||!1);throw Error("not convertible to Long")}c.B4=function(t){if("string"==typeof t&&(t=E.m3[t]),void 0===t.defaultValue)throw Error("default value for type "+t.name+" is not supported");return t==E.m3.bytes?new T(0):t.defaultValue},n.V4=function(i){var n=function(t,i){throw Error("Illegal value for "+this.toString(!0)+" of type "+this.type.name+": "+t+" ("+i+")")}.bind(this);switch(this.type){case E.m3.int32:case E.m3.sint32:case E.m3.sfixed32:return("number"!=typeof i||i==i&&i%1!=0)&&n(typeof i,"not an integer"),4294967295<i?0|i:i;case E.m3.uint32:case E.m3.fixed32:return("number"!=typeof i||i==i&&i%1!=0)&&n(typeof i,"not an integer"),i<0?i>>>0:i;case E.m3.int64:case E.m3.sint64:case E.m3.sfixed64:if(E.ZA)try{return e(i,!1)}catch(t){n(typeof i,t.message)}else n(typeof i,"requires Long.js");case E.m3.uint64:case E.m3.fixed64:if(E.ZA)try{return e(i,!0)}catch(t){n(typeof i,t.message)}else n(typeof i,"requires Long.js");case E.m3.bool:return"boolean"!=typeof i&&n(typeof i,"not a boolean"),i;case E.m3["float"]:case E.m3["double"]:return"number"!=typeof i&&n(typeof i,"not a number"),i;case E.m3.string:return"string"==typeof i||i&&i instanceof String||n(typeof i,"not a string"),""+i;case E.m3.bytes:return T.rI(i)?i:T.wrap(i,"base64");case E.m3["enum"]:var t=this.N4.D4(E.Reflect.Q4.q4);for(s=0;s<t.length;s++){if(t[s].name==i)return t[s].id;if(t[s].id==i)return t[s].id}if("proto3"===this.h4)return("number"!=typeof i||i==i&&i%1!=0)&&n(typeof i,"not an integer"),(4294967295<i||i<0)&&n(typeof i,"not in range for uint32"),i;n(i,"not a valid enum value");case E.m3.group:case E.m3.message:if(i&&"object"==typeof i||n(typeof i,"object expected"),i instanceof this.N4.Y4)return i;if(i instanceof E.K4.Lc){var r={};for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s]);i=r}return new this.N4.Y4(i)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+i+" (undefined type "+this.type+")")},n.W4=function(t,i){if(null===i)return 0;var n;switch(this.type){case E.m3.int32:return i<0?T.nN(i):T.KI(i);case E.m3.uint32:return T.KI(i);case E.m3.sint32:return T.KI(T.WI(i));case E.m3.fixed32:case E.m3.sfixed32:case E.m3["float"]:return 4;case E.m3.int64:case E.m3.uint64:return T.nN(i);case E.m3.sint64:return T.nN(T.eN(i));case E.m3.fixed64:case E.m3.sfixed64:return 8;case E.m3.bool:return 1;case E.m3["enum"]:return T.KI(i);case E.m3["double"]:return 8;case E.m3.string:return n=T._N(i),T.KI(n)+n;case E.m3.bytes:if(i.GN()<0)throw Error("Illegal value for "+this.toString(!0)+": "+i.GN()+" bytes remaining");return T.KI(i.GN())+i.GN();case E.m3.message:return n=this.N4.X4(i),T.KI(n)+n;case E.m3.group:return(n=this.N4.X4(i))+T.KI(t<<3|E.d3.y3)}throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+i+" (unknown type)")},n.z4=function(t,i,n){if(null===i)return n;switch(this.type){case E.m3.int32:i<0?n.cN(i):n.XI(i);break;case E.m3.uint32:n.XI(i);break;case E.m3.sint32:n.zI(i);break;case E.m3.fixed32:n.AI(i);break;case E.m3.sfixed32:n.RI(i);break;case E.m3.int64:case E.m3.uint64:n.cN(i);break;case E.m3.sint64:n.lN(i);break;case E.m3.fixed64:n.LI(i);break;case E.m3.sfixed64:n.kI(i);break;case E.m3.bool:"string"==typeof i?n.XI("false"===i.toLowerCase()?0:!!i):n.XI(i?1:0);break;case E.m3["enum"]:n.XI(i);break;case E.m3["float"]:n.GI(i);break;case E.m3["double"]:n.qI(i);break;case E.m3.string:n.NN(i);break;case E.m3.bytes:if(i.GN()<0)throw Error("Illegal value for "+this.toString(!0)+": "+i.GN()+" bytes remaining");var r=i.offset;n.XI(i.GN()),n.append(i),i.offset=r;break;case E.m3.message:var s=new T().PN();this.N4.encode(i,s),n.XI(s.offset),n.append(s.cl());break;case E.m3.group:this.N4.encode(i,n),n.XI(t<<3|E.d3.y3);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+i+" (unknown type)")}return n},n.decode=function(t,i,n){if(i!=this.type._3)throw Error("Unexpected wire type for element");var r,s;switch(this.type){case E.m3.int32:return 0|t.JI();case E.m3.uint32:return t.JI()>>>0;case E.m3.sint32:return 0|t.tN();case E.m3.fixed32:return t.NI()>>>0;case E.m3.sfixed32:return 0|t.SI();case E.m3.int64:return t.vN();case E.m3.uint64:return t.vN().uN();case E.m3.sint64:return t.dN();case E.m3.fixed64:return t.UI();case E.m3.sfixed64:return t.jI();case E.m3.bool:return!!t.JI();case E.m3["enum"]:return t.JI();case E.m3["float"]:return t.VI();case E.m3["double"]:return t.Rp();case E.m3.string:return t.CN();case E.m3.bytes:if(s=t.JI(),t.GN()<s)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+s+" required but got only "+t.GN());return(r=t.clone()).WA=r.offset+s,t.offset+=s,r;case E.m3.message:return s=t.JI(),this.N4.decode(t,s);case E.m3.group:return this.N4.decode(t,-1,n)}throw Error("[INTERNAL] Illegal decode type")},n.J4=function(t){if(!this.C4)throw Error("valueFromString() called on non-map-key element");switch(this.type){case E.m3.int32:case E.m3.sint32:case E.m3.sfixed32:case E.m3.uint32:case E.m3.fixed32:return this.V4(parseInt(t));case E.m3.int64:case E.m3.sint64:case E.m3.sfixed64:case E.m3.uint64:case E.m3.fixed64:return this.V4(t);case E.m3.bool:return"true"===t;case E.m3.string:return this.V4(t);case E.m3.bytes:return T.hI(t)}},n.Z4=function(t){if(!this.C4)throw Error("valueToString() called on non-map-key element");return this.type===E.m3.bytes?t.toString("binary"):t.toString()},h.Element=c;var l=function(t,i,n,r,s,e){o.call(this,t,i,n,r,e),this.className="Message",this.extensions=[E.A3,E.I3],this.Y4=null,this.y4=!!s,this.t5=null,this.i5=null,this.n5=null},r=l.prototype=Object.create(o.prototype);function w(t,i){var n=i.JI(),r=7&n,s=n>>>3;switch(r){case E.d3.E3:for(;128==(128&(n=i.EI())););break;case E.d3.w3:i.offset+=8;break;case E.d3.g3:n=i.JI(),i.offset+=n;break;case E.d3.b3:w(s,i);break;case E.d3.y3:if(s===t)return!1;throw Error("Illegal GROUPEND after unknown group: "+s+" ("+t+" expected)");case E.d3.T3:i.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+t+": "+r)}return!0}function u(t,i,n,r,s,e,h,o,u,a){f.call(this,t,i,e),this.className="Message.Field",this.required="required"===n,this.repeated="repeated"===n,this.map="map"===n,this.r5=r||null,this.type=s,this.N4=null,this.id=h,this.options=o||{},this.defaultValue=null,this.R4=u||null,this.h4=a||"proto2",this.L4=this.name,this.s5=null,this.e5=null,!this.S4.options.N3||this instanceof l.h5||(this.name=E.ST.H3(this.name))}r._l=function(t){if(this.Y4&&!t)return this.Y4;var i=function(c,h){var o=h.D4(c.Reflect.Lc.P4),u=h.D4(c.Reflect.Lc.o5),a=function(t,i){c.K4.Lc.call(this);for(var n=0,r=u.length;n<r;++n)this[u[n].name]=null;for(n=0,r=o.length;n<r;++n){var s=o[n];this[s.name]=s.repeated?[]:s.map?new c.Map(s):null,!s.required&&"proto3"!==h.h4||null===s.defaultValue||(this[s.name]=s.defaultValue)}var e;if(0<arguments.length)if(1!==arguments.length||null===t||"object"!=typeof t||!("function"!=typeof t.encode||t instanceof a)||Array.isArray(t)||t instanceof c.Map||T.rI(t)||t instanceof ArrayBuffer||c.ZA&&t instanceof c.ZA)for(n=0,r=arguments.length;n<r;++n)void 0!==(e=arguments[n])&&this.u5(o[n].name,e);else this.u5(t)},e=a.prototype=Object.create(c.K4.Lc.prototype);e.add=function(t,i,n){var r=h.n5[t];if(!n){if(!r)throw Error(this+"#"+t+" is undefined");if(!(r instanceof c.Reflect.Lc.P4))throw Error(this+"#"+t+" is not a field: "+r.toString(!0));if(!r.repeated)throw Error(this+"#"+t+" is not a repeated field");i=r.V4(i,!0)}return null===this[t]&&(this[t]=[]),this[t].push(i),this},e.a5=e.add,e.set=function(t,i,n){if(t&&"object"==typeof t){for(var r in n=i,t)t.hasOwnProperty(r)&&void 0!==(i=t[r])&&this.u5(r,i,n);return this}var s=h.n5[t];if(n)this[t]=i;else{if(!s)throw Error(this+"#"+t+" is not a field: undefined");if(!(s instanceof c.Reflect.Lc.P4))throw Error(this+"#"+t+" is not a field: "+s.toString(!0));this[s.name]=i=s.V4(i)}if(s&&s.R4){var e=this[s.R4.name];null!==i?(null!==e&&e!==s.name&&(this[e]=null),this[s.R4.name]=s.name):e===t&&(this[s.R4.name]=null)}return this},e.u5=e.set,e.get=function(t,i){if(i)return this[t];var n=h.n5[t];if(!(n&&n instanceof c.Reflect.Lc.P4))throw Error(this+"#"+t+" is not a field: undefined");if(!(n instanceof c.Reflect.Lc.P4))throw Error(this+"#"+t+" is not a field: "+n.toString(!0));return this[n.name]},e.f5=e.get;for(var t=0;t<o.length;t++){var i=o[t];i instanceof c.Reflect.Lc.h5||h.S4.options.C3&&(function(n){var t=n.L4.replace(/(_[a-zA-Z])/g,function(t){return t.toUpperCase().replace("_","")});function i(t,i){return this[n.name]=i?t:n.V4(t),this}function r(){return this[n.name]}t=t.substring(0,1).toUpperCase()+t.substring(1);var s=n.L4.replace(/([A-Z])/g,function(t){return"_"+t});null===h.M4("set"+t)&&(e["set"+t]=i),null===h.M4("set_"+s)&&(e["set_"+s]=i),null===h.M4("get"+t)&&(e["get"+t]=r),null===h.M4("get_"+s)&&(e["get_"+s]=r)})(i)}function l(t,n,r,s){if(null===t||"object"!=typeof t){if(s&&s instanceof c.Reflect.Q4){var i=c.Reflect.Q4.getName(s.object,t);if(null!==i)return i}return t}if(T.rI(t))return n?t.toBase64():t.toBuffer();if(c.ZA.c5(t))return r?t.toString():c.ZA.l5(t);var e;if(Array.isArray(t))return e=[],t.forEach(function(t,i){e[i]=l(t,n,r,s)}),e;if(e={},t instanceof c.Map){for(var h=t.entries(),o=h.next();!o.done;o=h.next())e[t.v5.Z4(o.value[0])]=l(o.value[1],n,r,t.d5.N4);return e}var u=t.E5,a=void 0;for(var f in t)t.hasOwnProperty(f)&&(u&&(a=u.M4(f))?e[f]=l(t[f],n,r,a.N4):e[f]=l(t[f],n,r));return e}return e.encode=function(i,t){"boolean"==typeof i&&(t=i,i=void 0);var n=!1;i||(i=new T(),n=!0);var r=i.$A;try{return h.encode(this,i.PN(),t),(n?i.cl():i).PN(r)}catch(t){throw i.PN(r),t}},a.encode=function(t,i,n){return new a(t).encode(i,n)},e.X4=function(){return h.X4(this)},e.w5=function(t){var i=!1;t||(t=new T(),i=!0);var n=new T().PN();return h.encode(this,n).cl(),t.XI(n.GN()),t.append(n),i?t.cl():t},e.p5=function(){try{return this.encode().toArrayBuffer()}catch(t){throw t.g5&&(t.g5=t.g5.toArrayBuffer()),t}},e.toArrayBuffer=e.p5,e.b5=function(){try{return this.encode().toBuffer()}catch(t){throw t.g5&&(t.g5=t.g5.toBuffer()),t}},e.toBuffer=e.b5,e.y5=function(){try{return this.encode().toBase64()}catch(t){throw t.g5&&(t.g5=t.g5.toBase64()),t}},e.toBase64=e.y5,e.T5=function(){try{return this.encode().BN()}catch(t){throw t.g5&&(t.g5=t.g5.BN()),t}},e.BN=e.T5,e.O5=function(t,i){return l(this,!!t,!!i,this.E5)},e.m5=function(){return JSON.stringify(l(this,!0,!0,this.E5))},a.decode=function(i,t){"string"==typeof i&&(i=T.wrap(i,t||"base64"));var n=(i=T.rI(i)?i:T.wrap(i)).$A;try{var r=h.decode(i.PN());return i.PN(n),r}catch(t){throw i.PN(n),t}},a._5=function(i,t){if("string"==typeof i&&(i=T.wrap(i,t||"base64")),(i=T.rI(i)?i:T.wrap(i)).GN()<1)return null;var n=i.offset,r=i.JI();if(i.GN()<r)return i.offset=n,null;try{var s=h.decode(i.slice(i.offset,i.offset+r).PN());return i.offset+=r,s}catch(t){throw i.offset+=r,t}},a.decode64=function(t){return a.decode(t,"base64")},a.R5=function(t){return a.decode(t,"hex")},a.S5=function(t){return new a(JSON.parse(t))},e.toString=function(){return h.toString()},Object.defineProperty&&(Object.defineProperty(a,"F4",{value:h.G4()}),Object.defineProperty(e,"F4",{value:a.F4}),Object.defineProperty(a,"E5",{value:h}),Object.defineProperty(e,"E5",{value:h})),a}(E,this);this.t5=[],this.i5={},this.n5={};for(var n,r=0,s=this.children.length;r<s;r++)if((n=this.children[r])instanceof v||n instanceof l||n instanceof g){if(i.hasOwnProperty(n.name))throw Error("Illegal reflect child of "+this.toString(!0)+": "+n.toString(!0)+" cannot override static property '"+n.name+"'");i[n.name]=n._l()}else if(n instanceof l.P4)n._l(),this.t5.push(n),this.i5[n.id]=n,this.n5[n.name]=n;else if(!(n instanceof l.o5||n instanceof p))throw Error("Illegal reflect child of "+this.toString(!0)+": "+this.children[r].toString(!0));return this.Y4=i},r.encode=function(t,i,n){for(var r,s,e=null,h=0,o=this.t5.length;h<o;++h)s=t[(r=this.t5[h]).name],r.required&&null===s?null===e&&(e=r):r.encode(n?s:r.V4(s),i,t);if(null===e)return i;var u=Error("Missing at least one required field for "+this.toString(!0)+": "+e);throw u.g5=i,u},r.X4=function(t){for(var i,n,r=0,s=0,e=this.t5.length;s<e;++s){if(n=t[(i=this.t5[s]).name],i.required&&null===n)throw Error("Missing at least one required field for "+this.toString(!0)+": "+i);r+=i.X4(n,t)}return r},r.decode=function(t,i,n){i="number"==typeof i?i:-1;for(var r,s,e,h,o=t.offset,u=new this.Y4();t.offset<o+i||-1===i&&0<t.GN();){if(e=(r=t.JI())>>>3,(s=7&r)===E.d3.y3){if(e!==n)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+e+" ("+(n?n+" expected":"not a group")+")");break}if(h=this.i5[e]){if(h.repeated&&!h.options.A5)u[h.name].push(h.decode(s,t));else if(h.map){var a=h.decode(s,t);u[h.name].set(a[0],a[1])}else if(u[h.name]=h.decode(s,t),h.R4){var f=u[h.R4.name];null!==f&&f!==h.name&&(u[f]=null),u[h.R4.name]=h.name}}else switch(s){case E.d3.E3:t.JI();break;case E.d3.T3:t.offset+=4;break;case E.d3.w3:t.offset+=8;break;case E.d3.g3:var c=t.JI();t.offset+=c;break;case E.d3.b3:for(;w(e,t););break;default:throw Error("Illegal wire type for unknown field "+e+" in "+this.toString(!0)+"#decode: "+s)}}for(var l=0,v=this.t5.length;l<v;++l)if(null===u[(h=this.t5[l]).name])if("proto3"===this.h4)u[h.name]=h.defaultValue;else{if(h.required){var d=Error("Missing at least one required field for "+this.toString(!0)+": "+h.name);throw d.I5=u,d}E.D3&&null!==h.defaultValue&&(u[h.name]=h.defaultValue)}return u},h.Lc=l;var s=u.prototype=Object.create(f.prototype);function a(t,i,n,r,s,e,h){u.call(this,t,i,n,null,r,s,e,h),this.N5}s._l=function(){this.s5=new c(this.type,this.N4,!1,this.h4),this.map&&(this.e5=new c(this.r5,void 0,!0,this.h4)),"proto3"!==this.h4||this.repeated||this.map?void 0!==this.options["default"]&&(this.defaultValue=this.V4(this.options["default"])):this.defaultValue=c.B4(this.type)},s.V4=function(t,i){i=i||!1;var n,r=function(t,i){throw Error("Illegal value for "+this.toString(!0)+" of type "+this.type.name+": "+t+" ("+i+")")}.bind(this);if(null===t)return this.required&&r(typeof t,"required"),"proto3"===this.h4&&this.type!==E.m3.message&&r(typeof t,"proto3 field without field presence cannot be null"),null;if(!this.repeated||i)return this.map&&!i?t instanceof E.Map?t:(t instanceof Object||r(typeof t,"expected ProtoBuf.Map or raw object for map field"),new E.Map(this,t)):(!this.repeated&&Array.isArray(t)&&r(typeof t,"no array expected"),this.s5.V4(t));Array.isArray(t)||(t=[t]);var s=[];for(n=0;n<t.length;n++)s.push(this.s5.V4(t[n]));return s},s.C5=function(t,i){if("proto3"!==this.h4)return null!==t;if(this.R4&&i[this.R4.name]===this.name)return!0;switch(this.type){case E.m3.int32:case E.m3.sint32:case E.m3.sfixed32:case E.m3.uint32:case E.m3.fixed32:return 0!==t;case E.m3.int64:case E.m3.sint64:case E.m3.sfixed64:case E.m3.uint64:case E.m3.fixed64:return 0!==t.low||0!==t.high;case E.m3.bool:return t;case E.m3["float"]:case E.m3["double"]:return 0!==t;case E.m3.string:return 0<t.length;case E.m3.bytes:return 0<t.GN();case E.m3["enum"]:return 0!==t;case E.m3.message:return null!==t;default:return!0}},s.encode=function(i,s,t){if(null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===i||this.repeated&&0==i.length)return s;try{var n;if(this.repeated)if(this.options.A5&&0<=E.O3.indexOf(this.type._3)){s.XI(this.id<<3|E.d3.g3),s.MN(s.offset+=1);var r=s.offset;for(n=0;n<i.length;n++)this.s5.z4(this.id,i[n],s);var e=s.offset-r,h=T.KI(e);if(1<h){var o=s.slice(r,s.offset);r+=h-1,s.offset=r,s.append(o)}s.XI(e,r-h)}else for(n=0;n<i.length;n++)s.XI(this.id<<3|this.type._3),this.s5.z4(this.id,i[n],s);else this.map?i.forEach(function(t,i,n){var r=T.KI(8|this.r5._3)+this.e5.W4(1,i)+T.KI(16|this.type._3)+this.s5.W4(2,t);s.XI(this.id<<3|E.d3.g3),s.XI(r),s.XI(8|this.r5._3),this.e5.z4(1,i,s),s.XI(16|this.type._3),this.s5.z4(2,t,s)},this):this.C5(i,t)&&(s.XI(this.id<<3|this.type._3),this.s5.z4(this.id,i,s))}catch(t){throw Error("Illegal value for "+this.toString(!0)+": "+i+" ("+t+")")}return s},s.X4=function(i,t){if(i=this.V4(i),null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===i||this.repeated&&0==i.length)return 0;var s=0;try{var n,r;if(this.repeated)if(this.options.A5&&0<=E.O3.indexOf(this.type._3)){for(s+=T.KI(this.id<<3|E.d3.g3),n=r=0;n<i.length;n++)r+=this.s5.W4(this.id,i[n]);s+=T.KI(r),s+=r}else for(n=0;n<i.length;n++)s+=T.KI(this.id<<3|this.type._3),s+=this.s5.W4(this.id,i[n]);else this.map?i.forEach(function(t,i,n){var r=T.KI(8|this.r5._3)+this.e5.W4(1,i)+T.KI(16|this.type._3)+this.s5.W4(2,t);s+=T.KI(this.id<<3|E.d3.g3),s+=T.KI(r),s+=r},this):this.C5(i,t)&&(s+=T.KI(this.id<<3|this.type._3),s+=this.s5.W4(this.id,i))}catch(t){throw Error("Illegal value for "+this.toString(!0)+": "+i+" ("+t+")")}return s},s.decode=function(t,i,n){var r,s;if(!(!this.map&&t==this.type._3||!n&&this.repeated&&this.options.A5&&t==E.d3.g3||this.map&&t==E.d3.g3))throw Error("Illegal wire type for field "+this.toString(!0)+": "+t+" ("+this.type._3+" expected)");if(t==E.d3.g3&&this.repeated&&this.options.A5&&0<=E.O3.indexOf(this.type._3)&&!n){s=i.JI(),s=i.offset+s;for(var e=[];i.offset<s;)e.push(this.decode(this.type._3,i,!0));return e}if(this.map){var h=c.B4(this.r5);if(r=c.B4(this.type),s=i.JI(),i.GN()<s)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+s+" required but got only "+i.GN());var o=i.clone();for(o.WA=o.offset+s,i.offset+=s;0<o.GN();){var u=o.JI();t=7&u;var a=u>>>3;if(1==a)h=this.e5.decode(o,t,a);else{if(2!=a)throw Error("Unexpected tag in map field key/value submessage");r=this.s5.decode(o,t,a)}}return[h,r]}return this.s5.decode(i,t,this.id)},h.Lc.P4=u,a.prototype=Object.create(u.prototype),h.Lc.h5=a,h.Lc.o5=function(t,i,n){f.call(this,t,i,n),this.fields=[]};var v=function(t,i,n,r,s){o.call(this,t,i,n,r,s),this.className="Enum",this.object=null};function d(t,i,n,r){f.call(this,t,i,n),this.className="Enum.Value",this.id=r}v.getName=function(t,i){for(var n,r=Object.keys(t),s=0;s<r.length;++s)if(t[n=r[s]]===i)return n;return null},(v.prototype=Object.create(o.prototype))._l=function(t){if(this.object&&!t)return this.object;for(var i=new E.K4.Q4(),n=this.D4(v.q4),r=0,s=n.length;r<s;++r)i[n[r].name]=n[r].id;return Object.defineProperty&&Object.defineProperty(i,"F4",{value:this.G4(),enumerable:!1}),this.object=i},h.Q4=v,d.prototype=Object.create(f.prototype),h.Q4.q4=d;var p=function(t,i,n,r){f.call(this,t,i,n),this.field=r};p.prototype=Object.create(f.prototype),h.k5=p;var g=function(t,i,n,r){o.call(this,t,i,n,r),this.className="Service",this.Y4=null};function b(t,i,n,r){f.call(this,t,i,n),this.className="Service.Method",this.options=r||{}}function y(t,i,n,r,s,e,h,o){b.call(this,t,i,n,o),this.className="Service.RPCMethod",this.D5=r,this.j5=s,this.M5=e,this.P5=h,this.L5=null,this.H5=null}return(g.prototype=Object.create(o.prototype))._l=function(t){return this.Y4&&!t?this.Y4:this.Y4=function(i,s){for(var e=function(t){i.K4.U5.call(this),this.F5=t||function(t,i,n){setTimeout(n.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}},t=e.prototype=Object.create(i.K4.U5.prototype),n=s.D4(i.Reflect.U5.G5),r=0;r<n.length;r++)!function(r){t[r.name]=function(t,n){try{try{t=r.L5.Y4.decode(T.wrap(t))}catch(t){if(!(t instanceof TypeError))throw t}if(null===t||"object"!=typeof t)throw Error("Illegal arguments");t instanceof r.L5.Y4||(t=new r.L5.Y4(t)),this.F5(r.A4(),t,function(t,i){if(t)n(t);else{try{i=r.H5.Y4.decode(i)}catch(t){}i&&i instanceof r.H5.Y4?n(null,i):n(Error("Illegal response type received in service method "+s.name+"#"+r.name))}})}catch(t){setTimeout(n.bind(this,t),0)}},e[r.name]=function(t,i,n){new e(t)[r.name](i,n)},Object.defineProperty&&(Object.defineProperty(e[r.name],"F4",{value:r.G4()}),Object.defineProperty(t[r.name],"F4",{value:e[r.name].F4}))}(n[r]);return Object.defineProperty&&(Object.defineProperty(e,"F4",{value:s.G4()}),Object.defineProperty(t,"F4",{value:e.F4}),Object.defineProperty(e,"E5",{value:s}),Object.defineProperty(t,"E5",{value:s})),e}(E,this)},h.U5=g,(b.prototype=Object.create(f.prototype)).G4=i.G4,h.U5.x5=b,y.prototype=Object.create(b.prototype),h.U5.G5=y,h}(s),s.K4=function(c,i,h){function o(t){this.B5=new h.H4(this,null,""),this.V5=this.B5,this.q5=!1,this.result=null,this.files={},this.Q5=null,this.options=t||{}}var t=o.prototype;return o.Y5=function(t){return"string"==typeof t.name&&void 0===t.values&&void 0===t.d4},o.K5=function(t){return"string"==typeof t.rule&&"string"==typeof t.name&&"string"==typeof t.type&&void 0!==t.id},o.W5=function(t){return"string"==typeof t.name&&!(void 0===t.values||!Array.isArray(t.values)||0===t.values.length)},o.X5=function(t){return!("string"!=typeof t.name||"object"!=typeof t.d4||!t.d4)},o.z5=function(t){return"string"==typeof t.KY},t.reset=function(){return this.V5=this.B5,this},t.define=function(t){if("string"!=typeof t||!i.x3.test(t))throw Error("illegal namespace: "+t);return t.split(".").forEach(function(t){var i=this.V5.M4(t);null===i&&this.V5.j4(i=new h.H4(this,this.V5,t)),this.V5=i},this),this},t.create=function(t){if(!t)return this;if(Array.isArray(t)){if(0===t.length)return this;t=t.slice()}else t=[t];for(var i=[t];0<i.length;){if(t=i.pop(),!Array.isArray(t))throw Error("not a valid namespace: "+JSON.stringify(t));for(;0<t.length;){var n=t.shift();if(o.Y5(n)){var s=new h.Lc(this,this.V5,n.name,n.options,n.y4,n.h4),r={};n.b4&&Object.keys(n.b4).forEach(function(t){s.j4(r[t]=new h.Lc.o5(this,s,t))},this),n.fields&&n.fields.forEach(function(t){if(null!==s.M4(0|t.id))throw Error("duplicate or invalid field id in "+s.name+": "+t.id);if(t.options&&"object"!=typeof t.options)throw Error("illegal field options in "+s.name+"#"+t.name);var i=null;if("string"==typeof t.R4&&!(i=r[t.R4]))throw Error("illegal oneof in "+s.name+"#"+t.name+": "+t.R4);t=new h.Lc.P4(this,s,t.rule,t.keytype,t.type,t.name,t.id,t.options,i,n.h4),i&&i.fields.push(t),s.j4(t)},this);var e=[];if(n.e4&&n.e4.forEach(function(t){e.push(t)}),n.messages&&n.messages.forEach(function(t){e.push(t)}),n.services&&n.services.forEach(function(t){e.push(t)}),n.extensions&&(s.extensions=n.extensions,s.extensions[0]<c.A3&&(s.extensions[0]=c.A3),s.extensions[1]>c.I3&&(s.extensions[1]=c.I3)),this.V5.j4(s),0<e.length){i.push(t),t=e,e=null,this.V5=s,s=null;continue}e=null}else if(o.W5(n))s=new h.Q4(this,this.V5,n.name,n.options,n.h4),n.values.forEach(function(t){s.j4(new h.Q4.q4(this,s,t.name,t.id))},this),this.V5.j4(s);else if(o.X5(n))s=new h.U5(this,this.V5,n.name,n.options),Object.keys(n.d4).forEach(function(t){var i=n.d4[t];s.j4(new h.U5.G5(this,s,t,i.request,i.response,!!i.w4,!!i.g4,i.options))},this),this.V5.j4(s);else{if(!o.z5(n))throw Error("not a valid definition: "+JSON.stringify(n));if(s=this.V5.resolve(n.KY,!0))n.fields.forEach(function(t){if(null!==s.M4(0|t.id))throw Error("duplicate extended field id in "+s.name+": "+t.id);if(t.id<s.extensions[0]||t.id>s.extensions[1])throw Error("illegal extended field id in "+s.name+": "+t.id+" ("+s.extensions.join(" to ")+" expected)");var i=t.name;this.options.N3&&(i=c.ST.H3(i));var n=new h.Lc.h5(this,s,t.rule,t.type,this.V5.A4()+"."+i,t.id,t.options),r=new h.k5(this,this.V5,t.name,n);n.N5=r,this.V5.j4(r),s.j4(n)},this);else if(!/\.?google\.protobuf\./.test(n.KY))throw Error("extended message "+n.KY+" is not defined")}s=n=null}t=null,this.V5=this.V5.parent}return this.q5=!1,this.result=null,this},t["import"]=function(i,t){var n="/";if("string"==typeof t){if(c.ST.j3&&(t=l(109).resolve(t)),!0===this.files[t])return this.reset();this.files[t]=!0}else if("object"==typeof t){var r=t.root;c.ST.j3&&(r=l(109).resolve(r)),(0<=r.indexOf("\\")||0<=t.J5.indexOf("\\"))&&(n="\\");var s=r+n+t.J5;if(!0===this.files[s])return this.reset();this.files[s]=!0}if(i.imports&&0<i.imports.length){var e,h=!1;"object"==typeof t?(this.Q5=t.root,h=!0,e=this.Q5,t=t.J5,(0<=e.indexOf("\\")||0<=t.indexOf("\\"))&&(n="\\")):"string"==typeof t?this.Q5?e=this.Q5:0<=t.indexOf("/")?""===(e=t.replace(/\/[^\/]*$/,""))&&(e="/"):0<=t.indexOf("\\")?(e=t.replace(/\\[^\\]*$/,""),n="\\"):e=".":e=null;for(var o=0;o<i.imports.length;o++)if("string"==typeof i.imports[o]){if(!e)throw Error("cannot determine import root");var u=i.imports[o];if("google/protobuf/descriptor.proto"===u)continue;if(u=e+n+u,!0===this.files[u])continue;/\.proto$/i.test(u)&&!c.Z3&&(u=u.replace(/\.proto$/,".json"));var a=c.ST.fetch(u);if(null===a)throw Error("failed to import '"+u+"' in '"+t+"': file not found");/\.json$/i.test(u)?this["import"](JSON.parse(a+""),u):this["import"](c.Z3.wJ.parse(a),u)}else t?/\.(\w+)$/.test(t)?this["import"](i.imports[o],t.replace(/^(.+)\.(\w+)$/,function(t,i,n){return i+"_import"+o+"."+n})):this["import"](i.imports[o],t+"_import"+o):this["import"](i.imports[o]);h&&(this.Q5=null)}i["package"]&&this.define(i["package"]),i.h4&&(function i(n){n.messages&&n.messages.forEach(function(t){t.h4=n.h4,i(t)}),n.e4&&n.e4.forEach(function(t){t.h4=n.h4})})(i);var f=this.V5;return i.options&&Object.keys(i.options).forEach(function(t){f.options[t]=i.options[t]}),i.messages&&(this.create(i.messages),this.V5=f),i.e4&&(this.create(i.e4),this.V5=f),i.services&&(this.create(i.services),this.V5=f),i.Z5&&this.create(i.Z5),this.reset()},t.t6=function(){var t;if(null==this.V5||"object"==typeof this.V5.type)return this;if(this.V5 instanceof h.H4)this.V5.children.forEach(function(t){this.V5=t,this.t6()},this);else if(this.V5 instanceof h.Lc.P4){if(i._L.test(this.V5.type))this.V5.type=c.m3[this.V5.type];else{if(!i.x3.test(this.V5.type))throw Error("illegal type reference in "+this.V5.toString(!0)+": "+this.V5.type);if(!(t=(this.V5 instanceof h.Lc.h5?this.V5.N5.parent:this.V5.parent).resolve(this.V5.type,!0)))throw Error("unresolvable type reference in "+this.V5.toString(!0)+": "+this.V5.type);if((this.V5.N4=t)instanceof h.Q4){if(this.V5.type=c.m3["enum"],"proto3"===this.V5.h4&&"proto3"!==t.h4)throw Error("proto3 message cannot reference proto2 enum")}else{if(!(t instanceof h.Lc))throw Error("illegal type reference in "+this.V5.toString(!0)+": "+this.V5.type);this.V5.type=t.y4?c.m3.group:c.m3.message}}if(this.V5.map){if(!i._L.test(this.V5.r5))throw Error("illegal key type for map field in "+this.V5.toString(!0)+": "+this.V5.r5);this.V5.r5=c.m3[this.V5.r5]}}else if(this.V5 instanceof c.Reflect.U5.x5){if(!(this.V5 instanceof c.Reflect.U5.G5))throw Error("illegal service type in "+this.V5.toString(!0));if(!((t=this.V5.parent.resolve(this.V5.D5,!0))&&t instanceof c.Reflect.Lc))throw Error("Illegal type reference in "+this.V5.toString(!0)+": "+this.V5.D5);if(this.V5.L5=t,!((t=this.V5.parent.resolve(this.V5.j5,!0))&&t instanceof c.Reflect.Lc))throw Error("Illegal type reference in "+this.V5.toString(!0)+": "+this.V5.j5);this.V5.H5=t}else if(!(this.V5 instanceof c.Reflect.Lc.o5||this.V5 instanceof c.Reflect.k5||this.V5 instanceof c.Reflect.Q4.q4))throw Error("illegal object in namespace: "+typeof this.V5+": "+this.V5);return this.reset()},t._l=function(t){if(this.reset(),this.q5||(this.t6(),this.q5=!0,this.result=null),null===this.result&&(this.result=this.B5._l()),!t)return this.result;for(var i="string"==typeof t?t.split("."):t,n=this.result,r=0;r<i.length;r++){if(!n[i[r]]){n=null;break}n=n[i[r]]}return n},t.lookup=function(t,i){return t?this.B5.resolve(t,i):this.B5},t.toString=function(){return"Builder"},o.Lc=function(){},o.Q4=function(){},o.U5=function(){},o}(s,s.Lang,s.Reflect),s.Map=function(t,h){function i(t,i){if(!t.map)throw Error("field is not a map");if(this.field=t,this.v5=new h.Element(t.r5,null,!0,t.h4),this.d5=new h.Element(t.type,t.N4,!1,t.h4),this.map={},Object.defineProperty(this,"size",{get:function(){return Object.keys(this.map).length}}),i)for(var n=Object.keys(i),r=0;r<n.length;r++){var s=this.v5.J4(n[r]),e=this.d5.V4(i[n[r]]);this.map[this.v5.Z4(s)]={key:s,value:e}}}var n=i.prototype;function s(t){var i=0;return{next:function(){return i<t.length?{done:!1,value:t[i++]}:{done:!0}}}}return n.clear=function(){this.map={}},n["delete"]=function(t){var i=this.v5.Z4(this.v5.V4(t)),n=i in this.map;return delete this.map[i],n},n.entries=function(){for(var t,i=[],n=Object.keys(this.map),r=0;r<n.length;r++)i.push([(t=this.map[n[r]]).key,t.value]);return s(i)},n.keys=function(){for(var t=[],i=Object.keys(this.map),n=0;n<i.length;n++)t.push(this.map[i[n]].key);return s(t)},n.values=function(){for(var t=[],i=Object.keys(this.map),n=0;n<i.length;n++)t.push(this.map[i[n]].value);return s(t)},n.forEach=function(t,i){for(var n,r=Object.keys(this.map),s=0;s<r.length;s++)t.call(i,(n=this.map[r[s]]).value,n.key,this)},n.set=function(t,i){var n=this.v5.V4(t),r=this.d5.V4(i);return this.map[this.v5.Z4(n)]={key:n,value:r},this},n.get=function(t){var i=this.v5.Z4(this.v5.V4(t));if(i in this.map)return this.map[i].value},n.has=function(t){return this.v5.Z4(this.v5.V4(t))in this.map},i}(0,s.Reflect),s.i6=function(t,i,n){return("string"==typeof i||i&&"string"==typeof i.J5&&"string"==typeof i.root)&&(n=i,i=void 0),s.Rl(s.Z3.wJ.parse(t),i,n)},s.n6=s.i6,s.r6=function(i,n,r){if(n&&"object"==typeof n?(r=n,n=null):n&&"function"==typeof n||(n=null),n)return s.ST.fetch("string"==typeof i?i:i.root+"/"+i.J5,function(t){if(null!==t)try{n(null,s.i6(t,r,i))}catch(t){n(t)}else n(Error("Failed to fetch file"))});var t=s.ST.fetch("object"==typeof i?i.root+"/"+i.J5:i);return null===t?null:s.i6(t,r,i)},s.s6=s.r6,s.e6=function(t){return void 0===(t=t||{}).N3&&(t.N3=s.N3),void 0===t.C3&&(t.C3=s.C3),new s.K4(t)},s.Rl=function(t,i,n){return("string"==typeof i||i&&"string"==typeof i.J5&&"string"==typeof i.root)&&(n=i,i=null),i&&"object"==typeof i||(i=s.e6()),"string"==typeof t&&(t=JSON.parse(t)),i["import"](t,n),i.t6(),i},s.h6=function(i,n,r){if(n&&"object"==typeof n?(r=n,n=null):n&&"function"==typeof n||(n=null),n)return s.ST.fetch("string"==typeof i?i:i.root+"/"+i.J5,function(t){if(null!==t)try{n(null,s.Rl(JSON.parse(t),r,i))}catch(t){n(t)}else n(Error("Failed to fetch file"))});var t=s.ST.fetch("object"==typeof i?i.root+"/"+i.J5:i);return null===t?null:s.Rl(JSON.parse(t),r,i)},s})?t.apply(e,n):t)||(s.exports=r)}).call(this,l(37))},function(t,i,n){var r,s,e;s=[],void 0===(e="function"==typeof (r=function(){"use strict";function v(t,i,n){this.low=0|t,this.high=0|i,this.hN=!!n}Object.defineProperty(v.prototype,"o6",{value:!0,enumerable:!1,configurable:!1}),v.c5=function(t){return!0===(t&&t.o6)};var s={},e={};v.cb=function(t,i){var n,r;return i?0<=(t>>>=0)&&t<256&&(r=e[t])?r:(n=new v(t,(0|t)<0?-1:0,!0),0<=t&&t<256&&(e[t]=n),n):-128<=(t|=0)&&t<128&&(r=s[t])?r:(n=new v(t,t<0?-1:0,!1),-128<=t&&t<128&&(s[t]=n),n)},v.rb=function(t,i){return i=!!i,isNaN(t)||!isFinite(t)?v.ZERO:!i&&t<=-h?v.MIN_VALUE:!i&&h<=t+1?v.MAX_VALUE:i&&r<=t?v.u6:t<0?v.rb(-t,i).Ub():new v(t%n|0,t/n|0,i)},v.LO=function(t,i,n){return new v(t,i,n)},v.fromString=function(t,i,n){if(0===t.length)throw Error("number format error: empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return v.ZERO;if("number"==typeof i&&(n=i,i=!1),(n=n||10)<2||36<n)throw Error("radix out of range: "+n);var r;if(0<(r=t.indexOf("-")))throw Error('number format error: interior "-" character: '+t);if(0===r)return v.fromString(t.substring(1),i,n).Ub();for(var s=v.rb(Math.pow(n,8)),e=v.ZERO,h=0;h<t.length;h+=8){var o=Math.min(8,t.length-h),u=parseInt(t.substring(h,h+o),n);if(o<8){var a=v.rb(Math.pow(n,o));e=e.multiply(a).add(v.rb(u))}else e=(e=e.multiply(s)).add(v.rb(u))}return e.hN=i,e},v.l5=function(t){return t instanceof v?t:"number"==typeof t?v.rb(t):"string"==typeof t?v.fromString(t):new v(t.low,t.high,t.hN)};var n=4294967296,r=n*n,h=r/2,d=v.cb(1<<24);return v.ZERO=v.cb(0),v.R3=v.cb(0,!0),v.ONE=v.cb(1),v.a6=v.cb(1,!0),v.f6=v.cb(-1),v.MAX_VALUE=v.LO(-1,2147483647,!1),v.u6=v.LO(-1,-1,!0),v.MIN_VALUE=v.LO(0,-2147483648,!1),v.prototype.rN=function(){return this.hN?this.low>>>0:this.low},v.prototype.c6=function(){return this.hN?(this.high>>>0)*n+(this.low>>>0):this.high*n+(this.low>>>0)},v.prototype.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix out of range: "+t);if(this.l6())return"0";var i;if(this.dJ()){if(this.equals(v.MIN_VALUE)){var n=v.rb(t),r=this.v6(n);return i=r.multiply(n).d6(this),r.toString(t)+i.rN().toString(t)}return"-"+this.Ub().toString(t)}var s=v.rb(Math.pow(t,6),this.hN);i=this;for(var e="";;){var h=i.v6(s),o=(i.d6(h.multiply(s)).rN()>>>0).toString(t);if((i=h).l6())return o+e;for(;o.length<6;)o="0"+o;e=""+o+e}},v.prototype.E6=function(){return this.high},v.prototype.w6=function(){return this.high>>>0},v.prototype.p6=function(){return this.low},v.prototype.g6=function(){return this.low>>>0},v.prototype.b6=function(){if(this.dJ())return this.equals(v.MIN_VALUE)?64:this.Ub().b6();for(var t=0!=this.high?this.high:this.low,i=31;0<i&&0==(t&1<<i);i--);return 0!=this.high?i+33:i+1},v.prototype.l6=function(){return 0===this.high&&0===this.low},v.prototype.dJ=function(){return!this.hN&&this.high<0},v.prototype.y6=function(){return this.hN||0<=this.high},v.prototype.T6=function(){return 1==(1&this.low)},v.prototype.Hb=function(){return 0==(1&this.low)},v.O6=v.prototype.equals=function(t){return v.c5(t)||(t=v.l5(t)),(this.hN===t.hN||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low},v.m6=v.prototype._6=function(t){return!this.equals(t)},v.prototype.R6=v.prototype.S6=function(t){return this.compare(t)<0},v.prototype.A6=v.prototype.I6=function(t){return this.compare(t)<=0},v.prototype.N6=v.prototype.C6=function(t){return 0<this.compare(t)},v.prototype.k6=v.prototype.D6=function(t){return 0<=this.compare(t)},v.prototype.compare=function(t){if(v.c5(t)||(t=v.l5(t)),this.equals(t))return 0;var i=this.dJ(),n=t.dJ();return i&&!n?-1:!i&&n?1:this.hN?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.d6(t).dJ()?-1:1},v.prototype.j6=v.prototype.Ub=function(){return!this.hN&&this.equals(v.MIN_VALUE)?v.MIN_VALUE:this.not().add(v.ONE)},v.prototype.add=function(t){v.c5(t)||(t=v.l5(t));var i=this.high>>>16,n=65535&this.high,r=this.low>>>16,s=65535&this.low,e=t.high>>>16,h=65535&t.high,o=t.low>>>16,u=0,a=0,f=0,c=0;return f+=(c+=s+(65535&t.low))>>>16,a+=(f+=r+o)>>>16,u+=(a+=n+h)>>>16,u+=i+e,v.LO((f&=65535)<<16|(c&=65535),(u&=65535)<<16|(a&=65535),this.hN)},v.prototype.sub=v.prototype.d6=function(t){return v.c5(t)||(t=v.l5(t)),this.add(t.Ub())},v.prototype.M6=v.prototype.multiply=function(t){if(this.l6())return v.ZERO;if(v.c5(t)||(t=v.l5(t)),t.l6())return v.ZERO;if(this.equals(v.MIN_VALUE))return t.T6()?v.MIN_VALUE:v.ZERO;if(t.equals(v.MIN_VALUE))return this.T6()?v.MIN_VALUE:v.ZERO;if(this.dJ())return t.dJ()?this.Ub().multiply(t.Ub()):this.Ub().multiply(t).Ub();if(t.dJ())return this.multiply(t.Ub()).Ub();if(this.S6(d)&&t.S6(d))return v.rb(this.c6()*t.c6(),this.hN);var i=this.high>>>16,n=65535&this.high,r=this.low>>>16,s=65535&this.low,e=t.high>>>16,h=65535&t.high,o=t.low>>>16,u=65535&t.low,a=0,f=0,c=0,l=0;return c+=(l+=s*u)>>>16,f+=(c+=r*u)>>>16,c&=65535,f+=(c+=s*o)>>>16,a+=(f+=n*u)>>>16,f&=65535,a+=(f+=r*o)>>>16,f&=65535,a+=(f+=s*h)>>>16,a+=i*u+n*o+r*h+s*e,v.LO((c&=65535)<<16|(l&=65535),(a&=65535)<<16|(f&=65535),this.hN)},v.prototype.P6=v.prototype.v6=function(t){if(v.c5(t)||(t=v.l5(t)),t.l6())throw new Error("division by zero");if(this.l6())return this.hN?v.R3:v.ZERO;var i,n,r;if(this.equals(v.MIN_VALUE))return t.equals(v.ONE)||t.equals(v.f6)?v.MIN_VALUE:t.equals(v.MIN_VALUE)?v.ONE:(i=this.aN(1).v6(t).shiftLeft(1)).equals(v.ZERO)?t.dJ()?v.ONE:v.f6:(n=this.d6(t.multiply(i)),r=i.add(n.v6(t)));if(t.equals(v.MIN_VALUE))return this.hN?v.R3:v.ZERO;if(this.dJ())return t.dJ()?this.Ub().v6(t.Ub()):this.Ub().v6(t).Ub();if(t.dJ())return this.v6(t.Ub()).Ub();for(r=v.ZERO,n=this;n.D6(t);){i=Math.max(1,Math.floor(n.c6()/t.c6()));for(var s=Math.ceil(Math.log(i)/Math.LN2),e=s<=48?1:Math.pow(2,s-48),h=v.rb(i),o=h.multiply(t);o.dJ()||o.C6(n);)o=(h=v.rb(i-=e,this.hN)).multiply(t);h.l6()&&(h=v.ONE),r=r.add(h),n=n.d6(o)}return r},v.prototype.mb=v.prototype.iJ=function(t){return v.c5(t)||(t=v.l5(t)),this.d6(this.v6(t).multiply(t))},v.prototype.not=function(){return v.LO(~this.low,~this.high,this.hN)},v.prototype.and=function(t){return v.c5(t)||(t=v.l5(t)),v.LO(this.low&t.low,this.high&t.high,this.hN)},v.prototype.or=function(t){return v.c5(t)||(t=v.l5(t)),v.LO(this.low|t.low,this.high|t.high,this.hN)},v.prototype.xor=function(t){return v.c5(t)||(t=v.l5(t)),v.LO(this.low^t.low,this.high^t.high,this.hN)},v.prototype.L6=v.prototype.shiftLeft=function(t){return v.c5(t)&&(t=t.rN()),0==(t&=63)?this:t<32?v.LO(this.low<<t,this.high<<t|this.low>>>32-t,this.hN):v.LO(0,this.low<<t-32,this.hN)},v.prototype.H6=v.prototype.aN=function(t){return v.c5(t)&&(t=t.rN()),0==(t&=63)?this:t<32?v.LO(this.low>>>t|this.high<<32-t,this.high>>t,this.hN):v.LO(this.high>>t-32,0<=this.high?0:-1,this.hN)},v.prototype.U6=v.prototype.sN=function(t){if(v.c5(t)&&(t=t.rN()),0==(t&=63))return this;var i=this.high;if(t<32){var n=this.low;return v.LO(n>>>t|i<<32-t,i>>>t,this.hN)}return v.LO(32===t?i:i>>>t-32,0,this.hN)},v.prototype.oN=function(){return this.hN?new v(this.low,this.high,!1):this},v.prototype.uN=function(){return this.hN?this:new v(this.low,this.high,!0)},v})?r.apply(i,s):r)||(t.exports=e)},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=n(0),y=n(17),e=n(53),h=n(204),o=n(208),u=n(8),T=n(1),O=n(2),m=u.Y.af,a=u.Y.sf,f=(c.prototype.tl=function(){return this.sender.tl()||this.receiver.tl()},c.prototype.close=function(){var i=this,n=r.defer();return this.sender.F6().then(function(t){return i.receiver.close(t).then(function(t){return i.SQ(t).then(function(t){return i.transport.close(t).then(function(t){n.resolve(t)})})})})["catch"](function(t){T.ErrorMonitor.getInstance().logError("Error closing connection to peer",i.loggerId,O.Ft.jt,{detailedError:t,otherGuid:i.otherGuid}),n.reject("Close partnership failed")}),n.promise},c.prototype.SQ=function(t){this.logger.debug("SEND CLOSE TO "+this.otherGuid);var i=new y.Al.ml.Close();return i.setType(t),this.rl(y.Fc.Close,i),r(this.swarmId)},c.prototype.sh=function(t){try{switch(m&&this.logger.debug("DISPATCH "+t.bl),t.bl){case y.Fc.Chunk:var i=y.Al.ml.Chunk.decode(t.receivedData);this.receiver.G6(i);break;case y.Fc.Ack:var n=y.Al.ml.Ack.decode(t.receivedData);this.sender.x6(n.transferId);break;case y.Fc.Cancel:var r=y.Al.ml.Cancel.decode(t.receivedData);this.sender.B6(r.transferId);break;case y.Fc.Gc:m&&this.logger.debug("RECEIVED OUT PART,DECODING ");var s=y.Al.ml.OutPartnershipRequest.decode(t.receivedData);m&&this.logger.debug("RECEIVED OUT PART FROM "+s.guid),this.partnership.NQ(s,this.transport);break;case y.Fc.xc:m&&this.logger.debug("RECEIVED OUT PART RESP ");var e=y.Al.ml.OutPartnershipResponse.decode(t.receivedData);m&&this.logger.debug("RECEIVED OUT PART RESP FROM "+e.accept),this.partnership.$Q(e,this.transport);break;case y.Fc.Have:var h=y.Al.ml.Have.decode(t.receivedData);m&&this.logger.debug("RECEIVED HAVE FOR "+h.fragmentId+" FROM "+this.otherGuid),this.partnership.V6(this.otherGuid,h);break;case y.Fc.Close:var o=y.Al.ml.Close.decode(t.receivedData);m&&this.logger.debug("RECEIVED CLOSE FROM "+this.otherGuid),this.partnership.KQ(this.otherGuid,o);break;case y.Fc.Request:var u=y.Al.ml.Request.decode(t.receivedData);m&&this.logger.debug("RECEIVED REQUEST FOR "+u.fragmentId+" FROM "+this.otherGuid),this.e0.hH(this.otherGuid,u,this);break;case y.Fc.DoNotHave:var a=y.Al.ml.DoNotHave.decode(t.receivedData);m&&this.logger.debug("DoNotHave "+a.transferId),this.Q6.q6(a);break;case y.Fc.Bc:var f=y.Al.ml.UDPHandshakeMessage.decode(t.receivedData);m&&this.logger.debug("UDP HANDSHAKE MESSAGE RECEIVED FROM "+f.uuid),this.GZ.uq(f,this.transport);break;case y.Fc.UDPHandshakeResponse:var c=y.Al.ml.UDPHandshakeResponse.decode(t.receivedData);m&&this.logger.debug("UDP HANDSHAKE MESSAGE RESPONSE RECEIVED FROM "+this.otherGuid),this.GZ.oq(c,this.transport);break;case y.Fc.UDPSwitchLeadershipRequest:var l=y.Al.ml.UDPSwitchLeadershipRequest.decode(t.receivedData);m&&this.logger.debug("SWITCH LEADERSHIP REQUEST RECEIVED FROM "+this.otherGuid),this.GZ.Rq(l);break;case y.Fc.Vc:var v=y.Al.ml.UDPSwitchLeadershipAck.decode(t.receivedData);m&&this.logger.debug("UDP SWITCH ACKNOWLEDGMENT RESPONSE FROM "+this.otherGuid),this.GZ.kq(v,this.otherGuid);break;case y.Fc.QualityLevelMessage:var d=y.Al.ml.QualityLevelMessage.decode(t.receivedData);m&&this.logger.debug("QUALITY LEVEL INFO "+d.qualityLevel.id+" FROM "+d.guid),this.partnership.JQ(d);break;case y.Fc.Haves:var E=y.Al.ml.Haves.decode(t.receivedData);m&&this.logger.debug("RECEIVED BATCH HAVES FOR FROM "+this.otherGuid),this.partnership.Y6(this.otherGuid,E);break;case y.Fc.qc:var w=y.Al.ml.PeerInfoMessage.decode(t.receivedData);m&&this.logger.debug("RECEIVED PEER INFO FROM "+this.otherGuid),this.partnership.iY(w);break;case y.Fc.Ping:var p=y.Al.ml.Ping.decode(t.receivedData);m&&this.logger.debug("RECEIVED PING FROM "+this.otherGuid),this.partnership.K6(p);break;case y.Fc.Pong:var g=y.Al.ml.Pong.decode(t.receivedData);m&&this.logger.debug("RECEIVED PONG FROM "+this.otherGuid),this.partnership.W6(g);break;case y.Fc.Qc:var b=y.Al.ml.NoPartners.decode(t.receivedData);m&&this.logger.debug("RECEIVED NON PARTNER MESSAGE FROM "+this.otherGuid),this.Q6.X6(this.otherGuid,b);break;default:this.logger.warn("UNKNOWN MESSAGE TYPE "+t.bl)}}catch(t){T.ErrorMonitor.getInstance().logError("Error dispatching message",this.loggerId,t,O.Ft.Gt,t)}},c.prototype.rl=function(t,i){return this.transport.rl(t,this.swarmId,i)},c.prototype.dl=function(){this.sender.dl()},c);function c(t,i,n,r){this.loggerId="[P2PDispatcher] ",this.logger=s.Framework.resolve(s.Framework.v.p).log(t.sessionId),this.$c=i,this.otherGuid=n,this.swarmId=t.swarmId,this.transport=r,this.receiver=new h.z6(i,n,t),this.sender=new o.J6(i,n,t,this),this.Q6=t.oM,this.partnership=t.partnership,this.e0=t.e0,(a||s.Framework.T()&&e.$j.Kj)&&(this.GZ=t.GZ)}i.Wc=f},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=n(34),e=n(17),u=n(0),a=n(6),f=n(5),h=n(110),c=n(1),l=n(2),o=(v.prototype.setReportingGuid=function(t){this.Z6=t},v.prototype.tl=function(){return!(0===this.J1.keys().length&&null===this.t8)},v.prototype.n8=function(t){var i=new e.Al.ml.Request();try{i.fragmentId=t.I_(),i.transferId=t.OP,this.Uc&&this.logger.debug("INITIATING TR-"+t.OP+" TIMEOUT: "+t.r8+" FRAGMENT: "+t.I_()+" FROM: "+this.otherGuid),this.J1.set(t.OP,t),this.s8.set(t.OP,u.Framework.time())}catch(t){c.ErrorMonitor.getInstance().logError("Error constructing fragment request message",this.loggerId,l.Ur.Fr,{detailedError:t,otherGuid:this.otherGuid}),i=null}try{i&&t.partner.AQ.rl(e.Fc.Request,i)}catch(t){c.ErrorMonitor.getInstance().logError("Error sending fragment request",this.loggerId,l.Ur.Gr,{detailedError:t,otherGuid:this.otherGuid})}},v.prototype.G6=function(t){try{var i=t.transferId,n=t.data.toBuffer(),r=t.chunkSize,s=t.totalSize,e=t.headers;if(this.Uc&&this.logger.debug("RCV Chunk "+n.byteLength),!this.J1.has(i))return;null==this.t8?(this.Uc&&this.logger.debug("INITIATED TR-"+i+",SIZE="+s),this.t8=this.J1.get(i),this.t8.OP=i,f.xu.ju.Wo&&this.e8(i,this.t8.partner),null!=e?this.t8.K_=e:this.logger.warn("HEADERS NULL IN FIRST CHUNK"),this.Q6.I2(this.otherGuid,this.t8,r,s),this.t8.W_=r,u.Framework.T()||(this.t8.F_=n)):(f.xu.ju.Wo&&this.e8(i,this.t8.partner),this.t8.W_+=r,u.Framework.T()||(this.t8.F_=a.appendBuffer(this.t8.F_,n)));var h=u.Framework.T()?this.t8.W_:this.t8.F_.byteLength;if(this.Uc&&this.logger.debug("RECEIVED "+h+"/"+s+" TRID "+i),h==s){this.Uc&&this.logger.debug("RCV ALL DATA "+h+" TR-"+this.t8.C_),this.t8.L_.E_=h,u.Framework.clearTimeout(this.t8.hq),this.J1["delete"](i);var o=u.Framework.time()-this.s8.get(i);this.logger.debug("RCV ALL DATA FROM "+this.otherGuid+" AFTER "+o+" mseconds"),this.s8["delete"](i),this.Q6.SM(i,this.t8),this.t8=null}}catch(t){c.ErrorMonitor.getInstance().logError("Error receiving chunk",this.loggerId,l.Ur.xr,{detailedError:t,otherGuid:this.otherGuid})}},v.prototype.e8=function(t,i){try{this.Uc&&this.logger.debug("SEND ACK "+t+" TO "+this.otherGuid);var n=new e.Al.ml.Ack();n.transferId=t,i.AQ.rl(e.Fc.Ack,n)}catch(t){c.ErrorMonitor.getInstance().logError("Error sending ack",this.loggerId,l.Ur.Br,{detailedError:t,otherGuid:this.otherGuid})}},v.prototype.close=function(t){var i=this,n=r.defer();return null!=this.t8&&this.h8(this.t8.OP),this.J1.keys().slice().forEach(function(t){i.h8(t)}),n.resolve(h.Bq.FV),n.promise},v.prototype.h8=function(t){try{if(this.J1.has(t)){var i=this.J1.get(t);i.L_.E_=i.W_,this.logger.debug("SEND CANCEL FOR "+t+" TO "+this.otherGuid),this.s8["delete"](t);var n=new e.Al.ml.Cancel();n.transferId=t,i.partner.AQ.rl(e.Fc.Cancel,n),null!==this.t8&&this.t8.N_()===i.N_()&&(this.t8=null),this.J1["delete"](t)}else c.ErrorMonitor.getInstance().logError("Error cleaning up a not pending transfer",this.loggerId,l.Ur.Vr)}catch(t){c.ErrorMonitor.getInstance().logError("Error sending stop transfer",this.loggerId,l.Ur.qr,{detailedError:t,otherGuid:this.otherGuid})}},v);function v(t,i,n){this.loggerId="[FragmentRequester] ",this.J1=new s(),this.s8=new s(),this.t8=null,this.Uc=e.Uc,this.$c=t,this.otherGuid=i,this.Q6=n.oM,this.tv=n.tv,this.Jc=u.Framework.resolve(u.Framework.v.Zc),this.logger=u.Framework.resolve(u.Framework.v.p).log(n.sessionId)}i.z6=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var o=n(3),u=n(0),a=n(5),f=n(2),c=n(1),r=(s.prototype.HQ=function(t){this.reportingGuid=t,this.AQ&&(this.AQ.receiver.setReportingGuid(this.reportingGuid),this.AQ.sender.setReportingGuid(this.reportingGuid))},s.prototype.o8=function(t,i,n){var r=Math.max(1,i);for(n&&(this.u8+=r,this.a8+=t);this.f8.length>a.xu.ku.Lo;)this.f8.pop();var s=t/r;this.f8.unshift(s)},s.prototype.c8=function(t){this.J1.has(t)?this.logger.warn(this.guid+" DUPLICATE {} PENDING REQUESTS "+t):this.J1.set(t,u.Framework.time())},s.prototype.l8=function(t,i,n,r,s,e){try{if(this.J1.has(t)){var h=this.J1.get(t),o=u.Framework.time()-h;this.J1["delete"](t),r&&s&&this.o8(i,o,!0),this.tU.success(i),this.aH.v8(this.reportingGuid,i,n,s,e)}else c.ErrorMonitor.getInstance().logError("Error completing a non-existing request",this.loggerId,f.Ts.ms,{otherGuid:this.guid,Z6:this.reportingGuid})}catch(t){c.ErrorMonitor.getInstance().logError("Error handling request completed",this.loggerId,f.Ts.Os,{detailedError:t,otherGuid:this.guid,Z6:this.reportingGuid})}},s.prototype.d8=function(t,i,n,r,s,e){try{if(this.J1.has(t)){var h=this.J1.get(t);this.J1["delete"](t),a.xu.ku.Ho?this.o8(i,h,!0):this.o8(0,h,!0),this.tU.E8(i,r),this.aH.w8(this.reportingGuid,i,n,r,s,e)}else c.ErrorMonitor.getInstance().logError("Error partially failed a non-existing request",this.loggerId,f.Ts.Rs,{otherGuid:this.guid,Z6:this.reportingGuid})}catch(t){c.ErrorMonitor.getInstance().logError("Error handling request partially failed ",this.loggerId,f.Ts._s,{detailedError:t,otherGuid:this.guid})}},s.prototype.TP=function(t,i,n){try{if(this.J1.has(t)){var r=this.J1.get(t);this.J1["delete"](t),this.o8(0,r,!0),this.tU.failed(),this.aH.p8(this.reportingGuid,n,i)}else c.ErrorMonitor.getInstance().logError("Error failed a non-existing request",this.loggerId,f.Ts.As,{otherGuid:this.guid,Z6:this.reportingGuid})}catch(t){c.ErrorMonitor.getInstance().logError("Error handling request failed ",this.loggerId,f.Ts.Ss,{detailedError:t,otherGuid:this.guid})}},s.prototype.g8=function(t,i){this.aH.b8(t,i,!0)},s.prototype.y8=function(t,i){this.aH.T8(t,i,!0)},s.prototype.O8=function(t,i,n){this.aH.m8(t,i,n,!0)},s.prototype.dP=function(){var t=this.f8.reduce(function(t,i){return t+i},0);return 0<this.f8.length?t/this.f8.length:0},s.prototype._8=function(t){this.R8=t},s.prototype.S8=function(){return this.R8},s.prototype._Q=function(){return this.hP._Q()},s.prototype.A8=function(){return this.handshakeDelay},s.prototype.I8=function(t){var i=Math.max(0,this.vY-t);0<i&&i<a.xu._u.Wh&&(this.handshakeDelay=i)},s);function s(t,i,n,r,s,e,h){this.loggerId="[Partner] ",this.a8=0,this.u8=0,this.R8=0,this.f8=new Array(),this.N8=new Array(),this.J1=new o(),this.handshakeDelay=-1,this.logger=r,this.AQ=n,this.guid=t,this.hP=e,this.C8=s,this.aH=i,this.tU=u.Framework.resolve(u.Framework.v.hk),this.nU=u.Framework.resolve(u.Framework.v.hk),this.vY=u.Framework.time(),h&&this.I8(h)}i.Partner=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e=n(36),r=n(3),h=n(0),u=n(9),v=n(17),o=n(5),d=n(1),s=n(207),E=n(2),a=(f.prototype.init=function(t){this.logger=h.Framework.resolve(h.Framework.v.p).log(t.sessionId),this.tv=t.tv,this.gw=t.gw,this.uploadScore=t.uploadScore,this.eM=t.eM,this.TQ=t.KH},f.prototype.uQ=function(t){return this.CQ(t.peerInfo.guid)},f.prototype.CQ=function(t){return this.qU.has(t)||this.VU.has(t)},f.prototype.rY=function(t){return this.VU.has(t)?this.VU.get(t):this.qU.get(t)},f.prototype.sQ=function(t){return this.qQ(t.peerInfo.guid)},f.prototype.qQ=function(t){return this.QU.has(t)||this.fQ.has(t)},f.prototype.QQ=function(t){return this.QU.has(t)?this.QU.get(t):this.fQ.get(t)},f.prototype.FQ=function(u){var a=this;try{var t=this.tv.k8();if(this.D8&&!t)if(this.CQ(u)){var f=this.rY(u),c=this.uploadScore.j8(!1),l=[];this.gw.B1().then(function(t){a.logger.debug(a.eH+"SEND ALL HAVES TO "+u+","+t.length);for(var i=0;i<t.length;i++){var n=0;n=a.context.UH()?t[i].size():t[i].totalSize;var r=t[i].A_,s=new v.Al.ml.Have();s.setFragmentId(r.I_()),s.setSize(n),s.setUploadScore(c);var e=r;s.setId(e.uA());var h=new v.Al.ml.QualityLevel();h.id=e.getQualityLevel().id,h.bitrate=e.getQualityLevel().bitrate,s.setQualityLevel(h),s.setDuration(e.getDuration()),s.setType(e.S_()),l.push(s)}if(0<l.length){var o=new v.Al.ml.Haves();o.setHave(l),f.AQ.rl(v.Fc.Haves,o)}})}else d.ErrorMonitor.getInstance().logError("Error sending all haves to peer who is not out partner",this.eH,E.ci.gi,{otherGuid:u})}catch(t){d.ErrorMonitor.getInstance().logError("Error sending all haves",this.eH,E.ci.li,{detailedError:t,otherGuid:u})}},f.prototype.z0=function(i,n,r){var s=this,t=this.tv.k8();if(this.D8&&!t){var e=this.VU.values();this.qU.forEach(function(t,i){e.push(t)});var h=this.uploadScore.j8(!1);e.forEach(function(t){(!r||r&&t.guid!=r.guid)&&s.M8(t.AQ,i,n,h)})}},f.prototype.M8=function(i,t,n,r){this.P8&&this.logger.debug(this.eH+"SEND HAVE TO "+i.otherGuid+" FOR "+t.I_());try{var s=new v.Al.ml.Have();s.setFragmentId(t.I_()),s.setSize(n),s.setUploadScore(r);var e=t;s.setId(e.uA());var h=new v.Al.ml.QualityLevel();h.id=e.getQualityLevel().id,h.bitrate=e.getQualityLevel().bitrate,s.setQualityLevel(h),s.setDuration(e.getDuration()),s.setType(e.S_()),i.rl(v.Fc.Have,s)}catch(t){d.ErrorMonitor.getInstance().logError("Error sending have ",this.eH,E.ci.vi,{detailedError:t,otherGuid:i.otherGuid})}},f.prototype.V6=function(i,t){try{if(this.qQ(i)){this.L8&&this.logger.debug(this.eH+"HAVE RECEIVED FROM "+i+": "+t.fragmentId);var n=this.QQ(i);n._8(t.getUploadScore()),this.eM.put(t,n),this.context.kH(t)}else d.ErrorMonitor.getInstance().logError("Error receiving have from unknown peer",this.eH,E.ci.di,{otherGuid:i})}catch(t){d.ErrorMonitor.getInstance().logError("Error handling received have",this.eH,E.ci.wi,{detailedError:t,otherGuid:i})}},f.prototype.Y6=function(i,t){var n=this;try{if(this.qQ(i)){this.L8&&this.logger.debug(this.eH+"BATCH HAVES RECEIVED FROM "+i);var r=this.QQ(i);t.getHave().forEach(function(t){r._8(t.getUploadScore()),n.eM.put(t,r)}),this.context.kH(t.getHave()[0])}else d.ErrorMonitor.getInstance().logError("Error receiving haves from unknown peer",this.eH,E.ci.Ei,{otherGuid:i})}catch(t){d.ErrorMonitor.getInstance().logError("Error handling received haves",this.eH,E.ci.pi,{detailedError:t,otherGuid:i})}},f.prototype.mQ=function(i){try{var t=new v.Al.ml.Ping();t.id=this.tv.getId(),t.startTs=h.Framework.time(),this.logger.debug(this.eH+"REQUEST PING TO PEER GUID "+i.otherGuid),i.rl(v.Fc.Ping,t)}catch(t){d.ErrorMonitor.getInstance().logError("Error requesting ping",this.eH,E.ci.yi,{detailedError:t,otherGuid:i.otherGuid})}},f.prototype.K6=function(i){try{var t=i.id;if(!this.CQ(t))return void d.ErrorMonitor.getInstance().logError("Error receiving ping from an unknown peer",this.eH,E.ci.Oi,{otherGuid:t});var n=-1;i.startTs&&(n=i.startTs),this.H8(this.rY(t).AQ,n)}catch(t){d.ErrorMonitor.getInstance().logError("Error handling received ping",this.eH,E.ci.Ti,{detailedError:t,otherGuid:i.id})}},f.prototype.U8=function(){try{for(var t="",i=0;i<o.xu.ju.qo;i++)t+=String.fromCharCode(33+93*Math.random());var n=new ArrayBuffer(t.length),r=new Uint8Array(n),s=t.length;for(i=0;i<s;i++)r[i]=t.charCodeAt(i);this.F8=e.wrap(r)}catch(t){d.ErrorMonitor.getInstance().logError("Error creating random buffer for ping pong",this.logger,E.ci.bi,t)}},f.prototype.H8=function(i,t){try{var n=new v.Al.ml.Pong();n.id=this.tv.getId(),n.startTs=t,this.F8||this.U8(),n.data=this.F8,n.dataSize=o.xu.ju.qo,this.logger.debug(this.eH+"SEND PONG TO PEER GUID "+i.otherGuid),i.rl(v.Fc.Pong,n)}catch(t){d.ErrorMonitor.getInstance().logError("Error sending pong",this.eH,E.ci.mi,{detailedError:t,otherGuid:i.otherGuid})}},f.prototype.W6=function(i){try{var t=i.id;if(!this.qQ(t))return void d.ErrorMonitor.getInstance().logError("Error receiving a pong from an unknown peer",this.eH,E.ci._i,{otherGuid:t});var n=h.Framework.time();if(i.startTs&&0<i.startTs){var r=n-i.startTs,s=this.QQ(t);i.dataSize==i.data.toArrayBuffer().byteLength?s.o8(i.dataSize,r,!0):d.ErrorMonitor.getInstance().logError("Error receing pong with wrong data size",this.eH,E.ci.Ri,{otherGuid:t})}else d.ErrorMonitor.getInstance().logError("Error receiving pong with wrong timestamp",this.eH,E.ci.Si,{otherGuid:t})}catch(t){d.ErrorMonitor.getInstance().logError("Error receiving pong",this.eH,E.ci.Ai,{detailedError:t,otherGuid:i.id})}},f.prototype.KU=function(){try{var t=new r();return this.G8(this.QU,t),this.G8(this.fQ,t),t}catch(t){return d.ErrorMonitor.getInstance().logError("Error getting partner snapshots",this.eH,E.ci.Ii,t),new r()}},f.prototype.G8=function(t,h){var o=this;t.forEach(function(t,i){var n=new hive.snapshots.Partner();n.inPart=!0,n.outPart=o.CQ(i),n.connInfo=new hive.snapshots.ConnectivityInfo();var r=void 0;t.hP.peerInfo.publicIpString&&(r=t.hP.peerInfo.publicIpString);var s=void 0;t.hP.peerInfo.privateIpString&&(s=t.hP.peerInfo.privateIpString),n.connInfo.publicIp=r,n.connInfo.privateIp=s,n.connInfo.externalAs=t.hP.peerInfo.externalAs,n.connInfo.internalAs=t.hP.peerInfo.internalAs;var e=o.x8();e.rateReceived=t.dP(),n.metrics=e,-1!=t.A8()&&(n.metrics.handshakeDelay=t.A8()),n.udp=t.hP.peerInfo.type==u.pf.bf,h.set(t.reportingGuid,n)})},f.prototype.BU=function(){return new s.B8(this.QU.length,this.fQ.length,this.qU.length,this.VU.length)},f.prototype.x8=function(){var t=new hive.snapshots.PartnerMetrics();return t.rateReceived=0,t.rateSent=0,t.handshakeDelay=0,t},f);function f(){this.eH="[PARTNERSHIP] ",this.fQ=new r(),this.QU=new r(),this.VU=new r(),this.qU=new r(),this.P8=!1,this.L8=!1,this.D8=!0,this.active=!1,this.U8(),this.dQ=[]}i.Qq=a},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(t,i,n,r){this.QU=t,this.YU=i,this.qU=n,this.VU=r}i.B8=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=n(34),e=n(36),h=n(17),o=n(0),u=n(209),a=n(5),f=n(1),c=n(2),l=(v.prototype.setReportingGuid=function(t){this.Z6=t},v.prototype.V8=function(t,i,n,r,s){var e=this;this.Uc&&this.logger.info("SEND FRAGMENT "+t+" TO "+this.otherGuid);try{var h=new u.q8();h.transferId=i,h.fragmentId=t,h.Q8=s,h.headers=r,h.Y8=n,h.K8=Math.ceil(h.Y8/a.xu.ju.qo),h.W8=0,this.X8.push(h),this.Uc&&this.X8.forEach(function(t){e.logger.debug(e.otherGuid+" PENDING OUT "+t)})}catch(t){f.ErrorMonitor.getInstance().logError("Error constructing chunk response",this.loggerId,c.Yr.Kr,{detailedError:t,otherGuid:this.otherGuid})}null===this.response?this.z8():this.Uc&&this.logger.debug(this.otherGuid+" OUT MSG NOT NULL")},v.prototype.x6=function(t){this.Uc&&this.logger.debug("ONGOING "+t+" GOT ACK"),null!==this.response&&this.response.transferId.toString()===t.toString()?this.J8(!1):f.ErrorMonitor.getInstance().logError("Error receiving ack for unknown transfer",this.loggerId,c.Yr.Xr)},v.prototype.dl=function(){null!=this.response&&this.J8(!1)},v.prototype.B6=function(i){null!=this.response&&this.response.transferId===i?(this.logger.debug("GOT CANCEL FOR ONGOING TR-"+i),this.logger.debug("TRANSPORT CANCEL STATS "+this.$c+","+this.otherGuid+","+i),this.Z8["delete"](i),0!=this.response.W8?this.e0.t9(this.otherGuid,this.Z6,this.response.W8,this.response.Y8):this.e0.i9(this.otherGuid,this.Z6,this.response.Y8),this.response=null,this.z8()):this.X8=this.X8.filter(function(t){return t.transferId!==i})},v.prototype.z8=function(){try{if(null===this.response&&0!==this.X8.length){var t=this.X8.shift();this.response=t,this.Uc&&this.logger.debug("DATA TO SEND LENGTH "+this.response.Y8+" IN "+this.response.K8+" CHUNKS WITH TR-"+this.response.transferId),this.J8(!0)}}catch(t){f.ErrorMonitor.getInstance().logError("Error start sending chunks",this.loggerId,c.Yr.Wr,t),this.nl()}},v.prototype.J8=function(t){t&&(this.Z8.set(this.response.transferId,o.Framework.time()),this.n9=this.response.K8);try{if(null!=this.response)if(0===this.response.K8)this.logger.debug("FINISHED SENDING TRANSFER "+this.response.transferId+" WITH "+this.response.W8+" BYTES"),this.Z8["delete"](this.response.transferId),this.e0.r9(this.otherGuid,this.Z6,this.response.Y8),this.response=null,this.s9(),this.z8();else{this.Uc&&this.logger.debug("A CHUNK");var i=Math.min(this.response.W8+a.xu.ju.qo,this.response.Y8),n=i-this.response.W8,r=new h.Al.ml.Chunk();if(r.transferId=this.response.transferId,r.totalSize=this.response.Y8,r.chunkSize=n,t&&null!=this.response.headers&&(r.headers=this.response.headers),o.Framework.T()||null==this.response.Q8)r.data=e.wrap(new ArrayBuffer(0));else if(r.data=this.aM.e9(this.response.fragmentId,this.n9-this.response.K8),null==r.data){var s=this.response.Q8.slice(this.response.W8,i);r.data=e.wrap(s)}this.response.W8=this.response.W8+n,this.AQ.rl(h.Fc.Chunk,r),this.Uc&&this.logger.debug("SND ["+this.response.W8+"-"+(this.response.W8+n)+"/"+this.response.Y8+"] TO "+this.otherGuid+" OF TR-"+this.response.transferId),this.response.K8--}else this.logger.debug("NO MESSAGE TO SEND")}catch(t){f.ErrorMonitor.getInstance().logError("Error sending chunk",this.loggerId,c.Yr.$r,{detailedError:t,otherGuid:this.otherGuid}),this.nl()}},v.prototype.tl=function(){return!(0===this.X8.length&&null===this.response)},v.prototype.F6=function(){var t=r.defer();return this.X8.length=0,this.tl()?this.close=t:t.resolve("CLOSE"),t.promise},v.prototype.s9=function(){this.close&&this.close.resolve("CLOSED")},v.prototype.nl=function(){this.response=null},v);function v(t,i,n,r){this.loggerId="[FragmentSender] ",this.Uc=h.Uc,this.response=null,this.X8=new Array(),this.Z8=new s(),this.n9=0,this.close=null,this.$c=t,this.otherGuid=i,this.e0=n.e0,this.AQ=r,this.aM=n.aM,this.logger=o.Framework.resolve(o.Framework.v.p).log(n.sessionId),this.Jc=o.Framework.resolve(o.Framework.v.Zc)}i.J6=l},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){this.headers=null}i.q8=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){}i.yl=r},function(t){t.exports=JSON.parse('{"package":"HiveMsgs","messages":[{"name":"Chunk","fields":[{"rule":"required","type":"int32","name":"transferId","id":1},{"rule":"required","type":"int32","name":"totalSize","id":2},{"rule":"required","type":"int32","name":"chunkSize","id":3},{"rule":"required","type":"bytes","name":"data","id":4},{"rule":"optional","type":"string","name":"headers","id":5}]},{"name":"Haves","fields":[{"rule":"repeated","type":"Have","name":"have","id":1}]},{"name":"Have","fields":[{"rule":"required","type":"string","name":"fragmentId","id":1},{"rule":"required","type":"int32","name":"size","id":2},{"rule":"required","type":"int32","name":"type","id":3},{"rule":"required","type":"int32","name":"id","id":4},{"rule":"required","type":"QualityLevel","name":"qualityLevel","id":5},{"rule":"required","type":"int32","name":"duration","id":6},{"rule":"required","type":"float","name":"uploadScore","id":7}]},{"name":"Ping","fields":[{"rule":"required","type":"string","name":"id","id":1},{"rule":"required","type":"uint64","name":"startTs","id":2}]},{"name":"Pong","fields":[{"rule":"required","type":"string","name":"id","id":1},{"rule":"required","type":"bytes","name":"data","id":2},{"rule":"required","type":"int32","name":"dataSize","id":3},{"rule":"required","type":"uint64","name":"startTs","id":4}]},{"name":"Request","fields":[{"rule":"required","type":"string","name":"fragmentId","id":1},{"rule":"required","type":"int32","name":"transferId","id":2}]},{"name":"DoNotHave","fields":[{"rule":"required","type":"int32","name":"transferId","id":1}]},{"name":"NoPartners","fields":[{"rule":"required","type":"int32","name":"transferId","id":1}]},{"name":"Cancel","fields":[{"rule":"required","type":"int32","name":"transferId","id":1}]},{"name":"Ack","fields":[{"rule":"optional","type":"int32","name":"transferId","id":1}]},{"name":"Close","fields":[{"rule":"required","type":"int32","name":"type","id":1}]},{"name":"StreamCharacteristics","fields":[{"rule":"required","type":"int32","name":"streamState","id":1},{"rule":"required","type":"QualityLevel","name":"qualityLevel","id":2},{"rule":"required","type":"int32","name":"delta","id":3}]},{"name":"OutPartnershipRequest","fields":[{"rule":"required","type":"string","name":"guid","id":1},{"rule":"required","type":"string","name":"contextId","id":2},{"rule":"required","type":"string","name":"p2pProtocolVersion","id":3},{"rule":"optional","type":"int32","name":"internalAs","id":4},{"rule":"optional","type":"int32","name":"externalAs","id":5},{"rule":"optional","type":"string","name":"publicIpString","id":6},{"rule":"optional","type":"string","name":"privateIpString","id":7},{"rule":"required","type":"string","name":"reportingGuid","id":8},{"rule":"repeated","type":"StreamCharacteristics","name":"streamCharacteristics","id":9}]},{"name":"OutPartnershipResponse","fields":[{"rule":"required","type":"int32","name":"accept","id":1},{"rule":"optional","type":"int32","name":"internalAs","id":2},{"rule":"optional","type":"int32","name":"externalAs","id":3},{"rule":"optional","type":"string","name":"publicIpString","id":4},{"rule":"optional","type":"string","name":"privateIpString","id":5},{"rule":"optional","type":"string","name":"reportingGuid","id":6},{"rule":"repeated","type":"StreamCharacteristics","name":"streamCharacteristics","id":7}]},{"name":"PeerInfoMessage","fields":[{"rule":"required","type":"string","name":"guid","id":1},{"rule":"optional","type":"string","name":"publicIpString","id":2},{"rule":"optional","type":"string","name":"privateIpString","id":3},{"rule":"optional","type":"int32","name":"internalAs","id":4},{"rule":"optional","type":"int32","name":"externalAs","id":5},{"rule":"repeated","type":"StreamCharacteristics","name":"streamCharacteristics","id":6}]},{"name":"UDPHandshakeMessage","fields":[{"rule":"required","type":"string","name":"uuid","id":1},{"rule":"required","type":"string","name":"streamId","id":2},{"rule":"required","type":"float","name":"udpScore","id":3},{"rule":"required","type":"bool","name":"isLeader","id":4}]},{"name":"UDPHandshakeResponse","fields":[{"rule":"required","type":"string","name":"accept","id":1}]},{"name":"UDPSwitchLeadershipRequest","fields":[{"rule":"required","type":"string","name":"uuid","id":1},{"rule":"required","type":"float","name":"udpScore","id":2}]},{"name":"UDPSwitchLeadershipAck","fields":[{"rule":"required","type":"bool","name":"ok","id":1}]},{"name":"QualityLevelMessage","fields":[{"rule":"required","type":"string","name":"guid","id":1},{"rule":"required","type":"QualityLevel","name":"qualityLevel","id":2}]},{"name":"QualityLevel","fields":[{"rule":"required","type":"string","name":"id","id":1},{"rule":"required","type":"int32","name":"bitrate","id":2}]}]}')},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(5),s=(e.Ob=function(t,i){var n=0;return 0!=(n=t.udpScore>i.udpScore?1:t.udpScore<i.udpScore?-1:0)?-n:r.xu.UDPBroadcast.Zo?i.uuid.localeCompare(t.uuid):t.uuid.localeCompare(i.uuid)},e);function e(t,i,n,r,s){this.udpScore=0,this.YV=!1,this.streamId="",this.uuid=t,this.udpScore=i,n&&(this.address=n),r&&(this.YV=r),s&&(this.streamId=s)}i.qV=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(6),h=n(0),e=n(7),o=n(9),u=n(1),a=n(2),f=(c.prototype.init=function(t){this.logger=h.Framework.resolve(h.Framework.v.p).log(t.sessionId),this.eM=t.eM,this.partnership=t.partnership,this.hM=t.hM,this.tv=t.tv,this.aH=t.KH,this.o9.h9(t.tv)},c.prototype.request=function(t){this.logger.debug("FRL ISSUE REQ FOR FRAGMENT "+t.A_.toString()+"-"+t.L_.E_+" ["+e.xa[t.S_()]+"] TO P2P"),this.J1.set(t.N_(),t);var i=this.Sl.next();t.OP=i,this.u9.set(i,t.N_()),this.u2(t)},c.prototype.u2=function(t){var i=t.I_(),n=t.N_(),r=this.a9(i);t.size=this.eM.nP(i).size;var s=this.o9.f9(r,t.type);null!=s?(this.logger.info("SELECT "+s.AQ.otherGuid+" (LAN LEADER "+s.hP.peerInfo.isLeader+" iAS "+s.hP.peerInfo.internalAs+" eAS "+s.hP.peerInfo.externalAs+" privateIp "+s.hP.peerInfo.privateIpString+" ) out of "+r.length+" type "+o.pf[s.hP.peerInfo.type]+" size:"+t.size+" FOR TRANSFER"+t.OP+" REQUEST ID "+n),t.partner=s,t.J0=s.hP.peerInfo,t.partner.c8(t.OP),t.L_.v_=!0,t.L_.T_=h.Framework.time(),this.yP(t)?(this.aH.c9(t),s.AQ.receiver.n8(t)):this.l9(t)):(u.ErrorMonitor.getInstance().logError("Error sending p2p request because we cannot find a partner",this.loggerId,a.zr.Jr),this.TP(t.OP,"NO PARTNERS FOUND FOR REQUEST"))},c.prototype.a9=function(t){var i=this,n=[];try{this.eM.rP(t).forEach(function(t){i.partnership.qQ(t.guid)?n.push(t):i.logger.warn("I HAVE A HAVE FROM A NON IN-PARTNER "+t.guid)})}catch(t){u.ErrorMonitor.getInstance().logError("Error filtering in partners",this.loggerId,a.zr.Zr,t)}return n},c.prototype.l9=function(t){var i=t.OP;if(this.logger.info("REQUEST "+t.OP+" TO "+t.partner.guid+" ABORTED BECAUSE OF SLOW P2P CONNECTION"),this.u9.has(i)){var n=this.u9.get(i);this.u9["delete"](i);var r=this.J1.get(n);this.J1["delete"](n),this.hM.Q0(r)}},c.prototype.yP=function(t){var i=this,n=!1;try{var r=0;null==t.size?(r=this.eM.nP(t.I_()).size,t.size=r,this.logger.warn("request size not set - this should not happen")):r=t.size;var s=r-t.W_,e=t.z_.GH().hV(t,s);return 0<(t.r8=e)&&(n=!0,null==t.hq&&(t.hq=h.Framework.setTimeout(function(){i.v9(t)},e))),n}catch(t){return u.ErrorMonitor.getInstance().logError("Error setting request timeout",this.loggerId,a.zr.ns,t),!1}},c.prototype.v9=function(t){this.aH.d9(t),this.TP(t.OP,"TIMED-OUT")},c.prototype.TP=function(t,i){this.logger.info(i+" "+t);var n=this.E9(t,!0);this.logger.warn("REQUEST "+t+" FOR "+n.N_()+" FAILED BECAUSE "+i),n&&this.hM.M0(n)},c.prototype.E9=function(t,i){try{if(this.u9.has(t)){var n=this.u9.get(t);this.u9["delete"](t);var r=this.J1.get(n);if(this.J1["delete"](n),h.Framework.clearTimeout(r.hq),i&&this.partnership.qQ(r.partner.AQ.otherGuid)){r.partner.AQ.receiver.h8(t);var s=r.S_()==e.xa.Va;0!=r.W_?r.partner.d8(r.OP,r.W_,r.L_.p2pAgenTrafficSuccessQt,r.size,s,r.type):r.partner.TP(r.OP,s,r.size)}return r}return u.ErrorMonitor.getInstance().logError("Error cancelling request on non existing session",this.loggerId,a.zr.ss),null}catch(t){return u.ErrorMonitor.getInstance().logError("Error removing request",this.loggerId,a.zr.rs,t),null}},c.prototype.j0=function(t){if(this.J1.has(t)){var i=this.J1.get(t).OP;this.E9(i,!0)}},c.prototype.I2=function(t,i,n,r){this.logger.debug("FRL DOWNLOADING "+i.N_()+" FROM "+t+" P2P")},c.prototype.SM=function(t,i){if(this.logger.debug("FRL PROMISED FRAGMENT "+i.N_()+" RETURNED FROM P2P SIZE "+i.L_.E_),i=this.E9(t,!1)){i.L_.m_=h.Framework.time();var n=i.S_()==e.xa.Va;i.partner.l8(i.OP,i.size,i.L_.p2pAgenTrafficSuccessQt,!0,n,i.type),this.hM.L0(i)}else this.logger.warn("TRIED TO REMOVE A NON EXISTING REQUEST "+t+" (THIS SHOULD NOT HAPPEN. AT LEAST NOT TOO OFTEN)")},c.prototype.q6=function(t){var i=t.getTransferId();if(this.u9.has(i)){u.ErrorMonitor.getInstance().logError("Error receiving a do not have for my request",this.loggerId,a.zr.es),this.logger.debug("DO NOT HAVE RECEIVED FOR "+i);var n=this.E9(i,!1);if(n){var r=n.S_()==e.xa.Va;n.partner.TP(n.OP,r,n.size),this.hM.M0(n)}}else this.logger.warn("UNKNOWN DO NOT HAVE "+i)},c.prototype.X6=function(t,i){var n=i.transferId;if(this.u9.has(n)){u.ErrorMonitor.getInstance().logError("Error rejected request by a non partner",this.loggerId,a.zr.hs),this.partnership.RQ(t);var r=this.E9(n,!1);r&&this.hM.M0(r)}},c.prototype.Ze=function(t){return this.J1.has(t)},c);function c(){this.loggerId="[P2PRequester] ",this.Sl=new s.Counter(),this.J1=new r(),this.u9=new r(),this.o9=h.Framework.resolve(h.Framework.v.ik)}i._Z=f},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=n(17),e=n(1),h=n(2),o=(u.prototype.init=function(t){this.logger=r.Framework.resolve(r.Framework.v.p).log(t.sessionId),this.GV=t,this.eM=t.eM,this.gw=t.gw,this.partnership=t.partnership,this.uploadScore=t.uploadScore,this.tv=t.tv,this.aH=t.KH},u.prototype.hH=function(t,i,n){try{if(this.partnership.CQ(t)){var r=this.partnership.rY(t);this.w9(t,i,r)}else this.p9(t,i,n)}catch(t){e.ErrorMonitor.getInstance().logError("Error on responding to p2p request",this.loggerId,h.us.fs,t)}},u.prototype.r9=function(t,i,n){try{if(this.uploadScore.success(n),this.partnership.CQ(t)){var r=this.partnership.rY(t);r.nU.success(n),r.g8(n,i)}}catch(t){e.ErrorMonitor.getInstance().logError("Error on request satisfied",this.loggerId,h.us.cs,t)}},u.prototype.t9=function(t,i,n,r){try{if(this.uploadScore.E8(n,r),this.partnership.CQ(t)){var s=this.partnership.rY(t);s.nU.E8(n,r),s.O8(n,r,i)}}catch(t){e.ErrorMonitor.getInstance().logError("Error on request partially satisfied",this.loggerId,h.us.ls,t)}},u.prototype.i9=function(t,i,n){try{if(this.uploadScore.failed(),this.partnership.CQ(t)){var r=this.partnership.rY(t);r.nU.failed(),r.y8(n,i)}}catch(t){e.ErrorMonitor.getInstance().logError("Error on request not satisfied",this.loggerId,h.us.vs,t)}},u.prototype.w9=function(i,n,r){var s=this;this.gw.get(n.fragmentId).then(function(t){t?(s.logger.debug("SENDING TO "+i+","+n.fragmentId+","+n.transferId+","+t.length+" DL "+t.length),r.AQ.sender.V8(n.fragmentId,n.transferId,t.length,t.headers,t.data)):(s.logger.debug("RECEIVED REQUEST FOR "+n.fragmentId+" FROM "+i+" CAN'T BE SERVED"),s.g9(n.transferId,r))})},u.prototype.g9=function(t,i){try{this.logger.info("SEND DO NOT HAVE "+t+" TO "+i.AQ.$c);var n=new s.Al.ml.DoNotHave();n.setTransferId(t),i.AQ.rl(s.Fc.DoNotHave,n)}catch(t){e.ErrorMonitor.getInstance().logError("Error on sending do not have",this.loggerId,h.us.ds,t)}},u.prototype.p9=function(t,i,n){try{this.logger.warn("GOT REQUEST FROM NON-PARTNER "+t+" FOR "+i.fragmentId);var r=new s.Al.ml.NoPartners();r.setTransferId(i.transferId),n.rl(s.Fc.Qc,r)}catch(t){e.ErrorMonitor.getInstance().logError("Error on send no partners",this.loggerId,h.us.Es,t)}},u);function u(){this.loggerId="[P2PResponder] "}i.RZ=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e,r,h=n(34),o=n(0),s=n(5);(r=e=i.b9||(i.b9={}))[r.S=0]="S",r[r.y9=1]="F",r[r.T9=2]="PF";var u=function(t){this.ts=t},a=function(){this.O9=0,this.m9=0,this._9=0,this.R9=0,this.S9=0,this.A9=0};i.I9=a;var f=(c.prototype.success=function(t){this.event(e.S,t,t)},c.prototype.failed=function(){this.event(e.y9,0,0)},c.prototype.E8=function(t,i){this.event(e.T9,t,i)},c.prototype.event=function(t,i,n){var r=new u(o.Framework.time());r.t=t,r.N9=i,r.C9=i/n,r.k9=(n-i)/n,this.D9.set(r.ts,r),this.j9()},c.prototype.j9=function(){var i=this,n=o.Framework.time()-2*s.xu.ku.Uo;if(0<n){var r=[];this.D9.forEach(function(t,i){i<n&&r.push(i)}),r.forEach(function(t){i.D9["delete"](t)})}},c.prototype.ZH=function(t){var i=0,n=this.M9(t,s.xu.ku.Uo);return null!=n&&(i=0==n.m9+n._9+n.R9?0:(n.m9-s.xu.ku.Fo*(n.R9+n._9))/(n.m9+s.xu.ku.Fo*(n.R9+n._9))),i},c.prototype.j8=function(t){var i=0,n=this.M9(t,s.xu.ku.Uo);if(null!=n){var r=n.m9+n._9+n.R9;i=0==r?0:(n._9+n.R9*s.xu.ku.xo)/r}return i},c.prototype.P9=function(t){var i=this.M9(!1,t);return null!=i?i.O9:0},c.prototype.M9=function(t,i){if(0==this.D9.keys().length)return null;var n=new a(),r=o.Framework.time()-i;r<0&&(r=0);var s=new h();return this.D9.forEach(function(t,i){r<=i&&s.set(i,t)}),s.forEach(function(t,i){switch(n.O9+=t.N9,t.t){case e.S:n.m9++;break;case e.y9:n._9++;break;default:n.R9++,n.S9+=t.C9,n.A9+=t.k9}}),n},c.xo=.2,c.Go=.2,c);function c(){this.D9=new h()}i.SZ=f},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(3),o=n(4),u=n(0),a=n(217),f=n(219),c=n(111),l=n(2),v=n(1),d=n(14),E=(e=f.L9,s(w,e),w.prototype.start=function(t,i){void 0===i&&(i=[]);var n=u.Framework.resolve(u.Framework.v.p).log(t),r=null;return 0==this.listeners.keys().length?(n.debug("TRIGGERING CONNECT "),r=this.H9(),this.U9(t,i)):(n.debug("ALREADY CONNECTED "),r=this.Ml.sv(),this.U9(t,i),this.F9.isConnected()&&this.G9(this.uS,t)),r},w.prototype.H9=function(){var n=this,r=d.Rc.hc;return"localhost"===r&&(r="127.0.0.1:"+location.port),this.logger.debug("CONNECTING.."),this.Ml.sv().then(function(t){var i=t.uv();return n.logger.debug("MY IDENTITY ",i),n.uS=i,n.F9.start(r,i),t})},w.prototype.cv=function(){return o.resolve(new h())},w.prototype.connect=function(i){var n=this,r=o.defer();return this.x9.has(i)?(this.logger.debug("Already connected to "+i+", ignoring"),r.resolve(this.x9.get(i))):this.channelManager.B9(this.uS,i).then(function(t){return n.connected(i,t)}).then(function(t){return r.resolve(t)}).fail(function(t){v.ErrorMonitor.getInstance().logError("Error establishing connection",n.loggerId,l.lt.wt,{otherGuid:i}),r.reject("CONN TO "+i+" CANNOT BE ESTABLISHED ")}),r.promise},w.prototype.send=function(t,i,n){var r=this.channelManager.send(t,i);return r||(v.ErrorMonitor.getInstance().logError("Error sending message without channel established",this.loggerId,l.lt.pt,{otherGuid:t}),this.V9(t)),r},w.prototype.q9=function(t,i,n){this.Q9&&this.logger.debug("REC BUF "+n.byteLength+" "+n),this.x9.has(t)?(this.Q9&&this.logger.debug("PROC MSG FROM "+t),this.x9.get(t).El(n)):v.ErrorMonitor.getInstance().logError("Error receiving msg without having a connection established",this.loggerId,l.lt.pt,{otherGuid:t})},w.prototype.connected=function(t,i){if(this.x9.has(t))this.logger.debug("RECONNECTED TO "+t+", RESETTING STATE"),this.x9.get(t).reset();else{this.logger.info("CONNECTED TO "+t);var n=i.$V;n.init(this.uS,t),this.x9.set(t,n)}return o.resolve(this.x9.get(t))},w.prototype.Y9=function(t,i){this.logger.debug("FAILED CONN TO "+i),t.reject("CONN TO "+i+" CANNOT BE ESTABLISHED ")},w.prototype.K9=function(t,i){this.logger.info(t+" connected to me"),this.connected(t,i)},w.prototype.V9=function(t){this.x9.has(t)?(this.logger.info("Connection closed to "+t),this.x9["delete"](t),this.W9(t)):this.logger.warn("TRYING TO REMOVE A PEER THAT IS NOT THERE: "+t)},w.prototype.X9=function(){var s=this;c.cY.oY&&u.Framework.setInterval(function(){var r=u.Framework.time();s.x9.forEach(function(t,i){var n=r-t.Ol();n>c.cY.aY&&(s.logger.debug("closing stale connection to "+i+" [unused for: "+n+"ms]"),s.disconnect(i))})},c.cY.uY)},w.prototype.stop=function(t){u.Framework.resolve(u.Framework.v.p).log(t).debug("STOPPING CONNECTIONS AND REMOVING LISTENERS"),this.bx(t)},w.prototype.z9=function(){},w.prototype.disconnect=function(t){this.x9.has(t)&&this.channelManager.disconnect(t)},w.fu="availableSendRate",w.cu="remoteAddress",w.lu="localAddress",w);function w(){var t=e.call(this)||this;return t.loggerId="[HiveNetworkManager] ",t.Q9=!1,t.x9=new h(),t.Sl=1,t.Ml=u.Framework.resolve(u.Framework.v.Pl),t.F9=u.Framework.resolve(u.Framework.v.uk),t.channelManager=new a.J9(t.logger,t.F9,t),t.F9.init(t,t.logger,t.channelManager),t.X9(),t}i.wZ=E},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e=n(4),r=n(0),s=n(218),h=n(111),o=n(2),u=n(1),a=(f.prototype.B9=function(t,i){var n=null;if(i in this.Z9){var r=e.defer();r.reject("OTHER ALREADY TRYING TO CONNECT"),n=r.promise}else{this.t7.Q9&&this.logger.info("Initiating connection to "+i);var s=this.i7(t,i);n=this.n7(s,i).connect(i)}return n},f.prototype.r7=function(t){t.s7 in this.Z9&&(delete this.channels[t.label],delete this.Z9[t.s7]),t.open&&(this.t7.V9(t.s7),t.open=!1)},f.prototype.send=function(t,i){this.t7.Q9&&this.logger.debug("DATA "+i.byteLength+" "+i);var n=this.Z9[t];return n&&n.channel?(n.send(i),!0):(u.ErrorMonitor.getInstance().logError("Error sending message wihtout channel established",this.loggerId,o.Pt.Lt,{otherGuid:t}),!1)},f.prototype.trigger=function(t,i){var n=i.channel;if(n&&n.label&&this.channels[n.label]){var r=this.channels[n.label];(s=r[t]).call(r,i)}else{var s,e="handle_"+t;(s=this[e])?s.call(this,i):u.ErrorMonitor.getInstance().logError("Error received a message for a non existing function",this.loggerId,o.Pt.Ht,{e7:e})}},f.prototype.handle_offer=function(t){if(this.t7.Q9&&this.logger.info("received an offer from "+t.peer.guid+" on channel "+t.channel.label),this.Z9[t.peer.guid]&&t.peer<this.t7.uS)this.F9.h7(this.t7.uS,t.peer.guid,t.channel.label);else{var i=this.n7(t.channel.label,t.peer.guid),n=this.o7(i);i.offer(t,n)}},f.prototype.o7=function(t){var i=this;return r.Framework.setTimeout(function(){u.ErrorMonitor.getInstance().logError("Error incoming connection timedout",i.loggerId,o.Pt.Ut,{otherGuid:t.s7}),t.close()},h.cY.fY)},f.prototype.n7=function(t,i){var n=new s.u7(this,this.t7,t,this.a7,this.f7,i);return this.channels[t]=n,this.Z9[i]=n},f.prototype.handle_offer_rejected=function(t){this.t7.Q9&&this.logger.debug("remote peer rejected ",t);var i=this.Z9[t.c7];i&&i.close(),delete this.Z9[t.c7],delete this.channels[t.channel]},f.prototype.i7=function(t,i){return t.substring(0,Math.max(8,t.length))+":"+i.substring(0,Math.max(8,i.length))+":"+this.Sl++},f.prototype.disconnect=function(t){var i=this.Z9[t];i&&i.close()},f);function f(t,i,n){this.loggerId="[ChannelManager] ",this.f7={iceServers:[{urls:"stun:stun.hivestreaming.com:3478"}]},this.Sl=1,this.a7=null,this.channels={},this.Z9={},this.logger=t,this.F9=i,this.t7=n}i.J9=a},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var s=n(5),o=n(2),e=n(4),u=n(0),a=n(1),r=(h.prototype.l7=function(){var t=this;if(this.channel&&"open"!=this.channel.readyState){if(this.Q9&&this.logger.debug(this.loggerId+"Check connection "+this.s7),this.v7<=0)return this.logger.debug(this.loggerId+"Closing channel since it couldnt be established to "+this.s7),void this.close();this.v7-=1,this.d7=u.Framework.setTimeout(function(){return t.l7()},this.timeout)}},h.prototype.close=function(){try{this.Q9&&this.logger.debug(this.loggerId+"Closing connection to "+this.s7),this.E7(!0),this.channelManager.r7(this),this.cG&&"closed"!==this.cG.signalingState&&(this.cG.close(),this.cG=null,this.channel&&(this.channel.close(),this.channel=null))}catch(t){a.ErrorMonitor.getInstance().logError("Error closing the connection",this.loggerId,o.bt.jt,{detailedError:t,otherGuid:this.s7})}},h.prototype.w7=function(){return!!this.channel&&"connecting"===this.channel.readyState},h.prototype.connect=function(t){var i=this;this.Q9&&this.logger.debug(this.loggerId+"Connecting to "+t),this.s7=t,this.channel=this.cG.createDataChannel(this.label);var n=this.p7(!0,-1);return this.d7=u.Framework.setTimeout(function(){return i.l7()},this.timeout),n},h.prototype.g7=function(t){var i=this,n=e.defer();return this.cG.setRemoteDescription(t).then(function(){n.resolve("OK")})["catch"](function(t){a.ErrorMonitor.getInstance().logError("Error setting remote description",i.loggerId,o.bt.Ot,{detailedError:t,otherGuid:i.s7}),n.reject(t)}),n.promise},h.prototype.b7=function(t){var i=this,n=e.defer();return"closed"!==this.cG.signalingState?this.cG.setLocalDescription(t).then(function(){n.resolve(i.cG.localDescription)})["catch"](function(t){a.ErrorMonitor.getInstance().logError("Error setting local description",i.loggerId,o.bt._t,{detailedError:t,otherGuid:i.s7}),n.reject(t)}):(a.ErrorMonitor.getInstance().logError("Signaling state is closed",this.loggerId,o.bt.Ot),n.reject("Signaling state is closed")),n.promise},h.prototype.createOffer=function(){var i=this,n=e.defer();return this.cG.createOffer().then(function(t){n.resolve(new RTCSessionDescription(t))})["catch"](function(t){a.ErrorMonitor.getInstance().logError("Error creating offer",i.loggerId,o.bt.yt,{detailedError:t,otherGuid:i.s7}),i.close()}),n.promise},h.prototype.createAnswer=function(){var i=this,n=e.defer();return this.cG.createAnswer().then(function(t){n.resolve(new RTCSessionDescription(t))})["catch"](function(t){a.ErrorMonitor.getInstance().logError("Error creating answer",i.loggerId,o.bt.Tt,{detailedError:t,otherGuid:i.s7}),n.reject(t)}),n.promise},h.prototype.offer=function(t,i){var n=this;this.Q9&&(this.logger.debug(this.loggerId+"Received an offer from "+this.s7),this.logger.debug(this.loggerId+"Offer:",t)),this.cG.ondatachannel=function(t){n.channel=t.channel,n.p7(!1,i)};var r=new RTCSessionDescription(t.channel.offer);this.s7=t.peer.guid,this.g7(r).then(function(){return"closed"!==n.cG.signalingState?(n.update_ice_candidates(t),n.createAnswer()):e.reject("Connection closed while creating answer")}).then(function(t){return n.b7(t)}).then(function(t){n.logger.debug(n.loggerId+"Sending back an answer [candidates: "+n.y7.length+"]");var i=n.y7;n.y7=new Array(),n.channelManager.F9.answer(n,t,i,n.s7),n.T7=!0})["catch"](function(t){a.ErrorMonitor.getInstance().logError("Error responding to offer",n.loggerId,o.bt.kt,{detailedError:t,otherGuid:n.s7}),n.close()})},h.prototype.answer=function(t){var i=this;this.Q9&&this.logger.debug(this.loggerId+"Answer: ",t);var n=new RTCSessionDescription(t.answer);this.g7(n).then(function(){"closed"!==i.cG.signalingState&&i.update_ice_candidates(t)})["catch"](function(t){a.ErrorMonitor.getInstance().logError("Error setting remote descriptor for the answer received",i.logger,o.bt.Ct,{detailedError:t,otherGuid:i.s7}),i.close()})},h.prototype.update_ice_candidates=function(t){var n=this;t.channel.ice_candidates.forEach(function(t){n.Q9&&n.logger.debug(n.loggerId+"got ICE cand: ",t);var i=new RTCIceCandidate(t);n.cG.addIceCandidate(i).then(function(){})["catch"](function(t){a.ErrorMonitor.getInstance().logError("Error updating ice candidates",n.loggerId,o.bt.Nt,{detailedError:t,otherGuid:n.s7})})})},h.prototype.p7=function(i,n){var r=this,s=e.defer();return this.channel.onopen=function(t){return r.O7(s,i,n)},this.channel.onclose=function(t){r.close(),s.reject(r)},this.channel.onmessage=function(t){return r.$V.El(t.data)},this.channel.onerror=function(t){a.ErrorMonitor.getInstance().logError("Error setting up channel",r.loggerId,o.bt.St,{detailedError:t,otherGuid:r.s7}),r.close()},s.promise},h.prototype.O7=function(t,i,n){var r=this;this.open=!0,this.channel.bufferedAmountLowThreshold=Math.min(this.cG.sctp.maxMessageSize,s.xu.ju.qo),this.channel.addEventListener("bufferedamountlow",function(){r.$V.dl()}),t.resolve(this),i||(this.t7.K9(this.s7,this),n&&u.Framework.clearTimeout(n))},h.prototype.m7=function(){var t=this;this.T7&&-1==this._7&&(this._7=u.Framework.setTimeout(function(){t.R7(),t.E7(!1)},s.xu.Uu.Eu))},h.prototype.R7=function(){var i=this,t=this.y7;if(this.y7=new Array(),t&&0<t.length){var n=t.length;this.channelManager.F9.S7(this.t7.uS,this,t,this.s7).then(function(t){i.Q9&&i.logger.debug(i.loggerId+"sent "+n+" more candidates")})["catch"](function(t){a.ErrorMonitor.getInstance().logError("Error sending candidates",i.loggerId,o.bt.St,{detailedError:t,otherGuid:i.s7})})}},h.prototype.E7=function(t){t&&-1!=this._7&&u.Framework.clearTimeout(this._7),this._7=-1},h.prototype.send=function(t){var i=this;null!==this.A7&&(u.Framework.clearTimeout(this.A7),this.A7=null);try{this.channel.send(t),this.channel.bufferedAmount<=s.xu.ju.qo&&(this.A7=u.Framework.setTimeout(function(){return i.$V.dl()},0))}catch(t){a.ErrorMonitor.getInstance().logError("Error setting sending ",this.loggerId,o.bt.Mt,{detailedError:t,otherGuid:this.s7}),this.close()}},h);function h(t,i,n,r,s,e){var h=this;this.Q9=!1,this.loggerId="[Channel] ",this._7=-1,this.cG=null,this.channel=null,this.A7=null,this.d7=null,this.v7=5,this.timeout=5e3,this.open=!1,this.T7=!1,this.y7=new Array(),this.channelManager=t,this.t7=i,this.label=n,this.a7=r,this.f7=s,this.s7=e,this.logger=u.Framework.resolve(u.Framework.v.p).log(),this.$V=u.Framework.resolve(u.Framework.v.dk),this.$V.init(this.t7.uS,e),this.cG=new RTCPeerConnection(this.f7),this.cG.onicecandidate=function(t){t&&t.candidate&&(h.y7.push(t.candidate),h.m7())},this.cG.onnegotiationneeded=function(){h.createOffer().then(function(t){return h.b7(t)}).then(function(t){h.Q9&&h.logger.debug(h.loggerId+"Sending offer to "+h.s7+" [candidates: "+h.y7.length+"]");var i=h.y7;h.y7=new Array();var n=h.channelManager.F9.offer(h.t7.uS,h.s7,h,i,t);return h.T7=!0,n})["catch"](function(t){a.ErrorMonitor.getInstance().logError("Error negotiating with peer",h.loggerId,o.bt.Rt,{detailedError:t,otherGuid:h.s7}),h.close()})},this.cG.oniceconnectionstatechange=function(t){h.cG&&"disconnected"===h.cG.iceConnectionState&&h.close(),h.cG&&"failed"===h.cG.iceConnectionState&&(a.ErrorMonitor.getInstance().logError("Error establishing ICE connection",h.loggerId,o.bt.Rt,{otherGuid:h.s7}),h.close())},this.cG.onsignalingstatechange=function(t){"closed"===t.signalingState&&h.close()}}i.u7=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(0),e=n(2),h=n(1),o=(u.prototype.U9=function(t,i){void 0===i&&(i=[]),this.logger.info("SET LISTENERS FOR "+t+","+i.length),this.listeners.set(t,i)},u.prototype.bx=function(t){this.listeners["delete"](t)},u.prototype.I7=function(){0<this.listeners.length&&this.listeners.forEach(function(t,i){t.forEach(function(t){t.nQ&&t.nQ()})})},u.prototype.G9=function(n,t){var r=this;0<this.listeners.length&&(t?this.listeners.get(t).forEach(function(t){try{t.PS&&t.PS(n)}catch(t){h.ErrorMonitor.getInstance().logError("Error firing server connect when we have swarm",r.eH,e.lt.dt,t)}}):this.listeners.forEach(function(t,i){t.forEach(function(t){try{t.PS&&t.PS(n)}catch(t){h.ErrorMonitor.getInstance().logError("Error firing server connect when we do not have swarm",r.eH,e.lt.Et,t)}})}))},u.prototype.W9=function(n){0<this.listeners.length&&this.listeners.forEach(function(t,i){t.forEach(function(t){t.Mq&&t.Mq(n)})})},u);function u(){this.eH="[Base Network Manager] ",this.listeners=new r(),this.logger=s.Framework.resolve(s.Framework.v.p).log()}i.L9=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(4),o=n(0),u=n(16),r=(s.prototype.init=function(t,i,n){this.t7=t,this.logger=i,this.channelManager=n},s.prototype.isConnected=function(){return this.client.xS().isConnected()},s.prototype.start=function(t,i){var n=this;this.logger.debug("MY ID "+i),this.uS=i,this.client&&this.client.xS()?this.client.xS().on(HiveStreamingServices.bW,1,function(t){n.N7(t.msg)}):this.logger.error("error getting active services connection"),this.t7.G9(this.uS)},s.prototype.N7=function(t){var i=JSON.parse(t);this.t7.Q9&&this.logger.debug("RCV MSG FROM SRV ",i),this.channelManager.trigger(i.msgName,i.msg)},s.prototype.C7=function(t,i,n){var r=this.wrap(i,t,n);if(this.client&&this.client.xS()){var s=JSON.stringify(r);this.t7.Q9&&this.logger.debug(" FORWARDING REQUEST : "+s);var e=new u.Lc(HiveStreamingServices.bW,0,s);return this.client.xS().send(e)}return h.reject()},s.prototype.wrap=function(t,i,n){return{msgId:this.Sl++,destination:n,msg:t,msgName:i}},s.prototype.S7=function(t,i,n,r){var s={channel:{label:i.label,ice_candidates:n}};return this.C7("update_ice_candidates",s,r)},s.prototype.offer=function(t,i,n,r,s){var e={peer:{guid:t,first_seen:o.Framework.time()},channel:{label:n.label,ice_candidates:r,offer:s}};return this.C7("offer",e,n.s7)},s.prototype.h7=function(t,i,n){this.t7.Q9&&this.logger.debug("Discovery service rejects offer from peer "+i+" on channel "+n);var r={c7:t,channel:n};return this.C7("answer",r,i)},s.prototype.answer=function(t,i,n,r){var s={answer:i,k7:this.t7.uS,channel:{label:t.label,ice_candidates:n}};return this.C7("answer",s,r)},s);function s(){this.Sl=1,this.client=o.Framework.resolve(o.Framework.v.jl)}i.pZ=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(5),e=n(0),h=(o.prototype.init=function(t){this.logger=e.Framework.resolve(e.Framework.v.p).log(t.sessionId),this.hM=t.hM,this.D7()},o.prototype.D7=function(){var t=this;e.Framework.setInterval(function(){t.j7()},s.xu.Cu.ko)},o.prototype.j7=function(){var i=this;this.J1.values().filter(function(t){return e.Framework.time()-t.L_.y_>s.xu.Cu.Do}).forEach(function(t){i.hM.abort(t.X_),i._H(t.I_(),t.N_())})},o.prototype.mH=function(t){this.M7(t.I_(),t.N_()),this.J1.set(t.N_(),t)},o.prototype._H=function(t,i){this.J1["delete"](i),this.P7(t,i)},o.prototype.AH=function(t){this.L7(t)},o.prototype.RH=function(t){this.EH["delete"](t)},o.prototype.L7=function(t){if(this.EH.set(t.I_(),t.R_()),this.H7.push(t.I_()),this.EH.length>s.xu.Cu.Co){var i=this.H7[0];this.EH["delete"](i),this.H7.splice(0,1)}},o.prototype.vH=function(t){return this.EH.has(t)},o.prototype.wH=function(t){return this.EH.get(t)},o.prototype.M7=function(t,i){if(this.U7.has(t))this.U7.get(t).push(i);else{var n=[];n.push(i),this.U7.set(t,n)}},o.prototype.P7=function(t,i){if(this.U7.has(t)){var n=this.U7.get(t),r=n.indexOf(i);-1==r?this.logger.warn("I CANNOT FIND THE REQUEST ID "+i):n.splice(r,1),0==n.length&&this.U7["delete"](t)}else this.logger.warn("TRIED TO REMOVE AN OBJECT THAT DOES NOT EXIST")},o.prototype.bH=function(t){var i=[];if(this.F7(t))for(var n=this.U7.get(t),r=0;r<n.length;r++)this.J1.has(n[r])&&i.push(this.J1.get(n[r]));return i},o.prototype.F7=function(t){return this.U7.has(t)},o.prototype.NH=function(){return 0!=this.J1.length},o.prototype.gH=function(t){return this.U7.has(t)},o);function o(){this.EH=new r(),this.H7=[],this.J1=new r(),this.U7=new r()}i.Cu=h},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(5),e=n(6),h=n(23),o=(u.prototype.setId=function(t){this.G7=t},u.prototype.getId=function(){return this.G7},u.prototype.xZ=function(t){this.udpScore=t},u.prototype.jq=function(){return this.udpScore},u.prototype.BZ=function(t){this.x7=t},u.prototype.w2=function(){return this.x7},u.prototype.setContextId=function(t){var i=h.ol.ib(t+"_"+s.xu._u.xh).toString(h.ol.jg.Mg);this.contextId=i},u.prototype.getContextId=function(){return this.contextId},u.prototype.yq=function(t){this.B7=t},u.prototype.zM=function(){return this.B7},u.prototype.Pq=function(t){this.V7=t},u.prototype.aP=function(){return this.V7},u.prototype.VQ=function(t){this.q7=t},u.prototype.fP=function(){return this.q7},u.prototype.BQ=function(t){this.Q7=t},u.prototype.cP=function(){return this.Q7},u.prototype._2=function(t){this.siteId=t},u.prototype.sP=function(){return this.siteId},u.prototype.R2=function(t){this.Y7=t},u.prototype.eP=function(){return this.Y7},u.prototype.bq=function(t){this.K7=t},u.prototype.pP=function(){return this.K7},u.prototype.W7=function(t){this.X7=t},u.prototype.lP=function(){return this.X7},u.prototype.JF=function(t){this.watchingQualityLevel=t},u.prototype.ZF=function(){return this.watchingQualityLevel},u.prototype._q=function(t){this.mq=t},u.prototype.EP=function(){return this.mq},u.prototype.bG=function(t){this.privateIp=t},u.prototype.getPrivateIp=function(){return this.privateIp},u.prototype.EG=function(t){this.publicIp=t},u.prototype.getPublicIp=function(){return this.publicIp},u.prototype.setReportingGuid=function(t){this.reportingGuid=t},u.prototype.getReportingGuid=function(){return this.reportingGuid},u.prototype.setDelta=function(t){this.delta=t},u.prototype.getDelta=function(){return this.delta},u.prototype.RM=function(t,i){this.z7.set(t.id,i)},u.prototype.OM=function(t){this.z7["delete"](t.id)},u.prototype.xQ=function(){return this.z7},u.prototype.UU=function(){return this.lP()?this.z7.values().map(function(t){return t.qualityLevel}):[]},u.prototype.FU=function(){return this.lP()?[]:this.z7.values().map(function(t){return t.qualityLevel})},u.prototype.MZ=function(t){this.ticket=t},u.prototype.wP=function(){return this.ticket},u.prototype.PZ=function(t){this.f0=t},u.prototype.k8=function(){return this.f0},u.prototype.tG=function(){return this.srcThroughput},u);function u(){this.udpScore=0,this.x7=0,this.B7=!1,this.X7=!1,this.V7=!1,this.q7=!1,this.Q7=!1,this.z7=new r(),this.srcThroughput=new e.ma()}i.DZ=o},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var a,f=n(9),e=n(224),c=n(2),l=n(1),v=n(5),h=(a=e.J7,s(o,a),o.prototype.f9=function(t,i){var r=[],s=[],e=[],h=[];try{var o=this.tv.sP(),u=this.tv.eP();return t.forEach(function(t){t.hP.peerInfo.type==f.pf.bf&&r.push(t);var i=t.hP.peerInfo.internalAs;if(0!=o&&o===i&&s.push(t),v.xu.ju.$o){var n=t.hP.peerInfo.externalAs;0!=u&&u===n&&e.push(t)}t.hP.peerInfo.type==f.pf.gf&&h.push(t)}),0<r.length?a.prototype.f9.call(this,r,i):0<s.length?a.prototype.f9.call(this,s,i):0<e.length?a.prototype.f9.call(this,e,i):a.prototype.f9.call(this,h,i)}catch(t){return l.ErrorMonitor.getInstance().logError("Error choosing partner for p2p",this.loggerId,c.Lr.Hr,t),null}},o);function o(){return null!==a&&a.apply(this,arguments)||this}i.AZ=h},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=n(5),e=n(1),h=n(2),o=(u.prototype.h9=function(t){this.tv=t},u.prototype.f9=function(t,i){var n=this.Z7(t);return n?n[0]:null},u.prototype.ttt=function(t,i){return s.xu.ju.Yo*(t.dP()/i)+s.xu.ju.Ko*(1-t.S8())},u.prototype.Z7=function(t){var n=this;try{var r=.1;r+=t.map(function(t){return t.dP()}).reduce(function(t,i){return t+i});var i=t.sort(function(t,i){return n.ttt(i,r)-n.ttt(t,r)}),s=[];return i.forEach(function(t){s.push(t.guid+":"+n.ttt(t,r))}),this.logger.debug("SC ["+s.join(", ")+"]"),i}catch(t){return e.ErrorMonitor.getInstance().logError("Error sorting the partners",this.loggerId,h.Mr.Pr,t),null}},u);function u(){this.loggerId="[PickerTRSingle] ",this.logger=r.Framework.resolve(r.Framework.v.p).log()}i.J7=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var v=n(54),d=n(3),E=n(66),w=n(6),p=n(5),a=n(0),r=n(53),s=n(107),e=n(8).Y.sf,h=(o.prototype.init=function(t){this.logger=a.Framework.resolve(a.Framework.v.p).log(t.sessionId),this.tv=t.tv,this.LZ=t.LZ,this.xV=t.xV,this.WH=t.WH},o.prototype.fM=function(t){this.cM=t},o.prototype.N2=function(){this.t0()},o.prototype.Tq=function(){if(p.xu.Nu.wo)this.itt();else{var t=!this.tv.aP()||this.tv.zM()||!e;this.logger.debug("REQUEST REMOTE ELECTION "+t),t?this.itt():this.ntt()}},o.prototype.itt=function(){var t=this.tv.sP(),i=t&&0!=t?s.UV.tM:s.UV.AS;this.LZ.O2(i)},o.prototype.ntt=function(){this.LZ.O2(s.UV.FV)},o.prototype.t0=function(){var t=this;this.YZ(),this.stt=a.Framework.setInterval(function(){t.Tq()},p.xu.Nu.bo),this.WH.AR(),this.Tq()},o.prototype.YZ=function(){this.stt&&a.Framework.clearInterval(this.stt)},o.prototype.KZ=function(){this.WH.VM(),this.cM.o1()},o.prototype.Oq=function(t){var i=new d();if(t){this.ett().forEach(function(t){i.set(t,v.Jj.Zj)});var n=!1,r=v.Jj.Zj;this.tv.lP()&&(r=v.Jj.tM,n=!0),this.WH.EM(i,r,n)}else this.WH.EM(i,v.Jj.Z_,!1)},o.prototype.S2=function(t,i){var n=this,r=this.htt(i),s=this.WH.dM().UH();if(t&&0<t.length){var e=new E();e.hiveAddEach(t);var h=p.xu.Nu.fo||e.some(function(t){var i=w.ja(hive.services.protocol.tracker.TrackerRankType,t.key.rankType);return n.logger.info("GOT RANKING "+i+",CRV "+t.cumulatedRankValue+",RV "+t.ranking+",GS "+t.groupSize),n.ott(t)});p.xu.Nu.co&&(h=this.utt(h));var o=null!=r&&0!=r.length;if(this.logger.debug("Tracker reports ["+r.keys().join(", ")+"]  quality levels"),this.logger.debug("ISLive "+s+" DoElect "+h),p.xu.Nu.ao&&s){var u=this.ett();if(o&&h){this.tv.W7(!0),this.logger.info("BECOMING SITE LEADER");var a=new d();u.forEach(function(t){a.set(t,v.Jj.Zj)}),r.forEach(function(t,i){n.xV.UQ.has(t)||a.set(i,v.Jj.tM)}),this.WH.EM(a,v.Jj.tM,!1)}else{this.tv.W7(!1);var f=v.Jj.Z_,c=new d();this.tv.aP()&&this.tv.zM()&&(f=v.Jj.Zj,u.forEach(function(t){c.set(t,v.Jj.Zj)})),this.WH.EM(c,f,!1)}}}else if(s){p.xu.Nu.fo?this.tv.W7(!0):this.tv.W7(!1);var l=new d();f=v.Jj.Z_,this.tv.aP()&&this.tv.zM()&&(this.ett().forEach(function(t){l.set(t,v.Jj.Zj)}),f=v.Jj.Zj),p.xu.Nu.fo&&(f=v.Jj.tM),this.WH.EM(l,f,!1)}},o.prototype.utt=function(t){return t?!(this.att=!1):this.tv.lP()?this.att?this.att=!1:this.att=!0:void 0},o.prototype.tY=function(){var t=this.ett(),i=new d();t.forEach(function(t){i.set(t,v.Jj.Zj)});var n=!1,r=v.Jj.Zj;this.tv.lP()&&(r=v.Jj.tM,n=!0),this.WH.EM(i,r,n)},o.prototype.ett=function(){var n=new E();return this.xV.UQ.forEach(function(t,i){t.peerInfo.watchingQualityLevel&&!n.has(t.peerInfo.watchingQualityLevel.id)&&n.hiveAdd(t.peerInfo.watchingQualityLevel.id)}),n.toArray()},o.prototype.htt=function(t){var i=new d(),n=this.tv.sP();return t.forEach(function(t){null!=t.watchingQualityLevel&&(0<n?n===t.internalAs&&i.set(t.watchingQualityLevel,t.guid):i.set(t.watchingQualityLevel,t.guid))}),i},o.prototype.ott=function(t){if(t.groupSize<2)return!1;var i=Math.max(p.xu.Nu["do"],Math.round(t.groupSize*p.xu.Nu.vo));return e||a.Framework.T()&&r.$j.Kj?t.ranking<i&&(this.tv.zM()||!this.tv.aP()):t.ranking<i},o.prototype.FM=function(t,i,n,r){var s=1,e=this.cM.ZM(n,i),h=p.xu.Nu.To*a.Framework.random();if(t==v.Jj.Zj){var o=this.cM.v1()-h;s=Math.max(1,e-o)}else if(t==v.Jj.tM){var u=p.xu.Nu.Oo-h;s=Math.max(1,e-u)+r}return s=Math.round(s)},o);function o(){this.att=!1}i.IZ=h},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=n(3),e=n(16),h=n(1),o=n(2);n(25);var u=n(6),a=(f.prototype.n2=function(t,i){try{return this.logger.debug("TRACKER CLIENT REGISTERED "+t),this.ftt.has(t)||this.ftt.set(t,i),this.ftt.get(t)}catch(t){h.ErrorMonitor.getInstance().logError("Error adding new tracker client",this.loggerId,o.Ir.Nr,t)}},f.prototype.ctt=function(t){this.ftt["delete"](t)},f.prototype.ltt=function(t){return this.ftt.get(t)},f.prototype.T2=function(t){var i=this;if(this.client&&this.client.xS()){var n=void 0;try{n=this.vtt.ia(t,"TRACKER_REQ",0)}catch(t){h.ErrorMonitor.getInstance().logError("Error serializing the new request",this.loggerId,o.Ir.Cr,t)}if(n){var r=new e.Lc(HiveStreamingServices.pW,1,n),s=this.client.xS().send(r);s.then(function(){return i.logger.info("TRACKER REQUEST SENT")}),s.fail(function(t){h.ErrorMonitor.getInstance().logError("Error sending tracker request",i.loggerId,o.Ir.Sr)})}}else h.ErrorMonitor.getInstance().logError("Error sending tracker request because of connection",this.loggerId,o.Ir.Dr)},f.prototype.dtt=function(t){t.infos.map(function(t){t.guid=atob(t.guid),t.publicIp=new InetAddress(),t.publicIp.address=t.publicIpString,t.privateIp=new InetAddress(),t.privateIp.address=t.privateIpString}),t.peerInfo.guid=atob(t.peerInfo.guid),t.peerInfo.publicIp=new InetAddress(),t.peerInfo.publicIp.address=t.peerInfo.publicIpString,t.peerInfo.privateIp=new InetAddress(),t.peerInfo.privateIp.address=t.peerInfo.privateIpString},f.prototype.init=function(){var n=this;this.logger.debug("TRACKER MANAGER INIT"),this.client&&this.client.xS()?this.client.xS().on(HiveStreamingServices.pW,10,function(t){try{var i=null;try{i=n.vtt.oa(t.msg,"TRACKER_RESP",1,hive.services.protocol.tracker.TrackerResponse),n.dtt(i)}catch(t){h.ErrorMonitor.getInstance().logError("Error deserializing the tracker response",n.loggerId,o.Ir.kr,t)}n.Ett&&n.logger.debug("RESP "+JSON.stringify(i)),i&&n.ftt.has(i.sessionId)?n.ftt.get(i.sessionId).U0(i):n.logger.warn("SESSION ID NOT VALID OR NULL "+i.sessionId)}catch(t){h.ErrorMonitor.getInstance().logError("Error initializing the tracker manager",n.loggerId,o.Ir.jr,t)}}):r.Framework.T()||this.logger.warn(this.loggerId+" CANNOT GET ACTIVE CONNECTION")},f);function f(){this.Ett=!1,this.loggerId="[TRACKER] ",this.ftt=new s(),this.vtt=new u.va(),this.logger=r.Framework.resolve(r.Framework.v.p).log(),r.Framework.T()||(this.client=r.Framework.resolve(r.Framework.v.jl))}i.dZ=a},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var f=n(36),r=n(3),c=n(0),l=n(5),v=n(1),d=n(2),s=(e.prototype.init=function(t){this.logger=c.Framework.resolve(c.Framework.v.p).log(t.sessionId)},e.prototype.F0=function(t){try{var i=t.I_(),n=t.F_,r=t.L_.d_,s=Math.ceil(r/l.xu.ju.qo),e=t.A_.getQualityLevel(),h=0,o=Math.min(l.xu.ju.qo,r);this.wtt(i,e);for(var u=o-h;0<s;){var a=null;try{c.Framework.T()||(a=f.wrap(n.slice(h,o))),h+=u}catch(t){v.ErrorMonitor.getInstance().logError("Error wrapping chunk",this.loggerId,d.pn.bn,t)}this.ptt.get(i).push(a),s--,u=(o=Math.min(h+l.xu.ju.qo,r))-h}}catch(t){v.ErrorMonitor.getInstance().logError("Error adding fragment to the fragmentMap",this.loggerId,d.pn.gn,t)}},e.prototype.wtt=function(t,i){try{if(this.gtt.has(i.id)&&this.gtt.get(i.id).length>l.xu.Cache.Po){var n=this.gtt.get(i.id)[0];this.ptt["delete"](n),this.gtt.get(i.id).shift()}if(this.gtt.has(i.id))this.gtt.get(i.id).push(t),this.ptt.set(t,[]);else{var r=[t];this.gtt.set(i.id,r),this.ptt.set(t,[])}}catch(t){v.ErrorMonitor.getInstance().logError("Error generating the chunk handler hashmaps",this.loggerId,d.pn.yn,t)}},e.prototype.e9=function(t,i){return this.ptt.has(t)?this.ptt.get(t)[i]:null},e.prototype.zZ=function(){this.ptt=new r(),this.gtt=new r()},e);function e(){this.loggerId="[ChunkHandler] ",this.ptt=new r(),this.gtt=new r()}i.gZ=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),h=n(5),s=n(0),o=n(2),u=n(1),e=(a.prototype.init=function(t){this.logger=s.Framework.resolve(s.Framework.v.p).log(t.sessionId),this.partnership=t.partnership,this.btt=new r(),this.ytt=new r(),this.Ttt&&this.Ott()},a.prototype.pQ=function(i,t,n){try{if(!this.Ttt)return!1;if(this.btt.has(i)||!t||!n)return!1;var r=this.mtt(t,n);return!!(r&&this.ytt.has(r)&&this.ytt.get(r).length>=h.xu.Ru.zh)&&(u.ErrorMonitor.getInstance().logError("Error peer violates ip spoofing rules",this.loggerId,o.ws.gs,{privateIp:t,publicIp:n,otherGuid:i}),this.logger.debug(this.loggerId+"Spoofing rule violated for "+i+" with privateIp "+t+" publicIp "+n),!0)}catch(t){return u.ErrorMonitor.getInstance().logError("Error checking if peer violates ip spoofing rules",this.loggerId,o.ws.ps,{detailedError:t,otherGuid:i}),!1}},a.prototype.OQ=function(i,t,n){try{if(this.Ttt&&n&&t){var r=this.mtt(t,n),s=this.btt.get(i);s&&s!=r&&this._tt(i,s),this.Rtt(i,r)}}catch(t){u.ErrorMonitor.getInstance().logError("Error adding or updating ip spoofing maps",this.loggerId,o.ws.bs,{detailedError:t,otherGuid:i})}},a.prototype.Stt=function(t){this.Ttt&&this.YQ(t)},a.prototype.Mq=function(t){this.Ttt&&this.YQ(t)},a.prototype.Rtt=function(t,i){this.btt.set(t,i);var n=[];this.ytt.has(i)&&-1!=(n=this.ytt.get(i)).indexOf(t)||(n.push(t),this.ytt.set(i,n))},a.prototype.YQ=function(t){var i=this.btt.get(t);i?(this._tt(t,i),this.btt["delete"](t)):this.logger.warn(this.loggerId+"no ip pair for guid "+t)},a.prototype._tt=function(t,i){var n=this.ytt.get(i),r=n.indexOf(t);-1!=r?(n.splice(r,1),0==n.length?this.ytt["delete"](i):this.ytt.set(t,n)):this.logger.warn(this.loggerId+"pair list "+i+" does not contain guid "+t)},a.prototype.mtt=function(t,i){return i+":"+t},a.prototype.Ott=function(){var e=this;s.Framework.setInterval(function(){try{var s=[];e.ytt.forEach(function(t,i){if(t.length>h.xu.Ru.zh){for(var n=[],r=h.xu.Ru.zh;r<t.length;r++)n.push(t[r]);e.logger.warn("IpSpoofing violation for "+i+" - closing: "+n),s.concat(n)}}),s.forEach(function(t){e.partnership.IQ(t)})}catch(t){u.ErrorMonitor.getInstance().logError("Error checking periodic ip spoofing tables",e.loggerId,o.ws.ys,t)}},h.xu.Ru.Jh)},a);function a(){this.loggerId="[IPSpoofing] ",this.Ttt=h.xu.Ru.$h}i.Ru=e},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(112),o=n(5),u=n(67),a=n(0),f=n(2),c=n(1),l=(e=h.pY,s(v,e),v.prototype.dY=function(t,i){try{return i.sort(u.iU.JH),i.slice(0,t)}catch(t){return c.ErrorMonitor.getInstance().logError("Error selecting partners to remove",this.Att,f.hn.rn,t),[]}},v.prototype.EY=function(t,n,r,i){try{return i.filter(function(i){return n.every(function(t){return t.guid!=i.peerInfo.guid})&&-1==r.indexOf(i.peerInfo.guid)}).slice(0,t)}catch(t){return c.ErrorMonitor.getInstance().logError("Error selecting partners to add",this.Att,f.hn.sn,t),[]}},v);function v(){var t=e.call(this)||this;return t.Att="[Score Partner Selection] ",t.type="Score",t}i.Itt=l;var d=(E.prototype.MQ=function(t){try{var i=t.filter(function(t){return!t.AQ.transport.tl()}),n=a.Framework.time(),r=i.filter(function(t){return n-t.vY>o.xu._u.Kh});return 0<r.length?(r.sort(u.rU.JH),r.slice(0,1)[0]):null}catch(t){return c.ErrorMonitor.getInstance().logError("Error updating partners out",this.Att,f.hn.en,t),null}},E);function E(){this.Att="[Score Partner Selection] "}i.TZ=d},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0}),n(25);var p=n(3),E=n(113),g=n(5),b=n(0),d=n(6),h=n(67),y=n(2),T=n(1),e="NOT_USEFUL_PARTNER",r=(s.prototype.init=function(t){this.tv=t.tv},s.prototype.vQ=function(t,i,n,r){try{var s=[],e=[],h=Math.round(t*(1-g.xu.mu.Fh)),o=Math.max(i.length-h,0),u=t-i.length+o;if(0<o){var a=i.filter(function(t){return!t.AQ.transport.tl()}),f=b.Framework.time(),c=a.filter(function(t){return f-t.vY>g.xu._u.Kh}),l=Math.min(c.length,o);(e=this.dY(l,c)).length>l&&(u+=e.length-l);var v=[],d=[];e.forEach(function(t){v.push(t.guid),d.push(t.tU.ZH(!1))})}return 0<u&&(s=this.EY(u,i,n,r)),new E.wY(s,e)}catch(t){return T.ErrorMonitor.getInstance().logError("Error updating in partners",this.Ntt,y.un["in"],t),new E.wY([],[])}},s.prototype.dY=function(t,i){var n=this;try{i.sort(h.iU.JH);var r=i.slice(0,t);return i.slice(t,i.length).forEach(function(t){n.Ctt(t.hP)&&r.push(t)}),r}catch(t){return T.ErrorMonitor.getInstance().logError("Error selecting partners to remove",this.Ntt,y.un.rn,t),[]}},s.prototype.EY=function(t,i,n,r){var s=this;try{var e=[],h=[],o=[],u=[],a=[],f=[];i.forEach(function(t){f.push(t.guid)});var c=Math.floor(t*g.xu._u.qh),l=this.tv.xQ();r.forEach(function(t){var i=t.peerInfo.streams;if(i){var n=s.isLeader(t,i,l);n.YV?n.ktt?e.push(t):h.push(t):s.Dtt(t,g.xu._u.Vh)?s.Ctt(t)?a.push(t):u.push(t):o.push(t)}else a.push(t)});var v=this.jtt(e,h,o,u,a,t,t,c);return v.slice(0,Math.min(v.length,t))}catch(t){return T.ErrorMonitor.getInstance().logError("Error selecting partners to add",this.Ntt,y.un.sn,t),[]}},s.prototype.jtt=function(t,i,n,r,s,e,h,o){try{var u=[],a=[];0<t.length&&b.Framework.random()<g.xu._u.Qh&&(a=(t=d.Ca(t)).slice(0,Math.min(t.length,o)),u.push.apply(u,a),h=e-a.length);var f=[];0<i.length&&(f=(i=d.Ca(i)).slice(0,Math.min(i.length,o)),u.push.apply(u,f),h=e-f.length);var c=[];0<n.length&&(c=(n=d.Ca(n)).slice(0,Math.min(n.length,o)),u.push.apply(u,c),h=e-c.length);var l=null;0<r.length&&(l=(r=d.Ca(r)).slice(0,Math.min(r.length,h)),h=e-((0<c.length?c.length:0)-l.length));var v=[];return 0<h&&0<s.length&&(v=(s=d.Ca(s)).slice(0,Math.min(s.length,h)),u.push.apply(u,v)),u}catch(t){return T.ErrorMonitor.getInstance().logError("Error grouping partners",this.Ntt,y.un.an,t),[]}},s.prototype.isLeader=function(e,t,h){try{var o=!1,u=this.tv.sP(),a=this.tv.eP(),i=new p();t.forEach(function(t){i.set(t.qualityLevel,t)});var n=new p();return i.forEach(function(t,i){h.has(i)&&n.set(i,t)}),0<n.keys().length&&n.forEach(function(t,i){var n=h.get(i);if(n&&2<=t.state&&1<=n.type){var r=e.peerInfo.internalAs,s=e.peerInfo.externalAs;o=0<u?u===r:0<a&&a===s}}),{YV:!1,ktt:o}}catch(t){return T.ErrorMonitor.getInstance().logError("Error identifying if member is leader or same site",this.Ntt,y.un.fn,{detailedError:t,otherGuid:e.peerInfo.guid}),{YV:!1,ktt:!1}}},s.prototype.Dtt=function(i,t){try{var n=this.tv.getDelta(),r=this.tv.ZF(),s=this.Mtt(i,r);return(0!=n||0!=s)&&n<s&&s+t<n}catch(t){return T.ErrorMonitor.getInstance().logError("Error identifying if member is ahead or behind delta",this.Ntt,y.un.cn,{detailedError:t,otherGuid:i.peerInfo.guid}),!1}},s.prototype.Ctt=function(i){try{var t=this.tv.getDelta(),n=this.tv.ZF(),r=this.Mtt(i,n);return 0==t&&0==r||r<t}catch(t){return T.ErrorMonitor.getInstance().logError("Error identifying if member is behind or not retrieveing the same quality level",this.Ntt,y.un.vn,{detailedError:t,otherGuid:i.peerInfo.guid}),!1}},s.prototype.Mtt=function(i,n){try{var t=i.peerInfo.streams,r=0;return t&&t.forEach(function(t){t.qualityLevel===n.id&&(r=t.delta)}),r}catch(t){return T.ErrorMonitor.getInstance().logError("Error retrieving delta for member's quality level",this.Ntt,y.un.dn,{detailedError:t,otherGuid:i.peerInfo.guid}),0}},s);function s(){this.Ntt="[Delta Partner Selection] "}i.OZ=r;var o=(u.prototype.MQ=function(t,i,n){var r=this;try{this.tv=t;var s=this.tv.xQ(),e=i.streams;if(e){var h=n.filter(function(t){return!t.AQ.transport.tl()}),o=b.Framework.time(),u=h.filter(function(t){return o-t.vY>g.xu._u.Kh});if(0==e.filter(function(t){return s.has(t.qualityLevel)}).length)return null;var a=this.Ptt(u),f=this.Ltt(s,a);if(f)return f;var c=s.keys().length,l=u.length,v=Math.round(l/c),d=a.keys().filter(function(t){return s.has(t)}),E=new p();d.forEach(function(t){E.set(t,a.get(t))});var w=null;return null!=(w=this.Htt(E,v))?w:(e.forEach(function(t){var i=E.get(t.qualityLevel);if(null!=i){var n=r.Utt(i);0<n.length&&!g.xu._u.Yh&&(w=n[0])}}),null!=w?w:null)}return null}catch(t){return T.ErrorMonitor.getInstance().logError("Error selecting partner to update out",this.loggerId,y.En.wn,t),null}},u.prototype.Ptt=function(t){var s=new p();return t.forEach(function(t){var i=t.hP.peerInfo.watchingQualityLevel,n=i?i.id:null;if(n=n||e,s.has(n)){var r=s.get(n);r.push(t),s.set(n,r)}else s.set(n,[t])}),s},u.prototype.Utt=function(t){return t.filter(function(t){if(0==t.nU.P9(g.xu.ku.Bo))return t})},u.prototype.Htt=function(r,s){var n=[];r.forEach(function(t,i){n.push({qualityLevel:i,count:t.length})}),n.sort(function(t,i){return t.count>i.count?1:t.count<i.count?0:-1});var e=null;return n.forEach(function(t){var i=r.get(t.qualityLevel).length;if(s<i){var n=r.get(t.qualityLevel);0<n.length&&(n.sort(h.rU.JH),e=n[0])}}),e},u.prototype.Ltt=function(n,t){var r=this,s=null;return t.has(e)?s=t.get(e)[0]:t.filter(function(t,i){return!n.has(i)}).forEach(function(t,i){var n=r.Utt(t);0<n.length&&(s=n[0])}),s},u);function u(){this.loggerId="[Throughput Partner Selection] ",this.logger=b.Framework.resolve(b.Framework.v.p).log()}i.mZ=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),f=n(7),s=n(31),a=n(24),c=n(9),e=n(13),h=n(5),o=(u.prototype.init=function(t){this.logger=r.Framework.resolve(r.Framework.v.p).log(t.sessionId),this.loggerId="S["+t.sessionId+"]",this.Vl=t.reportingInstance.Vl,this.tv=t.tv,this.r0()},u.prototype.G2=function(t){this.Vl.MU.metrics.memN=t,this.Vl.Ul.metrics.memN=t},u.prototype.yQ=function(t,i){this.Vl.MU.metrics.lookupTotal++,this.Vl.Ul.metrics.lookupTotal++,t?(this.Vl.MU.metrics.lookupNotFound++,this.Vl.Ul.metrics.lookupNotFound++,this.Vl.MU.metrics.lookupFailed++,this.Vl.Ul.metrics.lookupFailed++):i?(this.Vl.MU.metrics.lookupFailed++,this.Vl.Ul.metrics.lookupFailed++):(this.Vl.MU.metrics.lookupReqEstablished++,this.Vl.Ul.metrics.lookupReqEstablished++)},u.prototype.GQ=function(){this.Vl.MU.metrics.lookupReqAccept++,this.Vl.Ul.metrics.lookupReqAccept++},u.prototype.v8=function(t,i,n,r,s){if(this.Ftt||r){var e=s==a.h_.l_,h=this.Vl.lF(t),o=this.Vl.cF(t);h.p2pSuccReq++,h.p2pSuccReceived+=i,o.p2pSuccReq++,o.p2pSuccReceived+=i,e&&(h.p2pSuccReceivedLow+=i,o.p2pSuccReceivedLow+=i),0<n&&!e&&(h.p2pSuccReceivedLow+=i,o.p2pSuccReceivedLow+=i)}},u.prototype.w8=function(t,i,n,r,s,e){if(this.Ftt||s){var h=e==a.h_.l_,o=this.Vl.lF(t),u=this.Vl.cF(t);o.p2pFailReq++,o.p2pSuccReceived+=i,o.p2pFailReceived+=r-i,u.p2pSuccReq++,u.p2pSuccReceived+=i,u.p2pFailReceived+=r-i,h&&(o.p2pSuccReceivedLow+=i,u.p2pSuccReceivedLow+=i),0<n&&!h&&(o.p2pSuccReceivedLow+=i,u.p2pSuccReceivedLow+=i)}},u.prototype.p8=function(t,i,n){if(this.Ftt||n){var r=this.Vl.lF(t),s=this.Vl.cF(t);r.p2pFailReq++,r.p2pFailReceived+=i,s.p2pFailReq++,s.p2pFailReceived+=i}},u.prototype.b8=function(t,i,n){if(this.Ftt||n){var r=this.Vl.lF(i),s=this.Vl.cF(i);r.p2pSuccResp++,r.p2pSuccSent+=t,s.p2pSuccResp++,s.p2pSuccSent+=t}},u.prototype.m8=function(t,i,n,r){if(this.Ftt||r){var s=this.Vl.lF(n),e=this.Vl.cF(n);s.p2pPartResp++,s.p2pSuccSent+=t,s.p2pFailSent+=i-t,e.p2pPartResp++,e.p2pSuccSent+=t,e.p2pFailSent+=i-t}},u.prototype.T8=function(t,i,n){if(this.Ftt||n){var r=this.Vl.lF(i),s=this.Vl.cF(i);r.p2pFailResp++,r.p2pFailSent+=t,s.p2pFailResp++,s.p2pFailSent+=t}},u.prototype.uH=function(t){t?this.Vl.MU.metrics.bitrateUpN++:this.Vl.MU.metrics.bitrateDwnN++},u.prototype.vx=function(t){if(-1==[f.xa.qa,f.xa.Qa].indexOf(t.S_())){var i=t.S_()!=f.xa.Ba;if((this.Ftt||i)&&(this.Vl.hF().reqN++,this.Vl.eF().reqN++,t.S_()==f.xa.Va)){var n=t;if(n.getQualityLevel()){var r=n.getQualityLevel();this.Vl.oF(r).reqN++,this.Vl.uF(r).reqN++}}}else this.Vl.hF().reqOtherN++,this.Vl.eF().reqOtherN++},u.prototype.hx=function(t){var i=t.S_()!=f.xa.Ba;if(this.Ftt||i){var n,r=this.Vl.hF(),s=this.Vl.eF(),e=null,h=null;-1==[f.xa.qa,f.xa.Qa].indexOf(t.S_())&&(r.srcReqN++,s.srcReqN++,!i||(n=this.Gtt(t))&&(e=this.Vl.oF(n),h=this.Vl.uF(n),e.srcReqN++,h.srcReqN++),t.R_()==a.h_.a_&&(r.srcOtherReqN++,s.srcOtherReqN++,!i||(n=this.Gtt(t))&&(e.srcOtherReqN++,h.srcOtherReqN++)))}},u.prototype.c9=function(t){if(this.Vl.hF().p2pSubReqN++,this.Vl.eF().p2pSubReqN++,t.S_()==f.xa.Va){var i=this.Gtt(t);i&&(this.Vl.oF(i).p2pSubReqN++,this.Vl.uF(i).p2pSubReqN++)}},u.prototype.xtt=function(t,i){this.Btt(t,this.Vl.eF()),this.Btt(t,this.Vl.hF());var n=this.Gtt(t);n&&t.S_()===f.xa.Va&&this.tv.ZF().id===n.id&&(this.Btt(t,this.Vl.oF(n)),this.Btt(t,this.Vl.uF(n))),isNaN(i)||(this.Vl.MU.metrics.srcThroughput=i)},u.prototype.wx=function(t,i){var n=t.S_()!=f.xa.Ba;(this.Ftt||n)&&(-1!=[f.xa.qa,f.xa.Qa].indexOf(t.S_())?(this.Vl.hF().respFallbackOtherN++,this.Vl.eF().respFallbackOtherN++):this.xtt(t,i))},u.prototype.px=function(t,i){if(-1!=[f.xa.qa,f.xa.Qa].indexOf(t.S_()))this.Vl.hF().respFallbackOthertErrN++,this.Vl.eF().respFallbackOthertErrN++;else{var n=t.S_()!=f.xa.Ba;if(this.Ftt||n)if(this.oH(t.type))this.Vl.eF().respFallbackErrN++,this.Vl.hF().respFallbackErrN++,!n||(r=this.Gtt(t))&&(this.Vl.oF(r).respFallbackErrN++,this.Vl.uF(r).respFallbackErrN++),0==t.L_.g_&&(this.Vl.eF().srcRespErrN++,this.Vl.hF().srcRespErrN++,!n||(r=this.Gtt(t))&&t.S_()===f.xa.Va&&(this.Vl.oF(r).srcRespErrN++,this.Vl.uF(r).srcRespErrN++)),this.xtt(t,i);else if(t.type==a.h_.a_&&-1!=h.xu.Iu.oo.indexOf(t.X_.status))this.Vl.hF().fallAgentFailedRespN++,this.Vl.eF().fallAgentFailedRespN++,this.Vl.hF().reqN--,this.Vl.eF().reqN--;else{var r;0==t.L_.g_&&(this.Vl.hF().srcOtherRespErrN++,this.Vl.eF().srcOtherRespErrN++),n||(r=this.Gtt(t))&&t.S_()===f.xa.Va&&(this.Vl.oF(r).srcOtherRespErrN++,this.Vl.uF(r).srcOtherRespErrN++),this.xtt(t,i)}}},u.prototype.C0=function(t,i){if(i.Q1==a.h_.l_)this.Vl.eF().respP2pN++,this.Vl.hF().respP2pN++;else if(i.Q1==a.h_.a_)this.Vl.eF().respFallbackN++,this.Vl.hF().respFallbackN++;else if(i.Q1==a.h_.o_){this.Vl.eF().lCacheRespN++,this.Vl.hF().lCacheRespN++;var n=r.Framework.T()?i.length:t.F_.byteLength;this.Vl.eF().lCacheRespQt+=n,this.Vl.hF().lCacheRespQt+=n}},u.prototype.x0=function(t,i){var n=t.S_()!=f.xa.Ba;(this.Ftt||n)&&this.xtt(t,i);var r=new hive.snapshots.PartnerMetrics();r.rateReceived=t.partner.dP(),this.Vl.Ul.TU.set(t.partner.reportingGuid,r)},u.prototype.P0=function(t){if(0!=t.W_&&(this.Vl.hF().p2pSubRespErrN++,this.Vl.eF().p2pSubRespErrN++,t.S_()==f.xa.Va)){var i=this.Gtt(t);i&&(this.Vl.oF(i).p2pSubRespErrN++,this.Vl.uF(i).p2pSubRespErrN++)}},u.prototype.d9=function(t){if(this.Vl.hF().p2pSubRespExpN++,this.Vl.eF().p2pSubRespExpN++,t.S_()==f.xa.Va){var i=this.Gtt(t);i&&(this.Vl.oF(i).p2pSubRespExpN++,this.Vl.uF(i).p2pSubRespExpN++)}},u.prototype.Btt=function(t,i){var n=t.L_.d_,r=t.L_.g_,s=t.L_.E_,e=t.L_.w_,h=t.L_.p_;if(t.S_()!=f.xa.qa){if(t.L_.v_&&e&&e<n){var o=e/n;i.p2pSubRespPartN+=o,this.oH(t.type)||(i.p2pAgenTrafficFailureQt+=n-s)}if(0!=h&&(h==n&&i.lCacheRespN++,i.lCacheRespQt+=t.L_.p_),0!=s)if(s==n&&(this.oH(t.type)&&i.respP2pN++,i.p2pSubRespN++),i.p2pSubReqQt+=n,i.p2pSubRespQt+=s,i.p2pAgenTrafficSuccessQt+=t.L_.p2pAgenTrafficSuccessQt,i.p2pDirectQt+=s,t.partner.hP.peerInfo.type==c.pf.bf)i.p2pUdpbQt+=s,i.p2pNatQt+=s;else{var u=this.tv.sP();u&&0<u&&(null!=t.J0?u===t.J0.internalAs&&(i.p2pNatQt+=s):this.logger.warn("Missing partner info"))}}if(0!=r){if(this.Vtt(t.type)&&(i.srcOtherReqQt+=t.L_.g_),r==n)this.Vtt(t.type)?(i.srcOtherRespN++,i.srcOtherRespQt+=t.L_.g_,i.srcOtherOverQt+=t.L_.g_,i.fallAgentRespN++):i.respFallbackN++,i.srcRespN++;else{i.srcRespErrN++;var a=r/(s+r);i.respFallbackN=a,i.respP2pN=1-a,this.Vtt(t.type)&&(i.srcOtherRespErrN++,i.srcOtherRespQt+=t.L_.g_,i.srcOtherOverQt+=t.L_.g_,i.fallAgenTrafficFailureQt+=t.L_.g_)}i.srcReqQt+=t.L_.g_,i.srcRespQt+=t.L_.g_,i.srcOverQt+=t.L_.g_,this.Vtt(t.type)&&(i.fallAgenTrafficSuccessQt+=t.L_.b_)}},u.prototype.Gtt=function(t){var i=null;if(t.A_ instanceof s.dA){var n=t.A_;n.getQualityLevel()&&(i=n.getQualityLevel())}return i},u.prototype.oH=function(t){return t!=a.h_.l_&&t!=a.h_.a_},u.prototype.Vtt=function(t){return!this.oH(t)},u.prototype.r0=function(){this.qtt()},u.prototype.ZZ=function(){r.Framework.clearInterval(this.Qtt),this.Qtt=null},u.prototype.qtt=function(){var t=this;null==this.Qtt&&(this.Qtt=r.Framework.setInterval(function(){t.Vl.JU=t.tv.eP(),t.Vl.zU=t.tv.sP(),t.Vl.ZU=t.tv.getPublicIp()},h.xu.Lu.vu))},u);function u(){this.Ftt=!0===e.HiveConfig.Stats.AudioAccounting,this.Qtt=null}i.lx=o},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(112),c=n(5),o=n(67),l=n(0),v=n(2),d=n(1),E=n(49),u=(e=h.pY,s(a,e),a.prototype.init=function(t){e.prototype.init.call(this,t),this.h0=t.h0},a.prototype.dY=function(t,i){try{return i.sort(o.iU.JH),i.slice(0,t)}catch(t){return d.ErrorMonitor.getInstance().logError("Error selecting partners to remove",this.Att,v.hn.rn,t),[]}},a.prototype.EY=function(t,n,r,i){try{var s=i.filter(function(i){return n.every(function(t){return t.guid!=i.peerInfo.guid})&&-1==r.indexOf(i.peerInfo.guid)});if(0<s.length){this.h0.Ytt(),this.h0.Ktt(!0);var e=[],h=0;for(s.forEach(function(t){h+=t.J2(),t.J2()});0<s.length&&e.length<t;)for(var o=l.Framework.random()*h,u=0,a=0;a<s.length;a++){var f=s[a];if(u<=o&&o<=u+f.J2()){e.push(f),h-=f.J2(),s.splice(a,1);break}u+=f.J2()}return c.xu.Fu.pu&&(s.sort(function(t,i){return i.J2()-t.J2()}),E.Lk.Mk(null,null,"local_score",this.tv.getReportingGuid(),[[s.length],e.map(function(t){return t.J2()}),s.reduce(function(t,i){return 0<i.J2()&&t.push(i.J2()),t},[])],6)),e}return[]}catch(t){return d.ErrorMonitor.getInstance().logError("Error selecting partners to add",this.Att,v.hn.sn,t),[]}},a);function a(){var t=e.call(this)||this;return t.Att="[Score Partner Selection] ",t.type="Locality",t}i.yZ=u},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0}),n(25);var u=n(5),r=(s.prototype.init=function(t){this.tv=t.tv},s.prototype.Ytt=function(){},s.prototype.Wtt=function(t,i){var n=0,r=t.split("."),s=i.split(".");if(4==r.length&&4==s.length)for(var e=0;e<r.length&&n==e;)r[e]==s[e]&&n++,e++;return n},s.prototype.$tt=function(t){var i=this.tv.ZF();if(!i)return!1;var n=!1;return t.peerInfo.streams.forEach(function(t){t.qualityLevel===i.id&&(n=!0)}),n},s.prototype.Y2=function(t){var i=this.tv.getPrivateIp()?this.tv.getPrivateIp().split(".").slice(0,2).join("."):null,n=this.tv.sP(),r=this.tv.getPublicIp(),s=this.tv.eP(),e=!1,h=0;if(0<s&&s===t.peerInfo.externalAs&&(h+=u.xu.Gu.gu,e=!0,0==n&&(h+=u.xu.Gu.bu)),r&&t.peerInfo.publicIpString){var o=this.Wtt(r,t.peerInfo.publicIpString);h+=o,4===o&&(e=!0)}e&&0<n&&n===t.peerInfo.internalAs&&(h+=u.xu.Gu.bu),e&&t.peerInfo.privateIpString&&t.peerInfo.privateIpString.startsWith(i)&&(h+=u.xu.Gu.yu),this.$tt(t)&&(h+=u.xu.Gu.Tu),h/=u.xu.Gu.Ou,t.Z2(h)},s.prototype.Ktt=function(t){void 0===t&&(t=!1)},s);function s(){}i.NZ=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e=n(4);n(235);var r=n(0),h=n(1),o=n(2),u=n(16),s=n(6),a=(f.prototype.init=function(t){this.logger=r.Framework.resolve(r.Framework.v.p).log(t.sessionId),this.tv=t.tv},f.prototype.Xtt=function(){var s=this;this.client&&this.client.xS()?this.ztt().then(function(t){s.logger.debug(s.loggerId+"Peer Locality Info constructed with privateip "+t.networkInfo.privateIp);var i=null;try{i=s.vtt.ia(t,"LOCALITY_INFO",0)}catch(t){h.ErrorMonitor.getInstance().logError("Error serializing locality info update",s.loggerId,o.Oe.Zs)}if(i){var n=new u.Lc(HiveStreamingServices.TW,0,i),r=s.client.xS().send(n);r.then(function(){return s.logger.info("LOCALITY INFO UPDATE SENT")}),r.fail(function(t){h.ErrorMonitor.getInstance().logError("Error sending locality update",s.loggerId,o.Oe.Sr)})}}):h.ErrorMonitor.getInstance().logError("Error sending locality update because of missing connection",this.loggerId,o.Oe.Dr)},f.prototype.ztt=function(){var n=this,t=e.defer(),i=new PeerLocalityInfo();i.agentId=this.tv.getReportingGuid();var r=new CustomerInfo();r.partnerId=this.tv.wP().mR(),r.customerId=this.tv.wP()._R(),i.customerInfo=r;var s=new NetworkInfo();return this.kS.getConnectivityInfo().then(function(t){var i=t.getNetworkChanged().getPrivateIp();n.tv.bG(i)}).fail(function(t){h.ErrorMonitor.getInstance().logError("Error getting connectivity info",n.loggerId,o.Oe.yr)})["finally"](function(){""!=n.tv.getPublicIp()&&(s.publicIp=n.tv.getPublicIp()),""!=n.tv.getPrivateIp()&&(s.privateIp=n.tv.getPrivateIp()),i.networkInfo=s,t.resolve(i)}),t.promise},f.prototype.PS=function(t){this.Xtt()},f);function f(){this.loggerId="[LocalityServiceClient] ",this.kS=r.Framework.resolve(r.Framework.v.jR),this.vtt=new s.va(),r.Framework.T()||(this.client=r.Framework.resolve(r.Framework.v.jl))}i.fZ=a},function(t,i,n){var s=n(22),e=window.CustomerInfo=function(t){this.partnerId=null,this.customerId=null,t&&(void 0!==t.partnerId&&null!==t.partnerId&&(this.partnerId=t.partnerId),void 0!==t.customerId&&null!==t.customerId&&(this.customerId=t.customerId))};e.prototype={},e.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=i.ftype,r=i.fid;if(n==s.Type.STOP)break;switch(r){case 1:n==s.Type.STRING?this.partnerId=t.$E().value:t.XE(n);break;case 2:n==s.Type.STRING?this.customerId=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},e.prototype.write=function(t){t.tw("CustomerInfo"),null!==this.partnerId&&void 0!==this.partnerId&&(t.iw("partnerId",s.Type.STRING,1),t.nw(this.partnerId),t.rw()),null!==this.customerId&&void 0!==this.customerId&&(t.iw("customerId",s.Type.STRING,2),t.nw(this.customerId),t.rw()),t.ew(),t.hw()};var h=window.NetworkInfo=function(t){this.privateIp=null,this.publicIp=null,t&&(void 0!==t.privateIp&&null!==t.privateIp&&(this.privateIp=t.privateIp),void 0!==t.publicIp&&null!==t.publicIp&&(this.publicIp=t.publicIp))};h.prototype={},h.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=i.ftype,r=i.fid;if(n==s.Type.STOP)break;switch(r){case 1:n==s.Type.STRING?this.privateIp=t.$E().value:t.XE(n);break;case 2:n==s.Type.STRING?this.publicIp=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},h.prototype.write=function(t){t.tw("NetworkInfo"),null!==this.privateIp&&void 0!==this.privateIp&&(t.iw("privateIp",s.Type.STRING,1),t.nw(this.privateIp),t.rw()),null!==this.publicIp&&void 0!==this.publicIp&&(t.iw("publicIp",s.Type.STRING,2),t.nw(this.publicIp),t.rw()),t.ew(),t.hw()};var r=window.PeerLocalityInfo=function(t){this.agentId=null,this.customerInfo=null,this.networkInfo=null,t&&(void 0!==t.agentId&&null!==t.agentId&&(this.agentId=t.agentId),void 0!==t.customerInfo&&null!==t.customerInfo&&(this.customerInfo=new e(t.customerInfo)),void 0!==t.networkInfo&&null!==t.networkInfo&&(this.networkInfo=new h(t.networkInfo)))};r.prototype={},r.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=i.ftype,r=i.fid;if(n==s.Type.STOP)break;switch(r){case 1:n==s.Type.STRING?this.agentId=t.$E().value:t.XE(n);break;case 2:n==s.Type.STRUCT?(this.customerInfo=new e(),this.customerInfo.read(t)):t.XE(n);break;case 3:n==s.Type.STRUCT?(this.networkInfo=new h(),this.networkInfo.read(t)):t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},r.prototype.write=function(t){t.tw("PeerLocalityInfo"),null!==this.agentId&&void 0!==this.agentId&&(t.iw("agentId",s.Type.STRING,1),t.nw(this.agentId),t.rw()),null!==this.customerInfo&&void 0!==this.customerInfo&&(t.iw("customerInfo",s.Type.STRUCT,2),this.customerInfo.write(t),t.rw()),null!==this.networkInfo&&void 0!==this.networkInfo&&(t.iw("networkInfo",s.Type.STRUCT,3),this.networkInfo.write(t),t.rw()),t.ew(),t.hw()}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=(e.prototype.startServer=function(t,i){try{this.Jtt&&this.Jtt.startServer(t,i)}catch(t){this.logger.warn(this.loggerId+t)}},e.prototype.Ztt=function(){try{this.Jtt&&this.Jtt.Ztt()}catch(t){this.logger.warn(this.loggerId+t)}},e.prototype.broadcast=function(t,i,n){try{this.Jtt&&this.Jtt.broadcast(t,i,n)}catch(t){this.logger.warn(this.loggerId+t)}},e.prototype.$Z=function(){try{this.Jtt&&this.Jtt.$Z()}catch(t){this.logger.warn(this.loggerId+t)}},e.prototype.tit=function(t,i){try{this.Jtt&&this.Jtt.tit(t,i)}catch(t){this.logger.warn(this.loggerId+t)}},e);function e(){this.loggerId="[ProxyUDPB]",this.logger=r.Framework.resolve(r.Framework.v.p).log(),this.Jtt=window.myUdpBroadcaster,this.Jtt||this.logger.error(this.loggerId+" helper undefined")}i.kZ=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),e=n(5),h=n(9),o=n(238),s=n(13),u=(a.prototype.init=function(t){this.logger=r.Framework.resolve(r.Framework.v.p).log(t.sessionId),this.Jtt=t.o0,this.tv=t.tv},a.prototype.HZ=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.listeners=t,this.contextId=this.tv.getContextId()},a.prototype.startServer=function(){var s=this;this.logger.debug(this.loggerId+"START UDP BROADCAST SERVER"),this.Jtt.startServer(e.xu.UDPBroadcast.Xo,function(t,i){if(-1<s.iit){var n=o.nit.Pc(i);if(n.uuid!=s.guid&&n.streamId==s.contextId&&n.p2pProtocolVersion===e.xu._u.xh){s.logger.debug(s.loggerId+"I RECEIVED A MESSAGE FROM "+n.uuid);var r=new h.yf(h.pf.bf,null,n.isLeader);r.guid=n.uuid,r.privateIpString=t,r.rankValue=n.rankValue,s.listeners.forEach(function(t){return t.JV([r],!1)})}}})},a.prototype.n0=function(){var t=this;this.logger.info(this.loggerId+"START BROADCAST EVERY "+e.xu.UDPBroadcast.zo),-1!=this.iit&&r.Framework.clearInterval(this.iit),this.iit=r.Framework.setInterval(function(){t.rit()},e.xu.UDPBroadcast.zo),this.rit()},a.prototype.$Z=function(){-1!=this.iit&&r.Framework.clearInterval(this.iit)},a.prototype.rit=function(){var t=new o.nit(this.contextId,this.tv.getId(),this.tv.jq(),this.tv.zM(),e.xu._u.xh);this.logger.info(this.loggerId+"BROADCAST MESSAGE contextId "+t.streamId+" id "+t.uuid+" udpscore "+t.rankValue+" lan leader "+t.isLeader+" protobufVersion "+t.p2pProtocolVersion),s.HiveConfig.UDPBroadcast.usiz&&(e.xu.UDPBroadcast.Jo=s.HiveConfig.UDPBroadcast.usiz),this.Jtt.broadcast(e.xu.UDPBroadcast.Xo,e.xu.UDPBroadcast.Jo,t.ia())},a.prototype.PS=function(t){this.logger.info("UDPDISCOVERY SERVER CONNECTED"),this.sit||(this.guid=t,this.startServer(),this.n0())},a);function a(){this.sit=!1,this.loggerId="[UDPBDiscovery] ",this.iit=-1}i.CZ=u},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.ia=function(){var t={streamId:this.streamId,uuid:this.uuid,rankValue:this.rankValue,isLeader:this.isLeader,p2pProtocolVersion:this.p2pProtocolVersion};return JSON.stringify(t,this.eit)},s.prototype.eit=function(t,i){if(null!==i)return i},s.Pc=function(t){var i=t,n=JSON.parse(i);return new s(n.streamId,n.uuid,n.rankValue,n.isLeader,n.p2pProtocolVersion)},s);function s(t,i,n,r,s){this.streamId=t,this.uuid=i,this.rankValue=n,this.isLeader=r,this.p2pProtocolVersion=s}i.nit=r},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(20),o=(e=h.HiveTechOptions,s(u,e),u);function u(){var t=null!==e&&e.apply(this,arguments)||this;return t.minVersion="3.0.0",t.renderStatsCallback=function(t){},t}i.HiveJSOptions=o},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(6),o=n(35),u=n(1),a=n(32),f=n(95),c=(e=o.VA,s(l,e),l.prototype.send=function(){var i=this;this.pluginId||(this.pluginId=a.aR.getInstance().wA()),f.Rx.getInstance().AR(this.pluginId,this.url,function(t){t.tech.nZ(i)})||(u.ErrorMonitor.getInstance().logError("Failed to initialize session on player request",this.loggerId),this.resolve())},l.prototype.resolve=function(){var t=this,i=new XMLHttpRequest();i.open("GET",this.url),i.onreadystatechange=function(){4===i.readyState&&(t.response=i.responseText,t.responseText=i.responseText,t.readyState=4,t.status=i.status,t.dispatchEvent(h.createEvent(Event,"readystatechange",{currentTarget:t})),t.dispatchEvent(h.createEvent(ProgressEvent,"load",{currentTarget:t})),!1)},i.send()},l);function l(){return null!==e&&e.apply(this,arguments)||this}i.nx=c},function(t,s,i){"use strict";var r,n=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(s,"s",{value:!0});var o=i(4),e=i(47),h=i(75),u=i(46),a=i(242),f=i(15),c=i(243),l=i(20),v=i(244),d=i(28),E=i(45),w=i(44),p=i(19),g=i(29),b=i(62),y=i(1),T=i(60);s.hit=navigator;var O,m=(O=e.HiveSessionInternal,n(_,O),_);function _(){return null!==O&&O.apply(this,arguments)||this}var R=(S.prototype.getName=function(){return S.dR},S.prototype.getVersion=function(){return this.version},S.prototype.needsReportingInstance=function(){return!1},S.prototype.isReady=function(){var n=this;if(null==this.oit||1e4<Date.now()-this.uit){var t=new T.OS();t.mS(navigator.userAgent);var i=t.cL();if("IE"===i.name&&i.version&&parseInt(i.version)<10)return o.reject(new d.HiveTechError(d.wR.NOT_READY,"Internet Explorer < v.10 not supported"));this.ait=Date.now(),this.fit=0;var r="//"+E.gv.Ok+":"+this.plugin.options().monitorPort+"/version.json";this.logger().debug(this.id()+"verifying Hive Client version"),this.oit=f.Cc(r).then(function(t){var i=JSON.parse(t);return n.state=i.state,n.version=i.version,"ready"===n.state?"developer"===n.version||n.version>=n.options_.minVersion?(n.fit=Date.now(),n.logger().debug(n.id()+"Hive Client ready - version "+n.version+" ["+(n.fit-n.ait)+"]"),"ready"):(y.ErrorMonitor.getInstance().logError("Client version requirement not satisfied",n.id(),{version:n.version,minVersion:n.options_.minVersion}),n.plugin.addTechEvent(new g.XS(null,2)),o.reject(new d.HiveTechError(d.wR.VERSION_ERROR,"version "+n.version))):(y.ErrorMonitor.getInstance().logError("Cannot check version: client state not ready",n.id(),{state:n.state}),n.plugin.addTechEvent(new g.XS(null,1)),n.fit=Date.now(),n.logger().debug("[Timing] Hive Client not ready",n.fit-n.ait),o.reject(new d.HiveTechError(d.wR.NOT_READY,"state "+n.state)))},function(t){var i="Client not reachable";return null!=t&&null!=t.status&&-1!=t.status&&(i="Client check returned error"),500===t.status?(y.ErrorMonitor.getInstance().logError(i,n.id(),{error:t}),n.plugin.addTechEvent(new g.XS(null,1)),o.reject(new d.HiveTechError(d.wR.PLUGIN_ERROR,i))):(y.ErrorMonitor.getInstance().logError(i,n.id(),null!=t&&null!=t.status&&-1!=t.status?{status:t.status}:void 0),n.plugin.addTechEvent(new g.XS(null,0)),o.reject(new d.HiveTechError(d.wR.NOT_READY,i)))})["catch"](function(t){if(t instanceof d.HiveTechError)return o.reject(t);var i="Error fetching Hive Client version";return y.ErrorMonitor.getInstance().logError(i,n.id(),t),o.reject(new d.HiveTechError(d.wR.NOT_READY,i))}),this.uit=Date.now()}return this.oit},S.prototype.initSession=function(t,i){var n=this,r=this.plugin.options(),s=r.readyCheckTimeout,e=r.macReadyCheckTimeout,h=this.cit.getTimeout(s,e,this.logger());return(h&&0<h?this.isReady().timeout(h,"Client Ready check timed out after "+h+"ms"):this.isReady()).then(function(){return n.lit(t)["catch"](function(t){return o.reject(t)})})["catch"](function(t){return t instanceof Error&&(t=new d.HiveTechError(d.wR.TIMEOUT_ERROR,t.message)),o.reject(t)})},S.prototype.getInitSessionTimeout=function(){return this.options_.initTimeout},S.prototype.isActive=function(t,i){return-1<t.indexOf(i.vit)},S.prototype.closeSession=function(i,n){var r=this;this.logger().debug(this.id()+"Stopping session "+i.id+" [complete close:"+n+"]");var t="//"+E.gv.Ok+":"+this.plugin.options().playerPort+"/session?action=stop";t+="&currentSession="+i.id,n&&(t+="&completeStop=true"),n&&s.hit.sendBeacon?(s.hit.sendBeacon(t),this.logger().debug(this.id()+"session stopped ["+i.id+"][beacon]")):f.Cc(t,null,!n).then(function(){r.logger().debug(r.id()+"session stopped ["+i.id+"]"+(n?"[sync]":""))},function(t){r.logger().warn(r.id()+"session close error ["+i.id+"]"+(n?"[sync]":""),t)})},S.prototype.onStateChange=function(t,i){this.dit=i?p.Il.IDLE:p.Il.Nl,this.logger().notice("[HiveComm] client state: "+p.Il[this.dit])},S.prototype.handleStats=function(t,i){if(this.dit==p.Il.IDLE)return o.resolve(!0);var n="playing-point="+i.playingPoint;n+="&buffer-length="+i.bufferLength,n+="&total-buffering="+i.totalBuffering,n+="&width="+i.width,n+="&height="+i.height,n+="&fullscreen="+i.fullscreen;var r=t.vit+"stats?"+n;return this.logger().trace(r),f.Cc(r)},S.prototype.handleEvent=function(t,i,n){var r=this;if(!(i!==g.PlayerEvents.VISIBLE&&i!==g.PlayerEvents.HIDDEN||this.version&&("developer"===this.version||"2017"<=this.version)))return o.resolve(!0);var s=t.vit+"player-event?type="+g.PlayerEvents[i];if(null!=n)for(var e in n)n.hasOwnProperty(e)&&(s+="&"+e+"="+n[e]);return this.logger().debug(this.id()+"event "+g.PlayerEvents[i],null!=n?n:""),f.Cc(s).fail(function(t){return r.logger().warn(r.id()+"error sending feedback event to Hive Client",t),o.reject(t)})},S.prototype.handleTechEvent=function(t,i){return o.resolve(!0)},S.prototype.updatePlayerInfo=function(t){var i=this;if(this.Eit())return this.logger().warn("Player info not supported in this Java client version"),o.resolve(!0);var n="comm-version="+this.plugin.getCoreVersion();n+="&plugin-name="+this.plugin.getPluginName(),n+="&plugin-version="+this.plugin.getPluginVersion(),n+="&player-tech="+this.plugin.getPlayerTech(),n+="&player-version="+this.plugin.getPlayerVersion(),this.plugin.getTelemetryId()&&(n+="&telemetry-id="+this.plugin.getTelemetryId());var r=t.vit+"player-info?"+n;return f.Cc(r).fail(function(t){return i.logger().debug(i.id()+"error sending player Info to Hive Client",t),o.reject(t)})},S.prototype.onError=function(t){var i=!0;if(null!=this.options_.onError)try{!1===this.options_.onError(t)&&(i=!1)}catch(t){y.ErrorMonitor.getInstance().logError("Exception in user-defined onError callback",this.id(),t)}return i},S.prototype.onTechTimeout=function(t,i,n){var r={isReadyIn:this.ait,isReadyOut:this.fit,leaseIn:this.wit,leaseOut:this.pit,resolveIn:this.git,resolveOut:this.bit};void 0!==i&&null!=i&&(r.sessionId=i.id),void 0!==n&&(r.total=n);var s=JSON.parse(JSON.stringify(r));y.ErrorMonitor.getInstance().logError(t.message,this.id(),s),this.plugin.addTechEvent(new g.XS(null,5,r)),this.yit()},S.prototype.onActiveSession=function(t){if(this.updatePlayerInfo(t),h.SessionStorageUtil.setItem("hiveActiveSessionId",t.id),null!=this.options_.onActiveSession)try{this.options_.onActiveSession(t.toHiveSession())}catch(t){y.ErrorMonitor.getInstance().logError("Exception in user-defined onActiveSession callback",this.id(),t)}},S.prototype.setPlugin=function(t){this.plugin=t},S.prototype.id=function(){return"["+S.dR+"] "},S.prototype.Tit=function(t){null!=t[S.dR]&&f.updateOptions(t[S.dR],this.options_)},S.prototype.lit=function(i){var n=this,r=new Date().getTime();return this.Oit(i).then(function(t){return t?n.mit(i,t,r):n.resolveTicketPromise(i).then(function(t){return n.mit(i,t,r)})})},S.prototype.Oit=function(i){var r=this;if(this.wit=Date.now(),this.plugin.options().useSessionCheck){var n="//"+E.gv.Ok+":"+this.plugin.options().playerPort+"/session?&action=check";n+="&hivePluginId="+this.plugin.getPluginId(),n+="&callback="+encodeURIComponent(i);var t=h.SessionStorageUtil.getItem("hiveActiveSessionId");return h.SessionStorageUtil.removeItem("hiveActiveSessionId"),t&&(n+="&currentSession="+t),this._it(),this.Rit(n).then(function(t){return r.pit=Date.now(),t?r.Sit(t,n,i,r.wit):(r.logger().debug(r.id()+"session allowed ["+(r.pit-r.wit)+"]"),!1)},function(t){if(400==t.status)return r.Ait("bad request","error resolving ticket",t);if(401==t.status)return r.Ait("unauthorized","error verifying the ticket",t);if(403!=t.status)return 404==t.status?(r.logger().debug(r.id()+"installed version does not support active session check"),r.pit=Date.now(),!1):(y.ErrorMonitor.getInstance().logError("unhandled error from Java",r.id(),{error:t.status}),r.plugin.addTechEvent(new g.XS(null,4)),o.reject(new d.HiveTechError(d.wR.PLUGIN_ERROR,t)));var i=S.Iit(t,void 0,"session"),n=i?{Nit:i}:void 0;return y.ErrorMonitor.getInstance().logError("reports another active session",r.id(),n),r.plugin.addTechEvent(new g.XS(null,3,n)),o.reject(new d.HiveTechError(d.wR.SESSION_ERROR,"another active session"+(n?" ["+n.Nit+"]":"")))})["catch"](function(t){return t instanceof d.HiveTechError?o.reject(t):(y.ErrorMonitor.getInstance().logError("unhandled error on requestLeaseDirect",r.id(),{error:t}),r.plugin.addTechEvent(new g.XS(null,4)),r.pit=Date.now(),r.plugin.logger().warn("[Timing] unhandeled session request ",r.pit-r.wit),o.reject(new d.HiveTechError(d.wR.PLUGIN_ERROR,t)))})["finally"](function(){clearTimeout(r.Cit)})}return this.logger().debug(this.id()+"Hive session check disabled - will directly resolve ticket (other active sessions may fail)"),o.resolve(!1)},S.prototype.Rit=function(t){var i;if(this.plugin.options().testId){if(!("developer"!==this.version||this.version<E.gv.Ak))return f.Cc(t,void 0,!0,((i={})[w.Rc.Tk]=this.plugin.options().testId,i));this.logger().warn(this.id()+"The Hive Client Version installed does not support the test id in its generated metrics")}return f.Cc(t)},S.prototype.Ait=function(t,i,n){var r=S.Iit(n,t);return y.ErrorMonitor.getInstance().logError(i,this.id()),this.bit=Date.now(),o.reject(new d.HiveTechError(d.wR.TICKET_ERROR,r))},S.Iit=function(t,i,n){void 0===n&&(n="status");var r=i;if(t.body)try{r=JSON.parse(t.body)[n]}catch(t){}return r},S.prototype.resolveTicketPromise=function(i){var n=this;this.git=Date.now(),this.logger().debug(this.id()+"resolving ticket: "+i);var r=this.kit(i);return f.Cc(r,"application/json").then(function(t){return n.Sit(t,r,i,n.git)},function(t){return n.Dit(t,i)})["catch"](function(t){return y.ErrorMonitor.getInstance().logError("error parsing ticket response",n.id(),t),o.reject(new d.HiveTechError(d.wR.PLUGIN_ERROR,t))})},S.prototype.Dit=function(t,i){return y.ErrorMonitor.getInstance().logError("error resolving ticket",this.id(),{ticket:i}),o.reject(new d.HiveTechError(d.wR.TICKET_ERROR,t))},S.prototype.Sit=function(t,i,n,r){var s=JSON.parse(t),e=c.jit((0===i.indexOf("//")?location.protocol:"")+i,s.location);return s.version&&!this.version&&(this.version=s.version),this.bit=Date.now(),this.logger().debug(this.id()+"resolved ticket "+n+" -> "+e+" ["+(this.bit-r)+"]"),e},S.prototype.mit=function(t,i,n){var r=this.$G(t,i);if(null==r)throw new d.HiveTechError(d.wR.TICKET_ERROR,"error generating session");var s=new Date().getTime()-n;return s>=this.options_.warnSlowRespTimeout&&this.onTechTimeout(new d.HiveTechError(d.wR.TIMEOUT_ERROR,this.id()+" The tech initialization took more than "+this.options_.warnSlowRespTimeout+" milliseconds"),r,s),u.HiveRequestFactory.register(this),r},S.prototype.$G=function(t,i){var n=b.Ticket.OR(t),r=new m(t,n,i,null,this.plugin.options().onSessionStateChange);r.SDN=!0;var s=E.gv.Rk.exec(r.manifest);return null!=s?(r.vit=s[1],r.id=s[5],r):null},S.prototype.kit=function(t){var i=-1==t.indexOf("?")?"?":"&";return this.Eit()?f.Ic(E.gv._k,E.gv.Ok,this.plugin.options().playerPort,t):f.Ic(E.gv.mk,E.gv.Ok,this.plugin.options().playerPort,t,i,this.plugin.getPluginId4Java())},S.prototype._it=function(){var t=this;this.Cit&&clearTimeout(this.Cit),this.Cit=setTimeout(function(){y.ErrorMonitor.getInstance().logError("The Lease Request is taking more than "+t.options_.warnSlowRespTimeout+" secs",t.id())},this.options_.warnSlowRespTimeout)},S.prototype.yit=function(){this.wit=0,this.pit=0,this.git=0,this.bit=0},S.prototype.logger=function(){return this.plugin.logger()},S.prototype.resetTech=function(){this.yit()},S.prototype.Eit=function(){return this.options_.supportLegacyClient&&(!this.version||this.version.substr(0,4)<"2016")},S.prototype.getPluginId=function(){return this.plugin.getPluginId()},S.prototype.createManifestRequest=function(t){return new XMLHttpRequest()},S.prototype.createRequest=function(t){return new XMLHttpRequest()},S.prototype.supportsXhrInterception=function(){return!1},S.dR="HiveJava",S);function S(t,i){this.uit=0,this.plugin=t,this.options_=new v.HiveJavaOptions(),this.cit=new a.TimeoutResolver(),this.Tit(i),f.parseParameterOptions(window.location.href,new l.UrlConfigurableOptions(),this.options_)}s.HiveJava=R},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.getTimeout=function(t,i,n){return t=isNaN(t)?(n.debug("readyCheckTimeout is "+t+". Setting it to 0"),0):Number(t),i=isNaN(i)?(n.debug("macReadyCheckTimeout is "+i+". Setting it to 0"),0):Number(i),window.navigator.platform.match(/Mac/gi)&&-1<i?i:t},s);function s(){}i.TimeoutResolver=r},function(t,i,n){var r,f,s,e,c;r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,f=/^([^\/?#]*)(.*)$/,s=/(?:\/|^)\.(?=\/)/g,e=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,c={jit:function(t,i,n){if(n=n||{},t=t.trim(),!(i=i.trim())){if(!n.Mit)return t;var r=c.Pit(t);if(!r)throw new Error("Error trying to parse base URL.");return r.path=c.vE(r.path),c.Lit(r)}var s=c.Pit(i);if(!s)throw new Error("Error trying to parse relative URL.");if(s.scheme)return n.Mit?(s.path=c.vE(s.path),c.Lit(s)):i;var e=c.Pit(t);if(!e)throw new Error("Error trying to parse base URL.");if(!e.Hit&&e.path&&"/"!==e.path[0]){var h=f.exec(e.path);e.Hit=h[1],e.path=h[2]}e.Hit&&!e.path&&(e.path="/");var o={scheme:e.scheme,Hit:s.Hit,path:null,Uit:s.Uit,query:s.query,Av:s.Av};if(!s.Hit&&(o.Hit=e.Hit,"/"!==s.path[0]))if(s.path){var u=e.path,a=u.substring(0,u.lastIndexOf("/")+1)+s.path;o.path=c.vE(a)}else o.path=e.path,s.Uit||(o.Uit=e.Uit,s.query||(o.query=e.query));return null===o.path&&(o.path=n.Mit?c.vE(s.path):s.path),c.Lit(o)},Pit:function(t){var i=r.exec(t);return i?{scheme:i[1]||"",Hit:i[2]||"",path:i[3]||"",Uit:i[4]||"",query:i[5]||"",Av:i[6]||""}:null},vE:function(t){for(t=t.split("").reverse().join("").replace(s,"");t.length!==(t=t.replace(e,"")).length;);return t.split("").reverse().join("")},Lit:function(t){return t.scheme+t.Hit+t.path+t.Uit+t.query+t.Av}},t.exports=c},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(20),o=n(45),u=(e=h.HiveTechOptions,s(a,e),a);function a(){var t=null!==e&&e.apply(this,arguments)||this;return t.minVersion=o.gv.Sk,t.initTimeout=6e4,t.warnSlowRespTimeout=5e3,t.supportLegacyClient=!1,t}i.HiveJavaOptions=u},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var o,e=n(26),h=(o=e.fR,s(u,o),u.prototype.YJ=function(t,i,n){if(this.Fit&&t!==this.Fit)return o.prototype.YJ.call(this,t,i,n);if(!t[i])throw new Error(this.loggerId+" - method "+i+" is undefined in event target.")},u.prototype.registerEvent=function(t,i,n,r,s){if(t!==this.Fit)return o.prototype.registerEvent.call(this,t,i,n,r,s);var e=t[i](n,r);if(void 0===e||"function"!=typeof e.remove)throw new Error(this.loggerId+" - Missing remove method for unsubscribing '"+n+"' event");var h=e.remove;return"function"==typeof s?h:(s.IY=h,s)},u.prototype.SR=function(t){void 0===t&&(t=!1),o.prototype.SR.call(this,t),t&&(this.Fit=void 0)},u.prototype.zJ=function(t,i,n,r){if(t!==this.Fit)return o.prototype.zJ.call(this,t,i,n,r);r()},u);function u(t,i,n){var r=o.call(this,t,i,n,null)||this;return r.loggerId="[OzEventsBinder]",r.Fit=i,r}i["default"]=h},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var c=n(26),l="[HiveOzRequestImplementation]",r="0";function v(t,i,n){try{i(r,d(t),{reason:n,status:t.status,statusText:t.statusText})}catch(t){c.logError("Exception caught from Oz onFailure callback: "+t.message,l,t)}}function d(t){return t.getAllResponseHeaders()||""}i["default"]=function(t,i,n){var r=t.url,s=t.http,e=t.options,h=t.method,o=t.responseType,u=s&&s.credentials,a=e&&e.networkTimeoutMs,f=this.createXMLHttpRequest();"include"===u&&(f.withCredentials=!0),"number"==typeof a&&(f.timeout=a),f.addEventListener("load",function(){return function(t,i){try{i(t.response,function(t){return t.status+(t.statusText?": "+t.statusText:"")}(t),d(t))}catch(t){c.logError("Exception caught from Oz onSuccess callback: "+t.message,l,t)}}(f,i)}),f.addEventListener("error",function(){return v(f,n,"network error")}),f.addEventListener("timeout",function(){return v(f,n,"timeout")}),f.open(h,r),f.responseType=o,f.send()}}],g={},h.lb=f,h.c=g,h.d=function(t,i,n){h.Git(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},h.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"s",{value:!0})},h.t=function(i,t){if(1&t&&(i=h(i)),8&t)return i;if(4&t&&"object"==typeof i&&i&&i.s)return i;var n=Object.create(null);if(h.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:i}),2&t&&"string"!=typeof i)for(var r in i)h.d(n,r,function(t){return i[t]}.bind(null,r));return n},h.n=function(t){var i=t&&t.s?function(){return t["default"]}:function(){return t};return h.d(i,"a",i),i},h.Git=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},h.Bb="",h(h.Tb=114);function h(t){if(g[t])return g[t].exports;var i=g[t]={xit:t,Bit:!1,exports:{}};return f[t].call(i.exports,i,i.exports,h),i.Bit=!0,i.exports}var f,g})}),null);
__d("HiveStreamingOzSDK",["OzHiveStreaming"],(function(a,b,c,d,e,f){"use strict";f.HiveOz=b("OzHiveStreaming").HiveOz;a=window.HiveConfig;f.HiveConfig=a}),null);
__d("XVideoPermalinkController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/{vanity}/videos/{?set_token}/{video_id}/{?story_token}/",{photo_id:{type:"Int"},set_token:{type:"String"},type:{type:"Enum",defaultValue:3,enumType:0},link_share:{type:"String"},subject:{type:"Int"},object_id:{type:"Int"},opaque_cursor:{type:"String"},legacy_user_id:{type:"Int"},legacy_photo_id:{type:"Int"},video_id:{type:"Int"},comment_id:{type:"Int"},notif_t:{type:"String"},is_notification_preview:{type:"Bool",defaultValue:!1},force_theater:{type:"Bool",defaultValue:!1},story_token:{type:"String"},extid:{type:"String"},vanity:{type:"String"},__tn__:{type:"String"},t:{type:"Int"},flite:{type:"String"},__so__:{type:"Enum",enumType:1},__rv__:{type:"Enum",enumType:1},redirect:{type:"Bool",defaultValue:!0},depth:{type:"Int"},reply_comment_id:{type:"Int"},privacy_mutation_token:{type:"String"}})}),null);
__d("VideoComposerVideoPublishingMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],b=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"VideoPublishResponsePayload",kind:"LinkedField",name:"video_publish",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"video_asset_id",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"VideoComposerVideoPublishingMutation",selections:b,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"VideoComposerVideoPublishingMutation",selections:b},params:{id:"2794099187357617",metadata:{},name:"VideoComposerVideoPublishingMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("BandicootSession",[],(function(a,b,c,d,e,f){"use strict";f.isValidSession=a;f.isTrackedSession=b;f.isCrashedSession=c;f.isOrphanSession=d;var g=Object.freeze({ACTIVE:"ACTIVE",INACTIVE:"INACTIVE",CLOSED:"CLOSED"});f.Status=g;var h=10*60*1e3,i=14*24*60*60*1e3;function j(a){return Date.now()-a.lastUpdated}function a(a){return!!(typeof a==="object"&&a&&a.lastUpdated&&a.status)}function b(a){if(a.status===g.CLOSED)return!1;else if(a.status===g.INACTIVE&&j(a)>h)return!1;return!0}function c(a){return a.status===g.ACTIVE&&j(a)>h}function d(a){return j(a)>i}}),null);
__d("Bandicoot",["invariant","BandicootSession","FBLogger"],(function(a,b,c,d,e,f,g){"use strict";var h=5*1e3,i=h*2,j="Bandicoot:";function a(){try{var a=window.localStorage;if(a){var c="__test"+Date.now();a.setItem(c,"");a.removeItem(c)}return a}catch(a){b("FBLogger")("bandicoot").warn("Local storage is full");return null}}var k=a();c=function(){function a(a){this.$5=j+a,this.$4={},this.$1=this.$7.bind(this),this.sessionID=null,this.sessionStartTime=null,this.storage=k}var c=a.prototype;c.getCrashTimeData=function(){var a=window.performance&&window.performance.memory||{},b=this.sessionStartTime;return{duration:b?Date.now()-b:0,tabs:Object.keys(this.$8()).length,jsHeapSizeLimit:a.jsHeapSizeLimit,totalJSHeapSize:a.totalJSHeapSize,usedJSHeapSize:a.usedJSHeapSize,elementsInDOM:document.getElementsByTagName("*").length,uri:window.location.href}};c.getLogTimeData=function(){return{userAgent:window.navigator.userAgent}};c.logCrash=function(a,c,d){b("FBLogger")("bandicoot").warn("Session %s crashed at %s",a,d)};c.logBrowserUnsupported=function(){b("FBLogger")("bandicoot").warn("Browser not supported")};c.logTrackingError=function(){b("FBLogger")("bandicoot").warn("Failed to record data for current session")};c.startSession=function(){var a=this;if(!this.storage){this.logBrowserUnsupported();return}if(this.$2)return;this.sessionID||(this.sessionID=Math.random().toString(36).slice(2,9));this.sessionStartTime||(this.sessionStartTime=Date.now());this.$2=setInterval(function(){a.$9()},h);this.$9();document.addEventListener&&document.addEventListener("visibilitychange",this.$1);this.$10()};c.endSession=function(){if(!this.storage)return;if(!this.$2)return;clearInterval(this.$2);this.$2=null;this.$3||this.$11({status:b("BandicootSession").Status.CLOSED});this.sessionID=null;this.sessionStartTime=null;document.removeEventListener&&document.removeEventListener("visibilitychange",this.$1)};c.logKnownCrashes=function(){var a=this;if(!this.storage)return;if(!this.$2){var c=this.$8();c=this.$12(c,function(c,d){if(b("BandicootSession").isCrashedSession(c)){a.logCrash(d,c,a.getLogTimeData());return null}else return c});this.$13(c)}};c.$14=function(){var a=this.sessionID;a||g(0,663);return a};c.$9=function(){var a=this.$8();this.$15(a);a=this.$16(a);this.$13(a)};c.$15=function(a){var b=this.$14(),c=a[b]?a[b]:{};a[b]=babelHelpers["extends"]({},c,this.getCrashTimeData(),{lastUpdated:Date.now(),status:this.$17()})};c.$12=function(a,c){var d={};Object.keys(a).forEach(function(e){var f=a[e];if(b("BandicootSession").isValidSession(f)&&b("BandicootSession").isTrackedSession(f)&&!b("BandicootSession").isOrphanSession(f)){f=c(f,e);f&&(d[e]=f)}});return d};c.$16=function(a){var c=this;return this.$12(a,function(a,d){if(b("BandicootSession").isCrashedSession(a)){var e=a.loggerReportTime||0;if(Date.now()-e>i)a.loggerReportTime=Date.now(),a.loggerReportSession=c.$14();else if(a.loggerReportSession==c.$14()){c.logCrash(d,a,c.getLogTimeData());c.$4[d]=!0;return null}}return a})};c.$8=function(a){a=a||this.$5;var c=this.storage.getItem(a)||"{}";try{c=JSON.parse(c)}catch(d){c={},this.storage.removeItem(a),b("FBLogger")("bandicoot").catching(d).warn("Invalid JSON data")}return c};c.$11=function(a){a.lastUpdated=Date.now();var b=this.$8(),c=this.sessionID;c&&b[c]&&(Object.assign(b[c],a),this.$13(b))};c.$13=function(a){a=JSON.stringify(a);try{this.storage.setItem(this.$5,a)}catch(d){a=this.$6;var c=Date.now();(!a||c>a+h)&&(this.logTrackingError(),this.$6=c);try{this.storage.removeItem(this.$5)}catch(a){this.$3=!0,this.endSession(),b("FBLogger")("bandicoot").catching(a).warn("Removing from storage failed")}}};c.$10=function(){for(var a=0;a<this.storage.length;++a){var c=this.storage.key(a);if(c.indexOf(j)===0&&c!==this.$5){var d=this.$8(c),e=Object.keys(d).every(function(a){a=d[a];return!b("BandicootSession").isValidSession(a)||b("BandicootSession").isOrphanSession(a)});e&&this.storage.removeItem(c)}}};c.$7=function(){this.$11({status:this.$17()})};c.$17=function(){return document.hidden?b("BandicootSession").Status.INACTIVE:b("BandicootSession").Status.ACTIVE};return a}();e.exports=c}),null);
__d("FileHasher",["WebWorker","emptyFunction","fileSliceName","FileHashWorkerResource"],(function(a,b,c,d,e,f){a=function(){"use strict";a.isSupported=function(){return b("WebWorker").isSupported()};function a(){var a=this,c=b("FileHashWorkerResource");b("WebWorker").prepareResource(c);this.$1=new(b("WebWorker"))(c).setMessageHandler(function(b){a.$2(b)}).execute()}var c=a.prototype;c.hash=function(a,c){this.$2=c;this.$1.postMessage({file:a,fileSliceName:b("fileSliceName")});return this};c.destroy=function(){this.$2=b("emptyFunction"),this.$1.terminate()};return a}();e.exports=a}),null);
__d("mediaUploadLogStackTrace",["Banzai","ErrorNormalizeUtils","err","gkx","requireCond","cr:1840657"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a){if(b("gkx")("1816889")){var c=b("ErrorNormalizeUtils").normalizeError(b("err")("no-op"));c=c.stack;c={event:"upload.client.media_debug_info",waterfall_id:a.waterfallID,source:a.sourceType,composer_entry_point_ref:a.composerEntryPointRef,error_trace:c,application_state:a.applicationState};b("cr:1840657")!=null?b("cr:1840657")(c):b("Banzai").post("video_waterfall",c,b("Banzai").VITAL)}}}),null);
__d("FBSphericalMetadataTags",[],(function(a,b,c,d,e,f){a=Object.freeze({SPHERICAL:"FBSpherical:Spherical",INITIAL_VERTICAL_FOV_DEGREES:"FBSpherical:InitialVerticalFOVDegrees",GUIDE:"FBSpherical:Guide",HOTSPOT:"FBSpherical:HotspotMetadata",USED_360_DIRECTOR:"FBSpherical:Used360Director"});e.exports=a}),null);
__d("GSphericalMetadataTags",[],(function(a,b,c,d,e,f){a=Object.freeze({SPHERICAL:"GSpherical:Spherical",INITIAL_VIEW_HEADING_DEGREES:"GSpherical:InitialViewHeadingDegrees",INITIAL_VIEW_PITCH_DEGREES:"GSpherical:InitialViewPitchDegrees",PROJECTION_TYPE:"GSpherical:ProjectionType",STEREO_MODE:"GSpherical:StereoMode",STITCHED:"GSpherical:Stitched",STITCHING_SOFTWARE:"GSpherical:StitchingSoftware",CROPPED_AREA_IMAGE_WIDTH_PIXELS:"GSphercal:CroppedAreaImageWidthPixels",CROPPED_AREA_IMAGE_HEIGHT_PIXELS:"GSphercal:CroppedAreaImageHeightPixels",CROPPED_AREA_LEFT_PIXELS:"GSphercal:CroppedAreaLeftPixels",CROPPED_AREA_TOP_PIXELS:"GSphercal:CroppedAreaTopPixels",FULL_PANO_WIDTH_PIXELS:"GSphercal:FullPanoWidthPixels",FULL_PANO_HEIGHT_PIXELS:"GSphercal:FullPanoHeightPixels"});e.exports=a}),null);
__d("SphericalVideoMetadataTags",["FBSphericalMetadataTags","GSphericalMetadataTags"],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({GSPHERICAL:b("GSphericalMetadataTags"),FBSPHERICAL:b("FBSphericalMetadataTags")});e.exports=a}),null);
__d("ResumableUploadAsyncService",["regeneratorRuntime","Promise","AsyncRequest","EventEmitter","ResumableUploadServiceState.enum","URI","gkx","uuid"],(function(a,b,c,d,e,f){"use strict";var g,h="rupload",i="facebook.com";a=function(a){babelHelpers.inheritsLoose(c,a);function c(c,d,e,f,g,j,k,l,m,n){var o;o=a.call(this)||this;o.consumer=c;o.accessToken=d;o.sessionKey=e||b("uuid")();o.contentKey=f||"";o.contentValue=g||"";o.serviceName=j&&j!=""?j:h;o.serviceDomain=k&&k!=""?k:i;o.receiveParameters=l;o.flowCaptureHeaderValue=m;o.tracingHeaderValue=n;return o}c.create=function(a){return new c(a.consumer,a.accessToken,a.sessionKey||"",a.contentKey,a.contentValue,a.serviceName,a.serviceDomain,a.receiveParameters,a.flowCaptureHeaderValue,a.tracingHeaderValue)};var d=c.prototype;d.$ResumableUploadService1=function(a){if(b("gkx")("1765373")){var c;if(((c=this.receiveParameters)==null?void 0:c.target_id)!=null){a.setRequestHeader("target_id",String((c=this.receiveParameters)==null?void 0:c.target_id))}if(((c=this.receiveParameters)==null?void 0:c.video_waterfall_id)!=null){a.setRequestHeader("x_fb_video_waterfall_id",String((c=this.receiveParameters)==null?void 0:c.video_waterfall_id))}}};d.resume=function(a){var c,d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0;e.next=3;return b("regeneratorRuntime").awrap(this.sendOffsetRequest());case 3:c=e.sent;this.emit(b("ResumableUploadServiceState.enum").START,{offset:c.offset});e.next=7;return b("regeneratorRuntime").awrap(this.sendUploadRequest(a,c));case 7:d=e.sent;this.emit(b("ResumableUploadServiceState.enum").SUCCESS,d.h);e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),this.emit(b("ResumableUploadServiceState.enum").FAIL,e.t0);case 14:this.abortUpload=void 0;case 15:case"end":return e.stop()}},null,this,[[0,11]])};d.cancel=function(){this.abortUpload&&this.abortUpload(),this.emit(b("ResumableUploadServiceState.enum").CANCEL)};d.decorateRequestFlowCaptureHeader=function(a){this.flowCaptureHeaderValue&&a.setRequestHeader("X-Fb-Flow-Capture",String(this.flowCaptureHeaderValue))};d.sendOffsetRequest=function(){var a=this;return new(b("Promise"))(function(c,d){var e=new(b("AsyncRequest"))().setAllowCrossOrigin(!0).setAllowCredentials(!0).setMethod("GET").setURI(a.getUploadUri()).setReadOnly(!0).setRequestHeader("Authorization","OAuth "+a.accessToken).setHandler(function(a){return c(JSON.parse(a.payload.response))}).setErrorHandler(d).setOption("suppressEvaluation",!0).setTransportErrorHandler(function(c){a.emit(b("ResumableUploadServiceState.enum").TRANSPORT_FAILURE,c)});a.$ResumableUploadService1(e);a.decorateRequestFlowCaptureHeader(e);a.abortUpload=function(){return e.abort()};e.send()})};d.sendUploadRequest=function(a,c){var d=this;c=c||{};var e=c.offset;c=c.duplicate;var f=c?"":a.slice(e);return new(b("Promise"))(function(c,g){var h=new(b("AsyncRequest"))().setAllowCrossOrigin(!0).setAllowCredentials(!0).setURI(d.getUploadUri()).setRawData(f).setHandler(function(a){return c(JSON.parse(a.payload.response))}).setErrorHandler(g).setRequestHeader("Authorization","OAuth "+d.accessToken).setRequestHeader("X-Entity-Name",encodeURIComponent(a.name)).setRequestHeader("X-Entity-Type",a.type).setRequestHeader("X-Entity-Length",String(a.size)).setRequestHeader("Offset",String(e)).setOption("suppressEvaluation",!0).setUploadProgressHandler(function(c){c=new ProgressEvent("upload-service",{total:a.size,loaded:c.loaded+Number(e)});d.emit(b("ResumableUploadServiceState.enum").PROGRESS,c)}).setTransportErrorHandler(function(a){d.emit(b("ResumableUploadServiceState.enum").TRANSPORT_FAILURE,a)});d.$ResumableUploadService1(h);d.decorateRequestFlowCaptureHeader(h);d.abortUpload=function(){return h.abort()};g=d.receiveParameters;g&&(h.setRequestHeader("start_offset",String(g.start_offset)).setRequestHeader("end_offset",String(g.end_offset)).setRequestHeader("composer_session_id",String(g.composer_session_id)).setRequestHeader("id",String(g.upload_session_id)),g.fb_region&&h.setRequestHeader("X-FB-Region",String(g.fb_region)));d.tracingHeaderValue&&h.setRequestHeader("x-fb-product-log",d.tracingHeaderValue);h.send()})};d.getUploadUri=function(){var a=this.getServiceName();a=new(g||(g=b("URI")))("https://"+a+"/"+this.consumer+"/"+this.sessionKey);this.contentKey&&this.contentValue&&(a=a.addQueryData(this.contentKey,this.contentValue));return a};d.getServiceName=function(){return this.serviceName+"."+this.serviceDomain};return c}(b("EventEmitter"));e.exports=a}),null);
__d("GraphQLVideoPublishUtils",["gkx","immutable"],(function(a,b,c,d,e,f){"use strict";f.isGraphQLPublish=a;function a(a,c,d,e){if(d&&!b("gkx")("1797557"))return!1;if(e&&!b("gkx")("1827276"))return!1;d=b("immutable").List(["cs_ab_testing_video_upload","cs_content_library","cs_content_library_bulk_upload","cs_content_library_upload_videos","cs_content_show_episode_upload","cs_global_basic_post","cs_global_bulk_upload","cs_global_multipost","cs_global_upload_video","cs_home_basic_post","cs_home_bulk_video","cs_home_upload_video","cs_home_multipost","cs_instagram_content_library","media_manager","pages_composer_bulk_upload_upsell","page_content_tab_drafts","page_content_tab_published_posts_opted_out","page_content_tab_scheduled_posts_opted_out","page_content_tab_video_library","page_content_tab_video_library_premiere","pages_posts","pages_video_tab","timeline","video_page_video_list"]);e=b("gkx")("1787006")?d.contains(c)||b("gkx")("1809100")&&c==="pages_feed_video_composer":!0;return b("gkx")("1687206")&&(a==="composer"||a==="media_manager_instagram_video_composer")&&e}}),null);
__d("GraphQLVideoPublisherInputDataHandlerBase",["invariant","gkx"],(function(a,b,c,d,e,f,g){"use strict";f.hasAPISupport=h;a=function(){function a(a,b){this.postData=a,this.extraData=b}var b=a.prototype;b.mapPostDataToGraphQLInputObject=function(){g(0,85)};b.hasAPISupport=function(){return h(this.postData)};b.uploadables=function(){g(0,85)};return a}();f.GraphQLVideoPublisherInputDataHandlerBase=a;function h(a){return b("gkx")("1687206")}}),null);
__d("BrandedContentSharedToSponsorStatus",[],(function(a,b,c,d,e,f){a=Object.freeze({NOT_SHARED:0,ALL_SHARED:1});e.exports=a}),null);
__d("ExpirationType",[],(function(a,b,c,d,e,f){a=Object.freeze({NONE:0,DELETE:1,HIDE:2,ONLY_ME:3});e.exports=a}),null);
__d("VideoAssetMatureContentRating",[],(function(a,b,c,d,e,f){a=Object.freeze({UNSET:0,SUITABLE_FOR_ALL:1,FOURTEEN_PLUS:2,EIGHTEEN_PLUS:3});e.exports=a}),null);
__d("VideoCommentatingPermission",[],(function(a,b,c,d,e,f){a=Object.freeze({UNSET:"unset",ALLOW:"allow",DISALLOW:"disallow"});e.exports=a}),null);
__d("VideoFundedContentFlagProgram",[],(function(a,b,c,d,e,f){a=Object.freeze({UNSET:0,IS_FUNDED_CONTENT:1,NOT_FUNDED_CONTENT:2});e.exports=a}),null);
__d("VideoStereoFormat",[],(function(a,b,c,d,e,f){a=Object.freeze({MONO:"mono",LEFT_RIGHT:"left-right",TOP_BOTTOM:"top-bottom"});e.exports=a}),null);
__d("GraphQLVideoPublisherVideoUploaderInputDataHandler",["BrandedContentSharedToSponsorStatus","BrandedContentSponsorRelationship","CallToActionTypes","ClientIDs","ExpirationType","GraphQLVideoPublisherInputDataHandlerBase","VideoAssetMatureContentRating","VideoCommentatingPermission","VideoFundedContentFlagProgram","VideoProjection","VideoStereoFormat","enumUtils","gkx"],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.mapPostDataToGraphQLInputObject=function(){var a=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler1(),c=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler2(),d=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler3(),e=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler4(),f=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler5(),g=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler6(),h=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler7(),i=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler8(),j=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler9(),k=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler10(),l=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler11(),m=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler12(),n=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler13(),o=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler14(),p=this.$GraphQLVideoPublisherVideoUploaderInputDataHandler15();return{actor_id:this.extraData.target_id,basic_data:a,client_mutation_id:b("ClientIDs").getNewClientID(),thumbnail_data:c,ad_break_data:e,auto_reframe_data:j,post_status_data:d,main_composer_tab_data:f,distribution_data:g,stars_data:h,metadata_data:i,questions_data:k,polls_data:l,tracking_data:m,captions_data:n,spherical_data:o,live_premiere_data:p,video_editor_config_json:this.postData.video_editor_config_json}};d.uploadables=function(){return babelHelpers["extends"]({},this.$GraphQLVideoPublisherVideoUploaderInputDataHandler16(),this.$GraphQLVideoPublisherVideoUploaderInputDataHandler17(),this.$GraphQLVideoPublisherVideoUploaderInputDataHandler18())};d.$GraphQLVideoPublisherVideoUploaderInputDataHandler1=function(){var a;return{source:this.extraData.source,target_id:this.extraData.target_id,video_id:this.extraData.video_id,video_title:this.postData.video_title,waterfall_id:this.extraData.waterfall_id,xhpc_message:this.postData.xhpc_message,creator_product:(a=this.extraData.creator_product)==null?void 0:a.toString(),composer_entry_point_ref:this.extraData.composer_entry_point_ref,composer_dialog_version:this.extraData.composer_dialog_version,has_file_been_replaced:this.extraData.has_file_been_replaced,supports_chunking:this.extraData.supports_chunking}};d.$GraphQLVideoPublisherVideoUploaderInputDataHandler2=function(){return{thumbnail_type:this.postData.thumbnail_type}};d.$GraphQLVideoPublisherVideoUploaderInputDataHandler17=function(){return this.postData.thumbnail_uploadable};d.$GraphQLVideoPublisherVideoUploaderInputDataHandler18=function(){var a={},b=this.postData.schedule_custom_background_image,c=this.postData.schedule_custom_profile_image,d=this.postData.schedule_feed_background_image;b!=null&&(a.schedule_custom_background_image=b);c!=null&&(a.schedule_custom_profile_image=c);d!=null&&(a.schedule_feed_background_image=d);return a};d.$GraphQLVideoPublisherVideoUploaderInputDataHandler4=function(){if(b("gkx")("1845167")){var a;a=(a=this.postData.ad_breaks)==null?void 0:a.map(function(a){return{time_offset:parseInt(a.time_offset,10),status:a.status}})}else a=this.postData.ad_breaks;return{ad_breaks:a,ad_break_prereview:this.postData.ad_break_prereview,ad_breaks_experiment_revenue_loss_threshold:this.postData.ad_breaks_experiment_revenue_loss_threshold,enable_ad_breaks_experiment:this.postData.enable_ad_breaks_experiment,ad_breaks_block_lists:this.postData.ad_breaks_block_lists,has_ad_breaks_block_lists:this.postData.has_ad_breaks_block_lists,is_in_stream_enabled:this.postData.is_in_stream_enabled,self_cert_answers:this.postData.self_cert_answers,should_auto_adjust_manual_ad_breaks:this.postData.should_auto_adjust_manual_ad_breaks,should_auto_insert_ad_breaks:this.postData.should_auto_insert_ad_breaks,should_use_image_ads:this.postData.should_use_image_ads}};d.$GraphQLVideoPublisherVideoUploaderInputDataHandler3=function(){return{dogfooding:this.postData.dogfooding,draft:this.postData.draft,is_reviewable_branded_content:this.postData.is_reviewable_branded_content,scheduled:this.postData.scheduled,future_date:this.postData.future_date,future_time:this.postData.future_time,expiring:this.postData.expiring,expire_type:this.postData.expire_type!=null?b("enumUtils").enumValueToKeyEnforcing(this.postData.expire_type,b("ExpirationType")):null,expire_time:this.postData.expire_time,backdated_date:this.postData.backdated_date,hide_from_newsfeed:this.postData.hide_from_newsfeed}};d.$GraphQLVideoPublisherVideoUploaderInputDataHandler19=function(){var a=this.postData.branded_content_data;if(a==null)return null;var c=a.tagging_data;c!=null&&(c=babelHelpers["extends"]({},c,{shared_to_sponsor_status:c.shared_to_sponsor_status!=null?b("enumUtils").enumValueToKeyEnforcing(c.shared_to_sponsor_status,b("BrandedContentSharedToSponsorStatus")):null,sponsor_relationship:c.sponsor_relationship!=null?b("enumUtils").enumValueToKeyEnforcing(c.sponsor_relationship,b("BrandedContentSponsorRelationship")):null}));return babelHelpers["extends"]({},a,{tagging_data:c})};d.$GraphQLVideoPublisherVideoUploaderInputDataHandler5=function(){return{action_type_id:this.postData.action_type_id,branded_content_data:this.$GraphQLVideoPublisherVideoUploaderInputDataHandler19(),composertags_place_name:this.postData.composertags_place_name,composertags_place:this.postData.composertags_place,composertags_product_items:this.postData.composertags_product_items,composertags_sponsor:this.postData.composertags_sponsor,composertags_with:this.postData.composertags_with,content_tags:this.postData.content_tags,cta_type:this.postData.cta_type!=null?b("enumUtils").enumValueToKeyEnforcing(this.postData.cta_type,b("CallToActionTypes")):null,deal_id:this.postData.deal_id,direct_share_status:this.postData.direct_share_status!=null?b("enumUtils").enumValueToKeyEnforcing(this.postData.direct_share_status,b("BrandedContentSharedToSponsorStatus")):null,episode_data_json:this.postData.episode_data_json,external_movie_data:this.postData.external_movie_data,feed_targeted_data:this.$GraphQLVideoPublisherVideoUploaderInputDataHandler20(),fan_funding_promotion_metadata:this.postData.fan_funding_promotion_metadata,free_form_tags:this.postData.free_form_tags,funded_content_program:this.postData.funded_content_program?b("enumUtils").enumValueToKeyEnforcing(this.postData.funded_content_program,b("VideoFundedContentFlagProgram")):null,fundraiser_for_story_charity_id:this.postData.fundraiser_for_story_charity_id,fundraiser_for_story_charity_type:this.postData.fundraiser_for_story_charity_type,game_id:this.postData.game_id,icon_id:this.postData.icon_id,is_explicitly_tagged_as_gaming_video:this.postData.is_explicitly_tagged_as_gaming_video,is_rewards_enabled:this.postData.is_rewards_enabled,is_stars_enabled_for_post:this.postData.is_stars_enabled_for_post,multilingual_specified_lang:this.postData.multilingual_specified_lang,multilingual_status_langs:this.postData.multilingual_status_langs,multilingual_statuses:this.postData.multilingual_statuses,object_id:this.postData.object_id,object_str:this.postData.object_str,playlistIDs:this.postData.playlistIDs,share_to_parent_page_option_selected:this.postData.share_to_parent_page_option_selected,sponsor_relationship:this.postData.sponsor_relationship?b("enumUtils").enumValueToKeyEnforcing(this.postData.sponsor_relationship,b("BrandedContentSponsorRelationship")):null,targeted_privacy_data:JSON.stringify(this.postData.targeted_privacy_data)}};d.$GraphQLVideoPublisherVideoUploaderInputDataHandler20=function(){var a=babelHelpers["extends"]({},this.postData.feed_targeted_data);this.postData.relevant_until_date!=null&&(a["relevant-until-date"]=this.postData.relevant_until_date);this.postData.relevant_until_time!=null&&(a["relevant-until-time"]=this.postData.relevant_until_time);Object.keys(a).length===0&&(a=void 0);return JSON.stringify(a)};d.$GraphQLVideoPublisherVideoUploaderInputDataHandler6=function(){return{commentating_permission:this.postData.commentating_permission!=null?b("enumUtils").enumValueToKeyEnforcing(this.postData.commentating_permission,b("VideoCommentatingPermission")):null,crossposting_config:this.postData.crossposting_config,disturbing:this.postData.disturbing,embeddable:this.postData.embeddable,enable_drm:this.postData.enable_drm,exclude_from_watch:this.postData.exclude_from_watch,mature_content_rating:this.postData.mature_content_rating!=null?b("enumUtils").enumValueToKeyEnforcing(this.postData.mature_content_rating,b("VideoAssetMatureContentRating")):null,no_story:this.postData.no_story,secret:this.postData.secret,shows_v2_episode_data:this.postData.shows_v2_episode_data,social_actions:this.postData.social_actions}};d.$GraphQLVideoPublisherVideoUploaderInputDataHandler7=function(){return{is_receiving_stars_enabled:this.postData.is_receiving_stars_enabled,stars_goal_id:this.postData.stars_goal_id,stars_cue_trigger_timestamp:this.postData.stars_cue_trigger_timestamp}};d.$GraphQLVideoPublisherVideoUploaderInputDataHandler12=function(){return{custom_labels:this.postData.custom_labels,external_video_id:this.postData.external_video_id}};d.$GraphQLVideoPublisherVideoUploaderInputDataHandler10=function(){return{questions:this.postData.questions}};d.$GraphQLVideoPublisherVideoUploaderInputDataHandler11=function(){return{polls:this.postData.polls}};d.$GraphQLVideoPublisherVideoUploaderInputDataHandler21=function(a){return a.getIsDefault()?"captions_default":"captions_file"};d.$GraphQLVideoPublisherVideoUploaderInputDataHandler13=function(){var a,b=this;a=(a=this.postData.captions)==null?void 0:a.map(function(a,c){return b.$GraphQLVideoPublisherVideoUploaderInputDataHandler21(a)+c});return{autopublish_captions:this.postData.autopublish_captions,captions:a,should_review_all_captions:this.postData.should_review_all_captions,spoken_locale:this.postData.spoken_locale}};d.$GraphQLVideoPublisherVideoUploaderInputDataHandler16=function(){var a,b=this,c={};(a=this.postData.captions)==null?void 0:a.forEach(function(a,d){c[b.$GraphQLVideoPublisherVideoUploaderInputDataHandler21(a)+d]=a.getFile()});return c};d.$GraphQLVideoPublisherVideoUploaderInputDataHandler8=function(){return{is_vu_experiment_eligible:this.postData.is_vu_experiment_eligible}};d.$GraphQLVideoPublisherVideoUploaderInputDataHandler9=function(){return{aspect_ratios:this.postData.aspect_ratios,auto_reframe_publish_mode:this.postData.auto_reframe_publish_mode}};d.$GraphQLVideoPublisherVideoUploaderInputDataHandler14=function(){return{initialHeading:this.postData.initialHeading,initialPitch:this.postData.initialPitch,fov:this.postData.fov,guide_enabled:this.postData.guide_enabled,guide_keyframes:this.postData.guide_keyframes,enable_omnistab:this.postData.enable_omnistab,spherical:this.postData.spherical,projection:this.postData.projection!=null?b("enumUtils").enumValueToKeyEnforcing(this.postData.projection,b("VideoProjection")):null,stereoMode:this.postData.stereoMode!=null?b("enumUtils").enumValueToKeyEnforcing(this.postData.stereoMode,b("VideoStereoFormat")):null}};d.$GraphQLVideoPublisherVideoUploaderInputDataHandler15=function(){return{premiere_time_ms:this.postData.premiere_time_ms,should_premiere:this.postData.should_premiere,premiere_in_living_room_video_ids:this.postData.premiere_in_living_room_video_ids,premiere_custom_profile_image_focus:this.postData.premiere_custom_profile_image_focus,feed_background_focus:this.postData.feed_background_focus,premiere_audience:this.postData.premiere_audience}};return c}(b("GraphQLVideoPublisherInputDataHandlerBase").GraphQLVideoPublisherInputDataHandlerBase);e.exports=a}),null);
__d("VideoComposerVideoPublishingMutation",["RelayAPIConfig","RelayModern","RelayRuntime","VideoComposerVideoPublishingMutation.graphql"],(function(a,b,c,d,e,f){"use strict";f.commit=a;var g,h=b("RelayRuntime").commitMutation,i=1e3*90,j=g!==void 0?g:g=b("VideoComposerVideoPublishingMutation.graphql");function a(a,c,d,e,f){var g=b("RelayAPIConfig").fetchTimeout;b("RelayAPIConfig").fetchTimeout=i;return h(c,{uploadables:d,mutation:j,variables:{input:a},onCompleted:function(a){b("RelayAPIConfig").fetchTimeout=g,e(a)},onError:function(a){b("RelayAPIConfig").fetchTimeout=g,f(a)}})}}),null);
__d("VideoComposerVideoPublisher",["RelayFBEnvironmentFactory","VideoComposerVideoPublishingMutation","err"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a.mapPostDataToGraphQLInputObject(),this.$3=a.hasAPISupport(),this.$2=a.uploadables()}var c=a.prototype;c.publish=function(a,c){if(!this.$3)throw b("err")("This api does not support your publishing use case");b("VideoComposerVideoPublishingMutation").commit(this.$1,b("RelayFBEnvironmentFactory").getForActorID(this.$1.basic_data.target_id),this.$2,a,c)};return a}();e.exports=a}),null);
__d("VideoUploadSphericalLogger",["Banzai"],(function(a,b,c,d,e,f){var g=3e3;a=function(){function a(){this.$1={},this.$2=!1,this.$3=0}var c=a.prototype;c.log=function(){this.$2?this.$4():this.$5()};c.$5=function(){b("Banzai").post("spherical_video_composer_upload",babelHelpers["extends"]({},this.$1))};c.$4=function(){var a=Date.now();a-this.$3>g&&(this.$3=a,this.$5())};c.setDirectorsCutEnabled=function(a){this.$1.directors_cut_enabled=a;return this};c.setFieldOfView=function(a){this.$1.field_of_view=a;return this};c.setFileExtension=function(a){this.$1.file_extension=a;return this};c.setHasSphericalMetadata=function(a){this.$1.has_spherical_metadata=a;return this};c.setPitchDegrees=function(a){this.$1.pitch_degrees=a;return this};c.setTargetID=function(a){this.$1.target_id=a;return this};c.setVideoID=function(a){this.$1.video_id=a;return this};c.setUserAction=function(a){this.$1.user_action=a;a==="drag_video_preview"||a==="scroll_video_preview"?this.$2=!0:this.$2=!1;return this};c.setVideoPreviewPosition=function(a){this.$1.video_preview_position=a;return this};c.setYawDegrees=function(a){this.$1.yaw_degrees=a;return this};c.setIsRedesign=function(a){this.$1.is_redesign=a;return this};c.setFinalGuideEnabled=function(a){this.$1.final_guide_enabled=a;return this};c.setFinalNumGuidePoints=function(a){this.$1.final_num_guide_points=a;return this};c.setIsNuxTest=function(a){this.$1.is_nux_test=a;return this};return a}();c=new a();e.exports=c}),null);
__d("VideoUploadCallbacksMixin",[],(function(a,b,c,d,e,f){"use strict";function g(a){return Array.isArray(a)?a:[a]}a={inform:function(a,b){var c=this.__callbacksByType;if(c==null)return;a=g(a);a.forEach(function(a){var d=c[a];if(d==null)return;d.forEach(function(c){try{c(a,b)}catch(a){}})})},subscribe:function(a,b){var c,d=this.__callbacksByType=(c=this.__callbacksByType)!=null?c:{},e=g(a);e.forEach(function(a){a=d[a]=(a=d[a])!=null?a:[];a.push(b)});var f=!1;return{remove:function(){if(f===!0)return;f=!0;e.forEach(function(a){var c=d[a];if(c==null)return;var e=c.indexOf(b);e!==-1&&c.splice(e,1);c.length===0&&delete d[a]})}}}};e.exports=a}),null);
__d("VideoUploadCrashMonitor",["Bandicoot","VideoUploadLogger"],(function(a,b,c,d,e,f){a=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(b,c,d,e,f,g,h,i){var j;j=a.call(this,"VideoUploadSession")||this;j.$VideoUploadCrashMonitor1={waterfallID:b,actorID:c,source:d,targetID:e,loggingDelay:f,supportsChunking:g,composerEntryPointRef:h,flowStarted:i};return j}var d=c.prototype;d.flowStarted=function(){this.$VideoUploadCrashMonitor1.flowStarted=!0};d.getCrashTimeData=function(){return this.$VideoUploadCrashMonitor1};d.logCrash=function(a,c,d){if(!c.waterfallID)return;a=new(b("VideoUploadLogger"))({actor_id:c.actorID,source:c.source,waterfall_id:c.waterfallID,target_id:c.targetID,delay:c.loggingDelay,is_chunked_upload:c.supportsChunking,composer_entry_point_ref:c.composerEntryPointRef});d={error:"Crash Detected",error_description:"Detected video upload did not complete due to a crash"};a.logEvent(b("VideoUploadLogger").EVENT_FAILED_UPLOADING,d);c.flowStarted&&a.logEvent(b("VideoUploadLogger").EVENT_RESIGNED_FLOW,{})};return c}(b("Bandicoot"));e.exports=a}),null);
__d("VideoUploadFileValidator",["errorCode","fbt","requireCond","cr:909496","cr:909497","React"],(function(a,b,c,d,e,f,g,h){var i=b("React"),j=[1363019,1363020,1363021,1363022,1363023,1363024,1363025,1363026,1363027,1363030,1363031,1363032,1363033,1363038,1363039,1363040,1363048],k=["VIDEO__INVALID_GUIDE_DATA"];a=function(){"use strict";function a(a){this.$1=a}var c=a.prototype;c.validate=function(a,b){return this.$2(a)&&this.$3(a)&&this.$4(a.getExtension()==="gif",b)};c.getValidationErrorMessage=function(a,b){return this.$5(a)||this.$6(a)||this.$7(a.getExtension()==="gif",b)};a.canReplaceVideoForError=function(a){if(!a)return!0;if(k.indexOf(a)>-1)return!1;return j.indexOf(a)>-1?!0:!1};c.$2=function(a){a=this.$5(a);if(a){b("cr:909496")!==null&&b("cr:909496").show(a.summary,a.description);return!1}else return!0};c.$5=function(a){if(this.$1.extensions[a.getExtension()])return;a="http://www.facebook.com/help/?faq=218673814818907#What-formats-of-video-files-can-I-upload?";a=i.jsx(b("cr:909497"),{target:"_blank",href:a,children:h._("formatos recomendados")});return{summary:h._("Formato de archivo no compatible"),description:h._("No admitimos el formato del archivo que seleccionaste. Usa uno de nuestros {link} para archivos de video.",[h._param("link",a)])}};c.$3=function(a){a=this.$6(a);if(a){b("cr:909496")!==null&&b("cr:909496").show(a.summary,a.description);return!1}else return!0};c.$6=function(a){var b;if(a.getSize()===null)return;a.getSize()<this.$1.minSize&&(b=this.$8());a.getSize()>this.$1.maxSize&&(b=this.$9());return b};c.$8=function(){var a=Math.round(this.$1.minSize/1024);return{summary:h._("El archivo de video es demasiado peque\u00f1o"),description:h._("El archivo de video que intentaste subir es demasiado peque\u00f1o. El tama\u00f1o m\u00ednimo para los archivos de video es de {min-size} KB. Sube uno m\u00e1s grande.",[h._param("min-size",a)])}};c.$9=function(){var a=Math.floor(this.$1.maxSize/1024/1024);return{summary:h._("El archivo de video es demasiado grande"),description:h._("El archivo de video que intentaste subir es demasiado grande. El tama\u00f1o m\u00e1ximo para los archivos de video es de {max-size} MB. Sube uno m\u00e1s peque\u00f1o.",[h._param("max-size",a)])}};c.$4=function(a,c){a=this.$7(a,c);if(a){b("cr:909496")!==null&&b("cr:909496").show(a.summary,a.description);return!1}else return!0};c.$7=function(a,b){var c;if(!b)return;var d=b.format.duration;d&&(d>this.$1.maxLength&&(c=this.$10()),d<this.$1.minLength&&!a&&(c=this.$11()));if(!b.streams||!b.streams.primaryVideo)return;d=b.streams.primaryVideo.width;a=b.streams.primaryVideo.height;var e=0,f=0;b.videoPlayerData!==null&&(e=b.videoPlayerData.height,f=b.videoPlayerData.width);this.$1.acceptDimensionsFromPlayer&&f!==0&&e!==0&&(d=f,a=e);!b.streams.primaryVideo&&b.streams.primaryAudio&&(c=this.$12());d<this.$1.minWidth&&(c=this.$13());a<this.$1.minHeight&&(c=this.$14());f=d/a;this.$1.require16to9AspectRatio&&((f>2||f<1.6)&&(c=this.$15()));this.$1.minAspectRatio&&(f<this.$1.minAspectRatio&&(c=this.$16()));this.$1.maxAspectRatio&&(f>this.$1.maxAspectRatio&&(c=this.$17()));return c};c.$10=function(){if(this.$1.source==="profile_video")return{summary:h._("El video del perfil es demasiado largo"),description:h._("La duraci\u00f3n m\u00e1xima es de {max-length} segundos. Sube un video m\u00e1s corto.",[h._param("max-length",this.$1.maxLength)])};else return{summary:h._("Video demasiado largo"),description:h._("El video que intentaste subir es demasiado largo. La duraci\u00f3n m\u00e1xima para los videos es de {max-length} minutos. Sube uno m\u00e1s corto.",[h._param("max-length",Math.round(this.$1.maxLength/60))])}};c.$11=function(){return{summary:h._("El archivo de video es demasiado corto"),description:h._({"second":"El video que intentaste subir es demasiado corto. La duraci\u00f3n m\u00ednima es de {min-length} segundos. Sube un video m\u00e1s largo.","seconds":"El video que intentaste subir es demasiado corto. La duraci\u00f3n m\u00ednima es de {min-length} segundos. Sube un video m\u00e1s largo."},[h._param("min-length",this.$1.minLength),h._enum(this.$1.minLength===1?"second":"seconds",{second:"second",seconds:"seconds"})])}};c.$12=function(){var a="http://www.facebook.com/help/?faq=218673814818907#What-formats-of-video-files-can-I-upload?";a=i.jsx(b("cr:909497"),{href:a,children:h._("formato de video compatible")});return{summary:h._("No se detect\u00f3 ning\u00fan video"),description:h._("Parece que est\u00e1s intentando subir un archivo que no es un video. Sube uno que tenga un {supported-video-format link}",[h._param("supported-video-format link",a)])}};c.$13=function(){return{summary:h._("El video no es lo suficientemente ancho"),description:h._("El video que intentaste subir no es lo suficientemente ancho. El ancho m\u00ednimo para los videos es de {min-width}. Sube uno m\u00e1s ancho.",[h._param("min-width",this.$1.minWidth)])}};c.$15=function(){return{summary:h._("Se produjo un problema al subir el video"),description:h._("Los videos se ven mejor con una relaci\u00f3n de aspecto de 16:9. Edita tu video y vuelve a subirlo.")}};c.$14=function(){return{summary:h._("El video es demasiado corto"),description:h._("El video que intentaste subir no es lo suficientemente alto. La altura m\u00ednima para los videos es de {min-height}. Sube uno m\u00e1s alto.",[h._param("min-height",this.$1.minHeight)])}};c.$17=function(){return{summary:h._("Video demasiado ancho"),description:h._("El video que seleccionaste es demasiado ancho. Las relaciones de aspecto de los videos deben ser entre {max_aspect_ratio} y {min_aspect_ratio}. Graba y sube un video m\u00e1s alto.",[h._param("max_aspect_ratio",this.$1.maxAspectRatio+":1"),h._param("min_aspect_ratio",this.$1.minAspectRatio+":1")])}};c.$16=function(){return{summary:h._("Video demasiado alto"),description:h._("El video que seleccionaste es demasiado alto. Las relaciones de aspecto de los videos deben ser entre {max_aspect_ratio} y {min_aspect_ratio}. Graba y sube un video m\u00e1s angosto.",[h._param("max_aspect_ratio",this.$1.maxAspectRatio+":1"),h._param("min_aspect_ratio",this.$1.minAspectRatio+":1")])}};return a}();e.exports=a}),null);
__d("submitForm",["DOM"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a){var c=a.querySelector('input[type="submit"]');c!=null?c.click():(c=b("DOM").create("input",{type:"submit",className:"hidden_elem"}),b("DOM").appendContent(a,c),c.click(),b("DOM").remove(c))}}),null);
__d("VideoUploadRequest",["AsyncRequest","DOM","DTSG","FileForm","Form","VideoUploadFeatureDetector","emptyFunction","flattenPHPQueryData","submitForm"],(function(a,b,c,d,e,f){var g="video";a=function(){"use strict";function a(a){this.$1=a;this.$2=null;this.$3=!1;this.$4=null;this.$5=null;this.$6=null;this.$7=null;this.$8=a=b("emptyFunction");this.$9=a;this.$10=a;this.$11=a;this.$12=null}var c=a.prototype;c.setAllowCrossOrigin=function(a){this.$3=a;return this};c.setData=function(a){this.$4=a;return this};c.setWaterfallID=function(a){this.$6=a;return this};c.setSuccessHandler=function(a){this.$8=a;return this};c.setErrorHandler=function(a){this.$9=a;return this};c.setTransportErrorHandler=function(a){this.$10=a;return this};c.setUploadProgressHandler=function(a){this.$11=a;return this};c.setTimeoutHandler=function(a,b){this.$7=a;this.$12=b;return this};c.setThumbnail=function(a){this.$13=a;return this};c.setCustomProfileImage=function(a){this.$14=a;return this};c.setCustomBackgroundImage=function(a){this.$15=a;return this};c.setFeedBackgroundImage=function(a){this.$16=a;return this};c.setHandle=function(a){this.$5=a;return this};c.setCaptions=function(a){this.$17=a;return this};c.setPollOptionImages=function(a){this.$18=a;return this};c.send=function(){if(this.$2)throw new Error("An upload request is already in progress.");if(b("VideoUploadFeatureDetector").supportsXHR()){this.$2=this.$19();if(this.$13||this.$17||this.$14||this.$15||this.$16||this.$18){var a=new FormData();this.$13&&a.append("thumb",this.$13);this.$14&&a.append("schedule_custom_profile_image",this.$14);this.$15&&a.append("schedule_custom_background_image",this.$15);this.$16&&a.append("schedule_feed_background_image",this.$16);this.$17&&this.$17.forEach(function(b,c){c=b.getIsDefault()?"captions_default":"captions_file"+c;a.append(c,b.getFile())});if(this.$18){var c=this.$18;Object.keys(c).forEach(function(b){a.append(b,c[b])})}if(this.$4){var d=b("flattenPHPQueryData")(this.$4);Object.keys(d).forEach(function(b){a.append(b,d[b])})}this.$2.setRawData(a)}this.$2.send()}else this.$2=this.$20(),this.$21(this.$2)};c.sendChunk=function(a){if(this.$2)throw new Error("An upload request is already in progress.");var b=new FormData();this.$5?b.append("fbuploader_video_file_chunk",this.$5):b.append("video_file_chunk",a);this.$2=this.$19();this.$2.setRawData(b);this.$2.send()};c.sendFile=function(a){if(this.$2)throw new Error("An upload request is already in progress.");this.$2=this.$20();var c=a.cloneNode(!1);a.name=g;b("DOM").replace(a,c);b("DOM").appendContent(this.$2.getRoot(),a);this.$21(this.$2);a.name=c.name;b("DOM").replace(c,a)};c.abort=function(){if(!this.$2)return;this.$2.abort();this.$2=null};c.$19=function(){var a=this.__getAsyncRequest().setAllowCrossOrigin(this.$3).setURI(this.$1).setData(this.$4).setRequestHeader("X_FB_VIDEO_WATERFALL_ID",this.$6).setHandler(this.$8).setErrorHandler(this.$9).setTransportErrorHandler(this.$10).setUploadProgressHandler(this.$11);this.$12&&a.setTimeoutHandler(this.$7,this.$12);return a};c.__getAsyncRequest=function(){return new(b("AsyncRequest"))()};c.$20=function(){var a=b("DOM").create("form",{action:this.$1,method:"POST"});b("Form").createHiddenInputs(babelHelpers["extends"]({fb_dtsg:b("DTSG").getToken()},this.$4),a);a=new(b("FileForm"))(a,null,{allowCrossOrigin:this.$3});a.subscribe("success",this.$22.bind(this));a.subscribe("failure",this.$23.bind(this));a.subscribe("progress",this.$24.bind(this));return a};c.$21=function(a){b("DOM").appendContent(document.body,a.getRoot()),b("submitForm")(a.getRoot())};c.$22=function(a,b){this.$8(b.response)};c.$23=function(a,b){this.$9(b.response)};c.$24=function(a,b){this.$11(b.event)};return a}();e.exports=a}),null);
__d("VideoUploadRequestContext",[],(function(a,b,c,d,e,f){a=function(){function a(){this.$14=!1,this.$21=0,this.$22=!1,this.$23=!1,this.$26=!1,this.reset()}var b=a.prototype;b.setFile=function(a){this.$1=a;return this};b.getFile=function(){return this.$1};b.setMetadata=function(a){this.$24=a;return this};b.getMetadata=function(){return this.$24};b.setVideoID=function(a){this.$2=a;return this};b.getVideoID=function(){return this.$2};b.setXPVAssetID=function(a){this.$29=a;return this};b.getXPVAssetID=function(){return this.$29};b.setUploadSessionID=function(a){this.$3=a;return this};b.getUploadSessionID=function(){return this.$3};b.setFbRegion=function(a){this.$4=a;return this};b.getFbRegion=function(){return this.$4};b.setStartOffset=function(a){this.$5=a;return this};b.getStartOffset=function(){return this.$5};b.setEndOffset=function(a){this.$6=a;return this};b.getEndOffset=function(){return this.$6};b.setPartitionStartOffset=function(a){this.$17=a;return this};b.getPartitionStartOffset=function(){return this.$17};b.setPartitionEndOffset=function(a){this.$18=a;return this};b.getPartitionEndOffset=function(){return this.$18};b.setPartitionNo=function(a){this.$19=a;return this};b.getPartitionNo=function(){return this.$19};b.setTargetID=function(a){this.$7=a;return this};b.getTargetID=function(){return this.$7};b.setSource=function(a){this.$8=a;return this};b.setComposerDialogVersion=function(a){this.$9=a;return this};b.getComposerDialogVersion=function(){return this.$9};b.getSource=function(){return this.$8};b.setWaterfallID=function(a){this.$10=a;return this};b.getWaterfallID=function(){return this.$10};b.setComposerEntryPointRef=function(a){this.$11=a;return this};b.getComposerEntryPointRef=function(){return this.$11};b.setComposerWorkSharedDraftMode=function(a){this.$12=a;return this};b.getComposerWorkSharedDraftMode=function(){return this.$12};b.setHasFileBeenReplaced=function(a){this.$14=a;return this};b.getHasFileBeenReplaced=function(){return this.$14};b.setSupportsChunking=function(a){this.$15=a;return this};b.getSupportsChunking=function(){return this.$15};b.setSupportsFileAPI=function(a){this.$16=a;return this};b.getSupportsFileAPI=function(){return this.$16};b.setCreatorProduct=function(a){this.$20=a;return this};b.getCreatorProduct=function(){return this.$20};b.setLastKnownUploadSpeed=function(a){this.$21=a;return this};b.getLastKnownUploadSpeed=function(){return this.$21||0};b.setUseParallelChunks=function(a){this.$22=a;return this};b.getUseParallelChunks=function(){return this.$22};b.setIsSphericalVideo=function(a){this.$23=a;return this};b.getIsSphericalVideo=function(){return this.$23};b.setSphericalMetadata=function(a){this.$25=a;return this};b.getSphericalMetadata=function(){return this.$25};b.setEnableOmnistab=function(a){this.$26=a;return this};b.getEnableOmnistab=function(){return this.$26};b.setClientChunkSize=function(a){this.$27=a;return this};b.getClientChunkSize=function(){return this.$27};b.setVideoPublisherActionSource=function(a){this.$28=a;return this};b.getVideoPublisherActionSource=function(){return this.$28};b.setComposerSessionID=function(a){this.$13=a;return this};b.getComposerSessionID=function(){return this.$13};b.setRetryState=function(a){this.$30=a;return this};b.getRetryState=function(){return this.$30};b.reset=function(){this.$1=null,this.$2=null,this.$3=null,this.$4=null,this.$5=null,this.$6=null,this.$7=null,this.$8=null,this.$9=null,this.$10=null,this.$11=null,this.$12=null,this.$14=!1,this.$15=null,this.$16=null,this.$17=null,this.$18=null,this.$19=null,this.$20=null,this.$21=0,this.$22=!1,this.$23=!1,this.$24={},this.$25={},this.$26=!1,this.$27=null,this.$28={},this.$13=null,this.$30=null};return a}();e.exports=a}),null);
__d("VideoUploadGraphQLPostRequestManager",["FBLogger","GraphQLVideoPublisherInputDataHandlerBase","GraphQLVideoPublisherVideoUploaderInputDataHandler","VideoComposerVideoPublisher","clearTimeout","err","gkx","mixin","requireCond","setTimeout","cr:909282"],(function(a,b,c,d,e,f){a=function(a){babelHelpers.inheritsLoose(c,a);function c(b,c,d,e){var f;f=a.call(this)||this;f.$VideoUploadGraphQLPostRequestManager1=0;f.$VideoUploadGraphQLPostRequestManager2=0;f.$VideoUploadGraphQLPostRequestManager3=0;f.$VideoUploadGraphQLPostRequestManager4=0;f.$VideoUploadGraphQLPostRequestManager5=0;f.$VideoUploadGraphQLPostRequestManager6=0;f.$VideoUploadGraphQLPostRequestManager7=null;f.$VideoUploadGraphQLPostRequestManager8=null;f.$VideoUploadGraphQLPostRequestManager9=!1;f.$VideoUploadGraphQLPostRequestManager1=b;f.$VideoUploadGraphQLPostRequestManager2=c;f.$VideoUploadGraphQLPostRequestManager3=0;f.$VideoUploadGraphQLPostRequestManager4=d;f.$VideoUploadGraphQLPostRequestManager5=e;f.$VideoUploadGraphQLPostRequestManager6=0;return f}var d=c.prototype;d.sendRequest=function(a){this.$VideoUploadGraphQLPostRequestManager8=a;if(this.$VideoUploadGraphQLPostRequestManager9){b("gkx")("1838765")&&b("FBLogger")("video_publish_graphql").info("Sending publishing request again while processing another request");return}this.$VideoUploadGraphQLPostRequestManager10();this.inform("request-started")};d.clearRequest=function(){this.$VideoUploadGraphQLPostRequestManager9=!1,this.$VideoUploadGraphQLPostRequestManager6=0,this.$VideoUploadGraphQLPostRequestManager3=0};d.$VideoUploadGraphQLPostRequestManager10=function(){var a=this.$VideoUploadGraphQLPostRequestManager8;if(a==null)return;b("clearTimeout")(this.$VideoUploadGraphQLPostRequestManager7);this.$VideoUploadGraphQLPostRequestManager7=null;var c=a.getMetadata();a=this.__createRequestData(a);c=new(b("GraphQLVideoPublisherVideoUploaderInputDataHandler"))(c,a);this.$VideoUploadGraphQLPostRequestManager9=!0;a=new(b("VideoComposerVideoPublisher"))(c);a.publish(this.$VideoUploadGraphQLPostRequestManager11.bind(this),this.$VideoUploadGraphQLPostRequestManager12.bind(this))};d.__createRequestData=function(a){var c=a.getVideoID(),d=a.getTargetID();if(c==null)throw b("err")("Video id cannot be null");if(d==null)throw b("err")("Target id cannot be null");return{video_id:c,target_id:d,source:"COMPOSER",waterfall_id:a.getWaterfallID()||"",creator_product:a.getCreatorProduct(),composer_entry_point_ref:a.getComposerEntryPointRef&&a.getComposerEntryPointRef(),composer_dialog_version:a.getComposerDialogVersion(),has_file_been_replaced:a.getHasFileBeenReplaced(),supports_chunking:a.getSupportsChunking()}};d.$VideoUploadGraphQLPostRequestManager11=function(a){this.inform("request-finished",{video_asset_id:(a=a.video_publish)==null?void 0:a.video_asset_id});this.clearRequest()};d.$VideoUploadGraphQLPostRequestManager13=function(a){this.inform("request-failed",{error_code:a.number,error_description:a.message,error_summary:a.name,error_object:a}),this.clearRequest()};d.$VideoUploadGraphQLPostRequestManager12=function(a){this.$VideoUploadGraphQLPostRequestManager14(a)&&this.$VideoUploadGraphQLPostRequestManager6<this.$VideoUploadGraphQLPostRequestManager4?(b("gkx")("1838765")&&b("FBLogger")("video_publish_graphql").info("retry publishing for error: %s",a.stack),this.$VideoUploadGraphQLPostRequestManager6++,this.$VideoUploadGraphQLPostRequestManager15(this.$VideoUploadGraphQLPostRequestManager16(this.$VideoUploadGraphQLPostRequestManager5,this.$VideoUploadGraphQLPostRequestManager6))):this.$VideoUploadGraphQLPostRequestManager13(a)};d.$VideoUploadGraphQLPostRequestManager16=function(a,b){return Math.pow(a,b)*1e3};d.$VideoUploadGraphQLPostRequestManager15=function(a){b("clearTimeout")(this.$VideoUploadGraphQLPostRequestManager7),this.$VideoUploadGraphQLPostRequestManager7=b("setTimeout")(this.$VideoUploadGraphQLPostRequestManager10.bind(this),a)};d.$VideoUploadGraphQLPostRequestManager14=function(a){a=a.toString();return a.includes("NetworkTransportError")||a.includes("NetworkTimeoutError")||a.includes("NetworkRequestError")?!0:!1};d.hasAPISupport=function(a){return b("GraphQLVideoPublisherInputDataHandlerBase").hasAPISupport(a)};return c}(b("mixin")(b("cr:909282")));e.exports=a}),null);
__d("VideoUploadPostRequestManager",["VideoUploadLogger","VideoUploadRequest","clearTimeout","mixin","requireCond","setTimeout","cr:909282"],(function(a,b,c,d,e,f){a=function(a){babelHelpers.inheritsLoose(c,a);function c(b,c,d,e,f){var g;g=a.call(this)||this;g.$VideoUploadPostRequestManager2=b;g.$VideoUploadPostRequestManager3=c;g.$VideoUploadPostRequestManager4=d;g.$VideoUploadPostRequestManager5=0;g.$VideoUploadPostRequestManager6=e;g.$VideoUploadPostRequestManager7=f;g.$VideoUploadPostRequestManager8=0;return g}var d=c.prototype;d.$VideoUploadPostRequestManager9=function(){return this.$VideoUploadPostRequestManager1?new(b("VideoUploadLogger"))({source:this.$VideoUploadPostRequestManager1.getSource(),waterfall_id:this.$VideoUploadPostRequestManager1.getWaterfallID(),target_id:this.$VideoUploadPostRequestManager1.getTargetID(),composer_entry_point_ref:this.$VideoUploadPostRequestManager1.getComposerEntryPointRef&&this.$VideoUploadPostRequestManager1.getComposerEntryPointRef()}):null};d.getRequest=function(){return this.$VideoUploadPostRequestManager10};d.sendRequest=function(a){this.$VideoUploadPostRequestManager1=a;if(this.$VideoUploadPostRequestManager10){var c=this.$VideoUploadPostRequestManager9();c&&c.logEvent(b("VideoUploadLogger").EVENT_DUPLICATE_POST_REQUEST);return}this.$VideoUploadPostRequestManager11=babelHelpers["extends"]({},a.getMetadata(),this.__createRequestData(a));this.$VideoUploadPostRequestManager12=this.$VideoUploadPostRequestManager11.thumb;this.$VideoUploadPostRequestManager13=this.$VideoUploadPostRequestManager11.schedule_custom_profile_image;this.$VideoUploadPostRequestManager14=this.$VideoUploadPostRequestManager11.schedule_custom_background_image;this.$VideoUploadPostRequestManager15=this.$VideoUploadPostRequestManager11.schedule_feed_background_image;delete this.$VideoUploadPostRequestManager11.thumb;this.$VideoUploadPostRequestManager16=this.$VideoUploadPostRequestManager11.captions;delete this.$VideoUploadPostRequestManager11.captions;this.$VideoUploadPostRequestManager17=a.getWaterfallID();this.$VideoUploadPostRequestManager18=this.$VideoUploadPostRequestManager11.pollImages;this.$VideoUploadPostRequestManager19();this.inform("request-started")};d.$VideoUploadPostRequestManager19=function(){b("clearTimeout")(this.$VideoUploadPostRequestManager20),this.$VideoUploadPostRequestManager20=null,this.$VideoUploadPostRequestManager10=this.__getVideoUploadRequest(this.$VideoUploadPostRequestManager2).setAllowCrossOrigin(!0).setData(this.$VideoUploadPostRequestManager11).setThumbnail(this.$VideoUploadPostRequestManager12).setCustomProfileImage(this.$VideoUploadPostRequestManager13).setCustomBackgroundImage(this.$VideoUploadPostRequestManager14).setFeedBackgroundImage(this.$VideoUploadPostRequestManager15).setCaptions(this.$VideoUploadPostRequestManager16).setWaterfallID(this.$VideoUploadPostRequestManager17).setPollOptionImages(this.$VideoUploadPostRequestManager18).setSuccessHandler(this.$VideoUploadPostRequestManager21.bind(this)).setErrorHandler(this.$VideoUploadPostRequestManager22.bind(this)).setTransportErrorHandler(this.$VideoUploadPostRequestManager23.bind(this)),this.$VideoUploadPostRequestManager10.send()};d.__createRequestData=function(a){return{video_id:a.getVideoID(),target_id:a.getTargetID(),source:a.getSource(),waterfall_id:a.getWaterfallID(),creator_product:a.getCreatorProduct(),composer_entry_point_ref:a.getComposerEntryPointRef&&a.getComposerEntryPointRef(),composer_dialog_version:a.getComposerDialogVersion(),has_file_been_replaced:a.getHasFileBeenReplaced(),supports_chunking:a.getSupportsChunking()}};d.__getVideoUploadRequest=function(a){return new(b("VideoUploadRequest"))(a)};d.clearRequest=function(){this.$VideoUploadPostRequestManager10=null,this.$VideoUploadPostRequestManager8=0,this.$VideoUploadPostRequestManager5=0};d.isInProgress=function(){return!!this.$VideoUploadPostRequestManager10};d.$VideoUploadPostRequestManager24=function(a){b("clearTimeout")(this.$VideoUploadPostRequestManager20),this.$VideoUploadPostRequestManager20=b("setTimeout")(this.$VideoUploadPostRequestManager19.bind(this),a)};d.$VideoUploadPostRequestManager25=function(a,b){return Math.pow(a,b)*1e3};d.$VideoUploadPostRequestManager21=function(a){a=a.getPayload();this.inform("request-finished",{video_id:a.video_id,video_asset_id:a.video_asset_id,container_type:a.container_type,transport_retries:this.$VideoUploadPostRequestManager5,server_retries:this.$VideoUploadPostRequestManager8,premiere_destination_video_id:a.premiere_destination_video_id});this.clearRequest()};d.$VideoUploadPostRequestManager26=function(a){this.inform("request-failed",{error_code:a.getError(),error_description:a.getErrorDescription(),error_summary:a.getErrorSummary(),transport_retries:this.$VideoUploadPostRequestManager5,server_retries:this.$VideoUploadPostRequestManager8,error_is_silent:a.isSilent(),error_is_transient:a.isTransient(),www_request_id:(a=a.getPayload())==null?void 0:a.__www_request_id__});this.clearRequest()};d.$VideoUploadPostRequestManager22=function(a){this.$VideoUploadPostRequestManager10=null;this.$VideoUploadPostRequestManager5=0;var c=this.$VideoUploadPostRequestManager9();if(c){var d={server_retries:this.$VideoUploadPostRequestManager8,extra_data:{failure_is_transient:a.isTransient()}};c.logEvent(b("VideoUploadLogger").EVENT_HANDLING_SERVER_FAILURE_RESPONSE,d)}a.isTransient()&&this.$VideoUploadPostRequestManager8<this.$VideoUploadPostRequestManager6?(this.$VideoUploadPostRequestManager8++,this.$VideoUploadPostRequestManager24(this.$VideoUploadPostRequestManager25(this.$VideoUploadPostRequestManager7,this.$VideoUploadPostRequestManager8))):this.$VideoUploadPostRequestManager26(a)};d.$VideoUploadPostRequestManager23=function(a){var c=this.$VideoUploadPostRequestManager9();if(c){var d={extra_data:{transport_retries:this.$VideoUploadPostRequestManager5}};c.logEvent(b("VideoUploadLogger").EVENT_HANDLING_TRANSPORT_FAILURE_RESPONSE,d)}this.$VideoUploadPostRequestManager3===0||this.$VideoUploadPostRequestManager5>=this.$VideoUploadPostRequestManager3?this.$VideoUploadPostRequestManager26(a):(this.$VideoUploadPostRequestManager5++,this.$VideoUploadPostRequestManager10=null,this.$VideoUploadPostRequestManager24(this.$VideoUploadPostRequestManager25(this.$VideoUploadPostRequestManager4,this.$VideoUploadPostRequestManager5)))};return c}(b("mixin")(b("cr:909282")));e.exports=a}),null);
__d("VideoUploadConnectionMonitor",["requireCond","cr:909282","Network","VideoUploadFeatureDetector","debounce","mixin","setTimeout"],(function(a,b,c,d,e,f){a=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(){var c;c=a.call(this)||this;c.$VideoUploadConnectionMonitor1=!1;c.$VideoUploadConnectionMonitor2=[];c.$VideoUploadConnectionMonitor3=!1;c.$VideoUploadConnectionMonitor4=!0;c.$VideoUploadConnectionMonitor5=b("debounce")(function(){this.$VideoUploadConnectionMonitor6(!1)}.bind(babelHelpers.assertThisInitialized(c)),2e3);return c}var d=c.prototype;d.notifyStart=function(){if(this.$VideoUploadConnectionMonitor3)return;this.$VideoUploadConnectionMonitor2.length===0&&(this.$VideoUploadConnectionMonitor2.push(b("Network").addListener("online",function(){this.$VideoUploadConnectionMonitor6(!0)}.bind(this))),this.$VideoUploadConnectionMonitor2.push(b("Network").addListener("offline",function(){this.$VideoUploadConnectionMonitor1?this.$VideoUploadConnectionMonitor5():(this.$VideoUploadConnectionMonitor5.reset(),b("setTimeout")(this.$VideoUploadConnectionMonitor5,2e3))}.bind(this))));this.$VideoUploadConnectionMonitor3=!0};d.notifyProgress=function(a){if(!this.$VideoUploadConnectionMonitor3)return;if(!a)return;b("VideoUploadFeatureDetector").supportsFullProgress()&&(this.$VideoUploadConnectionMonitor1=!0,a.total&&a.loaded===a.total?this.$VideoUploadConnectionMonitor5.reset():this.$VideoUploadConnectionMonitor5())};d.notifySuccess=function(){if(!this.$VideoUploadConnectionMonitor3)return;this.reset();this.$VideoUploadConnectionMonitor6(!0)};d.notifyTransportError=function(){if(!this.$VideoUploadConnectionMonitor3)return;this.$VideoUploadConnectionMonitor3=!1;this.$VideoUploadConnectionMonitor6(!1)};d.notifyError=function(){if(!this.$VideoUploadConnectionMonitor3)return;this.reset();this.$VideoUploadConnectionMonitor6(!0)};d.isOnline=function(){return this.$VideoUploadConnectionMonitor4};d.reset=function(){while(this.$VideoUploadConnectionMonitor2.length)this.$VideoUploadConnectionMonitor2.pop().remove();this.$VideoUploadConnectionMonitor5.reset();this.$VideoUploadConnectionMonitor3=!1};d.$VideoUploadConnectionMonitor6=function(a){this.$VideoUploadConnectionMonitor5.reset(),this.$VideoUploadConnectionMonitor4!==a&&(this.$VideoUploadConnectionMonitor4=a,this.$VideoUploadConnectionMonitor4?this.inform("online"):this.inform("offline"))};return c}(b("mixin")(b("cr:909282")));e.exports=a}),null);
__d("VideoUploadReceiveRequestManager",["fbt","ODS","ResumableUploadAsyncService","ResumableUploadService","ResumableUploadServiceState.enum","VideoUploadConnectionMonitor","VideoUploadRequest","clearTimeout","gkx","md5","mixin","requireCond","setTimeout","uuid","cr:909282"],(function(a,b,c,d,e,f,g){var h=1363037,i={INITIAL:"initial",NEXT_CHUNK:"next chunk",INVALID_OFFSET_RETRY:"invalid offset retry",SERVER_FAILURE_RETRY:"server failure retry",TRANSPORT_FAILURE_RETRY:"transport failure retry",TIMEOUT_RETRY:"timeout retry",BACK_ONLINE:"back online"};a=function(a){babelHelpers.inheritsLoose(c,a);function c(c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){var A;m===void 0&&(m="");n===void 0&&(n=!1);o===void 0&&(o=!1);p===void 0&&(p=null);q===void 0&&(q=null);r===void 0&&(r=null);s===void 0&&(s=0);t===void 0&&(t=!1);u===void 0&&(u=!1);v===void 0&&(v=!1);w===void 0&&(w=!1);x===void 0&&(x=!1);y===void 0&&(y=!1);z===void 0&&(z=0);A=a.call(this)||this;A.$VideoUploadReceiveRequestManager1=c;A.$VideoUploadReceiveRequestManager2=d;A.$VideoUploadReceiveRequestManager3=e!=null?e:0;A.$VideoUploadReceiveRequestManager4=f;A.$VideoUploadReceiveRequestManager5=g;A.$VideoUploadReceiveRequestManager6=h;A.$VideoUploadReceiveRequestManager7=i;A.$VideoUploadReceiveRequestManager8=j;A.$VideoUploadReceiveRequestManager9=k;A.$VideoUploadReceiveRequestManager10=l;A.$VideoUploadReceiveRequestManager11=0;A.$VideoUploadReceiveRequestManager14=0;A.$VideoUploadReceiveRequestManager15=0;A.$VideoUploadReceiveRequestManager16=null;A.$VideoUploadReceiveRequestManager17=null;A.$VideoUploadReceiveRequestManager18=0;A.$VideoUploadReceiveRequestManager19="constructed";A.$VideoUploadReceiveRequestManager13=null;A.$VideoUploadReceiveRequestManager20=null;A.$VideoUploadReceiveRequestManager21=null;A.$VideoUploadReceiveRequestManager22=m;A.$VideoUploadReceiveRequestManager24=o;A.$VideoUploadReceiveRequestManager23=n;A.$VideoUploadReceiveRequestManager25=p;A.$VideoUploadReceiveRequestManager26=!1;A.$VideoUploadReceiveRequestManager27=q;A.$VideoUploadReceiveRequestManager30=t;A.$VideoUploadReceiveRequestManager31=u;A.$VideoUploadReceiveRequestManager32=v;A.$VideoUploadReceiveRequestManager29=s;A.$VideoUploadReceiveRequestManager33=w;A.$VideoUploadReceiveRequestManager28=r;A.$VideoUploadReceiveRequestManager34=x;A.$VideoUploadReceiveRequestManager12=b("uuid")();A.$VideoUploadReceiveRequestManager35=y;A.$VideoUploadReceiveRequestManager36=z;A.$VideoUploadReceiveRequestManager41=null;A.$VideoUploadReceiveRequestManager42=null;A.$VideoUploadReceiveRequestManager40=!1;A.$VideoUploadReceiveRequestManager39=null;A.$VideoUploadReceiveRequestManager37=new(b("VideoUploadConnectionMonitor"))();A.$VideoUploadReceiveRequestManager37.subscribe("online",A.$VideoUploadReceiveRequestManager50.bind(babelHelpers.assertThisInitialized(A)));A.$VideoUploadReceiveRequestManager37.subscribe("offline",A.$VideoUploadReceiveRequestManager51.bind(babelHelpers.assertThisInitialized(A)));return A}var d=c.prototype;d.updateVideoID=function(a){if(this.$VideoUploadReceiveRequestManager38.getVideoID())return;this.$VideoUploadReceiveRequestManager38.setVideoID(a);this.$VideoUploadReceiveRequestManager45&&this.$VideoUploadReceiveRequestManager45.setData(this.__createRequestData(this.$VideoUploadReceiveRequestManager38));this.$VideoUploadReceiveRequestManager52()};d.isResumabilityEnabled=function(){return this.$VideoUploadReceiveRequestManager23};d.isResumableServiceProxyReceiveEnabled=function(){return this.$VideoUploadReceiveRequestManager30};d.sendRequest=function(a){this.$VideoUploadReceiveRequestManager19="sending request";if(this.$VideoUploadReceiveRequestManager45){this.$VideoUploadReceiveRequestManager19="request already in progress";return}this.$VideoUploadReceiveRequestManager18=a.getEndOffset()-a.getStartOffset();this.$VideoUploadReceiveRequestManager38=a;this.$VideoUploadReceiveRequestManager53(i.INITIAL)};d.cancelRequest=function(){if(!this.$VideoUploadReceiveRequestManager45)return;this.$VideoUploadReceiveRequestManager45.abort();this.$VideoUploadReceiveRequestManager21!==void 0&&this.$VideoUploadReceiveRequestManager21!==null&&this.$VideoUploadReceiveRequestManager21.cancel();this.$VideoUploadReceiveRequestManager54();this.inform("request-canceled")};d.appendStateLogData=function(a,b){a[b+"request_manager_state"]=this.$VideoUploadReceiveRequestManager19,a[b+"upload_speed"]=this.$VideoUploadReceiveRequestManager17,a[b+"transport_retries"]=this.$VideoUploadReceiveRequestManager11,a[b+"server_retries"]=this.$VideoUploadReceiveRequestManager14,a[b+"timeout_retries"]=this.$VideoUploadReceiveRequestManager15,a[b+"last_timeout_value"]=this.$VideoUploadReceiveRequestManager43,a[b+"last_request_start_time"]=this.$VideoUploadReceiveRequestManager16,a[b+"pending_request"]=this.$VideoUploadReceiveRequestManager45!=null,a[b+"pending_timer"]=this.$VideoUploadReceiveRequestManager46!=null,a[b+"cached_chunk"]=this.$VideoUploadReceiveRequestManager44!=null,a[b+"early_receive_start"]=this.$VideoUploadReceiveRequestManager40,this.$VideoUploadReceiveRequestManager38!=null&&(a[b+"start_offset"]=this.$VideoUploadReceiveRequestManager38.getStartOffset(),a[b+"end_offset"]=this.$VideoUploadReceiveRequestManager38.getEndOffset(),a[b+"partition_start_offset"]=this.$VideoUploadReceiveRequestManager38.getPartitionStartOffset(),a[b+"partition_end_offset"]=this.$VideoUploadReceiveRequestManager38.getPartitionEndOffset()),this.$VideoUploadReceiveRequestManager37!=null&&(a[b+"connection_monitor_online"]=this.$VideoUploadReceiveRequestManager37.isOnline())};d.getHostName=function(a){try{return new URL(a).hostname}catch(a){return null}};d.$VideoUploadReceiveRequestManager54=function(){this.$VideoUploadReceiveRequestManager45=null,this.$VideoUploadReceiveRequestManager44=null,this.$VideoUploadReceiveRequestManager11=0,this.$VideoUploadReceiveRequestManager14=0,this.$VideoUploadReceiveRequestManager12=b("uuid")(),this.$VideoUploadReceiveRequestManager15=0,this.$VideoUploadReceiveRequestManager16=null,this.$VideoUploadReceiveRequestManager17=null,this.$VideoUploadReceiveRequestManager18=0,this.$VideoUploadReceiveRequestManager41=null,this.$VideoUploadReceiveRequestManager42=null,this.$VideoUploadReceiveRequestManager40=!1,this.$VideoUploadReceiveRequestManager26=!1,this.$VideoUploadReceiveRequestManager39=null,this.$VideoUploadReceiveRequestManager38.reset(),this.$VideoUploadReceiveRequestManager37.reset(),b("clearTimeout")(this.$VideoUploadReceiveRequestManager46),this.$VideoUploadReceiveRequestManager46=null};d.$VideoUploadReceiveRequestManager53=function(a,c){b("clearTimeout")(this.$VideoUploadReceiveRequestManager46);this.$VideoUploadReceiveRequestManager46=null;this.$VideoUploadReceiveRequestManager20=a;this.$VideoUploadReceiveRequestManager13=b("uuid")();if(this.$VideoUploadReceiveRequestManager38.getSupportsChunking()&&this.$VideoUploadReceiveRequestManager38.getStartOffset()>=this.$VideoUploadReceiveRequestManager38.getPartitionEndOffset()){!c?(this.inform("request-finished",{start_offset:this.$VideoUploadReceiveRequestManager38.getEndOffset()-1,end_offset:this.$VideoUploadReceiveRequestManager38.getEndOffset(),transport_retries:this.$VideoUploadReceiveRequestManager11,server_retries:this.$VideoUploadReceiveRequestManager14,upload_speed:this.$VideoUploadReceiveRequestManager17,request_manager_state:this.$VideoUploadReceiveRequestManager19,upload_domain:this.$VideoUploadReceiveRequestManager39,debug:{request_reason:this.$VideoUploadReceiveRequestManager20,single_request_id:this.$VideoUploadReceiveRequestManager13}}),this.$VideoUploadReceiveRequestManager19="request finished - notified"):this.$VideoUploadReceiveRequestManager19="request finished - not notified";return}this.$VideoUploadReceiveRequestManager45=this.__getVideoUploadRequest(this.$VideoUploadReceiveRequestManager1).setAllowCrossOrigin(!0).setData(this.__createRequestData(this.$VideoUploadReceiveRequestManager38)).setWaterfallID(this.$VideoUploadReceiveRequestManager38.getWaterfallID()).setSuccessHandler(this.__handleSuccessResponse.bind(this)).setErrorHandler(this.__handleServerFailureResponse.bind(this)).setTransportErrorHandler(this.$VideoUploadReceiveRequestManager55.bind(this));this.$VideoUploadReceiveRequestManager23||this.$VideoUploadReceiveRequestManager45.setUploadProgressHandler(this.$VideoUploadReceiveRequestManager56.bind(this));this.$VideoUploadReceiveRequestManager16=Date.now();this.$VideoUploadReceiveRequestManager39=this.getHostName(this.$VideoUploadReceiveRequestManager1);a=!1;if(this.$VideoUploadReceiveRequestManager38.getSupportsChunking()){if(this.$VideoUploadReceiveRequestManager5){c=this.$VideoUploadReceiveRequestManager57(this.$VideoUploadReceiveRequestManager38.getEndOffset()-this.$VideoUploadReceiveRequestManager38.getStartOffset(),this.$VideoUploadReceiveRequestManager17);this.$VideoUploadReceiveRequestManager45.setTimeoutHandler(c,this.__handleResponseTimeout.bind(this));this.$VideoUploadReceiveRequestManager19="sending chunk with timeout = "+c;this.$VideoUploadReceiveRequestManager43=c}else this.$VideoUploadReceiveRequestManager19="sending chunk without timeout";c=this.$VideoUploadReceiveRequestManager58();if(c===null||c===void 0){this.$VideoUploadReceiveRequestManager59({error_description:"Provided chunk is null.",error_is_transient:!1});return}else this.$VideoUploadReceiveRequestManager23&&this.$VideoUploadReceiveRequestManager29<this.$VideoUploadReceiveRequestManager38.getFile().getSize()?(a=!0,this.$VideoUploadReceiveRequestManager60(c)):this.$VideoUploadReceiveRequestManager45.sendChunk(c)}else this.$VideoUploadReceiveRequestManager19="sending file",this.$VideoUploadReceiveRequestManager45.sendFile(this.$VideoUploadReceiveRequestManager38.getFile().getFileInput());this.$VideoUploadReceiveRequestManager61(a);this.$VideoUploadReceiveRequestManager37.notifyStart();this.inform("request-started",{start_offset:this.$VideoUploadReceiveRequestManager38.getStartOffset(),end_offset:this.$VideoUploadReceiveRequestManager38.getEndOffset(),transport_retries:this.$VideoUploadReceiveRequestManager11,server_retries:this.$VideoUploadReceiveRequestManager14,upload_speed:this.$VideoUploadReceiveRequestManager17,request_manager_state:this.$VideoUploadReceiveRequestManager19,upload_domain:this.$VideoUploadReceiveRequestManager39,debug:{request_reason:this.$VideoUploadReceiveRequestManager20,single_request_id:this.$VideoUploadReceiveRequestManager13}})};d.$VideoUploadReceiveRequestManager61=function(a){(this.$VideoUploadReceiveRequestManager38.getSource()==="create_flow"||this.$VideoUploadReceiveRequestManager38.getSource()==="ads_interfaces")&&b("ODS").bumpEntityKey(2966,"video_ads_upload",a?"upload_service":"graph_api")};d.$VideoUploadReceiveRequestManager62=function(a,b,c){!this.$VideoUploadReceiveRequestManager38.getVideoID()?(this.$VideoUploadReceiveRequestManager41=a,this.$VideoUploadReceiveRequestManager42=b):a(b,c)};d.$VideoUploadReceiveRequestManager52=function(){this.$VideoUploadReceiveRequestManager41&&(this.$VideoUploadReceiveRequestManager41(this.$VideoUploadReceiveRequestManager42),this.$VideoUploadReceiveRequestManager41=null,this.$VideoUploadReceiveRequestManager42=null)};d.$VideoUploadReceiveRequestManager60=function(a){var c,d=this.$VideoUploadReceiveRequestManager38.getFile(),e=d.getFile().lastModified+d.getFile().name+d.getFile().type+this.$VideoUploadReceiveRequestManager63();e=String(b("md5")(e))+"-"+this.$VideoUploadReceiveRequestManager38.getStartOffset()+"-"+this.$VideoUploadReceiveRequestManager38.getEndOffset();c=((c=this.$VideoUploadReceiveRequestManager38)==null?void 0:c.getRetryState())==null?this.$VideoUploadReceiveRequestManager14+this.$VideoUploadReceiveRequestManager11+this.$VideoUploadReceiveRequestManager15:this.$VideoUploadReceiveRequestManager38.getRetryState().getTotalRetryCount();d=this.$VideoUploadReceiveRequestManager35&&this.$VideoUploadReceiveRequestManager36<d.getSize()?["video_upload_www",[this.$VideoUploadReceiveRequestManager12,String(c)].join("_"),[String(this.$VideoUploadReceiveRequestManager38.getWaterfallID()),String(this.$VideoUploadReceiveRequestManager38.getVideoID())].join("_")].join(":"):null;this.isResumabilityEnabled()&&this.$VideoUploadReceiveRequestManager25&&this.$VideoUploadReceiveRequestManager11>this.$VideoUploadReceiveRequestManager2/3&&(this.$VideoUploadReceiveRequestManager26=!0);c="fb_video";this.$VideoUploadReceiveRequestManager30&&(c="fb_video2");var f=null;if(this.$VideoUploadReceiveRequestManager30||this.$VideoUploadReceiveRequestManager31){var g={};g.start_offset=this.$VideoUploadReceiveRequestManager38.getStartOffset();g.end_offset=this.$VideoUploadReceiveRequestManager38.getEndOffset();g.composer_session_id=this.$VideoUploadReceiveRequestManager38.getWaterfallID();g.upload_session_id=this.$VideoUploadReceiveRequestManager38.getUploadSessionID();g.product_media_id=this.$VideoUploadReceiveRequestManager38.getVideoID();g.xpv_asset_id=this.$VideoUploadReceiveRequestManager38.getXPVAssetID();g.fb_region=this.$VideoUploadReceiveRequestManager38.getFbRegion();this.$VideoUploadReceiveRequestManager32&&(g.total_file_size=this.$VideoUploadReceiveRequestManager38.getFile().getSize());b("gkx")("1765373")&&(g.video_waterfall_id=this.$VideoUploadReceiveRequestManager38.getWaterfallID(),g.target_id=this.$VideoUploadReceiveRequestManager38.getTargetID());f=g}g={};g.consumer=c;g.accessToken=this.$VideoUploadReceiveRequestManager22;g.sessionKey=e;g.serviceName=this.$VideoUploadReceiveRequestManager26?null:this.$VideoUploadReceiveRequestManager25;g.serviceDomain=this.$VideoUploadReceiveRequestManager27;g.receiveParameters=f;g.flowCaptureHeaderValue=this.$VideoUploadReceiveRequestManager34?this.$VideoUploadReceiveRequestManager38.getWaterfallID():null;g.tracingHeaderValue=d;this.$VideoUploadReceiveRequestManager24?c=b("ResumableUploadAsyncService").create(g):c=b("ResumableUploadService").create(g);this.$VideoUploadReceiveRequestManager21=c;this.$VideoUploadReceiveRequestManager39=c.getServiceName();this.$VideoUploadReceiveRequestManager64();c.resume(a);this.inform("resumable-called",{debug:{single_request_id:this.$VideoUploadReceiveRequestManager13,authority:this.$VideoUploadReceiveRequestManager39}})};d.$VideoUploadReceiveRequestManager64=function(){var a=this;this.$VideoUploadReceiveRequestManager38.getVideoID()||(this.$VideoUploadReceiveRequestManager40=!0);var c=this.$VideoUploadReceiveRequestManager21;if(c===null||c===void 0)return;c.addListener(b("ResumableUploadServiceState.enum").START,function(b){a.inform("resumable-started",{resume_from_offset:b.offset,debug:{single_request_id:a.$VideoUploadReceiveRequestManager13,partition:a.$VideoUploadReceiveRequestManager38.getPartitionNo(),authority:a.$VideoUploadReceiveRequestManager39}})});this.$VideoUploadReceiveRequestManager47=function(b){a.inform("resumable-failed",{error_code:b.getError(),error_description:b.getErrorDescription(),error_summary:b.getErrorSummary(),error_is_transient:b.isTransient(),debug:{error_source:"service",single_request_id:a.$VideoUploadReceiveRequestManager13,partition:a.$VideoUploadReceiveRequestManager38.getPartitionNo(),authority:a.$VideoUploadReceiveRequestManager39}}),a.__handleServerFailureResponse(b)};c.addListener(b("ResumableUploadServiceState.enum").FAIL,function(b){a.$VideoUploadReceiveRequestManager62(a.$VideoUploadReceiveRequestManager47,b)});this.$VideoUploadReceiveRequestManager48=function(b){!a.$VideoUploadReceiveRequestManager30?(a.$VideoUploadReceiveRequestManager45.setHandle(b),a.$VideoUploadReceiveRequestManager45.sendChunk(null)):a.__handleSuccessResponsePayload({start_offset:a.$VideoUploadReceiveRequestManager38.getEndOffset(),end_offset:a.$VideoUploadReceiveRequestManager38.getPartitionEndOffset()}),a.inform("resumable-success",{everstore_handle:b,debug:{single_request_id:a.$VideoUploadReceiveRequestManager13,partition:a.$VideoUploadReceiveRequestManager38.getPartitionNo(),authority:a.$VideoUploadReceiveRequestManager39}})};c.addListener(b("ResumableUploadServiceState.enum").SUCCESS,function(b){a.$VideoUploadReceiveRequestManager62(a.$VideoUploadReceiveRequestManager48,b)});this.$VideoUploadReceiveRequestManager49=function(b,c){a.inform("resumable-failed",{error_code:b.getError(),error_description:b.getErrorDescription(),error_summary:b.getErrorSummary(),error_is_transient:b.isTransient(),resume_from_offset:c.offset,debug:{error_source:"transport",single_request_id:a.$VideoUploadReceiveRequestManager13,partition:a.$VideoUploadReceiveRequestManager38.getPartitionNo(),method:c.method,authority:a.$VideoUploadReceiveRequestManager39}}),a.$VideoUploadReceiveRequestManager55(b)};c.addListener(b("ResumableUploadServiceState.enum").TRANSPORT_FAILURE,function(b,c){a.$VideoUploadReceiveRequestManager62(a.$VideoUploadReceiveRequestManager49,b,c)});c.addListener(b("ResumableUploadServiceState.enum").PROGRESS,function(b){a.$VideoUploadReceiveRequestManager33&&(a.$VideoUploadReceiveRequestManager11=0),a.$VideoUploadReceiveRequestManager56(b)})};d.__getVideoUploadRequest=function(a){return new(b("VideoUploadRequest"))(a)};d.$VideoUploadReceiveRequestManager65=function(a,c){this.$VideoUploadReceiveRequestManager19="setting request to send after"+c,b("clearTimeout")(this.$VideoUploadReceiveRequestManager46),this.$VideoUploadReceiveRequestManager46=b("setTimeout")(this.$VideoUploadReceiveRequestManager53.bind(this,a),c)};d.$VideoUploadReceiveRequestManager58=function(){if(this.$VideoUploadReceiveRequestManager44)return this.$VideoUploadReceiveRequestManager44;var a=this.$VideoUploadReceiveRequestManager38.getFile();if(this.$VideoUploadReceiveRequestManager23){var b=a.getFile();this.$VideoUploadReceiveRequestManager44=b?b.slice(this.$VideoUploadReceiveRequestManager38.getStartOffset(),this.$VideoUploadReceiveRequestManager38.getEndOffset(),"application/octet-stream"):null}else this.$VideoUploadReceiveRequestManager44=a.getChunk(this.$VideoUploadReceiveRequestManager38.getStartOffset(),this.$VideoUploadReceiveRequestManager38.getEndOffset());return this.$VideoUploadReceiveRequestManager44};d.__createRequestData=function(a){return{composer_session_id:a.getComposerSessionID(),video_id:a.getVideoID(),start_offset:a.getStartOffset(),end_offset:a.getEndOffset(),source:a.getSource(),target_id:a.getTargetID(),waterfall_id:a.getWaterfallID(),composer_entry_point_ref:a.getComposerEntryPointRef&&a.getComposerEntryPointRef(),composer_work_shared_draft_mode:a.getComposerWorkSharedDraftMode(),composer_dialog_version:a.getComposerDialogVersion(),has_file_been_replaced:a.getHasFileBeenReplaced(),supports_chunking:a.getSupportsChunking(),upload_speed:this.$VideoUploadReceiveRequestManager17,partition_start_offset:a.getPartitionStartOffset(),partition_end_offset:a.getPartitionEndOffset()}};d.__handleSuccessResponse=function(a){a=a.getPayload();this.__handleSuccessResponsePayload(a)};d.__handleSuccessResponsePayload=function(a){this.$VideoUploadReceiveRequestManager19="success response received";var c=Date.now()-(this.$VideoUploadReceiveRequestManager16||0);c=c===0?1:c;if(a.start_offset===this.$VideoUploadReceiveRequestManager38.getEndOffset()){var d=this.$VideoUploadReceiveRequestManager38.getEndOffset()-this.$VideoUploadReceiveRequestManager38.getStartOffset();this.$VideoUploadReceiveRequestManager17=Math.floor(d/c)}else this.$VideoUploadReceiveRequestManager17=null;this.$VideoUploadReceiveRequestManager37.notifySuccess();this.inform("request-finished",{start_offset:this.$VideoUploadReceiveRequestManager38.getStartOffset(),end_offset:this.$VideoUploadReceiveRequestManager38.getEndOffset(),transport_retries:this.$VideoUploadReceiveRequestManager11,server_retries:this.$VideoUploadReceiveRequestManager14,upload_speed:this.$VideoUploadReceiveRequestManager17,request_manager_state:this.$VideoUploadReceiveRequestManager19,upload_domain:this.$VideoUploadReceiveRequestManager39,debug:{request_reason:this.$VideoUploadReceiveRequestManager20,single_request_id:this.$VideoUploadReceiveRequestManager13}});this.$VideoUploadReceiveRequestManager38.setStartOffset(a.start_offset);d=a.end_offset;this.$VideoUploadReceiveRequestManager38.getClientChunkSize()&&(d=a.start_offset+Math.min(this.$VideoUploadReceiveRequestManager38.getPartitionEndOffset()-a.start_offset,this.$VideoUploadReceiveRequestManager38.getClientChunkSize()));this.$VideoUploadReceiveRequestManager38.setEndOffset(d);this.$VideoUploadReceiveRequestManager38.setLastKnownUploadSpeed(this.$VideoUploadReceiveRequestManager17);this.$VideoUploadReceiveRequestManager45=null;this.$VideoUploadReceiveRequestManager44=null;this.$VideoUploadReceiveRequestManager11=0;this.$VideoUploadReceiveRequestManager14=0;this.$VideoUploadReceiveRequestManager12=b("uuid")();this.$VideoUploadReceiveRequestManager15=0;this.$VideoUploadReceiveRequestManager38.getSupportsChunking()&&this.$VideoUploadReceiveRequestManager53(i.NEXT_CHUNK,!0)};d.$VideoUploadReceiveRequestManager66=function(a){var b=this,c=a.getPayload();this.$VideoUploadReceiveRequestManager19="invalid offset response received start="+c.start_offset+" end="+c.end_offset;(this.$VideoUploadReceiveRequestManager38.getStartOffset()!=c.start_offset||this.$VideoUploadReceiveRequestManager38.getEndOffset()!=c.end_offset)&&(this.$VideoUploadReceiveRequestManager38.setStartOffset(c.start_offset),this.$VideoUploadReceiveRequestManager38.setEndOffset(c.end_offset),this.$VideoUploadReceiveRequestManager44=null);((c=this.$VideoUploadReceiveRequestManager38)==null?void 0:c.getRetryState())==null?(this.$VideoUploadReceiveRequestManager14++,this.$VideoUploadReceiveRequestManager53(i.INVALID_OFFSET_RETRY)):this.$VideoUploadReceiveRequestManager38.getRetryState().handleRetry({context:{location:"receive-invalid_offset"},retryHandler:function(a){return b.$VideoUploadReceiveRequestManager65(i.INVALID_OFFSET_RETRY,a)},failureHandler:function(){return b.$VideoUploadReceiveRequestManager67(a)}})};d.__handleServerFailureResponse=function(a){var b=this;this.$VideoUploadReceiveRequestManager19="failure response received";this.$VideoUploadReceiveRequestManager45=null;this.$VideoUploadReceiveRequestManager11=0;this.$VideoUploadReceiveRequestManager17=null;this.$VideoUploadReceiveRequestManager15=0;this.$VideoUploadReceiveRequestManager37.notifyError();if(this.__hasInvalidStartOffsetAndHasRetries(a.getError()))this.$VideoUploadReceiveRequestManager66(a);else{var c;((c=this.$VideoUploadReceiveRequestManager38)==null?void 0:c.getRetryState())==null?(a.isTransient()||this.$VideoUploadReceiveRequestManager10)&&this.$VideoUploadReceiveRequestManager14<this.$VideoUploadReceiveRequestManager4?(this.$VideoUploadReceiveRequestManager19="transient server error",this.$VideoUploadReceiveRequestManager14++,this.$VideoUploadReceiveRequestManager65(i.SERVER_FAILURE_RETRY,this.$VideoUploadReceiveRequestManager68(this.$VideoUploadReceiveRequestManager9,this.$VideoUploadReceiveRequestManager14,0))):this.$VideoUploadReceiveRequestManager67(a):this.$VideoUploadReceiveRequestManager38.getRetryState().handleRetry({context:{location:"receive-server_issue",error_code:a.getError()},predicate:function(){return a.isTransient()},retryHandler:function(a){b.$VideoUploadReceiveRequestManager19="transient server error",b.$VideoUploadReceiveRequestManager65(i.SERVER_FAILURE_RETRY,a)},failureHandler:function(){return b.$VideoUploadReceiveRequestManager67(a)}})}};d.__handleResponseTimeout=function(a){var b=this;this.inform("request-timeout",{start_offset:this.$VideoUploadReceiveRequestManager38.getStartOffset(),end_offset:this.$VideoUploadReceiveRequestManager38.getEndOffset(),transport_retries:this.$VideoUploadReceiveRequestManager11,server_retries:this.$VideoUploadReceiveRequestManager14,timeout_retries:this.$VideoUploadReceiveRequestManager15,upload_speed:this.$VideoUploadReceiveRequestManager17,request_manager_state:this.$VideoUploadReceiveRequestManager19,debug:{upload_domain:this.$VideoUploadReceiveRequestManager39,single_request_id:this.$VideoUploadReceiveRequestManager13}});this.$VideoUploadReceiveRequestManager45.abort();this.$VideoUploadReceiveRequestManager45=null;this.$VideoUploadReceiveRequestManager17=null;this.$VideoUploadReceiveRequestManager37.notifyTransportError();var c=function(){var a=b.$VideoUploadReceiveRequestManager38.getEndOffset()-b.$VideoUploadReceiveRequestManager38.getStartOffset();a=Math.floor(a/2);a=Math.max(a,b.$VideoUploadReceiveRequestManager18);var c=b.$VideoUploadReceiveRequestManager38.getEndOffset();c=Math.min(c,b.$VideoUploadReceiveRequestManager38.getStartOffset()+a);b.$VideoUploadReceiveRequestManager38.setEndOffset(c);b.$VideoUploadReceiveRequestManager44=null;b.$VideoUploadReceiveRequestManager19="resending after timeout with chunksize="+a;b.$VideoUploadReceiveRequestManager53(i.TIMEOUT_RETRY)},d=function(){b.$VideoUploadReceiveRequestManager59({error_code:1006,error_description:g._("Your browser appears to be offline. Please check your internet connection and try again."),error_summary:g._("No hay conexi\u00f3n de red"),error_is_transient:!0})};((a=this.$VideoUploadReceiveRequestManager38)==null?void 0:a.getRetryState())==null?++this.$VideoUploadReceiveRequestManager15<=this.$VideoUploadReceiveRequestManager6?c():d():this.$VideoUploadReceiveRequestManager38.getRetryState().handleRetry({context:{location:"receive-timeout",error_code:1006},retryHandler:function(a){return c()},failureHandler:function(){return d()}})};d.__hasInvalidStartOffsetAndHasRetries=function(a){return a===h&&this.$VideoUploadReceiveRequestManager14<this.$VideoUploadReceiveRequestManager4};d.$VideoUploadReceiveRequestManager55=function(a){var b,c=this;this.$VideoUploadReceiveRequestManager37.notifyTransportError();this.$VideoUploadReceiveRequestManager17=null;((b=this.$VideoUploadReceiveRequestManager38)==null?void 0:b.getRetryState())==null?(this.$VideoUploadReceiveRequestManager15=0,this.$VideoUploadReceiveRequestManager11<this.$VideoUploadReceiveRequestManager2?(this.$VideoUploadReceiveRequestManager19="resending after transport failure",this.$VideoUploadReceiveRequestManager11++,this.$VideoUploadReceiveRequestManager45=null,this.$VideoUploadReceiveRequestManager65(i.TRANSPORT_FAILURE_RETRY,this.$VideoUploadReceiveRequestManager68(this.$VideoUploadReceiveRequestManager8,this.$VideoUploadReceiveRequestManager11,this.$VideoUploadReceiveRequestManager3))):this.$VideoUploadReceiveRequestManager67(a)):this.$VideoUploadReceiveRequestManager38.getRetryState().handleRetry({context:{location:"receive-transport_issue",error_code:a.getError()},retryHandler:function(a){c.$VideoUploadReceiveRequestManager45=null,c.$VideoUploadReceiveRequestManager19="resending after transport failure",c.$VideoUploadReceiveRequestManager65(i.TRANSPORT_FAILURE_RETRY,a)},failureHandler:function(){return c.$VideoUploadReceiveRequestManager67(a)}})};d.$VideoUploadReceiveRequestManager67=function(a){this.$VideoUploadReceiveRequestManager59({error_code:a.getError(),error_description:a.getErrorDescription(),error_summary:a.getErrorSummary(),error_is_transient:a.isTransient(),upload_domain:this.uploadDomain,www_request_id:(a=a.getPayload())==null?void 0:a.__www_request_id__})};d.$VideoUploadReceiveRequestManager59=function(a){this.$VideoUploadReceiveRequestManager19="handling failure error",a.debug=babelHelpers["extends"]({},a.debug,{single_request_id:this.$VideoUploadReceiveRequestManager13}),this.inform("request-failed",a),this.$VideoUploadReceiveRequestManager54()};d.$VideoUploadReceiveRequestManager56=function(a){this.$VideoUploadReceiveRequestManager37.notifyProgress(a),this.$VideoUploadReceiveRequestManager38&&this.$VideoUploadReceiveRequestManager38.getFile()&&this.inform("request-progressed",{file_size:this.$VideoUploadReceiveRequestManager38.getFile().getSize(),start_offset:this.$VideoUploadReceiveRequestManager38.getStartOffset(),sent_bytes:a.loaded,transport_retries:this.$VideoUploadReceiveRequestManager11,upload_domain:this.$VideoUploadReceiveRequestManager39,debug:{single_request_id:this.$VideoUploadReceiveRequestManager13}})};d.$VideoUploadReceiveRequestManager50=function(){var a;this.inform("online");this.$VideoUploadReceiveRequestManager11=0;this.$VideoUploadReceiveRequestManager15=0;(a=this.$VideoUploadReceiveRequestManager38)==null?void 0:(a=a.getRetryState())==null?void 0:a.resetDelay();this.$VideoUploadReceiveRequestManager46&&this.$VideoUploadReceiveRequestManager53(i.BACK_ONLINE)};d.$VideoUploadReceiveRequestManager51=function(){this.inform("offline")};d.$VideoUploadReceiveRequestManager68=function(a,b,c){var d;this.$VideoUploadReceiveRequestManager23?d=Math.min(Math.pow(a,b),8)*1e3:d=Math.pow(a,b)*1e3;c>0&&(d=Math.min(d,c));return d};d.$VideoUploadReceiveRequestManager57=function(a,b){b!==void 0&&b!==null&&b>0?b=b:b=10;a=Math.floor(a/b*this.$VideoUploadReceiveRequestManager7/100);return Math.max(a,3e4)};d.$VideoUploadReceiveRequestManager63=function(){return this.$VideoUploadReceiveRequestManager28?this.$VideoUploadReceiveRequestManager28:this.$VideoUploadReceiveRequestManager38.getWaterfallID()};return c}(b("mixin")(b("cr:909282")));e.exports=a}),null);
__d("VideoUploadStartRequestManager",["Assert","FileHasher","VideoUploadRequest","clearTimeout","mixin","performanceNow","requireCond","setTimeout","cr:909282"],(function(a,b,c,d,e,f){var g;a=function(a){babelHelpers.inheritsLoose(c,a);function c(b,c,d,e,f,g,h,i){var j;j=a.call(this)||this;j.$VideoUploadStartRequestManager1=b;j.$VideoUploadStartRequestManager2=c;j.$VideoUploadStartRequestManager3=d;j.$VideoUploadStartRequestManager4=e;j.$VideoUploadStartRequestManager5=0;j.$VideoUploadStartRequestManager6=f;j.$VideoUploadStartRequestManager7=g;j.$VideoUploadStartRequestManager8=h;j.$VideoUploadStartRequestManager9=i;j.$VideoUploadStartRequestManager10=0;return j}var d=c.prototype;d.getRequest=function(){return this.$VideoUploadStartRequestManager11};d.sendRequest=function(a){var c=this;if(this.$VideoUploadStartRequestManager12||this.$VideoUploadStartRequestManager11)return;this.$VideoUploadStartRequestManager13=a;this.$VideoUploadStartRequestManager6&&this.$VideoUploadStartRequestManager13.getFile().getFile()&&this.$VideoUploadStartRequestManager13.getFile().getFile().size<this.$VideoUploadStartRequestManager7&&b("FileHasher").isSupported()?(this.$VideoUploadStartRequestManager14=(g||(g=b("performanceNow")))(),this.$VideoUploadStartRequestManager12=new(b("FileHasher"))(),this.$VideoUploadStartRequestManager12.hash(this.$VideoUploadStartRequestManager13.getFile().getFile(),function(a){c.$VideoUploadStartRequestManager14=(g||(g=b("performanceNow")))()-c.$VideoUploadStartRequestManager14,c.$VideoUploadStartRequestManager15=a.hash,c.$VideoUploadStartRequestManager12.destroy(),c.$VideoUploadStartRequestManager12=null,a.hash||(c.$VideoUploadStartRequestManager16=a.exception),c.$VideoUploadStartRequestManager17()})):this.$VideoUploadStartRequestManager17()};d.$VideoUploadStartRequestManager17=function(){this.$VideoUploadStartRequestManager18(),this.inform("request-started",{hash_time:this.$VideoUploadStartRequestManager14,hash_exception:this.$VideoUploadStartRequestManager16})};d.$VideoUploadStartRequestManager18=function(){b("clearTimeout")(this.$VideoUploadStartRequestManager19),this.$VideoUploadStartRequestManager19=null,this.$VideoUploadStartRequestManager11=this.__getVideoUploadRequest(this.$VideoUploadStartRequestManager1).setAllowCrossOrigin(!0).setData(this.__getDataToSend(this.$VideoUploadStartRequestManager13,this.$VideoUploadStartRequestManager15)).setWaterfallID(this.$VideoUploadStartRequestManager13.getWaterfallID()).setSuccessHandler(this.$VideoUploadStartRequestManager20.bind(this)).setErrorHandler(this.$VideoUploadStartRequestManager21.bind(this)).setTransportErrorHandler(this.$VideoUploadStartRequestManager22.bind(this)),this.$VideoUploadStartRequestManager11.send()};d.__getVideoUploadRequest=function(a){return new(b("VideoUploadRequest"))(a)};d.__getDataToSend=function(a,b){return{file_size:a.getFile().getSize(),file_extension:a.getFile().getExtension(),target_id:a.getTargetID(),source:a.getSource(),composer_dialog_version:a.getComposerDialogVersion(),waterfall_id:a.getWaterfallID(),composer_session_id:a.getComposerSessionID(),composer_entry_point_ref:a.getComposerEntryPointRef&&a.getComposerEntryPointRef(),composer_work_shared_draft_mode:a.getComposerWorkSharedDraftMode(),has_file_been_replaced:a.getHasFileBeenReplaced(),supports_chunking:a.getSupportsChunking(),supports_file_api:a.getSupportsFileAPI(),partition_start_offset:a.getPartitionStartOffset(),partition_end_offset:a.getPartitionEndOffset(),creator_product:a.getCreatorProduct(),original_file_hash:b,spherical:a.getIsSphericalVideo(),spherical_metadata:a.getSphericalMetadata(),video_publisher_action_source:a.getVideoPublisherActionSource()}};d.cancelRequest=function(){this.$VideoUploadStartRequestManager23(),this.inform("request-canceled")};d.$VideoUploadStartRequestManager24=function(a){b("clearTimeout")(this.$VideoUploadStartRequestManager19),this.$VideoUploadStartRequestManager19=b("setTimeout")(this.$VideoUploadStartRequestManager18.bind(this),a)};d.$VideoUploadStartRequestManager23=function(){this.$VideoUploadStartRequestManager12&&(this.$VideoUploadStartRequestManager12.destroy(),this.$VideoUploadStartRequestManager12=null),this.$VideoUploadStartRequestManager11&&(this.$VideoUploadStartRequestManager11.abort(),this.$VideoUploadStartRequestManager11=null),this.$VideoUploadStartRequestManager10=0,this.$VideoUploadStartRequestManager5=0,this.$VideoUploadStartRequestManager13=null,b("clearTimeout")(this.$VideoUploadStartRequestManager19),this.$VideoUploadStartRequestManager19=null};d.$VideoUploadStartRequestManager25=function(a,b,c){a=Math.pow(a,b)*1e3;c>0&&(a=Math.min(a,c));return a};d.$VideoUploadStartRequestManager20=function(a){var c;(c=this.$VideoUploadStartRequestManager13)==null?void 0:(c=c.getRetryState())==null?void 0:c.resetDelay();c=a.getPayload();this.inform("request-finished",this.__getSuccessInformData(c));this.$VideoUploadStartRequestManager11=null;b("Assert").isTrue(this.$VideoUploadStartRequestManager12==null,"Unexpected: if file hasher is not null, clean up is required.")};d.__getSuccessInformData=function(a){return{video_id:a.video_id,xpv_asset_id:a.xpv_asset_id,upload_session_id:a.upload_session_id,fb_region:a.region_hint,start_offset:a.start_offset,end_offset:a.end_offset,transport_retries:this.$VideoUploadStartRequestManager5,server_retries:this.$VideoUploadStartRequestManager10,skip_upload:a.skip_upload,hash_time:this.$VideoUploadStartRequestManager14}};d.$VideoUploadStartRequestManager26=function(a){this.inform("request-failed",this.$VideoUploadStartRequestManager27(a)),this.$VideoUploadStartRequestManager11=null,b("Assert").isTrue(this.$VideoUploadStartRequestManager12==null,"Unexpected: if file hasher is not null, clean up is required.")};d.$VideoUploadStartRequestManager21=function(a){var b,c=this;this.$VideoUploadStartRequestManager11=null;var d=(b=this.$VideoUploadStartRequestManager13)==null?void 0:b.getRetryState();d==null?(this.$VideoUploadStartRequestManager5=0,a.isTransient()&&this.$VideoUploadStartRequestManager10<this.$VideoUploadStartRequestManager8?(this.$VideoUploadStartRequestManager10++,this.$VideoUploadStartRequestManager24(this.$VideoUploadStartRequestManager25(this.$VideoUploadStartRequestManager9,this.$VideoUploadStartRequestManager10))):this.$VideoUploadStartRequestManager26(a)):d.handleRetry({context:{location:"start-server_issue",error_code:a.getError()},predicate:function(){return a.isTransient()},retryHandler:function(a){c.$VideoUploadStartRequestManager10=d.getTotalRetryCount(),c.$VideoUploadStartRequestManager24(a)},failureHandler:function(){return c.$VideoUploadStartRequestManager26(a)}})};d.$VideoUploadStartRequestManager22=function(a){var b,c=this;((b=this.$VideoUploadStartRequestManager13)==null?void 0:b.getRetryState())==null?this.$VideoUploadStartRequestManager2===0||this.$VideoUploadStartRequestManager5>=this.$VideoUploadStartRequestManager2?this.$VideoUploadStartRequestManager26(a):(this.$VideoUploadStartRequestManager5++,this.$VideoUploadStartRequestManager11=null,this.$VideoUploadStartRequestManager24(this.$VideoUploadStartRequestManager25(this.$VideoUploadStartRequestManager3,this.$VideoUploadStartRequestManager5,this.$VideoUploadStartRequestManager4))):this.$VideoUploadStartRequestManager13.getRetryState().handleRetry({context:{location:"start-transport_issue",error_code:a.getError()},retryHandler:function(a){c.$VideoUploadStartRequestManager11=null,c.$VideoUploadStartRequestManager24(a)},failureHandler:function(){return c.$VideoUploadStartRequestManager26(a)}})};d.$VideoUploadStartRequestManager27=function(a){return{error_code:a.getError(),error_description:a.getErrorDescription(),error_summary:a.getErrorSummary(),transport_retries:this.$VideoUploadStartRequestManager5,server_retries:this.$VideoUploadStartRequestManager10,error_is_transient:a.isTransient(),www_request_id:(a=a.getPayload())==null?void 0:a.__www_request_id__}};return c}(b("mixin")(b("cr:909282")));e.exports=a}),null);
__d("ISOVideoBoxConstants",[],(function(a,b,c,d,e,f){"use strict";a=8;f.BOX_BASE_SIZE=a;b=[255,204,130,99,248,85,74,147,136,20,88,122,2,82,31,221];f.GSPHERICAL_UUID=b;c=[174,36,178,77,60,143,79,24,138,123,224,9,193,56,53,193];f.FBSPHERICAL_UUID=c}),null);
__d("VideoSphericalMetadataUtil",["SphericalVideoMetadataTags","VideoProjection","VideoStereoFormat"],(function(a,b,c,d,e,f){"use strict";f.parseXMLToDocument=a;f.stringToProjectionType=c;f.stringToStereoMode=d;f.getUnsupportedGSphericalTagsXML=e;f.isGoogleVR180=g;f.arrayBufferToFile=h;f.stringToArrayBuffer=i;f.bufferToFile=j;f.uuidArrayEquals=k;function a(a){if(!a)return null;a=a.replace(/\0/g,"");if(window.DOMParser){var b=new DOMParser();b=b.parseFromString(a,"text/xml")}else b=new window.ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a);return b}function c(a){if(Object.values(b("VideoProjection")).includes(a))return a;else return null}function d(a){if(Object.values(b("VideoStereoFormat")).includes(a))return a;else return null}function e(a){a=a.getElementsByTagNameNS("*","*");var c=null;for(var d=0;d<a.length;d++){var e=a[d],f=e.nodeName,g=e.parentElement;if(f!=="parsererror"&&g&&g.nodeName!=="parsererror"&&Object.values(b("SphericalVideoMetadataTags").GSPHERICAL).indexOf(f)<0&&Object.values(b("SphericalVideoMetadataTags").GSPHERICAL).indexOf(g.nodeName)<0){c||(c="");g=e.outerHTML;c+="<"+f+g.slice(f.length+1,-(f.length+1))+f+">"}}return c}function g(a,b,c,d,e){if(null!==b&&null!==c&&null!==d&&null!==e&&a.projectionType==="equirectangular"&&(a.stereoMode==="left-right"||a.stereoMode==="top-bottom")){a=parseInt(b,10);b=parseInt(c,10);c=parseInt(d,10);d=parseInt(e,10);if(Math.abs(a-c/2)<=1&&Math.abs(b-d)<=1)return!0}return!1}function h(a,b,c){return new File([a],b,{type:c})}function i(a){var b=new ArrayBuffer(a.length),c=new DataView(b);for(var d=0;d<a.length;d++)c.setUint8(d,a.charCodeAt(d));return b}function j(a,b,c){a=a.buffer;return this.arrayBufferToFile(a,b,c)}function k(a,b){if(a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}}),null);
__d("VideoUploadMetadataParserErrorCode",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["FILE_READING_NOT_SUPPORTED","UNKNOWN_FILE_EXTENSION","INTERNAL_FAILURE"]);c=a;e.exports=c}),null);
__d("checkForSphericalTag",["VideoSphericalMetadataUtil"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a){a=b("VideoSphericalMetadataUtil").parseXMLToDocument(a);if(!a)return!1;a=a.getElementsByTagNameNS("*","Spherical");if(a.length===0)return!1;a=a[0];a=a.childNodes[0].nodeValue;return a.toLowerCase()==="true"}}),null);
__d("getVideo64BitAtomLength",["Int64"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a,c,d,e){var f=a.getUint32(c+e+d);a=a.getUint32(c+d+e+e);return new(b("Int64"))(a,f).toNumber()}}),null);
__d("VideoUploadMetadataParser",["regeneratorRuntime","Promise","Bootloader","ErrorNormalizeUtils","ISOVideoBoxConstants","VideoSphericalMetadataUtil","VideoUploadFeatureDetector","VideoUploadMetadataParserErrorCode","VideoUploadSphericalLogger","checkForSphericalTag","fileSlice","getErrorSafe","getVideo64BitAtomLength","gkx","nullthrows","promiseDone"],(function(a,b,c,d,e,f){var g=4,h=4,i=5242880,j=24,k=88,l=20,m=16,n=4,o=84,p=20,q=62,r=4,s=12,t=12,u=16,v=16,w={0:36,1:52,2:72},x=1,y=1,z=4,A=1,B=1,C=4,D=4,E=1e3,F=16,G=32,H=34;c=function(){function c(a,b,c,d){this.$1=a,this.$2=b==null?function(){}:b,this.$4=c,this.$5=!0,this.$3=d}var d=c.prototype;d.getHandler=function(){return this.$2};d.$6=function(a){this.$2(a),this.$3!=null&&this.$3({success:!0,metadata:a})};d.$7=function(a,c){this.$2(null);if(this.$3!=null){c=c==null?void 0:b("ErrorNormalizeUtils").normalizeError(b("getErrorSafe")(c));this.$3({success:!1,errorCode:a,errorObject:c})}};d.parse=function(){if(!b("VideoUploadFeatureDetector").supportsFileReading()){this.$7(b("VideoUploadMetadataParserErrorCode").FILE_READING_NOT_SUPPORTED);return null}switch(this.$1.getExtension()){case"mp4":case"mov":case"m4v":case"3gp":case"3g2":b("VideoUploadSphericalLogger").setFileExtension(this.$1.getExtension());break;case"mkv":if(b("gkx")("816873")){b("VideoUploadSphericalLogger").setFileExtension(this.$1.getExtension());break}default:this.$7(b("VideoUploadMetadataParserErrorCode").UNKNOWN_FILE_EXTENSION);return null}return this.$8()};d.$8=function(){var a=this,c,d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:c=this.$9();d=this.$10();return e.abrupt("return",new(b("Promise"))(function(e,f){try{b("promiseDone")(b("Promise").all([c,d]).then(function(b){var c=b[0];if(c.completed){b=b[1];c.videoPlayerData=b;a.$6(c)}e(c)},function(c){a.$7(b("VideoUploadMetadataParserErrorCode").INTERNAL_FAILURE,c),f(c)}))}catch(c){a.$7(b("VideoUploadMetadataParserErrorCode").INTERNAL_FAILURE,c),f(c)}}));case 3:case"end":return e.stop()}},null,this)};d.$9=function(){var a=this,c;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.t0=this.$1.getExtension();d.next=d.t0==="mp4"?3:d.t0==="mov"?3:d.t0==="m4v"?3:d.t0==="3gp"?3:d.t0==="3g2"?3:d.t0==="mkv"?5:8;break;case 3:c=this.$11(0,Math.min(i,this.$1.getSize()||0),null);return d.abrupt("break",9);case 5:d.next=7;return b("regeneratorRuntime").awrap(new(b("Promise"))(function(d,e){b("Bootloader").loadModules(["VideoUploadMetadataMKVParser"],function(a){a=new a(this.$1);c=a.parse();d()}.bind(a),"VideoUploadMetadataParser")}));case 7:return d.abrupt("break",9);case 8:throw new Error("Unrecognized file extension in _parseImpl");case 9:return d.abrupt("return",b("nullthrows")(c));case 10:case"end":return d.stop()}},null,this)};d.$11=function(a,c,d){var e=this,f=new FileReader(),g=new(b("Promise"))(function(g,h){f.onload=function(j){var k,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:m.prev=0;if(f.result instanceof ArrayBuffer){m.next=3;break}throw new Error("reader.result is something other than ArrayBuffer");case 3:k=e.$12(new DataView(f.result),0,c-a,a,d);if(!k.completed){m.next=10;break}j=e.$13(k);j.completed=!0;g(j);m.next=14;break;case 10:m.next=12;return b("regeneratorRuntime").awrap(e.$11(a+k.nextOffset,Math.min(e.$1.getSize()||0,a+k.nextOffset+i),k));case 12:l=m.sent,g(l);case 14:m.next=19;break;case 16:m.prev=16,m.t0=m["catch"](0),h(m.t0);case 19:case"end":return m.stop()}},null,this,[[0,16]])};var j=e.$1.getFile();f.readAsArrayBuffer(b("fileSlice").call(j,a,c))});return g};d.$10=function(){if(!this.$4||!a.URL||!a.URL.createObjectURL)return null;var c=this.$1.getFile(),d=document.createElement("video"),e=new(b("Promise"))(function(a,b){var c=window.setTimeout(function(){window.clearTimeout(c),b("Video onloadedmetadata timed out")},E)}),f=new(b("Promise"))(function(b,e){d.onloadedmetadata=function(){try{var a={width:d.videoWidth,height:d.videoHeight};b(a)}catch(a){e(a)}};try{d.src=a.URL.createObjectURL(c)}catch(a){e(a)}});return b("Promise").race([f,e])};d.$14=function(a,b,c){var d=[];for(var e=0;e<c;e++)d.push(String.fromCharCode(a.getUint8(b+e)));return d.join("")};d.$15=function(a,b,c){var d={version:null,ambisonic_type:null,ambisonic_order:null,ambisonic_channel_ordering:null,ambisonic_normalization:null,num_channels:null,channel_map:[]},e=0;d.version=a.getUint8(b+e);e=x;d.ambisonic_type=a.getUint8(b+e);e+=y;d.ambisonic_order=a.getUint32(b+e);e+=z;d.ambisonic_channel_ordering=a.getUint8(b+e);e+=A;d.ambisonic_normalization=a.getUint8(b+e);e+=B;d.num_channels=a.getUint32(b+e);e+=C;for(var f=0;f<d.num_channels;f++){d.channel_map.push(a.getUint32(b+e));e+=D;if(e>c)return null}return JSON.stringify(d)};d.$16=function(a,c,d,e){try{var f=h+g,i=b("ISOVideoBoxConstants").GSPHERICAL_UUID.length;if(f+i<d){var j=[];for(var k=0;k<i;k++)j.push(a.getUint8(c+f+k));k=b("VideoSphericalMetadataUtil").uuidArrayEquals(j,b("ISOVideoBoxConstants").GSPHERICAL_UUID);j=b("VideoSphericalMetadataUtil").uuidArrayEquals(j,b("ISOVideoBoxConstants").FBSPHERICAL_UUID);f+=i;if(k||j){i=this.$14(a,c+f,d-f);b("checkForSphericalTag")(i)&&(e.sphericalMetadata.spherical=!0,j?e.sphericalMetadata.FBSphericalMetadataXML=i:e.sphericalMetadata.sphericalMetadataXml=i)}}}catch(a){}};d.$12=function(a,c,d,e,f){f=f||{widths:[],heights:[],streamTypes:[],streamDurations:[],spherical:!1,sphericalMetadata:{sphericalMetadataXml:null,FBSphericalMetadataXML:null,fbSpatialAudioMetadataXml:null,ytSa3dMetadataJson:null},isParsingInMediaInformationAtom:!1,endOfMediaInformationAtomOffset:null,streamSampleCounts:[],samples:[]};var i=null;while(c<d){var x=a.getUint32(c),y=this.$14(a,c+g,h);x===1&&(x=b("getVideo64BitAtomLength")(a,c,h,g));if(c+x>d){f.completed=!1;f.nextOffset=c;x>d&&(f.nextOffset+=x);return f}f.isParsingInMediaInformationAtom&&c>=Number(f.endOfMediaInformationAtomOffset)&&(f.isParsingInMediaInformationAtom=!1,f.endOfMediaInformationAtomOffset=null);if(c+e===0&&y!=="ftyp")throw new Error("No ftyp atom");if(x===0)throw new Error("len is 0");var z=function(){var b=a.getUint32(c+l),d=a.getUint32(c+j);return d/b};switch(y){case"moov":case"trak":case"mdia":case"stbl":c+=g+h;break;case"mvhd":f.duration=z();c+=x;break;case"tkhd":y=a.getUint16(c+o);var A=a.getUint16(c+k);f.widths.push(y);f.heights.push(A);f.samples.push({descriptions:[]});i=a.getUint32(c+p);c+=x;break;case"hdlr":if(!f.isParsingInMediaInformationAtom){y=this.$14(a,c+m,n);switch(y){case"vide":y="video";break;case"soun":y="audio";break;case"subt":y="subtitle";break;default:y="data"}f.streamTypes.push(y)}c+=x;break;case"mdhd":f.streamDurations.push(z());c+=x;break;case"uuid":this.$16(a,c,x,f);c+=x;break;case"meta":A=t+s+r;y=this.$14(a,c+A,4);if(y!=="face"){c+=x;break}z=g+h+q;A=this.$14(a,c+z,x-z);A!==null&&((f.sphericalMetadata.fbSpatialAudioMetadataXml===null||f.sphericalMetadata.fbSpatialAudioMetadataXml===void 0)&&(f.sphericalMetadata.fbSpatialAudioMetadataXml="<fb360_spatial_audio>"),i?f.sphericalMetadata.fbSpatialAudioMetadataXml+='\n                <track id="'+i.toString()+'">\n                  '+A+"\n                </track>\n              ":f.sphericalMetadata.fbSpatialAudioMetadataXml+="\n                <spatial_audio_formatting>\n                  "+A+"\n                </spatial_audio_formatting>\n              ");c+=x;break;case"minf":y=this.$14(a,c+2*g+h,h);y==="smhd"||y==="vmhd"?(c+=g+h,f.isParsingInMediaInformationAtom=!0,f.endOfMediaInformationAtomOffset=c+x):(f.streamSampleCounts.push(null),c+=x);break;case"stsd":c+=u;break;case"avc1":if(this.$5&&f.samples.length>0){z=f.samples[f.samples.length-1];z.descriptions.push({width:a.getUint16(c+G),height:a.getUint16(c+H)})}c+=x;break;case"mp4a":case"sowt":case"raw ":case"twos":case"fl32":case"fl64":case"in24":case"in32":case"ulaw":case"alaw":case"lpcm":case"Opus":A=a.getUint16(c+v).toString();Object.prototype.hasOwnProperty.call(w,A)?c+=w[A]:c+=x;break;case"SA3D":y=this.$15(a,c+g+h,x);y!==null&&(f.sphericalMetadata.ytSa3dMetadataJson===null&&(f.sphericalMetadata.ytSa3dMetadataJson=y));c+=x;break;case"stsz":case"stz2":f.streamSampleCounts.push(a.getUint32(c+F));c+=x;break;default:c+=x}}f.completed=!0;f.sphericalMetadata.fbSpatialAudioMetadataXml&&(f.sphericalMetadata.fbSpatialAudioMetadataXml+="</fb360_spatial_audio>");return f};d.$13=function(a){var c={streams:{numAudioTracks:0},format:{},metadata:{}},d=a.widths.length,e=a.heights.length,f=a.streamTypes.length,g=a.streamDurations.length,h=a.streamSampleCounts.length,i=a.samples.length;if(d!==e||d!==f||d!==g||d!==h||d!==i)throw new Error("Number of parsed widths, heights, durations or sample counts for video file are mismatched.");for(var e=0;e<d;e++){var j={width:a.widths[e],height:a.heights[e],duration:a.streamDurations[e],type:a.streamTypes[e],sampleCount:a.streamSampleCounts[e]};if(j.type==="video"){this.$5&&a.samples[e].descriptions.forEach(function(a){a.width>j.width&&a.height>j.height&&(j.width=a.width,j.height=a.height)});f=j.width*j.height;g=c.streams.primaryVideo;(!g||g.width*g.height>f)&&(c.streams.primaryVideo=j)}else if(j.type==="audio"){h=c.streams.primaryAudio;(!h||h.duration<j.duration)&&(c.streams.primaryAudio=j);c.streams.numAudioTracks++}}c.format.duration=a.duration;c.format.isSpherical=a.sphericalMetadata.spherical;a.sphericalMetadata.spherical&&(c.metadata.sphericalMetadataXml=a.sphericalMetadata.sphericalMetadataXml,c.metadata.FBSphericalMetadataXML=a.sphericalMetadata.FBSphericalMetadataXML,c.metadata.fbSpatialAudioMetadataXml=a.sphericalMetadata.fbSpatialAudioMetadataXml,c.metadata.ytSa3dMetadataJson=a.sphericalMetadata.ytSa3dMetadataJson);b("VideoUploadSphericalLogger").setHasSphericalMetadata(a.sphericalMetadata.spherical);return c};return c}();e.exports=c}),null);
__d("VideoUploadSession",["requireCond","cr:909282","AsyncRequest","GraphQLVideoPublishUtils","SubscriptionsHandler","VideoUploadCrashMonitor","VideoUploadFeatureDetector","VideoUploadFileValidator","VideoUploadGraphQLPostRequestManager","VideoUploadLogger","VideoUploadMetadataParser","VideoUploadPostRequestManager","VideoUploadReceiveRequestManager","VideoUploadRequestContext","cr:1661398","VideoUploadStartRequestManager","WaterfallIDGenerator","getByPath","gkx","mixin","mediaUploadLogStackTrace"],(function(a,b,c,d,e,f){var g={CANCELED:"canceled",ABANDONED:"abandoned",SHUTDOWN:"shutdown"};a=function(a){babelHelpers.inheritsLoose(c,a);function c(c){var d;d=a.call(this)||this;d.$VideoUploadSession1=c.source;d.$VideoUploadSession2=c.composer_dialog_version;d.$VideoUploadSession3=c.target_id;d.$VideoUploadSession4=c.logging_delay;d.$VideoUploadSession5=c.silent_file_validation;d.$VideoUploadSession6=c.background_upload;d.$VideoUploadSession7=c.actor_id;d.$VideoUploadSession8=c.composer_entry_point_ref;d.$VideoUploadSession9=c.composer_work_shared_draft_mode;d.$VideoUploadSession10=c.video_publisher_action_source;d.$VideoUploadSession11=c.monitor_crashes;d.$VideoUploadSession12=c.isMultiMediaPost;d.$VideoUploadSession13=c.container_type;d.$VideoUploadSession14=c.number_of_partitions;d.$VideoUploadSession15=c.multi_partitioning_enabled;d.$VideoUploadSession16=c.change_default_chunk_size;d.$VideoUploadSession17=c.has_file_been_replaced?c.has_file_been_replaced:!1;d.$VideoUploadSession16&&(d.$VideoUploadSession18=c.client_chunk_size);d.$VideoUploadSession19=c.early_receive;d.$VideoUploadSession20=!1;d.$VideoUploadSession21=c.accept_dimensions_from_player;d.$VideoUploadSession22=c.ad_account_id;d.$VideoUploadSession23=c.waterfall_id;d.$VideoUploadSession24=new(b("VideoUploadFileValidator"))({minSize:c.min_size,maxSize:c.max_size,minLength:c.min_length,maxLength:c.max_length,minWidth:c.min_width,minHeight:c.min_height,extensions:c.extensions,source:c.source,require16to9AspectRatio:c.require_16to9_aspect_ratio,minAspectRatio:c.min_aspect_ratio,maxAspectRatio:c.max_aspect_ratio,acceptDimensionsFromPlayer:c.accept_dimensions_from_player});d.$VideoUploadSession25=b("VideoUploadFeatureDetector").supportsChunking();d.$VideoUploadSession26=b("VideoUploadFeatureDetector").supportsFileAPI();d.$VideoUploadSession25?(d.$VideoUploadSession27=c.parallel_chunk_uploads,d.$VideoUploadSession27&&(d.$VideoUploadSession28=c.parallel_chunk_upload_filesize,d.$VideoUploadSession29=c.default_chunk_size)):d.$VideoUploadSession27=!1;d.$VideoUploadSession30=c.shutdown_logging_enabled;d.$VideoUploadSession31=d.$VideoUploadSession32(c);d.$VideoUploadSession33=d.$VideoUploadSession34(c);if(d.$VideoUploadSession27)if(d.$VideoUploadSession15){var e=0;d.$VideoUploadSession35=[];for(e=0;e<d.$VideoUploadSession14-1;e++)d.$VideoUploadSession35[e]=d.$VideoUploadSession34(c)}else d.$VideoUploadSession35=d.$VideoUploadSession34(c);d.$VideoUploadSession36=d.$VideoUploadSession37(c);d.$VideoUploadSession38=d.$VideoUploadSession39(c);d.$VideoUploadSession40=c.log_free_local_storage;d.$VideoUploadSession41=null;return d}var d=c.prototype;d.$VideoUploadSession42=function(){this.$VideoUploadSession43=[];this.$VideoUploadSession44=[];this.$VideoUploadSession45=[];this.$VideoUploadSession46=[];this.$VideoUploadSession47=[];var a=0;for(a=0;a<this.$VideoUploadSession48-1;a++)this.$VideoUploadSession43.push(!1)};d.$VideoUploadSession49=function(){var a;this.$VideoUploadSession23==null&&(this.$VideoUploadSession23=b("WaterfallIDGenerator").generate());this.$VideoUploadSession50=new(b("VideoUploadLogger"))({actor_id:this.$VideoUploadSession7,ad_account_id:this.$VideoUploadSession22,source:this.$VideoUploadSession1,composer_dialog_version:this.$VideoUploadSession2,waterfall_id:this.$VideoUploadSession23,target_id:this.$VideoUploadSession3,delay:this.$VideoUploadSession4,is_chunked_upload:this.$VideoUploadSession25,composer_entry_point_ref:this.$VideoUploadSession8,composer_work_shared_draft_mode:this.$VideoUploadSession9,container_type:this.$VideoUploadSession13,has_file_been_replaced:this.$VideoUploadSession17,composer_session_id:this.$VideoUploadSession51,asset_id:(a=this.$VideoUploadSession52)==null?void 0:a.getStableAssetID()});this.inform("set-waterfall-id",{waterfallID:this.$VideoUploadSession23})};d.createTestLogger=function(){this.$VideoUploadSession49()};d.$VideoUploadSession53=function(){this.$VideoUploadSession50||this.$VideoUploadSession49();return this.$VideoUploadSession50};d.getLogger=function(){return!this.$VideoUploadSession50?null:this.$VideoUploadSession50};d.$VideoUploadSession54=function(){var a,c=this;a=b("cr:1661398")==null?void 0:(a=b("cr:1661398").VideoUploadRetries)==null?void 0:a.createState();a!=null&&(a.addListener("retry-attempted",function(a){var d=a.delay_retry_count,e=a.total_retry_count,f=a.since_started_ms,g=a.retry_context;a=a.backoff_ms;c.__logEvent(b("VideoUploadLogger").EVENT_RETRY_ATTEMPT,{retries:e,elapsed_time:f,error_trace:g==null?void 0:g.location,error_code:g==null?void 0:g.error_code,debug:{delay_retry_count:d,backoff_ms:a}})}),a.addListener("retries-abandoned",function(a){var d=a.delay_retry_count,e=a.total_retry_count,f=a.since_started_ms,g=a.retry_context;a=a.abandon_reason;c.__logEvent(b("VideoUploadLogger").EVENT_RETRY_ATTEMPT,{retries:e,elapsed_time:f,error:a,error_trace:g==null?void 0:g.location,error_code:g==null?void 0:g.error_code,debug:{delay_retry_count:d}})}));return a};d.start=function(a){var c=this;this.$VideoUploadSession55=null;this.$VideoUploadSession56=null;this.$VideoUploadSession57=null;this.$VideoUploadSession58=!1;this.$VideoUploadSession59=!1;this.$VideoUploadSession60=null;this.$VideoUploadSession52=a;this.$VideoUploadSession61=0;this.$VideoUploadSession62=!1;this.$VideoUploadSession63={sphericalMetadataXml:null,fbSpatialAudioMetadataXml:null,ytSa3dMetadataJson:null};this.$VideoUploadSession64=!1;this.$VideoUploadSession41=this.$VideoUploadSession54();this.$VideoUploadSession49();b("mediaUploadLogStackTrace")({waterfallID:this.$VideoUploadSession23,sourceType:this.$VideoUploadSession1,composerEntryPointRef:this.$VideoUploadSession8});this.$VideoUploadSession15&&(this.$VideoUploadSession48=Math.min(this.$VideoUploadSession14,Math.ceil(this.$VideoUploadSession52.getSize()/this.$VideoUploadSession28)));this.__logEvent(b("VideoUploadLogger").EVENT_REQUESTED_UPLOADING);this.inform("upload-requested");a=new(b("VideoUploadMetadataParser"))(this.$VideoUploadSession52,this.$VideoUploadSession65.bind(this),this.$VideoUploadSession21);a.parse();this.$VideoUploadSession40&&navigator.webkitTemporaryStorage&&navigator.webkitTemporaryStorage.queryUsageAndQuota(function(a,d){c.__logEvent(b("VideoUploadLogger").EVENT_MEASURE_FREE_LOCAL_STORAGE,{free_space_in_device:d})})};d.setTargetID=function(a){this.$VideoUploadSession3=a};d.setComposerSessionID=function(a){this.$VideoUploadSession51=a};d.post=function(a){var c;this.__logEvent(b("VideoUploadLogger").EVENT_STARTED_POST_REQUEST,this.$VideoUploadSession66);this.inform("post-started",a);var d=this.__createPostRequestContext(a);if(b("GraphQLVideoPublishUtils").isGraphQLPublish(this.$VideoUploadSession1,this.$VideoUploadSession8,(c=a==null?void 0:a.isProfilePlus)!=null?c:!1,(c=a==null?void 0:a.shouldPremiere)!=null?c:!1)&&this.$VideoUploadSession38.hasAPISupport(a)){this.$VideoUploadSession38.sendRequest(d);this.$VideoUploadSession67=a;return}this.$VideoUploadSession36.sendRequest(d);this.$VideoUploadSession67=a};d.__createPostRequestContext=function(a){var c=new(b("VideoUploadRequestContext"))();this.__setupPostRequestContext(c,a);return c};d.__setupPostRequestContext=function(a,b){a.setMetadata(b).setVideoID(this.$VideoUploadSession55).setTargetID(this.$VideoUploadSession3).setSource(this.$VideoUploadSession1).setComposerDialogVersion(this.$VideoUploadSession2).setComposerWorkSharedDraftMode(this.$VideoUploadSession9).setWaterfallID(this.$VideoUploadSession23).setComposerSessionID(this.$VideoUploadSession51).setSupportsChunking(this.$VideoUploadSession25).setCreatorProduct(this.$VideoUploadSession52.getCreatorProduct()).setFile(this.$VideoUploadSession52).setHasFileBeenReplaced(this.$VideoUploadSession17),b&&(b.spherical&&(this.$VideoUploadSession62=!0,a.setIsSphericalVideo(this.$VideoUploadSession62)),b.enable_omnistab&&(this.$VideoUploadSession64=!0,a.setEnableOmnistab(this.$VideoUploadSession64))),a.setComposerEntryPointRef&&a.setComposerEntryPointRef(this.$VideoUploadSession8)};d.$VideoUploadSession68=function(a,d){if(this.$VideoUploadSession58){var e={event_reason:d,debug:babelHelpers["extends"]({},this.__fetchReceiveRequestManagerStateLogData(),{is_background_upload:this.$VideoUploadSession6})};d=d===g.CANCELED?b("VideoUploadLogger").EVENT_CANCELED_UPLOADING:b("VideoUploadLogger").EVENT_ABANDONED_UPLOADING;this.$VideoUploadSession69();this.$VideoUploadSession6?(this.$VideoUploadSession59||this.__logEvent(d),this.$VideoUploadSession70&&(this.__logEvent(b("VideoUploadLogger").EVENT_CANCELED_FLOW,e),this.$VideoUploadSession70=!1)):(this.__logEvent(d),this.__logEvent(b("VideoUploadLogger").EVENT_CANCELED_FLOW,e));this.inform("upload-canceled")}else a&&this.$VideoUploadSession55&&c.deleteVideo(this.$VideoUploadSession55)};d.cancel=function(a){a===void 0&&(a=!1),this.$VideoUploadSession68(a,g.CANCELED)};d.abandon=function(a){a===void 0&&(a=!1),this.$VideoUploadSession68(a,g.ABANDONED)};d.isPostInProgress=function(){return this.$VideoUploadSession36.isInProgress()};d.isInProgress=function(){return this.$VideoUploadSession58};d.getHasUploadFinished=function(){return this.$VideoUploadSession59};d.getVideoID=function(){return this.$VideoUploadSession55};d.getUploadTime=function(){return this.$VideoUploadSession71};d.getExPartitionNumber=function(a){var b;for(b=0;b<this.$VideoUploadSession48-1;b++)if(a>=this.$VideoUploadSession44[b]&&a<this.$VideoUploadSession45[b])break;return b===this.$VideoUploadSession48?-1:b};d.getIsSphericalVideo=function(){return this.$VideoUploadSession62||!1};d.startFlow=function(){if(!this.$VideoUploadSession6||this.$VideoUploadSession70)return;this.__logEvent(b("VideoUploadLogger").EVENT_STARTED_FLOW,{is_spherical:this.getIsSphericalVideo()?"true":null});this.$VideoUploadSession70=!0;this.$VideoUploadSession72&&this.$VideoUploadSession72.flowStarted()};d.__extractVideoMetadata=function(a){var c;a=(c=b("getByPath"))(a,["streams","primaryVideo"]);c={source_height:c(a,["height"]),source_width:c(a,["width"]),duration:c(a,["duration"])*1e3};c.original_video_duration=c.duration;return c};d.$VideoUploadSession65=function(a){var c;if(this.$VideoUploadSession5){var d=this.$VideoUploadSession24.getValidationErrorMessage(this.$VideoUploadSession52,a);d?(c={error_summary:d.summary,error_description:d.description},d=!1):d=!0}else d=this.$VideoUploadSession24.validate(this.$VideoUploadSession52,a);if(!d){this.__logEvent(b("VideoUploadLogger").EVENT_INVALIDATED_UPLOADING);this.inform("upload-failed",c);return}this.$VideoUploadSession66=this.__extractVideoMetadata(a);a&&a.format&&(this.$VideoUploadSession62=a.format.isSpherical,a.metadata&&(this.$VideoUploadSession63.sphericalMetadataXml=a.metadata.sphericalMetadataXml,this.$VideoUploadSession63.fbSpatialAudioMetadataXml=a.metadata.fbSpatialAudioMetadataXml,this.$VideoUploadSession63.ytSa3dMetadataJson=a.metadata.ytSa3dMetadataJson));this.$VideoUploadSession6||this.__logEvent(b("VideoUploadLogger").EVENT_STARTED_FLOW,{is_spherical:this.getIsSphericalVideo()?"true":null});this.$VideoUploadSession73=this.$VideoUploadSession27&&this.$VideoUploadSession52.getSize()>=this.$VideoUploadSession28;this.$VideoUploadSession74=!1;this.$VideoUploadSession75=0;this.$VideoUploadSession76=this.$VideoUploadSession75;this.$VideoUploadSession77=0;this.$VideoUploadSession15?this.$VideoUploadSession42():this.$VideoUploadSession43=!1;if(this.$VideoUploadSession73)if(this.$VideoUploadSession15){d=0;this.$VideoUploadSession78=Math.ceil(this.$VideoUploadSession52.getSize()/this.$VideoUploadSession48);var e=this.$VideoUploadSession78,f=this.$VideoUploadSession78;for(d=0;d<this.$VideoUploadSession48-1;d++)this.$VideoUploadSession44[d]=e,e=Math.min(this.$VideoUploadSession44[d]+f,this.$VideoUploadSession52.getSize()),this.$VideoUploadSession45[d]=e,this.$VideoUploadSession46[d]=this.$VideoUploadSession44[d],this.$VideoUploadSession47[d]=0}else this.$VideoUploadSession78=Math.floor(this.$VideoUploadSession52.getSize()/2),this.$VideoUploadSession44=this.$VideoUploadSession78,this.$VideoUploadSession46=this.$VideoUploadSession44,this.$VideoUploadSession47=0,this.$VideoUploadSession45=this.$VideoUploadSession52.getSize();else this.$VideoUploadSession78=this.$VideoUploadSession52.getSize();d=new(b("VideoUploadRequestContext"))().setFile(this.$VideoUploadSession52).setTargetID(this.$VideoUploadSession3).setSource(this.$VideoUploadSession1).setComposerDialogVersion(this.$VideoUploadSession2).setComposerWorkSharedDraftMode(this.$VideoUploadSession9).setWaterfallID(this.$VideoUploadSession23).setComposerSessionID(this.$VideoUploadSession51).setHasFileBeenReplaced(this.$VideoUploadSession17).setSupportsChunking(this.$VideoUploadSession25).setSupportsFileAPI(this.$VideoUploadSession26).setCreatorProduct(this.$VideoUploadSession52.getCreatorProduct()).setPartitionStartOffset(this.$VideoUploadSession75).setPartitionEndOffset(this.$VideoUploadSession78).setRetryState(this.$VideoUploadSession41);this.$VideoUploadSession27&&d.setUseParallelChunks(this.$VideoUploadSession27);this.$VideoUploadSession62&&(d.setIsSphericalVideo(this.$VideoUploadSession62),d.setSphericalMetadata(this.$VideoUploadSession63));d.setComposerEntryPointRef&&d.setComposerEntryPointRef(this.$VideoUploadSession8);d.setVideoPublisherActionSource(this.$VideoUploadSession10);this.$VideoUploadSession79();this.$VideoUploadSession31.sendRequest(d);this.$VideoUploadSession19&&this.$VideoUploadSession16&&this.$VideoUploadSession33.isResumabilityEnabled()&&!this.$VideoUploadSession33.isResumableServiceProxyReceiveEnabled()&&this.$VideoUploadSession80();this.inform("metadata-parsed",a)};d.$VideoUploadSession32=function(a){var b=this.$VideoUploadSession25?a.chunk_start_uri:a.start_uri;b=this.__getVideoUploadStartRequestManager(b,a.start_max_transport_retries,a.start_transport_retry_interval_base,a.start_max_transport_retry_timeout,a.skip_upload_enabled,a.skip_upload_file_size_limit,a.start_max_server_retries,a.start_server_retry_interval_base);b.subscribe("request-started",this.$VideoUploadSession81.bind(this));b.subscribe("request-finished",this.$VideoUploadSession82.bind(this));b.subscribe("request-failed",this.$VideoUploadSession83.bind(this));b.subscribe("request-canceled",this.$VideoUploadSession84.bind(this));return b};d.$VideoUploadSession34=function(a){var b=this.$VideoUploadSession25?a.chunk_receive_uri:a.receive_uri;b=this.__getVideoUploadReceiveRequestManager(b,a);b.subscribe("request-started",this.$VideoUploadSession85.bind(this));b.subscribe("request-progressed",this.$VideoUploadSession86.bind(this));b.subscribe("request-finished",this.$VideoUploadSession87.bind(this));b.subscribe("request-failed",this.$VideoUploadSession88.bind(this));b.subscribe("request-canceled",this.$VideoUploadSession89.bind(this));b.subscribe("request-timeout",this.$VideoUploadSession90.bind(this));b.subscribe("online",this.$VideoUploadSession91.bind(this));b.subscribe("offline",this.$VideoUploadSession92.bind(this));b.subscribe("resumable-called",this.$VideoUploadSession93.bind(this));b.subscribe("resumable-started",this.$VideoUploadSession94.bind(this));b.subscribe("resumable-success",this.$VideoUploadSession95.bind(this));b.subscribe("resumable-failed",this.$VideoUploadSession96.bind(this));return b};d.$VideoUploadSession37=function(a){var b=this.$VideoUploadSession25?a.chunk_post_uri:a.post_uri;b=this.__getVideoUploadPostRequestManager(b,a);b.subscribe("request-finished",this.__handlePostRequestFinished.bind(this));b.subscribe("request-failed",this.$VideoUploadSession97.bind(this));return b};d.$VideoUploadSession39=function(a){a=new(b("VideoUploadGraphQLPostRequestManager"))(isNaN(a.post_max_transport_retries)?0:a.post_max_transport_retries,isNaN(a.post_transport_retry_interval_base)?0:a.post_transport_retry_interval_base,isNaN(a.post_max_server_retries)?0:a.post_max_server_retries,isNaN(a.post_server_retry_interval_base)?0:a.post_server_retry_interval_base);a.subscribe("request-finished",this.__handlePostRequestFinished.bind(this));a.subscribe("request-failed",this.$VideoUploadSession97.bind(this));return a};d.$VideoUploadSession81=function(a,c){this.__logEvent(b("VideoUploadLogger").EVENT_STARTED_UPLOADING,babelHelpers["extends"]({hash_time:c.hash_time,hash_exception:c.hash_exception},this.$VideoUploadSession66)),this.__logEvent(b("VideoUploadLogger").EVENT_STARTED_START_REQUEST,this.$VideoUploadSession66),this.$VideoUploadSession98=Date.now(),this.inform("upload-started")};d.$VideoUploadSession80=function(a){if(!this.$VideoUploadSession20){this.$VideoUploadSession20=!0;a||(a={video_id:null});var b;b=this.__createReceiveRequestContext(a,!1);this.$VideoUploadSession33.sendRequest(b);if(this.$VideoUploadSession73)if(this.$VideoUploadSession15){var c=0;for(c=0;c<this.$VideoUploadSession48-1;c++)b=this.__createReceiveRequestContext(a,!0,c),this.$VideoUploadSession35[c].sendRequest(b)}else b=this.__createReceiveRequestContext(a,!0),this.$VideoUploadSession35.sendRequest(b)}else this.$VideoUploadSession99()};d.$VideoUploadSession99=function(){this.$VideoUploadSession33.updateVideoID(this.$VideoUploadSession55);if(this.$VideoUploadSession73)if(this.$VideoUploadSession15){var a=0;for(a=0;a<this.$VideoUploadSession48-1;a++)this.$VideoUploadSession35[a].updateVideoID(this.$VideoUploadSession55)}else this.$VideoUploadSession35.updateVideoID(this.$VideoUploadSession55)};d.$VideoUploadSession100=function(a){if(this.$VideoUploadSession41==null)return((a==null?void 0:a.transport_retries)||0)+((a==null?void 0:a.server_retries)||0)+((a==null?void 0:a.timeout_retries)||0);else return this.$VideoUploadSession41.getTotalRetryCount()};d.$VideoUploadSession82=function(a,c){this.__logEvent(b("VideoUploadLogger").EVENT_PROGRESS_UPLOADING_START_REQUEST,{retries:this.$VideoUploadSession100(c),transport_retries:c.transport_retries,hash_time:c.hash_time,skip_upload:c.skip_upload?1:null}),this.__logEvent(b("VideoUploadLogger").EVENT_FINISHED_START_REQUEST,babelHelpers["extends"]({video_id:c.video_id},this.$VideoUploadSession66)),this.$VideoUploadSession55=c.video_id,this.$VideoUploadSession56=c.upload_session_id,this.$VideoUploadSession57=c.fb_region,this.$VideoUploadSession101=c.skip_upload,!c.skip_upload?this.$VideoUploadSession80(c):(this.$VideoUploadSession102(),this.inform("upload-progressed",{start_offset:0,end_offset:this.$VideoUploadSession52.getSize(),file_size:this.$VideoUploadSession52.getSize(),sent_bytes:this.$VideoUploadSession52.getSize(),video_id:c.video_id,skip_upload:c.skip_upload}),this.$VideoUploadSession6&&this.__logFinishedUploading(),this.inform("upload-finished",{start_offset:0,end_offset:this.$VideoUploadSession52.getSize(),video_id:c.video_id,is_spherical_video:this.$VideoUploadSession62}))};d.__fetchReceiveRequestManagerStateLogData=function(){var a={};this.$VideoUploadSession33!=null&&(this.$VideoUploadSession33.appendStateLogData(a,"requestManager_"),a.request_manager_state=a.requestManager_last_log_state);if(this.$VideoUploadSession15){var b=0;for(b=0;b<this.$VideoUploadSession48-1;b++)this.$VideoUploadSession35[b]!=null&&this.$VideoUploadSession35[b].appendStateLogData(a,"requestManagerEx_"+b.toString())}else this.$VideoUploadSession35!=null&&this.$VideoUploadSession35.appendStateLogData(a,"requestManagerEx_");return a};d.__createReceiveRequestContext=function(a,c,d){c||(c=!1);var e=new(b("VideoUploadRequestContext"))();this.$VideoUploadSession15?this.__setupReceiveRequestContext(e,a,c,d):this.__setupReceiveRequestContext(e,a,c);return e};d.__setupReceiveRequestContext=function(a,b,c,d){var e,f,g;!c?(c=this.$VideoUploadSession75,e=this.$VideoUploadSession78,this.$VideoUploadSession16?(f=this.$VideoUploadSession75,g=this.$VideoUploadSession18?Math.min(this.$VideoUploadSession18,this.$VideoUploadSession78):this.$VideoUploadSession78):(f=b.start_offset,g=b.end_offset)):this.$VideoUploadSession15?(this.$VideoUploadSession16&&(this.$VideoUploadSession29=this.$VideoUploadSession45[d]-this.$VideoUploadSession44[d],this.$VideoUploadSession29=this.$VideoUploadSession18?Math.min(this.$VideoUploadSession18,this.$VideoUploadSession29):this.$VideoUploadSession29),c=this.$VideoUploadSession44[d],e=this.$VideoUploadSession45[d],f=this.$VideoUploadSession44[d],g=this.$VideoUploadSession44[d]+this.$VideoUploadSession29>=this.$VideoUploadSession45[d]?this.$VideoUploadSession45[d]:this.$VideoUploadSession44[d]+this.$VideoUploadSession29):(this.$VideoUploadSession16&&(this.$VideoUploadSession29=this.$VideoUploadSession45-this.$VideoUploadSession44,this.$VideoUploadSession29=this.$VideoUploadSession18?Math.min(this.$VideoUploadSession18,this.$VideoUploadSession29):this.$VideoUploadSession29),c=this.$VideoUploadSession44,e=this.$VideoUploadSession45,f=this.$VideoUploadSession44,g=this.$VideoUploadSession44+this.$VideoUploadSession29>=this.$VideoUploadSession45?this.$VideoUploadSession45:this.$VideoUploadSession44+this.$VideoUploadSession29);a.setFile(this.$VideoUploadSession52).setVideoID(b.video_id).setXPVAssetID(b.xpv_asset_id).setUploadSessionID(b.upload_session_id).setFbRegion(b.fb_region).setStartOffset(f).setEndOffset(g).setPartitionStartOffset(c).setPartitionEndOffset(e).setPartitionNo(d).setTargetID(this.$VideoUploadSession3).setSource(this.$VideoUploadSession1).setComposerDialogVersion(this.$VideoUploadSession2).setComposerWorkSharedDraftMode(this.$VideoUploadSession9).setWaterfallID(this.$VideoUploadSession23).setComposerSessionID(this.$VideoUploadSession51).setSupportsChunking(this.$VideoUploadSession25).setHasFileBeenReplaced(this.$VideoUploadSession17).setRetryState(this.$VideoUploadSession41);this.$VideoUploadSession27&&a.setUseParallelChunks(this.$VideoUploadSession27);a.setComposerEntryPointRef&&a.setComposerEntryPointRef(this.$VideoUploadSession8);this.$VideoUploadSession18&&a.setClientChunkSize(this.$VideoUploadSession18)};d.$VideoUploadSession83=function(a,c){a=this.__getLogErrorData(c);this.__logEvent(b("VideoUploadLogger").EVENT_FAILED_START_REQUEST,a);this.__logEvent(b("VideoUploadLogger").EVENT_FAILED_UPLOADING,a);a=c.error_is_transient?b("VideoUploadLogger").EVENT_RESIGNED_FLOW:b("VideoUploadLogger").EVENT_FAILED_FLOW;this.$VideoUploadSession6?this.$VideoUploadSession70&&(this.__logEvent(a),this.$VideoUploadSession70=!1):this.__logEvent(a);this.$VideoUploadSession102();this.$VideoUploadSession103();this.inform("upload-failed",c)};d.$VideoUploadSession84=function(a){this.__logEvent(b("VideoUploadLogger").EVENT_CANCELED_START_REQUEST)};d.$VideoUploadSession85=function(a,c){this.__logEvent(b("VideoUploadLogger").EVENT_STARTED_RECEIVE_REQUEST,{debug:c.debug}),!c.start_offset&&!c.transport_retries&&!c.server_retries&&this.__logEvent(b("VideoUploadLogger").EVENT_STARTED_SENDING_BYTES,{total_bytes:this.$VideoUploadSession52.getSize(),upload_domain:c.upload_domain,debug:c.debug}),this.$VideoUploadSession25&&this.__logEvent(b("VideoUploadLogger").EVENT_STARTED_SENDING_CHUNK_BYTES,{start_offset:c.start_offset,total_bytes:c.end_offset-c.start_offset,retries:this.$VideoUploadSession100(c),transport_retries:c.transport_retries,server_retries:c.server_retries,upload_speed:c.upload_speed,request_manager_state:c.request_manager_state,upload_domain:c.upload_domain,debug:c.debug})};d.$VideoUploadSession86=function(a,b){if(b.start_offset<this.$VideoUploadSession78)this.$VideoUploadSession76=b.start_offset,this.$VideoUploadSession77=b.sent_bytes;else if(this.$VideoUploadSession15){a=this.getExPartitionNumber(b.start_offset);a>-1&&(this.$VideoUploadSession46[a]=b.start_offset,this.$VideoUploadSession47[a]=b.sent_bytes)}else this.$VideoUploadSession46=b.start_offset,this.$VideoUploadSession47=b.sent_bytes;b.start_offset=this.$VideoUploadSession76;b.sent_bytes=this.$VideoUploadSession77;if(this.$VideoUploadSession73)if(this.$VideoUploadSession15)for(a=0;a<this.$VideoUploadSession48-1;a++)b.start_offset+=this.$VideoUploadSession46[a]-this.$VideoUploadSession44[a],b.sent_bytes+=this.$VideoUploadSession47[a];else b.start_offset+=this.$VideoUploadSession46-this.$VideoUploadSession44,b.sent_bytes+=this.$VideoUploadSession47;a=Math.min(b.start_offset+b.sent_bytes,b.file_size);a>this.$VideoUploadSession61&&(this.$VideoUploadSession61=a,this.inform("upload-progressed",b))};d.$VideoUploadSession87=function(a,c){this.__logEvent(b("VideoUploadLogger").EVENT_FINISHED_RECEIVE_REQUEST,{debug:c.debug});this.$VideoUploadSession25&&this.__logEvent(b("VideoUploadLogger").EVENT_FINISHED_SENDING_CHUNK_BYTES,{start_offset:c.start_offset,sent_bytes:c.end_offset-c.start_offset,retries:this.$VideoUploadSession100(c),transport_retries:c.transport_retries,server_retries:c.server_retries,upload_speed:c.upload_speed,request_manager_state:c.request_manager_state,upload_domain:c.upload_domain,debug:c.debug});a=!1;if(c.start_offset<this.$VideoUploadSession78)this.$VideoUploadSession74=c.end_offset>=this.$VideoUploadSession78;else if(this.$VideoUploadSession15){var d;d=this.getExPartitionNumber(c.start_offset);if(d===-1){var e={error_summary:"Invalid offset",error_description:"Offset doesn't fall in any exPartition range."};this.__logEvent(b("VideoUploadLogger").EVENT_FAILED_UPLOADING);this.inform("upload-failed",e);return}this.$VideoUploadSession43[d]=c.end_offset>=this.$VideoUploadSession45[d]}else this.$VideoUploadSession43=c.end_offset>=this.$VideoUploadSession45;if(this.$VideoUploadSession15)for(d=0;d<this.$VideoUploadSession48-1;d++)if(this.$VideoUploadSession43[d]===!1){a=!1;break}else a=!0;else a=this.$VideoUploadSession43;(!this.$VideoUploadSession26||this.$VideoUploadSession74&&(!this.$VideoUploadSession73||a))&&(this.__logEvent(b("VideoUploadLogger").EVENT_FINISHED_SENDING_BYTES,{sent_bytes:this.$VideoUploadSession52.getSize(),upload_domain:c.upload_domain,debug:c.debug}),this.$VideoUploadSession71=Date.now()-this.$VideoUploadSession98,this.$VideoUploadSession6&&this.__logFinishedUploading(),c.video_id=this.$VideoUploadSession55,c.is_spherical_video=this.$VideoUploadSession62,this.inform("upload-finished",c),this.$VideoUploadSession12&&(this.$VideoUploadSession6||this.__logFinishedUploading(),this.__logEvent(b("VideoUploadLogger").EVENT_FINISHED_FLOW,c),this.$VideoUploadSession70=!1,this.$VideoUploadSession103(),this.inform("multimedia-upload-finished",c)))};d.$VideoUploadSession88=function(a,c){a=this.__getLogErrorData(c);this.__logEvent(b("VideoUploadLogger").EVENT_FAILED_RECEIVE_REQUEST,a);this.$VideoUploadSession25&&this.__logEvent(b("VideoUploadLogger").EVENT_FAILED_SENDING_CHUNK_BYTES,a);if(this.$VideoUploadSession58){this.__logEvent(b("VideoUploadLogger").EVENT_FAILED_SENDING_BYTES,a);this.__logEvent(b("VideoUploadLogger").EVENT_FAILED_UPLOADING,a);var d=c.error_is_transient?b("VideoUploadLogger").EVENT_RESIGNED_FLOW:b("VideoUploadLogger").EVENT_FAILED_FLOW;this.$VideoUploadSession6?this.$VideoUploadSession70&&(this.__logEvent(d,a),this.$VideoUploadSession70=!1):this.__logEvent(d,a)}this.$VideoUploadSession103();this.inform("upload-failed",c)};d.$VideoUploadSession89=function(a){this.$VideoUploadSession25?this.__logEvent(b("VideoUploadLogger").EVENT_CANCELED_SENDING_CHUNK_BYTES):this.__logEvent(b("VideoUploadLogger").EVENT_CANCELED_SENDING_BYTES)};d.$VideoUploadSession90=function(a,c){a={start_offset:c.start_offset,sent_bytes:c.end_offset-c.start_offset,retries:this.$VideoUploadSession100(c),transport_retries:c.transport_retries,server_retries:c.server_retries,timeout_retries:c.timeout_retries,upload_speed:c.upload_speed,request_manager_state:c.request_manager_state,debug:c.debug};this.__logEvent(b("VideoUploadLogger").EVENT_TIMEOUT_SENDING_CHUNK_BYTES,a)};d.$VideoUploadSession91=function(a,b){this.inform("online",b)};d.$VideoUploadSession92=function(a,b){this.inform("offline",b)};d.$VideoUploadSession93=function(a,c){this.__logEvent(b("VideoUploadLogger").EVENT_RESUMABLE_CALLED,c)};d.$VideoUploadSession94=function(a,c){this.__logEvent(b("VideoUploadLogger").EVENT_RESUMABLE_STARTED,c)};d.$VideoUploadSession95=function(a,c){this.__logEvent(b("VideoUploadLogger").EVENT_RESUMABLE_SUCCESS,c)};d.$VideoUploadSession96=function(a,c){this.__logEvent(b("VideoUploadLogger").EVENT_RESUMABLE_FAILED,c)};d.__handlePostRequestFinished=function(a,c){this.__logEvent(b("VideoUploadLogger").EVENT_FINISHED_POST_REQUEST,babelHelpers["extends"]({video_id:this.$VideoUploadSession55},this.$VideoUploadSession66));c.video_id||(c.video_id=this.$VideoUploadSession55);this.$VideoUploadSession6||this.__logFinishedUploading();this.__logEvent(b("VideoUploadLogger").EVENT_FINISHED_FLOW);this.$VideoUploadSession70=!1;this.$VideoUploadSession103();a=babelHelpers["extends"]({},c,this.$VideoUploadSession67);this.inform("post-finished",a)};d.__logFinishedUploading=function(){this.__logEvent(b("VideoUploadLogger").EVENT_FINISHED_UPLOADING,babelHelpers["extends"]({elapsed_time:this.$VideoUploadSession71,skip_upload:this.$VideoUploadSession101?1:null,video_id:this.$VideoUploadSession55},this.$VideoUploadSession66)),this.$VideoUploadSession59=!0};d.$VideoUploadSession97=function(a,c){a=this.__getLogErrorData(c);this.__logEvent(b("VideoUploadLogger").EVENT_FAILED_POST_REQUEST,a);if(this.$VideoUploadSession58){this.__logEvent(b("VideoUploadLogger").EVENT_FAILED_UPLOADING,a);var d=c.error_is_transient?b("VideoUploadLogger").EVENT_RESIGNED_FLOW:b("VideoUploadLogger").EVENT_FAILED_FLOW;this.__logEvent(d,a)}this.$VideoUploadSession103();this.inform("post-failed",c)};d.$VideoUploadSession102=function(){this.$VideoUploadSession33.cancelRequest();if(this.$VideoUploadSession73)if(this.$VideoUploadSession15){var a=0;for(a=0;a<this.$VideoUploadSession48-1;a++)this.$VideoUploadSession35[a].cancelRequest()}else this.$VideoUploadSession35.cancelRequest();this.$VideoUploadSession20=!1};d.$VideoUploadSession69=function(){this.$VideoUploadSession31.cancelRequest(),this.$VideoUploadSession102(),this.$VideoUploadSession103(),this.$VideoUploadSession55&&(c.deleteVideo(this.$VideoUploadSession55),this.$VideoUploadSession55=null,this.$VideoUploadSession56=null,this.$VideoUploadSession57=null)};d.$VideoUploadSession79=function(){var a=this;this.$VideoUploadSession58=!0;this.$VideoUploadSession30&&(this.$VideoUploadSession60=new(b("SubscriptionsHandler"))(),this.$VideoUploadSession60.addSubscriptions(this.$VideoUploadSession53().postOnShutdown(function(){if(a.$VideoUploadSession58){var c={event_reason:g.SHUTDOWN,debug:babelHelpers["extends"]({},a.__fetchReceiveRequestManagerStateLogData(),{is_background_upload:a.$VideoUploadSession6})};a.$VideoUploadSession6?a.$VideoUploadSession70&&a.__logEvent(b("VideoUploadLogger").EVENT_CANCELED_FLOW,c):a.__logEvent(b("VideoUploadLogger").EVENT_CANCELED_FLOW,c)}})));this.$VideoUploadSession11&&(this.$VideoUploadSession72=new(b("VideoUploadCrashMonitor"))(this.$VideoUploadSession23,this.$VideoUploadSession7,this.$VideoUploadSession1,this.$VideoUploadSession3,this.$VideoUploadSession4,this.$VideoUploadSession25,this.$VideoUploadSession8,!this.$VideoUploadSession6||this.$VideoUploadSession70),this.$VideoUploadSession72.startSession())};d.$VideoUploadSession103=function(){this.$VideoUploadSession58=!1,this.$VideoUploadSession60&&(this.$VideoUploadSession60.release(),this.$VideoUploadSession60=null),this.$VideoUploadSession72&&(this.$VideoUploadSession72.endSession(),this.$VideoUploadSession72=null)};d.__getLogErrorData=function(a){return{error:a.error_summary,error_code:a.error_code,error_description:a.error_description,retries:this.$VideoUploadSession100(a),transport_retries:a.transport_retries,server_retries:a.server_retries,request_manager_state:a.request_manager_state,debug:a.debug}};d.__logEvent=function(a,b){b=b||{},this.$VideoUploadSession52&&(b.file_size=this.$VideoUploadSession52.getSize(),b.file_extension=this.$VideoUploadSession52.getExtension(),b.sent_bytes=this.$VideoUploadSession61),this.$VideoUploadSession53().logEvent(a,b)};d.__getVideoUploadStartRequestManager=function(a,c,d,e,f,g,h,i){return new(b("VideoUploadStartRequestManager"))(a,c,d,e,f,g,h,i)};d.__getVideoUploadReceiveRequestManager=function(a,c){return new(b("VideoUploadReceiveRequestManager"))(a,c.max_transport_retries,c.max_transport_retry_timeout,c.max_server_retries,c.response_timeout_enabled,c.max_response_timeout_retries,c.response_timeout_speed_variation_factor_ppt,c.transport_retry_interval_base,c.server_retry_interval_base,c.receive_errors_force_retry,c.access_token,c.resumability_enabled,c.resumability_async_enabled,c.resumable_service_name,c.resumable_service_domain,c.datr,c.resumability_min_file_size,c.resumable_service_proxy_receive,c.resumable_service_send_media_info,c.resumable_service_send_file_size,c.resumable_reset_transport_retries_on_progress,c.add_flow_capture_header,c.traffic_tracing_enabled,c.traffic_tracing_min_file_size)};d.__getVideoUploadPostRequestManager=function(a,c){return new(b("VideoUploadPostRequestManager"))(a,c.post_max_transport_retries,c.post_transport_retry_interval_base,c.post_max_server_retries,c.post_server_retry_interval_base)};c.deleteVideo=function(a){a=new(b("AsyncRequest"))("/ajax/video/actions/delete").setData({fbid:a,redirect:!1});a.setErrorHandler(function(){});a.send()};return c}(b("mixin")(b("cr:909282")));e.exports=a}),null);
__d("VideoUploader",["VideoUploadCrashMonitor","VideoUploadSession","mixin","requireCond","cr:909282"],(function(a,b,c,d,e,f){a=function(a){babelHelpers.inheritsLoose(c,a);function c(c){var d;d=a.call(this)||this;d.$VideoUploader1=c;d.$VideoUploader2=null;d.$VideoUploader3=null;d.$VideoUploader4=c.waterfall_id==null?null:c.waterfall_id;d.$VideoUploader5=d.$VideoUploader1.ad_account_id;c.monitor_crashes&&(d.$VideoUploader6=new(b("VideoUploadCrashMonitor"))(),d.$VideoUploader6.logKnownCrashes());return d}var d=c.prototype;d.setComposerSessionID=function(a){this.$VideoUploader7=a,this.$VideoUploader2&&this.$VideoUploader2.setComposerSessionID(a)};d.getLogger=function(){if(!this.$VideoUploader2)return;if(this.$VideoUploader2.getLogger)return this.$VideoUploader2.getLogger()};d.upload=function(a){var b=this;if(this.$VideoUploader2)return;var c=this.__getVideoUploadSession(this.$VideoUploader1);c.setComposerSessionID(this.$VideoUploader7);c.subscribe(this.__getEventsWhichShouldListenFromSession(),function(a,c){return b.$VideoUploader8(a,c)});this.$VideoUploader2=c;c.start(a)};d.__getVideoUploadSession=function(a){return new(b("VideoUploadSession"))(a)};d.__getEventsWhichShouldListenFromSession=function(){return["upload-requested","upload-started","upload-progressed","upload-finished","upload-failed","upload-canceled","post-started","post-finished","post-failed","online","offline","metadata-parsed","set-waterfall-id"]};d.postUserRequest=function(){if(!this.$VideoUploader2)return;this.$VideoUploader2.startFlow&&this.$VideoUploader2.startFlow()};d.setTargetID=function(a){if(this.$VideoUploader2==null)return;this.$VideoUploader2.setTargetID(a)};d.setHasFileBeenReplaced=function(a){this.$VideoUploader1.has_file_been_replaced=a};d.post=function(a){if(!this.$VideoUploader2)return;this.$VideoUploader2.post(a)};d.getVideoID=function(){this.$VideoUploader2&&(this.$VideoUploader3=this.$VideoUploader2.getVideoID());return this.$VideoUploader3};d.cancel=function(a){a===void 0&&(a=!1);var c=this.getVideoID();this.$VideoUploader2?this.$VideoUploader2.cancel(a):a&&c&&b("VideoUploadSession").deleteVideo(c);this.reset()};d.abandon=function(a){a===void 0&&(a=!1);var c=this.getVideoID();this.$VideoUploader2?this.$VideoUploader2.abandon(a):a&&c&&b("VideoUploadSession").deleteVideo(c);this.reset()};d.reset=function(){this.$VideoUploader2&&(this.$VideoUploader3=this.getVideoID()),this.$VideoUploader2=null};d.getUploadSession=function(){return this.$VideoUploader2};d.getLoggerData=function(){return{waterfall_id:this.$VideoUploader2?this.$VideoUploader2.$VideoUploader4:null,actor_id:this.$VideoUploader1.actor_id,target_id:this.$VideoUploader1.target_id,target_type:this.$VideoUploader1.target_type,composer_entry_point_ref:this.$VideoUploader1.composer_entry_point_ref}};d.isPostInProgress=function(){return!!this.$VideoUploader2&&this.$VideoUploader2.isPostInProgress()};d.isSessionInProgress=function(){return!!this.$VideoUploader2&&this.$VideoUploader2.isInProgress()};d.isSessionExist=function(){return!!this.$VideoUploader2};d.getUploadParameters=function(){return this.$VideoUploader1};d.__getSession=function(){return this.$VideoUploader2};d.__getEventsForWhichSessionShouldBeSetToNull=function(){return["upload-failed","post-finished","multimedia-upload-finished"]};d.$VideoUploader8=function(a,b){this.__getEventsForWhichSessionShouldBeSetToNull().includes(a)&&this.reset(),this.__delegateEvent(a,b)};d.__delegateEvent=function(a,b){this.inform(a,b)};return c}(b("mixin")(b("cr:909282")));e.exports=a}),null);
__d("LiveVideoWorkplaceP2PPlaybackTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(a){b("GeneratedLoggerUtils").log("logger:LiveVideoWorkplaceP2PPlaybackLoggerConfig",this.$1,b("Banzai").BASIC,a)};c.logVital=function(a){b("GeneratedLoggerUtils").log("logger:LiveVideoWorkplaceP2PPlaybackLoggerConfig",this.$1,b("Banzai").VITAL,a)};c.logImmediately=function(a){b("GeneratedLoggerUtils").log("logger:LiveVideoWorkplaceP2PPlaybackLoggerConfig",this.$1,{signal:!0},a)};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setBroadcastID=function(a){this.$1.broadcast_id=a;return this};c.setBroadcastURL=function(a){this.$1.broadcast_url=a;return this};c.setCommunityID=function(a){this.$1.community_id=a;return this};c.setCommunityName=function(a){this.$1.community_name=a;return this};c.setCustomerID=function(a){this.$1.customer_id=a;return this};c.setEventStr=function(a){this.$1.event_str=a;return this};c.setExceptionCode=function(a){this.$1.exception_code=a;return this};c.setExceptionMessage=function(a){this.$1.exception_message=a;return this};c.setExceptionSeverity=function(a){this.$1.exception_severity=a;return this};c.setExceptionTrace=function(a){this.$1.exception_trace=a;return this};c.setExceptionType=function(a){this.$1.exception_type=a;return this};c.setHiveClientStatsCdnRequests=function(a){this.$1.hive_client_stats_cdn_requests=a;return this};c.setHiveClientStatsCdnResponseBytes=function(a){this.$1.hive_client_stats_cdn_response_bytes=a;return this};c.setHiveClientStatsCdnResponseErrors=function(a){this.$1.hive_client_stats_cdn_response_errors=a;return this};c.setHiveClientStatsCdnResponses=function(a){this.$1.hive_client_stats_cdn_responses=a;return this};c.setHiveClientStatsNumPartners=function(a){this.$1.hive_client_stats_num_partners=a;return this};c.setHiveClientStatsP2pRequests=function(a){this.$1.hive_client_stats_p2p_requests=a;return this};c.setHiveClientStatsP2pResponseBytes=function(a){this.$1.hive_client_stats_p2p_response_bytes=a;return this};c.setHiveClientStatsP2pResponseErrors=function(a){this.$1.hive_client_stats_p2p_response_errors=a;return this};c.setHiveClientStatsP2pResponses=function(a){this.$1.hive_client_stats_p2p_responses=a;return this};c.setHiveClientStatsSavings=function(a){this.$1.hive_client_stats_savings=a;return this};c.setHivePartnerID=function(a){this.$1.hive_partner_id=a;return this};c.setHivePluginTech=function(a){this.$1.hive_plugin_tech=a;return this};c.setHiveStreamingTicketingEndpoint=function(a){this.$1.hive_streaming_ticketing_endpoint=a;return this};c.setHTTPStatusCode=function(a){this.$1.http_status_code=a;return this};c.setP2pPlaybackReportURL=function(a){this.$1.p2p_playback_report_url=a;return this};c.setP2pPlaybackTicketURL=function(a){this.$1.p2p_playback_ticket_url=a;return this};c.setSessionID=function(a){this.$1.session_id=a;return this};c.setSummaryCdnTraffic=function(a){this.$1.summary_cdn_traffic=a;return this};c.setSummaryP2pTraffic=function(a){this.$1.summary_p2p_traffic=a;return this};c.setSummaryPeerSavings=function(a){this.$1.summary_peer_savings=a;return this};c.setSummaryQualityScore=function(a){this.$1.summary_quality_score=a;return this};c.setSummaryUniqueViewers=function(a){this.$1.summary_unique_viewers=a;return this};c.setSummaryViewedMinutes=function(a){this.$1.summary_viewed_minutes=a;return this};c.setTimeMs=function(a){this.$1.time_ms=a;return this};c.setTimeSpentInP2pMs=function(a){this.$1.time_spent_in_p2p_ms=a;return this};c.setVideoID=function(a){this.$1.video_id=a;return this};c.setViewerManifestURL=function(a){this.$1.viewer_manifest_url=a;return this};return a}();c={broadcast_id:!0,broadcast_url:!0,community_id:!0,community_name:!0,customer_id:!0,event_str:!0,exception_code:!0,exception_message:!0,exception_severity:!0,exception_trace:!0,exception_type:!0,hive_client_stats_cdn_requests:!0,hive_client_stats_cdn_response_bytes:!0,hive_client_stats_cdn_response_errors:!0,hive_client_stats_cdn_responses:!0,hive_client_stats_num_partners:!0,hive_client_stats_p2p_requests:!0,hive_client_stats_p2p_response_bytes:!0,hive_client_stats_p2p_response_errors:!0,hive_client_stats_p2p_responses:!0,hive_client_stats_savings:!0,hive_partner_id:!0,hive_plugin_tech:!0,hive_streaming_ticketing_endpoint:!0,http_status_code:!0,p2p_playback_report_url:!0,p2p_playback_ticket_url:!0,session_id:!0,summary_cdn_traffic:!0,summary_p2p_traffic:!0,summary_peer_savings:!0,summary_quality_score:!0,summary_unique_viewers:!0,summary_viewed_minutes:!0,time_ms:!0,time_spent_in_p2p_ms:!0,video_id:!0,viewer_manifest_url:!0};e.exports=a}),null);
__d("useSEOLoggedOutWebCrawler",["gkx"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(){return b("gkx")("1779508")}}),null);
__d("handleOzManifestFetchErrorEvent",[],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a,b){var c=a.getNumber("initial_manifest_request_retry_count",0),d=JSON.parse(a.getString("network_retry_intervals_json","{}")),e=a.getNumber("live_max_try_attempts_on_404",1),f=["404","503"];a.getBool("live_gracefully_handle_no_network",!1)&&f.push("0");a.getBool("live_gracefully_handle_410",!1)&&f.push("410");a.getBool("live_gracefully_handle_502",!1)&&f.push("502");a=b.error.getExtra().code;d=d[a];if(b.isInitialRequest)typeof d==="number"&&d>0&&b.retryAttemptCount<c&&b.retry(d);else if(a!=null&&f.indexOf(a)>-1)switch(a){case"410":b.endStream();break;case"404":e<b.consecutiveFailuresForErrorCode&&b.retry();break;case"502":case"503":case"0":b.retry();break;default:break}}}),null);
__d("handleOzStreamErrorEvent",[],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=[0,1,1,2,3,5,8,13,21,34];function a(a,b){var c=b.error.getExtra().code,d=JSON.parse(a.getString("network_end_broadcasts_json","[]"));if(d.includes(c)){b.endStream();return}d=JSON.parse(a.getString("network_skip_json","[]"));if(d.includes(c)){b.retry();return}d=a.getBool("back_off_pdash_504_retry",!0)?g[b.retryAttemptCount]:0;var e=JSON.parse(a.getString("network_reload_mpd_json","[]")),f=a.getBool("fix_reload_manifest_retry",!1);if(a.getBool("back_off_pdash_504_retry",!0)&&d==null&&(!f||e.includes(c)))return;if(d!=null&&e.includes(c)){b.retry(d*1e3);return}f=JSON.parse(a.getString("network_retry_intervals_json",'{"0": 1000, "404": 2000, "502": 1000, "503": 1000, "504": 1000}'));e=c!=null?f[c]:null;if(e!=null){b.retry(e);return}}}),null);
__d("OzOneSemanticHandler",["ConstUriUtils","handleOzManifestFetchErrorEvent","handleOzStreamErrorEvent","qex","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";f.handleManifestFetchErrorEvent=a;f.handleStreamErrorEvent=c;function g(a){var c=a.error;c=c.getExtra();c=c.code;c==null&&b("recoverableViolation")("A ONE Semantic error response must have an error code.","comet_video_player");switch(c){case"410":a.endStream();break;default:}}function h(a){var b=!1;switch(a){case"410":b=!0;break;default:}return b}function i(a){if(a!=null){a=b("ConstUriUtils").getUri(a);if(a){a=a.getQueryParam("os_param");return!!a}}return!1}function j(a){var c=k(a);if(c){c=a.getExtra();a=c.code;c=c.url;if(a==null){b("recoverableViolation")("A ONE Semantic error response must have an error code.","comet_video_player");return!1}return h(a)&&(i(c)||!!b("qex")._("1809475"))}return!1}function k(a){a=a.getExtra();a=a.headers;return a?a.has("x-fb-one"):!1}function a(a,c){var d=c.error;!!b("qex")._("1840705")&&j(d)?g(c):b("handleOzManifestFetchErrorEvent")(a,c)}function c(a,c){var d=c.error;!!b("qex")._("1840705")&&j(d)?g(c):b("handleOzStreamErrorEvent")(a,c)}}),null);
__d("VideoPlayerImplementationLoadSequenceManager",["setTimeout"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=[],this.$2=[]}var c=a.prototype;c.schedule=function(a,c,d){var e=this,f={load:d,maximumBlockTimeMs:a.getNumber("load_sequence_max_delay_ms",0),sequence:c};!this.$2.find(function(a){return a.sequence<c})?this.$3(f):(this.$1.push(f),b("setTimeout")(function(){return e.$4(f)},f.maximumBlockTimeMs));return function(){return e.$5(f)}};c.$4=function(a){var b=this.$1.find(function(b){return b===a});b&&(this.$1=this.$1.filter(function(b){return b!==a}),this.$3(b))};c.$3=function(a){var c=this;this.$2.push(a);a.load().then(function(){return c.$6(a)})["catch"](function(b){c.$6(a);throw b});b("setTimeout")(function(){return c.$6(a)},a.maximumBlockTimeMs)};c.$7=function(){var a=this,b=Math.min.apply(Math,this.$1.map(function(a){return a.sequence})),c=this.$1.filter(function(a){return a.sequence===b});c.forEach(function(b){return a.$4(b)})};c.$5=function(a){this.$1=this.$1.filter(function(b){return b!==a})};c.$6=function(a){if(!this.$2.find(function(b){return b===a}))return;this.$2=this.$2.filter(function(b){return b!==a});var b=!!this.$2.find(function(b){return b.sequence===a.sequence});b&&this.$7()};return a}();c=new a();d=c;e.exports=d}),null);
__d("VideoPlayerOzImplementationData",[],(function(a,b,c,d,e,f){"use strict";f.makeOzImplementationData=a;function a(a){var b=a.canUseOz,c=a.dashManifest,d=a.dashUrl,e=a.experimentationConfig,f=a.minQualityPreference,g=a.ozQuickStarterData;a=a.videoFBID;if(b!==!0||a==null)return null;b=c==null||c===""?null:c;a=d==null||d===""?null:d;if(b==null&&a==null)return null;return e==null?null:{experimentationConfig:e,manifest:b,manifestUrl:a,minQualityPreference:(c=f)!=null?c:null,ozQuickStarterData:(d=g)!=null?d:null}}}),null);
__d("handleVideoPlayerLatencyLevelChange",[],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a,b,c,d){if(a&&b&&c){a.setContext("latency_level",d);d=(d=c.getSelectedVideoRepresentation())==null?void 0:(c=d.getEndingSegment())==null?void 0:c.getTimeRange().endTime;c=d!=null?d+a.getNumber("live_initial_playback_position",0):null;c!=null&&c>b.getPlayheadPosition()&&b.setPlayheadPosition(c)}}}),null);
__d("VideoPlayerOzImplementationEngineExtrasAPI",["VideoPlayerOzWWWGlobalConfig","emptyFunction","gkx","handleVideoPlayerLatencyLevelChange","oz-player/networks/OzBandwidthEstimator"],(function(a,b,c,d,e,f){"use strict";f.createVideoPlayerOzImplementationEngineExtrasAPI=a;c=b("emptyFunction");function g(a){return a.getSelectedVideoQuality()}function h(a){a=a.getCurrentVideoRepresentation();return a==null?"":a.getQualityLabel()}function i(a){a=a.getIsVideoQualityAdaptationEnabled()?"auto":a.getSelectedVideoQuality();return a}function j(a){return(a=(a=a.getMpd())==null?void 0:a.getCustomField("fbProjection"))!=null?a:null}function k(a,b){var c=i(a);if(b==="notselected"||b===c)return!1;else if(b==="auto"){a.enableVideoQualityAdaptation();return!0}else if(b!==a.getSelectedVideoQuality()){c=b;a.switchToVideoQuality(c);return!0}else return!1}function a(a){var c=a.getConfig,d=a.getOzPlayer,e=a.getOzQuickStarter,f=a.getVideoElementAPI;a={getApproximateFBLSToPlayerDisplayLatency:function(){var a;return(a=(a=d())==null?void 0:a.getApproximateFBLSToPlayerDisplayLatency())!=null?a:null},getAudioRepresentationIDAtTime:function(a){var b,c;b=(b=d())==null?void 0:b.getAudioRepresentationIDAtTime(a);c=(c=e())==null?void 0:c.getAudioRepresentationIDAtTime(a);return(b=(a=b)!=null?a:c)!=null?b:null},getAvailableVideoQualities:function(){var a;return(a=(a=d())==null?void 0:a.getVideoQualities())!=null?a:[]},getCurrentAudioRepresentation:function(){var a;return(a=(a=d())==null?void 0:a.getCurrentAudioRepresentation())!=null?a:null},getCurrentPlayingVideoQuality:function(){var a=d();return a?h(a):""},getCurrentTargetVideoQuality:function(){var a=d();return a?g(a):""},getCurrentVideoRepresentation:function(){var a;return(a=(a=d())==null?void 0:a.getCurrentVideoRepresentation())!=null?a:null},getEstimatedBandwidth:function(){return b("oz-player/networks/OzBandwidthEstimator").getBandwidth(b("VideoPlayerOzWWWGlobalConfig"))},getInbandCaptionsAutogeneratedFromManifest:function(){var a;a=(a=d())==null?void 0:a.getMpd();return Boolean(a==null?void 0:a.getCustomField("hasInbandCaptionsFromUsingASRCaptions"))},getInbandCaptionsExpectedFromManifest:function(){var a;a=(a=d())==null?void 0:a.getMpd();return Boolean(a==null?void 0:a.getCustomField("hasInbandCaptionsFromUsingASRCaptions"))||Boolean(a==null?void 0:a.getCustomField("hasInbandCaptionsFromAccessibility"))},getPerfLoggerProvider:function(){var a=d();return a?a.getPerfLoggerProvider():null},getStreamType:function(){return"dash"},getUserSelectedVideoQuality:function(){var a=d();return a?i(a):""},getVideoProjectionType:function(){var a=d();return a!=null?j(a):null},getVideoRepresentationIDAtTime:function(a){var b,c;b=(b=d())==null?void 0:b.getVideoRepresentationIDAtTime(a);c=(c=e())==null?void 0:c.getVideoRepresentationIDAtTime(a);return(b=(a=b)!=null?a:c)!=null?b:null},getVideoRepresentations:function(){var a;return(a=(a=d())==null?void 0:(a=a.getMpd())==null?void 0:a.getVideoRepresentations())!=null?a:null},isDrm:function(){var a;return Boolean((a=d())==null?void 0:a.isDrm())},isFBIsLiveTemplated:function(){var a;a=(a=d())==null?void 0:a.getMpd();return Boolean(a==null?void 0:a.getCustomField("isLiveTemplated"))},isFBMS:function(){var a;a=(a=d())==null?void 0:a.getMpd();return Boolean(a==null?void 0:a.getCustomField("isFBMS"))},isFBWasLive:function(){var a;a=(a=d())==null?void 0:a.getMpd();return Boolean(a==null?void 0:a.getCustomField("isFBWasLive"))},isPredictiveDash:function(){var a;a=(a=(a=d())==null?void 0:(a=a.getMpd())==null?void 0:a.getVideoRepresentations()[0])!=null?a:null;return a!==null&&a.canPredict()},setDimensions:function(a){},setEnableLiveheadCatchup:function(a){var b=d();b!=null&&b.setEnableLiveheadCatchup(a)},setLatencyLevel:function(a){b("handleVideoPlayerLatencyLevelChange")(c(),f(),d(),a)},setUserSelectedVideoQuality:function(a){var b=d();b!=null&&k(b,a)}};return a}}),null);
__d("OzActiveActiveFailoverNetworkRequestStreamHandler",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a}var b=a.prototype;b.onResponse=function(a,b){var c=a.headers;c&&c.has("x-fb-video-replica")&&this.$1(a,b);return null};b.onError=function(a,b){return null};return a}();e.exports=a}),null);
__d("oz-player/utils/arrayBuffer2OzReadableStream",["oz-player/shims/OzReadableStream"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a){return new(b("oz-player/shims/OzReadableStream"))({start:function(b){var c=new Uint8Array(a);b.enqueue(c);b.close()}})}}),null);
__d("OzConfigurableRequestImplementation",["MaybeNativePromise","oz-player/utils/arrayBuffer2OzReadableStream","parseHeaders"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a){return function(c,d,e){var f={url:c,http:d,options:e,method:"GET",responseType:"arraybuffer"};c=new(b("MaybeNativePromise"))(function(c,d){a(f,function(a,d,e){a={body:b("oz-player/utils/arrayBuffer2OzReadableStream")(a),headers:new Headers(b("parseHeaders")(e)),ok:!0,status:d};c(a)},function(a,e,f){if(a==null||a==="0")d(new TypeError("NetworkError"));else{f={body:b("oz-player/utils/arrayBuffer2OzReadableStream")(new ArrayBuffer(0)),headers:new Headers(b("parseHeaders")(e)),ok:!1,status:a};c(f)}})});return c}}}),null);
__d("OzCustomParsers",[],(function(a,b,c,d,e,f){f.createOzCustomParser=a;function a(){return new Map([["fbProjection",function(a){try{return a.Period[0].AdaptationSet[0].$.FBProjection||null}catch(a){return null}}],["hasInbandCaptionsFromAccessibility",function(a){a=a.Period[0];a=a&&a.AdaptationSet[0].Accessibility;return a&&a[0]?a[0].$.schemeIdUri==="urn:scte:dash:cc:cea-608:2015":!1}],["hasInbandCaptionsFromUsingASRCaptions",function(a){a=Number.parseInt(a.$.usingASRCaptions,0);return!isNaN(a)&&a!=0}],["hasInbandCaptionsFromIsUsingAsrCaptionsEmployeeDogfooding",function(a){a=Number.parseInt(a.$.isUsingAsrCaptionsEmployeeDogfooding,0);return!isNaN(a)&&a!=0}],["isLiveTemplated",function(a){return a.$.FBIsLiveTemplated==="true"}],["isFBMS",function(a){return a.$.FBMS==="true"}],["isFBWasLive",function(a){return a.$.FBWasLive==="true"}],["loapStreamType",function(a){return a.$.loapStreamType?parseInt(a.$.loapStreamType,10):0}],["fbManifestIdentifier",function(a){return(a=a.$.FBManifestIdentifier)!=null?a:""}],["lastVideoFrameTs",function(a){return a.$.lastVideoFrameTs?Number.parseInt(a.$.lastVideoFrameTs,10):null}]])}}),null);
__d("oz-player/shims/OzURI",["requireCond","cr:1615801"],(function(a,b,c,d,e,f){"use strict";a=b("cr:1615801");e.exports=a}),null);
__d("OzCustomRepresentationParsers",["oz-player/shims/OzURI"],(function(a,b,c,d,e,f){f.createOzCustomRepresentationParsers=a;function a(a){var c=a.ozConfig,d=a.startTimestamp;a={timescale:function(a){a=a.SegmentTemplate;if(a&&a.length>0){a=a[0].$;if(a)return Number.parseInt(a.timescale,0)||null}return null}};var e=c.getNumber("mos_upper_threshold",0),f=c.getNumber("mos_lower_threshold",0);(e>0||f>0)&&(a.playbackResolutionMos=function(a){try{return a.$.FBPlaybackResolutionMos}catch(a){return null}});a.qualityLabel=function(a){try{return a.$.FBQualityLabel}catch(a){return null}};c.getBool("parse_first_segment",!1)&&(a.firstSegmentParser=function(a){if(d!=null&&d>0)return null;try{var c=a.SegmentBase[0].$.FBFirstSegmentRange.split("-").map(Number),e={startByte:c[0],endByte:c[1]},f=new(b("oz-player/shims/OzURI"))(a.BaseURL[0]._);return{getURI:function(){return f},getByteRange:function(){return e},getTimeRange:function(){return{startTime:0,endTime:2}},getSequenceNumber:function(){return null}}}catch(a){return null}});return a}}),null);
__d("OzDashPrefetchCache",["VideoDashPrefetchCache"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){}var c=a.prototype;c.hasCacheValue=function(a){return b("VideoDashPrefetchCache").hasCacheValue(a)};c.getCacheValue=function(a){return b("VideoDashPrefetchCache").getCacheValue(a)};c.getCachedRepresentations=function(a){return null};return a}();e.exports=a}),null);
__d("oz-player/shims/ozvariant",["requireCond","cr:1615806"],(function(a,b,c,d,e,f){a=b("cr:1615806");e.exports=a}),null);
__d("oz-player/utils/OzNumericalHelper",[],(function(a,b,c,d,e,f){"use strict";f.equalTo=h;f.greaterThan=i;f.lessThan=j;f.lessThanOrEqual=a;f.greaterThanOrEqual=b;var g=1e-5;function h(a,b,c){c===void 0&&(c=g);return Math.abs(b-a)<=c}function i(a,b,c){c===void 0&&(c=g);return a>b&&!h(a,b,c)}function j(a,b,c){c===void 0&&(c=g);return a<b&&!h(a,b,c)}function a(a,b,c){c===void 0&&(c=g);return j(a,b,c)||h(a,b,c)}function b(a,b,c){c===void 0&&(c=g);return i(a,b,c)||h(a,b,c)}}),null);
__d("oz-player/utils/OzNumericalRangeUtil",["oz-player/utils/OzNumericalHelper"],(function(a,b,c,d,e,f){"use strict";var g=.01;function h(a,b){b=b.rangeEnd;return b===null||b===void 0?!1:Math.abs(a.rangeStart-b)>g&&a.rangeStart>b}function i(a,b){a=a.rangeEnd;b=b.rangeEnd;if(a===null||a===void 0)return!0;return b===null||b===void 0?!1:Math.abs(a-b)>g&&a>b}function j(a,b){b=b.rangeEnd;return b===null||b===void 0?!1:Math.abs(a-b)>g&&a>b}function k(a,b){return a>b-g}a=function(){function a(){}var c=a.prototype;c.mergeSortedRanges=function(a){if(!a.length)return[];var b=[],c=a[0];b.push(c);for(var d=1;d<a.length;d++){var e=a[d];if(!i(e,c))continue;else h(e,c)?(c={rangeStart:e.rangeStart,rangeEnd:e.rangeEnd},b.push(c)):c.rangeEnd=e.rangeEnd}return b};c.diffSortedRanges=function(a,b){return a.reduceRight(function(a,c){j(c.rangeStart,b)||j(b.rangeStart,c)?a.push(c):(b.rangeEnd!=null&&(c.rangeEnd==null||j(c.rangeEnd,b))&&a.push({rangeStart:b.rangeEnd,rangeEnd:c.rangeEnd}),k(b.rangeStart,c.rangeStart)&&a.push({rangeStart:c.rangeStart,rangeEnd:b.rangeStart}));return a},[]).filter(function(a){return a.rangeEnd==null||a.rangeStart<a.rangeEnd}).reverse()};c.findCurrentRangeIndex=function(a,b){for(var c=0;c<b.length;c++){var d=b[c],e=d.rangeStart;if(k(a,e)&&!j(a,d))return c}return-1};c.findNextRangeIndex=function(a,b){for(var c=0;c<b.length;c++){var d=b[c];d=d.rangeStart;if(!k(a,d))return c}return-1};c.findDiffCoveredByRanges=function(a,b,c){return a>=b?0:c.reduceRight(function(c,d){var e=d.rangeStart;d=d.rangeEnd;if(b<e||d!=null&&a>d)return c;else if(d==null||b<=d)return Math.min(b-e,b-a)+c;else if(a>=e)return Math.min(d-a,b-a)+c;else return d-e+c},0)};c.firstAddedInSortedRanges=function(a,c){var d=null;for(var e=0;e<a.length;e++){var f=a[e];for(var g=e;g<c.length;g++){var h=c[g];if(b("oz-player/utils/OzNumericalHelper").equalTo(f.rangeStart,h.rangeStart)&&f.rangeEnd!=null&&h.rangeEnd!=null&&b("oz-player/utils/OzNumericalHelper").equalTo(f.rangeEnd,h.rangeEnd))break;else if(h.rangeEnd!=null&&f.rangeEnd!=null&&!b("oz-player/utils/OzNumericalHelper").equalTo(f.rangeStart,h.rangeStart)){d={rangeStart:h.rangeStart,rangeEnd:h.rangeEnd};break}else if(h.rangeEnd!=null&&f.rangeEnd!=null&&b("oz-player/utils/OzNumericalHelper").equalTo(f.rangeStart,h.rangeStart)&&!b("oz-player/utils/OzNumericalHelper").equalTo(f.rangeEnd,h.rangeEnd)){d={rangeStart:f.rangeEnd,rangeEnd:h.rangeEnd};break}}if(d!==null)break}return d};c.convertFromTimeRanges=function(a){var b=[];for(var c=0;c<a.length;c++)b.push({rangeStart:a[c].startTime,rangeEnd:a[c].endTime});return b};return a}();e.exports=a}),null);
__d("oz-player/manifests/SegmentTemplateSegmentsContainer",["oz-player/shims/OzEventEmitter","oz-player/shims/OzURI","oz-player/shims/ozvariant","oz-player/utils/OzError","oz-player/utils/OzNumericalHelper","oz-player/utils/OzNumericalRangeUtil"],(function(a,b,c,d,e,f){"use strict";var g=1e-4;a=function(){function a(a,c,d,e,f,g){g===void 0&&(g=!1),this.$7=new(b("oz-player/shims/OzEventEmitter"))(),this.$10=null,this.$8=a,this.$2=c,this.$3=d,this.$1=f,this.$4=e,this.$5=this.$11(this.$4),this.$6=g,this.$9=this.$8.getNumber("live_numerical_error_epsilon")}var c=a.prototype;c.getSegmentByTime=function(a){a=this.$8.getBool("live_query_time_in_range")?this.$12(a):a;a=a*this.$3;var c=null;for(var d=this.$4.length-1;d>=0;d--){var e=this.$4[d];if(b("oz-player/utils/OzNumericalHelper").lessThanOrEqual(e.t+e.d*(e.r+1),a,this.$9))break;c=e}if(c===null)return null;if(this.$8.getBool("live_no_segment_when_playhead_is_before_first_segment")&&b("oz-player/utils/OzNumericalHelper").greaterThan(c.t,a,this.$9))return null;e=Math.max(0,Math.floor((a-c.t+this.$9)/c.d));return this.$13(c,e)};c.getSegment=function(a){var b=0;a=a;while(a>=0&&b<this.$4.length){var c=this.$4[b];c=c.r;c=c+1;if(a>=c){a-=c;b++;continue}break}c=this.$4[b];return!c?null:this.$13(c,a)};c.getSegmentAfter=function(a){a=a.getTimeRange().endTime;return this.getSegmentByTime(a)};c.getPredictedSegmentAfter=function(a){return null};c.canPredict=function(){return!1};c.isEndingSegment=function(a){if(!this.$4||!this.$4.length||!this.$6)return!1;var b=this.$4[this.$4.length-1],c=b.r;b=this.$13(b,c);return Math.abs(b.getTimeRange().startTime-a.getTimeRange().startTime)+Math.abs(b.getTimeRange().endTime-a.getTimeRange().endTime)<g};c.updateWith=function(c){c instanceof a||b("oz-player/shims/ozvariant")(0,646),this.$6=c.$6,this.$14(c.$4),this.$15(c.$4),this.$7.emit("segment_updated")};c.getTimeRanges=function(){return this.$10?this.$16(this.$5,this.$10):this.$5};c.blockTimeRange=function(a){this.$10=a};c.$16=function(a,c){return new(b("oz-player/utils/OzNumericalRangeUtil"))().diffSortedRanges(a.map(function(a){return{rangeStart:a.startTime,rangeEnd:a.endTime}}),{rangeStart:c.startTime,rangeEnd:c.endTime}).map(function(a){return{startTime:a.rangeStart,endTime:a.rangeEnd===null||a.rangeEnd===void 0?Infinity:a.rangeEnd}})};c.addUpdateListener=function(a){return this.$7.addListener("segment_updated",a)};c.$12=function(a){var c=a,d=new(b("oz-player/utils/OzNumericalRangeUtil"))().findCurrentRangeIndex(a,this.getTimeRanges().map(function(a){return{rangeStart:a.startTime,rangeEnd:a.endTime}}));if(d===-1){d=new(b("oz-player/utils/OzNumericalRangeUtil"))().findNextRangeIndex(a,this.getTimeRanges().map(function(a){return{rangeStart:a.startTime,rangeEnd:a.endTime}}));d!==-1&&(c=this.getTimeRanges()[d].startTime)}return c};c.$17=function(a,c){if(a.d!==c.d)return!1;var d=a.t+a.d*a.r,e=c.t+c.d*c.r;return b("oz-player/utils/OzNumericalHelper").greaterThanOrEqual(a.t,e,this.$9)||b("oz-player/utils/OzNumericalHelper").greaterThanOrEqual(c.t,d,this.$9)?!1:Number.isInteger((a.t-c.t)/a.d)};c.$14=function(a){if(this.$8.getBool("copy_new_manifest")){var c;(c=this.$4).splice.apply(c,[0,this.$4.length].concat(a));return}if(this.$8.getBool("use_loose_manifest_updates")){(c=this.$4).splice.apply(c,[this.$4.length,0].concat(a));this.$4.sort(function(a,b){if(a.t<b.t)return-1;else if(a.t>b.t)return 1;return a.d===b.d?a.r-b.r:0});c=[];for(var d=0,e=d+1;e<this.$4.length;){var f=this.$4[d],g=this.$4[e];if(f.t===g.t){if(f.d>g.d)throw new(b("oz-player/utils/OzError"))({type:"OZ_REPRESENTATION_PARSER",description:"Previous segment group duration greater than new.",extra:{code:"OZ_RP-1"}});f.d=g.d;f.r=Math.max(f.r,g.r);f.id=g.id;e++;continue}else c.push(this.$4[d]),d=e,e++}this.$4.length>0&&c.push(this.$4[this.$4.length-1]);(f=this.$4).splice.apply(f,[0,this.$4.length].concat(c));return}g=this.$4.length-1;d=a.length-1;e=g;f=d;c=JSON.stringify(this.$4);while(g>=0&&d>=0){var h=this.$4[g],i=a[d];if(b("oz-player/utils/OzNumericalHelper").equalTo(h.t,i.t,this.$9)){var j=g===e||d===f,k=j&&(g!==e&&i.r>h.r||d!==f&&h.r>i.r);j=!j&&h.r!==i.r||k;if(j)throw new(b("oz-player/utils/OzError"))({type:"OZ_REPRESENTATION_PARSER",description:'Segment group "R" field mismatch. Old groups: '+c+"\n            , new groups: "+JSON.stringify(a),extra:{code:"OZ_RP-2"}});if(this.$8.getBool("throw_on_non_zero_r_d_mismatch")&&h.r>0&&h.d!==i.d)throw new(b("oz-player/utils/OzError"))({type:"OZ_REPRESENTATION_PARSER",description:"Duration mismatch between non-zero repeat tag and new.",extra:{code:"OZ_RP-3"}});h.r=Math.max(h.r,i.r);h.id!=null&&i.id!=null&&(h.id=Math.max(h.id,i.id));if(this.$8.getBool("fix_template_duration_artifact_in_manifest")){if(h.d>i.d)throw new(b("oz-player/utils/OzError"))({type:"OZ_REPRESENTATION_PARSER",description:"Previous segment group duration greater than new.",extra:{code:"OZ_RP-4"}});h.d=i.d}g--;d--}else if(b("oz-player/utils/OzNumericalHelper").greaterThan(i.t,h.t,this.$9))this.$4.splice(g+1,0,i),d--;else{if(this.$17(h,i))throw new(b("oz-player/utils/OzError"))({type:"OZ_REPRESENTATION_PARSER",description:"Segment group misalinged",extra:{code:"OZ_RP-5"}});g--}}if(d>=0){(k=this.$4).unshift.apply(k,a.slice(0,d+1))}};c.$15=function(a){a=this.$11(a);a=new(b("oz-player/utils/OzNumericalRangeUtil"))().mergeSortedRanges(this.$5.map(function(a){return{rangeStart:a.startTime,rangeEnd:a.endTime}}).concat(a.map(function(a){return{rangeStart:a.startTime,rangeEnd:a.endTime}})));this.$5=a.map(function(a){return{startTime:a.rangeStart,endTime:a.rangeEnd===null||a.rangeEnd===void 0?Infinity:a.rangeEnd}})};c.$11=function(a){var c=this;a=new(b("oz-player/utils/OzNumericalRangeUtil"))();a=a.mergeSortedRanges(this.$4.map(function(a){var b=c.$13(a,0).getTimeRange().startTime;a=c.$13(a,a.r).getTimeRange().endTime;return{rangeStart:b,rangeEnd:a}}));return a.map(function(a){var b=a.rangeStart;a=a.rangeEnd;a=a===null||a===void 0?Infinity:a;return{startTime:b,endTime:a}})};c.$13=function(a,c){var d=this;c===void 0&&(c=0);var e=a.t,f=a.d,g=a.r;a=a.id;var h=e+f*c,i=this.$8.getBool("use_sc_timebased_segments"),j=this.$8.getBool("use_scf_timebased_segments"),k=this.$8.getBool("touch_cb_key"),l=a!=null?a-(g-c):null;return{getURI:function(){var a=d.$8.getBool("use_templated_pdash_segments")&&d.$1!=null&&l!=null?d.$1.replace("$Number$",l.toString()):d.$2.replace("$Time$",h.toString());a=new(b("oz-player/shims/OzURI"))(a);i&&a.addQueryData("_nc_sc",1);j&&a.addQueryData("_nc_scf",1);var c=a.getQueryData().cb;k&&c!=null&&a.addQueryData("cb",c+"_oz");return a},getTimeRange:function(){return{startTime:h/d.$3,endTime:(h+f)/d.$3}},getByteRange:function(){return null},getSequenceNumber:function(){return null}}};c.getSegmentGroups=function(){return this.$4};c.getEndingSegment=function(){if(this.$4.length==0)return null;var a=this.$4[this.$4.length-1],b=a.r;return this.$13(a,b)};c.forceParseIfNotParsed=function(){};c.getMaxGopSec=function(){return null};return a}();e.exports=a}),null);
__d("PredictedSegmentTemplateSegmentsContainer",["oz-player/manifests/SegmentTemplateSegmentsContainer","oz-player/shims/OzURI","oz-player/shims/ozvariant","oz-player/utils/OzNumericalHelper"],(function(a,b,c,d,e,f){"use strict";var g=b("oz-player/shims/ozvariant");a=function(a){babelHelpers.inheritsLoose(c,a);function c(b,c,d,e,f,g,h,i,j){j===void 0&&(j=!1);c=a.call(this,b,c,d,e,null,j)||this;c.$PredictedSegmentTemplateSegmentsContainer9=0;c.$PredictedSegmentTemplateSegmentsContainer8=j;c.$PredictedSegmentTemplateSegmentsContainer10=e;c.$PredictedSegmentTemplateSegmentsContainer7=b;c.$PredictedSegmentTemplateSegmentsContainer5=d;c.$PredictedSegmentTemplateSegmentsContainer1=f;c.$PredictedSegmentTemplateSegmentsContainer3=h;c.$PredictedSegmentTemplateSegmentsContainer2=g;c.$PredictedSegmentTemplateSegmentsContainer4=i;c.$PredictedSegmentTemplateSegmentsContainer6=b.getNumber("live_numerical_error_epsilon");for(var j=0;j<c.$PredictedSegmentTemplateSegmentsContainer10.length;j++)c.$PredictedSegmentTemplateSegmentsContainer9=Math.max(c.$PredictedSegmentTemplateSegmentsContainer10[j].d,c.$PredictedSegmentTemplateSegmentsContainer9);return c}var d=c.prototype;d.$PredictedSegmentTemplateSegmentsContainer11=function(a,c,d){var e=this.$PredictedSegmentTemplateSegmentsContainer1.replace("$Number$",d.toString()),f=this.$PredictedSegmentTemplateSegmentsContainer7.getBool("touch_cb_key");return{getByteRange:function(){return null},getSequenceNumber:function(){return d},getTimeRange:function(){return{endTime:c,startTime:a}},getURI:function(){var a=new(b("oz-player/shims/OzURI"))(e),c=a.getQueryData().cb;f&&c!=null&&a.addQueryData("cb",c+"_oz");return a}}};d.updateWith=function(b){b instanceof c||g(0,646);this.$PredictedSegmentTemplateSegmentsContainer3=b.$PredictedSegmentTemplateSegmentsContainer3;a.prototype.updateWith.call(this,b);this.$PredictedSegmentTemplateSegmentsContainer10=b.$PredictedSegmentTemplateSegmentsContainer10;this.$PredictedSegmentTemplateSegmentsContainer8=b.$PredictedSegmentTemplateSegmentsContainer8;for(var b=0;b<this.$PredictedSegmentTemplateSegmentsContainer10.length;b++)this.$PredictedSegmentTemplateSegmentsContainer9=Math.max(this.$PredictedSegmentTemplateSegmentsContainer10[b].d,this.$PredictedSegmentTemplateSegmentsContainer9)};d.getSegmentByTime=function(a){return this.$PredictedSegmentTemplateSegmentsContainer7.getLegacyConfig().getBool("pdash_seq_based_approx",!1)&&this.$PredictedSegmentTemplateSegmentsContainer2!=null&&this.$PredictedSegmentTemplateSegmentsContainer4!=null?this.$PredictedSegmentTemplateSegmentsContainer12(a):this.$PredictedSegmentTemplateSegmentsContainer13(a)};d.getPredictedSegmentAfter=function(a){return a!=null&&a.getSequenceNumber()!=null&&this.canPredict()?this.$PredictedSegmentTemplateSegmentsContainer11(0,0,a.getSequenceNumber()+1):null};d.getTimeRanges=function(){if(this.$PredictedSegmentTemplateSegmentsContainer7.getLegacyConfig().getBool("pdash_seq_based_approx",!1)&&this.$PredictedSegmentTemplateSegmentsContainer2!=null&&this.$PredictedSegmentTemplateSegmentsContainer4!=null)return[{endTime:(this.$PredictedSegmentTemplateSegmentsContainer10[this.$PredictedSegmentTemplateSegmentsContainer10.length-1].t+this.$PredictedSegmentTemplateSegmentsContainer10[this.$PredictedSegmentTemplateSegmentsContainer10.length-1].d)/this.$PredictedSegmentTemplateSegmentsContainer5,startTime:(this.$PredictedSegmentTemplateSegmentsContainer10[0].t-this.$PredictedSegmentTemplateSegmentsContainer4-(this.$PredictedSegmentTemplateSegmentsContainer3-this.$PredictedSegmentTemplateSegmentsContainer10.length-Number(this.$PredictedSegmentTemplateSegmentsContainer2))*Number(this.$PredictedSegmentTemplateSegmentsContainer4))/this.$PredictedSegmentTemplateSegmentsContainer5}];else return a.prototype.getTimeRanges.call(this)};d.canPredict=function(){var a=this.$PredictedSegmentTemplateSegmentsContainer7.getLegacyConfig().getNumber("num_predictive_segments",0);return a>0};d.$PredictedSegmentTemplateSegmentsContainer13=function(a){var c=null;a=a*this.$PredictedSegmentTemplateSegmentsContainer5;var d=0;for(var e=0;this.$PredictedSegmentTemplateSegmentsContainer10.length-1-e>=0;e++){var f=this.$PredictedSegmentTemplateSegmentsContainer10[this.$PredictedSegmentTemplateSegmentsContainer10.length-1-e];f.r===0||g(0,18769);if(b("oz-player/utils/OzNumericalHelper").lessThanOrEqual(f.t+f.d*(f.r+1),a,this.$PredictedSegmentTemplateSegmentsContainer6))break;c=f;d=e}if(c===null)return null;else return this.$PredictedSegmentTemplateSegmentsContainer11(c.t/this.$PredictedSegmentTemplateSegmentsContainer5,(c.t+c.d)/this.$PredictedSegmentTemplateSegmentsContainer5,this.$PredictedSegmentTemplateSegmentsContainer3-d)};d.$PredictedSegmentTemplateSegmentsContainer12=function(a){var c=a*this.$PredictedSegmentTemplateSegmentsContainer5,d=this.getTimeRanges();if(b("oz-player/utils/OzNumericalHelper").greaterThan(d[0].startTime,a)||b("oz-player/utils/OzNumericalHelper").lessThanOrEqual(d[0].endTime,a))return null;else if(b("oz-player/utils/OzNumericalHelper").lessThanOrEqual(this.$PredictedSegmentTemplateSegmentsContainer10[0].t,c))return this.$PredictedSegmentTemplateSegmentsContainer13(a);else{d=Math.ceil((this.$PredictedSegmentTemplateSegmentsContainer10[0].t-c)/Number(this.$PredictedSegmentTemplateSegmentsContainer4));c=Math.max(Number(this.$PredictedSegmentTemplateSegmentsContainer2),this.$PredictedSegmentTemplateSegmentsContainer3-this.$PredictedSegmentTemplateSegmentsContainer10.length+1-d);return this.$PredictedSegmentTemplateSegmentsContainer11(a,a+Number(this.$PredictedSegmentTemplateSegmentsContainer4)/this.$PredictedSegmentTemplateSegmentsContainer5,c)}};d.isEndingSegment=function(b){if(!this.$PredictedSegmentTemplateSegmentsContainer8)return!1;var c=b.getSequenceNumber();return c!=null?c>=this.$PredictedSegmentTemplateSegmentsContainer3:a.prototype.isEndingSegment.call(this,b)};d.getEndingSegment=function(){if(this.$PredictedSegmentTemplateSegmentsContainer10.length===0)return null;var a=this.$PredictedSegmentTemplateSegmentsContainer10[this.$PredictedSegmentTemplateSegmentsContainer10.length-1];return this.$PredictedSegmentTemplateSegmentsContainer11(a.t/this.$PredictedSegmentTemplateSegmentsContainer5,(a.t+a.d)/this.$PredictedSegmentTemplateSegmentsContainer5,this.$PredictedSegmentTemplateSegmentsContainer3)};d.getMaxGopSec=function(){return this.$PredictedSegmentTemplateSegmentsContainer9/this.$PredictedSegmentTemplateSegmentsContainer5};return c}(b("oz-player/manifests/SegmentTemplateSegmentsContainer"));e.exports=a}),null);
__d("oz-player/utils/OzUrlHelper",[],(function(a,b,c,d,e,f){"use strict";f.joinRelativeUrlPaths=a;f.joinUrlPaths=b;f._isAbsoluteUrl=c;function g(a){var b=a.lastIndexOf("/"),c=a.lastIndexOf("://");b>c+2&&(a=a.substring(0,b+1));return a}function h(a){a=g(a);return a.endsWith("/")?g(a.substring(0,a.length-1)):a}function i(a,b){a=g(a);while(b.length)if(b.startsWith("./"))b=b.substring(2);else if(b.startsWith("../"))b=b.substring(3),a=h(a),a.endsWith("/")&&(a=a.substring(0,a.length-1));else if(b.startsWith(".."))b=b.substring(2),a=h(a);else if(b.startsWith("."))b=b.substring(1);else break;b&&b.length&&(a.endsWith("/")||(a+="/"),a+=b);return a}function a(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];if(!b||!b.length)return"";if(b.length===1)return b[0];var d=b.shift();while(b.length>0)d=i(d,b.shift());return d}function b(a,b){return this._isAbsoluteUrl(b)?b:this.joinRelativeUrlPaths(a,b)}function c(a){var b=/^https?:\/\//i;return b.test(a)}}),null);
__d("oz-player/parsers/OzDefaultSegmentTimelineParser",["oz-player/manifests/SegmentTemplateSegmentsContainer","oz-player/utils/OzUrlHelper"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){}a.parseSegments=function(a,b){a=[];b.SegmentTimeline[0].S&&(a=b.SegmentTimeline[0].S.map(function(a){return{t:Number.parseInt(a.$.t,10),d:Number.parseInt(a.$.d,10),r:Number.parseInt(a.$.r||"0",10),id:a.$.id?Number.parseInt(a.$.id,10):void 0}}));return a};var c=a.prototype;c.parseSegmentsContainer=function(c,d,e){return new(b("oz-player/manifests/SegmentTemplateSegmentsContainer"))(c,b("oz-player/utils/OzUrlHelper").joinUrlPaths(d.baseUrl,e.$.media),Number.parseInt(e.$.timescale,10),a.parseSegments(c,e),null,d.isStaticMpd)};return a}();e.exports=a}),null);
__d("OzPredictedSegmentTimelineParser",["PredictedSegmentTemplateSegmentsContainer","oz-player/manifests/SegmentTemplateSegmentsContainer","oz-player/parsers/OzDefaultSegmentTimelineParser","oz-player/shims/OzURI","oz-player/utils/OzUrlHelper"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){}var c=a.prototype;c.parseSegmentsContainer=function(a,c,d){var e;if(d.SegmentTimeline[0].$.FBPredictedMedia){e=b("oz-player/utils/OzUrlHelper").joinUrlPaths(c.baseUrl,d.SegmentTimeline[0].$.FBPredictedMedia);var f=new(b("oz-player/shims/OzURI"))(e);f=f.addQueryData("_nc_sc",1);e=f.toString()}var g;d.SegmentTimeline[0].$.FBPredictedMediaStartNumber&&(g=Number.parseInt(d.SegmentTimeline[0].$.FBPredictedMediaStartNumber,0));var h;d.SegmentTimeline[0].$.FBPredictedMediaEndNumber&&(h=Number.parseInt(d.SegmentTimeline[0].$.FBPredictedMediaEndNumber,0));var i;d.SegmentTimeline[0].$.FBAverageDuration&&(i=Number.parseInt(d.SegmentTimeline[0].$.FBAverageDuration,0));f=b("oz-player/parsers/OzDefaultSegmentTimelineParser").parseSegments(a,d);return(c.isTemplatedMpd&&g!=null&&i!=null||!c.isTemplatedMpd)&&e!=null&&h!=null?new(b("PredictedSegmentTemplateSegmentsContainer"))(a,b("oz-player/utils/OzUrlHelper").joinUrlPaths(c.baseUrl,d.$.media),Number.parseInt(d.$.timescale,10),f,e,g,h,i,c.isStaticMpd):new(b("oz-player/manifests/SegmentTemplateSegmentsContainer"))(a,b("oz-player/utils/OzUrlHelper").joinUrlPaths(c.baseUrl,d.$.media),Number.parseInt(d.$.timescale,10),f,e,c.isStaticMpd)};return a}();e.exports=a}),null);
__d("OzVideoLiveTraceNetworkRequestStreamHandler",["oz-player/networks/OzTransformStream","oz-player/utils/OzResourceTimingUtils"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a}var c=a.prototype;c.onResponse=function(a,c){var d=this,e=a.headers;if(!this.$1)return null;a=new(b("oz-player/networks/OzTransformStream"))();a.addListener("writableClose",function(){var a={},f=b("oz-player/utils/OzResourceTimingUtils").getLatestResourceTimingEntry(c);f&&(a.lat=Math.round(f.responseStart-f.requestStart).toString());d.$1&&e&&d.$1(e,a)});return a};c.onError=function(a,b){return null};return a}();e.exports=a}),null);
__d("P2PPlaybackSessionLogger",["LiveVideoWorkplaceP2PPlaybackTypedLogger","Random"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$4=!1,this.$1=a,this.$2=b("Random").uint32(),this.$7()}var c=a.prototype;c.getSessionID=function(){return this.$2};c.setCurrentHiveStats=function(a){this.$3=a,!this.$4&&a.p2pRequests>0&&(this.$4=!0,this.logReceivedFirstPeerRequest())};c.pauseStatsLogging=function(){this.$5&&(window.clearInterval(this.$5),this.$5=null)};c.resumeStatsLogging=function(){this.$7()};c.$7=function(){this.$5||(this.$5=window.setInterval(this.logStats.bind(this),60*1e3))};c.$8=function(){return new(b("LiveVideoWorkplaceP2PPlaybackTypedLogger"))().setVideoID(this.$1).setSessionID(this.$2).setTimeMs(Date.now())};c.logEnableP2P=function(){this.$8().setEventStr("ENABLE_P2P").log()};c.logSessionInit=function(a,b){this.$6=Date.now(),this.$8().setEventStr("SESSION_INITIALIZED").setHivePluginTech(a).setViewerManifestURL(b).log()};c.logSessionActive=function(a){this.$8().setEventStr("SESSION_ACTIVE").setHivePluginTech(a).log()};c.logManifestMismatch=function(a,b){this.$8().setEventStr("MANIFEST_MISMATCH").setBroadcastURL(a).setViewerManifestURL(b).log()};c.logError=function(a){this.$8().setEventStr("ERROR").setExceptionTrace(a.stack).setExceptionMessage(a.message).setExceptionType(a.name).log()};c.logHiveError=function(a){this.$8().setEventStr("ERROR").setExceptionMessage(a.message).setExceptionType("HiveErrorMessage").setExceptionCode(a.code).setExceptionSeverity(a.severity).log()};c.logUnload=function(){var a=this.$8().setEventStr("UNLOAD"),b=this.$3;b&&a.setHiveClientStatsCdnRequests(b.cdnRequests).setHiveClientStatsCdnResponseBytes(b.cdnResponseBytes).setHiveClientStatsCdnResponseErrors(b.cdnResponseErrors).setHiveClientStatsCdnResponses(b.cdnResponses).setHiveClientStatsP2pRequests(b.p2pRequests).setHiveClientStatsP2pResponseBytes(b.p2pResponseBytes).setHiveClientStatsP2pResponseErrors(b.p2pResponseErrors).setHiveClientStatsP2pResponses(b.p2pResponses).setHiveClientStatsSavings(parseInt(b.savings,10)).setHiveClientStatsNumPartners(Object.keys(b.partners).length);a.log()};c.logCreatedP2PVideoSource=function(){this.$8().setEventStr("CREATED_VIDEO_SOURCE").log()};c.logStats=function(){var a=this.$3,b=this.$8().setEventStr("STATS");a&&b.setHiveClientStatsCdnRequests(a.cdnRequests).setHiveClientStatsCdnResponseBytes(a.cdnResponseBytes).setHiveClientStatsCdnResponseErrors(a.cdnResponseErrors).setHiveClientStatsCdnResponses(a.cdnResponses).setHiveClientStatsP2pRequests(a.p2pRequests).setHiveClientStatsP2pResponseBytes(a.p2pResponseBytes).setHiveClientStatsP2pResponseErrors(a.p2pResponseErrors).setHiveClientStatsP2pResponses(a.p2pResponses).setHiveClientStatsSavings(parseInt(a.savings,10)).setHiveClientStatsNumPartners(Object.keys(a.partners).length);b.log()};c.logReceivedFirstPeerRequest=function(){this.$8().setEventStr("RECEIVED_FIRST_PEER_REQUEST").log()};c.logEndSession=function(){this.pauseStatsLogging();var a=this.$6;a=a!=null?Date.now()-a:-1;this.$8().setEventStr("SESSION_END").setTimeSpentInP2pMs(a).log()};c.logMissingGetRequestPromise=function(){this.$8().setEventStr("MISSING_GET_REQUEST_PROMISE").log()};return a}();e.exports=a}),null);
__d("oz-player/shims/OzDOMEventListener",["requireCond","cr:1615796"],(function(a,b,c,d,e,f){"use strict";a=b("cr:1615796");e.exports=a}),null);
__d("oz-player/shims/OzSubscriptionsHandler",["requireCond","cr:1615800"],(function(a,b,c,d,e,f){"use strict";a=b("cr:1615800");e.exports=a}),null);
__d("oz-player/shims/ozThrottle",["requireCond","cr:1615805"],(function(a,b,c,d,e,f){"use strict";a=b("cr:1615805");e.exports=a}),null);
__d("oz-player/utils/OzBufferingUtils",[],(function(a,b,c,d,e,f){"use strict";f.hasEnoughBuffer=a;f.hasBufferedToOrReachedEnd=h;f.getBufferAheadFromPlaybackStates=b;f.getBufferAheadFromCurrentTime=i;f.getNumericalRangesFromSourceBuffer=c;f.hasEnoughPartialBuffer=d;e=.1;f.BUFFER_UNDERFLOW_THRESHOLD=e;a=1;f.BUFFER_OVERFLOW_THRESHOLD=a;var g=.2;f.BUFFER_FUDGE_FACTOR=g;function a(a,b,c,d){if(h(a,c,d))return!0;c=a.currentTime;d=0;for(var e=0;e<a.buffered.length;e++){var f=a.buffered.start(e),g=a.buffered.end(e);if(f<=c&&g>=c){d=g;break}}return d-c>b}function h(a,b,c){var d=a.currentTime,e=0;for(var f=0;f<a.buffered.length;f++){var h=a.buffered.start(f),i=a.buffered.end(f);if(h<=d&&i>=d){e=i;break}}return(!c.getBool("reach_end_only_when_video_ended",!1)||a.ended)&&(Math.abs(e-b)<=g||Math.abs(d-b)<=g)}function b(a,b){a=a?a.getSourceBufferState():null;if(!a)return 0;b=b.getCurrentTime();return i(b,a.getBufferedRanges())}function i(a,b){var c=null;for(var d=0;d<b.length;d++){var e=b[d];e.startTime<=a&&e.endTime>a&&(c=e)}return!c?0:c.endTime-a}function c(a){var b=[];for(var c=0;c<a.buffered.length;c++)b.push({rangeStart:a.buffered.start(c),rangeEnd:a.buffered.end(c)});return b}function d(a,b,c,d){if(c.length===0||b.size===0)return!1;var e=null;for(var f=0;f<c.length;f++){var g=c[f],h=b.get(g);if(h!=null){h=h.getBufferedRanges();for(var i=0;i<h.length;i++)if(h[i].startTime<=a&&h[i].endTime>=a){e=g;break}}if(e!=null)break}if(e==null)return!1;h=!0;b.forEach(function(c,b){if(e===b)return;b=c.getBufferedRanges();for(var c=0;c<b.length;c++)a-b[c].endTime<d&&(c=!1)});return!h}}),null);
__d("oz-player/strategies/OzBufferingDetectorStates",["oz-player/utils/OzBufferingUtils"],(function(a,b,c,d,e,f){"use strict";var g=function(){function a(a,b){this.$1=a,this.$2=b}var c=a.prototype;c.handleEvent=function(a,c,d){if(a.type==="pause"||c.paused)return new h(this.$1);a=this.$2 instanceof i?this.$1.getNumber("in_play_buffer_overflow_target",b("oz-player/utils/OzBufferingUtils").BUFFER_OVERFLOW_THRESHOLD):this.$1.getNumber("start_buffer_underflow_target",b("oz-player/utils/OzBufferingUtils").BUFFER_OVERFLOW_THRESHOLD);return b("oz-player/utils/OzBufferingUtils").hasEnoughBuffer(c,a,d,this.$1)?new i(this.$1):this};return a}();f.OzVideoBufferingState=g;var h=function(){function a(a){this.$1=a}var c=a.prototype;c.handleEvent=function(a,c,d){if(a.type==="play"||a.type==="playing"||!c.paused){a=this.$1.getNumber("start_buffer_underflow_target",b("oz-player/utils/OzBufferingUtils").BUFFER_UNDERFLOW_THRESHOLD);return b("oz-player/utils/OzBufferingUtils").hasEnoughBuffer(c,a,d,this.$1)?new i(this.$1):new g(this.$1,this)}return this};return a}();f.OzVideoPausedState=h;var i=function(){function a(a){this.$1=a,this.$2=a.getString("stream_types_eligible_for_partial_playback","").split(",")}var c=a.prototype;c.handleEvent=function(a,c,d,e){e===void 0&&(e=new Map());if(a.type==="pause"||c.paused)return new h(this.$1);var f=this.$1.getNumber("in_play_buffer_underflow_target",b("oz-player/utils/OzBufferingUtils").BUFFER_UNDERFLOW_THRESHOLD);return this.$1.getBool("buffer_when_waiting",!1)&&a.type==="waiting"||!b("oz-player/utils/OzBufferingUtils").hasEnoughBuffer(c,f,d,this.$1)&&!b("oz-player/utils/OzBufferingUtils").hasEnoughPartialBuffer(c.currentTime,e,this.$2,this.$1.getNumber("partial_playback_buffer_overflow",0))?new g(this.$1,this):this};return a}();f.OzVideoPlayingState=i}),null);
__d("oz-player/utils/OzDomEventCapturer",["oz-player/shims/OzDOMEventListener"],(function(a,b,c,d,e,f){"use strict";var g=b("oz-player/shims/OzDOMEventListener").captureDOMEvent,h=b("oz-player/shims/OzDOMEventListener").suppressDOMEvent;a=function(){function a(a){this.$2=new Map(),this.$1=a}var b=a.prototype;b.capture=function(a,b){var c=this,d=this.$1.parentNode;return!d?{remove:function(){}}:g(d,a,function(a){if(a.target!==c.$1)return;var d=b(a);d&&c.$3(a)})};b.dispatchIfSuppressed=function(a){var b=this.$2.get(a);b&&this.$1.dispatchEvent(b);this.$2["delete"](a)};b.$3=function(a){h(a),this.$2.set(a.type,a)};return a}();e.exports=a}),null);
__d("oz-player/strategies/OzBufferingDetector",["oz-player/shims/OzDOMEventListener","oz-player/shims/OzEventEmitter","oz-player/shims/OzSubscriptionsHandler","oz-player/shims/ozThrottle","oz-player/utils/OzBufferingUtils","oz-player/utils/OzDomEventCapturer","oz-player/strategies/OzBufferingDetectorStates"],(function(a,b,c,d,e,f){"use strict";var g=b("oz-player/shims/OzDOMEventListener").listenDOMEvent,h=150;a=function(a){babelHelpers.inheritsLoose(c,a);function c(c,d,e){var f;f=a.call(this)||this;f.$OzBufferingDetector3=new(b("oz-player/shims/OzSubscriptionsHandler"))();f.$OzBufferingDetector7=new Map();f.$OzBufferingDetector8=function(a){f.$OzBufferingDetector10(a)};f.$OzBufferingDetector9=function(a){a=f.$OzBufferingDetector10(a)instanceof b("oz-player/strategies/OzBufferingDetectorStates").OzVideoBufferingState;return f.$OzBufferingDetector5.getBool("suppress_playing_event_while_buffering",!1)?a:!1};f.$OzBufferingDetector2=c;f.$OzBufferingDetector5=d;f.$OzBufferingDetector6=e;f.$OzBufferingDetector2.paused?f.$OzBufferingDetector1=new(b("oz-player/strategies/OzBufferingDetectorStates").OzVideoPausedState)(f.$OzBufferingDetector5):f.$OzBufferingDetector1=b("oz-player/utils/OzBufferingUtils").hasEnoughBuffer(f.$OzBufferingDetector2,f.$OzBufferingDetector5.getNumber("in_play_buffer_underflow_target",b("oz-player/utils/OzBufferingUtils").BUFFER_UNDERFLOW_THRESHOLD),f.$OzBufferingDetector6(),f.$OzBufferingDetector5)?new(b("oz-player/strategies/OzBufferingDetectorStates").OzVideoPlayingState)(f.$OzBufferingDetector5):new(b("oz-player/strategies/OzBufferingDetectorStates").OzVideoBufferingState)(f.$OzBufferingDetector5,null);f.$OzBufferingDetector4=new(b("oz-player/utils/OzDomEventCapturer"))(f.$OzBufferingDetector2);f.$OzBufferingDetector3.addSubscriptions(g(f.$OzBufferingDetector2,"pause",f.$OzBufferingDetector8),g(f.$OzBufferingDetector2,"play",f.$OzBufferingDetector8),f.$OzBufferingDetector4.capture("playing",f.$OzBufferingDetector9),g(f.$OzBufferingDetector2,"progress",b("oz-player/shims/ozThrottle")(f.$OzBufferingDetector8,h)),g(f.$OzBufferingDetector2,"timeupdate",b("oz-player/shims/ozThrottle")(f.$OzBufferingDetector8,h)),g(f.$OzBufferingDetector2,"seeked",f.$OzBufferingDetector8),g(f.$OzBufferingDetector2,"seeking",f.$OzBufferingDetector8),g(f.$OzBufferingDetector2,"waiting",f.$OzBufferingDetector8));f.$OzBufferingDetector5.getBool("listen_for_canplay_in_buffering_detector",!1)&&f.$OzBufferingDetector3.addSubscriptions(g(f.$OzBufferingDetector2,"canplay",f.$OzBufferingDetector8),g(f.$OzBufferingDetector2,"canplaythrough",f.$OzBufferingDetector8));return f}var d=c.prototype;d.setSourceBufferState=function(a,b){this.$OzBufferingDetector7.set(a,b)};d.$OzBufferingDetector10=function(a){a=this.$OzBufferingDetector1.handleEvent(a,this.$OzBufferingDetector2,this.$OzBufferingDetector6(),this.$OzBufferingDetector7);var c=this.$OzBufferingDetector1;this.$OzBufferingDetector1=a;var d=a instanceof b("oz-player/strategies/OzBufferingDetectorStates").OzVideoBufferingState,e=c instanceof b("oz-player/strategies/OzBufferingDetectorStates").OzVideoBufferingState;if(a===c)return a;if(d){d=c instanceof b("oz-player/strategies/OzBufferingDetectorStates").OzVideoPlayingState?"in_play":"start/unpause";this.emit("enterBuffering",d)}else e&&this.emit("leaveBuffering");a instanceof b("oz-player/strategies/OzBufferingDetectorStates").OzVideoPlayingState&&this.$OzBufferingDetector4.dispatchIfSuppressed("playing");return a};d.destroy=function(){this.$OzBufferingDetector3.release()};return c}(b("oz-player/shims/OzEventEmitter"));e.exports=a}),null);
__d("VideoPlayerOzImplementationEnginePartsImplUtils",["OzWidevineDrmProvider","gkx","oz-player/strategies/OzBufferingDetector","qex"],(function(a,b,c,d,e,f){"use strict";f.checkShouldIncludeOsParam=a;f.checkShouldIncludeCredentials=c;f.createOzBufferingDetector=d;f.createOzDrmProviders=e;f.createOzPerfLoggerProviders=i;f.calculateInitialPlaybackPositionForDynamicMpd=j;f.calculateLiveheadFallBehindBlockThreshold=k;f.calculateLiveheadFallBehindBlockMargin=l;var g=/(livestream-)?lookaside\.(facebook|workplace)\.com$/,h=b("qex")._("1770917");function a(a){return h!==null&&h!==void 0&&h!==""?{os_param:h}:null}function c(a){return g.test(a.getDomain())}function d(a,c,d,e,f){if(f.current!=null)return;var g=!0,h=function(){if(g)return!1;var a=f.current!==i;return a&&b("gkx")("1508440")?!0:!1},i=new(b("oz-player/strategies/OzBufferingDetector"))(a,d,function(){var a=e.getCurrentState();a=a.controlledState;return a.streamEnded?c.getDuration():Infinity});f.current=i;g=!1;a=function(a){if(h())return;if(b("gkx")("1235655"))return;e.dispatch({payload:{bufferingType:a},type:"buffering_begin_requested"})};d=function(){if(h())return;e.dispatch({type:"buffering_end_requested"})};i.addListener("enterBuffering",a);i.addListener("leaveBuffering",d)}function e(a){var c=a.accessToken,d=a.graphQLVideoDRMInfo;a=a.videoFBID;var e=[];d&&a!=null&&e.push(new(b("OzWidevineDrmProvider"))(a,d.graphApiVideoLicenseUri,d.videoLicenseUriMap,c,null));return e}function i(a){var b=a.VideoPlayerShakaPerformanceLoggerClass,c=a.accessToken,d=a.getApproximateFBLSToPlayerDisplayLatency,e=a.getBandwidthEstimate,f=a.playbackIsLiveStreaming,g=a.playerInstanceCount,h=a.playerInstanceKey,i=a.playerSuborigin,j=a.playerVersion,k=a.videoElement;a=a.videoFBID;if(!b||!b.shouldInitialize())return[];d={accessToken:c,getApproximateFBLSToPlayerDisplayLatency:d,getBandwidthEstimate:e,isLive:f,isServableViaFbms:!1,playerInstanceCount:g,playerOrigin:null,playerSuborigin:i,playerVersion:j,representationId:null,uniqueID:h,video:k,videoID:(c=a)!=null?c:""};return[new b(d)]}function j(a,b){return b>0?b/1e3*-1:a.getNumber("live_initial_playback_position",0)}function k(a,b,c){return b>0&&c>0?(b+c)/1e3:a.getNumber("livehead_fall_behind_block_threshold",0)}function l(a,b){return b>0?b/2/1e3:a.getNumber("live_time_range_block_margin",0)}}),null);
__d("OzMinimumSmallestDimensionRestriction",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a}var b=a.prototype;b.applyRestriction=function(a,b){var c=this;if(a.length===0)return[];b=a.filter(function(a){var b=a.getWidth();a=a.getHeight();b=b<a?b:a;return b>=c.$1});return b.length>0?b:[a[a.length-1]]};return a}();e.exports=a}),null);
__d("MosUtils",[],(function(a,b,c,d,e,f){"use strict";f.getQualityLabel=g;f.getMosValue=h;f.parsePlaybackMos=a;f.filterTracksWithExpensiveMos=b;function g(a,b){if(a===0||b===0)return 0;if(a<b){var c=a;a=b;b=c}c=a/b;return c>16/9?Math.round(a/(16/9)):b}function h(a,b){var c=null,d=null,e=null,f=null;for(var g=0;g<a.length;g++){var h=a[g].qualityLabel;if(h<=b)e=a[g].mosValue,c=h;else{f=a[g].mosValue;d=h;break}}if(c===null&&d===null)return 0;else if(c===null&&f!==null)return f;else if(d===null&&e!==null)return e;else if(f!==null&&e!==null&&c!==null&&d!==null){h=e+(b-c)*(f-e)/(d-c);return h<0?0:h>100?100:h}return 0}function a(a){a=a.split(",");var b=[];for(var c=0;c<a.length;c++){var d=a[c].split(":");if(d.length!==2)return null;var e=Number(d[0]);d=Number(d[1]);if(isNaN(e)||isNaN(d))return null;b.push({qualityLabel:e,mosValue:d})}return b}function b(a,b,c,d,e,f){if(a.length<2)return a;var i=a.map(function(a){return{track:a,mosValue:a.playbackResolutionMos?h(a.playbackResolutionMos,g(b,c)):-1}}),j=[],k=e;for(var l=i.length-1;l>0;l--){if(i[l].mosValue===-1||i[l-1].mosValue===-1)return a;var m=i[l].track.bandwidth||-1,n=i[l-1].track.bandwidth||-1;if(m===-1||n===-1)return a;if(i[l].mosValue<i[l-1].mosValue&&m>=n)continue;m=i[l-1].track.bandwidth!==null?i[l].mosValue-i[l-1].mosValue:Infinity;if(m<=k&&i[l].track.bandwidth&&d/i[l].track.bandwidth<=f){k-=m;continue}else k=e;j.push(i[l].track)}j.push(i[0].track);j.reverse();return j}}),null);
__d("OzMosThresholdRestriction",["MosUtils"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$3=new Map(),this.$4=a,this.$1=a.getNumber("mos_upper_threshold",0),this.$2=a.getNumber("mos_lower_threshold",0)}var c=a.prototype;c.$5=function(){return this.$4.getBool("cache_mos_threshold",!1)?{mosUpperThreshold:this.$1,mosLowerThreshold:this.$2}:{mosUpperThreshold:this.$4.getNumber("mos_upper_threshold",0),mosLowerThreshold:this.$4.getNumber("mos_lower_threshold",0)}};c.$6=function(a,c){var d=null;if(this.$3.get(a))d=this.$3.get(a);else{var e=a.getCustomField("playbackResolutionMos");e!=null&&(d=b("MosUtils").parsePlaybackMos(String(e)),d&&this.$3.set(a,d))}return d!=null?b("MosUtils").getMosValue(d,b("MosUtils").getQualityLabel(c.width,c.height)):null};c.$7=function(a,b){var c=this,d=null,e=this.$5(),f=e.mosUpperThreshold;a.forEach(function(a){a=c.$6(a,b);a!=null&&a>f&&(d==null||d>a)&&(d=a)});return d==null?a:a.filter(function(a){a=c.$6(a,b);return a==null?!0:a<=f||a===d})};c.$8=function(a,b){var c=this,d=[],e=this.$5(),f=e.mosLowerThreshold;a.forEach(function(a){var e=c.$6(a,b);e!=null&&e>f&&d.push(a)});d.length===0&&d.push(a[a.length-1]);return d};c.applyRestriction=function(a,b){if(a.length===0)return[];a=a;var c=this.$5(),d=c.mosLowerThreshold;c=c.mosUpperThreshold;c>0&&(a=this.$7(a,b));d>0&&(a=this.$8(a,b));return a};return a}();e.exports=a}),null);
__d("getOzPlaybackRestrictions",["OzMinimumSmallestDimensionRestriction","OzMosThresholdRestriction","gkx"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=720,h=2160;function a(a,c){var d=[];switch(a){case"HD":d.push(new(b("OzMinimumSmallestDimensionRestriction"))(g));break;case"UHD":b("gkx")("1488288")&&d.push(new(b("OzMinimumSmallestDimensionRestriction"))(h));break;default:break}a=c.getNumber("mos_upper_threshold",0);var e=c.getNumber("mos_lower_threshold",0);(a>0||e>0)&&d.push(new(b("OzMosThresholdRestriction"))(c));return d}}),null);
__d("oz-player/configs/OzPlayerConfigDefaults",[],(function(a,b,c,d,e,f){a={abr_use_download_time:!1,allow_queueing_end_of_stream_when_update:!1,append_last_segment_if_beyond_end:!0,back_off_pdash_504_retry:!0,bandwidth_ignore_on_stream_write_samples:!1,bandwidth_use_response_time_adjustment:!1,buffer_when_waiting:!1,call_end_of_stream_in_quick_starter:!0,cancel_tracker_on_append_error:!0,check_buffer_range_once_for_playhead_update:!1,cleanup_video_node_on_destroy:!0,clear_buffer_when_switch_representation_initiator_is_user:!0,convert_dom_exception_to_oz_error:!0,copy_new_manifest:!0,delay_stream_end_for_sourceended:!0,detach_media_source_manager:!0,disable_audio_scheduler:!1,emit_stream_error_event:!0,enable_abr_for_first_request:!1,enable_adaptation:!0,enable_appends_on_wait_update_end_failure:!1,enable_network_manager_error:!1,enable_quickdashv2:!0,estimate_video_bandwidth_only:!0,exclude_prefetch_bandwidth_samples:!0,fallback_on_append_error:!1,fix_buffer_ahead_priority_strategy:!0,fix_prepended_segments_tagging:!0,fix_quick_starter_overhead:!0,fix_reload_manifest_retry:!0,fix_seek_performance:!1,fix_setup_video_duration_on_representation_switch:!0,fix_source_buffer_error_logging:!0,fix_stream_deferred_cancel:!0,fix_template_duration_artifact_in_manifest:!0,generate_mos_segment_buffer_diff:!1,handle_mpd_retries_outside_oz_mpd_updater:!0,handle_switch_to_unparsed_representation_sidx:!0,ignore_time_to_response_start:!1,lazy_parse_sidx:!1,listen_for_canplay_in_buffering_detector:!0,live_audio_ibr:!0,live_catch_up_only_when_paused:!1,live_disable_mpd_updates_when_paused:!0,live_gracefully_handle_410:!0,live_gracefully_handle_mpd_errors:!0,live_gracefully_handle_no_network:!0,live_no_segment_when_playhead_is_before_first_segment:!0,live_playhead_catch_up:!1,live_query_time_in_range:!0,load_video_node_on_unload:!0,log_appended_secs:!1,maybe_end_stream_if_prepended_segments:!0,media_source_is_available_in_ended_state:!0,mpd_update_cancel_current_request_tracker:!0,no_new_loop_body_promise_when_stream_ongoing:!0,pausable_stream_throws_error_when_aborted:!0,pdash_download_cursor_catchup_only_when_advancing:!1,pdash_download_cursor_catchup_skip_totalbufer:!0,pdash_download_cursor_pause_duration_of_gop:!1,pdash_use_pdash_segmentlocator:!1,playhead_manager_handle_buffered_timerange_update_on_timeupdate:!1,playhead_manager_handle_timerange_update_on_timeupdate:!0,prevent_unnecessary_seek_stream_anchor_reset:!1,queue_data_with_error_handling:!1,reach_end_only_when_video_ended:!1,remove_src_attr_on_unload:!0,respect_initial_representation_on_setup:!1,retry_fetch_on_prefetch_error:!1,sbm_abort_on_readable_stream_error:!0,sbm_check_source_buffer_ready_state_on_cancel:!0,sbm_recursively_waits_for_update_end:!1,sbm_waits_for_update_end:!0,seek_ahead_use_native_current_time:!0,seek_to_start_quick_starter:!0,set_source_buffer_append_window_end:!1,set_stream_anchor_only_on_done_status:!0,skip_videobuffer_gaps:!1,skip_videobuffer_gaps_on_buffer_updated:!1,stable_buffered_timeranges_in_observedsourcebufferstate:!0,stop_manifest_update_when_static:!0,stream_interrupted_fuzzy_equals:!1,suppress_playing_event_while_buffering:!1,throw_network_error_during_stream:!1,throw_on_non_zero_r_d_mismatch:!0,touch_cb_key:!1,update_bandwidth_cache_on_sample:!1,update_duration_when_init_appended:!0,update_live_video_config_on_representation_switch:!0,update_media_source_duration:!0,use_abr_for_missing_default_representation:!0,use_deferred_streaming_task:!0,use_loose_manifest_updates:!1,use_performance_entry_on_stream_close:!1,use_scf_timebased_segments:!1,use_scheduler:!0,use_sc_timebased_segments:!1,use_segment_request_cache:!1,use_stream_end_time_in_segment_locator:!1,use_templated_pdash_segments:!1,xmlparser_use_domparser:!1};b={abr_confidence_threshold:.9,abr_eval_buffer_threshold:0,abr_min_bandwidth_samples:0,abr_prevent_down_switch_buffer_threshold:11,abr_restrict_from_index:0,abr_restrict_to_index:0,append_byte_target_without_range:1e5,appends_per_segment:3,auto_seek_playhead_slack:.5,bandwidth_boundary_standard_deviation_factor:1,bandwidth_estimator_half_life:6,bandwidth_estimator_outlier_exclusion_factor:50,bandwidth_estimator_std_dev_penalty_factor:0,bandwidth_estimator_variance_penalty_down_factor:0,bandwidth_estimator_variance_penalty_half_life:0,bandwidth_estimator_variance_penalty_up_factor:0,bandwidth_penalty_additional_video_start:0,bandwidth_penalty_per_additional_video:0,bandwidth_response_time_handicap:0,buffer_ahead_target:22,byte_count_per_sample:2e5,catchup_timeout_after_play_sec:0,default_bandwidth_estimate:1e6,download_time_buffer_delta_penalty_factor:0,dynamic_mpd_initial_playback_position_offset_modifier:0,initial_manifest_request_retry_count:3,initial_switch_interval:0,in_play_buffer_overflow_target:1,in_play_buffer_underflow_target:.1,live_audio_ibr_bandwidth_percentage:.05,live_catch_up_fall_behind_threshold:20,live_catch_up_live_head_delta:6,live_max_try_attempts_on_404:2,live_numerical_error_epsilon:1e-4,loop_body_handle_error_interval_ms:1,low_buffer_bandwidth_target_increase_factor:0,low_buffer_bandwidth_target_threshold:10,low_segment_stream_playhead_threshold:0,max_bandwidth_sample_count:30,maximum_bandwidth_sample_bandwidth:2e6,max_start_eme_attempts:3,min_eval_interval:100,minimum_bandwidth_sample_duration:30,minimum_bytes_to_sample_on_close:25e3,minimum_download_additional_buffer_ms:0,min_switch_interval:100,network_seg_timeout_ms:0,partial_playback_buffer_overflow:0,paused_stream_segments_count:2,pdash_download_cursor_bufferahead_gop_multiplier:0,pdash_download_cursor_catchup_threshold_gop_multiplier:0,pdash_download_cursor_catchup_threshold_sec:0,pdash_download_cursor_catchup_tolerance_sec:0,pdash_download_cursor_tolerance_gop_multiplier:0,per_stream_duration_target:0,pixels_above_viewport_to_observe:0,pixels_below_viewport_to_observe:0,playhead_manager_timeupdate_throttle_ms:1e3,playhead_nudge_slack:.1,pre_start_buffer_ahead_target:16.924449682236,prioritize_by_viewport_static_penalty:0,resolution_constraint_factor:2,sbm_read_timeout_ms:0,seconds_to_stream:10,seconds_to_stream_near_bandwidth_boundary:10,seek_ahead_epsilon:.05,segments_to_stream:5,segments_to_stream_near_bandwidth_boundary:5,segments_to_stream_under_playhead_threshold:0,skip_videobuffer_gaps_max_gap_size_sec:0,start_buffer_underflow_target:.1,stream_interrupt_check_mpd_stale_count_threshold:3,tagged_time_range_per_append_throttle:0,timeline_offset_threshold:10,time_to_first_byte_estimate_half_life_ms:500};c={bandwidth_cache_key:"bandwidthEstimate",network_end_broadcasts_json:'["410"]',network_reload_mpd_json:"[]",network_retry_intervals_json:'{"0": 1000, "404": 2000, "502": 1000, "503": 1000, "504": 1000, "429": 2000, "20": 1000}',network_skip_json:"[]",stream_types_eligible_for_partial_playback:""};e.exports={defaultBools:a,defaultNumbers:b,defaultStrings:c}}),null);
__d("oz-player/configs/OzPlayerConfig",["oz-player/configs/OzPlayerConfigDefaults"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){}var c=a.prototype;c.getBool=function(a){return b("oz-player/configs/OzPlayerConfigDefaults").defaultBools[a]};c.getNumber=function(a){return b("oz-player/configs/OzPlayerConfigDefaults").defaultNumbers[a]};c.getString=function(a){return b("oz-player/configs/OzPlayerConfigDefaults").defaultStrings[a]};c.getLegacyConfig=function(){return{getBool:function(a,c){return(a=b("oz-player/configs/OzPlayerConfigDefaults").defaultBools[a])!=null?a:c},getNumber:function(a,c){return(a=b("oz-player/configs/OzPlayerConfigDefaults").defaultNumbers[a])!=null?a:c},getString:function(a,c){return(a=b("oz-player/configs/OzPlayerConfigDefaults").defaultStrings[a])!=null?a:c}}};return a}();e.exports=a}),null);
__d("oz-player/configs/OzConfigUtils",["oz-player/configs/OzPlayerConfig"],(function(a,b,c,d,e,f){"use strict";var g=new(b("oz-player/configs/OzPlayerConfig"))();a=function(a){return{getBool:function(b){return a.getBool(b,g.getBool(b))},getNumber:function(b){return a.getNumber(b,g.getNumber(b))},getString:function(b){return a.getString(b,g.getString(b))},getLegacyConfig:function(){return a}}};f.provideConfigWithDefaults=a}),null);
__d("VideoPlayerOzImplementationEnginePartsImplFunction",["Promise","CometThrottle","ConstUriUtils","OzActiveActiveFailoverNetworkRequestStreamHandler","OzConfigurableRequestImplementation","OzCustomParsers","OzCustomRepresentationParsers","OzDashPrefetchCache","OzOneSemanticHandler","OzPredictedSegmentTimelineParser","OzVideoLiveTraceNetworkRequestStreamHandler","P2PPlaybackSessionLogger","TimeRanges","VideoPlayerConnectionQuality","VideoPlayerOzImplementationEnginePartsImplUtils","getOzPlaybackRestrictions","gkx","oz-player/configs/OzConfigUtils","oz-player/networks/OzBandwidthEstimator","requireCond","unrecoverableViolation","cr:1836349","cr:1836099"],(function(a,b,c,d,e,f){"use strict";f.proceedWithOzPlayerCreation=a;var g=null,h=null;b("cr:1836099")&&(g=b("cr:1836099").HiveConfig,h=b("cr:1836099").HiveOz);function a(a){var c=a.OzPlayerClass,d=a.callChain,e=a.destroyOzPlayerPartsRef,f=a.engineDebugAPI,i=a.engineExtrasAPI,j=a.getCaptionsInfo,k=a.getLatencyLevelManager,l=a.getOzQuickStarter,m=a.getVideoLiveTrace,n=a.handleCaptionsInfoChange,o=a.handleFatalImplementationError,p=a.hivePluginRef,q=a.initialProps,r=a.logger,s=a.machine,t=a.overrideOzRequestImplementationRef,u=a.ozBufferingDetectorRef,v=a.ozPlayerRef,w=a.p2pSessionLoggerRef,x=a.playerVersion,y=a.resolvedVideoInfo,z=a.videoElement;a=a.videoElementAPI;var A={current:null},B={current:null};e.current=function(a){var c=u.current;c&&(u.current=null,c.destroy());c=v.current;c&&(f&&f.handleOzPlayerChanged(null),v.current=null,c.destroy(b("gkx")("1435909")?[].concat(a,["destroyOzPlayerParts"]).join(":"):null));c=A.current;c&&(A.current=null,c());a=B.current;a&&(B.current=null);V();p.current&&(p.current=null);w.current&&(w.current=null);t.current&&(t.current=null)};e=y.VideoPlayerShakaPerformanceLoggerClass;var C=y.accessToken,D=y.experimentationConfig,E=y.graphQLVideoDRMInfo,F=y.graphQLVideoP2PSettings,G=y.manifestUrl,H=y.manifestXmlStringResolved,I=y.minQualityPreference;y=y.videoFBID;l=l();var J=Boolean(q.loggingMetaData.coreVideoPlayerMetaData.isLiveStreaming),K=function(a){return i.getEstimatedBandwidth()},L=function(){return i.getApproximateFBLSToPlayerDisplayLatency()},M=function(){D.setContext("connection_quality",b("VideoPlayerConnectionQuality").evaluate(function(){return K(J)}))},N=function(){var a=D.getNumber("connection_quality_context_throttle_frequency",0);if(a===0)return null;var c=b("CometThrottle")(M,a),d=b("oz-player/networks/OzBandwidthEstimator").addListener("bandwidth_sampled",c);return function(){d.remove(),c.cancel()}};A.current=N();N=b("VideoPlayerOzImplementationEnginePartsImplUtils").createOzDrmProviders({accessToken:C,graphQLVideoDRMInfo:E,videoFBID:y});E=b("VideoPlayerOzImplementationEnginePartsImplUtils").createOzPerfLoggerProviders({VideoPlayerShakaPerformanceLoggerClass:e,accessToken:C,getApproximateFBLSToPlayerDisplayLatency:L,getBandwidthEstimate:K,playbackIsLiveStreaming:J,playerInstanceCount:q.loggingMetaData.playerImplementationInstanceCountRef.current,playerInstanceKey:q.loggingMetaData.instanceKey,playerSuborigin:q.loggingMetaData.coreVideoPlayerMetaData.subOrigin,playerVersion:x,videoElement:z,videoFBID:y});b("cr:1836349")!=null&&B.current==null&&(B.current=new(b("cr:1836349"))());if(F&&y!=null){C=F.hive_initialization_options;x=w.current=(L=w.current)!=null?L:new(b("P2PPlaybackSessionLogger"))(y);try{if(!p.current){x.logEnableP2P();L=function(a){w.current&&w.current.logHiveError(a)};y=function(b){var a=v.current;a&&a.injectExternalDebugEvent("P2PTech",b.tech);w.current&&w.current.logSessionActive(b.tech)};var O=function(b){var a=v.current;a&&a.injectExternalDebugEvent("P2PStats",b);w.current&&w.current.setCurrentHiveStats(b)};O={HiveJS:{renderStatsCallback:O},HiveJava:{},debugLevel:"off",hiveTechOrder:["HiveJS","StatsJS"],onActiveSession:y,onError:L,telemetryId:x.getSessionID()};if(C){y=C.HiveJava;L=C.debugLevel;C=C.hiveTechOrder;O.hiveTechOrder=C.slice();O.HiveJava=y?{minVersion:y.minVersion}:{};O.debugLevel=(C=L)!=null?C:O.debugLevel}if(g)g.SensitiveInfo.restrictedConnectivityInfo=!0;else throw b("unrecoverableViolation")("HiveConfig does not exist","comet_video_player");if(h)p.current=new h(O);else throw b("unrecoverableViolation")("HiveOz does not exist","comet_video_player");p.current&&(t.current=b("OzConfigurableRequestImplementation")(p.current.getRequestImplementation()))}}catch(a){x.logError(a),V()}}y=[new(b("OzVideoLiveTraceNetworkRequestStreamHandler"))(function(a,b){var c=m();c!=null&&c.handleHeaders(a,b)})];b("OzActiveActiveFailoverNetworkRequestStreamHandler")&&y.push(new(b("OzActiveActiveFailoverNetworkRequestStreamHandler"))(function(a,c){if(b("gkx")("1664503")){var d=v.current,e=a.headers;if(d&&e){e=parseInt(e.get("x-fb-video-replica"),10);r.logVPLEvent({eventType:"replica_switch",logDataOverrides:{error_code:a.status.toString(),error_user_info:JSON.stringify({failover_response_code:a.status.toString(),replica:e,url:c})},state:s.getCurrentState()});a=d.getMpdUrl();if(a!=null){c=b("ConstUriUtils").getUri(a);if(c){a=c.addQueryParam("replica",e);a&&d.updatePlayerRunTimeConfig({manifestUrl:a.toString()})}}}}}));L={config:b("oz-player/configs/OzConfigUtils").provideConfigWithDefaults(D),customParsers:b("OzCustomParsers").createOzCustomParser(),customRepresentationParsers:b("OzCustomRepresentationParsers").createOzCustomRepresentationParsers({ozConfig:D}),customSegmentTimelineParser:D.getBool("enable_predictive_dash",!1)?new(b("OzPredictedSegmentTimelineParser"))():void 0,debugCreateInitiator:b("gkx")("1435909")?[].concat(d,["proceedWithOzPlayerCreation"]).join(":"):null,drmProviders:N,getCustomRequestParametersForURI:function(a){var c=a.getQueryData(),d;J&&(d=babelHelpers["extends"]({},b("VideoPlayerOzImplementationEnginePartsImplUtils").checkShouldIncludeOsParam(a)));if(b("gkx")("1836350")){c.uss!=null&&c.odm!=null&&(d=babelHelpers["extends"]({},d,{manual_redirect:"1"}));c=B.current;if(c!=null){a=a.getDomain()+a.getPath();c=c.get(a);if(c!=null)for(var e in c){d=babelHelpers["extends"]({},d,(a={},a[e]=c[e],a))}}}return d},getOverrideOzRequestImplementation:function(){return t.current},getShouldIncludeCredentials:D.getBool("use_oz_credentials_provider",!1)?b("VideoPlayerOzImplementationEnginePartsImplUtils").checkShouldIncludeCredentials:null,getVideoDimensions:function(){return s.getCurrentState().controlledState.dimensions},initialPlaybackPositionForDynamicMpd:b("VideoPlayerOzImplementationEnginePartsImplUtils").calculateInitialPlaybackPositionForDynamicMpd(D,(L=q.initialDesiredLatencyMs)!=null?L:0),initialRepresentationIDs:(C=q.initialRepresentationIds)!=null?C:[],liveheadFallBehindBlockMargin:b("VideoPlayerOzImplementationEnginePartsImplUtils").calculateLiveheadFallBehindBlockMargin(D,(O=q.initialDesiredLatencyMs)!=null?O:0),liveheadFallBehindBlockThreshold:b("VideoPlayerOzImplementationEnginePartsImplUtils").calculateLiveheadFallBehindBlockThreshold(D,(x=q.initialDesiredLatencyMs)!=null?x:0,(d=q.initialLatencyToleranceMs)!=null?d:0),loggerConfig:{isOzDevConsoleEnabled:b("gkx")("722076"),observedOperationLoggers:l&&e&&e.shouldInitialize()?l.getObservedOperationLoggers():[],perfLoggerProviders:E},mpdUrl:G,networkRequestStreamHandlers:y,networkRequestStreamRetryHandler:b("gkx")("1836350")?function(a,c){var d=a.headers,e=d==null?void 0:d.get("x-fb-url-refresh");d=B.current;if(d!=null&&a.status===403&&e!=null){r.logVPLEvent({eventType:"video_cdn_url_expired",state:s.getCurrentState()});return d.refresh(e).then(function(){r.logVPLEvent({eventType:"video_cdn_url_refreshed",state:s.getCurrentState()});return c()})["catch"](function(a){r.logVPLEvent({eventType:"video_cdn_url_refresh_error",logDataOverrides:{error_description:a.message,resource_url:e},state:s.getCurrentState()});throw a})}return b("Promise").resolve(a)}:null,prefetchCache:D.getBool("use_prefetch_cache",!1)?new(b("OzDashPrefetchCache"))():null,rawMpdXml:H,seekHandler:b("gkx")("1482680")?function(a){var b=z.currentTime;s.dispatch({payload:{seekSourcePosition:b},type:"implementation_seek_requested"});z.currentTime=a}:null,startTimeStamp:D.getBool("fix_start_timestamp",!1)?q.startTimestamp:0,videoNodeOrQuickStarter:(N=l)!=null?N:z,videoPlaybackRestrictions:b("getOzPlaybackRestrictions")(I,D)};var P=new c(L);v.current=P;C=q.loggingMetaData.playerImplementationInstanceCountRef;C.current++;P.onError(function(a){o(a,"oz_player_error")});P.addListener("switchVideoRepresentation",function(){s.dispatch({payload:{targetVideoQuality:i.getCurrentTargetVideoQuality()},type:"representation_changed"})});P.addListener("manifestFetchError",function(a){b("OzOneSemanticHandler").handleManifestFetchErrorEvent(D,a)});P.addListener("streamError",function(a){return b("OzOneSemanticHandler").handleStreamErrorEvent(D,a)});P.addListener("streamInterruptAt",function(){s.dispatch({type:"stream_interrupted"})});P.addListener("streamResumedAt",function(){s.dispatch({type:"stream_resumed"})});P.addListener("streamEnd",function(){V(),s.dispatch({type:"stream_ended"})});l==null?(P.addListener("enterBuffering",function(a){if(b("gkx")("1235655"))return;s.dispatch({payload:{bufferingType:a},type:"buffering_begin_requested"})}),P.addListener("leaveBuffering",function(){s.dispatch({type:"buffering_end_requested"})})):b("VideoPlayerOzImplementationEnginePartsImplUtils").createOzBufferingDetector(z,a,D,s,u);f&&f.handleOzPlayerChanged(P);var Q=function(){var a=j();a={inbandCaptionsAutogeneratedFromManifest:i.getInbandCaptionsAutogeneratedFromManifest(),inbandCaptionsExpectedFromManifest:i.getInbandCaptionsExpectedFromManifest(),inbandCaptionsExpectedFromProps:a==null?void 0:a.inbandCaptionsExpectedFromProps,sideLoadCaptionsExpectedFromProps:a==null?void 0:a.sideLoadCaptionsExpectedFromProps,sideLoadCaptionsUrlFromProps:a==null?void 0:a.sideLoadCaptionsUrlFromProps};var b=s.getCurrentState();b=b.controlledState;(a.inbandCaptionsExpectedFromManifest!==b.captionsLoaded||a.inbandCaptionsAutogeneratedFromManifest!==b.inbandCaptionsAutogenerated)&&n(a)},R=function(a,b){a=a.getCustomField("timescale")||0;s.dispatch({payload:{timescale:a,videoBytes:b},type:"cea608_bytes_received"})},S=function(){var a=i.getVideoRepresentations();if(a!=null&&a.length>0){a=a[0].getTimeRanges();if(a!=null&&a.length>0){var c=a[0].startTime;a=Math.max(a[a.length-1].endTime-D.getNumber("live_rewind_seek_to_live_delta",8),c);s.dispatch({payload:{seekableRanges:new(b("TimeRanges"))([{endTime:a,startTime:c}])},type:"seekable_ranges_changed"})}}},T=function(){var a=P.getMpd();if(!a)return;a=a.getCustomField("loapStreamType");var b=m();typeof a==="number"&&b!=null&&b.setStreamType(a)},U=function(a){var c=function(){S(),Q(),T()};a.addListener("updated",c);b("gkx")("1656434")&&c();P.updatePlayerRunTimeConfig({videoStreamDataHandler:R});if(i.isPredictiveDash()){D.setContext("streaming_implementation","pdash");a=k();a&&a.maybeUpdateLatencyLevel()}c=j();n({inbandCaptionsAutogeneratedFromManifest:i.getInbandCaptionsAutogeneratedFromManifest(),inbandCaptionsExpectedFromManifest:i.getInbandCaptionsExpectedFromManifest(),inbandCaptionsExpectedFromProps:c==null?void 0:c.inbandCaptionsExpectedFromProps,sideLoadCaptionsExpectedFromProps:c==null?void 0:c.sideLoadCaptionsExpectedFromProps,sideLoadCaptionsUrlFromProps:c==null?void 0:c.sideLoadCaptionsUrlFromProps})};P.addListener("mpdReady",function(a){U(a);s.dispatch({payload:{availableQualities:i.getAvailableVideoQualities(),selectedVideoQuality:i.getUserSelectedVideoQuality(),targetVideoQuality:i.getCurrentTargetVideoQuality(),videoProjection:(a=i.getVideoProjectionType())!=null?a:null},type:"implementation_engine_initialized"})});function V(){var a=p.current,b=w.current;try{a&&a.closeHiveSession(),b&&b.logEndSession()}catch(a){b&&b.logHiveError(a)}t.current=null}O=p.current;if(G!=null&&F&&O){x=F.ticket;if(x!=null){d=G.substring(G.indexOf("?"));e=O.initSession(x+d,P,z);e.then(function(a){var b=a.manifest;a=a.tech;var c=w.current;b!==G&&c&&c.logManifestMismatch(b,G);c&&c.logSessionInit(a,b);P.load(b)})["catch"](function(a){var b=w.current;b&&b.logError(a);V();P.load(G)})}}else D.getBool("live_use_inline_manifest_after_request_manifest",!1)&&J&&G!=null&&H!=null?P.loadMpdUrlButUseInlinedManifestForExperimentingOnly_DO_NOT_USE(G):P.load(G)}}),null);
__d("VideoPlayerOzImplementationLatencyLevelManager",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b){this.$2="normal",this.$4=null,this.$1=a,this.$3=b}var b=a.prototype;b.updatePlayerFormat=function(a){this.$4!==a&&(this.$4=a,this.maybeUpdateLatencyLevel())};b.maybeUpdateLatencyLevel=function(){var a=this.$5();a!==this.$2&&(this.$2=a,this.$3.dispatch({payload:{latencyLevel:a},type:"implementation_set_latency_level_requested"}))};b.$5=function(){var a=JSON.parse(this.$1.getString("player_formats_for_low_latency","[]"));return a.includes(this.$4)?"low":"normal"};return a}();e.exports=a}),null);
__d("VideoPlayerOzQuickStarterUtils",["VideoDashPrefetchCache"],(function(a,b,c,d,e,f){"use strict";f.createPrefetchDataForTrack=a;function g(a,c,d){c=b("VideoDashPrefetchCache").createQueryStringURL(c);c=b("VideoDashPrefetchCache").getCacheValue(c);if(!c){a.push(d);return null}return c}function h(a,b){return a.find(function(a){return a.segmentType===b})}function a(a,b,c){var d=h(b,"init");b=h(b,"data");if(d){var e=g(a,d,c+" init");if(!e)return null;var f;b&&(f=g(a,b,c+" data"));return{initializationPromise:e,mimeCodec:d.mimeCodec,representationID:d.representationID,segmentPromise:f}}return null}}),null);
__d("VideoPlayerOzImplementationEngine",["VideoPlayerImplementationEngineAPI","VideoPlayerImplementationEngineVideoElementAPI","VideoPlayerImplementationErrors","VideoPlayerImplementationLoadSequenceManager","VideoPlayerODS","VideoPlayerOzImplementationEngineExtrasAPI","VideoPlayerOzImplementationEnginePartsImplFunction","VideoPlayerOzImplementationEnginePartsImplUtils","VideoPlayerOzImplementationLatencyLevelManager","VideoPlayerOzQuickStarterUtils","emptyFunction","gkx","oz-player/utils/OzError","promiseDone","requireCond","unrecoverableViolation","cr:1494458","cr:1473549","cr:1534629","cr:1494460"],(function(a,b,c,d,e,f){"use strict";f.createVideoPlayerOzImplementationEngine=a;c=!1;var g=b("emptyFunction");function h(a,c){if(a instanceof b("oz-player/utils/OzError")){var d=a,e=d.getExtra();d={createdTimestamp:Date.now(),errorCode:e.code,errorDescription:d.getDescription(),errorLocation:c,errorName:d.getType(),stack:d.stack,url:e.url};return d}else return b("VideoPlayerImplementationErrors").createVideoPlayerErrorFromGenericError("OZ_JAVASCRIPT_NATIVE",a,c)}function a(a){var c=a.debugLogId,d=a.handleFatalError,e=a.initialProps;a=a.setExposedStateInReact;var f={current:null},i={current:null},j={current:null},k={current:null},l={current:null},m={current:null},n={current:null},o={current:null},p={current:null},q={current:null},r={current:null},s={current:null},t={current:null},u={current:null};function v(){var a;return(a=o.current)!=null?a:null}function w(){var a;return(a=n.current)!=null?a:null}function x(){return m.current}function y(){var a;return(a=(a=i.current)==null?void 0:a.experimentationConfig)!=null?a:null}function z(){var a;return(a=X.current)!=null?a:null}function A(){var a;return(a=u.current)!=null?a:null}var B;b("cr:1473549")&&(B=new(b("cr:1473549"))());var C="comet_oz",D=function(a,b){return b.manifestXmlStringInitial!==null?a.manifestXmlStringInitial!==b.manifestXmlStringInitial:a.manifestUrl!==b.manifestUrl},E=function(a,b){return a.videoFBID!==b.videoFBID},F=function(a){return a.getBool("use_full_player_if_cached",!1)&&b("cr:1534629")?b("cr:1534629")().getModuleIfRequireable():null},G=function(a,b,c){b!=null?i.current=babelHelpers["extends"]({},a,{manifestXmlStringResolved:b}):i.current=a,W.dispatch({type:"implementation_engine_oz_manifest_downloading"}),l.current=F(a.experimentationConfig),K(l.current,[].concat(c,["proceedWithOzManifestDownloading"]))},H=function(a){var c;c={VideoPlayerShakaPerformanceLoggerClass:a.VideoPlayerShakaPerformanceLoggerClass,accessToken:a.loggingMetaData.accessToken,experimentationConfig:a.experimentationConfig,graphQLVideoDRMInfo:a.graphQLVideoDRMInfo,graphQLVideoP2PSettings:a.graphQLVideoP2PSettings,manifestUrl:(c=a.manifestUrl)!=null?c:null,manifestXmlStringInitial:(c=a.manifest)!=null?c:null,minQualityPreference:a.minQualityPreference,ozQuickStarterData:a.ozQuickStarterData,videoFBID:a.videoFBID};var d=f.current;u.current==null&&(u.current=new(b("VideoPlayerOzImplementationLatencyLevelManager"))(a.experimentationConfig,W));u.current.updatePlayerFormat((a=a.loggingMetaData.coreVideoPlayerMetaData.playerFormat)!=null?a:null);a=!1;if(d==null)a=!0;else if(d!=null&&!E(c,d)&&D(c,d)){var e=14;b("VideoPlayerODS").bumpEntityKey("OzImplementation","manifest_reloaded",e);a=!1}else if(d!=null&&E(c,d))throw b("unrecoverableViolation")("videoFBID changed after player initialization","comet_video_player");if(!a)return!1;e=c.manifestUrl;d=c.manifestXmlStringInitial;if(d==null&&e==null)throw b("unrecoverableViolation")("Empty manifestXmlStringInitial and manifestUrl","comet_video_player");f.current=c;G(c,d,["handleVideoInfoChangeForOzImplementation","downloadManifestInOz"]);return!0},I=function(a,c,d,e,f){var g=function(b){if(k.current!==a)return;l.current=b;K(b,[].concat(f,["handleOzPlayerModuleLoadSuccess"]))},h=function(b){if(k.current!==a)return;U(b,"oz_player_module_load_failed")};k.current=a;if(m.current==null&&c!=null&&e!=null){c=new c(d,e.experimentationConfig);b("gkx")("1494163")&&(m.current=c);d=e.ozQuickStarterData;if(d!=null){e=[];var i=b("VideoPlayerOzQuickStarterUtils").createPrefetchDataForTrack(e,d.video,"video");if(i){c.addPrefetchTrack(i);i=b("VideoPlayerOzQuickStarterUtils").createPrefetchDataForTrack(e,d.audio,"audio");i&&c.addPrefetchTrack(i)}}c.addListener("streamEnd",function(){W.dispatch({type:"stream_ended"})});b("gkx")("1494163")||(m.current=c)}b("promiseDone")(a,g,h)},J=function(a){a=b("VideoPlayerImplementationEngineVideoElementAPI").createVideoPlayerImplementationEngineVideoElementAPI(a);X.current=a;return a},K=function(a,c){var d=R(),e=i.current;if(d==null||e==null)return;var f=J(d),g=e.experimentationConfig;a?L(a,d,f,e,[].concat(c,["proceedWithResolvedVideoInfo","OzPlayerModuleFromRef"])):b("cr:1494460")?L(b("cr:1494460")(),d,f,e,[].concat(c,["proceedWithResolvedVideoInfo","VideoPlayerOzPlayerModuleLoaderSync"])):b("cr:1534629")?(g.getBool("instantiate_buffering_detector_before_quick_starter",!1)&&b("VideoPlayerOzImplementationEnginePartsImplUtils").createOzBufferingDetector(d,f,e.experimentationConfig,W,o),I(b("cr:1534629")().load(),b("cr:1494458"),d,e,[].concat(c,["proceedWithResolvedVideoInfo","VideoPlayerOzPlayerModuleLoaderAsync"]))):U(new Error("Neither of OzPlayerModuleLoader is available."),"oz_player_module_loaders_missing")},L=function(a,c,d,f,g){try{var h={OzPlayerClass:a,callChain:[].concat(g,["proceedWithResolvedVideoInfoAndOzPlayerModuleSync"]),destroyOzPlayerPartsRef:t,engineDebugAPI:B,engineExtrasAPI:P,getCaptionsInfo:Q,getLatencyLevelManager:A,getOzQuickStarter:x,getVideoLiveTrace:S,handleCaptionsInfoChange:T,handleFatalImplementationError:U,initialProps:e,logger:V,machine:W,ozBufferingDetectorRef:o,playerVersion:C,resolvedVideoInfo:f,videoElement:c,videoElementAPI:d};a=y();g=e.loadSequence;a&&a.getNumber("load_sequence_max_delay_ms",0)>0&&g!=null?s.current=b("VideoPlayerImplementationLoadSequenceManager").schedule(a,g,function(){b("VideoPlayerOzImplementationEnginePartsImplFunction").proceedWithOzPlayerCreation(babelHelpers["extends"]({},h,{hivePluginRef:p,overrideOzRequestImplementationRef:r,ozPlayerRef:n,p2pSessionLoggerRef:q}));return d.getCanPlayPromise()}):b("VideoPlayerOzImplementationEnginePartsImplFunction").proceedWithOzPlayerCreation(babelHelpers["extends"]({},h,{hivePluginRef:p,overrideOzRequestImplementationRef:r,ozPlayerRef:n,p2pSessionLoggerRef:q}));j.current=f}catch(a){U(a,"oz_player_create_exception")}};function M(a){b("gkx")("1494163")&&(j.current=null);var c=t.current;c!=null&&(t.current=null,c(a));s.current!=null&&(s.current(),s.current=null);c=m.current;c&&(m.current=null);b("gkx")("1494163")&&(m.current=null)}function N(){if(b("gkx")("1494163"))f.current=null,i.current=null,j.current=null;else{if(b("gkx")("1431367"))return;f.current=null;i.current=null;j.current=null}}function O(){k.current=null,l.current=null}var P=b("VideoPlayerOzImplementationEngineExtrasAPI").createVideoPlayerOzImplementationEngineExtrasAPI({getConfig:y,getOzPlayer:w,getOzQuickStarter:x,getVideoElementAPI:z});z=b("VideoPlayerImplementationEngineAPI").createVideoPlayerImplementationEngine({createDebugAPI:function(b){var a=b.getVideoElementAPI;b=b.logger;return B?B.createDebugAPI({engineExtrasAPI:P,getConfig:function(){var a;return(a=(a=j.current)==null?void 0:a.experimentationConfig)!=null?a:null},getManifest:function(){var a;return(a=(a=j.current)==null?void 0:a.manifestXmlStringResolved)!=null?a:null},getManifestUrl:function(){var a;return(a=(a=j.current)==null?void 0:a.manifestUrl)!=null?a:null},getOzBufferingDetector:v,getOzPlayer:w,getVideoElementAPI:a,logger:b}):null},createVideoPlayerError:h,debugLog:g,debugLogId:c,destroyEngineParts:function(a){M([].concat(a,["destroyEngineParts"])),N(),O()},engineExtrasAPI:P,engineMetadata:{isAbrEnabled:!0,playerImplementationName:"oz_v2",playerVersion:C,streamingFormat:"dash"},handleFatalError:d,handleVideoElementMounted:function(a){var b=R();K(l.current,[].concat(a,["handleVideoElementMounted"]))},handleVideoElementUnmounted:function(a){(b("gkx")("1494163")||b("gkx")("1380112"))&&M([].concat(a,["handleVideoElementUnmounted"]))},handleVideoInfoChange:H,initialProps:e,setExposedStateInReact:a});c=z.engine;var Q=z.getCaptionsInfo,R=z.getVideoElement,S=z.getVideoLiveTrace,T=z.handleCaptionsInfoChange,U=z.handleFatalImplementationError,V=z.logger,W=z.machine,X=z.videoElementAPIRef;return c}}),null);
__d("VideoPlayerOzImplementationV2.react",["React","VideoPlayerImplementationEngineAPI","VideoPlayerImplementationReactVideoElement.react","VideoPlayerOzImplementationEngine","useSEOLoggedOutWebCrawler"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var c=b("VideoPlayerImplementationEngineAPI").useVideoPlayerImplementationEngine(a,b("VideoPlayerOzImplementationEngine").createVideoPlayerOzImplementationEngine),d=c[0];c=c[1];var e=b("useSEOLoggedOutWebCrawler")(),f={src:null,videoElementCallbacks:c.videoElementCallbacks,videoElementRefCallback:c.videoElementRefCallback};e&&(f={src:a.manifestUrl,videoElementCallbacks:null,videoElementRefCallback:null});return g.jsx(b("VideoPlayerImplementationReactVideoElement.react"),{implementationController:c.implementationController,implementationExposedState:d,renderWithVideoImplementationStates:a.renderWithVideoImplementationStates,src:f.src,videoElementCallbacks:f.videoElementCallbacks,videoElementRefCallback:f.videoElementRefCallback})}}),null);
__d("VideoPlayerOzPlayerModuleLoaderDeferredForDisplay",["requireDeferredForDisplay"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("requireDeferredForDisplay")("oz-player");function a(){return{getModuleIfRequireable:function(){return g.getModuleIfRequireable()||null},load:function(){return g.load()}}}}),null);
__d("manifestHasUnsupportedCodecs",[],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a){if(window.MediaSource!=null||a!=null||typeof a!=="string")return!1;var b=/mimeType=\"([^\"]*)\"\s*codecs=\"([^\"]*)\"/g,c;while(c=b.exec(a)){c=c[1]+'; codecs="'+c[2]+'"';if(!window.MediaSource.isTypeSupported(c))return!0}return!1}}),null);
__d("OzDOMEventListenerImpl",["requireCond","cr:1351686"],(function(a,b,c,d,e,f){"use strict";a={listenDOMEvent:b("cr:1351686").listen,captureDOMEvent:b("cr:1351686").capture,suppressDOMEvent:b("cr:1351686").suppress};c=a;e.exports=c}),null);
__d("VideoPlayerOzWWWConfig",[],(function(a,b,c,d,e,f){"use strict";var g="oz_www_";a=function(){function a(a){this.$1=a}var b=a.prototype;b.getBool=function(a,b){return this.$1.getBool(g+a,b)};b.getNumber=function(a,b){return this.$1.getNumber(g+a,b)};b.getString=function(a,b){return this.$1.getString(g+a,b)};b.setContext=function(a,b){this.$1.setContext(a,b)};b.getAllContexts=function(){return this.$1.getAllContexts()};return a}();e.exports=a}),null);
__d("oz-player/loggings/OzLoggingUtils",[],(function(a,b,c,d,e,f){"use strict";f.executeOperationAndLog=a;f.monitorPromiseAndLogOperation=b;function a(a,b,c){a=a.getOperationLogger(b).start();try{b=c(a);return b}catch(b){a.setError(b);throw b}finally{a.log()}}function b(a,b,c,d,e){d===void 0&&(d=function(){});e===void 0&&(e=function(){});var f=b.getOperationLogger(c).start();d(f);return a.then(function(a){e(f);f.log();return a})["catch"](function(a){e(f);f.setError(a);f.log();throw a})}}),null);
__d("oz-player/loggings/OzOperationLoggerBase",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a}var b=a.prototype;b.start=function(){this.getClientTimeBegin()||this.setClientTimeBegin(Date.now());return this};b.log=function(){this.getClientTimeEnd()||this.setClientTimeEnd(Date.now())};b.setError=function(a){this.$2=a;return this};b.setResult=function(a){this.$3=a;return this};b.setType=function(a){this.$4=a;return this};b.setClientTimeBegin=function(a){this.$5=a;return this};b.setClientTimeEnd=function(a){this.$6=a;return this};b.setSegmentCount=function(a){this.$13=a;return this};b.setTimeToFirstByte=function(a){this.$7=a;return this};b.setTimeToLastByte=function(a){this.$8=a;return this};b.setTimeToRequestStart=function(a){this.$9=a;return this};b.setTimeToRequestSent=function(a){this.$10=a;return this};b.setReason=function(a){this.$11=a;return this};b.setResource=function(a){this.$12=a;return this};b.setSegmentStartTime=function(a){this.$14=a;return this};b.setSegmentEndTime=function(a){this.$15=a;return this};b.setLength=function(a){this.$16=a;return this};b.setLiveheadPosition=function(a){this.$17=a;return this};b.setLiveheadSeqNumHeader=function(a){this.$18=a;return this};b.setLiveheadSeqNumMpd=function(a){this.$19=a;return this};b.setManifestType=function(a){this.$20=a;return this};b.setPriorityFloat=function(a){this.$21=a;return this};b.setAppendedBufferMs=function(a){this.$22=a;return this};b.setInitiator=function(a){this.$23=a;return this};b.setPreloadTime=function(a){this.$24=a;return this};b.setConcluder=function(a){this.$25=a;return this};b.setPreviousRepresentationID=function(a){this.$26=a;return this};b.setRepresentationID=function(a){this.$27=a;return this};b.setStreamSwitchReason=function(a){this.$28=a;return this};b.setState=function(a){this.$29=a;return this};b.setContentLengthHeader=function(a){this.$30=a;return this};b.setOriginHitHeader=function(a){this.$32=a;return this};b.setEdgeHitHeader=function(a){this.$33=a;return this};b.setCode=function(a){this.$31=a;return this};b.setResponseTimeMsHeader=function(a){this.$34=a;return this};b.getError=function(){return this.$2};b.getResult=function(){return this.$3};b.getType=function(){return this.$4};b.getClientTimeBegin=function(){return this.$5};b.getClientTimeEnd=function(){return this.$6};b.getTimeToRequestStart=function(){return this.$9};b.getTimeToRequestSent=function(){return this.$10};b.getReason=function(){return this.$11};b.getResource=function(){return this.$12};b.getOperationName=function(){return this.$1};b.getSegmentStartTime=function(){return this.$14};b.getSegmentEndTime=function(){return this.$15};b.getLength=function(){return this.$16};b.getLiveheadPosition=function(){return this.$17};b.getManifestType=function(){return this.$20};b.getPriorityFloat=function(){return this.$21};b.getAppendedBufferMs=function(){return this.$22};b.getInitiator=function(){return this.$23};b.getPreloadTime=function(){return this.$24};b.getConcluder=function(){return this.$25};b.getContentLengthHeader=function(){return this.$30};b.getOriginHitHeader=function(){return this.$32};b.getEdgeHitHeader=function(){return this.$33};b.getCode=function(){return this.$31};b.getResponseTimeMsHeader=function(){return this.$34};return a}();e.exports=a}),null);
__d("oz-player/loggings/OzMultiDestinationPerfLogger",["oz-player/loggings/OzOperationLoggerBase","oz-player/loggings/OzPerfLoggerProviderBase"],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;c=a.call(this)||this;c.$OzMultiDestinationPerfLoggerProvider1=b;return c}var c=b.prototype;c.createOperationLogger=function(a){var b=new g(a,this.$OzMultiDestinationPerfLoggerProvider1.map(function(b){return b.getOperationLogger(a)}));return b};c.createLoggerProvider=function(){return new b(this.$OzMultiDestinationPerfLoggerProvider1)};return b}(b("oz-player/loggings/OzPerfLoggerProviderBase"));f.OzMultiDestinationPerfLoggerProvider=a;var g=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c){a=b.call(this,a)||this;a.$OzMultiDestinationOperationLogger1=c;return a}var c=a.prototype;c.start=function(){b.prototype.start.call(this);this.$OzMultiDestinationOperationLogger1.forEach(function(a){return a.start()});return this};c.setResult=function(a){b.prototype.setResult.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setResult(a)});return this};c.setError=function(a){b.prototype.setError.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setError(a)});return this};c.setType=function(a){b.prototype.setType.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setType(a)});return this};c.setClientTimeEnd=function(a){b.prototype.setClientTimeEnd.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setClientTimeEnd(a)});return this};c.setClientTimeBegin=function(a){b.prototype.setClientTimeBegin.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setClientTimeBegin(a)});return this};c.setSegmentCount=function(a){b.prototype.setSegmentCount.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setSegmentCount(a)});return this};c.setTimeToFirstByte=function(a){b.prototype.setTimeToFirstByte.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setTimeToFirstByte(a)});return this};c.setTimeToLastByte=function(a){b.prototype.setTimeToLastByte.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setTimeToLastByte(a)});return this};c.setTimeToRequestStart=function(a){b.prototype.setTimeToRequestStart.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setTimeToRequestStart(a)});return this};c.setTimeToRequestSent=function(a){b.prototype.setTimeToRequestSent.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setTimeToRequestSent(a)});return this};c.setReason=function(a){b.prototype.setReason.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setReason(a)});return this};c.setResource=function(a){b.prototype.setResource.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setResource(a)});return this};c.setSegmentStartTime=function(a){b.prototype.setSegmentStartTime.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setSegmentStartTime(a)});return this};c.setSegmentEndTime=function(a){b.prototype.setSegmentEndTime.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setSegmentEndTime(a)});return this};c.setAppendedBufferMs=function(a){b.prototype.setAppendedBufferMs.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setAppendedBufferMs(a)});return this};c.setLength=function(a){b.prototype.setLength.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setLength(a)});return this};c.setLiveheadPosition=function(a){b.prototype.setLiveheadPosition.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setLiveheadPosition(a)});return this};c.setLiveheadSeqNumHeader=function(a){b.prototype.setLiveheadSeqNumHeader.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setLiveheadSeqNumHeader(a)});return this};c.setLiveheadSeqNumMpd=function(a){b.prototype.setLiveheadSeqNumMpd.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setLiveheadSeqNumMpd(a)});return this};c.setManifestType=function(a){b.prototype.setManifestType.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setManifestType(a)});return this};c.setPriorityFloat=function(a){b.prototype.setPriorityFloat.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setPriorityFloat(a)});return this};c.setInitiator=function(a){b.prototype.setInitiator.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setInitiator(a)});return this};c.setPreloadTime=function(a){b.prototype.setPreloadTime.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setPreloadTime(a)});return this};c.setConcluder=function(a){b.prototype.setConcluder.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setConcluder(a)});return this};c.setPreviousRepresentationID=function(a){b.prototype.setPreviousRepresentationID.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setPreviousRepresentationID(a)});return this};c.setRepresentationID=function(a){b.prototype.setRepresentationID.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setRepresentationID(a)});return this};c.setState=function(a){b.prototype.setState.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setState(a)});return this};c.setContentLengthHeader=function(a){b.prototype.setContentLengthHeader.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setContentLengthHeader(a)});return this};c.setEdgeHitHeader=function(a){b.prototype.setEdgeHitHeader.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setEdgeHitHeader(a)});return this};c.setOriginHitHeader=function(a){b.prototype.setOriginHitHeader.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setOriginHitHeader(a)});return this};c.setCode=function(a){b.prototype.setCode.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setCode(a)});return this};c.setResponseTimeMsHeader=function(a){b.prototype.setResponseTimeMsHeader.call(this,a);this.$OzMultiDestinationOperationLogger1.forEach(function(b){return b.setResponseTimeMsHeader(a)});return this};c.log=function(){b.prototype.log.call(this),this.$OzMultiDestinationOperationLogger1.forEach(function(a){return a.log()})};return a}(b("oz-player/loggings/OzOperationLoggerBase"))}),null);
__d("oz-player/loggings/OzPreInitLogger",["oz-player/shims/OzEventEmitter","oz-player/loggings/OzOperationLoggerBase","oz-player/loggings/OzPerfLoggerProviderBase"],(function(a,b,c,d,e,f){"use strict";var g=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c){a=b.call(this,a)||this;a.$OzPreInitOperationLogger1=c;return a}var c=a.prototype;c.log=function(){b.prototype.log.call(this),this.$OzPreInitOperationLogger1(this)};return a}(b("oz-player/loggings/OzOperationLoggerBase"));a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.$OzPreInitLoggerProvider1=!1,d.$OzPreInitLoggerProvider2=[],d.$OzPreInitLoggerProvider3=new(b("oz-player/shims/OzEventEmitter"))(),c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.deactivate=function(){this.$OzPreInitLoggerProvider1=!1};d.activate=function(){var a=this;this.$OzPreInitLoggerProvider1=!0;this.$OzPreInitLoggerProvider2.forEach(function(b){a.$OzPreInitLoggerProvider3.emit("operation_logged",b)});this.$OzPreInitLoggerProvider2=[]};d.setOperationLoggedListener=function(a){return this.$OzPreInitLoggerProvider3.addListener("operation_logged",function(b){a(b)})};d.createOperationLogger=function(a){var b=this;a=new g(a,function(a){b.$OzPreInitLoggerProvider1?b.$OzPreInitLoggerProvider3.emit("operation_logged",a):b.$OzPreInitLoggerProvider2.push(a)});return a};d.createLoggerProvider=function(){return new c()};return c}(b("oz-player/loggings/OzPerfLoggerProviderBase"));f.OzPreInitLoggerProvider=a}),null);
__d("oz-player/media_source/OzMediaErrorProvider",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a}var b=a.prototype;b.hasError=function(){return this.$1.error!==null};b.getMediaErrorName=function(){var a=this.$1.error;return a&&a.message?this.$2(a.message):null};b.getErrorCode=function(){var a=this.$1.error;return a&&a.code?a.code:null};b.getVideoNode=function(){return this.$1};b.$2=function(a){a=a.split(":")[0];return a||""};return a}();e.exports=a}),null);
__d("oz-player/shims/ozClearTimeout",["requireCond","cr:1615802"],(function(a,b,c,d,e,f){"use strict";a=b("cr:1615802");e.exports=a}),null);
__d("oz-player/states/OzObservedSourceBufferState",["oz-player/shims/OzDOMEventListener","oz-player/shims/OzSubscriptionsHandler"],(function(a,b,c,d,e,f){"use strict";var g=b("oz-player/shims/OzDOMEventListener").listenDOMEvent;a=function(){function a(a,c){var d=this;this.$2=new(b("oz-player/shims/OzSubscriptionsHandler"))();this.$3=[];this.$5=function(){if(d.$4.getBool("stable_buffered_timeranges_in_observedsourcebufferstate")){var a=d.$1.buffered,b=[];for(var c=0;c<a.length;c++)b.push({startTime:a.start(c),endTime:a.end(c)});d.$3=b}else{a=[];for(var c=0;c<d.$1.buffered.length;c++)a.push({startTime:d.$1.buffered.start(c),endTime:d.$1.buffered.end(c)});d.$3=a}};this.$1=a;this.$4=c;this.$2.addSubscriptions(g(this.$1,"updateend",this.$5),g(this.$1,"error",this.$5))}var c=a.prototype;c.getBufferedRanges=function(){return this.$3};c.addEventListener=function(a,b){return g(this.$1,"updateend",b)};c.destroy=function(){this.$2.release(),this.$2.engage()};return a}();e.exports=a}),null);
__d("oz-player/utils/OzCustomErrorCode",[],(function(a,b,c,d,e,f){"use strict";a={SOURCE_BUFFER_UNKNOWN_ERROR:"21539",SOURCE_BUFFER_HAS_BEEN_REMOVED:"21540",SOURCE_BUFFER_ERROR_ATTRIBUTE_NOT_NULL:"21541",SOURCE_BUFFER_UPDATING_ATTRIBUTE_IS_TRUE:"21542"};b=a;e.exports=b}),null);
__d("oz-player/utils/OzSourceBufferUtil",[],(function(a,b,c,d,e,f){"use strict";f.getTotalBufferedTime=a;f.getEndBufferedTime=b;function a(a){var b=0;for(var c=0;c<a.buffered.length;c++)b+=a.buffered.end(c)-a.buffered.start(c);return b}function b(a){return a.buffered.length==0?0:a.buffered.end(a.buffered.length-1)}}),null);
__d("oz-player/utils/ozConcatArrayBuffer",[],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a,b){var c=new Uint8Array(a.byteLength+b.byteLength);c.set(new Uint8Array(a),0);c.set(new Uint8Array(b),a.byteLength);return c.buffer}}),null);
__d("oz-player/media_source/SourceBufferManager",["oz-player/loggings/OzLoggingUtils","oz-player/shims/ozClearTimeout","oz-player/shims/OzDeferred","oz-player/shims/OzDOMEventListener","oz-player/shims/OzMaybeNativePromise","oz-player/shims/OzReadableStream","oz-player/shims/ozSetTimeoutAcrossTransitions","oz-player/shims/OzSubscriptionsHandler","oz-player/states/OzObservedSourceBufferState","oz-player/utils/OzCustomErrorCode","oz-player/utils/ozConcatArrayBuffer","oz-player/utils/OzError","oz-player/utils/OzNumericalRangeUtil","oz-player/utils/OzSourceBufferUtil"],(function(a,b,c,d,e,f){"use strict";var g=b("oz-player/shims/OzDOMEventListener").listenDOMEvent,h=b("oz-player/shims/ozSetTimeoutAcrossTransitions");a=function(){function a(a,c,d,e){var f=this;this.$2=null;this.$3=new(b("oz-player/shims/OzSubscriptionsHandler"))();this.$6=!1;this.$7=[];this.$12=!1;this.$13=!1;this.$24=function(){if(f.$9.hasError()){f.$13=!1;f.$12=!1;var a=f.$9.getMediaErrorName();a=a!==null&&a!==void 0?a:"An unknown source buffer error occurred.";var c=f.$9.getErrorCode();c=c!==null&&c!==void 0?c:b("oz-player/utils/OzCustomErrorCode").SOURCE_BUFFER_UNKNOWN_ERROR;a=new(b("oz-player/utils/OzError"))({type:"OZ_SOURCE_BUFFER",description:a,extra:{code:c.toString()}});f.$2&&f.$2.reject(a);f.$2=null;f.cancelOperationAndCleanQueue()}else f.$13||(f.$13=!0,f.$3.addSubscriptions(g(f.$9.getVideoNode(),"error",f.$24)))};this.$15=function(){var a=f.$2;a&&(f.$12?f.$24():(a.resolve(),f.$2&&(f.$2=null)))};this.$16=function(){f.$10.getBool("fix_source_buffer_error_logging")?f.$12=!0:f.$25()};this.$1=a;this.$10=c;this.$3.addSubscriptions(g(this.$1,"updateend",this.$15),g(this.$1,"error",this.$16));this.$8=new(b("oz-player/states/OzObservedSourceBufferState"))(this.$1,this.$10);this.$9=d;this.$14=e}var c=a.prototype;c.queueData=function(a,c,d,e){c===void 0&&(c=null);d===void 0&&(d=0);e===void 0&&(e=null);var f=new(b("oz-player/shims/OzDeferred"))(b("oz-player/shims/OzMaybeNativePromise"));this.$7.push({data:a,deferred:f,loggerProvider:c,appendTarget:d,onDataAppend:e});a=f.getPromise();this.$6||(this.$10.getBool("queue_data_with_error_handling")?this.$17():this.$18());return a};c.cancelOperationAndCleanQueue=function(){var a=this.$19();this.$7.forEach(function(b){b=b.deferred;b.reject(a)});this.$7=[];this.$10.getBool("sbm_check_source_buffer_ready_state_on_cancel")?this.$1&&this.$14()&&this.$1.abort():this.$1.abort();var c=b("oz-player/shims/OzMaybeNativePromise").resolve(),d=this.$2;d&&(d.reject(a),c=d.getPromise()["catch"](function(){}));this.$4&&(this.$4.reject(a),this.$4=null);return c};c.getSourceBufferState=function(){return this.$8};c.clearRange=function(a,b){this.$1.remove(a,b)};c.$20=function(a){var c=this.$2=new(b("oz-player/shims/OzDeferred"))(b("oz-player/shims/OzMaybeNativePromise"));c=c.getPromise();a&&b("oz-player/loggings/OzLoggingUtils").monitorPromiseAndLogOperation(c,a,"wait_for_source_buffer");return c};c.$21=function(a,c,d){var e=this;if(this.$2!==null)return b("oz-player/shims/OzMaybeNativePromise").reject(this.$22("cannot have concurrent appends"));var f=function f(){if(e.$10.getBool("sbm_recursively_waits_for_update_end")&&e.$1.updating)return e.$20(c).then(f)["catch"](function(a){if(e.$10.getBool("enable_appends_on_wait_update_end_failure"))return f();throw a});var g=e.$2=new(b("oz-player/shims/OzDeferred"))(b("oz-player/shims/OzMaybeNativePromise")),h=!1;try{h=e.$1.updating,e.$1.appendBuffer(a)}catch(a){var i=b("oz-player/utils/OzCustomErrorCode").SOURCE_BUFFER_HAS_BEEN_REMOVED;e.$9.hasError()?i=b("oz-player/utils/OzCustomErrorCode").SOURCE_BUFFER_ERROR_ATTRIBUTE_NOT_NULL:h&&(i=b("oz-player/utils/OzCustomErrorCode").SOURCE_BUFFER_UPDATING_ATTRIBUTE_IS_TRUE);h=new(b("oz-player/utils/OzError"))({type:"OZ_SOURCE_BUFFER",description:a.message,extra:{originalError:a,code:i.toString()}});e.$2=null;g.reject(h)}i=g.getPromise();c&&b("oz-player/loggings/OzLoggingUtils").monitorPromiseAndLogOperation(i,c,"append",function(b){b.setLength(a.byteLength)});var j=e.$10.getBool("log_appended_secs")?b("oz-player/utils/OzSourceBufferUtil").getTotalBufferedTime(e.$1):0;return i.then(function(){d&&d();return e.$10.getBool("log_appended_secs")?b("oz-player/utils/OzSourceBufferUtil").getTotalBufferedTime(e.$1)-j:0})};if(!this.$10.getBool("sbm_waits_for_update_end"))return f();return!this.$10.getBool("sbm_recursively_waits_for_update_end")&&this.$1.updating?this.$20(c).then(f)["catch"](function(a){if(e.$10.getBool("enable_appends_on_wait_update_end_failure"))return f();throw a}):f()};c.$18=function(){var a=this;if(this.$6)return b("oz-player/shims/OzMaybeNativePromise").reject(this.$22("Another unit of queued data is being appended."));var c=this.$7.shift();if(!c){this.$6=!1;return b("oz-player/shims/OzMaybeNativePromise").resolve()}var d=c.data,e=c.deferred,f=c.loggerProvider,g=c.appendTarget;c=c.onDataAppend;this.$6=!0;g=d instanceof b("oz-player/shims/OzReadableStream")?this.$23(d,f,g,c):this.$21(d,f,c);var h=NaN,i;this.$10.getBool("generate_mos_segment_buffer_diff")?i=new(b("oz-player/utils/OzNumericalRangeUtil"))().convertFromTimeRanges(this.$8.getBufferedRanges()):h=b("oz-player/utils/OzSourceBufferUtil").getEndBufferedTime(this.$1);return g["catch"](function(a){e.reject(a);return 0}).then(function(c){if(a.$10.getBool("generate_mos_segment_buffer_diff")){c=new(b("oz-player/utils/OzNumericalRangeUtil"))().firstAddedInSortedRanges(i,new(b("oz-player/utils/OzNumericalRangeUtil"))().convertFromTimeRanges(a.$8.getBufferedRanges()));h=(c==null?void 0:c.rangeStart)||0;c=(c==null?void 0:c.rangeEnd)||0}else c=b("oz-player/utils/OzSourceBufferUtil").getEndBufferedTime(a.$1);e.resolve({startTime_UNSAFE:h,endTime_UNSAFE:c,appendedSec:c-h});a.$6=!1;a.$18()})};c.$17=function(){var a=this;try{if(this.$6)throw this.$22("Another unit of queued data is being appended.");var c=this.$7.shift();if(!c){this.$6=!1;return}var d=c.data,e=c.deferred,f=c.loggerProvider;c=c.appendTarget;this.$6=!0;c=d instanceof b("oz-player/shims/OzReadableStream")?this.$23(d,f,c):this.$21(d,f);var g=b("oz-player/utils/OzSourceBufferUtil").getEndBufferedTime(this.$1);c.then(function(c){c=b("oz-player/utils/OzSourceBufferUtil").getEndBufferedTime(a.$1);e.resolve({startTime_UNSAFE:g,endTime_UNSAFE:c,appendedSec:c-g})},function(a){e.reject(a)})["finally"](function(){a.$6=!1,a.$17()})}catch(a){new(b("oz-player/utils/OzError"))({type:"OZ_JAVASCRIPT_NATIVE",description:a.message,extra:{originalError:a,code:"0"}})}};c.$23=function(a,c,d,e){var f=this,g=new ArrayBuffer(0),i=a.getReader();a=function a(){var j=new(b("oz-player/shims/OzDeferred"))(b("oz-player/shims/OzMaybeNativePromise"));f.$4=j;var k=null;f.$10.getNumber("sbm_read_timeout_ms")>0&&(k=h(function(){var a=new(b("oz-player/utils/OzError"))({type:"OZ_SOURCE_BUFFER",description:"ReadableStreamReader.read() timed out.",extra:{}});j.reject(a);f.$4=null;f.$5=k=null},f.$10.getNumber("sbm_read_timeout_ms")));i.read().then(function(a){j.resolve(a),f.$4=null,k&&(b("oz-player/shims/ozClearTimeout")(k),f.$5=k=null)})["catch"](function(a){j.reject(a),f.$4=null,k&&(b("oz-player/shims/ozClearTimeout")(k),f.$5=k=null)});return j.getPromise().then(function(h){var i=h.done;h=h.value;if(i)return g.byteLength>0?f.$21(g,c,e):b("oz-player/shims/OzMaybeNativePromise").resolve(0);i=h;d>0&&(h instanceof Uint8Array&&(h=h.buffer),g=b("oz-player/utils/ozConcatArrayBuffer")(g,h),i=g);if(i&&i.byteLength>=d){g=new ArrayBuffer(0);return f.$21(i,c,e).then(function(b){return a().then(function(a){return a+b})})}return a()},function(a){f.$10.getBool("sbm_abort_on_readable_stream_error")&&f.$1.abort();return b("oz-player/shims/OzMaybeNativePromise").reject(a)})};return a()};c.$25=function(){var a=this,c=this.$2;c&&(b("oz-player/shims/ozClearTimeout")(this.$11),this.$11=h(function(){a.$11=null;var d=a.$9.getErrorCode(),e=a.$9.getMediaErrorName(),f={};f.code=d!==null&&d!==void 0?d.toString():e!=null?e:"OZ_SB-1";d=new(b("oz-player/utils/OzError"))({type:"OZ_SOURCE_BUFFER",description:e!==null&&e!==void 0?e:"Unknown SourceBuffer Append Error",extra:f});c.reject(d);a.$2=null},0))};c.$22=function(a){a=new Error(a);a.name="invariant_violation";return a};c.$19=function(){var a=new Error("operation is cancelled");a.name="cancelled";return a};c.destroy=function(){var a=this;this.$5&&b("oz-player/shims/ozClearTimeout")(this.$5);this.$5=null;b("oz-player/shims/ozClearTimeout")(this.$11);this.$11=null;var c=this.$2;c&&(!this.$13?(c.reject(this.$19()),this.$2=null,this.$3.release(),this.$3=new(b("oz-player/shims/OzSubscriptionsHandler"))()):c.getPromise()["catch"](function(){a.$2=null,a.$3.release(),a.$3=new(b("oz-player/shims/OzSubscriptionsHandler"))()}));this.$8.destroy()};c.getDebug=function(){return{SourceBuffer:this.$1}};return a}();e.exports=a}),null);
__d("oz-player/media_source/MediaSourceManager",["oz-player/loggings/OzLoggingUtils","oz-player/loggings/OzMultiDestinationPerfLogger","oz-player/shims/OzDeferred","oz-player/shims/OzDOMEventListener","oz-player/shims/OzMaybeNativePromise","oz-player/shims/OzSubscriptionsHandler","oz-player/media_source/OzMediaErrorProvider","oz-player/media_source/SourceBufferManager"],(function(a,b,c,d,e,f){"use strict";var g=b("oz-player/shims/OzDOMEventListener").listenDOMEvent;a=function(){function a(a,c,d){var e=this;d===void 0&&(d=new(b("oz-player/loggings/OzMultiDestinationPerfLogger").OzMultiDestinationPerfLoggerProvider)([]));this.$3=new(b("oz-player/shims/OzSubscriptionsHandler"))();this.$5=[];this.$6=[];this.$8=!1;this.$10=!1;this.$12=function(){e.$13()||(e.$8=!1);if(!e.$14())return;var a=e.$6.shift();a&&(a(e.$2),e.$8=!0)};this.$4=d;this.$9=c;this.$1=a;this.$2=new MediaSource();this.$1.src=window.URL.createObjectURL(this.$2);this.$7=new(b("oz-player/media_source/OzMediaErrorProvider"))(this.$1);b("oz-player/loggings/OzLoggingUtils").monitorPromiseAndLogOperation(this.$11(),this.$4,"media_source_open")}var c=a.prototype;c.$11=function(){var a=this;if(this.$2.readyState==="open")return b("oz-player/shims/OzMaybeNativePromise").resolve();var c=new(b("oz-player/shims/OzDeferred"))(b("oz-player/shims/OzMaybeNativePromise"));this.$3.addSubscriptions(g(this.$2,"sourceopen",function(){c.resolve(),a.$12()}));return c.getPromise()};c.createSourceBufferManager=function(a,c){var d=this;c===void 0&&(c=!1);return this.$11().then(function(){var e=d.$2.addSourceBuffer(a);c&&!isNaN(d.$2.duration)&&(e.appendWindowEnd=d.$2.duration);d.$5.push(e);d.$3.addSubscriptions(g(e,"updateend",d.$12));return new(b("oz-player/media_source/SourceBufferManager"))(e,d.$9,d.$7,function(){var a=d.$2;if(a){a=d.$9.getBool("media_source_is_available_in_ended_state")?a.readyState!=="closed":a.readyState==="open";return a}return!1})})};c.getMediaSource=function(){return this.$2};c.notifyEndOfStream=function(){var a=this,c=new(b("oz-player/shims/OzDeferred"))(b("oz-player/shims/OzMaybeNativePromise"));this.$3.addSubscriptions(g(this.$2,"sourceended",function(){c.resolve()}));this.$6.push(function(b){a.$4.getOperationLogger("end_of_stream").log(),b.endOfStream()});this.$12();return c.getPromise()};c.updateDuration=function(a){this.$6.push(function(b){b.duration=a}),this.$12()};c.detach=function(){this.$1.removeAttribute("src");for(var a=0;a<this.$2.sourceBuffers.length;a++){var b=this.$2.sourceBuffers[a];this.$2.removeSourceBuffer(b)}this.$3.release();this.$3.engage();this.$6=[];this.$8=!1;this.$10=!0};c.$14=function(){return!this.$13()&&this.$2.readyState==="open"&&!this.$8&&!this.$10};c.$13=function(){return this.$5.some(function(a){return a.updating})};return a}();e.exports=a}),null);
__d("oz-player/utils/OzErrorEmitter",["oz-player/shims/OzEventEmitter","oz-player/shims/ozvariant"],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(c,a);function c(c){var d;c===void 0&&(c=!1);d=a.call(this)||this;d.$OzErrorEmitter1=!1;d.$OzErrorEmitter2=!1;d.$OzErrorEmitter3=[];d.emitError=function(a){!d.$OzErrorEmitter1?d.$OzErrorEmitter2?d.$OzErrorEmitter3.push(a):d.$OzErrorEmitter1||b("oz-player/shims/ozvariant")(0,14038):d.emit("error",a)};d.$OzErrorEmitter2=c;return d}var d=c.prototype;d.onError=function(a){this.$OzErrorEmitter1=!0;a=this.addListener("error",a);this.$OzErrorEmitter2&&this.$OzErrorEmitter3.length>0&&this.$OzErrorEmitter3.forEach(this.emitError);return a};return c}(b("oz-player/shims/OzEventEmitter"));e.exports=a}),null);
__d("oz-player/utils/maybeConvertReadableStreamToOzReadableStream",["regeneratorRuntime","oz-player/shims/OzReadableStream"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a){if(!b("oz-player/shims/OzReadableStream").isPolyfilled)return a;var c=a.getReader();return new(b("oz-player/shims/OzReadableStream"))({start:function(a){var d,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:g.next=3;return b("regeneratorRuntime").awrap(c.read());case 3:d=g.sent;e=d.done;f=d.value;if(!e){g.next=8;break}return g.abrupt("break",11);case 8:a.enqueue(f);g.next=0;break;case 11:a.close();case 12:case"end":return g.stop()}},null,this)}})}}),null);
__d("oz-player/utils/convertPrefetchCacheEntryToReadableStream",["oz-player/shims/OzReadableStream","oz-player/utils/maybeConvertReadableStreamToOzReadableStream","oz-player/utils/OzError"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a){var c=new(b("oz-player/shims/OzReadableStream"))({start:function(c){a.then(function(a){switch(a.initiator){case"XHR_REQUEST":var d=new Uint8Array(a.response);c.enqueue(d);c.close();break;case"FETCH":d=a.response.body;if(d!=null){var e=function a(){f.read().then(function(b){var d=b.done;b=b.value;if(d){c.close();return}c.enqueue(b);a()})["catch"](function(a){c.err(a)})},f=b("oz-player/utils/maybeConvertReadableStreamToOzReadableStream")(d).getReader();e()}else a.response.arrayBuffer().then(function(a){a=new Uint8Array(a);c.enqueue(a);c.close()})["catch"](function(a){c.err(a)});break;default:a.initiator,c.error(new(b("oz-player/utils/OzError"))({type:"OZ_UNEXPECTED_CACHE_INITIATOR",description:"Unable to handle request initiator: "+a.initiator}))}})["catch"](function(a){c.error(a)})}});return c}}),null);
__d("oz-player/media_source/OzQuickStarter",["oz-player/configs/OzConfigUtils","oz-player/loggings/OzLoggingUtils","oz-player/loggings/OzPreInitLogger","oz-player/shims/OzEventEmitter","oz-player/shims/ozvariant","oz-player/utils/convertPrefetchCacheEntryToReadableStream","oz-player/utils/OzError","oz-player/utils/OzErrorEmitter","oz-player/media_source/MediaSourceManager"],(function(a,b,c,d,e,f){"use strict";var g=.1;a=function(a){babelHelpers.inheritsLoose(c,a);function c(c,d,e){var f;e===void 0&&(e=[]);f=a.call(this)||this;f.$OzQuickStarter5=new Map();f.$OzQuickStarter6=[];f.$OzQuickStarter8=new Map();f.$OzQuickStarter9=new Map();f.$OzQuickStarter10=new(b("oz-player/utils/OzErrorEmitter"))(!0);f.$OzQuickStarter13=function(a){a instanceof b("oz-player/utils/OzError")||(a=new(b("oz-player/utils/OzError"))({type:"OZ_QUICKSTARTER",description:a.message,extra:{originalError:a}})),f.$OzQuickStarter10.emitError(a)};f.$OzQuickStarter3=c;f.$OzQuickStarter1=b("oz-player/configs/OzConfigUtils").provideConfigWithDefaults(d);f.$OzQuickStarter7=new(b("oz-player/loggings/OzPreInitLogger").OzPreInitLoggerProvider)();f.$OzQuickStarter7.setInitiator("quick_starter");f.$OzQuickStarter6.push(f.$OzQuickStarter7);f.$OzQuickStarter2=new(b("oz-player/media_source/MediaSourceManager"))(f.$OzQuickStarter3,f.$OzQuickStarter1,f.$OzQuickStarter7);f.$OzQuickStarter4=new Map();e.forEach(function(a){return f.addPrefetchTrack(a)});return f}var d=c.prototype;d.addPrefetchTrack=function(a){var c=this,d=a.mimeCodec,e=this.$OzQuickStarter11(d);if(!e)return;var f=this.$OzQuickStarter11(d),g=this.$OzQuickStarter12(this.$OzQuickStarter7).setType(f),h=this.$OzQuickStarter12(this.$OzQuickStarter7).setType(f+";init");this.$OzQuickStarter5.set(e,a.segmentPromise?1:0);f=this.$OzQuickStarter2.createSourceBufferManager(d).then(function(d){var f=b("oz-player/utils/convertPrefetchCacheEntryToReadableStream")(a.initializationPromise);b("oz-player/loggings/OzLoggingUtils").monitorPromiseAndLogOperation(a.initializationPromise,h,"fetch_stream");d.queueData(f,h)["catch"](c.$OzQuickStarter13);f=a.segmentPromise;if(f){var i=b("oz-player/utils/convertPrefetchCacheEntryToReadableStream")(f);b("oz-player/loggings/OzLoggingUtils").monitorPromiseAndLogOperation(f,g,"fetch_stream");d.queueData(i,g).then(function(a){c.$OzQuickStarter8.set(e,a.appendedSec),c.$OzQuickStarter1.getBool("call_end_of_stream_in_quick_starter")&&c.$OzQuickStarter8.size===c.$OzQuickStarter4.size&&c.$OzQuickStarter14()&&(c.$OzQuickStarter2.notifyEndOfStream(),c.emit("streamEnd")),c.$OzQuickStarter1.getBool("seek_to_start_quick_starter")&&c.$OzQuickStarter8.size===c.$OzQuickStarter4.size&&c.$OzQuickStarter15()})["catch"](c.$OzQuickStarter13)}return d});this.$OzQuickStarter4.set(e,f);a.representationID&&this.$OzQuickStarter9.set(e,a.representationID)};d.onError=function(a){return this.$OzQuickStarter10.onError(a)};d.$OzQuickStarter15=function(){var a=this.$OzQuickStarter3.buffered.length>0?this.$OzQuickStarter3.buffered.start(0):null;a!==null&&this.$OzQuickStarter3.currentTime<a&&(this.$OzQuickStarter3.currentTime=a+g)};d.$OzQuickStarter14=function(){var a=this;if(Number.isNaN(this.$OzQuickStarter3.duration))return!1;var b=!0;this.$OzQuickStarter8.forEach(function(c){Math.abs(c-a.$OzQuickStarter3.duration)>g&&(b=!1)});return b};d.getSourceBufferManagerPromise=function(a){a=this.$OzQuickStarter11(a);return this.$OzQuickStarter4.get(a)};d.getPrependedSegmentsCount=function(a){var b=this.$OzQuickStarter11(a);if(!b)return 0;b=this.$OzQuickStarter5.get(b)||0;return this.getSourceBufferManagerPromise(a)?b:0};d.getRepresentationId=function(a){a=this.$OzQuickStarter11(a);return!a?null:this.$OzQuickStarter9.get(a)||null};d.getAudioRepresentationIDAtTime=function(a){return this.$OzQuickStarter16("audio",a)};d.getVideoRepresentationIDAtTime=function(a){return this.$OzQuickStarter16("video",a)};d.getVideoNode=function(){return this.$OzQuickStarter3};d.getMediaSourceManager=function(){return this.$OzQuickStarter2};d.getObservedOperationLoggers=function(){return this.$OzQuickStarter6};d.$OzQuickStarter16=function(a,b){var c=this.$OzQuickStarter8.get(a);return c!=null&&b<=c?this.$OzQuickStarter9.get(a):null};d.$OzQuickStarter12=function(a){a=a.cloneContext();a instanceof b("oz-player/loggings/OzPreInitLogger").OzPreInitLoggerProvider||b("oz-player/shims/ozvariant")(0,5677);this.$OzQuickStarter6.push(a);return a};d.$OzQuickStarter11=function(a){return(a.split("/")[0]||"").trim()};return c}(b("oz-player/shims/OzEventEmitter"));e.exports=a}),null);
__d("oz-player/shims/www/OzDOMEventListenerWWW",["OzDOMEventListenerImpl"],(function(a,b,c,d,e,f){"use strict";a=b("OzDOMEventListenerImpl");e.exports=a}),null);
__d("oz-player/shims/www/OzSubscriptionsHandlerWWW",["SubscriptionsHandler"],(function(a,b,c,d,e,f){"use strict";a=b("SubscriptionsHandler");e.exports=a}),null);
__d("oz-player/shims/www/OzURIWWW",["URI"],(function(a,b,c,d,e,f){"use strict";var g;a=function(){function a(a){this.$1=new(g||(g=b("URI")))(a)}var c=a.prototype;c.addQueryData=function(a,b){this.$1.addQueryData(a,b);return this};c.getQueryData=function(){return this.$1.getQueryData()};c.getDomain=function(){return this.$1.getDomain()};c.toString=function(){return this.$1.toString()};c.getPath=function(){return this.$1.getPath()};return a}();e.exports=a}),null);
__d("oz-player/shims/www/ozClearTimeoutWWW",["clearTimeout"],(function(a,b,c,d,e,f){"use strict";a=b("clearTimeout");e.exports=a}),null);
__d("oz-player/shims/www/ozThrottleWWW",["throttle"],(function(a,b,c,d,e,f){"use strict";a=b("throttle");e.exports=a}),null);
__d("oz-player/shims/www/ozvariantWWW",["invariant"],(function(a,b,c,d,e,f,g){a=g;e.exports=a}),null);
__d("MWChatComposerP2PPaymentEligibilityQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"fbids"}],b=[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"PeerToPeerPaymentAccount",kind:"LinkedField",name:"peer_to_peer_payments",plural:!1,selections:[{alias:null,args:[{kind:"Variable",name:"fbids",variableName:"fbids"}],concreteType:"PeerToPeerPaymentUserEligibility",kind:"LinkedField",name:"can_send_to",plural:!0,selections:[{alias:null,args:null,concreteType:"P2PPaymentUserFacingError",kind:"LinkedField",name:"exception",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fbid",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_eligible",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"MWChatComposerP2PPaymentEligibilityQuery",selections:b,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"MWChatComposerP2PPaymentEligibilityQuery",selections:b},params:{id:"2858925340888348",metadata:{},name:"MWChatComposerP2PPaymentEligibilityQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("MWChatComposerP2PPopoverQuery$Parameters",[],(function(a,b,c,d,e,f){"use strict";a={kind:"PreloadableConcreteRequest",params:{id:"4432371670167677",metadata:{},name:"MWChatComposerP2PPopoverQuery",operationKind:"query",text:null}};e.exports=a}),null);
__d("composerAudioClipReducer",[],(function(a,b,c,d,e,f){"use strict";e.exports=a;function g(a,b){return babelHelpers["extends"]({},a,{audioClip:b.audioClip})}function h(a,b){return babelHelpers["extends"]({},a,{audioClip:void 0})}function a(a,b){switch(b.type){case"SET_AUDIO_CLIP":return g(a,b);case"REMOVE_AUDIO_CLIP":return h(a,b)}return a}}),null);
__d("useControlledComposerViewStateDispatcher",["React","ReactDOMComet","useComposerViewStateDispatcher"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React"),h=b("ReactDOMComet").unstable_flushControlled;function a(){var a=b("useComposerViewStateDispatcher")();return g.useCallback(function(b){h!=null?h(function(){return a(b)}):a(b)},[a])}}),null);
__d("MWChatUploadAudioHook.bs",["URI","bs_curry","React","ActorURI","bs_caml_array","bs_caml_option","CurrentUser","MercuryConfig","XComposerPhotoUploader"],(function(a,b,c,d,e,f){"use strict";var g,h=b("React");function a(a){var c=b("CurrentUser").getID();return h.useCallback(function(a){return function(d){var e={data:{voice_clip:!0}};new(b("XComposerPhotoUploader"))({concurrentLimit:3,onUploadFailure:function(a,b){return!0},onUploadProgress:function(a,b){},onUploadStart:function(a){},onUploadSuccess:function(a,c){a=b("bs_caml_array").get(c.response.payload.metadata,0);c=b("bs_caml_option").some(a.audio_id);return b("bs_curry")._1(d,b("bs_caml_option").valFromOption(c))},retryLimit:1,uploadEndpoint:new(b("ActorURI").create)(new(g||(g=b("URI")))(b("MercuryConfig").upload_url),c)}).getAsyncUploadRequest([a],b("bs_caml_option").some(e)).send()}},[c])}f.useHook=a}),null);
__d("CometInteractionTracingQuickLogModule",[],(function(a,b,c,d,e,f){a=Object.freeze({APP_COLLECTIONS_TAIL_LOAD:30605376,APP_SECTIONS_FEED_TAILLOAD:30605366,BLUE_ON_COMET_MODAL:30605363,BOOKMARK_ITEM:30613596,CHANNEL_TAB_ALL_VIDEOS_CARD_FETCH_MORE:30605391,CHANNEL_TAB_LATEST_VIDEOS_CARD_HSCROLL_LOAD_MORE:30605392,CHANNEL_TAB_PLAYLISTS_CARD_FETCH_MORE:30605390,CHANNEL_TAB_SERIES_CARD_FETCH_MORE:30605389,CHAT_TAB_OPEN:30605380,CHAT_TAB_SEND_MESSAGE:30605384,COLLECTIONS_TAILLOAD:30605367,COMMUNITY_VIEW_DIALOG_OPEN:30614747,COMPOSER_SUBMIT_PROCESSING:30605375,DIALOG_SHOW:30605362,EDIT_SHORTCUTS:30608244,EVENT_RSVP_WWW:30605345,FEED_COMPOSER_DIALOG_OPEN:30605316,FEED_PREFERENCES_DIALOG_OPEN:30605385,GROUP_COMPOSER_DIALOG_OPEN:30605340,GROUP_MALL_FEED_TAILLOAD:30605332,HOMEPAGE_BADGED_NAVIGATION:30632331,HOME_FEED_TAILLOAD:30605313,LWI_SECTION_OPTION_CHANGE:30605381,MARKETPLACE_BUY_LOCATION_DIALOG_OPEN:30605342,MARKETPLACE_COMPOSER_CREATE:30605344,MARKETPLACE_DEALS_FEED_PAGINATION:30605371,MARKETPLACE_ECOMM_PRODUCT_FEED_PAGINATION:30605373,MARKETPLACE_FEED_SAVED_PAGINATION:30605347,MARKETPLACE_HOME_FEED_PAGINATION:30605341,MARKETPLACE_SEARCH_FEED_PAGINATION:30605343,NOTIFICATION_PAGINATION:30605314,PAGE_ABOUT_FACEPILES_SEE_ALL_DIALOG_LOAD:30605358,PAGE_ABOUT_OPEN_MAP_VIEW:30605325,PAGE_ADMIN_SELECT_MANAGED_PAGE:30605324,PAGE_COMMUNITY_FACEPILES_SEE_ALL_DIALOG_LOAD:30605356,PAGE_COMMUNITY_TOP_FANS_CARD_SEE_ALL_DIALOG_LOAD:30605355,PAGE_COMPOSER_DIALOG_OPEN:30605333,PAGE_HOME_CARD_SEE_ALL_DIALOG_LOAD:30605330,PAGE_LIKE:30605317,PAGE_OPEN_VIDEO:30605318,PAGE_PHOTO_TAB_FETCH_MORE:30605331,PAGE_POST_OPEN_DETAILS:30605327,PAGE_REVIEWS_COMPOSER_TRIGGER:30605369,PAGE_REVIEWS_FEED_SORT:30605368,PAGE_REVIEWS_RECOMMENDATION_POST:30605370,PAGE_VIDEO_TAB_FETCH_MORE:30605319,POPOVER_SHOW:30605361,PRIVACY_SELECTOR_DIALOG_LOAD:30605326,PRIVACY_SELECTOR_SAVED_CUSTOM_PAGINATION:30605365,PROFILE_COMPOSER_DIALOG_OPEN:30605360,PROFILE_MENTIONS_FEED_TAILLOAD:30616610,PROFILE_PICTURE_MENU_OPEN:30615365,PROFILE_PIC_EDIT_DIALOG_LOAD_MORE:30605386,PROFILE_PIC_EDIT_DIALOG_OPEN:30605387,PROFILE_PIC_OPEN:30605364,PROFILE_TILES_TAILLOAD:30605378,PYMK_FEED_PAGINATION:30618398,SEARCH_TYPEAHEAD:30620813,SEE_MORE_FEED_UNIT:30615438,STORY_VIEWER_NAV_LIST_LOAD_PAGINATION:30605322,TAHOE_COMMENT_CREATE:30621572,TARGETING_DIALOG_OPEN:30605379,TA_TTRC_COMET:30605354,TIMELINE_FEED_TAILLOAD:30605315,UFI_LOAD_MORE_COMMENTS:30605393,UFI_REACTIONS_DIALOG_OPEN:30605374,VIDEO_HOME_CATALOG_ALL_SHOWS_PAGINATION:30605336,VIDEO_HOME_CATALOG_MORE_FACEBOOK_ORIGINALS_PAGINATION:30605382,VIDEO_HOME_CATALOG_NAV:30605349,VIDEO_HOME_CHANNEL_PAGINATION:30605372,VIDEO_HOME_CONTEXT_MENU_TRIGGER:30605353,VIDEO_HOME_FEED_NAV:30605352,VIDEO_HOME_FEED_PAGINATION:30605334,VIDEO_HOME_LATEST_NAV:30605351,VIDEO_HOME_LATEST_PAGINATION:30605335,VIDEO_HOME_PLAYLIST_VIDEO_LIST_PAGINATION:30605337,VIDEO_HOME_SAVED_NAV:30605350,VIDEO_HOME_SAVED_PAGINATION:30605339,VIDEO_HOME_SETTINGS_TOGGLE:30605346,VIDEO_HOME_SPORTS_HIGHLIGHTS_PAGINATION:30605359,VIDEO_HOME_WATCHLIST_PAGE_NAV:30605348,VIDEO_HOME_WATCHLIST_PAGINATION:30605338});e.exports=a}),null);
__d("MWChatComposerCreatePollButton.bs",["bs_curry","React","JSResource","stylex","CometLazyPopoverTrigger.react"],(function(a,b,c,d,e,f){"use strict";var g,h=b("React"),i={flyoutRoot:{width:"geg40m2u"}};function a(a){var c=a.button,d=a.onPollCreate,e=a.logOnOpenPollFlyout;return h.jsx(b("CometLazyPopoverTrigger.react"),{onVisibilityChange:function(a){if(a)return b("bs_curry")._1(e,void 0)},popoverResource:b("JSResource")("MWChatPollFlyoutForJSResource.react").__setRef("MWChatComposerCreatePollButton.bs"),disablePositionAutoflip:!0,popoverProps:{className:(g||(g=b("stylex")))(i.flyoutRoot),onPollCreate:d},align:"end",position:"above",children:c})}c=a;f.styles=i;f.make=c}),null);
__d("MWChatComposerCreateRoomButton.react",["CometLazyPopoverTrigger.react","JSResourceForInteraction","React"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React"),h=b("JSResourceForInteraction")("CometRoomCardContainer.react").__setRef("MWChatComposerCreateRoomButton.react");function a(a){var c=a.button,d=a.sessionId;a=a.surface;return g.jsx(b("CometLazyPopoverTrigger.react"),{align:"end",disablePositionAutoflip:!0,popoverProps:{sessionId:d,surface:a},popoverResource:h,position:"above",children:c},"room")}}),null);
__d("MWChatComposerP2PButton.bs",["fbt","React","MWChatComposerIcons.bs","MWChatComposerActionTrayButton.bs"],(function(a,b,c,d,e,f,g){"use strict";var h=b("React");a=g._("Enviar o solicitar dinero");c=h.forwardRef(function(a,c){var d=a.onPress,e=a.disabled;a=a.label;d=d!==void 0?d:function(a){};return h.jsx(b("MWChatComposerActionTrayButton.bs").make,{disabled:e,icon:b("MWChatComposerIcons.bs").Currency.make,label:a,onPress:d,testid:"p2p_button_action_tray",ref:c})});f.label=a;f.make=c}),null);
__d("MWChatComposerP2PPaymentEligibility",["CometRelay","MWChatComposerP2PPaymentEligibilityQuery.graphql"],(function(a,b,c,d,e,f){"use strict";f.use=a;var g;function a(a){return b("CometRelay").useLazyLoadQuery(g!==void 0?g:g=b("MWChatComposerP2PPaymentEligibilityQuery.graphql"),a)}}),null);
__d("MWUIGetParticipantFbids.bs",["requireCond","cr:1682908"],(function(a,b,c,d,e,f){"use strict";a=b("cr:1682908").useHook;f.$MWLSGetParticipantFbids$OR$MWMSGetParticipantFbids$requireCond=b("cr:1682908");f.useHook=a}),null);
__d("MWChatComposerP2PPopoverTrigger.bs",["fbt","bs_curry","React","gkx","bs_js_dict","bs_caml_obj","bs_belt_Array","JSResource","bs_belt_Option","bs_caml_option","CurrentUser","MWChatThreadId.bs","MWChatTabEntryPoints.bs","MessengerWebEntryPoint","MWChatComposerP2PButton.bs","MWUIGetParticipantFbids.bs","CometEntryPointPopoverTrigger.react","MWChatComposerP2PPaymentEligibility","MWChatComposerP2PPopoverQuery$Parameters"],(function(a,b,c,d,e,f,g){"use strict";var h=b("React");function i(a){a=b("bs_js_dict").get(b("MWChatTabEntryPoints.bs").tabEntryPoints,b("MWChatThreadId.bs").getFBID(a));return a===b("bs_caml_option").some(b("MessengerWebEntryPoint").P2P_PAYMENTS)}function a(a){var c=a.actionTrayOpen,d=a.closeActionTray,e=a.isGroupThread;a=a.threadId;var f=b("bs_curry")._1(b("MWUIGetParticipantFbids.bs").useHook,void 0),j=a!==void 0&&!(typeof a==="string"||a.NAME!=="User")?b("bs_caml_option").some(a.VAL):void 0;f=b("MWChatComposerP2PPaymentEligibility").use({fbids:j!==void 0?[b("bs_caml_option").valFromOption(j)]:f.filter(function(a){return b("bs_caml_obj").caml_notequal(a,b("CurrentUser").getID())})});var k={};k.rootQuery={parameters:b("MWChatComposerP2PPopoverQuery$Parameters"),variables:{}};f=f.viewer;var l;if(f==null)l=void 0;else{f=f.peer_to_peer_payments;l=f==null?void 0:b("bs_caml_option").some(f.can_send_to)}f=l!==void 0?b("bs_belt_Array").get(b("bs_caml_option").valFromOption(l),0):void 0;var m=b("gkx")("1013539");if(!m)return null;if(f===void 0)return null;m=b("bs_caml_option").valFromOption(f);if(e)f=[!0,g._("Puedes solicitar dinero a varias personas en conversaciones en grupo.")];else{var n=m.is_eligible;m=n?b("MWChatComposerP2PButton.bs").label:m.exception.description;f=[n,m]}var o=f[1],p=f[0];return h.jsx(b("CometEntryPointPopoverTrigger.react"),{align:"end",children:function(a,d){return h.jsx(b("MWChatComposerP2PButton.bs").make,{onPress:d,disabled:!c||!p,label:o,ref:a})},entryPointParams:{},otherProps:{closeActionTray:d,eligibility:l,isGroupThread:e,otherUserFbid:j,threadFbid:b("bs_belt_Option").map(a,b("MWChatThreadId.bs").getFBID)},popoverEntryPoint:{getPreloadProps:function(a){return{queries:k}},root:b("JSResource")("MWChatComposerP2PPopover.react").__setRef("MWChatComposerP2PPopoverTrigger.bs")},position:"above",visibleOnLoad:a!==void 0?i(a):!1})}c=a;f.shouldShowOnLoad=i;f.make=c}),null);
__d("RoomButtonTapFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1744274");c=b("FalcoLoggerInternal").create("room_button_tap",a);e.exports=c}),null);
__d("RoomsUserActionsButton",[],(function(a,b,c,d,e,f){a=Object.freeze({ALL:"all",ARCHIVE_SETTING:"archive_setting",AUDIO_CALL_ICON:"audio_call_icon",BACK:"back",BIRTHDAY_STORY_CALL_CANCEL:"birthday_story_call_cancel",BIRTHDAY_STORY_CALL_CONFIRM:"birthday_story_call_confirm",BIRTHDAY_STORY_COMPOSER:"birthday_story_composer",BIRTHDAY_STORY_VIDEO_CALL:"birthday_story_video_call",CANCEL:"cancel",CANCEL_END_ROOM:"cancel_end_room",CLIENT_LINK_START:"client_link_start",COPY_LINK:"copy_link",CREATE:"create",CREATOR_LOBBY_INVITED_CELL_MESSAGE:"creator_lobby_invited_cell_message",CUSTOM_MESSAGE:"custom_message",CUSTOMIZE:"customize",CUSTOMIZE_ROOM_NAME_EMOJI:"customize_room_name_emoji",DONE:"done",EDIT_JOIN_PERMISSIONS:"edit_join_permissions",EDIT_ROOM_ACTIVITY:"edit_room_activity",END_RECURRING_SERIES:"end_recurring_series",END_ROOM:"end_room",EXIT:"exit",FRIEND_SELECTOR_INVITE:"friend_selector_invite",GROUP:"group",GVC:"gvc",INDIVIDUAL:"individual",INTEREST:"interest",INVITE:"invite",INVITE_FRIENDS:"invite_friends",JOIN:"join",JOIN_PERMISSIONS_ALL_FRIENDS:"join_permissions_all_friends",JOIN_PERMISSIONS_ANYONE:"join_permissions_anyone",JOIN_PERMISSIONS_NONE:"join_permissions_none",JOIN_PERMISSIONS_ONLY_INVITED_FRIENDS:"join_permissions_only_invited_friends",JOIN_ZR:"join_zr",JOINER_LOBBY_MESSAGE:"joiner_lobby_message",LEARN_MORE_CREATE_ROOM:"learn_more_create_room",LEARN_MORE_MENU:"learn_more_menu",LINK:"link",MANAGE:"manage",MANAGE_ARCHIVE:"manage_archive",MESSENGER_IN_THREAD_QP:"messenger_in_thread_qp",MESSENGER_THREAD_LIST_QP:"messenger_thread_list_qp",MORE:"more",NEXT:"next",OK:"ok",PROMOTION_UNIT:"promotion_unit",PROMOTION_UNIT_CREATE_ROOM:"create_room",PROMOTION_UNIT_DISMISS:"dismiss",PROMOTION_UNIT_GROUP_SETTINGS:"group_settings",PROMOTION_UNIT_INTERESTED:"qp_interested",PROMOTION_UNIT_LEARN_MORE:"learn_more",PROMOTION_UNIT_SEE_ROOMS:"see_rooms",RECREATE:"recreate",RECURRING_ROOM_REPEAT_DAILY:"recurring_room_repeat_daily",RECURRING_ROOM_REPEAT_NEVER:"recurring_room_repeat_never",RECURRING_ROOM_REPEAT_WEEKLY:"recurring_room_repeat_weekly",REPORT_BUG:"report_bug",REPORT_ROOM:"report_room",ROOMS:"rooms",ROOMS_CALL_ICON:"rooms_call_icon",SEARCH_BAR:"search_bar",SEARCH_BAR_CANCEL:"search_bar_cancel",SELECT_PARTICIPANT:"select_participant",SEND_LINK:"send_link",SEND_MESSAGE:"send_message",SETTING:"setting",SHARE_EXTERNAL:"share_external",SHARE_FB_FRIENDS:"share_fb_friends",SHARE_SEND_AS_MESSAGE:"share_send_as_message",SHARE_TO_NEWSFEED:"share_to_newsfeed",SHARE_VIA_OS_SHEET:"share_via_os_sheet",TEMPLATE_ALL_FRIENDS:"template_all_friends",TEMPLATE_QUICK_LINK:"template_quick_link",TEMPLATE_SCHEDULE_AHEAD:"template_schedule_ahead",TEMPLATE_SPECIFIC_FRIENDS:"template_specific_friends",TRY_IT:"try_it",UNDO:"undo",UNINTEREST:"uninterest",UPDATE:"update",VIDEO_CALL:"video_call",VIDEO_OFF:"video_off",VIDEO_ON:"video_on",VISIBILITY_TOGGLE_TO_ALL_FRIENDS:"visibility_toggle_to_all_friends",VISIBILITY_TOGGLE_TO_INVITED_FRIENDS:"visibility_toggle_to_invited_friends"});e.exports=a}),null);
__d("RoomsUserActionsSource",[],(function(a,b,c,d,e,f){a=Object.freeze({CELEBRANT_SIDE_BIRTHDAY_ROOM_NOTIFICATION:"celebrant_side_birthday_room_notification",COMET_CREATE_MENU:"comet_create_menu",COMET_RHC:"comet_rhc",CREATE_ROOM_CARD:"create_room_card",CROSS_GROUPS_CHATS_AND_ROOMS_TRAY:"cross_groups_chats_and_rooms_tray",CROSS_GROUPS_JOINED_CHATS_AND_ROOMS_INBOX:"cross_groups_joined_chats_and_rooms_inbox",CROSS_GROUPS_ROOMS_INBOX_SEE_ALL:"cross_groups_rooms_inbox_see_all",CROSS_GROUPS_ROOMS_ONLY_TRAY:"cross_groups_rooms_only_tray",EMPTY_FRIEND_ROOM_CARD:"empty_friend_room_card",EMPTY_GROUP_ROOM_CARD:"empty_group_room_card",EMPTY_THREAD_ROOM_CARD:"empty_thread_room_card",FB_BOOKMARK:"fb_bookmark",FB_CHAT_SIDE_BAR:"fb_chat_side_bar",FB_COMPOSER:"fb_composer",FB_COMPOSER_PUBLISHER_BAR:"fb_composer_publisher_bar",FB_FEED_COMPOSER:"fb_feed_composer",FB_FEED_TRAY_QP:"fb_feed_tray_qp",FB_FEED_TRAY_SOCIAL_NORMS_LARGE_QP:"fb_feed_tray_social_norms_large_qp",FB_FEED_TRAY_SOCIAL_NORMS_SMALL_QP:"fb_feed_tray_social_norms_small_qp",FB_GROUP_COMPOSER:"fb_group_composer",FB_IN_FEED:"fb_in_feed",FB_IN_FEED_ROOMS_CARD_LOBBY:"fb_in_feed_rooms_card_lobby",FB_IN_GROUP:"fb_in_group",FB_IN_PAGE:"fb_in_page",FB_IN_PROFILE:"fb_in_profile",FB_IN_THREAD:"fb_in_thread",FB_MESSENGER_JEWEL:"fb_messenger_jewel",FB_PROFILE_ROOMS_CARD_LOBBY:"fb_profile_rooms_card_lobby",FB_ROOMS_HOME_HEADER:"fb_rooms_home_header",FB_ROOMS_HOME_JOIN_UNIT:"fb_rooms_home_join_unit",FB_ROOMS_HOME_ROOMS_SECTION:"fb_rooms_home_rooms_section",FB_SEARCH_SHORTCUT:"fb_search_shortcut",FB_TOP_OF_FEED:"fb_top_of_feed",FB_TOP_OF_FEED_ROOMS_CARD_LOBBY:"fb_top_of_feed_rooms_card_lobby",FB_TOP_OF_FEED_TRAY_HEADER:"fb_top_of_feed_tray_header",FRIEND_ROOM_CARD:"friend_room_card",GROUP_DISCUSSION_TAB_COMPOSER:"group_discussion_tab_composer",GROUP_MEMBER_ONBOARDING:"group_member_onboarding",GROUP_RHC:"group_rhc",GROUP_ROOM_CARD:"group_room_card",GROUP_ROOM_CREATION:"group_room_creation",GROUP_ROOM_CREATION_ROOMS_CARD_LOBBY:"group_room_creation_rooms_card_lobby",GROUP_ROOM_JOINED_CHATS_AND_ROOMS_INBOX:"group_room_joined_chats_and_rooms_inbox",GROUP_ROOM_JOINED_CHATS_AND_ROOMS_INBOX_SEE_ALL:"group_room_joined_chats_and_rooms_inbox_see_all",GROUP_ROOM_JOINED_CHATS_AND_ROOMS_TRAY:"group_room_joined_chats_and_rooms_tray",GROUP_ROOM_LIST_VIEW:"group_room_list_view",GROUP_ROOM_LIST_VIEW_ROOMS_CARD_LOBBY:"group_room_list_view_rooms_card_lobby",GROUP_ROOM_LIST_VIEW_SEE_ALL:"group_room_list_view_see_all",GROUP_ROOM_LIST_VIEW_SEE_ALL_ROOMS_CARD_LOBBY:"group_room_list_view_see_all_rooms_card_lobby",GROUP_ROOM_VALUE_PROP_EDU_QP:"group_room_value_prop_edu_qp",GROUP_ROOMS_TAB:"group_rooms_tab",GROUP_ROOMS_TAB_ROOMS_CARD_LOBBY:"group_rooms_tab_rooms_card_lobby",GROUP_ROOMS_VALUE_PROP_EDU_NOTIF:"group_rooms_value_prop_edu_notif",GROUPS_JOINABLE_VIDEO_CHAT_FRIEND_JOINED:"groups_joinable_video_chat_friend_joined",GROUPS_JOINABLE_VIDEO_CHAT_REMINDER:"groups_joinable_video_chat_reminder",GROUPS_NEW_JOINABLE_VIDEO_CHAT:"groups_new_joinable_video_chat",IG_DIRECT_TAB:"ig_direct_tab",IG_DIRECT_TAB_ROOM_LIST:"ig_direct_tab_room_list",IN_THREAD:"in_thread",IN_THREAD_TOP_BAR:"in_thread_top_bar",INBOX_NEW:"inbox_new",INBOX_OLD:"inbox_old",INBOX_TRAY:"inbox_tray",INLINE_COMPOSER:"inline_composer",JVC_CHAT_REMINDER:"jvc_chat_reminder",JVC_CREATOR_JOINED:"jvc_creator_joined",JVC_EMPTY_ROOM:"jvc_empty_room",JVC_FRIEND_JOINED:"jvc_friend_joined",JVC_INVITED:"jvc_invited",JVC_JOIN_ATTEMPTED:"jvc_join_attempted",JVC_NOW_ROOM_CREATOR_REMINDER:"jvc_now_room_creator_reminder",JVC_RSVP:"jvc_rsvp",JVC_WANT_CHAT:"jvc_want_chat",MARKETING:"promo",MESSAGE_COMPOSER:"message_composer",NEW_VIDEO_CALL:"new_video_call",PEOPLE_TAB:"people_tab",PROFILE_SETTING:"profile_setting",PROFILE_TIMELINE:"profile_timeline",ROOM_PROMOTION_UNIT:"room_promotion_unit",SELF_ROOM_CARD:"self_room_card",TEST:"test",THREAD_TITLE:"thread_title",TOP_FRIENDS_BIRTHDAY_NOTIFICATION:"top_friends_birthday_notification",UNKNOWN_NOTIF:"unknown_notif",WEB_CHROME_EXTENSION:"web_chrome_extension",WHATSAPP:"whatsapp",XMA:"XMA"});e.exports=a}),null);
__d("RoomsUserActionsSurface",[],(function(a,b,c,d,e,f){a=Object.freeze({DEEP_LINKS:"deep_links",DEFAULT:"default",FACEBOOK_DOT_COM:"facebook_dot_com",FB_ROOMS_BOOKMARK:"fb_rooms_bookmark",FB_ROOMS_HOME:"fb_rooms_home",GROUP:"group",IG_DIRECT:"ig_direct",JEWEL_NOTIFICATIONS:"jewel_notifications",MESSENGER:"messenger",MESSENGER_DOT_COM:"messenger_dot_com",MESSENGER_FB:"messenger_fb",NEWSFEED:"newsfeed",PROFILE:"profile",PUSH_NOTIFICATIONS:"push_notifications",WEB_CHROME_EXTENSION:"web_chrome_extension",WORKCHAT:"workchat",WORKSPEED:"workspeed"});e.exports=a}),null);
__d("MWChatComposerActionTrayItems.bs",["ix","fbt","Promise","URI","uuid","bs_curry","React","gkx","qex","SkytaleDB","fbicon","JSResource","stylex","bs_belt_Option","bs_caml_option","MWThreadKey.bs","promiseDone","requireCond","SkytaleDBQuery.bs","useCurrentRoute","CometTooltip.react","LSDatabaseDeferred.bs","MWChatComposerIcons.bs","recoverableViolation","CometErrorBoundary.re","MWChatComposerButtons.bs","MessengerURIConstants","CometPlaceholder.react","RoomsUserActionsButton","RoomsUserActionsSource","MWChatComposerGifButton.bs","MWChatComposerP2PButton.bs","RoomButtonTapFalcoEvent","RoomsUserActionsSurface","MWChatComposerStickerButton.bs","CometLazyDialogTrigger.react","MWChatComposerActionTrayButton.bs","MWChatComposerCreatePollButton.bs","MWChatComposerUploadFileButton.bs","MWChatComposerP2PPopoverTrigger.bs","MWChatComposerCreateRoomButton.react","cr:1613306","cr:1711351"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=b("React"),l={button:{flexGrow:"buofh1pr",marginStart:"h676nmdw"}},m=(e=b("gkx"))("1787584"),n=e("1787585"),o=e("1787586"),p=e("1787587"),q=e("1787588"),r=e("1787590"),s=e("1787591"),t=e("1787592"),u=b("qex")._("1857144");function v(a){return k.jsx(b("MWChatComposerIcons.bs").Photo.make,{size:20,fill:"var(--primary-text)"})}e={make:v};function w(a){return k.jsx(b("MWChatComposerIcons.bs").Sticker.make,{size:20,fill:"var(--primary-text)"})}var x={make:w};function y(a){return k.jsx(b("MWChatComposerIcons.bs").Gif.make,{size:20,fill:"var(--primary-text)"})}var z={make:y},A=b("MWChatComposerCreateRoomButton.react"),B={make:A};function a(a){b("RoomButtonTapFalcoEvent").log(a)}a={log:a};function c(a){return b("useCurrentRoute")()}function C(a){b("recoverableViolation")("MWChatComposerActionTrayItems level component did not catch own error","messenger_web_product",{error:a})}function d(c,d,e,f,x,z,B,E,F,G,H,I,J,K,L,M,N,O){e=b("gkx")("1013538")&&z&&(!c||b("gkx")("1618969"));z=b("cr:1711351")==null?void 0:b("bs_caml_option").some(b("cr:1711351"));var a=b("cr:1613306")==null?void 0:b("bs_caml_option").some(b("cr:1613306")),P=b("MWThreadKey.bs").useIdMemoized(void 0),Q=b("uuid")(),R=b("MessengerURIConstants").FACEBOOK_PREFIX,S=b("useCurrentRoute")(),T;if(S==null)T=void 0;else{S=new(i||(i=b("URI")))(S.url);T=S.getPath()}var U=T!==void 0?T.startsWith(R)?b("RoomsUserActionsSurface").MESSENGER_FB:b("RoomsUserActionsSurface").MESSENGER_DOT_COM:b("RoomsUserActionsSurface").FACEBOOK_DOT_COM;S=[[0,F&&b("bs_belt_Option").isSome(z)&&!m,b("bs_belt_Option").mapWithDefault(z,null,function(a){return k.jsx(a.make,{button:function(a,c){return k.jsx("div",{children:k.jsx(b("MWChatComposerActionTrayButton.bs").make,{disabled:!d,icon:b("MWChatComposerIcons.bs").Camera.make,label:b("MWChatComposerButtons.bs").quickCamLabel,onPress:function(c){return b("bs_curry")._1(a,void 0)},ref:c}),className:(j||(j=b("stylex")))(l.button)})},onSendAttachment:G},"camera")})],[1,x&&b("bs_belt_Option").isSome(a)&&!n,b("bs_belt_Option").mapWithDefault(a,null,function(a){return k.jsx("div",{children:k.jsx(a.make,{onPress:H,disabled:!d}),className:(j||(j=b("stylex")))(l.button)},"audio")})],[2,!o,k.jsx(b("MWChatComposerUploadFileButton.bs").make,{button:function(a){return k.jsx("div",{children:k.jsx(b("MWChatComposerActionTrayButton.bs").make,{disabled:!d,icon:v,label:b("MWChatComposerButtons.bs").uploadPhotoLabel,onPress:a,testid:"composer_photo_uploader_action_tray"}),className:(j||(j=b("stylex")))(l.button)})},logOnSelectFileForUpload:O},"photo")],[3,!p,k.jsx(b("MWChatComposerStickerButton.bs").make,{button:function(a,c,e,f,g,h,i){return k.jsx("div",{children:k.jsx(b("MWChatComposerActionTrayButton.bs").make,{disabled:!d,icon:w,label:b("MWChatComposerButtons.bs").stickerLabel,onPress:c,testid:"composer_sticker_picker_action_tray"}),ref:a,className:(j||(j=b("stylex")))(l.button)})},onStickerSelect:K,logOnOpenStickerFlyout:N},"sticker")],[4,f&&!q,k.jsx(b("MWChatComposerGifButton.bs").make,{button:function(a,c,e,f,g,h,i){return k.jsx("div",{children:k.jsx(b("MWChatComposerActionTrayButton.bs").make,{disabled:!d,icon:y,label:b("MWChatComposerButtons.bs").gifLabel,onPress:c,testid:"composer_gif_picker_action_tray"}),ref:a,className:(j||(j=b("stylex")))(l.button)})},onGifSelect:J},"gif")],[5,B,k.jsx(b("MWChatComposerUploadFileButton.bs").make,{acceptAllFiles:!0,button:function(a){return k.jsx("div",{children:k.jsx(b("MWChatComposerActionTrayButton.bs").make,{disabled:!d,icon:b("MWChatComposerIcons.bs").Paperclip.make,label:b("MWChatComposerUploadFileButton.bs").label,onPress:a,testid:"composer_file_uploader"}),className:(j||(j=b("stylex")))(l.button)})},logOnSelectFileForUpload:O},"file")],[6,b("gkx")("1613519")&&!r,k.jsx(b("CometLazyDialogTrigger.react"),{dialogResource:b("JSResource")("MWChatStaticLocationShareDialog.react").__setRef("MWChatComposerActionTrayItems.bs"),dialogProps:{onClose:function(a){}},children:function(a,c){return k.jsx("div",{children:k.jsx(b("CometTooltip.react"),{tooltip:b("MWChatComposerButtons.bs").locationLabel,align:"middle",position:"above",children:k.jsx(b("MWChatComposerActionTrayButton.bs").make,{disabled:!d,icon:b("MWChatComposerIcons.bs").Pin.make,label:b("MWChatComposerButtons.bs").locationLabel,onPress:a,testid:"share_static_location"})}),ref:c,className:(j||(j=b("stylex")))(l.button)})}},"location")],[7,e&&!s,k.jsx("div",{children:k.jsx(b("CometPlaceholder.react"),{children:k.jsx(b("CometErrorBoundary.re").make,{fallback:function(a){return null},children:k.jsx(b("MWChatComposerP2PPopoverTrigger.bs").make,{actionTrayOpen:d,closeActionTray:I,isGroupThread:c,threadId:L}),onError:C}),fallback:k.jsx(b("MWChatComposerP2PButton.bs").make,{disabled:!0,label:h._("Cargando...")})}),className:(j||(j=b("stylex")))(l.button)},"payment")],[8,b("bs_belt_Option").isSome(M)&&!t,b("bs_belt_Option").mapWithDefault(M,null,function(a){return k.jsx(b("MWChatComposerCreatePollButton.bs").make,{button:function(a,c,e,f,g,h,i){return k.jsx("div",{children:k.jsx(b("MWChatComposerActionTrayButton.bs").make,{disabled:!d,icon:b("MWChatComposerIcons.bs").Poll.make,label:b("MWChatComposerButtons.bs").pollLabel,onPress:c,testid:"composer_poll_action_tray"}),ref:a,className:(j||(j=b("stylex")))(l.button)})},onPollCreate:a,logOnOpenPollFlyout:function(a){}},"poll")})],[9,u&&E,k.jsx(A,{button:function(a,c,e,f,h,i,m){return k.jsx("div",{children:k.jsx(b("MWChatComposerActionTrayButton.bs").make,{disabled:!d,icon:b("fbicon")._(g("1388374"),20),label:b("MWChatComposerButtons.bs").roomLabel,onPress:function(a){b("bs_curry")._1(c,void 0);if(P===void 0)return;a=b("LSDatabaseDeferred.bs").db.then(function(a){a=b("SkytaleDBQuery.bs").toArray(b("SkytaleDBQuery.bs").getKeyRange(b("SkytaleDB").table(a,"participants").asc,{hd:P,tl:0})).then(function(a){b("RoomButtonTapFalcoEvent").log(function(c){return{button_type:b("RoomsUserActionsButton").ROOMS,session_ids:{room_settings_session_id:Q},surface:U,source:b("RoomsUserActionsSource").IN_THREAD,target_thread_size:a.length}});return b("Promise").resolve(void 0)});b("promiseDone")(a,void 0,void 0);return b("Promise").resolve(void 0)});b("promiseDone")(a,void 0,void 0)},testid:"composer_room_picker_action_tray",ref:a}),className:(j||(j=b("stylex")))(l.button)})},sessionId:Q,surface:U},"room")]];T=S.filter(function(a){return a[1]});R=T.some(function(a){return a[0]-2>>>0>2});F=T.map(function(a){return a[2]});return[F,R]}var D=b("cr:1613306"),E=b("cr:1711351");f.styles=l;f.$MWChatComposerAudioButton$requireCond=b("cr:1613306");f.mwChatComposerAudioButton=D;f.$MWChatComposerQuickCamButton$requireCond=b("cr:1711351");f.mwChatComposerQuickCamButton=E;f.cameraButtonDisabled=m;f.audioButtonDisabled=n;f.photoButtonDisabled=o;f.stickerButtonDisabled=p;f.gifButtonDisabled=q;f.locationButtonDisabled=r;f.paymentButtonDisabled=s;f.pollButtonDisabled=t;f.roomButtonEnabled=u;f.PhotoButtonSVG=e;f.StickerButtonSVG=x;f.GifButtonSVG=z;f.MWChatComposerCreateRoomButton=B;f.RoomButtonTapFalcoEvent=a;f.useCurrentRoute=c;f.onError=C;f.useActionTrayItems=d}),null);
__d("MWChatComposerAttachmentArea.bs",["bs_curry","React","stylex","bs_belt_Option","bs_caml_option","withComposerViewStatePart"],(function(a,b,c,d,e,f){"use strict";var g,h=b("React"),i={notMediaRoot:{overflowX:"ni8dbmo4",overflowY:"stjgntxs"},root:{alignItems:"bp9cbjyn",display:"j83agx80",justifyContent:"taijpn5t",maxWidth:"d2edcug0",position:"l9j0dhe7"}};function a(a){var c=a.activeAttachmentType,d=a.children,e=a.closeActionTray;h.useEffect(function(){b("bs_curry")._1(e,void 0)},[e]);a=b("bs_belt_Option").flatMap(c,function(a){if(a==null)return;else return b("bs_caml_option").some(a)});if(a!==void 0)return h.jsx("div",{children:b("bs_curry")._1(d,a),className:(g||(g=b("stylex")))(i.root,a!=="MEDIA"?i.notMediaRoot:!1)});else return null}c=b("withComposerViewStatePart")(a,function(a){a=a.attachmentArea;return{activeAttachmentType:a==null?void 0:b("bs_caml_option").some(a.activeAttachmentType)}});f.styles=i;f.make=c}),null);
__d("MWChatComposerEmojiButton.bs",["fbt","bs_curry","React","bs_caml_option","CometTooltip.react","MWChatComposerIcons.bs","CometPressable.react","CometComposerEmojiPickerTrigger.react"],(function(a,b,c,d,e,f,g){"use strict";var h=b("React");function a(a){var c=a.className,d=a.fill,e=a.withArrow,f=a.logOnOpenEmojiFlyout,i=a.xstyleIcon;a=a.xstylePressable;e=e!==void 0?e:!0;var j=i!==void 0?b("bs_caml_option").valFromOption(i):!1,k=a!==void 0?b("bs_caml_option").valFromOption(a):!1,l=g._("Elegir un emoji");return h.jsx(b("CometComposerEmojiPickerTrigger.react"),{align:"end",children:function(a,e,f){return h.jsx("div",{children:h.jsx(b("CometTooltip.react"),{tooltip:l,align:"middle",position:"above",children:h.jsx(b("CometPressable.react"),{"aria-label":l,ref:a,testid:"composer_emoji_picker",onPress:function(a){return b("bs_curry")._1(e,void 0)},overlayRadius:"50%",xstyle:function(a){return[k]},children:h.jsx(b("MWChatComposerIcons.bs").Emoji.make,{size:20,fill:d,xstyle:j})})}),className:c})},onVisibilityChange:function(a){if(a)return b("bs_curry")._1(f,void 0)},withArrow:e})}c=a;f.make=c}),null);
__d("MWChatComposerHeadlessMediaUploader.bs",["bs_curry","React","bs_caml_option","withComposerViewStatePart","useComposerViewStateDispatcher"],(function(a,b,c,d,e,f){"use strict";var g=b("React");function a(a){var c=a.mediaAttachments,d=a.onUploadStart,e=a.onUploadSuccess,f=a.onAttachmentsChanged,h=b("useComposerViewStateDispatcher")();g.useEffect(function(){b("bs_curry")._4(f,c,h,d,e)},[f,c,h,d,e]);return null}c=b("withComposerViewStatePart")(a,function(a){return{mediaAttachments:b("bs_caml_option").nullable_to_opt(a.mediaAttachments)}});f.make=c}),null);
__d("VideoThumbnail",["invariant"],(function(a,b,c,d,e,f,g){a=function(){"use strict";function a(a){this.$1=a}var b=a.prototype;b.getURL=function(){return this.$1};b.getData=function(){g(0,4844)};a.addTextToCanvasContext=function(a,b,c,d,e,f,g,h,i){a.fillStyle=h;a.textAlign=i;a.font=f+"px "+g;h=i==="center"?d+e/2:d;g=1;i=b.split("\n");for(var d=i,b=Array.isArray(d),i=0,d=b?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var j;if(b){if(i>=d.length)break;j=d[i++]}else{i=d.next();if(i.done)break;j=i.value}j=j;var k="",l="";j=j.split(" ");for(var j=j,m=Array.isArray(j),n=0,j=m?j:j[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var o;if(m){if(n>=j.length)break;o=j[n++]}else{n=j.next();if(n.done)break;o=n.value}o=o;l+=o;var p=a.measureText(l).width,q=a.measureText(o).width;if(q>e){k.length>0&&(a.fillText(k,h,c+f*g),g++);q="";var r="";for(var s=o,t=Array.isArray(s),u=0,s=t?s:s[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var v;if(t){if(u>=s.length)break;v=s[u++]}else{u=s.next();if(u.done)break;v=u.value}v=v;r+=v;var w=a.measureText(r).width;w>e?(a.fillText(q,h,c+f*g),q=v,r=v,g++):q=r}k=q+" ";l=q+" "}else p>e?(a.fillText(k,h,c+f*g),k=o+" ",l=o+" ",g++):(l+=" ",k=l)}a.fillText(k,h,c+f*g);g++}return a};return a}();e.exports=a}),null);
__d("CanvasToBlobImpl",["BlobFactory"],(function(a,b,c,d,e,f){function a(a,c){a=atob(a.substr(a.indexOf(",")+1));var d=new Uint8Array(a.length);for(var e=0;e<a.length;e++)d[e]=a.charCodeAt(e);return b("BlobFactory").getBlob([d],{type:c})}e.exports={getBlob:a}}),null);
__d("dataURLToBlob",["Promise","BlobFactory","CanvasToBlobImpl","CanvasToBlobResource","WebWorker"],(function(a,b,c,d,e,f){e.exports=c;var g=a.URL||a.webkitURL||{};function c(a,c){if(!g.createObjectURL||!b("BlobFactory").isSupported)return b("Promise").reject("Browser doesn't support this feature");if(b("WebWorker").isSupported())return new(b("Promise"))(function(d,e){var f=new(b("WebWorker"))(b("CanvasToBlobResource")).setMessageHandler(function(a){d(a),f.terminate()}).setErrorHandler(function(a){e(a.message),f.terminate()}).execute().postMessage({dataURL:a,fileType:c})});else return b("Promise").resolve(b("CanvasToBlobImpl").getBlob(a,c))}}),null);
__d("canvasToBlob",["Promise","dataURLToBlob","promiseDone"],(function(a,b,c,d,e,f){e.exports=a;function a(a,c,d){return new(b("Promise"))(function(e,f){if(a.toBlob)a.toBlob(e,c,d);else{var g=a.toDataURL(c,d);b("promiseDone")(b("dataURLToBlob")(g,c).then(function(a){e(a)},f))}})}}),null);
__d("CanvasVideoThumbnail",["Promise","EventListener","VideoThumbnail","canvasToBlob","promiseDone"],(function(a,b,c,d,e,f){a=function(a){babelHelpers.inheritsLoose(c,a);function c(b,c,d,e,f,g,h){var i;e===void 0&&(e=null);f===void 0&&(f=null);g===void 0&&(g=0);h===void 0&&(h=0);i=a.call(this,null)||this;i.$CanvasVideoThumbnail1=b;i.$CanvasVideoThumbnail2=c;i.$CanvasVideoThumbnail3=d;i.$CanvasVideoThumbnail4=e;i.$CanvasVideoThumbnail5=f;i.$CanvasVideoThumbnail6=g;i.$CanvasVideoThumbnail7=h;return i}var d=c.prototype;d.getCanvas=function(){return this.$CanvasVideoThumbnail1};d.getTime=function(){return this.$CanvasVideoThumbnail3?this.$CanvasVideoThumbnail3:0};d.getURL=function(){this.$CanvasVideoThumbnail8||(this.$CanvasVideoThumbnail8=this.$CanvasVideoThumbnail1.toDataURL("image/jpeg"));return this.$CanvasVideoThumbnail8};d.getData=function(){var a=this,c=document.createElement("canvas"),d=c.getContext("2d"),e=this.$CanvasVideoThumbnail2;return new(b("Promise"))(function(f,g){var h=b("EventListener").listen(e,"seeked",function(){h.remove(),a.$CanvasVideoThumbnail9(c,d),b("promiseDone")(b("canvasToBlob")(c,"image/jpeg").then(f,g))});e.currentTime=a.$CanvasVideoThumbnail3})};d.getDataWithText=function(a,c,d,e,f,g,h,i){var j=this,k=document.createElement("canvas"),l=k.getContext("2d"),m=this.$CanvasVideoThumbnail2;return new(b("Promise"))(function(n,o){var p=b("EventListener").listen(m,"seeked",function(){p.remove(),l.fillStyle=h,l.textAlign=i,j.$CanvasVideoThumbnail9(k,l),l=b("VideoThumbnail").addTextToCanvasContext(l,a,c,d,e,f,g,h,i),b("promiseDone")(b("canvasToBlob")(k,"image/jpeg").then(n,o))});m.currentTime=j.$CanvasVideoThumbnail3})};d.$CanvasVideoThumbnail9=function(a,b){var c=this.$CanvasVideoThumbnail2;this.$CanvasVideoThumbnail4||this.$CanvasVideoThumbnail5?(a.width=this.$CanvasVideoThumbnail4?this.$CanvasVideoThumbnail4:c.videoWidth,a.height=this.$CanvasVideoThumbnail5?this.$CanvasVideoThumbnail5:c.videoHeight,this.$CanvasVideoThumbnail10(a,b)):(a.width=c.videoWidth,a.height=c.videoHeight,b.drawImage(c,0,0,a.width,a.height))};d.$CanvasVideoThumbnail10=function(a,b){var c=this.$CanvasVideoThumbnail2,d=this.$CanvasVideoThumbnail6,e=this.$CanvasVideoThumbnail7,f=this.$CanvasVideoThumbnail4?this.$CanvasVideoThumbnail4:a.width,g=this.$CanvasVideoThumbnail5?this.$CanvasVideoThumbnail5:a.height;b.drawImage(c,d,e,f,g,0,0,a.width,a.height)};return c}(b("VideoThumbnail"));e.exports=a}),null);
__d("HTMLMediaElementReadyStates",[],(function(a,b,c,d,e,f){a={HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4};b=a;e.exports=b}),null);
__d("VideoFrameBuffer",["HTMLMediaElementReadyStates"],(function(a,b,c,d,e,f){a=function(){function a(a,b,c,d,e,f,g){d===void 0&&(d=null),e===void 0&&(e=null),f===void 0&&(f=null),g===void 0&&(g=null),this.$2=b,this.$1=a,this.$3=c||"contain",this.$6=d,this.$7=e,this.$8=f,this.$9=g}var c=a.prototype;c.updateFrameBuffer=function(){this.$4&&(this.$1.width=this.$4,this.$4=null);this.$5&&(this.$1.height=this.$5,this.$5=null);if(this.$2.readyState<b("HTMLMediaElementReadyStates").HAVE_CURRENT_DATA)return;var a=this.$1.clientWidth||this.$1.width,c=this.$1.clientHeight||this.$1.height,d=a,e=c,f=this.$2.videoWidth/this.$2.videoHeight,g=d/e;this.$3==="cover"&&(g*=-1,f*=-1);g>f?d=e*f:g<f&&(e=d/f);g=this.$1.getContext("2d");if(!(g instanceof window.CanvasRenderingContext2D))return;try{if(this.$6||this.$7){g.drawImage(this.$2,(f=this.$8)!=null?f:0,(f=this.$9)!=null?f:0,(f=this.$6)!=null?f:a,(f=this.$7)!=null?f:c,0,0,a,c)}else g.drawImage(this.$2,(a-d)/2,(c-e)/2,d,e)}catch(a){if(a.name!=="NS_ERROR_NOT_AVAILABLE")throw a}};c.getDOMNode=function(){return this.$1};c.updateDimensions=function(a,b){this.$4=a,this.$5=b};return a}();e.exports=a}),null);
__d("generateVideoThumbnails",["Promise","CanvasVideoThumbnail","HTMLMediaElementReadyStates","VideoFrameBuffer","requireCond","cr:909281"],(function(a,b,c,d,e,f){e.exports=a;function a(a,c,d,e,f,k,l,m,n,o){f===void 0&&(f="contain");k===void 0&&(k=0);l===void 0&&(l=null);m===void 0&&(m=null);n===void 0&&(n=null);o===void 0&&(o=null);return new(b("Promise"))(function(p,q){var r=document.createElement("canvas"),s=[],t=0,u=a.duration-k;o!=null&&(u=Math.min(u,o));var v=u/e,w=null,x,y,z=(u=m)!=null?u:g(l,c),A=(u=n)!=null?u:h(l,d),B=i(l,c),C=j(l,d);x=new(b("VideoFrameBuffer"))(r,a,f,z,A,B,C);r.width=(u=z)!=null?u:c;r.height=(u=A)!=null?u:d;var D=function(){x.updateFrameBuffer();var c=new(b("CanvasVideoThumbnail"))(r,a,k+(t-1)*v,z,A,B,C);s.push(c);(!w||c.getURL().length>w.getURL().length)&&(w=c);F()},E=function(){if(a.readyState>=b("HTMLMediaElementReadyStates").HAVE_CURRENT_DATA)D();else if(b("cr:909281")!==null)var c=b("cr:909281").listen(a,"loadeddata",function(){c.remove(),D()});else a.addEventListener("loadeddata",D,{once:!0})},F=function(){t===0&&(b("cr:909281")!==null?y=b("cr:909281").listen(a,"seeked",E):a.addEventListener("seeked",E)),t<e?(a.currentTime=k+t*v,t++):(b("cr:909281")!==null?y&&y.remove():a.removeEventListener("seeked",E),p({thumbnails:s,selectedThumbnail:w}))};if(a.videoWidth===0||a.videoHeight===0){q();return}F()})}function g(a,b){if(a&&a.spherical){if(a.stereoMode==="left-right")return b/2;if(a.projectionType==="cubemap")return b/3}return null}function h(a,b){return a&&a.spherical&&(a.stereoMode==="top-bottom"||a.projectionType==="cubemap")?b/2:null}function i(a,b){return a&&a.spherical&&a.projectionType==="cubemap"?b/3:0}function j(a,b){return a&&a.spherical&&a.projectionType==="cubemap"?b/2:0}}),null);
__d("MWChatComposerRemoveMediaAttachmentItemButton.bs",["ix","fbt","bs_curry","React","fbicon","stylex","TetraCircleButton.react","CometComposerViewStateActions.bs","useComposerViewStateDispatcher"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=b("React"),k={root:{end:"e712q9ov",position:"pmk7jnqg",top:"nezaghv5"}};function a(a){var c=a.attachment,d=b("useComposerViewStateDispatcher")();a=j.useCallback(function(a){return b("bs_curry")._1(d,b("CometComposerViewStateActions.bs").convert({NAME:"RemoveMediaAttachmentItem",VAL:c}))},[c,d]);return j.jsx("div",{children:j.jsx(b("TetraCircleButton.react"),{icon:b("fbicon")._(g("478231"),12),label:h._("Eliminar archivo adjunto"),onPress:a,size:24,type:"overlay"}),className:(i||(i=b("stylex")))(k.root)})}c=a;f.styles=k;f.make=c}),null);
__d("MWChatComposerMediaAttachmentItem.bs",["ix","React","fbicon","MWChatFile.bs","stylex","MWChatImage.bs","TetraIcon.react","TetraText.react","CometImage.react","CometErrorBoundary.re","CometComposerViewState.bs","CometPlaceholder.react","CometLocalVideoFileThumbnailSuspense.react","MWChatComposerRemoveMediaAttachmentItemButton.bs"],(function(a,b,c,d,e,f,g){"use strict";var h,i=b("React"),j={root:{flexGrow:"kb5gq1qc",flexShrink:"pfnyh3mw",height:"m7zwrmfr",marginTop:"rs0gx3tq",marginEnd:"tvfksri0",marginBottom:"dicw6rsg",marginStart:"hcukyx3x",overflowWrap:"jm1wdb64",position:"l9j0dhe7",width:"tmrshh9y"},image:{borderTopStartRadius:"fni8adji",borderTopEndRadius:"hgaippwi",borderBottomEndRadius:"fykbt5ly",borderBottomStartRadius:"ns4ygwem",height:"datstx6m",objectFit:"bixrwtb6",width:"k4urcfbm"},videoIndicator:{position:"pmk7jnqg",start:"kfkz5moi",marginStart:"fnu23jab",top:"rk01pc8j",marginTop:"gy6hb44f"},fileRoot:{alignItems:"bp9cbjyn",backgroundColor:"n1jkxfxr",borderTopStartRadius:"fni8adji",borderTopEndRadius:"hgaippwi",borderBottomEndRadius:"fykbt5ly",borderBottomStartRadius:"ns4ygwem",display:"j83agx80",flexGrow:"kb5gq1qc",flexShrink:"pfnyh3mw",height:"m7zwrmfr",justifyContent:"taijpn5t",marginTop:"rs0gx3tq",marginEnd:"tvfksri0",marginBottom:"dicw6rsg",marginStart:"hcukyx3x",overflowWrap:"jm1wdb64",paddingStart:"scb9dxdr",paddingEnd:"hv4rvrfc",position:"l9j0dhe7",width:"k5ud4834"}};function a(a){a=a.attachment;var c=b("CometComposerViewState.bs").MediaAttachment.fromJS(a),d;switch(c.TAG|0){case 0:case 1:d=[c._0,c._1];break;default:d=[c._0,c._1]}var e=d[1],f=e.uploadID;f=f==null?null:i.jsx(b("MWChatComposerRemoveMediaAttachmentItemButton.bs").make,{attachment:a});var k=i.jsxs("div",{children:[f,i.jsx("div",{children:i.jsx(b("TetraIcon.react"),{icon:b("fbicon")._(g("908355"),16),color:"primary"}),className:(h||(h=b("stylex")))(b("MWChatFile.bs").styles.icon)}),i.jsx("div",{children:i.jsx(b("TetraText.react"),{type:"bodyLink3",numberOfLines:2,children:e.name}),className:h(b("MWChatFile.bs").styles.content)})],className:h(j.fileRoot)});if(c.TAG===4)return i.jsx("div",{});a=i.jsxs("div",{children:[f,i.jsx(b("CometImage.react"),{alt:e.name,draggable:!1,src:URL.createObjectURL(e),loading:"lazy",xstyle:[j.image]})],className:h(j.root)});switch(d[0]){case 0:return a;case 1:if(e.type==="image/gif")return a;else return i.jsx(b("CometErrorBoundary.re").make,{fallback:function(a){return k},children:i.jsx("div",{children:i.jsxs(b("CometPlaceholder.react"),{children:[f,i.jsx(b("CometLocalVideoFileThumbnailSuspense.react"),{file:e,height:b("MWChatImage.bs").defaultMaxHeight,renderer:function(a){return i.jsxs("div",{children:[i.jsx(b("CometImage.react"),{alt:e.name,draggable:!1,src:a,loading:"lazy",xstyle:[j.image]}),i.jsx(b("CometImage.react"),{src:"/images/video/play_24dp.png",xstyle:[j.videoIndicator]})]})},width:200})],fallback:null}),className:(h||(h=b("stylex")))(j.root)})});case 2:return k}}c=a;f.make=c}),null);
__d("MWChatComposerUploadAnotherFileButton.bs",["ix","fbt","bs_curry","React","fbicon","stylex","TetraIcon.react","CometFileSelector.re","CometPressable.react","useComposerViewStateReducer","CometComposerViewStateActions.bs","useComposerViewStateDispatcher","CometComposerMediaAttachmentReducer.re"],(function(a,b,c,d,e,f,g,h){"use strict";var i=b("React"),j={root:{alignItems:"bp9cbjyn",backgroundColor:"n1jkxfxr",borderTopStartRadius:"fni8adji",borderTopEndRadius:"hgaippwi",borderBottomEndRadius:"fykbt5ly",borderBottomStartRadius:"ns4ygwem",display:"j83agx80",flexGrow:"kb5gq1qc",flexShrink:"pfnyh3mw",height:"m7zwrmfr",justifyContent:"taijpn5t",marginTop:"rs0gx3tq",marginEnd:"tvfksri0",marginBottom:"dicw6rsg",marginStart:"hcukyx3x",overflowWrap:"jm1wdb64",position:"l9j0dhe7",width:"tmrshh9y"}};function a(a){b("useComposerViewStateReducer")(b("CometComposerMediaAttachmentReducer.re").reducer);var c=b("useComposerViewStateDispatcher")(),d=i.useCallback(function(a){if(a.length>0)return b("bs_curry")._1(c,b("CometComposerViewStateActions.bs").convert({NAME:"AddMediaAttachmentItems",VAL:a}))},[c]);return i.jsx(b("CometFileSelector.re").make,{accept:["image/*","image/heif","image/heic","video/*"],children:function(a){return i.jsx(b("CometPressable.react"),{"aria-label":h._("Subir otra foto o video"),onPress:function(c){return b("bs_curry")._1(a,void 0)},xstyle:j.root,children:i.jsx(b("TetraIcon.react"),{icon:b("fbicon")._(g("481777"),24),testid:"composer_attachment_area_photo_uploader",color:"primary"})})},multiple:!0,onFilesSelected:function(a){return b("bs_curry")._1(d,Array.from(a))}})}c=a;f.make=c}),null);
__d("MWChatComposerMediaAttachmentArea.bs",["bs_curry","React","stylex","bs_caml_option","withComposerViewStatePart","useComposerViewStateReducer","CometComposerViewStateActions.bs","useComposerViewStateDispatcher","MWChatComposerMediaAttachmentItem.bs","MWChatComposerHeadlessMediaUploader.bs","MWChatComposerUploadAnotherFileButton.bs","CometComposerMediaAttachmentReducer.re"],(function(a,b,c,d,e,f){"use strict";var g=b("React");function a(a){var c=a.mediaAttachments,d=a.onFileUploadStart,e=a.onFileUploadSuccess;a=a.onAttachmentsChanged;b("useComposerViewStateReducer")(b("CometComposerMediaAttachmentReducer.re").reducer);var f=b("useComposerViewStateDispatcher")();g.useEffect(function(){return function(a){return b("bs_curry")._1(f,b("CometComposerViewStateActions.bs").convert("RemoveAllMediaAttachmentItems"))}},[f]);return g.jsxs("div",{children:[g.jsx(b("MWChatComposerHeadlessMediaUploader.bs").make,{onUploadStart:d,onUploadSuccess:e,onAttachmentsChanged:a}),c!==void 0?c.map(function(a,c){return g.jsx(b("MWChatComposerMediaAttachmentItem.bs").make,{attachment:a},"media-"+c)}):null,g.jsx(b("MWChatComposerUploadAnotherFileButton.bs").make,{})],className:"k4urcfbm b3onmgus r8blr3vg ph5uu5jm cxgpxx05 d76ob5m9 jifvfom9 j83agx80 bp9cbjyn"})}c=b("withComposerViewStatePart")(a,function(a){return{mediaAttachments:b("bs_caml_option").nullable_to_opt(a.mediaAttachments)}});f.make=c}),null);
__d("MWChatComposerRoundedCorners.bs",["React","Locale","stylex","useUniqueID"],(function(a,b,c,d,e,f){"use strict";var g,h=b("React"),i={roundedCornerTopRight:{fill:"qbubdy2e",position:"pmk7jnqg",top:"plgsh5y4",end:"n7fi1qx3",pointerEvents:"hzruof5a"},roundedCornerBottomRight:{fill:"qbubdy2e",position:"pmk7jnqg",bottom:"tghqpdut",end:"n7fi1qx3",pointerEvents:"hzruof5a"},roundedCornerRtl:{transform:"c3knoul3"}};function a(a){a=b("useUniqueID")();return h.jsx("div",{children:h.jsxs("svg",{children:[h.jsx("defs",{children:h.jsxs("mask",{children:[h.jsx("rect",{height:"40",width:"40",fill:"white",x:"-20",y:"0"}),h.jsx("circle",{cx:"0",cy:"20",fill:"black",r:"20"})],id:a})}),h.jsx("rect",{height:"20",width:"20",mask:"url(#"+(a+")"),x:"0",y:"0"})],height:"20px",width:"20px"}),className:(g||(g=b("stylex")))(i.roundedCornerTopRight,b("Locale").isRTL()?i.roundedCornerRtl:!1)})}d={make:a};function c(a){a=b("useUniqueID")();return h.jsx("div",{children:h.jsxs("svg",{children:[h.jsx("defs",{children:h.jsxs("mask",{children:[h.jsx("rect",{height:"40",width:"40",fill:"white",x:"-20",y:"0"}),h.jsx("circle",{cx:"0",cy:"0",fill:"black",r:"20"})],id:a})}),h.jsx("rect",{height:"20",width:"20",mask:"url(#"+(a+")"),x:"0",y:"0"})],height:"20px",width:"20px"}),className:(g||(g=b("stylex")))(i.roundedCornerBottomRight,b("Locale").isRTL()?i.roundedCornerRtl:!1)})}e={make:c};f.styles=i;f.TopRight=d;f.BottomRight=e}),null);
__d("MWChatComposerInner.bs",["fbt","Keys","bs_curry","React","Locale","gkx","qex","bs_belt_Array","stylex","bs_caml_option","requireCond","MWChatComposerUtil.bs","isMimeTypeForMedia","recoverableViolation","MWChatComposerButtons.bs","useCometComposerHandler","composerAudioClipReducer","CometComposerEditor.react","MWChatComposerEmojiButton.bs","withComposerViewStatePart","useComposerViewStateReducer","MWChatComposerAttachmentArea.bs","MWChatComposerRoundedCorners.bs","CometComposerViewStateActions.bs","useComposerViewStateDispatcher","MWChatComposerMediaAttachmentArea.bs","CometComposerAttachmentAreaReducer.re","CometComposerMediaAttachmentReducer.re","getPlainTextFromDeferredDraftEditorState","cr:1701527"],(function(a,b,c,d,e,f,g){"use strict";var h,i=b("React"),j={root:{alignItems:"aovydwv3",display:"j83agx80",flexGrow:"buofh1pr",overflowX:"ni8dbmo4",paddingTop:"cxgpxx05",paddingBottom:"sj5x9vvc",width:"qio8uep8",pointerEvents:"hzruof5a",position:"l9j0dhe7"},container:{borderTopStartRadius:"orhb3f3m",borderTopEndRadius:"czkt41v7",borderBottomEndRadius:"fmqxjp7s",borderBottomStartRadius:"emzo65vh",display:"j83agx80",paddingBottom:"e5nlhep0",pointerEvents:"mrt03zmi"},composeArea:{paddingTop:"ecm0bbzt",paddingStart:"h4z51re5",borderTop:"gvyehdmr",borderEnd:"mu0vl6fp",borderBottom:"msuhji6j",borderStart:"iqy7zqfr",flexBasis:"rj1gh0hx",flexDirection:"cbu4d94t",flexGrow:"buofh1pr",display:"j83agx80",overflowX:"ni8dbmo4",alignItems:"ll8tlv6m",backgroundColor:"b3i9ofy5",color:"oo9gr5id",transitionProperty:"flx89l3n",transitionDuration:"dpja2al7",borderTopStartRadius:"orhb3f3m",borderTopEndRadius:"h905i5nu",borderBottomEndRadius:"jinzq4gt",borderBottomStartRadius:"emzo65vh"},composeAreaExpanded:{transform:"qiw3t3sk"},composeAreaCollapsed:{transform:"hedjyaoh"},composeAreaCollapsedRtl:{transform:"n83uzuu6"},inputBoxContainer:{position:"pmk7jnqg",end:"tdcub1r8",paddingTop:"jb3vyjys",paddingEnd:"rz4wbd8a",paddingBottom:"qt6c0cv9",paddingStart:"a8nywdso"},inputContainer:{display:"j83agx80",width:"k4urcfbm"},inputContainerContracted:{width:"thccjwpm"},photoAction:{marginEnd:"cxmmr5t8"},photoIcon:{marginTop:"kvgmc6g5",marginEnd:"cxmmr5t8",marginBottom:"oygrvhab",marginStart:"hcukyx3x"},photoPressable:{paddingTop:"cxgpxx05",paddingEnd:"dflh9lhu",paddingBottom:"sj5x9vvc",paddingStart:"scb9dxdr"},input:{paddingTop:"ecm0bbzt",paddingBottom:"e5nlhep0",flexGrow:"buofh1pr",fontSize:"jq4qci2q",lineHeight:"a3bd9o3v",maxHeight:"iko8p5ub",overflowY:"eg9m0zos",overflowX:"ni8dbmo4",boxSizing:"rq0escxv",marginEnd:"lexh0w6q"}};function a(a){var c=a.actionTrayOpen,d=a.buttonColor,e=a.hasExtraTrayButtons,f=a.closeActionTray,k=a.fileUploadHandlerRef,l=a.hasContent,m=a.inputRef,n=a.editorState,o=a.hasMediaAttachments,p=a.canSendGif,q=a.sendGif,r=a.sendSticker,s=a.shouldExpandInput,t=a.onBlur,u=a.onContentsChange,v=a.onEscape,w=a.onFileUploadStart,x=a.onFileUploadSuccess,y=a.onAttachmentsChanged,z=a.logOnOpenStickerFlyout,A=a.logOnOpenEmojiFlyout,B=a.logOnSelectFileForUpload,C=a.audioRecorderShown;a=a.audioClip;b("useComposerViewStateReducer")(b("CometComposerAttachmentAreaReducer.re").composerAttachmentAreaReducer);b("useComposerViewStateReducer")(b("CometComposerMediaAttachmentReducer.re").reducer);b("useComposerViewStateReducer")(b("composerAudioClipReducer"));var D=b("useComposerViewStateDispatcher")(),E=!e||b("gkx")("1787593"),F=i.useMemo(function(){return{handleKeyCommand:function(a,c,d){if(a!=="Messenger/CloseTab")return"not-handled";b("bs_curry")._1(v,void 0);return"handled"},keyBindingFn:function(a){if(a.keyCode===b("Keys").ESC)return"Messenger/CloseTab"},priority:10}},[v]);b("useCometComposerHandler")(F);F=function(a){a=b("bs_belt_Array").keepMap(a,function(a){if(b("isMimeTypeForMedia").isMimeTypeForPhoto(a.type))return b("bs_caml_option").some(a)});a.length>0&&(b("bs_curry")._1(D,b("CometComposerViewStateActions.bs").convert({NAME:"ActivateAttachmentType",VAL:"MEDIA"})),b("bs_curry")._1(D,b("CometComposerViewStateActions.bs").convert({NAME:"AddMediaAttachmentItems",VAL:a})));return"handled"};var G=function(a,c){return b("bs_curry")._1(D,b("CometComposerViewStateActions.bs").convert({NAME:"SetAudioClip",VAL:[a,c]}))};if(n!==void 0){var H=b("bs_caml_option").valFromOption(n);l.contents=b("MWChatComposerUtil.bs").hasContent(H);var I=H.draftEditorState;if(I!==void 0)I=b("bs_caml_option").valFromOption(I).isInCompositionMode();else{H=H.isComposing;H!==void 0?I=H:(b("recoverableViolation")("viewState.editorState in MWChatComposerInner is malformed!","messenger_comet"),I=!1)}}else b("recoverableViolation")("Did not properly supply editorState prop to MWChatComposerInner from viewState!","messenger_comet"),I=!1;H=function(a){if(n!==void 0){var c=b("getPlainTextFromDeferredDraftEditorState")(b("bs_caml_option").valFromOption(n)),d=b("getPlainTextFromDeferredDraftEditorState")(a);c!==d&&b("bs_curry")._1(u,d)}return a};var J=b("gkx")("1620337");s=s||J||I||c||o===!0||C||l.contents&&e;I=function(a){a=m.current;if(!(a==null))return a.focus()};c=b("qex")._("1586110");l=c==null?{}:{fontSize:String(c)+"px"};e={hasPermanentToggleButton:!E,fileUploadHandlerRef:k,canSendGif:p,sendGif:q,sendSticker:r,shouldHideButtons:s,logOnOpenStickerFlyout:z,logOnSelectFileForUpload:B};d!==void 0&&(e.buttonColor=b("bs_caml_option").valFromOption(d));var K;c=0;b("cr:1701527")==null||!C?c=1:K=i.jsx(b("cr:1701527").make,{audioClip:a,setAudioClip:G});if(c===1){E={className:(h||(h=b("stylex")))(j.photoAction),withArrow:!J,logOnOpenEmojiFlyout:A,xstylePressable:j.photoPressable};d!==void 0&&(E.fill=b("bs_caml_option").valFromOption(d));K=i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[o===!0?i.jsx(b("MWChatComposerAttachmentArea.bs").make,{children:function(a){return i.jsx(b("MWChatComposerMediaAttachmentArea.bs").make,{onFileUploadStart:w,onFileUploadSuccess:x,onAttachmentsChanged:y})},closeActionTray:f}):null,i.jsx("div",{children:i.jsx("div",{children:i.jsx(b("CometComposerEditor.react"),{autoFocus:!1,handlePastedFiles:F,onChange:H,onBlur:t,placeholder:g._("Aa"),ref:m,submitOnEnter:!0,testid:"chat_input",typingPerformanceID:"MWChatComposer"}),className:h(j.input),style:l}),className:h(j.inputContainer,s?!1:j.inputContainerContracted)})],className:h(j.container,j.composeArea,s?j.composeAreaExpanded:b("Locale").isRTL()?j.composeAreaCollapsedRtl:j.composeAreaCollapsed),onClick:I}),i.jsx("div",{children:i.jsx(b("MWChatComposerEmojiButton.bs").make,E),className:h(j.container,j.inputBoxContainer)})]})}return i.jsxs(i.Fragment,{children:[i.jsx(b("MWChatComposerButtons.bs").make,e),i.jsxs("div",{children:[K,i.jsx(b("MWChatComposerRoundedCorners.bs").TopRight.make,{}),i.jsx(b("MWChatComposerRoundedCorners.bs").BottomRight.make,{})],className:(h||(h=b("stylex")))(j.root)})]})}c=b("withComposerViewStatePart")(a,function(a){var c=a.mediaAttachments;return{audioClip:b("bs_caml_option").nullable_to_opt(a.audioClip),hasMediaAttachments:c==null?!1:c.length!==0,editorState:a.editorState}});d=b("cr:1701527");f.styles=j;f.$MWChatComposerAudioRecorder$requireCond=b("cr:1701527");f.mwChatComposerAudioRecorder=d;f.make=c}),null);
__d("MWChatDisabledSendButton.bs",["fbt","React","stylex","CometPressable.react","MWChatChatButtonColorConstants.bs"],(function(a,b,c,d,e,f,g){"use strict";var h,i=b("React");function j(a){}var k={disabledSend:{paddingTop:"cxgpxx05",paddingEnd:"dflh9lhu",paddingBottom:"sj5x9vvc",paddingStart:"scb9dxdr",marginTop:"knvmm38d",marginStart:"kkf49tns",marginEnd:"cgat1ltu",marginBottom:"bi6gxh9e"}};function a(a){a=g._("Bot\u00f3n \"Enviar\" desactivado");return i.jsx(b("CometPressable.react"),{"aria-label":a,onPress:j,overlayRadius:"50%",xstyle:function(a){return[k.disabledSend]},children:i.jsx("svg",{children:i.jsx("path",{d:"M16.6915026,12.4744748 L3.50612381,13.2599618 C3.19218622,13.2599618 3.03521743,13.4170592 3.03521743,13.5741566 L1.15159189,20.0151496 C0.8376543,20.8006365 0.99,21.89 1.77946707,22.52 C2.41,22.99 3.50612381,23.1 4.13399899,22.8429026 L21.714504,14.0454487 C22.6563168,13.5741566 23.1272231,12.6315722 22.9702544,11.6889879 C22.8132856,11.0605983 22.3423792,10.4322088 21.714504,10.118014 L4.13399899,1.16346272 C3.34915502,0.9 2.40734225,1.00636533 1.77946707,1.4776575 C0.994623095,2.10604706 0.8376543,3.0486314 1.15159189,3.99121575 L3.03521743,10.4322088 C3.03521743,10.5893061 3.34915502,10.7464035 3.50612381,10.7464035 L16.6915026,11.5318905 C16.6915026,11.5318905 17.1624089,11.5318905 17.1624089,12.0031827 C17.1624089,12.4744748 16.6915026,12.4744748 16.6915026,12.4744748 Z",fillRule:"evenodd",stroke:"none"}),className:(h||(h=b("stylex")))(b("MWChatChatButtonColorConstants.bs").styles.fillGrey),height:"20px",width:"20px",viewBox:"0 0 24 24"})})}c=a;f.noop=j;f.styles=k;f.make=c}),null);
__d("MWChatHotLikeButton.bs",["fbt","React","CometEmoji.bs","stylex","bs_caml_option","EmojiRenderer","MWLikeSvgIcon.bs","CometTooltip.react","CometPressable.react","MWChatChatButtonColorConstants.bs"],(function(a,b,c,d,e,f,g){"use strict";var h,i=b("React"),j={hotLikeCustom:{paddingTop:"ecm0bbzt",paddingEnd:"ph5uu5jm",paddingBottom:"e5nlhep0",paddingStart:"b3onmgus",marginTop:"qjjbsfad",marginStart:"hnxzwevs",marginEnd:"qq4y78aw",marginBottom:"oud54xpy"},hotLikeDefault:{paddingTop:"cxgpxx05",paddingEnd:"dflh9lhu",paddingBottom:"sj5x9vvc",paddingStart:"scb9dxdr",marginTop:"knvmm38d",marginStart:"kkf49tns",marginEnd:"cgat1ltu",marginBottom:"bi6gxh9e"}};function a(a){var c=a.color,d=a.customLikeEmoji;a=a.sendHotLike;if(d!==void 0&&d!==""){var e=g._("Enviar {emoji}",[g._param("emoji",d)]),f=function(a){var c=b("EmojiRenderer").parse(d).map(function(a){return a.emoji});if(c.length!==1)return i.jsx("span",{children:d});c=c[0];return i.jsx(b("CometEmoji.bs").make,{emoji:c,size:a})},k=g._("Enviar");k=i.jsxs(i.Fragment,{children:[i.jsxs("span",{children:[k," "]}),f(16)]});return i.jsx(b("CometTooltip.react"),{tooltip:k,align:"middle",position:"above",children:i.jsx(b("CometPressable.react"),{"aria-label":e,testid:"messenger_hotlike_emoji_button",onPress:a,overlayRadius:"50%",xstyle:function(a){return[j.hotLikeCustom]},children:f(24)})})}k=g._("Enviar un Me gusta");e={className:(h||(h=b("stylex")))(b("MWChatChatButtonColorConstants.bs").styles.fillGrey)};c!==void 0&&(e.color=b("bs_caml_option").valFromOption(c));return i.jsx(b("CometTooltip.react"),{tooltip:k,align:"middle",position:"above",children:i.jsx(b("CometPressable.react"),{"aria-label":k,testid:"messenger_hotlike_button",onPress:a,overlayRadius:"50%",xstyle:function(a){return[j.hotLikeDefault]},children:i.jsx(b("MWLikeSvgIcon.bs").make,e)})})}c=a;f.styles=j;f.make=c}),null);
__d("MWChatSendButton.bs",["fbt","React","stylex","bs_caml_option","CometTooltip.react","CometPressable.react","MWChatChatButtonColorConstants.bs"],(function(a,b,c,d,e,f,g){"use strict";var h,i=b("React"),j={send:{paddingTop:"cxgpxx05",paddingEnd:"dflh9lhu",paddingBottom:"sj5x9vvc",paddingStart:"scb9dxdr",marginTop:"knvmm38d",marginStart:"kkf49tns",marginEnd:"cgat1ltu",marginBottom:"bi6gxh9e"}};function a(a){var c=a.onPress,d=a.color;a=a.testid;var e=g._("Presiona \"Enter\" para enviar"),f={d:"M16.6915026,12.4744748 L3.50612381,13.2599618 C3.19218622,13.2599618 3.03521743,13.4170592 3.03521743,13.5741566 L1.15159189,20.0151496 C0.8376543,20.8006365 0.99,21.89 1.77946707,22.52 C2.41,22.99 3.50612381,23.1 4.13399899,22.8429026 L21.714504,14.0454487 C22.6563168,13.5741566 23.1272231,12.6315722 22.9702544,11.6889879 C22.8132856,11.0605983 22.3423792,10.4322088 21.714504,10.118014 L4.13399899,1.16346272 C3.34915502,0.9 2.40734225,1.00636533 1.77946707,1.4776575 C0.994623095,2.10604706 0.8376543,3.0486314 1.15159189,3.99121575 L3.03521743,10.4322088 C3.03521743,10.5893061 3.34915502,10.7464035 3.50612381,10.7464035 L16.6915026,11.5318905 C16.6915026,11.5318905 17.1624089,11.5318905 17.1624089,12.0031827 C17.1624089,12.4744748 16.6915026,12.4744748 16.6915026,12.4744748 Z",fillRule:"evenodd",stroke:"none"};d!==void 0&&(f.fill=b("bs_caml_option").valFromOption(d));return i.jsx(b("CometTooltip.react"),{tooltip:e,align:"middle",position:"above",children:i.jsx(b("CometPressable.react"),{"aria-label":e,testid:a,onPress:c,overlayRadius:"50%",xstyle:function(a){return[j.send]},children:i.jsx("svg",{children:i.jsx("path",f),className:(h||(h=b("stylex")))(b("MWChatChatButtonColorConstants.bs").styles.fillGrey),height:"20px",width:"20px",viewBox:"0 0 24 24"})})})}c=a;f.styles=j;f.make=c}),null);
__d("MWUIComposerPersistentMenuButton.bs",["requireCond","cr:1772080"],(function(a,b,c,d,e,f){"use strict";a=b("cr:1772080").make;f.$LSComposerPersistentMenuButton$OR$MWChatBusinessPersistentMenuButton$requireCond=b("cr:1772080");f.make=a}),null);
__d("MWChatComposerLastButton.bs",["bs_curry","React","gkx","FBLogger","bs_belt_Option","bs_caml_option","MWChatSendButton.bs","MWChatComposerUtil.bs","MWChatHotLikeButton.bs","MWChatDisabledSendButton.bs","withComposerViewStatePart","MWUIComposerPersistentMenuButton.bs"],(function(a,b,c,d,e,f){"use strict";var g=b("React");function a(a){var c=a.color,d=a.customLikeEmoji,e=a.editorState,f=a.hasMediaAttachments,h=a.hasAudioClip,i=a.onFocusComposer,j=a.sendHotLike,k=a.sendMenuItem,l=a.sendMessage,m=a.shouldShowMenu;a=a.pageId;var n=!b("gkx")("1835751");l={onPress:l,testid:"chat_send_button"};c!==void 0&&(l.color=b("bs_caml_option").valFromOption(c));l=g.jsx(b("MWChatSendButton.bs").make,l);if(e!==void 0){f=b("bs_belt_Option").getWithDefault(f,!1);h=b("bs_belt_Option").getWithDefault(h,!1);if(!(!b("MWChatComposerUtil.bs").hasContent(b("bs_caml_option").valFromOption(e))&&!f&&!h))return l;if(n)return g.jsx(b("MWChatDisabledSendButton.bs").make,{});if(a!==void 0&&m){e={pageId:b("bs_caml_option").valFromOption(a),sendMenuItem:k};c!==void 0&&(e.color=b("bs_caml_option").valFromOption(c));return g.jsx(b("MWUIComposerPersistentMenuButton.bs").make,e)}f={customLikeEmoji:d,sendHotLike:function(a){b("bs_curry")._1(j,a);return b("bs_curry")._1(i,void 0)}};c!==void 0&&(f.color=b("bs_caml_option").valFromOption(c));return g.jsx(b("MWChatHotLikeButton.bs").make,f)}b("FBLogger")("messenger-comet").mustfix("Did not properly supply editorState prop to MWChatComposerLastButton from viewState!");return l}c=b("withComposerViewStatePart")(a,function(a){var c=a.mediaAttachments;return{editorState:a.editorState,hasMediaAttachments:c==null?!1:c.length!==0,hasAudioClip:b("bs_caml_option").nullable_to_opt(a.audioClip)!==void 0}});d=b("bs_belt_Option").getWithDefault;f.$pipe$question=d;f.make=c}),null);
__d("LsReplyCanceledFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1743875");c=b("FalcoLoggerInternal").create("ls_reply_canceled",a);e.exports=c}),null);
__d("LsReplyRenderedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1743878");c=b("FalcoLoggerInternal").create("ls_reply_rendered",a);e.exports=c}),null);
__d("MWChatComposerReplyView.bs",["ix","fbt","bs_curry","React","bs_caml_int64","fbicon","stylex","MWChatReplyText.bs","TetraIcon.react","TetraText.react","MWThread_DEPRECATED.bs","MWUILoadParticipants.bs","LsFalcoEventEntryPoint.bs","TetraTextPairing.react","MessagingAttachmentType.bs","LsReplyCanceledFalcoEvent","LsReplyRenderedFalcoEvent"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=b("React"),k={container:{borderTop:"l6v480f0",backgroundColor:"nred35xi",paddingEnd:"oj5qckz4",paddingStart:"lb8aey2d",paddingTop:"jktsbyx5",paddingBottom:"pby63qed",display:"j83agx80",justifyContent:"i1fnvgqd",alignItems:"ll8tlv6m"},message:{marginEnd:"o3lre8g0"}};function a(a){var c=a.repliedToMessage,d=a.onClosePreview;a=b("MWThread_DEPRECATED.bs").useIdExn(void 0);a=b("bs_curry")._1(b("MWUILoadParticipants.bs").useParticipants,a);j.useEffect(function(){b("LsReplyRenderedFalcoEvent").log(function(){return{funnel:{entry_point:b("LsFalcoEventEntryPoint.bs").messageActions}}})},[]);var e;if(c.fromViewer)e=h._("a ti mismo");else{a=a.get(c.authorID);e=a==null?h._("Mensaje"):a.name}a=c.content;var f;switch(a.TAG|0){case 0:c=a._2;if(c.TAG){a=c._0;switch(a.TAG|0){case 0:f=h._("Sticker");break;case 1:case 2:f=h._("Imagen");break;case 3:a=a._0;f=b("bs_caml_int64").eq(a.f,b("MessagingAttachmentType.bs").ephemeralImage)?h._("Imagen"):b("bs_caml_int64").eq(a.f,b("MessagingAttachmentType.bs").ephemeralVideo)?h._("Video"):h._("Archivo adjunto");break;case 7:f=h._("Video");break;case 9:f=null;break;default:f=h._("Archivo adjunto")}}else{a=c._0;f=j.jsx(b("MWChatReplyText.bs").make,{text:a.text,ranges:a.ranges})}break;case 1:case 2:f=null;break}return j.jsxs("div",{children:[j.jsx(b("TetraTextPairing.react"),{body:j.jsx(j.Fragment,{children:j.jsxs(b("TetraText.react"),{type:"body4",children:[h._("Respondiendo a")," ",j.jsx(b("TetraText.react"),{type:"bodyLink4",children:e})]})}),meta:f,level:3,style:k.message}),j.jsx(b("TetraIcon.react"),{"aria-label":h._("Eliminar"),icon:b("fbicon")._(g("478231"),12),onPress:function(a){b("LsReplyCanceledFalcoEvent").log(function(){return{funnel:{entry_point:b("LsFalcoEventEntryPoint.bs").messageActions}}});return b("bs_curry")._1(d,void 0)},color:"primary"})],className:(i||(i=b("stylex")))(k.container)})}c=a;f.replyToStyles=k;f.make=c}),null);
__d("CometComposerEditorStateReducer.re",["composerEditorStateViewStateReducer"],(function(a,b,c,d,e,f){a=b("composerEditorStateViewStateReducer");f.reducerTypeChecked=a;c=a;f.reducer=c}),null);
__d("Draft.bs",["EditorState"],(function(a,b,c,d,e,f){"use strict";c={};d={};e={};var g={},h={},i={},j={},k={};function a(a){a=b("EditorState").createEmpty(void 0);var c=a.getCurrentContent();return b("EditorState").forceSelection(a,c.getSelectionAfter())}a={clearEditorContent:a};var l={};f.CharacterMetadata=c;f.ContentBlock=d;f.EntityInstance=e;f.SelectionState=g;f.ContentState=h;f.Decorator=i;f.CompositeDecorator=j;f.Modifier=k;f.EditorState=a;f.Editor=l}),null);
__d("MWChatResetComposer.bs",["bs_curry","Draft.bs","React","useComposerViewStateReducer","CometComposerViewStateActions.bs","CometComposerEditorStateReducer.re","useControlledComposerViewStateDispatcher"],(function(a,b,c,d,e,f){"use strict";var g=b("React");function a(a,c){b("useComposerViewStateReducer")(b("CometComposerEditorStateReducer.re").reducer);var d=b("useControlledComposerViewStateDispatcher")();g.useImperativeHandle(c,function(){return{reset:function(a){return[{NAME:"UpdateDraftEditorState",VAL:b("Draft.bs").EditorState.clearEditorContent(void 0)},"RemoveAllMediaAttachmentItems",{NAME:"RemoveAttachmentType",VAL:"MEDIA"},"RemoveAudioClip"].map(function(a){return b("bs_curry")._1(d,b("CometComposerViewStateActions.bs").convert(a))})}}},[d]);return null}c=g.forwardRef(a);f.make=c}),null);
__d("MWChatUseLatch.bs",["Run","bs_curry","React","setTimeout","bs_caml_option","clearTimeout"],(function(a,b,c,d,e,f){"use strict";var g=b("React");function a(a,c,d){var e=c!==void 0?c:!1,f=g.useRef(void 0),h=g.useCallback(function(a){var c=f.current;if(c!==void 0){b("clearTimeout")(b("bs_caml_option").valFromOption(c));f.current=void 0;return}else return b("bs_curry")._1(a,void 0)},[f]),i=g.useCallback(function(c){b("bs_curry")._1(h,function(a){});return b("bs_curry")._1(a,!1)},[a,h]);c=g.useCallback(function(c){b("bs_curry")._1(h,function(c){return b("bs_curry")._1(a,!0)});c=b("setTimeout")(i,d);f.current=b("bs_caml_option").some(c)},[a,i,f,h,d]);g.useEffect(function(){if(!e)return;var a=b("Run").onUnload(i);return function(b){return a.remove()}},[e,i]);return[c,i]}f.useLatch=a}),null);
__d("MWChatComposerBase.bs",["bs_curry","React","gkx","stylex","bs_belt_Option","bs_caml_option","requireCond","clearTimeout","MWChatUseLatch.bs","MWChatComposerUtil.bs","CometComposer.react","MWChatComposerInner.bs","MWChatResetComposer.bs","CometPlaceholder.react","CometTooltipGroup.react","MWChatComposerReplyView.bs","MWChatComposerLastButton.bs","CometOnOutsideClick.react","MWChatFocusComposerContext.bs","useCometInteractionTracing","MWChatComposerActionTrayItems.bs","CometInteractionTracingQuickLogModule","cr:1629297","cr:1628845","cr:1662514"],(function(a,b,c,d,e,f){"use strict";var g,h=b("React"),i={root:{display:"j83agx80",position:"l9j0dhe7",alignItems:"aovydwv3",overflowX:"ni8dbmo4",overflowY:"stjgntxs",backgroundColor:"nred35xi",paddingEnd:"n8tt0mok",paddingStart:"hyh9befq"},aboveActionTray:{transitionProperty:"flx89l3n",transitionDuration:"l9l1gxur"},aboveActionTrayClosed:{transform:"agkhgkm8"},aboveActionTrayOpen:{transform:"brhp5kr4"}};function j(a){}function a(a){var c=a.isPreviewThread,d=a.repliedToMessage,e=a.isTabFocused,f=a.initialComposerViewState,k=a.canSendGif,l=a.canSendFile,m=a.canSendRoom,n=a.canSendAudioClip,o=a.canSendQuickCamAttachment,p=a.canSendPayment,q=a.isGroupThread,r=a.otherUserFbid,s=a.sendMessage,t=a.sendGif,u=a.sendSticker,v=a.sendHotLike,w=a.sendMenuItem,aa=a.sendQuickCamAttachment,ba=a.shouldMinimizeActionsWhenTyping,x=a.logOnOpenStickerFlyout,ca=a.logOnOpenEmojiFlyout,y=a.logOnSelectFileForUpload,da=a.mentionsPlugin,z=a.actionTrayOpen,A=a.openActionTray,B=a.closeActionTray,ea=a.color,fa=a.customLikeEmoji,ga=a.shouldShowMenu,ha=a.pageId,C=a.onFileUploadStart,ia=a.onFileUploadSuccess,ja=a.onAttachmentsChanged,ka=a.fileUploadHandlerRef,D=a.messageRequestInfoText,E=a.onContentsChange,la=a.hasContent,ma=a.onCloseTab,F=a.onTypingStateChanged,G=a.isLocalThread,H=a.threadKey,na=a.onCloseReplyPreview,oa=a.resetComposerRef,I=a.isSubmitting,pa=a.saveState,J=a.createPoll,qa=a.showAudioRecorder,ra=a.hideAudioRecorder,K=a.audioRecorderShown,sa=C!==void 0?C:function(a){},L=h.useRef(null),M=h.useRef(null),N=b("gkx")("1787593"),ta=!b("gkx")("1840608");a=h.useState(function(){return!1});var O=a[1],P=a[0];C=h.useContext(b("MWChatFocusComposerContext.bs").context);var Q=C.setFocusComposer,R=function(a){a=M.current;if(!(a==null))return a.focus()};h.useEffect(function(){b("bs_curry")._1(Q,R)},[Q]);var S=h.useRef(f),T=function(a){a=L.current;S.current=a==null?void 0:b("bs_caml_option").some(a.getViewState())};h.useEffect(function(){return function(a){a=S.current;if(a!==void 0&&H!==void 0)return b("bs_curry")._2(pa,H,b("bs_caml_option").valFromOption(a))}},[]);var U=d!==void 0;h.useEffect(function(){var a=M.current;!(a==null)&&U&&a.focus()},[U]);h.useEffect(function(){var a=M.current;!(a==null)&&e&&!c&&a.focus()},[c]);a=b("MWChatUseLatch.bs").useLatch(b("bs_belt_Option").getWithDefault(F,j),!0,5e3);var V=a[1],W=a[0],X=h.useRef(null),Y=h.useCallback(function(a){a=X.current;if(!(a==null)){b("clearTimeout")(a);return}},[X]);h.useEffect(function(){return Y},[Y]);C=b("MWChatComposerActionTrayItems.bs").useActionTrayItems(q,z,r,k,n,p,l,m,o,aa,qa,B,t,u,H,J,x,y);var Z=C[1],ua=C[0],va=h.useCallback(function(a){!Z&&ba&&b("bs_curry")._1(O,function(b){return a!==""});b("bs_curry")._1(Y,void 0);b("bs_curry")._1(E,a);if(a==="")return b("bs_curry")._1(V,void 0);else return b("bs_curry")._1(W,void 0)},[O,E,W,V]),wa=function(a){a=M.current;a==null||a.focus();return b("bs_curry")._1(sa,void 0)},xa=b("useCometInteractionTracing")(b("CometInteractionTracingQuickLogModule").CHAT_TAB_SEND_MESSAGE,"fast","INTERACTION");F=function(a){if(!I.current)return xa(function(d){d.onComplete(function(a){a=c?"search":"chat";return d.addMetadata("entrypoint",a)});b("bs_curry")._1(s,a);return b("bs_curry")._1(V,void 0)})};var ya=d!==void 0?h.jsx(b("CometPlaceholder.react"),{children:h.jsx("div",{children:h.jsx(b("MWChatComposerReplyView.bs").make,{repliedToMessage:d,onClosePreview:na}),className:(g||(g=b("stylex")))(i.aboveActionTray,z&&!b("gkx")("1620337")?i.aboveActionTrayOpen:i.aboveActionTrayClosed)}),fallback:null}):null,$=e?ea:void 0;a={ref:L,children:function(a){return h.jsx(b("CometOnOutsideClick.react"),{children:function(c){var d;if(b("cr:1629297")==null)d=null;else{var e={actionTrayOpen:z,canSendGif:k,sendGif:t,sendSticker:u,createPoll:J,logOnSelectFileForUpload:y,isLocalThread:G,onPress:function(a){if(z){b("bs_curry")._1(B,void 0);return b("bs_curry")._1(O,function(a){return!1})}else return b("bs_curry")._1(A,void 0)}};$!==void 0&&(e.buttonColor=b("bs_caml_option").valFromOption($));d=h.jsx(b("cr:1629297").make,e)}if(b("cr:1662514")==null||N||!Z)e=null;else{var f={actionTrayOpen:z,hasExtraTrayButtons:Z,setShouldExpandInput:O,shouldExpandInput:P,hideAudioRecorder:ra,closeActionTray:B,openActionTray:A,audioRecorderShown:K,isLocalThread:G};$!==void 0&&(f.buttonColor=b("bs_caml_option").valFromOption($));e=h.jsx(b("cr:1662514").make,f)}f={actionTrayOpen:z,hasExtraTrayButtons:Z,closeActionTray:B,fileUploadHandlerRef:ka,hasContent:la,inputRef:M,canSendGif:k,sendGif:t,sendSticker:u,shouldExpandInput:P,onBlur:function(a){T(void 0);return b("bs_curry")._1(V,void 0)},onContentsChange:va,onEscape:function(a){T(void 0);return b("bs_curry")._1(ma,void 0)},onFileUploadStart:wa,onFileUploadSuccess:ia,onAttachmentsChanged:ja,logOnOpenStickerFlyout:x,logOnOpenEmojiFlyout:ca,logOnSelectFileForUpload:y,audioRecorderShown:K};$!==void 0&&(f.buttonColor=b("bs_caml_option").valFromOption($));var j={customLikeEmoji:fa,onFocusComposer:R,sendHotLike:function(a){return b("bs_curry")._1(v,void 0)},sendMenuItem:w,sendMessage:a,shouldShowMenu:ga,pageId:ha};$!==void 0&&(j.color=b("bs_caml_option").valFromOption($));return h.jsxs("div",{children:[h.jsx(b("MWChatResetComposer.bs").make,{ref:oa}),D!==void 0?h.jsx(b("CometPlaceholder.react"),{children:h.jsx("div",{children:b("bs_caml_option").valFromOption(D),className:(g||(g=b("stylex")))(i.aboveActionTray,z?i.aboveActionTrayOpen:i.aboveActionTrayClosed)}),fallback:null}):null,ya,ta?null:da,!(b("cr:1628845")==null)&&!(N||!Z)?h.jsx(b("cr:1628845").make,{isOpen:z,trayButtons:ua}):null,h.jsxs("div",{children:[h.jsxs(b("CometTooltipGroup.react"),{children:[d,e,h.jsx(b("MWChatComposerInner.bs").make,f)]}),h.jsx(b("MWChatComposerLastButton.bs").make,j)],className:(g||(g=b("stylex")))(i.root)})],ref:c})},onOutsideClick:function(a){return b("bs_curry")._1(O,function(a){return!1})}})},onBeforeViewStateChange:function(a){if(I.current&&!b("MWChatComposerUtil.bs").hasContent(a.editorState)){I.current=!1;return}},onSubmitCommit:F,registerOnBeforeUnload:!1};f!==void 0&&(a.beginningViewState=b("bs_caml_option").valFromOption(f));return h.jsx(b("CometComposer.react"),a)}c=a;f.styles=i;f.noOp=j;f.$MWWorkChatComposerToggleActionMenuButton$OR$null$requireCond=b("cr:1629297");f.$null$OR$MWChatComposerActionTray$requireCond=b("cr:1628845");f.$null$OR$MWChatComposerActionsToggle$requireCond=b("cr:1662514");f.make=c}),null);
__d("MWChatComposerMentionsTypeaheadListItem.react",["CometImageIcon.react","CometSearchMentionsBaseViewItem.react","React","TetraTextPairing.react","stylex"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var c=a.entry;a=babelHelpers.objectWithoutPropertiesLoose(a,["entry"]);var d=c.getLabel(),e=c.getSublabel(),f=c.getPhotoURI();return g.jsx(b("CometSearchMentionsBaseViewItem.react"),babelHelpers["extends"]({},a,{entry:c,children:g.jsxs("div",{className:"b38knevg j83agx80 bp9cbjyn",children:[f!=null&&g.jsx("div",{className:"ciadx1gn mudddibn",children:g.jsx(b("CometImageIcon.react"),{size:28,src:f,style:"circle"})}),g.jsx("div",{className:"ozuftl9m",children:g.jsx(b("TetraTextPairing.react"),{body:d,bodyLineLimit:1,level:3,meta:e,metaLineLimit:1})})]})}))}}),null);
__d("MWUICurrentThreadParticipants.re",["bs_curry","MWUICurrentThreadParticipants.bs"],(function(a,b,c,d,e,f){a=function(){var a=b("MWUICurrentThreadParticipants.bs").useMercuryParticipants();return[a[0],a[1],function(c,d){c=b("bs_curry")._2(a[2],c,d==null?void 0:d);return c}]};f.useMercuryParticipants=a;c=b("MWUICurrentThreadParticipants.bs").useParticipants;f.useParticipants=c}),null);
__d("MWChatComposerMentionsTypeaheadEntry",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a}var b=a.prototype;b.getRawData=function(){return this.$1};b.getKey=function(){return this.$1.key};b.getLabel=function(){return this.$1.title};b.getSublabel=function(){return this.$1.subtitle};b.getPhotoURI=function(){return this.$1.photoURI};b.isFromNickname=function(){return this.$1.source==="nickname"};return a}();e.exports=a}),null);
/**
 * License: https://www.facebook.com/legal/license/MDzNl_j9yvg/
 */
__d("remove-accents-0.4.2",[],(function(a,b,c,d,e,f){"use strict";b={};var g={exports:b};function h(){var a={"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\u1ea4":"A","\u1eae":"A","\u1eb2":"A","\u1eb4":"A","\u1eb6":"A","\xc6":"AE","\u1ea6":"A","\u1eb0":"A","\u0202":"A","\xc7":"C","\u1e08":"C","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\u1ebe":"E","\u1e16":"E","\u1ec0":"E","\u1e14":"E","\u1e1c":"E","\u0206":"E","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\u1e2e":"I","\u020a":"I","\xd0":"D","\xd1":"N","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\u1ed0":"O","\u1e4c":"O","\u1e52":"O","\u020e":"O","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xdd":"Y","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\u1ea5":"a","\u1eaf":"a","\u1eb3":"a","\u1eb5":"a","\u1eb7":"a","\xe6":"ae","\u1ea7":"a","\u1eb1":"a","\u0203":"a","\xe7":"c","\u1e09":"c","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\u1ebf":"e","\u1e17":"e","\u1ec1":"e","\u1e15":"e","\u1e1d":"e","\u0207":"e","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\u1e2f":"i","\u020b":"i","\xf0":"d","\xf1":"n","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\u1ed1":"o","\u1e4d":"o","\u1e53":"o","\u020f":"o","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xfd":"y","\xff":"y","\u0100":"A","\u0101":"a","\u0102":"A","\u0103":"a","\u0104":"A","\u0105":"a","\u0106":"C","\u0107":"c","\u0108":"C","\u0109":"c","\u010a":"C","\u010b":"c","\u010c":"C","\u010d":"c","C\u0306":"C","c\u0306":"c","\u010e":"D","\u010f":"d","\u0110":"D","\u0111":"d","\u0112":"E","\u0113":"e","\u0114":"E","\u0115":"e","\u0116":"E","\u0117":"e","\u0118":"E","\u0119":"e","\u011a":"E","\u011b":"e","\u011c":"G","\u01f4":"G","\u011d":"g","\u01f5":"g","\u011e":"G","\u011f":"g","\u0120":"G","\u0121":"g","\u0122":"G","\u0123":"g","\u0124":"H","\u0125":"h","\u0126":"H","\u0127":"h","\u1e2a":"H","\u1e2b":"h","\u0128":"I","\u0129":"i","\u012a":"I","\u012b":"i","\u012c":"I","\u012d":"i","\u012e":"I","\u012f":"i","\u0130":"I","\u0131":"i","\u0132":"IJ","\u0133":"ij","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u1e30":"K","\u1e31":"k","K\u0306":"K","k\u0306":"k","\u0139":"L","\u013a":"l","\u013b":"L","\u013c":"l","\u013d":"L","\u013e":"l","\u013f":"L","\u0140":"l","\u0141":"l","\u0142":"l","\u1e3e":"M","\u1e3f":"m","M\u0306":"M","m\u0306":"m","\u0143":"N","\u0144":"n","\u0145":"N","\u0146":"n","\u0147":"N","\u0148":"n","\u0149":"n","N\u0306":"N","n\u0306":"n","\u014c":"O","\u014d":"o","\u014e":"O","\u014f":"o","\u0150":"O","\u0151":"o","\u0152":"OE","\u0153":"oe","P\u0306":"P","p\u0306":"p","\u0154":"R","\u0155":"r","\u0156":"R","\u0157":"r","\u0158":"R","\u0159":"r","R\u0306":"R","r\u0306":"r","\u0212":"R","\u0213":"r","\u015a":"S","\u015b":"s","\u015c":"S","\u015d":"s","\u015e":"S","\u0218":"S","\u0219":"s","\u015f":"s","\u0160":"S","\u0161":"s","\u0162":"T","\u0163":"t","\u021b":"t","\u021a":"T","\u0164":"T","\u0165":"t","\u0166":"T","\u0167":"t","T\u0306":"T","t\u0306":"t","\u0168":"U","\u0169":"u","\u016a":"U","\u016b":"u","\u016c":"U","\u016d":"u","\u016e":"U","\u016f":"u","\u0170":"U","\u0171":"u","\u0172":"U","\u0173":"u","\u0216":"U","\u0217":"u","V\u0306":"V","v\u0306":"v","\u0174":"W","\u0175":"w","\u1e82":"W","\u1e83":"w","X\u0306":"X","x\u0306":"x","\u0176":"Y","\u0177":"y","\u0178":"Y","Y\u0306":"Y","y\u0306":"y","\u0179":"Z","\u017a":"z","\u017b":"Z","\u017c":"z","\u017d":"Z","\u017e":"z","\u017f":"s","\u0192":"f","\u01a0":"O","\u01a1":"o","\u01af":"U","\u01b0":"u","\u01cd":"A","\u01ce":"a","\u01cf":"I","\u01d0":"i","\u01d1":"O","\u01d2":"o","\u01d3":"U","\u01d4":"u","\u01d5":"U","\u01d6":"u","\u01d7":"U","\u01d8":"u","\u01d9":"U","\u01da":"u","\u01db":"U","\u01dc":"u","\u1ee8":"U","\u1ee9":"u","\u1e78":"U","\u1e79":"u","\u01fa":"A","\u01fb":"a","\u01fc":"AE","\u01fd":"ae","\u01fe":"O","\u01ff":"o","\xde":"TH","\xfe":"th","\u1e54":"P","\u1e55":"p","\u1e64":"S","\u1e65":"s","X\u0301":"X","x\u0301":"x","\u0403":"\u0413","\u0453":"\u0433","\u040c":"\u041a","\u045c":"\u043a","A\u030b":"A","a\u030b":"a","E\u030b":"E","e\u030b":"e","I\u030b":"I","i\u030b":"i","\u01f8":"N","\u01f9":"n","\u1ed2":"O","\u1ed3":"o","\u1e50":"O","\u1e51":"o","\u1eea":"U","\u1eeb":"u","\u1e80":"W","\u1e81":"w","\u1ef2":"Y","\u1ef3":"y","\u0200":"A","\u0201":"a","\u0204":"E","\u0205":"e","\u0208":"I","\u0209":"i","\u020c":"O","\u020d":"o","\u0210":"R","\u0211":"r","\u0214":"U","\u0215":"u","B\u030c":"B","b\u030c":"b","\u010c\u0323":"C","\u010d\u0323":"c","\xca\u030c":"E","\xea\u030c":"e","F\u030c":"F","f\u030c":"f","\u01e6":"G","\u01e7":"g","\u021e":"H","\u021f":"h","J\u030c":"J","\u01f0":"j","\u01e8":"K","\u01e9":"k","M\u030c":"M","m\u030c":"m","P\u030c":"P","p\u030c":"p","Q\u030c":"Q","q\u030c":"q","\u0158\u0329":"R","\u0159\u0329":"r","\u1e66":"S","\u1e67":"s","V\u030c":"V","v\u030c":"v","W\u030c":"W","w\u030c":"w","X\u030c":"X","x\u030c":"x","Y\u030c":"Y","y\u030c":"y","A\u0327":"A","a\u0327":"a","B\u0327":"B","b\u0327":"b","\u1e10":"D","\u1e11":"d","\u0228":"E","\u0229":"e","\u0190\u0327":"E","\u025b\u0327":"e","\u1e28":"H","\u1e29":"h","I\u0327":"I","i\u0327":"i","\u0197\u0327":"I","\u0268\u0327":"i","M\u0327":"M","m\u0327":"m","O\u0327":"O","o\u0327":"o","Q\u0327":"Q","q\u0327":"q","U\u0327":"U","u\u0327":"u","X\u0327":"X","x\u0327":"x","Z\u0327":"Z","z\u0327":"z"},b=Object.keys(a).join("|"),c=new RegExp(b,"g"),d=new RegExp(b,"");b=function(b){return b.replace(c,function(b){return a[b]})};var e=function(a){return!!a.match(d)};g.exports=b;g.exports.has=e;g.exports.remove=b}var i=!1;function j(){i||(i=!0,h());return g.exports}function a(a){switch(a){case void 0:return j()}}e.exports=a}),null);
__d("remove-accents",["remove-accents-0.4.2"],(function(a,b,c,d,e,f){e.exports=b("remove-accents-0.4.2")()}),null);
__d("MWChatComposerMentionsTypeaheadDataSource",["fbt","Promise","CurrentUser","MWChatComposerMentionsTypeaheadEntry","gkx","remove-accents"],(function(a,b,c,d,e,f,g){"use strict";var h=6;a=function(){function a(a,c){this.$1=[],this.$1=Array.from(a.values()).filter(function(a){return a.contactId!==b("CurrentUser").getID()}),this.$2=c}var c=a.prototype;c.bootstrap=function(){return};c.fetchCache=function(a){var c=this,d=a.query,e=[];this.$1.forEach(function(a){var f=a.actualName,g=a.contactId,h=a.nickname;a=a.profilePictureUrl;var i=null;c.$3(f,d)?i="name":h!=null&&c.$3(h,d)&&(i="nickname");i!=null&&a!=null&&e.push(new(b("MWChatComposerMentionsTypeaheadEntry"))({key:g+" "+i,photoURI:a,source:i,subtitle:h,title:f}))});if(b("gkx")("1608686")){var f=g._("todos").toString();if(this.$3(f,d)){var i=g._("Menciona a todas las personas de este chat").toString();e.push(new(b("MWChatComposerMentionsTypeaheadEntry"))({key:""+this.$2,photoURI:null,source:"all",subtitle:i,title:f}))}i=g._("aqu\u00ed").toString();if(this.$3(i,d)){f=g._("Menciona a todas las personas de este chat que est\u00e9n activas").toString();e.push(new(b("MWChatComposerMentionsTypeaheadEntry"))({key:this.$2+"-active",photoURI:null,source:"all",subtitle:f,title:i}))}}e.length>h&&(e=e.slice(0,h));return{entries:e,params:a}};c.fetchNetwork=function(a){return b("Promise").resolve(this.fetchCache(a))};c.$3=function(a,c){if(c.length===0)return!0;var d=b("remove-accents")(c).toLowerCase();c=b("remove-accents")(a).toLowerCase();return c.split(" ").some(function(a){return a.startsWith(d)})||c.startsWith(d)};return a}();e.exports=a}),null);
__d("useMWChatMentionsStrategyResolver",["MWChatComposerMentionsTypeaheadDataSource","createCometAtSignComposerMentionStrategy","useCometMentionsStrategyResolver"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a){var c=a.participants;a=a.threadFBID;return b("useCometMentionsStrategyResolver")([{dataSource:new(b("MWChatComposerMentionsTypeaheadDataSource"))(c,a),searchStrategy:b("createCometAtSignComposerMentionStrategy")({minMatchLength:0})}])}}),null);
__d("MWChatComposerMentionsPlugin.react",["CometComposerMentionsPlugin.react","MWChatComposerMentionsTypeaheadListItem.react","MWThread_DEPRECATED.re","MWUICurrentThreadParticipants.re","React","createCometComposerMentionsEntity","getCometComposerMentionsSearch","useMWChatMentionsStrategyResolver","withComposerViewStatePart"],(function(a,b,c,d,e,f){"use strict";var g=b("React");function a(a){a=a.currentBlockKey;var c=b("MWThread_DEPRECATED.re").useFBID(),d=b("MWUICurrentThreadParticipants.re").useParticipants();d=b("useMWChatMentionsStrategyResolver")({participants:d,threadFBID:c});c=g.useCallback(function(a){var b=a.getSublabel();return a.isFromNickname()&&b!=null?"@"+b:"@"+a.getLabel()},[]);var e=g.useCallback(function(a,c){return b("createCometComposerMentionsEntity")(c.getKey(),!1,a)},[]);return g.jsx(b("CometComposerMentionsPlugin.react"),{currentBlockKey:a,getReplacementString:c,getSearchText:b("getCometComposerMentionsSearch"),onMentionCreateContentState:e,priority:1,strategyResolver:d,viewItemStrategyRenderer:b("MWChatComposerMentionsTypeaheadListItem.react")})}c=b("withComposerViewStatePart")(a,function(a){a=a==null?void 0:a.editorState;a=a!=null&&a.__type==="editor-state-based"?a.draftEditorState:null;return{currentBlockKey:a!=null?a.getSelection().getStartKey():null}});e.exports=c}),null);
__d("MWChatComposerMentionsPlugin.re",["MWChatComposerMentionsPlugin.react"],(function(a,b,c,d,e,f){a=b("MWChatComposerMentionsPlugin.react");f.makeTypeChecked=a;c=a;f.make=c}),null);
__d("MWChatFileUploadErrorDialog.bs",["fbt"],(function(a,b,c,d,e,f,g){"use strict";a={body:g._("El archivo que seleccionaste es demasiado grande. El tama\u00f1o m\u00e1ximo es de 25 MB."),title:g._("Error al subir los archivos")};f.maxFileSizeExceeded=a}),null);
__d("MWChatComposerUploadFileHook.bs",["URI","bs_curry","React","ActorURI","bs_belt_Array","bs_caml_array","bs_caml_option","CurrentUser","MercuryConfig","MercuryConstants","useCometAlertDialog","recoverableViolation","CometComposerViewState.bs","XComposerPhotoUploader","MWChatFileUploadErrorDialog.bs","CometComposerViewStateActions.bs"],(function(a,b,c,d,e,f){"use strict";var g,h=b("React");function i(a,c,d,e,f){return new(b("XComposerPhotoUploader"))({concurrentLimit:3,onUploadFailure:function(a,c){a=c.response.getError();var d=c.response.getErrorSummary();c=c.response.getErrorDescriptionString();if(a!==0&&!(d==null)&&!(c==null)){b("bs_curry")._2(f,d,c);return!1}else return!0},onUploadProgress:function(a,b){},onUploadStart:function(a){b("bs_curry")._1(c,b("CometComposerViewStateActions.bs").convert({NAME:"MediaUploadStarted",VAL:a}));return b("bs_curry")._1(d,a)},onUploadSuccess:function(a,d){var f=d.upload.getFile();d=b("bs_caml_array").get(d.response.payload.metadata,0);var g=d.fbid,h=d.video_id,i=d.audio_id,j=d.gif_id;d=d.file_id;g=g!==void 0?b("bs_caml_option").some(b("bs_caml_option").valFromOption(g)):h!==void 0?b("bs_caml_option").some(b("bs_caml_option").valFromOption(h)):i!==void 0?b("bs_caml_option").some(b("bs_caml_option").valFromOption(i)):j!==void 0?b("bs_caml_option").some(b("bs_caml_option").valFromOption(j)):d!==void 0?b("bs_caml_option").some(b("bs_caml_option").valFromOption(d)):void 0;if(g!==void 0){h=b("bs_caml_option").valFromOption(g);b("bs_curry")._1(c,b("CometComposerViewStateActions.bs").convert({NAME:"MediaUploadSuccessful",VAL:[h,a]}));return b("bs_curry")._3(e,f,a,h)}b("recoverableViolation")("Unrecognized file upload success payload","messenger_comet")},retryLimit:1,uploadEndpoint:new(b("ActorURI").create)(new(g||(g=b("URI")))(b("MercuryConfig").upload_url),a)})}function j(a,c,d,e){var f=b("bs_belt_Array").keepMap(c.map(b("CometComposerViewState.bs").MediaAttachment.fromJS),function(a){if(a.TAG)return;else return b("bs_caml_option").some(a._1)});if(f.length<=0)return;var g=f.some(function(a){return a.size>b("MercuryConstants").AttachmentMaxSize});if(g){c.forEach(function(a){return b("bs_curry")._1(d,b("CometComposerViewStateActions.bs").convert({NAME:"RemoveMediaAttachmentItem",VAL:a}))});return b("bs_curry")._2(e,b("MWChatFileUploadErrorDialog.bs").maxFileSizeExceeded,function(a){})}else{b("bs_curry")._1(d,b("CometComposerViewStateActions.bs").convert({NAME:"QueueUploads",VAL:b("bs_belt_Array").keepMap(f,function(a){return b("bs_caml_option").nullable_to_opt(a.uploadID)})}));a.getAsyncUploadRequest(f,void 0).send();return}}function a(a){a=b("useCometAlertDialog")();var c=a[0],d=function(a,d){return b("bs_curry")._2(c,{body:d,title:a},function(a){})},e=b("CurrentUser").getID();return h.useCallback(function(a){return function(f,g,h){if(a!==void 0&&a.some(function(a){return b("CometComposerViewState.bs").MediaAttachment.stateJS(a)==="NEW"}))return j(i(e,f,g,h,d),a,f,c)}},[e])}f.createUploader=i;f.uploadAttachments=j;f.useHook=a}),null);
__d("MWChatProfileRange.bs",["FBID.bs","gkx","MessageProfileRangeType"],(function(a,b,c,d,e,f){"use strict";function a(a,c){var d=[],e={contents:0};c.getBlockMap().forEach(function(f,g,h){g=f.getText();f.findEntityRanges(function(a){return!0},function(g,h){var i=f.getEntityAt(g);if(i==null)return;i=c.getEntity(i);if(i.getType()!=="MENTION")return;var j=g+e.contents|0;i=i.getData().id.split(" ")[0];if(i===a&&b("gkx")("1608686")){d.push({id:a,offset:j,length:h-g|0,type:b("MessageProfileRangeType").THREAD});return}else if(i===a+"-active"&&b("gkx")("1608686")){d.push({id:a,offset:j,length:h-g|0,type:b("MessageProfileRangeType").THREAD_ACTIVE});return}else if(/^\d+$/.test(i)){d.push({id:b("FBID.bs").ofStringExn(i),offset:j,length:h-g|0,type:b("MessageProfileRangeType").PROFILE});return}else return});e.contents=(e.contents+g.length|0)+1|0});return d}f.getFromContentState=a}),null);
__d("MWUIMediaSendManager.bs",["requireCond","cr:1454163"],(function(a,b,c,d,e,f){"use strict";a=b("cr:1454163");f.$MWLSMediaSendManagerProvider$OR$MWMSMediaSendManagerProvider$requireCond=b("cr:1454163");f.Provider=a}),null);
__d("MWUISendAudioMessage.bs",["requireCond","cr:1683390"],(function(a,b,c,d,e,f){"use strict";a=b("cr:1683390").useMessage;f.$MWLSSendAudioMessage$OR$MWMSSendAudioMessage$requireCond=b("cr:1683390");f.useMessage=a}),null);
__d("MWUISendFileMessage.bs",["requireCond","cr:1451092"],(function(a,b,c,d,e,f){"use strict";a=b("cr:1451092").useSendFileMessage;f.$MWLSSendFileMessage$OR$MWMSSendAttachments$requireCond=b("cr:1451092");f.useSendFileMessage=a}),null);
__d("MWUISendGifMessage.bs",["requireCond","cr:1429241"],(function(a,b,c,d,e,f){"use strict";a=b("cr:1429241").useSendGifMessage;f.$MWLSSendGifMessage$OR$MWMSSendGIFMessage$requireCond=b("cr:1429241");f.useSendGifMessage=a}),null);
__d("MWChatComposer.bs",["Promise","ODS","bs_curry","React","gkx","uniqueID","bs_belt_Array","bs_caml_option","promiseDone","MWPollsHooks.bs","MWUIChatTabState.bs","MWUICreateThread.bs","MWUISendMenuItem.bs","StickerConstants","MessengerWebEvent","MWChatComposerBase.bs","MWChatComposerUtil.bs","MWChatProfileRange.bs","MWUISendGifMessage.bs","MWThread_DEPRECATED.bs","MWUISendFileMessage.bs","MWUISendTextMessage.bs","MWUIMediaSendManager.bs","MWUISendAudioMessage.bs","MWChatUploadAudioHook.bs","CometComposerViewState.bs","MWUISendStickerMessage.bs","MWUIThreadCapabilities.bs","unrecoverableViolation","MWChatComposerUploadFileHook.bs","MWChatComposerViewStateStore.bs","MessengerWebStgTypedLoggerLite.bs","MWChatComposerMentionsPlugin.re","getPlainTextFromDeferredDraftEditorState"],(function(a,b,c,d,e,f){"use strict";var g=b("React");function h(a){var c=a.color,d=a.otherUserFbid,e=a.customLikeEmoji,f=a.isTabFocused,h=a.isPreviewThread,i=a.onFileUploadStart,j=a.shouldShowMenu,k=a.shouldMinimizeActionsWhenTyping,l=a.hasContent,m=a.repliedToMessage,n=a.actionTrayOpen,o=a.closeActionTray,p=a.openActionTray,q=a.initialComposerViewState,r=a.fileUploadHandlerRef,s=a.hardResetComposer,t=a.onContentsChange,u=a.messageRequestInfoText,v=a.onTypingStateChanged,w=a.closeReplyPreview,x=a.openTabFromPreview,y=a.closeTab,z=a.onSendMessage;a=a.isOptimisticThread;a=a!==void 0?a:!1;var A=g.useRef(null),B=g.useRef(!1),C=b("bs_curry")._2(b("MWUISendTextMessage.bs").useSendTextMessage,a,void 0),D=b("bs_curry")._1(b("MWUISendGifMessage.bs").useSendGifMessage,void 0),E=b("bs_curry")._1(b("MWUISendStickerMessage.bs").useSendStickerMessage,void 0),F=b("bs_curry")._1(b("MWUISendMenuItem.bs").useSendMenuItem,void 0);a=b("bs_curry")._2(b("MWUISendFileMessage.bs").useSendFileMessage,m,z);var G=a[1],H=a[0],I=b("MWChatUploadAudioHook.bs").useHook(void 0);a=b("bs_curry")._1(b("MWUISendAudioMessage.bs").useMessage,void 0);var J=a[1],K=a[0];a=g.useState(function(){return!1});var L=a[1],M=b("bs_curry")._1(b("MWPollsHooks.bs").useCreatePoll,void 0),N=b("MWThread_DEPRECATED.bs").useId(void 0),O=b("bs_curry")._1(b("MWUIThreadCapabilities.bs").useCapabilities,void 0),P=b("MWUIChatTabState.bs").useLookupThreadHook(void 0),Q=b("MWUIChatTabState.bs").useTab(void 0),R=b("MWUIChatTabState.bs").useTokenProvider(void 0),S=b("bs_curry")._1(b("MWUICreateThread.bs").useHook,"comet_create_group"),T=function(a){if(Q)return b("Promise").resolve(Q._0);var c=b("bs_curry")._1(R,void 0);a=c.length;if(a!==1)if(a!==0)return P(c).then(function(a){if(a!==void 0)return b("Promise").resolve(a);else return b("bs_curry")._2(S,c,void 0).then(function(a){return b("Promise").resolve({NAME:"Group",VAL:a})})});else return b("Promise").reject(b("unrecoverableViolation")("Expected tokens","messenger_web_product"));a=c[0];return b("Promise").resolve({NAME:"User",VAL:a})},U=function(a){b("bs_curry")._1(L,function(a){return!1});a=A.current;a==null?b("bs_curry")._1(s,void 0):a.reset();return b("bs_curry")._1(w,void 0)},V=function(a){b("bs_curry")._1(L,function(a){return!0});return b("bs_curry")._1(o,void 0)},W=function(a){b("ODS").bumpEntityKey(3185,"mwchat_send","text");B.current=!0;b("promiseDone")(T(void 0),function(c){var d;if(typeof c==="string")d=[];else if(c.NAME==="Group"){var e=a.editorState.draftEditorState;d=e!==void 0?b("MWChatProfileRange.bs").getFromContentState(c.VAL,b("bs_caml_option").valFromOption(e).getCurrentContent()):[]}else d=[];e=b("MWChatComposerUtil.bs").hasContent(a.editorState)?b("getPlainTextFromDeferredDraftEditorState")(a.editorState):void 0;var f=a.mediaAttachments;d=d.length===0?void 0:d;var g=a.audioClip,h;if(!(g==null)){var i=g.file;g=g.duration;g=b("bs_curry")._3(K,c,i,g).then(function(a){var c=a[1],d=a[0];b("bs_curry")._2(I,i,function(a){return b("bs_curry")._3(J,d,c,a)});return b("Promise").resolve(void 0)});b("promiseDone")(g,void 0,void 0);return}if(e!==void 0)f==null||f.length===0?(h=e,g=2):g=1;else{if(f==null){b("bs_curry")._1(z,c);return b("bs_curry")._1(x,void 0)}g=1}switch(g){case 1:g=f.map(b("CometComposerViewState.bs").MediaAttachment.fromJS);b("bs_curry")._4(H,c,e,d,g);f=g.reduce(function(a,b){b=b.TAG===3?1:0;return a+b|0},0);e=g.map(function(a){return b("CometComposerViewState.bs").MediaAttachment.file(a).name});var j=b("bs_belt_Array").keepMap(g,function(a){return b("bs_caml_option").nullable_to_opt(b("CometComposerViewState.bs").MediaAttachment.file(a).uploadID)}),k=b("bs_belt_Array").keepMap(g,function(a){if(a.TAG===3)return a._2.id}),l=N!==void 0&&!(typeof N==="string"||N.NAME!=="Group")?N.VAL:null;if(N!==void 0&&typeof N!=="string"){var n=N.NAME;n=n==="User"||n==="Page"?N.VAL:null}else n=null;return b("MessengerWebStgTypedLoggerLite.bs").log({event_name:f===g.length?b("MessengerWebEvent").HIT_SEND_MESSAGE_WITH_ALL_FILES_UPLOADED:b("MessengerWebEvent").HIT_SEND_MESSAGE_WITH_FILES_PENDING,other_user_fbid:n,thread_fbid:l,extra_data:{attachment_names:e,attachment_upload_ids:j,attachment_fbids:k}});case 2:b("bs_curry")._4(C,c,h,d,m);b("bs_curry")._1(z,c);return b("bs_curry")._1(x,void 0)}});return U(void 0)},X=function(a){},Y=b("bs_curry")._1(b("MWUIThreadCapabilities.bs").canSendGif,O),Z=b("bs_curry")._1(b("MWUIThreadCapabilities.bs").canSendPayment,O),aa=b("bs_curry")._1(b("MWUIThreadCapabilities.bs").canCreatePoll,O),$=b("bs_curry")._1(b("MWUIThreadCapabilities.bs").canSendFile,O),ba=b("bs_curry")._1(b("MWUIThreadCapabilities.bs").canSendRoom,O),ca=b("bs_curry")._1(b("MWUIThreadCapabilities.bs").canSendAudioClip,O);O=b("bs_curry")._1(b("MWUIThreadCapabilities.bs").canSendQuickCamAttachment,O);$=$&&!b("gkx")("1787589");var da=N!==void 0&&typeof N!=="string"?N.NAME==="Group":!1,ea=N===void 0,fa=N!==void 0&&!(typeof N==="string"||N.NAME!=="Group")?g.jsx(b("MWChatComposerMentionsPlugin.re").make,{}):null,ga=function(a){if(N!==void 0&&typeof N!=="string"){a=N.NAME;a=a==="User"||a==="Page"?N.VAL:null}else a=null;return b("MessengerWebStgTypedLoggerLite.bs").log({event_name:b("MessengerWebEvent").OPEN_STICKER_FLYOUT,other_user_fbid:a,thread_fbid:N!==void 0&&!(typeof N==="string"||N.NAME!=="Group")?N.VAL:null})},ha=function(a){if(N!==void 0&&typeof N!=="string"){a=N.NAME;a=a==="User"||a==="Page"?N.VAL:null}else a=null;return b("MessengerWebStgTypedLoggerLite.bs").log({event_name:b("MessengerWebEvent").OPEN_EMOJI_FLYOUT,other_user_fbid:a,thread_fbid:N!==void 0&&!(typeof N==="string"||N.NAME!=="Group")?N.VAL:null})},ia=function(a){if(N!==void 0&&typeof N!=="string"){var c=N.NAME;c=c==="User"||c==="Page"?N.VAL:null}else c=null;return b("MessengerWebStgTypedLoggerLite.bs").log({event_name:b("MessengerWebEvent").SELECT_FILE_FOR_UPLOAD,other_user_fbid:c,thread_fbid:N!==void 0&&!(typeof N==="string"||N.NAME!=="Group")?N.VAL:null,extra_data:{attachment_names:a.map(function(a){return a.name})}})},ja=b("MWChatComposerUploadFileHook.bs").useHook(void 0);h={isPreviewThread:h,repliedToMessage:m,isTabFocused:f,canSendGif:Y,canSendFile:$,canSendRoom:ba,canSendAudioClip:ca,canSendQuickCamAttachment:O,canSendPayment:Z,isGroupThread:da,otherUserFbid:d,sendMessage:W,sendGif:function(a){b("ODS").bumpEntityKey(3185,"mwchat_send","gif");b("promiseDone")(T(void 0),function(c){b("bs_curry")._3(D,c,a,m);return b("bs_curry")._1(z,c)});return b("bs_curry")._1(w,void 0)},sendSticker:function(a,c,d){var e=d.uri;b("ODS").bumpEntityKey(3185,"mwchat_send","sticker");b("promiseDone")(T(void 0),function(c){b("bs_curry")._4(E,c,a,m,e);return b("bs_curry")._1(z,c)});return b("bs_curry")._1(w,void 0)},sendHotLike:function(a){b("ODS").bumpEntityKey(3185,"mwchat_send","hot_like");b("promiseDone")(T(void 0),function(a){e!==void 0&&e!==""?b("bs_curry")._4(C,a,e,void 0,m):b("bs_curry")._4(E,a,b("StickerConstants").HOT_LIKE_SMALL_STICKER_ID,m,void 0);return b("bs_curry")._1(z,a)});return b("bs_curry")._1(w,void 0)},sendMenuItem:function(a){b("ODS").bumpEntityKey(3185,"mwchat_send","postback");b("promiseDone")(T(void 0),function(c){return b("bs_curry")._3(F,c,a.title,a.id)});return b("bs_curry")._1(w,void 0)},sendQuickCamAttachment:X,shouldMinimizeActionsWhenTyping:k,logOnOpenStickerFlyout:ga,logOnOpenEmojiFlyout:ha,logOnSelectFileForUpload:ia,mentionsPlugin:fa,actionTrayOpen:n,openActionTray:p,closeActionTray:o,color:c,customLikeEmoji:e,shouldShowMenu:j,pageId:N!==void 0&&!(typeof N==="string"||N.NAME!=="Page")?b("bs_caml_option").some(N.VAL):void 0,onFileUploadStart:i,onFileUploadSuccess:function(a,c,d){b("bs_curry")._2(G,c,d);if(N!==void 0&&typeof N!=="string"){var e=N.NAME;e=e==="User"||e==="Page"?N.VAL:null}else e=null;return b("MessengerWebStgTypedLoggerLite.bs").log({event_name:b("MessengerWebEvent").UPLOAD_FILE_SUCCESS,other_user_fbid:e,thread_fbid:N!==void 0&&!(typeof N==="string"||N.NAME!=="Group")?N.VAL:null,extra_data:{attachment_names:[a.name],attachment_upload_ids:[c],attachment_fbids:[d]}})},onAttachmentsChanged:ja,fileUploadHandlerRef:r,onContentsChange:t,hasContent:l,onCloseTab:y,isLocalThread:ea,threadKey:N!==void 0?N:void 0,onCloseReplyPreview:w,resetComposerRef:A,isSubmitting:B,saveState:function(a,c){if(b("getPlainTextFromDeferredDraftEditorState")(c.editorState).length>0)return b("MWChatComposerViewStateStore.bs").set(a,b("bs_caml_option").some(c))},createPoll:aa?function(a,c){b("ODS").bumpEntityKey(3185,"mwchat_send","sticker"),b("promiseDone")(T(void 0),function(d){return b("bs_curry")._3(M,d,a,c)})}:void 0,showAudioRecorder:V,hideAudioRecorder:U,audioRecorderShown:a[0]};q!==void 0&&(h.initialComposerViewState=b("bs_caml_option").valFromOption(q));u!==void 0&&(h.messageRequestInfoText=b("bs_caml_option").valFromOption(u));v!==void 0&&(h.onTypingStateChanged=b("bs_caml_option").valFromOption(v));return g.jsx(b("MWChatComposerBase.bs").make,h)}c={make:h};function a(a){var c=a.color,d=a.otherUserFbid,e=a.isPreviewThread,f=a.isOptimisticThread,i=a.shouldMinimizeActionsWhenTyping,j=a.customLikeEmoji,k=a.isTabFocused,l=a.shouldShowMenu,m=a.hasContent,n=a.repliedToMessage,o=a.actionTrayOpen,p=a.closeActionTray,q=a.onContentsChange,r=a.onFileUploadStart,s=a.openActionTray,t=a.initialComposerViewState,u=a.fileUploadHandlerRef,v=a.messageRequestInfoText,w=a.onTypingStateChanged,x=a.closeReplyPreview,y=a.openTabFromPreview,z=a.closeTab;a=a.onSendMessage;e=e!==void 0?e:!1;f=f!==void 0?f:!1;i=i!==void 0?i:!0;q=q!==void 0?q:function(a){};r=r!==void 0?r:function(a){};var A=g.useState(function(){return b("uniqueID")()}),B=A[1];c={color:c,otherUserFbid:d,customLikeEmoji:j,isTabFocused:k,isPreviewThread:e,onFileUploadStart:r,shouldShowMenu:l,shouldMinimizeActionsWhenTyping:i,hasContent:m,repliedToMessage:n,actionTrayOpen:o,closeActionTray:p,openActionTray:s,fileUploadHandlerRef:u,hardResetComposer:function(a){return b("bs_curry")._1(B,function(a){return b("uniqueID")()})},onContentsChange:q,closeReplyPreview:x,openTabFromPreview:y,closeTab:z,onSendMessage:a,isOptimisticThread:f};t!==void 0&&(c.initialComposerViewState=b("bs_caml_option").valFromOption(t));v!==void 0&&(c.messageRequestInfoText=b("bs_caml_option").valFromOption(v));w!==void 0&&(c.onTypingStateChanged=b("bs_caml_option").valFromOption(w));return g.jsx(b("MWUIMediaSendManager.bs").Provider.make,b("bs_curry")._2(b("MWUIMediaSendManager.bs").Provider.makeProps,g.jsx(h,c,A[0]),void 0))}d=a;f.MWChatComposer=c;f.make=d}),null);
__d("MWChatUserComposer.bs",["bs_curry","React","MWChatBlockedComposer.bs","MWUIParticipantDetails.bs"],(function(a,b,c,d,e,f){"use strict";var g=b("React");function h(a){var c=a.fbid;a=a.chatComposer;var d=b("bs_curry")._1(b("MWUIParticipantDetails.bs").useParticipantReachabilityStatus,c);if(d)return b("bs_curry")._1(a,void 0);else return g.jsx(b("MWChatBlockedComposer.bs").make,{fbid:c,reportingToken:void 0,isReachable:!1})}c={make:h};function a(a){var c=a.threadId;a=a.chatComposer;if(typeof c==="string"||c.NAME!=="User")return b("bs_curry")._1(a,void 0);else return g.jsx(h,{fbid:c.VAL,chatComposer:a})}d=a;f.UserChatThreadWithBlockedComposer=c;f.make=d}),null);
__d("LsBusinessWelcomePageGetStartedButtonTappedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1743846");c=b("FalcoLoggerInternal").create("ls_business_welcome_page_get_started_button_tapped",a);e.exports=c}),null);
__d("EmojiLikeConstants",["EmojiStaticConfig"],(function(a,b,c,d,e,f){"use strict";a=b("EmojiStaticConfig").sizeMap;f.sizeMap=a;c=Object.freeze({XSMALL:"xsmall",SMALL:"small",MEDIUM:"medium",LARGE:"large"});f.size=c;d={dp16:"xsmall",dp32:"small",dp64:"medium",db64:"medium",dp128:"large"};f.sizeMapTransfer=d;e=Object.freeze({PICKER:"picker",HOT_LIKE:"hot_like"});f.source=e;b=[983040];f.FB_THUMBS_UP_EMOJI=b;a="hot_emoji_source";f.SOURCE_TAG_PREFIX=a;c="hot_emoji_size";f.TAG_PREFIX_NEW=c;d="emoji_like";f.TAG_PREFIX_OLD=d;e="\ud83d\udc4d";f.THUMBS_UP_EMOJI=e;b=[128077];f.THUMBS_UP_EMOJI_CODES=b}),null);
__d("installUFI2ComposerInputDecorators",[],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a){for(var b=arguments.length,c=new Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];return babelHelpers["extends"]({},a,{inputDecorators:[].concat(a.inputDecorators,c)})}}),null);
__d("PhotosMimeType",[],(function(a,b,c,d,e,f){f.isImage=g;f.isJpeg=a;function g(a){return h(a)[0]==="image"}function a(a){var b=h(a);return g(a)&&(b[1]==="jpeg"||b[1]==="pjpeg")}function h(a){return a.split("/")}}),null);
__d("EmojiSpan.react",["cx","FBEmojiResource","React","UnicodeUtils"],(function(a,b,c,d,e,f,g){e.exports=a;var h,i=b("React");function a(a){var c=a.children;a.contentState;var d=a.decoratedText,e=a.dir,f=a.offsetKey;a=a.size;var g=0,j=d.length,k=[];while(g<j){var l=(h||(h=b("UnicodeUtils"))).getUTF16Length(d,g);k.push(d.substr(g,l));g+=l}l=b("FBEmojiResource").fromCodepoints(k);g=l!=null?l.getImageURL(a):null;return g!=null?i.jsx("span",{className:"_3gl1 _5zz4","data-offset-key":f,dir:e,style:{backgroundImage:"url("+g+")",backgroundSize:a+"px "+a+"px",height:a,width:a},children:i.jsx("span",{className:"_ncl",children:c})}):i.jsx("span",{"data-offset-key":f,children:d})}}),null);
__d("getEntityMatcher",[],(function(a,b,c,d,e,f){e.exports=a;function g(a,b){return b.getEntity(a)}function a(a,b){return function(c,d,e){var f=b||g;c.findEntityRanges(function(b){b=b.getEntity();return typeof b==="string"&&a(f(b,e))},d)}}}),null);
__d("createMentionEntityForContentState",[],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a,b){var c=b.getType().toLowerCase();if(c==="hashtag")return a.createEntity("HASHTAG","IMMUTABLE");var d=c==="user"||c==="fb4c"?"SEGMENTED":"IMMUTABLE",e=b.getAuxiliaryData();return a.createEntity("MENTION",d,{id:b.getUniqueID(),uri:b.getURI(),isWeak:e&&e.renderType==="non_member",type:c})}}),null);
__d("immutable",[],(function(a,b,c,d,e,f){(function(b,c){typeof f==="object"&&typeof e!=="undefined"?e.exports=c():typeof define==="function"&&define.amd?define(c):b.Immutable=c()})(this,function(){"use strict";var a=Array.prototype.slice;function b(a,b){b&&(a.prototype=Object.create(b.prototype)),a.prototype.constructor=a}var c="delete",d=5,e=1<<d,f=e-1,g={},h={value:!1},i={value:!1};function j(a){a.value=!1;return a}function k(a){a&&(a.value=!0)}function l(){}function m(a,b){b=b||0;var c=Math.max(0,a.length-b),d=new Array(c);for(var e=0;e<c;e++)d[e]=a[e+b];return d}function n(a){a.size===void 0&&(a.size=a.__iterate(p));return a.size}function o(a,b){return b>=0?+b:n(a)+ +b}function p(){return!0}function q(a,b,c){return(a===0||c!==void 0&&a<=-c)&&(b===void 0||c!==void 0&&b>=c)}function r(a,b){return aa(a,b,0)}function s(a,b){return aa(a,b,b)}function aa(a,b,c){return a===void 0?c:a<0?Math.max(0,b+a):b===void 0?a:Math.min(b,a)}function t(a){return x(a)?a:F(a)}b(u,t);function u(a){return y(a)?a:G(a)}b(v,t);function v(a){return z(a)?a:H(a)}b(w,t);function w(a){return x(a)&&!ba(a)?a:I(a)}function x(a){return!!(a&&a[da])}function y(a){return!!(a&&a[ea])}function z(a){return!!(a&&a[fa])}function ba(a){return y(a)||z(a)}function ca(a){return!!(a&&a[ga])}t.isIterable=x;t.isKeyed=y;t.isIndexed=z;t.isAssociative=ba;t.isOrdered=ca;t.Keyed=u;t.Indexed=v;t.Set=w;var da="@@__IMMUTABLE_ITERABLE__@@",ea="@@__IMMUTABLE_KEYED__@@",fa="@@__IMMUTABLE_INDEXED__@@",ga="@@__IMMUTABLE_ORDERED__@@",ha=0,A=1,B=2,ia=typeof Symbol==="function"&&Symbol.iterator,ja="@@iterator",ka=ia||ja;function C(a){this.next=a}C.prototype.toString=function(){return"[Iterator]"};C.KEYS=ha;C.VALUES=A;C.ENTRIES=B;C.prototype.inspect=C.prototype.toSource=function(){return this.toString()};C.prototype[ka]=function(){return this};function D(a,b,c,d){a=a===0?b:a===1?c:[b,c];d?d.value=a:d={value:a,done:!1};return d}function E(){return{value:void 0,done:!0}}function la(a){return!!oa(a)}function ma(a){return a&&typeof a.next==="function"}function na(a){var b=oa(a);return b&&b.call(a)}function oa(a){a=a&&(ia&&a[ia]||a[ja]);if(typeof a==="function")return a}function pa(a){return a&&typeof a.length==="number"}b(F,t);function F(a){return a===null||a===void 0?xa():x(a)?a.toSeq():Aa(a)}F.of=function(){return F(arguments)};F.prototype.toSeq=function(){return this};F.prototype.toString=function(){return this.__toString("Seq {","}")};F.prototype.cacheResult=function(){!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length);return this};F.prototype.__iterate=function(a,b){return Ca(this,a,b,!0)};F.prototype.__iterator=function(a,b){return Da(this,a,b,!0)};b(G,F);function G(a){return a===null||a===void 0?xa().toKeyedSeq():x(a)?y(a)?a.toSeq():a.fromEntrySeq():ya(a)}G.prototype.toKeyedSeq=function(){return this};b(H,F);function H(a){return a===null||a===void 0?xa():x(a)?y(a)?a.entrySeq():a.toIndexedSeq():za(a)}H.of=function(){return H(arguments)};H.prototype.toIndexedSeq=function(){return this};H.prototype.toString=function(){return this.__toString("Seq [","]")};H.prototype.__iterate=function(a,b){return Ca(this,a,b,!1)};H.prototype.__iterator=function(a,b){return Da(this,a,b,!1)};b(I,F);function I(a){return(a===null||a===void 0?xa():x(a)?y(a)?a.entrySeq():a:za(a)).toSetSeq()}I.of=function(){return I(arguments)};I.prototype.toSetSeq=function(){return this};F.isSeq=va;F.Keyed=G;F.Set=I;F.Indexed=H;var qa="@@__IMMUTABLE_SEQ__@@";F.prototype[qa]=!0;b(ra,H);function ra(a){this._array=a,this.size=a.length}ra.prototype.get=function(a,b){return this.has(a)?this._array[o(this,a)]:b};ra.prototype.__iterate=function(a,b){var c=this._array,d=c.length-1;for(var e=0;e<=d;e++)if(a(c[b?d-e:e],e,this)===!1)return e+1;return e};ra.prototype.__iterator=function(a,b){var c=this._array,d=c.length-1,e=0;return new C(function(){return e>d?E():D(a,e,c[b?d-e++:e++])})};b(sa,G);function sa(a){var b=Object.keys(a);this._object=a;this._keys=b;this.size=b.length}sa.prototype.get=function(a,b){return b!==void 0&&!this.has(a)?b:this._object[a]};sa.prototype.has=function(a){return this._object.hasOwnProperty(a)};sa.prototype.__iterate=function(a,b){var c=this._object,d=this._keys,e=d.length-1;for(var f=0;f<=e;f++){var g=d[b?e-f:f];if(a(c[g],g,this)===!1)return f+1}return f};sa.prototype.__iterator=function(a,b){var c=this._object,d=this._keys,e=d.length-1,f=0;return new C(function(){var g=d[b?e-f:f];return f++>e?E():D(a,g,c[g])})};sa.prototype[ga]=!0;b(ta,H);function ta(a){this._iterable=a,this.size=a.length||a.size}ta.prototype.__iterateUncached=function(a,b){if(b)return this.cacheResult().__iterate(a,b);b=this._iterable;b=na(b);var c=0;if(ma(b)){var d;while(!(d=b.next()).done)if(a(d.value,c++,this)===!1)break}return c};ta.prototype.__iteratorUncached=function(a,b){if(b)return this.cacheResult().__iterator(a,b);b=this._iterable;var c=na(b);if(!ma(c))return new C(E);var d=0;return new C(function(){var b=c.next();return b.done?b:D(a,d++,b.value)})};b(ua,H);function ua(a){this._iterator=a,this._iteratorCache=[]}ua.prototype.__iterateUncached=function(a,b){if(b)return this.cacheResult().__iterate(a,b);b=this._iterator;var c=this._iteratorCache,d=0;while(d<c.length)if(a(c[d],d++,this)===!1)return d;var e;while(!(e=b.next()).done){e=e.value;c[d]=e;if(a(e,d++,this)===!1)break}return d};ua.prototype.__iteratorUncached=function(a,b){if(b)return this.cacheResult().__iterator(a,b);var c=this._iterator,d=this._iteratorCache,e=0;return new C(function(){if(e>=d.length){var b=c.next();if(b.done)return b;d[e]=b.value}return D(a,e,d[e++])})};function va(a){return!!(a&&a[qa])}var wa;function xa(){return wa||(wa=new ra([]))}function ya(a){var b=Array.isArray(a)?new ra(a).fromEntrySeq():ma(a)?new ua(a).fromEntrySeq():la(a)?new ta(a).fromEntrySeq():typeof a==="object"?new sa(a):void 0;if(!b)throw new TypeError("Expected Array or iterable object of [k, v] entries, or keyed object: "+a);return b}function za(a){var b=Ba(a);if(!b)throw new TypeError("Expected Array or iterable object of values: "+a);return b}function Aa(a){var b=Ba(a)||typeof a==="object"&&new sa(a);if(!b)throw new TypeError("Expected Array or iterable object of values, or keyed object: "+a);return b}function Ba(a){return pa(a)?new ra(a):ma(a)?new ua(a):la(a)?new ta(a):void 0}function Ca(a,b,c,d){var e=a._cache;if(e){var f=e.length-1;for(var g=0;g<=f;g++){var h=e[c?f-g:g];if(b(h[1],d?h[0]:g,a)===!1)return g+1}return g}return a.__iterateUncached(b,c)}function Da(a,b,c,d){var e=a._cache;if(e){var f=e.length-1,g=0;return new C(function(){var a=e[c?f-g:g];return g++>f?E():D(b,d?a[0]:g-1,a[1])})}return a.__iteratorUncached(b,c)}b(Ea,t);function Ea(){throw TypeError("Abstract")}b(Fa,Ea);function Fa(){}b(Ga,Ea);function Ga(){}b(Ha,Ea);function Ha(){}Ea.Keyed=Fa;Ea.Indexed=Ga;Ea.Set=Ha;function J(a,b){if(a===b||a!==a&&b!==b)return!0;if(!a||!b)return!1;if(typeof a.valueOf==="function"&&typeof b.valueOf==="function"){a=a.valueOf();b=b.valueOf();if(a===b||a!==a&&b!==b)return!0;if(!a||!b)return!1}return typeof a.equals==="function"&&typeof b.equals==="function"&&a.equals(b)?!0:!1}function Ia(a,b){return b?Ja(b,a,"",{"":a}):Ka(a)}function Ja(a,b,c,d){if(Array.isArray(b))return a.call(d,c,H(b).map(function(c,d){return Ja(a,c,d,b)}));return La(b)?a.call(d,c,G(b).map(function(c,d){return Ja(a,c,d,b)})):b}function Ka(a){if(Array.isArray(a))return H(a).map(Ka).toList();return La(a)?G(a).map(Ka).toMap():a}function La(a){return a&&(a.constructor===Object||a.constructor===void 0)}var Ma=typeof Math.imul==="function"&&Math.imul(4294967295,2)===-2?Math.imul:function(a,b){a=a|0;b=b|0;var c=a&65535,d=b&65535;return c*d+((a>>>16)*d+c*(b>>>16)<<16>>>0)|0};function Na(a){return a>>>1&1073741824|a&3221225471}function K(a){if(a===!1||a===null||a===void 0)return 0;if(typeof a.valueOf==="function"){a=a.valueOf();if(a===!1||a===null||a===void 0)return 0}if(a===!0)return 1;var b=typeof a;if(b==="number"){var c=a|0;c!==a&&(c^=a*4294967295);while(a>4294967295)a/=4294967295,c^=a;return Na(c)}if(b==="string")return a.length>Ya?Oa(a):Pa(a);return typeof a.hashCode==="function"?a.hashCode():Qa(a)}function Oa(b){var a=ab[b];a===void 0&&(a=Pa(b),$a===Za&&($a=0,ab={}),$a++,ab[b]=a);return a}function Pa(b){var a=0;for(var c=0;c<b.length;c++)a=31*a+b.charCodeAt(c)|0;return Na(a)}function Qa(b){var a;if(Ua){a=Va.get(b);if(a!==void 0)return a}a=b[Xa];if(a!==void 0)return a;if(!Sa){a=b.propertyIsEnumerable&&b.propertyIsEnumerable[Xa];if(a!==void 0)return a;a=Ta(b);if(a!==void 0)return a}a=++Wa;Wa&1073741824&&(Wa=0);if(Ua)Va.set(b,a);else if(Ra!==void 0&&Ra(b)===!1)throw new Error("Non-extensible objects are not allowed as keys.");else if(Sa)Object.defineProperty(b,Xa,{enumerable:!1,configurable:!1,writable:!1,value:a});else if(b.propertyIsEnumerable!==void 0&&b.propertyIsEnumerable===b.constructor.prototype.propertyIsEnumerable)b.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},b.propertyIsEnumerable[Xa]=a;else if(b.nodeType!==void 0)b[Xa]=a;else throw new Error("Unable to set a non-enumerable property on object.");return a}var Ra=Object.isExtensible,Sa=function(){try{Object.defineProperty({},"@",{});return!0}catch(a){return!1}}();function Ta(a){if(a&&a.nodeType>0)switch(a.nodeType){case 1:return a.uniqueID;case 9:return a.documentElement&&a.documentElement.uniqueID}}var Ua=typeof WeakMap==="function",Va;Ua&&(Va=new WeakMap());var Wa=0,Xa="__immutablehash__";typeof Symbol==="function"&&(Xa=Symbol(Xa));var Ya=16,Za=255,$a=0,ab={};function bb(a,b){if(!a)throw new Error(b)}function L(a){bb(a!==Infinity,"Cannot perform this action with an infinite size.")}b(M,G);function M(a,b){this._iter=a,this._useKeys=b,this.size=a.size}M.prototype.get=function(a,b){return this._iter.get(a,b)};M.prototype.has=function(a){return this._iter.has(a)};M.prototype.valueSeq=function(){return this._iter.valueSeq()};M.prototype.reverse=function(){var a=this,b=hb(this,!0);this._useKeys||(b.valueSeq=function(){return a._iter.toSeq().reverse()});return b};M.prototype.map=function(a,b){var c=this,d=gb(this,a,b);this._useKeys||(d.valueSeq=function(){return c._iter.toSeq().map(a,b)});return d};M.prototype.__iterate=function(a,b){var c=this,d;return this._iter.__iterate(this._useKeys?function(b,d){return a(b,d,c)}:(d=b?xb(this):0,function(e){return a(e,b?--d:d++,c)}),b)};M.prototype.__iterator=function(a,b){if(this._useKeys)return this._iter.__iterator(a,b);var c=this._iter.__iterator(A,b),d=b?xb(this):0;return new C(function(){var e=c.next();return e.done?e:D(a,b?--d:d++,e.value,e)})};M.prototype[ga]=!0;b(cb,H);function cb(a){this._iter=a,this.size=a.size}cb.prototype.includes=function(a){return this._iter.includes(a)};cb.prototype.__iterate=function(a,b){var c=this,d=0;return this._iter.__iterate(function(b){return a(b,d++,c)},b)};cb.prototype.__iterator=function(a,b){var c=this._iter.__iterator(A,b),d=0;return new C(function(){var b=c.next();return b.done?b:D(a,d++,b.value,b)})};b(db,I);function db(a){this._iter=a,this.size=a.size}db.prototype.has=function(a){return this._iter.includes(a)};db.prototype.__iterate=function(a,b){var c=this;return this._iter.__iterate(function(b){return a(b,b,c)},b)};db.prototype.__iterator=function(a,b){var c=this._iter.__iterator(A,b);return new C(function(){var b=c.next();return b.done?b:D(a,b.value,b.value,b)})};b(eb,G);function eb(a){this._iter=a,this.size=a.size}eb.prototype.entrySeq=function(){return this._iter.toSeq()};eb.prototype.__iterate=function(a,b){var c=this;return this._iter.__iterate(function(b){if(b){wb(b);var d=x(b);return a(d?b.get(1):b[1],d?b.get(0):b[0],c)}},b)};eb.prototype.__iterator=function(a,b){var c=this._iter.__iterator(A,b);return new C(function(){while(!0){var b=c.next();if(b.done)return b;var d=b.value;if(d){wb(d);var e=x(d);return D(a,e?d.get(0):d[0],e?d.get(1):d[1],b)}}})};cb.prototype.cacheResult=M.prototype.cacheResult=db.prototype.cacheResult=eb.prototype.cacheResult=Ab;function fb(a){var b=zb(a);b._iter=a;b.size=a.size;b.flip=function(){return a};b.reverse=function(){var b=a.reverse.apply(this);b.flip=function(){return a.reverse()};return b};b.has=function(b){return a.includes(b)};b.includes=function(b){return a.has(b)};b.cacheResult=Ab;b.__iterateUncached=function(b,c){var d=this;return a.__iterate(function(a,c){return b(c,a,d)!==!1},c)};b.__iteratorUncached=function(b,c){if(b===B){var d=a.__iterator(b,c);return new C(function(){var a=d.next();if(!a.done){var b=a.value[0];a.value[0]=a.value[1];a.value[1]=b}return a})}return a.__iterator(b===A?ha:A,c)};return b}function gb(a,b,c){var d=zb(a);d.size=a.size;d.has=function(b){return a.has(b)};d.get=function(d,e){var f=a.get(d,g);return f===g?e:b.call(c,f,d,a)};d.__iterateUncached=function(d,e){var f=this;return a.__iterate(function(a,e,g){return d(b.call(c,a,e,g),e,f)!==!1},e)};d.__iteratorUncached=function(d,e){var f=a.__iterator(B,e);return new C(function(){var e=f.next();if(e.done)return e;var g=e.value,h=g[0];return D(d,h,b.call(c,g[1],h,a),e)})};return d}function hb(a,b){var c=zb(a);c._iter=a;c.size=a.size;c.reverse=function(){return a};a.flip&&(c.flip=function(){var b=fb(a);b.reverse=function(){return a.flip()};return b});c.get=function(c,d){return a.get(b?c:-1-c,d)};c.has=function(c){return a.has(b?c:-1-c)};c.includes=function(b){return a.includes(b)};c.cacheResult=Ab;c.__iterate=function(b,c){var d=this;return a.__iterate(function(a,c){return b(a,c,d)},!c)};c.__iterator=function(b,c){return a.__iterator(b,!c)};return c}function ib(a,b,c,d){var e=zb(a);d&&(e.has=function(d){var e=a.get(d,g);return e!==g&&!!b.call(c,e,d,a)},e.get=function(d,e){var f=a.get(d,g);return f!==g&&b.call(c,f,d,a)?f:e});e.__iterateUncached=function(e,f){var g=this,h=0;a.__iterate(function(a,f,i){if(b.call(c,a,f,i)){h++;return e(a,d?f:h-1,g)}},f);return h};e.__iteratorUncached=function(e,f){var g=a.__iterator(B,f),h=0;return new C(function(){while(!0){var f=g.next();if(f.done)return f;var i=f.value,j=i[0];i=i[1];if(b.call(c,i,j,a))return D(e,d?j:h++,i,f)}})};return e}function jb(a,b,c){var d=O().asMutable();a.__iterate(function(e,f){d.update(b.call(c,e,f,a),0,function(a){return a+1})});return d.asImmutable()}function kb(a,b,c){var d=y(a),e=(ca(a)?S():O()).asMutable();a.__iterate(function(f,g){e.update(b.call(c,f,g,a),function(a){return a=a||[],a.push(d?[g,f]:f),a})});var f=yb(a);return e.map(function(b){return N(a,f(b))})}function lb(a,b,c,d){var e=a.size;if(q(b,c,e))return a;var f=r(b,e);e=s(c,e);if(f!==f||e!==e)return lb(a.toSeq().cacheResult(),b,c,d);b=e-f;var g;b===b&&(g=b<0?0:b);c=zb(a);c.size=g;!d&&va(a)&&g>=0&&(c.get=function(b,c){b=o(this,b);return b>=0&&b<g?a.get(b+f,c):c});c.__iterateUncached=function(b,c){var e=this;if(g===0)return 0;if(c)return this.cacheResult().__iterate(b,c);var h=0,i=!0,j=0;a.__iterate(function(a,c){if(!(i&&(i=h++<f))){j++;return b(a,d?c:j-1,e)!==!1&&j!==g}});return j};c.__iteratorUncached=function(b,c){if(g!==0&&c)return this.cacheResult().__iterator(b,c);var e=g!==0&&a.__iterator(b,c),h=0,i=0;return new C(function(){while(h++<f)e.next();if(++i>g)return E();var a=e.next();if(d||b===A)return a;else if(b===ha)return D(b,i-1,void 0,a);else return D(b,i-1,a.value[1],a)})};return c}function mb(a,b,c){var d=zb(a);d.__iterateUncached=function(d,e){var f=this;if(e)return this.cacheResult().__iterate(d,e);var g=0;a.__iterate(function(a,e,h){return b.call(c,a,e,h)&&++g&&d(a,e,f)});return g};d.__iteratorUncached=function(d,e){var f=this;if(e)return this.cacheResult().__iterator(d,e);var g=a.__iterator(B,e),h=!0;return new C(function(){if(!h)return E();var a=g.next();if(a.done)return a;var e=a.value,i=e[0];e=e[1];if(!b.call(c,e,i,f)){h=!1;return E()}return d===B?a:D(d,i,e,a)})};return d}function nb(a,b,c,d){var e=zb(a);e.__iterateUncached=function(e,f){var g=this;if(f)return this.cacheResult().__iterate(e,f);var h=!0,i=0;a.__iterate(function(a,f,j){if(!(h&&(h=b.call(c,a,f,j)))){i++;return e(a,d?f:i-1,g)}});return i};e.__iteratorUncached=function(e,f){var g=this;if(f)return this.cacheResult().__iterator(e,f);var h=a.__iterator(B,f),i=!0,j=0;return new C(function(){var a,f;do{a=h.next();if(a.done)if(d||e===A)return a;else if(e===ha)return D(e,j++,void 0,a);else return D(e,j++,a.value[1],a);var k=a.value;f=k[0];k=k[1];i&&(i=b.call(c,k,f,g))}while(i);return e===B?a:D(e,f,k,a)})};return e}function ob(a,b){var c=y(a);b=[a].concat(b).map(function(a){!x(a)?a=c?ya(a):za(Array.isArray(a)?a:[a]):c&&(a=u(a));return a}).filter(function(a){return a.size!==0});if(b.length===0)return a;if(b.length===1){var d=b[0];if(d===a||c&&y(d)||z(a)&&z(d))return d}d=new ra(b);c?d=d.toKeyedSeq():z(a)||(d=d.toSetSeq());d=d.flatten(!0);d.size=b.reduce(function(a,b){if(a!==void 0){b=b.size;if(b!==void 0)return a+b}},0);return d}function pb(a,b,c){var d=zb(a);d.__iterateUncached=function(d,e){var f=0,g=!1;function h(a,i){var j=this;a.__iterate(function(a,e){(!b||i<b)&&x(a)?h(a,i+1):d(a,c?e:f++,j)===!1&&(g=!0);return!g},e)}h(a,0);return f};d.__iteratorUncached=function(d,e){var f=a.__iterator(d,e),g=[],h=0;return new C(function(){while(f){var a=f.next();if(a.done!==!1){f=g.pop();continue}var i=a.value;d===B&&(i=i[1]);if((!b||g.length<b)&&x(i))g.push(f),f=i.__iterator(d,e);else return c?a:D(d,h++,i,a)}return E()})};return d}function qb(a,b,c){var d=yb(a);return a.toSeq().map(function(e,f){return d(b.call(c,e,f,a))}).flatten(!0)}function rb(a,b){var c=zb(a);c.size=a.size&&a.size*2-1;c.__iterateUncached=function(c,d){var e=this,f=0;a.__iterate(function(a,d){return(!f||c(b,f++,e)!==!1)&&c(a,f++,e)!==!1},d);return f};c.__iteratorUncached=function(c,d){var e=a.__iterator(A,d),f=0,g;return new C(function(){if(!g||f%2){g=e.next();if(g.done)return g}return f%2?D(c,f++,b):D(c,f++,g.value,g)})};return c}function sb(a,b,c){b||(b=Bb);var d=y(a),e=0,f=a.toSeq().map(function(b,d){return[d,b,e++,c?c(b,d,a):b]}).toArray();f.sort(function(a,c){return b(a[3],c[3])||a[2]-c[2]}).forEach(d?function(a,b){f[b].length=2}:function(a,b){f[b]=a[1]});return d?G(f):z(a)?H(f):I(f)}function tb(a,b,c){b||(b=Bb);if(c){var d=a.toSeq().map(function(b,d){return[b,c(b,d,a)]}).reduce(function(a,c){return ub(b,a[1],c[1])?c:a});return d&&d[0]}else return a.reduce(function(a,c){return ub(b,a,c)?c:a})}function ub(a,b,c){a=a(c,b);return a===0&&c!==b&&(c===void 0||c===null||c!==c)||a>0}function vb(a,b,c){a=zb(a);a.size=new ra(c).map(function(a){return a.size}).min();a.__iterate=function(a,b){b=this.__iterator(A,b);var c,d=0;while(!(c=b.next()).done)if(a(c.value,d++,this)===!1)break;return d};a.__iteratorUncached=function(a,d){var e=c.map(function(a){return a=t(a),na(d?a.reverse():a)}),f=0,g=!1;return new C(function(){var c;g||(c=e.map(function(a){return a.next()}),g=c.some(function(a){return a.done}));return g?E():D(a,f++,b.apply(null,c.map(function(a){return a.value})))})};return a}function N(a,b){return va(a)?b:a.constructor(b)}function wb(a){if(a!==Object(a))throw new TypeError("Expected [K, V] tuple: "+a)}function xb(a){L(a.size);return n(a)}function yb(a){return y(a)?u:z(a)?v:w}function zb(a){return Object.create((y(a)?G:z(a)?H:I).prototype)}function Ab(){if(this._iter.cacheResult){this._iter.cacheResult();this.size=this._iter.size;return this}else return F.prototype.cacheResult.call(this)}function Bb(a,b){return a>b?1:a<b?-1:0}function Cb(a){var b=na(a);if(!b){if(!pa(a))throw new TypeError("Expected iterable or array-like: "+a);b=na(t(a))}return b}b(O,Fa);function O(a){return a===null||a===void 0?Pb():Db(a)?a:Pb().withMutations(function(b){var c=u(a);L(c.size);c.forEach(function(a,c){return b.set(c,a)})})}O.prototype.toString=function(){return this.__toString("Map {","}")};O.prototype.get=function(a,b){return this._root?this._root.get(0,void 0,a,b):b};O.prototype.set=function(a,b){return Qb(this,a,b)};O.prototype.setIn=function(a,b){return this.updateIn(a,g,function(){return b})};O.prototype.remove=function(a){return Qb(this,a,g)};O.prototype.deleteIn=function(a){return this.updateIn(a,function(){return g})};O.prototype.update=function(a,b,c){return arguments.length===1?a(this):this.updateIn([a],b,c)};O.prototype.updateIn=function(a,b,c){c||(c=b,b=void 0);a=$b(this,Cb(a),b,c);return a===g?void 0:a};O.prototype.clear=function(){if(this.size===0)return this;if(this.__ownerID){this.size=0;this._root=null;this.__hash=void 0;this.__altered=!0;return this}return Pb()};O.prototype.merge=function(){return Xb(this,void 0,arguments)};O.prototype.mergeWith=function(b){var c=a.call(arguments,1);return Xb(this,b,c)};O.prototype.mergeIn=function(b){var c=a.call(arguments,1);return this.updateIn(b,Pb(),function(a){return typeof a.merge==="function"?a.merge.apply(a,c):c[c.length-1]})};O.prototype.mergeDeep=function(){return Xb(this,Yb(void 0),arguments)};O.prototype.mergeDeepWith=function(b){var c=a.call(arguments,1);return Xb(this,Yb(b),c)};O.prototype.mergeDeepIn=function(b){var c=a.call(arguments,1);return this.updateIn(b,Pb(),function(a){return typeof a.mergeDeep==="function"?a.mergeDeep.apply(a,c):c[c.length-1]})};O.prototype.sort=function(a){return S(sb(this,a))};O.prototype.sortBy=function(a,b){return S(sb(this,b,a))};O.prototype.withMutations=function(a){var b=this.asMutable();a(b);return b.wasAltered()?b.__ensureOwner(this.__ownerID):this};O.prototype.asMutable=function(){return this.__ownerID?this:this.__ensureOwner(new l())};O.prototype.asImmutable=function(){return this.__ensureOwner()};O.prototype.wasAltered=function(){return this.__altered};O.prototype.__iterator=function(a,b){return new Kb(this,a,b)};O.prototype.__iterate=function(a,b){var c=this,d=0;this._root&&this._root.iterate(function(b){d++;return a(b[1],b[0],c)},b);return d};O.prototype.__ensureOwner=function(a){if(a===this.__ownerID)return this;if(!a){this.__ownerID=a;this.__altered=!1;return this}return Nb(this.size,this._root,a,this.__hash)};function Db(a){return!!(a&&a[Eb])}O.isMap=Db;var Eb="@@__IMMUTABLE_MAP__@@",P=O.prototype;P[Eb]=!0;P[c]=P.remove;P.removeIn=P.deleteIn;function Fb(a,b){this.ownerID=a,this.entries=b}Fb.prototype.get=function(a,b,c,d){a=this.entries;for(var b=0,e=a.length;b<e;b++)if(J(c,a[b][0]))return a[b][1];return d};Fb.prototype.update=function(a,b,c,d,e,f,h){b=e===g;c=this.entries;var i=0;for(var j=c.length;i<j;i++)if(J(d,c[i][0]))break;var l=i<j;if(l?c[i][1]===e:b)return this;k(h);(b||!l)&&k(f);if(b&&c.length===1)return;if(!l&&!b&&c.length>=ec)return Ub(a,c,d,e);h=a&&a===this.ownerID;f=h?c:m(c);l?b?i===j-1?f.pop():f[i]=f.pop():f[i]=[d,e]:f.push([d,e]);if(h){this.entries=f;return this}return new Fb(a,f)};function Gb(a,b,c){this.ownerID=a,this.bitmap=b,this.nodes=c}Gb.prototype.get=function(a,b,c,e){b===void 0&&(b=K(c));var g=1<<((a===0?b:b>>>a)&f),h=this.bitmap;return(h&g)===0?e:this.nodes[ac(h&g-1)].get(a+d,b,c,e)};Gb.prototype.update=function(a,b,c,e,h,i,j){c===void 0&&(c=K(e));var k=(b===0?c:c>>>b)&f,l=1<<k,m=this.bitmap,n=(m&l)!==0;if(!n&&h===g)return this;var o=ac(m&l-1),p=this.nodes,q=n?p[o]:void 0;b=Rb(q,a,b+d,c,e,h,i,j);if(b===q)return this;if(!n&&b&&p.length>=fc)return Wb(a,p,m,k,b);if(n&&!b&&p.length===2&&Sb(p[o^1]))return p[o^1];if(n&&b&&p.length===1&&Sb(b))return b;c=a&&a===this.ownerID;e=n?b?m:m^l:m|l;h=n?b?bc(p,o,b,c):dc(p,o,c):cc(p,o,b,c);if(c){this.bitmap=e;this.nodes=h;return this}return new Gb(a,e,h)};function Hb(a,b,c){this.ownerID=a,this.count=b,this.nodes=c}Hb.prototype.get=function(a,b,c,e){b===void 0&&(b=K(c));var g=(a===0?b:b>>>a)&f;g=this.nodes[g];return g?g.get(a+d,b,c,e):e};Hb.prototype.update=function(a,b,c,e,h,i,j){c===void 0&&(c=K(e));var k=(b===0?c:c>>>b)&f,l=h===g,m=this.nodes,n=m[k];if(l&&!n)return this;l=Rb(n,a,b+d,c,e,h,i,j);if(l===n)return this;b=this.count;if(!n)b++;else if(!l){b--;if(b<gc)return Vb(a,m,b,k)}c=a&&a===this.ownerID;e=bc(m,k,l,c);if(c){this.count=b;this.nodes=e;return this}return new Hb(a,b,e)};function Ib(a,b,c){this.ownerID=a,this.keyHash=b,this.entries=c}Ib.prototype.get=function(a,b,c,d){a=this.entries;for(var b=0,e=a.length;b<e;b++)if(J(c,a[b][0]))return a[b][1];return d};Ib.prototype.update=function(a,b,c,d,e,f,h){c===void 0&&(c=K(d));var i=e===g;if(c!==this.keyHash){if(i)return this;k(h);k(f);return Tb(this,a,b,c,[d,e])}b=this.entries;c=0;for(var j=b.length;c<j;c++)if(J(d,b[c][0]))break;var l=c<j;if(l?b[c][1]===e:i)return this;k(h);(i||!l)&&k(f);if(i&&j===2)return new Jb(a,this.keyHash,b[c^1]);h=a&&a===this.ownerID;f=h?b:m(b);l?i?c===j-1?f.pop():f[c]=f.pop():f[c]=[d,e]:f.push([d,e]);if(h){this.entries=f;return this}return new Ib(a,this.keyHash,f)};function Jb(a,b,c){this.ownerID=a,this.keyHash=b,this.entry=c}Jb.prototype.get=function(a,b,c,d){return J(c,this.entry[0])?this.entry[1]:d};Jb.prototype.update=function(a,b,c,d,e,f,h){c=e===g;var i=J(d,this.entry[0]);if(i?e===this.entry[1]:c)return this;k(h);if(c){k(f);return}if(i){if(a&&a===this.ownerID){this.entry[1]=e;return this}return new Jb(a,this.keyHash,[d,e])}k(f);return Tb(this,a,b,K(d),[d,e])};Fb.prototype.iterate=Ib.prototype.iterate=function(a,b){var c=this.entries;for(var d=0,e=c.length-1;d<=e;d++)if(a(c[b?e-d:d])===!1)return!1};Gb.prototype.iterate=Hb.prototype.iterate=function(a,b){var c=this.nodes;for(var d=0,e=c.length-1;d<=e;d++){var f=c[b?e-d:d];if(f&&f.iterate(a,b)===!1)return!1}};Jb.prototype.iterate=function(a,b){return a(this.entry)};b(Kb,C);function Kb(a,b,c){this._type=b,this._reverse=c,this._stack=a._root&&Mb(a._root)}Kb.prototype.next=function(){var a=this._type,b=this._stack;while(b){var c=b.node,d=b.index++,e;if(c.entry){if(d===0)return Lb(a,c.entry)}else if(c.entries){e=c.entries.length-1;if(d<=e)return Lb(a,c.entries[this._reverse?e-d:d])}else{e=c.nodes.length-1;if(d<=e){c=c.nodes[this._reverse?e-d:d];if(c){if(c.entry)return Lb(a,c.entry);b=this._stack=Mb(c,b)}continue}}b=this._stack=this._stack.__prev}return E()};function Lb(a,b){return D(a,b[0],b[1])}function Mb(a,b){return{node:a,index:0,__prev:b}}function Nb(b,c,d,a){var e=Object.create(P);e.size=b;e._root=c;e.__ownerID=d;e.__hash=a;e.__altered=!1;return e}var Ob;function Pb(){return Ob||(Ob=Nb(0))}function Qb(a,b,c){var d,e;if(!a._root){if(c===g)return a;e=1;d=new Fb(a.__ownerID,[[b,c]])}else{var f=j(h),k=j(i);d=Rb(a._root,a.__ownerID,0,void 0,b,c,f,k);if(!k.value)return a;e=a.size+(f.value?c===g?-1:1:0)}if(a.__ownerID){a.size=e;a._root=d;a.__hash=void 0;a.__altered=!0;return a}return d?Nb(e,d):Pb()}function Rb(a,b,c,d,e,f,h,i){if(!a){if(f===g)return a;k(i);k(h);return new Jb(b,d,[e,f])}return a.update(b,c,d,e,f,h,i)}function Sb(a){return a.constructor===Jb||a.constructor===Ib}function Tb(a,b,c,e,g){if(a.keyHash===e)return new Ib(b,e,[a.entry,g]);var h=(c===0?a.keyHash:a.keyHash>>>c)&f,i=(c===0?e:e>>>c)&f;e=h===i?[Tb(a,b,c+d,e,g)]:(c=new Jb(b,e,g),h<i?[a,c]:[c,a]);return new Gb(b,1<<h|1<<i,e)}function Ub(a,b,c,d){a||(a=new l());c=new Jb(a,K(c),[c,d]);for(var d=0;d<b.length;d++){var e=b[d];c=c.update(a,0,void 0,e[0],e[1])}return c}function Vb(a,b,c,d){var e=0,f=0;c=new Array(c);for(var g=0,h=1,i=b.length;g<i;g++,h<<=1){var j=b[g];j!==void 0&&g!==d&&(e|=h,c[f++]=j)}return new Gb(a,e,c)}function Wb(a,b,c,d,f){var g=0,h=new Array(e);for(var i=0;c!==0;i++,c>>>=1)h[i]=c&1?b[g++]:void 0;h[d]=f;return new Hb(a,g+1,h)}function Xb(a,b,c){var d=[];for(var e=0;e<c.length;e++){var f=c[e],g=u(f);x(f)||(g=g.map(function(a){return Ia(a)}));d.push(g)}return Zb(a,b,d)}function Yb(a){return function(b,c,d){return b&&b.mergeDeepWith&&x(c)?b.mergeDeepWith(a,c):a?a(b,c,d):c}}function Zb(a,b,c){c=c.filter(function(a){return a.size!==0});if(c.length===0)return a;return a.size===0&&!a.__ownerID&&c.length===1?a.constructor(c[0]):a.withMutations(function(a){var d=b?function(c,d){a.update(d,g,function(a){return a===g?c:b(a,c,d)})}:function(b,c){a.set(c,b)};for(var e=0;e<c.length;e++)c[e].forEach(d)})}function $b(a,b,c,d){var e=a===g,f=b.next();if(f.done){var h=e?c:a,i=d(h);return i===h?a:i}bb(e||a&&a.set,"invalid keyPath");h=f.value;i=e?g:a.get(h,g);f=$b(i,b,c,d);return f===i?a:f===g?a.remove(h):(e?Pb():a).set(h,f)}function ac(a){a=a-(a>>1&1431655765);a=(a&858993459)+(a>>2&858993459);a=a+(a>>4)&252645135;a=a+(a>>8);a=a+(a>>16);return a&127}function bc(a,b,c,d){d=d?a:m(a);d[b]=c;return d}function cc(a,b,c,d){var e=a.length+1;if(d&&b+1===e){a[b]=c;return a}d=new Array(e);var f=0;for(var g=0;g<e;g++)g===b?(d[g]=c,f=-1):d[g]=a[g+f];return d}function dc(a,b,c){var d=a.length-1;if(c&&b===d){a.pop();return a}c=new Array(d);var e=0;for(var f=0;f<d;f++)f===b&&(e=1),c[f]=a[f+e];return c}var ec=e/4,fc=e/2,gc=e/4;b(Q,Ga);function Q(a){var b=oc();if(a===null||a===void 0)return b;if(hc(a))return a;var c=v(a),f=c.size;if(f===0)return b;L(f);return f>0&&f<e?mc(0,f,d,null,new jc(c.toArray())):b.withMutations(function(a){a.setSize(f),c.forEach(function(b,c){return a.set(c,b)})})}Q.of=function(){return this(arguments)};Q.prototype.toString=function(){return this.__toString("List [","]")};Q.prototype.get=function(a,b){a=o(this,a);if(a<0||a>=this.size)return b;a+=this._origin;b=sc(this,a);return b&&b.array[a&f]};Q.prototype.set=function(a,b){return pc(this,a,b)};Q.prototype.remove=function(a){return this.has(a)?a===0?this.shift():a===this.size-1?this.pop():this.splice(a,1):this};Q.prototype.clear=function(){if(this.size===0)return this;if(this.__ownerID){this.size=this._origin=this._capacity=0;this._level=d;this._root=this._tail=null;this.__hash=void 0;this.__altered=!0;return this}return oc()};Q.prototype.push=function(){var a=arguments,b=this.size;return this.withMutations(function(c){tc(c,0,b+a.length);for(var d=0;d<a.length;d++)c.set(b+d,a[d])})};Q.prototype.pop=function(){return tc(this,0,-1)};Q.prototype.unshift=function(){var a=arguments;return this.withMutations(function(b){tc(b,-a.length);for(var c=0;c<a.length;c++)b.set(c,a[c])})};Q.prototype.shift=function(){return tc(this,1)};Q.prototype.merge=function(){return uc(this,void 0,arguments)};Q.prototype.mergeWith=function(b){var c=a.call(arguments,1);return uc(this,b,c)};Q.prototype.mergeDeep=function(){return uc(this,Yb(void 0),arguments)};Q.prototype.mergeDeepWith=function(b){var c=a.call(arguments,1);return uc(this,Yb(b),c)};Q.prototype.setSize=function(a){return tc(this,0,a)};Q.prototype.slice=function(a,b){var c=this.size;return q(a,b,c)?this:tc(this,r(a,c),s(b,c))};Q.prototype.__iterator=function(a,b){var c=0,d=lc(this,b);return new C(function(){var b=d();return b===kc?E():D(a,c++,b)})};Q.prototype.__iterate=function(a,b){var c=0;b=lc(this,b);var d;while((d=b())!==kc)if(a(d,c++,this)===!1)break;return c};Q.prototype.__ensureOwner=function(a){if(a===this.__ownerID)return this;if(!a){this.__ownerID=a;return this}return mc(this._origin,this._capacity,this._level,this._root,this._tail,a,this.__hash)};function hc(a){return!!(a&&a[ic])}Q.isList=hc;var ic="@@__IMMUTABLE_LIST__@@",R=Q.prototype;R[ic]=!0;R[c]=R.remove;R.setIn=P.setIn;R.deleteIn=R.removeIn=P.removeIn;R.update=P.update;R.updateIn=P.updateIn;R.mergeIn=P.mergeIn;R.mergeDeepIn=P.mergeDeepIn;R.withMutations=P.withMutations;R.asMutable=P.asMutable;R.asImmutable=P.asImmutable;R.wasAltered=P.wasAltered;function jc(a,b){this.array=a,this.ownerID=b}jc.prototype.removeBefore=function(a,b,c){if(c===b?1<<b:this.array.length===0)return this;var e=c>>>b&f;if(e>=this.array.length)return new jc([],a);var g=e===0,h;if(b>0){var i=this.array[e];h=i&&i.removeBefore(a,b-d,c);if(h===i&&g)return this}if(g&&!h)return this;b=rc(this,a);if(!g)for(var c=0;c<e;c++)b.array[c]=void 0;h&&(b.array[e]=h);return b};jc.prototype.removeAfter=function(a,b,c){if(c===b?1<<b:this.array.length===0)return this;var e=c-1>>>b&f;if(e>=this.array.length)return this;var g=e===this.array.length-1,h;if(b>0){var i=this.array[e];h=i&&i.removeAfter(a,b-d,c);if(h===i&&g)return this}if(g&&!h)return this;b=rc(this,a);g||b.array.pop();h&&(b.array[e]=h);return b};var kc={};function lc(a,b){var c=a._origin,f=a._capacity,g=vc(f),h=a._tail;return i(a._root,a._level,0);function i(a,b,c){return b===0?j(a,c):k(a,b,c)}function j(a,d){var i=d===g?h&&h.array:a&&a.array,j=d>c?0:c-d,k=f-d;k>e&&(k=e);return function(){if(j===k)return kc;var a=b?--k:j++;return i&&i[a]}}function k(a,g,h){var j,k=a&&a.array,l=h>c?0:c-h>>g,m=(f-h>>g)+1;m>e&&(m=e);return function(){do{if(j){var a=j();if(a!==kc)return a;j=null}if(l===m)return kc;a=b?--m:l++;j=i(k&&k[a],g-d,h+(a<<g))}while(!0)}}}function mc(b,c,d,e,f,g,a){var h=Object.create(R);h.size=c-b;h._origin=b;h._capacity=c;h._level=d;h._root=e;h._tail=f;h.__ownerID=g;h.__hash=a;h.__altered=!1;return h}var nc;function oc(){return nc||(nc=mc(0,0,d))}function pc(a,b,c){b=o(a,b);if(b>=a.size||b<0)return a.withMutations(function(a){b<0?tc(a,b).set(0,c):tc(a,0,b+1).set(b,c)});b+=a._origin;var d=a._tail,e=a._root,f=j(i);b>=vc(a._capacity)?d=qc(d,a.__ownerID,0,b,c,f):e=qc(e,a.__ownerID,a._level,b,c,f);if(!f.value)return a;if(a.__ownerID){a._root=e;a._tail=d;a.__hash=void 0;a.__altered=!0;return a}return mc(a._origin,a._capacity,a._level,e,d)}function qc(a,b,c,e,g,h){var i=e>>>c&f,j=a&&i<a.array.length;if(!j&&g===void 0)return a;if(c>0){var l=a&&a.array[i];c=qc(l,b,c-d,e,g,h);if(c===l)return a;e=rc(a,b);e.array[i]=c;return e}if(j&&a.array[i]===g)return a;k(h);e=rc(a,b);g===void 0&&i===e.array.length-1?e.array.pop():e.array[i]=g;return e}function rc(a,b){return b&&a&&b===a.ownerID?a:new jc(a?a.array.slice():[],b)}function sc(a,b){if(b>=vc(a._capacity))return a._tail;if(b<1<<a._level+d){var c=a._root;a=a._level;while(c&&a>0)c=c.array[b>>>a&f],a-=d;return c}}function tc(a,b,c){var e=a.__ownerID||new l(),g=a._origin,h=a._capacity;b=g+b;c=c===void 0?h:c<0?h+c:g+c;if(b===g&&c===h)return a;if(b>=c)return a.clear();var i=a._level,j=a._root,k=0;while(b+k<0)j=new jc(j&&j.array.length?[void 0,j]:[],e),i+=d,k+=1<<i;k&&(b+=k,g+=k,c+=k,h+=k);var m=vc(h),n=vc(c);while(n>=1<<i+d)j=new jc(j&&j.array.length?[j]:[],e),i+=d;var o=a._tail,p=n<m?sc(a,c-1):n>m?new jc([],e):o;if(o&&n>m&&b<h&&o.array.length){j=rc(j,e);var q=j;for(var r=i;r>d;r-=d){var s=m>>>r&f;q=q.array[s]=rc(q.array[s],e)}q.array[m>>>d&f]=o}c<h&&(p=p&&p.removeAfter(e,0,c));if(b>=n)b-=n,c-=n,i=d,j=null,p=p&&p.removeBefore(e,0,b);else if(b>g||n<m){k=0;while(j){s=b>>>i&f;if(s!==n>>>i&f)break;s&&(k+=(1<<i)*s);i-=d;j=j.array[s]}j&&b>g&&(j=j.removeBefore(e,i,b-k));j&&n<m&&(j=j.removeAfter(e,i,n-k));k&&(b-=k,c-=k)}if(a.__ownerID){a.size=c-b;a._origin=b;a._capacity=c;a._level=i;a._root=j;a._tail=p;a.__hash=void 0;a.__altered=!0;return a}return mc(b,c,i,j,p)}function uc(a,b,c){var d=[],e=0;for(var f=0;f<c.length;f++){var g=c[f],h=v(g);h.size>e&&(e=h.size);x(g)||(h=h.map(function(a){return Ia(a)}));d.push(h)}e>a.size&&(a=a.setSize(e));return Zb(a,b,d)}function vc(a){return a<e?0:a-1>>>d<<d}b(S,O);function S(a){return a===null||a===void 0?zc():wc(a)?a:zc().withMutations(function(b){var c=u(a);L(c.size);c.forEach(function(a,c){return b.set(c,a)})})}S.of=function(){return this(arguments)};S.prototype.toString=function(){return this.__toString("OrderedMap {","}")};S.prototype.get=function(a,b){a=this._map.get(a);return a!==void 0?this._list.get(a)[1]:b};S.prototype.clear=function(){if(this.size===0)return this;if(this.__ownerID){this.size=0;this._map.clear();this._list.clear();return this}return zc()};S.prototype.set=function(a,b){return Ac(this,a,b)};S.prototype.remove=function(a){return Ac(this,a,g)};S.prototype.wasAltered=function(){return this._map.wasAltered()||this._list.wasAltered()};S.prototype.__iterate=function(a,b){var c=this;return this._list.__iterate(function(b){return b&&a(b[1],b[0],c)},b)};S.prototype.__iterator=function(a,b){return this._list.fromEntrySeq().__iterator(a,b)};S.prototype.__ensureOwner=function(a){if(a===this.__ownerID)return this;var b=this._map.__ensureOwner(a),c=this._list.__ensureOwner(a);if(!a){this.__ownerID=a;this._map=b;this._list=c;return this}return xc(b,c,a,this.__hash)};function wc(a){return Db(a)&&ca(a)}S.isOrderedMap=wc;S.prototype[ga]=!0;S.prototype[c]=S.prototype.remove;function xc(b,c,d,a){var e=Object.create(S.prototype);e.size=b?b.size:0;e._map=b;e._list=c;e.__ownerID=d;e.__hash=a;return e}var yc;function zc(){return yc||(yc=xc(Pb(),oc()))}function Ac(a,b,c){var d=a._map,f=a._list,h=d.get(b),i=h!==void 0,j,k;if(c===g){if(!i)return a;f.size>=e&&f.size>=d.size*2?(k=f.filter(function(a,b){return a!==void 0&&h!==b}),j=k.toKeyedSeq().map(function(a){return a[0]}).flip().toMap(),a.__ownerID&&(j.__ownerID=k.__ownerID=a.__ownerID)):(j=d.remove(b),k=h===f.size-1?f.pop():f.set(h,void 0))}else if(i){if(c===f.get(h)[1])return a;j=d;k=f.set(h,[b,c])}else j=d.set(b,f.size),k=f.set(f.size,[b,c]);if(a.__ownerID){a.size=j.size;a._map=j;a._list=k;a.__hash=void 0;return a}return xc(j,k)}b(T,Ga);function T(a){return a===null||a===void 0?Gc():Bc(a)?a:Gc().unshiftAll(a)}T.of=function(){return this(arguments)};T.prototype.toString=function(){return this.__toString("Stack [","]")};T.prototype.get=function(a,b){var c=this._head;a=o(this,a);while(c&&a--)c=c.next;return c?c.value:b};T.prototype.peek=function(){return this._head&&this._head.value};T.prototype.push=function(){if(arguments.length===0)return this;var a=this.size+arguments.length,b=this._head;for(var c=arguments.length-1;c>=0;c--)b={value:arguments[c],next:b};if(this.__ownerID){this.size=a;this._head=b;this.__hash=void 0;this.__altered=!0;return this}return Ec(a,b)};T.prototype.pushAll=function(a){a=v(a);if(a.size===0)return this;L(a.size);var b=this.size,c=this._head;a.reverse().forEach(function(a){b++,c={value:a,next:c}});if(this.__ownerID){this.size=b;this._head=c;this.__hash=void 0;this.__altered=!0;return this}return Ec(b,c)};T.prototype.pop=function(){return this.slice(1)};T.prototype.unshift=function(){return this.push.apply(this,arguments)};T.prototype.unshiftAll=function(a){return this.pushAll(a)};T.prototype.shift=function(){return this.pop.apply(this,arguments)};T.prototype.clear=function(){if(this.size===0)return this;if(this.__ownerID){this.size=0;this._head=void 0;this.__hash=void 0;this.__altered=!0;return this}return Gc()};T.prototype.slice=function(a,b){if(q(a,b,this.size))return this;var c=r(a,this.size),d=s(b,this.size);if(d!==this.size)return Ga.prototype.slice.call(this,a,b);d=this.size-c;a=this._head;while(c--)a=a.next;if(this.__ownerID){this.size=d;this._head=a;this.__hash=void 0;this.__altered=!0;return this}return Ec(d,a)};T.prototype.__ensureOwner=function(a){if(a===this.__ownerID)return this;if(!a){this.__ownerID=a;this.__altered=!1;return this}return Ec(this.size,this._head,a,this.__hash)};T.prototype.__iterate=function(a,b){if(b)return this.reverse().__iterate(a);b=0;var c=this._head;while(c){if(a(c.value,b++,this)===!1)break;c=c.next}return b};T.prototype.__iterator=function(a,b){if(b)return this.reverse().__iterator(a);var c=0,d=this._head;return new C(function(){if(d){var b=d.value;d=d.next;return D(a,c++,b)}return E()})};function Bc(a){return!!(a&&a[Cc])}T.isStack=Bc;var Cc="@@__IMMUTABLE_STACK__@@",Dc=T.prototype;Dc[Cc]=!0;Dc.withMutations=P.withMutations;Dc.asMutable=P.asMutable;Dc.asImmutable=P.asImmutable;Dc.wasAltered=P.wasAltered;function Ec(b,c,d,a){var e=Object.create(Dc);e.size=b;e._head=c;e.__ownerID=d;e.__hash=a;e.__altered=!1;return e}var Fc;function Gc(){return Fc||(Fc=Ec(0))}b(U,Ha);function U(a){return a===null||a===void 0?Mc():Hc(a)?a:Mc().withMutations(function(b){var c=w(a);L(c.size);c.forEach(function(a){return b.add(a)})})}U.of=function(){return this(arguments)};U.fromKeys=function(a){return this(u(a).keySeq())};U.prototype.toString=function(){return this.__toString("Set {","}")};U.prototype.has=function(a){return this._map.has(a)};U.prototype.add=function(a){return Jc(this,this._map.set(a,!0))};U.prototype.remove=function(a){return Jc(this,this._map.remove(a))};U.prototype.clear=function(){return Jc(this,this._map.clear())};U.prototype.union=function(){var b=a.call(arguments,0);b=b.filter(function(a){return a.size!==0});if(b.length===0)return this;return this.size===0&&!this.__ownerID&&b.length===1?this.constructor(b[0]):this.withMutations(function(a){for(var c=0;c<b.length;c++)w(b[c]).forEach(function(b){return a.add(b)})})};U.prototype.intersect=function(){var b=a.call(arguments,0);if(b.length===0)return this;b=b.map(function(a){return w(a)});var c=this;return this.withMutations(function(a){c.forEach(function(c){b.every(function(a){return a.includes(c)})||a.remove(c)})})};U.prototype.subtract=function(){var b=a.call(arguments,0);if(b.length===0)return this;b=b.map(function(a){return w(a)});var c=this;return this.withMutations(function(a){c.forEach(function(c){b.some(function(a){return a.includes(c)})&&a.remove(c)})})};U.prototype.merge=function(){return this.union.apply(this,arguments)};U.prototype.mergeWith=function(b){var c=a.call(arguments,1);return this.union.apply(this,c)};U.prototype.sort=function(a){return Nc(sb(this,a))};U.prototype.sortBy=function(a,b){return Nc(sb(this,b,a))};U.prototype.wasAltered=function(){return this._map.wasAltered()};U.prototype.__iterate=function(a,b){var c=this;return this._map.__iterate(function(b,d){return a(d,d,c)},b)};U.prototype.__iterator=function(a,b){return this._map.map(function(a,b){return b}).__iterator(a,b)};U.prototype.__ensureOwner=function(a){if(a===this.__ownerID)return this;var b=this._map.__ensureOwner(a);if(!a){this.__ownerID=a;this._map=b;return this}return this.__make(b,a)};function Hc(a){return!!(a&&a[Ic])}U.isSet=Hc;var Ic="@@__IMMUTABLE_SET__@@",V=U.prototype;V[Ic]=!0;V[c]=V.remove;V.mergeDeep=V.merge;V.mergeDeepWith=V.mergeWith;V.withMutations=P.withMutations;V.asMutable=P.asMutable;V.asImmutable=P.asImmutable;V.__empty=Mc;V.__make=Kc;function Jc(a,b){if(a.__ownerID){a.size=b.size;a._map=b;return a}return b===a._map?a:b.size===0?a.__empty():a.__make(b)}function Kc(a,b){var c=Object.create(V);c.size=a?a.size:0;c._map=a;c.__ownerID=b;return c}var Lc;function Mc(){return Lc||(Lc=Kc(Pb()))}b(Nc,U);function Nc(a){return a===null||a===void 0?Sc():Oc(a)?a:Sc().withMutations(function(b){var c=w(a);L(c.size);c.forEach(function(a){return b.add(a)})})}Nc.of=function(){return this(arguments)};Nc.fromKeys=function(a){return this(u(a).keySeq())};Nc.prototype.toString=function(){return this.__toString("OrderedSet {","}")};function Oc(a){return Hc(a)&&ca(a)}Nc.isOrderedSet=Oc;var Pc=Nc.prototype;Pc[ga]=!0;Pc.__empty=Sc;Pc.__make=Qc;function Qc(a,b){var c=Object.create(Pc);c.size=a?a.size:0;c._map=a;c.__ownerID=b;return c}var Rc;function Sc(){return Rc||(Rc=Qc(zc()))}b(W,Fa);function W(a,b){var c,d=function(f){if(f instanceof d)return f;if(!(this instanceof d))return new d(f);if(!c){c=!0;var g=Object.keys(a);Vc(e,g);e.size=g.length;e._name=b;e._keys=g;e._defaultValues=a}this._map=O(f)},e=d.prototype=Object.create(X);e.constructor=d;return d}W.prototype.toString=function(){return this.__toString(Uc(this)+" {","}")};W.prototype.has=function(a){return this._defaultValues.hasOwnProperty(a)};W.prototype.get=function(a,b){if(!this.has(a))return b;b=this._defaultValues[a];return this._map?this._map.get(a,b):b};W.prototype.clear=function(){if(this.__ownerID){this._map&&this._map.clear();return this}var a=this.constructor;return a._empty||(a._empty=Tc(this,Pb()))};W.prototype.set=function(a,b){if(!this.has(a))throw new Error('Cannot set unknown key "'+a+'" on '+Uc(this));a=this._map&&this._map.set(a,b);return this.__ownerID||a===this._map?this:Tc(this,a)};W.prototype.remove=function(a){if(!this.has(a))return this;a=this._map&&this._map.remove(a);return this.__ownerID||a===this._map?this:Tc(this,a)};W.prototype.wasAltered=function(){return this._map.wasAltered()};W.prototype.__iterator=function(a,b){var c=this;return u(this._defaultValues).map(function(a,b){return c.get(b)}).__iterator(a,b)};W.prototype.__iterate=function(a,b){var c=this;return u(this._defaultValues).map(function(a,b){return c.get(b)}).__iterate(a,b)};W.prototype.__ensureOwner=function(a){if(a===this.__ownerID)return this;var b=this._map&&this._map.__ensureOwner(a);if(!a){this.__ownerID=a;this._map=b;return this}return Tc(this,b,a)};var X=W.prototype;X[c]=X.remove;X.deleteIn=X.removeIn=P.removeIn;X.merge=P.merge;X.mergeWith=P.mergeWith;X.mergeIn=P.mergeIn;X.mergeDeep=P.mergeDeep;X.mergeDeepWith=P.mergeDeepWith;X.mergeDeepIn=P.mergeDeepIn;X.setIn=P.setIn;X.update=P.update;X.updateIn=P.updateIn;X.withMutations=P.withMutations;X.asMutable=P.asMutable;X.asImmutable=P.asImmutable;function Tc(a,b,c){a=Object.create(Object.getPrototypeOf(a));a._map=b;a.__ownerID=c;return a}function Uc(a){return a._name||a.constructor.name||"Record"}function Vc(a,b){try{b.forEach(Wc.bind(void 0,a))}catch(a){}}function Wc(a,b){Object.defineProperty(a,b,{get:function(){return this.get(b)},set:function(a){bb(this.__ownerID,"Cannot set on an immutable record."),this.set(b,a)}})}function Xc(a,b){if(a===b)return!0;if(!x(b)||a.size!==void 0&&b.size!==void 0&&a.size!==b.size||a.__hash!==void 0&&b.__hash!==void 0&&a.__hash!==b.__hash||y(a)!==y(b)||z(a)!==z(b)||ca(a)!==ca(b))return!1;if(a.size===0&&b.size===0)return!0;var c=!ba(a);if(ca(a)){var d=a.entries();return b.every(function(a,b){var e=d.next().value;return e&&J(e[1],a)&&(c||J(e[0],b))})&&d.next().done}var e=!1;if(a.size===void 0)if(b.size===void 0)typeof a.cacheResult==="function"&&a.cacheResult();else{e=!0;var f=a;a=b;b=f}f=!0;b=b.__iterate(function(b,d){if(c?!a.has(b):e?!J(b,a.get(d,g)):!J(a.get(d,g),b)){f=!1;return!1}});return f&&a.size===b}b(Y,H);function Y(a,b,c){if(!(this instanceof Y))return new Y(a,b,c);bb(c!==0,"Cannot step a Range by 0");a=a||0;b===void 0&&(b=Infinity);c=c===void 0?1:Math.abs(c);b<a&&(c=-c);this._start=a;this._end=b;this._step=c;this.size=Math.max(0,Math.ceil((b-a)/c-1)+1);if(this.size===0){if(Yc)return Yc;Yc=this}}Y.prototype.toString=function(){return this.size===0?"Range []":"Range [ "+this._start+"..."+this._end+(this._step>1?" by "+this._step:"")+" ]"};Y.prototype.get=function(a,b){return this.has(a)?this._start+o(this,a)*this._step:b};Y.prototype.includes=function(a){a=(a-this._start)/this._step;return a>=0&&a<this.size&&a===Math.floor(a)};Y.prototype.slice=function(a,b){if(q(a,b,this.size))return this;a=r(a,this.size);b=s(b,this.size);return b<=a?new Y(0,0):new Y(this.get(a,this._end),this.get(b,this._end),this._step)};Y.prototype.indexOf=function(a){a=a-this._start;if(a%this._step===0){a=a/this._step;if(a>=0&&a<this.size)return a}return-1};Y.prototype.lastIndexOf=function(a){return this.indexOf(a)};Y.prototype.__iterate=function(a,b){var c=this.size-1,d=this._step,e=b?this._start+c*d:this._start;for(var f=0;f<=c;f++){if(a(e,f,this)===!1)return f+1;e+=b?-d:d}return f};Y.prototype.__iterator=function(a,b){var c=this.size-1,d=this._step,e=b?this._start+c*d:this._start,f=0;return new C(function(){var g=e;e+=b?-d:d;return f>c?E():D(a,f++,g)})};Y.prototype.equals=function(a){return a instanceof Y?this._start===a._start&&this._end===a._end&&this._step===a._step:Xc(this,a)};var Yc;b(Z,H);function Z(a,b){if(!(this instanceof Z))return new Z(a,b);this._value=a;this.size=b===void 0?Infinity:Math.max(0,b);if(this.size===0){if(Zc)return Zc;Zc=this}}Z.prototype.toString=function(){return this.size===0?"Repeat []":"Repeat [ "+this._value+" "+this.size+" times ]"};Z.prototype.get=function(a,b){return this.has(a)?this._value:b};Z.prototype.includes=function(a){return J(this._value,a)};Z.prototype.slice=function(a,b){var c=this.size;return q(a,b,c)?this:new Z(this._value,s(b,c)-r(a,c))};Z.prototype.reverse=function(){return this};Z.prototype.indexOf=function(a){return J(this._value,a)?0:-1};Z.prototype.lastIndexOf=function(a){return J(this._value,a)?this.size:-1};Z.prototype.__iterate=function(a,b){for(var b=0;b<this.size;b++)if(a(this._value,b,this)===!1)return b+1;return b};Z.prototype.__iterator=function(a,b){var c=this,d=0;return new C(function(){return d<c.size?D(a,d++,c._value):E()})};Z.prototype.equals=function(a){return a instanceof Z?J(this._value,a._value):Xc(a)};var Zc;function $c(a,b){var c=function(c){a.prototype[c]=b[c]};Object.keys(b).forEach(c);Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(b).forEach(c);return a}t.Iterator=C;$c(t,{toArray:function(){L(this.size);var a=new Array(this.size||0);this.valueSeq().__iterate(function(b,c){a[c]=b});return a},toIndexedSeq:function(){return new cb(this)},toJS:function(){return this.toSeq().map(function(a){return a&&typeof a.toJS==="function"?a.toJS():a}).__toJS()},toJSON:function(){return this.toSeq().map(function(a){return a&&typeof a.toJSON==="function"?a.toJSON():a}).__toJS()},toKeyedSeq:function(){return new M(this,!0)},toMap:function(){return O(this.toKeyedSeq())},toObject:function(){L(this.size);var a={};this.__iterate(function(b,c){a[c]=b});return a},toOrderedMap:function(){return S(this.toKeyedSeq())},toOrderedSet:function(){return Nc(y(this)?this.valueSeq():this)},toSet:function(){return U(y(this)?this.valueSeq():this)},toSetSeq:function(){return new db(this)},toSeq:function(){return z(this)?this.toIndexedSeq():y(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return T(y(this)?this.valueSeq():this)},toList:function(){return Q(y(this)?this.valueSeq():this)},toString:function(){return"[Iterable]"},__toString:function(a,b){return this.size===0?a+b:a+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+b},concat:function(){var b=a.call(arguments,0);return N(this,ob(this,b))},contains:function(a){return this.includes(a)},includes:function(a){return this.some(function(b){return J(b,a)})},entries:function(){return this.__iterator(B)},every:function(a,b){L(this.size);var c=!0;this.__iterate(function(d,e,f){if(!a.call(b,d,e,f)){c=!1;return!1}});return c},filter:function(a,b){return N(this,ib(this,a,b,!0))},find:function(a,b,c){a=this.findEntry(a,b);return a?a[1]:c},findEntry:function(a,b){var c;this.__iterate(function(d,e,f){if(a.call(b,d,e,f)){c=[e,d];return!1}});return c},findLastEntry:function(a,b){return this.toSeq().reverse().findEntry(a,b)},forEach:function(a,b){L(this.size);return this.__iterate(b?a.bind(b):a)},join:function(a){L(this.size);a=a!==void 0?""+a:",";var b="",c=!0;this.__iterate(function(d){c?c=!1:b+=a,b+=d!==null&&d!==void 0?d.toString():""});return b},keys:function(){return this.__iterator(ha)},map:function(a,b){return N(this,gb(this,a,b))},reduce:function(a,b,c){L(this.size);var d,e;arguments.length<2?e=!0:d=b;this.__iterate(function(b,f,g){e?(e=!1,d=b):d=a.call(c,d,b,f,g)});return d},reduceRight:function(a,b,c){var d=this.toKeyedSeq().reverse();return d.reduce.apply(d,arguments)},reverse:function(){return N(this,hb(this,!0))},slice:function(a,b){return N(this,lb(this,a,b,!0))},some:function(a,b){return!this.every(cd(a),b)},sort:function(a){return N(this,sb(this,a))},values:function(){return this.__iterator(A)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return this.size!==void 0?this.size===0:!this.some(function(){return!0})},count:function(a,b){return n(a?this.toSeq().filter(a,b):this)},countBy:function(a,b){return jb(this,a,b)},equals:function(a){return Xc(this,a)},entrySeq:function(){var a=this;if(a._cache)return new ra(a._cache);var b=a.toSeq().map(bd).toIndexedSeq();b.fromEntrySeq=function(){return a.toSeq()};return b},filterNot:function(a,b){return this.filter(cd(a),b)},findLast:function(a,b,c){return this.toKeyedSeq().reverse().find(a,b,c)},first:function(){return this.find(p)},flatMap:function(a,b){return N(this,qb(this,a,b))},flatten:function(a){return N(this,pb(this,a,!0))},fromEntrySeq:function(){return new eb(this)},get:function(a,b){return this.find(function(b,c){return J(c,a)},void 0,b)},getIn:function(a,b){var c=this;a=Cb(a);var d;while(!(d=a.next()).done){d=d.value;c=c&&c.get?c.get(d,g):g;if(c===g)return b}return c},groupBy:function(a,b){return kb(this,a,b)},has:function(a){return this.get(a,g)!==g},hasIn:function(a){return this.getIn(a,g)!==g},isSubset:function(a){a=typeof a.includes==="function"?a:t(a);return this.every(function(b){return a.includes(b)})},isSuperset:function(a){return a.isSubset(this)},keySeq:function(){return this.toSeq().map(ad).toIndexedSeq()},last:function(){return this.toSeq().reverse().first()},max:function(a){return tb(this,a)},maxBy:function(a,b){return tb(this,b,a)},min:function(a){return tb(this,a?dd(a):gd)},minBy:function(a,b){return tb(this,b?dd(b):gd,a)},rest:function(){return this.slice(1)},skip:function(a){return this.slice(Math.max(0,a))},skipLast:function(a){return N(this,this.toSeq().reverse().skip(a).reverse())},skipWhile:function(a,b){return N(this,nb(this,a,b,!0))},skipUntil:function(a,b){return this.skipWhile(cd(a),b)},sortBy:function(a,b){return N(this,sb(this,b,a))},take:function(a){return this.slice(0,Math.max(0,a))},takeLast:function(a){return N(this,this.toSeq().reverse().take(a).reverse())},takeWhile:function(a,b){return N(this,mb(this,a,b))},takeUntil:function(a,b){return this.takeWhile(cd(a),b)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=hd(this))}});var $=t.prototype;$[da]=!0;$[ka]=$.values;$.__toJS=$.toArray;$.__toStringMapper=ed;$.inspect=$.toSource=function(){return this.toString()};$.chain=$.flatMap;(function(){try{Object.defineProperty($,"length",{get:function(){if(!t.noLengthWarning){var a;try{throw new Error()}catch(b){a=b.stack}if(a.indexOf("_wrapObject")===-1){console&&emptyFunction&&!1;return this.size}}}})}catch(a){}})();$c(u,{flip:function(){return N(this,fb(this))},findKey:function(a,b){a=this.findEntry(a,b);return a&&a[0]},findLastKey:function(a,b){return this.toSeq().reverse().findKey(a,b)},keyOf:function(a){return this.findKey(function(b){return J(b,a)})},lastKeyOf:function(a){return this.findLastKey(function(b){return J(b,a)})},mapEntries:function(a,b){var c=this,d=0;return N(this,this.toSeq().map(function(e,f){return a.call(b,[f,e],d++,c)}).fromEntrySeq())},mapKeys:function(a,b){var c=this;return N(this,this.toSeq().flip().map(function(d,e){return a.call(b,d,e,c)}).flip())}});c=u.prototype;c[ea]=!0;c[ka]=$.entries;c.__toJS=$.toObject;c.__toStringMapper=function(a,b){return JSON.stringify(b)+": "+ed(a)};$c(v,{toKeyedSeq:function(){return new M(this,!1)},filter:function(a,b){return N(this,ib(this,a,b,!1))},findIndex:function(a,b){a=this.findEntry(a,b);return a?a[0]:-1},indexOf:function(a){a=this.toKeyedSeq().keyOf(a);return a===void 0?-1:a},lastIndexOf:function(a){return this.toSeq().reverse().indexOf(a)},reverse:function(){return N(this,hb(this,!1))},slice:function(a,b){return N(this,lb(this,a,b,!1))},splice:function(a,b){var c=arguments.length;b=Math.max(b|0,0);if(c===0||c===2&&!b)return this;a=r(a,this.size);var d=this.slice(0,a);return N(this,c===1?d:d.concat(m(arguments,2),this.slice(a+b)))},findLastIndex:function(a,b){a=this.toKeyedSeq().findLastKey(a,b);return a===void 0?-1:a},first:function(){return this.get(0)},flatten:function(a){return N(this,pb(this,a,!1))},get:function(a,b){a=o(this,a);return a<0||this.size===Infinity||this.size!==void 0&&a>this.size?b:this.find(function(b,c){return c===a},void 0,b)},has:function(a){a=o(this,a);return a>=0&&(this.size!==void 0?this.size===Infinity||a<this.size:this.indexOf(a)!==-1)},interpose:function(a){return N(this,rb(this,a))},interleave:function(){var a=[this].concat(m(arguments)),b=vb(this.toSeq(),H.of,a),c=b.flatten(!0);b.size&&(c.size=b.size*a.length);return N(this,c)},last:function(){return this.get(-1)},skipWhile:function(a,b){return N(this,nb(this,a,b,!1))},zip:function(){var a=[this].concat(m(arguments));return N(this,vb(this,fd,a))},zipWith:function(a){var b=m(arguments);b[0]=this;return N(this,vb(this,a,b))}});v.prototype[fa]=!0;v.prototype[ga]=!0;$c(w,{get:function(a,b){return this.has(a)?a:b},includes:function(a){return this.has(a)},keySeq:function(){return this.valueSeq()}});w.prototype.has=$.includes;$c(G,u.prototype);$c(H,v.prototype);$c(I,w.prototype);$c(Fa,u.prototype);$c(Ga,v.prototype);$c(Ha,w.prototype);function ad(a,b){return b}function bd(a,b){return[b,a]}function cd(a){return function(){return!a.apply(this,arguments)}}function dd(a){return function(){return-a.apply(this,arguments)}}function ed(a){return typeof a==="string"?JSON.stringify(a):a}function fd(){return m(arguments)}function gd(a,b){return a<b?1:a>b?-1:0}function hd(a){if(a.size===Infinity)return 0;var b=ca(a),c=y(a),d=b?1:0;a=a.__iterate(c?b?function(a,b){d=31*d+jd(K(a),K(b))|0}:function(a,b){d=d+jd(K(a),K(b))|0}:b?function(a){d=31*d+K(a)|0}:function(a){d=d+K(a)|0});return id(a,d)}function id(a,b){b=Ma(b,3432918353);b=Ma(b<<15|b>>>-15,461845907);b=Ma(b<<13|b>>>-13,5);b=(b+3864292196|0)^a;b=Ma(b^b>>>16,2246822507);b=Ma(b^b>>>13,3266489909);b=Na(b^b>>>16);return b}function jd(a,b){return a^b+2654435769+(a<<6)+(a>>2)|0}b={Iterable:t,Seq:F,Collection:Ea,Map:O,OrderedMap:S,List:Q,Stack:T,Set:U,OrderedSet:Nc,Record:W,Range:Y,Repeat:Z,is:J,fromJS:Ia};return b})}),null);
__d("CharacterMetadata",["immutable"],(function(a,b,c,d,e,f){"use strict";var g=b("immutable").Map,h=b("immutable").OrderedSet;a=b("immutable").Record;var i=h();c={style:i,entity:null};d=a(c);f=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.getStyle=function(){return this.get("style")};c.getEntity=function(){return this.get("entity")};c.hasStyle=function(a){return this.getStyle().includes(a)};b.applyStyle=function(a,c){a=a.set("style",a.getStyle().add(c));return b.create(a)};b.removeStyle=function(a,c){a=a.set("style",a.getStyle().remove(c));return b.create(a)};b.applyEntity=function(a,c){a=a.getEntity()===c?a:a.set("entity",c);return b.create(a)};b.create=function(a){if(!a)return j;var c={style:i,entity:null};c=g(c).merge(a);a=k.get(c);if(a)return a;a=new b(c);k=k.set(c,a);return a};b.fromJS=function(a){var c=a.style;a=a.entity;return new b({style:Array.isArray(c)?h(c):c,entity:Array.isArray(a)?h(a):a})};return b}(d);var j=new f(),k=g([[g(c),j]]);f.EMPTY=j;e.exports=f}),null);
__d("findRangesImmutable",[],(function(a,b,c,d,e,f){"use strict";function a(a,b,c,d){if(!a.size)return;var e=0;a.reduce(function(a,f,g){b(a,f)||(c(a)&&d(e,g),e=g);return f});c(a.last())&&d(e,a.count())}e.exports=a}),null);
__d("ContentBlockNode",["CharacterMetadata","findRangesImmutable","immutable"],(function(a,b,c,d,e,f){"use strict";var g=(a=b("immutable")).List;c=a.Map;d=a.OrderedSet;f=a.Record;var h=a.Repeat,i=d(),j={parent:null,characterList:g(),data:c(),depth:0,key:"",text:"",type:"unstyled",children:g(),prevSibling:null,nextSibling:null},k=function(a,b){return a.getStyle()===b.getStyle()},l=function(a,b){return a.getEntity()===b.getEntity()},m=function(a){if(!a)return a;var c=a.characterList,d=a.text;d&&!c&&(a.characterList=g(h(b("CharacterMetadata").EMPTY,d.length)));return a};a=function(a){babelHelpers.inheritsLoose(c,a);function c(b){b===void 0&&(b=j);return a.call(this,m(b))||this}var d=c.prototype;d.getKey=function(){return this.get("key")};d.getType=function(){return this.get("type")};d.getText=function(){return this.get("text")};d.getCharacterList=function(){return this.get("characterList")};d.getLength=function(){return this.getText().length};d.getDepth=function(){return this.get("depth")};d.getData=function(){return this.get("data")};d.getInlineStyleAt=function(a){a=this.getCharacterList().get(a);return a?a.getStyle():i};d.getEntityAt=function(a){a=this.getCharacterList().get(a);return a?a.getEntity():null};d.getChildKeys=function(){return this.get("children")};d.getParentKey=function(){return this.get("parent")};d.getPrevSiblingKey=function(){return this.get("prevSibling")};d.getNextSiblingKey=function(){return this.get("nextSibling")};d.findStyleRanges=function(a,c){b("findRangesImmutable")(this.getCharacterList(),k,a,c)};d.findEntityRanges=function(a,c){b("findRangesImmutable")(this.getCharacterList(),l,a,c)};return c}(f(j));e.exports=a}),null);
__d("generateRandomKey",[],(function(a,b,c,d,e,f){"use strict";var g={},h=Math.pow(2,24);function a(){var a;while(a===void 0||Object.prototype.hasOwnProperty.call(g,a)||!isNaN(+a))a=Math.floor(Math.random()*h).toString(32);g[a]=!0;return a}e.exports=a}),null);
__d("BlockMapBuilder",["immutable"],(function(a,b,c,d,e,f){"use strict";var g=b("immutable").OrderedMap;a={createFromArray:function(a){return g(a.map(function(a){return[a.getKey(),a]}))}};e.exports=a}),null);
__d("BlockTree",["findRangesImmutable","getOwnObjectValues","immutable"],(function(a,b,c,d,e,f){"use strict";var g=b("immutable").List,h=b("immutable").Repeat;a=b("immutable").Record;var i=function(){return!0};c={start:null,end:null};var j=a(c);d={start:null,end:null,decoratorKey:null,leaves:null};var k=a(d);f={generate:function(a,c,d){var e=c.getLength();if(!e)return g.of(new k({start:0,end:0,decoratorKey:null,leaves:g.of(new j({start:0,end:0}))}));var f=[],n=d?d.getDecorations(c,a):g(h(null,e)),o=c.getCharacterList();b("findRangesImmutable")(n,m,i,function(a,b){f.push(new k({start:a,end:b,decoratorKey:n.get(a),leaves:l(o.slice(a,b).toList(),a)}))});return g(f)},fromJS:function(a){var c=a.leaves;a=babelHelpers.objectWithoutPropertiesLoose(a,["leaves"]);return new k(babelHelpers["extends"]({},a,{leaves:c!=null?g(Array.isArray(c)?c:b("getOwnObjectValues")(c)).map(function(a){return j(a)}):null}))}};function l(a,c){var d=[];a=a.map(function(a){return a.getStyle()}).toList();b("findRangesImmutable")(a,m,i,function(a,b){d.push(new j({start:a+c,end:b+c}))});return g(d)}function m(a,b){return a===b}e.exports=f}),null);
__d("ContentBlock",["CharacterMetadata","findRangesImmutable","immutable"],(function(a,b,c,d,e,f){"use strict";var g=(a=b("immutable")).List;c=a.Map;d=a.OrderedSet;f=a.Record;var h=a.Repeat,i=d();a={key:"",type:"unstyled",text:"",characterList:g(),depth:0,data:c()};d=f(a);var j=function(a){if(!a)return a;var c=a.characterList,d=a.text;d&&!c&&(a.characterList=g(h(b("CharacterMetadata").EMPTY,d.length)));return a};c=function(a){babelHelpers.inheritsLoose(c,a);function c(b){return a.call(this,j(b))||this}var d=c.prototype;d.getKey=function(){return this.get("key")};d.getType=function(){return this.get("type")};d.getText=function(){return this.get("text")};d.getCharacterList=function(){return this.get("characterList")};d.getLength=function(){return this.getText().length};d.getDepth=function(){return this.get("depth")};d.getData=function(){return this.get("data")};d.getInlineStyleAt=function(a){a=this.getCharacterList().get(a);return a?a.getStyle():i};d.getEntityAt=function(a){a=this.getCharacterList().get(a);return a?a.getEntity():null};d.findStyleRanges=function(a,c){b("findRangesImmutable")(this.getCharacterList(),k,a,c)};d.findEntityRanges=function(a,c){b("findRangesImmutable")(this.getCharacterList(),l,a,c)};return c}(d);function k(a,b){return a.getStyle()===b.getStyle()}function l(a,b){return a.getEntity()===b.getEntity()}e.exports=c}),null);
__d("DraftEntityInstance",["immutable"],(function(a,b,c,d,e,f){"use strict";a=b("immutable").Record;c=a({type:"TOKEN",mutability:"IMMUTABLE",data:Object});d=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.getType=function(){return this.get("type")};c.getMutability=function(){return this.get("mutability")};c.getData=function(){return this.get("data")};return b}(c);e.exports=d}),null);
__d("DraftEntity",["invariant","DraftEntityInstance","immutable","uuid"],(function(a,b,c,d,e,f,g){a=b("immutable").OrderedMap;var h=a(),i=b("uuid")(),j={__getAll:function(){return h},__loadWithEntities:function(a){h=a,i=b("uuid")()},__getLastCreatedEntityKey:function(){return i},__create:function(a,c,d){return j.__add(new(b("DraftEntityInstance"))({type:a,mutability:c,data:d||{}}))},__add:function(a){i=b("uuid")();h=h.set(i,a);return i},__get:function(a){var b=h.get(a);!b&&g(0,2105,a);return b},get:function(a){return j.__get(a)},set:function(a,b){h=h.set(a,b);return j},last:function(){return h.last()},__mergeData:function(a,b){var c=j.__get(a);b=babelHelpers["extends"]({},c.getData(),b);c=c.set("data",b);h=h.set(a,c);return c},__replaceData:function(a,b){var c=j.__get(a);c=c.set("data",b);h=h.set(a,c);return c}};e.exports=j}),null);
__d("SelectionState",["immutable"],(function(a,b,c,d,e,f){"use strict";a=b("immutable").Record;c={anchorKey:"",anchorOffset:0,focusKey:"",focusOffset:0,isBackward:!1,hasFocus:!1};d=a(c);f=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.serialize=function(){return"Anchor: "+this.getAnchorKey()+":"+this.getAnchorOffset()+", Focus: "+this.getFocusKey()+":"+this.getFocusOffset()+", Is Backward: "+String(this.getIsBackward())+", Has Focus: "+String(this.getHasFocus())};c.getAnchorKey=function(){return this.get("anchorKey")};c.getAnchorOffset=function(){return this.get("anchorOffset")};c.getFocusKey=function(){return this.get("focusKey")};c.getFocusOffset=function(){return this.get("focusOffset")};c.getIsBackward=function(){return this.get("isBackward")};c.getHasFocus=function(){return this.get("hasFocus")};c.hasEdgeWithin=function(a,b,c){var d=this.getAnchorKey(),e=this.getFocusKey();if(d===e&&d===a){var f=this.getStartOffset(),g=this.getEndOffset();return b<=f&&f<=c||b<=g&&g<=c}if(a!==d&&a!==e)return!1;f=a===d?this.getAnchorOffset():this.getFocusOffset();return b<=f&&c>=f};c.isCollapsed=function(){return this.getAnchorKey()===this.getFocusKey()&&this.getAnchorOffset()===this.getFocusOffset()};c.getStartKey=function(){return this.getIsBackward()?this.getFocusKey():this.getAnchorKey()};c.getStartOffset=function(){return this.getIsBackward()?this.getFocusOffset():this.getAnchorOffset()};c.getEndKey=function(){return this.getIsBackward()?this.getAnchorKey():this.getFocusKey()};c.getEndOffset=function(){return this.getIsBackward()?this.getAnchorOffset():this.getFocusOffset()};b.createEmpty=function(a){return new b({anchorKey:a,anchorOffset:0,focusKey:a,focusOffset:0,isBackward:!1,hasFocus:!1})};return b}(d);e.exports=f}),null);
__d("sanitizeDraftText",[],(function(a,b,c,d,e,f){"use strict";var g=new RegExp("\r","g");function a(a){return a.replace(g,"")}e.exports=a}),null);
__d("ContentState",["BlockMapBuilder","CharacterMetadata","ContentBlock","ContentBlockNode","DraftEntity","SelectionState","generateRandomKey","getOwnObjectValues","gkx","immutable","sanitizeDraftText"],(function(a,b,c,d,e,f){"use strict";var g=(a=b("immutable")).List;c=a.Record;var h=a.Repeat,i=a.Map,j=a.OrderedMap;d={entityMap:null,blockMap:null,selectionBefore:null,selectionAfter:null};f=c(d);var k=b("gkx")("676842")?b("ContentBlockNode"):b("ContentBlock");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getEntityMap=function(){return b("DraftEntity")};d.getBlockMap=function(){return this.get("blockMap")};d.getSelectionBefore=function(){return this.get("selectionBefore")};d.getSelectionAfter=function(){return this.get("selectionAfter")};d.getBlockForKey=function(a){a=this.getBlockMap().get(a);return a};d.getKeyBefore=function(a){return this.getBlockMap().reverse().keySeq().skipUntil(function(b){return b===a}).skip(1).first()};d.getKeyAfter=function(a){return this.getBlockMap().keySeq().skipUntil(function(b){return b===a}).skip(1).first()};d.getBlockAfter=function(a){return this.getBlockMap().skipUntil(function(b,c){return c===a}).skip(1).first()};d.getBlockBefore=function(a){return this.getBlockMap().reverse().skipUntil(function(b,c){return c===a}).skip(1).first()};d.getBlocksAsArray=function(){return this.getBlockMap().toArray()};d.getFirstBlock=function(){return this.getBlockMap().first()};d.getLastBlock=function(){return this.getBlockMap().last()};d.getPlainText=function(a){return this.getBlockMap().map(function(a){return a?a.getText():""}).join(a||"\n")};d.getLastCreatedEntityKey=function(){return b("DraftEntity").__getLastCreatedEntityKey()};d.hasText=function(){var a=this.getBlockMap();return a.size>1||escape(a.first().getText()).replace(/%u200B/g,"").length>0};d.createEntity=function(a,c,d){b("DraftEntity").__create(a,c,d);return this};d.mergeEntityData=function(a,c){b("DraftEntity").__mergeData(a,c);return this};d.replaceEntityData=function(a,c){b("DraftEntity").__replaceData(a,c);return this};d.addEntity=function(a){b("DraftEntity").__add(a);return this};d.getEntity=function(a){return b("DraftEntity").__get(a)};d.getAllEntities=function(){return b("DraftEntity").__getAll()};d.setEntityMap=function(a){b("DraftEntity").__loadWithEntities(a);return this};c.mergeEntityMaps=function(a,b){return a.merge(b.__getAll())};d.replaceEntityMap=function(a){return this.setEntityMap(a.__getAll())};d.setSelectionBefore=function(a){return this.set("selectionBefore",a)};d.setSelectionAfter=function(a){return this.set("selectionAfter",a)};d.setBlockMap=function(a){return this.set("blockMap",a)};c.createFromBlockArray=function(a,d){a=Array.isArray(a)?a:a.contentBlocks;a=b("BlockMapBuilder").createFromArray(a);var e=a.isEmpty()?new(b("SelectionState"))():b("SelectionState").createEmpty(a.first().getKey());return new c({blockMap:a,entityMap:d||b("DraftEntity"),selectionBefore:e,selectionAfter:e})};c.createFromText=function(a,d){d===void 0&&(d=/\r\n?|\n/g);a=a.split(d);d=a.map(function(a){a=b("sanitizeDraftText")(a);return new k({key:b("generateRandomKey")(),text:a,type:"unstyled",characterList:g(h(b("CharacterMetadata").EMPTY,a.length))})});return c.createFromBlockArray(d)};c.fromJS=function(a){return new c(babelHelpers["extends"]({},a,{blockMap:j(a.blockMap).map(c.createContentBlockFromJS),selectionBefore:new(b("SelectionState"))(a.selectionBefore),selectionAfter:new(b("SelectionState"))(a.selectionAfter)}))};c.createContentBlockFromJS=function(a){var c=a.characterList;return new k(babelHelpers["extends"]({},a,{data:i(a.data),characterList:c!=null?g((Array.isArray(c)?c:b("getOwnObjectValues")(c)).map(function(a){return b("CharacterMetadata").fromJS(a)})):void 0}))};return c}(f);e.exports=a}),null);
__d("UnicodeBidiService",["invariant","UnicodeBidi","UnicodeBidiDirection","UnicodeBidiGlobalDirection"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){!a?a=b("UnicodeBidiGlobalDirection").getDir():b("UnicodeBidiDirection").isStrong(a)||g(0,3594),this.$1=a,this.reset()}var c=a.prototype;c.reset=function(){this.$2=this.$1};c.getDirection=function(a){this.$2=b("UnicodeBidi").getDirection(a,this.$2);return this.$2};return a}();e.exports=a}),null);
__d("EditorBidiService",["UnicodeBidiService","immutable","nullthrows"],(function(a,b,c,d,e,f){"use strict";var g=b("immutable").OrderedMap,h;a={getDirectionMap:function(a,c){!h?h=new(b("UnicodeBidiService"))():h.reset();a=a.getBlockMap();var d=a.valueSeq().map(function(a){return b("nullthrows")(h).getDirection(a.getText())});a=g(a.keySeq().zip(d));return c!=null&&b("immutable").is(c,a)?c:a}};e.exports=a}),null);
__d("EditorState",["BlockTree","ContentState","EditorBidiService","SelectionState","immutable"],(function(a,b,c,d,e,f){"use strict";var g=(a=b("immutable")).OrderedSet;c=a.Record;var h=a.Stack,i=a.OrderedMap,j=a.List;d={allowUndo:!0,currentContent:null,decorator:null,directionMap:null,forceSelection:!1,inCompositionMode:!1,inlineStyleOverride:null,lastChangeType:null,nativelyRenderedContent:null,redoStack:h(),selection:null,treeMap:null,undoStack:h()};var k=c(d),l=function(){a.createEmpty=function(a){return this.createWithText("",a)};a.createWithText=function(c,d){return a.createWithContent(b("ContentState").createFromText(c),d)};a.createWithContent=function(c,d){if(c.getBlockMap().count()===0)return a.createEmpty(d);var e=c.getBlockMap().first().getKey();return a.create({currentContent:c,undoStack:h(),redoStack:h(),decorator:d||null,selection:b("SelectionState").createEmpty(e)})};a.create=function(c){var d=c.currentContent,e=c.decorator;c=babelHelpers["extends"]({},c,{treeMap:n(d,e),directionMap:b("EditorBidiService").getDirectionMap(d)});return new a(new k(c))};a.fromJS=function(c){return new a(new k(babelHelpers["extends"]({},c,{directionMap:c.directionMap!=null?i(c.directionMap):c.directionMap,inlineStyleOverride:c.inlineStyleOverride!=null?g(c.inlineStyleOverride):c.inlineStyleOverride,nativelyRenderedContent:c.nativelyRenderedContent!=null?b("ContentState").fromJS(c.nativelyRenderedContent):c.nativelyRenderedContent,redoStack:c.redoStack!=null?h(c.redoStack.map(function(a){return b("ContentState").fromJS(a)})):c.redoStack,selection:c.selection!=null?new(b("SelectionState"))(c.selection):c.selection,treeMap:c.treeMap!=null?i(c.treeMap).map(function(a){return j(a).map(function(a){return b("BlockTree").fromJS(a)})}):c.treeMap,undoStack:c.undoStack!=null?h(c.undoStack.map(function(a){return b("ContentState").fromJS(a)})):c.undoStack,currentContent:b("ContentState").fromJS(c.currentContent)})))};a.set=function(b,c){var d=b.getImmutable().withMutations(function(a){var d=a.get("decorator"),e=d;c.decorator===null?e=null:c.decorator&&(e=c.decorator);var f=c.currentContent||b.getCurrentContent();if(e!==d){var g=a.get("treeMap");e&&d?g=p(f,f.getBlockMap(),g,e,d):g=n(f,e);a.merge({decorator:e,treeMap:g,nativelyRenderedContent:null});return}d=b.getCurrentContent();f!==d&&a.set("treeMap",o(b,f.getBlockMap(),f.getEntityMap(),e));a.merge(c)});return new a(d)};var c=a.prototype;c.toJS=function(){return this.getImmutable().toJS()};c.getAllowUndo=function(){return this.getImmutable().get("allowUndo")};c.getCurrentContent=function(){return this.getImmutable().get("currentContent")};c.getUndoStack=function(){return this.getImmutable().get("undoStack")};c.getRedoStack=function(){return this.getImmutable().get("redoStack")};c.getSelection=function(){return this.getImmutable().get("selection")};c.getDecorator=function(){return this.getImmutable().get("decorator")};c.isInCompositionMode=function(){return this.getImmutable().get("inCompositionMode")};c.mustForceSelection=function(){return this.getImmutable().get("forceSelection")};c.getNativelyRenderedContent=function(){return this.getImmutable().get("nativelyRenderedContent")};c.getLastChangeType=function(){return this.getImmutable().get("lastChangeType")};c.getInlineStyleOverride=function(){return this.getImmutable().get("inlineStyleOverride")};a.setInlineStyleOverride=function(b,c){return a.set(b,{inlineStyleOverride:c})};c.getCurrentInlineStyle=function(){var a=this.getInlineStyleOverride();if(a!=null)return a;a=this.getCurrentContent();var b=this.getSelection();return b.isCollapsed()?r(a,b):s(a,b)};c.getBlockTree=function(a){return this.getImmutable().getIn(["treeMap",a])};c.isSelectionAtStartOfContent=function(){var a=this.getCurrentContent().getBlockMap().first().getKey();return this.getSelection().hasEdgeWithin(a,0,0)};c.isSelectionAtEndOfContent=function(){var a=this.getCurrentContent();a=a.getBlockMap();a=a.last();var b=a.getLength();return this.getSelection().hasEdgeWithin(a.getKey(),b,b)};c.getDirectionMap=function(){return this.getImmutable().get("directionMap")};a.acceptSelection=function(a,b){return m(a,b,!1)};a.forceSelection=function(a,b){b.getHasFocus()||(b=b.set("hasFocus",!0));return m(a,b,!0)};a.moveSelectionToEnd=function(c){var d=c.getCurrentContent();d=d.getLastBlock();var e=d.getKey();d=d.getLength();return a.acceptSelection(c,new(b("SelectionState"))({anchorKey:e,anchorOffset:d,focusKey:e,focusOffset:d,isBackward:!1}))};a.moveFocusToEnd=function(b){b=a.moveSelectionToEnd(b);return a.forceSelection(b,b.getSelection())};a.push=function(c,d,e,f){f===void 0&&(f=!0);if(c.getCurrentContent()===d)return c;var g=b("EditorBidiService").getDirectionMap(d,c.getDirectionMap());if(!c.getAllowUndo())return a.set(c,{currentContent:d,directionMap:g,lastChangeType:e,selection:d.getSelectionAfter(),forceSelection:f,inlineStyleOverride:null});var i=c.getSelection(),j=c.getCurrentContent(),k=c.getUndoStack(),l=d;i!==j.getSelectionAfter()||q(c,e)?(k=k.push(j),l=l.setSelectionBefore(i)):(e==="insert-characters"||e==="backspace-character"||e==="delete-character")&&(l=l.setSelectionBefore(j.getSelectionBefore()));i=c.getInlineStyleOverride();j=["adjust-depth","change-block-type","split-block"];j.indexOf(e)===-1&&(i=null);j={currentContent:l,directionMap:g,undoStack:k,redoStack:h(),lastChangeType:e,selection:d.getSelectionAfter(),forceSelection:f,inlineStyleOverride:i};return a.set(c,j)};a.undo=function(c){if(!c.getAllowUndo())return c;var d=c.getUndoStack(),e=d.peek();if(!e)return c;var f=c.getCurrentContent(),g=b("EditorBidiService").getDirectionMap(e,c.getDirectionMap());return a.set(c,{currentContent:e,directionMap:g,undoStack:d.shift(),redoStack:c.getRedoStack().push(f),forceSelection:!0,inlineStyleOverride:null,lastChangeType:"undo",nativelyRenderedContent:null,selection:f.getSelectionBefore()})};a.redo=function(c){if(!c.getAllowUndo())return c;var d=c.getRedoStack(),e=d.peek();if(!e)return c;var f=c.getCurrentContent(),g=b("EditorBidiService").getDirectionMap(e,c.getDirectionMap());return a.set(c,{currentContent:e,directionMap:g,undoStack:c.getUndoStack().push(f),redoStack:d.shift(),forceSelection:!0,inlineStyleOverride:null,lastChangeType:"redo",nativelyRenderedContent:null,selection:e.getSelectionAfter()})};function a(a){this.$1=a}c.getImmutable=function(){return this.$1};return a}();function m(a,b,c){return l.set(a,{selection:b,forceSelection:c,nativelyRenderedContent:null,inlineStyleOverride:null})}function n(a,c){return a.getBlockMap().map(function(d){return b("BlockTree").generate(a,d,c)}).toOrderedMap()}function o(a,c,d,e){var f=a.getCurrentContent().replaceEntityMap(d),g=f.getBlockMap();d=a.getImmutable().get("treeMap");return d.merge(c.toSeq().filter(function(a,b){return a!==g.get(b)}).map(function(a){return b("BlockTree").generate(f,a,e)}))}function p(a,c,d,e,f){return d.merge(c.toSeq().filter(function(b){return e.getDecorations(b,a)!==f.getDecorations(b,a)}).map(function(c){return b("BlockTree").generate(a,c,e)}))}function q(a,b){a=a.getLastChangeType();return b!==a||b!=="insert-characters"&&b!=="backspace-character"&&b!=="delete-character"}function r(a,b){var c=b.getStartKey();b=b.getStartOffset();var d=a.getBlockForKey(c);if(b>0)return d.getInlineStyleAt(b-1);return d.getLength()?d.getInlineStyleAt(0):t(a,c)}function s(a,b){var c=b.getStartKey();b=b.getStartOffset();var d=a.getBlockForKey(c);if(b<d.getLength())return d.getInlineStyleAt(b);return b>0?d.getInlineStyleAt(b-1):t(a,c)}function t(a,b){a=a.getBlockMap().reverse().skipUntil(function(a,c){return c===b}).skip(1).skipUntil(function(a,b){return a.getLength()}).first();return a?a.getInlineStyleAt(a.getLength()-1):g()}e.exports=l}),null);
__d("replaceSelectionWithMention",["DraftModifier","EditorState"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a,c,d,e,f){e=e(c.getCurrentContent(),a);var g=e.getLastCreatedEntityKey();f=f?f(a):a.getTitle();a=b("DraftModifier").replaceText(e,d,f,c.getCurrentInlineStyle(),g);return b("EditorState").push(c,a,"insert-fragment")}}),null);
__d("moveSelectionBackward",["warning"],(function(a,b,c,d,e,f){"use strict";function a(a,c){var d=a.getSelection();b("warning")(d.isCollapsed(),"moveSelectionBackward should only be called with a collapsed SelectionState");a=a.getCurrentContent();var e=d.getStartKey(),f=d.getStartOffset(),g=e,h=0;if(c>f){var i=a.getKeyBefore(e);if(i==null)g=e;else{g=i;e=a.getBlockForKey(i);h=e.getText().length}}else h=f-c;return d.merge({focusKey:g,focusOffset:h,isBackward:!0})}e.exports=a}),null);
__d("moveSelectionForward",["warning"],(function(a,b,c,d,e,f){"use strict";function a(a,c){var d=a.getSelection();b("warning")(d.isCollapsed(),"moveSelectionForward should only be called with a collapsed SelectionState");var e=d.getStartKey(),f=d.getStartOffset();a=a.getCurrentContent();var g=e,h=a.getBlockForKey(e);c>h.getText().length-f?(g=a.getKeyAfter(e),h=0):h=f+c;return d.merge({focusKey:g,focusOffset:h})}e.exports=a}),null);
__d("removeTextWithStrategy",["DraftModifier","gkx"],(function(a,b,c,d,e,f){"use strict";var g=b("gkx")("676842");function a(a,c,d){var e=a.getSelection(),f=a.getCurrentContent(),h=e,i=e.getAnchorKey(),j=e.getFocusKey(),k=f.getBlockForKey(i);if(g&&(d==="forward"&&i!==j))return f;if(e.isCollapsed()){if(d==="forward"){if(a.isSelectionAtEndOfContent())return f;if(g){j=e.getAnchorOffset()===f.getBlockForKey(i).getLength();if(j){i=f.getBlockForKey(k.nextSibling);if(!i||i.getLength()===0)return f}}}else if(a.isSelectionAtStartOfContent())return f;h=c(a);if(h===e)return f}return b("DraftModifier").removeRange(f,h,d)}e.exports=a}),null);
__d("getHashtagRegexStringChars",[],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(){var a="\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u024f\u0253-\u0254\u0256-\u0257\u0259\u025b\u0263\u0268\u026f\u0272\u0289\u028b\u02bb\u0300-\u036f\u1e00-\u1eff",b="\u0400-\u04ff\u0500-\u0527\u2de0-\u2dff\ua640-\ua69f\u0591-\u05bf\u05c1-\u05c2\u05c4-\u05c5\u05c7\u05d0-\u05ea\u05f0-\u05f4\ufb12-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4f\u0610-\u061a\u0620-\u065f\u066e-\u06d3\u06d5-\u06dc\u06de-\u06e8\u06ea-\u06ef\u06fa-\u06fc\u06ff\u0750-\u077f\u08a0\u08a2-\u08ac\u08e4-\u08fe\ufb50-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\u200c-\u200c\u0e01-\u0e3a\u0e40-\u0e4e\u1100-\u11ff\u3130-\u3185\ua960-\ua97f\uac00-\ud7af\ud7b0-\ud7ff\uffa1-\uffdc",c=String.fromCharCode;c="\u30a1-\u30fa\u30fc-\u30fe\uff66-\uff9f\uff10-\uff19\uff21-\uff3a\uff41-\uff5a\u3041-\u3096\u3099-\u309e\u3400-\u4dbf\u4e00-\u9fff"+c(173824)+"-"+c(177983)+c(177984)+"-"+c(178207)+c(194560)+"-"+c(195103)+"\u3003\u3005\u303b";a=a+b+c;b="A-Za-z\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u0241\u0250-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ee\u037a\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03ce\u03d0-\u03f5\u03f7-\u0481\u048a-\u04ce\u04d0-\u04f9\u0500-\u050f\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0621-\u063a\u0640-\u064a\u066e-\u066f\u0671-\u06d3\u06d5\u06e5-\u06e6\u06ee-\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u076d\u0780-\u07a5\u07b1\u0904-\u0939\u093d\u0950\u0958-\u0961\u097d\u0985-\u098c\u098f-\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc-\u09dd\u09df-\u09e1\u09f0-\u09f1\u0a05-\u0a0a\u0a0f-\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32-\u0a33\u0a35-\u0a36\u0a38-\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2-\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0-\u0ae1\u0b05-\u0b0c\u0b0f-\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32-\u0b33\u0b35-\u0b39\u0b3d\u0b5c-\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99-\u0b9a\u0b9c\u0b9e-\u0b9f\u0ba3-\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c60-\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0-\u0ce1\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d60-\u0d61\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32-\u0e33\u0e40-\u0e46\u0e81-\u0e82\u0e84\u0e87-\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa-\u0eab\u0ead-\u0eb0\u0eb2-\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6a\u0f88-\u0f8b\u1000-\u1021\u1023-\u1027\u1029-\u102a\u1050-\u1055\u10a0-\u10c5\u10d0-\u10fa\u10fc\u1100-\u1159\u115f-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1681-\u169a\u16a0-\u16ea\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u1900-\u191c\u1950-\u196d\u1970-\u1974\u1980-\u19a9\u19c1-\u19c7\u1a00-\u1a16\u1d00-\u1dbf\u1e00-\u1e9b\u1ea0-\u1ef9\u1f00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u2094\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2131\u2133-\u2139\u213c-\u213f\u2145-\u2149\u2c00-\u2c2e\u2c30-\u2c5e\u2c80-\u2ce4\u2d00-\u2d25\u2d30-\u2d65\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u3005-\u3006\u3031-\u3035\u303b-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312c\u3131-\u318e\u31a0-\u31b7\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fbb\ua000-\ua48c\ua800-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\uac00-\ud7a3\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc";c="\u0300-\u036f\u0483-\u0486\u0591-\u05b9\u05bb-\u05bd\u05bf\u05c1-\u05c2\u05c4-\u05c5\u05c7\u0610-\u0615\u064b-\u065e\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7-\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u0901-\u0903\u093c\u093e-\u094d\u0951-\u0954\u0962-\u0963\u0981-\u0983\u09bc\u09be-\u09c4\u09c7-\u09c8\u09cb-\u09cd\u09d7\u09e2-\u09e3\u0a01-\u0a03\u0a3c\u0a3e-\u0a42\u0a47-\u0a48\u0a4b-\u0a4d\u0a70-\u0a71\u0a81-\u0a83\u0abc\u0abe-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ae2-\u0ae3\u0b01-\u0b03\u0b3c\u0b3e-\u0b43\u0b47-\u0b48\u0b4b-\u0b4d\u0b56-\u0b57\u0b82\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd7\u0c01-\u0c03\u0c3e-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55-\u0c56\u0c82-\u0c83\u0cbc\u0cbe-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5-\u0cd6\u0d02-\u0d03\u0d3e-\u0d43\u0d46-\u0d48\u0d4a-\u0d4d\u0d57\u0d82-\u0d83\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0df2-\u0df3\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb-\u0ebc\u0ec8-\u0ecd\u0f18-\u0f19\u0f35\u0f37\u0f39\u0f3e-\u0f3f\u0f71-\u0f84\u0f86-\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102c-\u1032\u1036-\u1039\u1056-\u1059\u135f\u1712-\u1714\u1732-\u1734\u1752-\u1753\u1772-\u1773\u17b6-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u192b\u1930-\u193b\u19b0-\u19c0\u19c8-\u19c9\u1a17-\u1a1b\u1dc0-\u1dc3\u20d0-\u20dc\u20e1\u20e5-\u20eb\u302a-\u302f\u3099-\u309a\ua802\ua806\ua80b\ua823-\ua827\ufb1e\ufe00-\ufe0f\ufe20-\ufe23";var d="0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u17e0-\u17e9\u1810-\u1819\u1946-\u194f\u19d0-\u19d9\uff10-\uff19";b=b+c+a;c=d+"_";a=b+c;d="#\\uFF03";return{alpha:b,alphanumeric:a,hashChars:d}}}),null);
__d("getHashtagRegexString",["getHashtagRegexStringChars"],(function(a,b,c,d,e,f){e.exports=a;function a(){var a=b("getHashtagRegexStringChars")(),c=a.alpha,d=a.alphanumeric;a=a.hashChars;c="["+c+"]";var e="["+d+"]";d="^|$|[^&/"+d+"]";a="["+a+"]";d="("+d+")("+a+")("+e+"*"+c+e+"*)";return d}}),null);
__d("getHashtagRegex",["getHashtagRegexString"],(function(a,b,c,d,e,f){e.exports=a;function a(){return new RegExp(b("getHashtagRegexString")(),"ig")}}),null);
__d("ComposerMediaFileUploader",["fbt","ActorURI","ReactComposerMediaConfig","VideoUploader","VideoUploadFile","VideoUploadFlowNotifier","VideoUploadSurface","XComposerPhotoUploader","gkx","killswitch","requireCond","cr:1342782"],(function(a,b,c,d,e,f,g){"use strict";var h=function(){function a(){this.subscribers=[]}var b=a.prototype;b.subscribe=function(a){this.subscribers.push(a)};b.notify=function(a){this.subscribers.forEach(function(b){return b(a)})};b.unsubscribe=function(a){this.subscribers=this.subscribers.filter(function(b){return b!==a})};return a}();a=function(){a.createOrGetInstance=function(c,d,e,f){f===void 0&&(f=!1);f=(b("killswitch")("COMET_COMPOSER_MEDIA_UPLOADER_PER_ACTOR_SINGLETON")?a.$1:a.$2.get(c))||new a(c,d,e,f);if(f.creationSessionID!==e){var g;f.creationSessionID=(g=e)!=null?g:"";f.videoUploaderConfig=d;f.videoUploadFlowNotifier=b("VideoUploadFlowNotifier").createVideoUploadFlowNotifier({cancel_on_leave:!1,composer_entry_point_ref:(g=f.videoUploaderConfig.composer_entry_point_ref)!=null?g:"unknown",composer_session_id:(d=e)!=null?d:"",extended_flow_logging_enabled:!0,source:f.videoUploaderConfig.source});b("VideoUploadSurface").VideoUploadSurface.getOrCreate(b("VideoUploadSurface").VideoUploadSurfaceIDs.FEED).notifiers().register(f.videoUploadFlowNotifier,f.creationSessionID)}b("killswitch")("COMET_COMPOSER_MEDIA_UPLOADER_PER_ACTOR_SINGLETON")?a.$1=f:a.$2.set(c,f);return f};a.getInstance=function(c){return b("killswitch")("COMET_COMPOSER_MEDIA_UPLOADER_PER_ACTOR_SINGLETON")?a.$1:a.$2.get(c)};function a(a,c,d,e){this.startedObserver=new h();this.progressObserver=new h();this.successObserver=new h();this.errorObserver=new h();this.uploadStatuses=new Map();this.uploadStatusChangeObserver=new h();this.videoUploadsQueue=[];this.actorID=a;this.videoUploaderConfig=c;this.creationSessionID=(a=d)!=null?a:"";this.photoUploader=this.$3(this.actorID,e);this.videoUploader=this.$4(this.videoUploaderConfig,this.creationSessionID);this.videoUploadFlowNotifier=b("VideoUploadFlowNotifier").createVideoUploadFlowNotifier({cancel_on_leave:!1,composer_entry_point_ref:(c=this.videoUploaderConfig.composer_entry_point_ref)!=null?c:"unknown",composer_session_id:(d=this.creationSessionID)!=null?d:"",extended_flow_logging_enabled:!0,source:this.videoUploaderConfig.source});b("VideoUploadSurface").VideoUploadSurface.getOrCreate(b("VideoUploadSurface").VideoUploadSurfaceIDs.FEED).notifiers().register(this.videoUploadFlowNotifier,this.creationSessionID)}var c=a.prototype;c.$5=function(a,b){var c;c=(c=this.uploadStatuses.get(a))==null?void 0:c.bytesTotal;if(c==null)return;this.uploadStatuses.set(a,{bytesLoaded:(a=b)!=null?a:c,bytesTotal:c});this.uploadStatusChangeObserver.notify(this.uploadStatuses)};c.$3=function(a,c){var d=this;a=b("cr:1342782")!=null&&b("cr:1342782").isSupported()?b("cr:1342782").getSingleton():void 0;return new(b("XComposerPhotoUploader"))({concurrentLimit:b("ReactComposerMediaConfig").photo.concurrentLimit,onUploadFailure:function(a,b){var c;d.errorObserver.notify({entID:(c=b.response.payload)==null?void 0:c.photoID,error:b.response.getErrorSummary(),uploadID:a})},onUploadProgress:function(a,b){var c=Math.min(1,Math.max(0,b.event.loaded/b.event.total));d.progressObserver.notify({percentComplete:c,uploadID:a});d.$5(a,b.event.loaded)},onUploadStart:function(a,b){d.startedObserver.notify({uploadID:a})},onUploadSuccess:function(a,b){var c=b.response.payload;c==null?d.errorObserver.notify({entID:null,error:b.response.getErrorSummary(),uploadID:a}):(d.successObserver.notify({attachmentType:"PHOTO",entID:c.photoID,imageURL:c.imageSrc,uploadID:a}),d.$5(a))},resizer:a,retryLimit:b("ReactComposerMediaConfig").photo.retryLimit,uploadData:babelHelpers["extends"]({},b("ReactComposerMediaConfig").photo.uploadData,{source:8},c?{work_shared_draft_mode:"drafter_creating"}:{}),uploadEndpoint:b("ActorURI").create(b("ReactComposerMediaConfig").photo.uploadEndpoint,this.actorID)})};c.$4=function(a,c){a=babelHelpers["extends"]({},a,{isMultiMediaPost:!0,waterfall_id:c});return new(b("VideoUploader"))(a)};c.upload=function(a){var b=this;a.forEach(function(a){var c=a[0];a[1];a=c.uploadID;a!=null&&b.uploadStatuses.get(a)==null&&b.uploadStatuses.set(a,{bytesLoaded:0,bytesTotal:c.size})});this.uploadStatusChangeObserver.notify(this.uploadStatuses);this.$6(a.filter(function(a){a[0];a=a[1];return a==="PHOTO"}).map(function(a){var b=a[0];a[1];return b}));this.$7(a.filter(function(a){a[0];a=a[1];return a==="VIDEO"}).map(function(a){var b=a[0];a[1];return b}))};c.$6=function(a){a.length>0&&this.photoUploader.getAsyncUploadRequest(a).send()};c.$7=function(a){var c=this;a.length>0&&(this.videoUploadsQueue=this.videoUploadsQueue.concat(a));if(this.videoUploadsQueue.length>0&&!this.videoUploader.isSessionExist()){var d=this.videoUploadsQueue.shift();this.videoUploader=this.$4(this.videoUploaderConfig,this.creationSessionID);var e=this.videoUploader;e.subscribe("upload-started",function(a,b){a=d.uploadID;a!=null&&c.startedObserver.notify({uploadID:a})});e.subscribe("upload-progressed",function(a,b){a=Math.min(1,Math.max(0,(b.start_offset+b.sent_bytes)/b.file_size));var f=d.uploadID;f!=null&&(c.progressObserver.notify({entID:e.getVideoID(),percentComplete:a,uploadID:f}),c.$5(f,b.start_offset+b.sent_bytes))});e.subscribe("upload-finished",function(a,b){e.reset();a=d.uploadID;a!=null&&(c.successObserver.notify({attachmentType:"VIDEO",entID:b.video_id,uploadID:a}),c.$5(a));c.$7([])});e.subscribe("upload-failed",function(a,b){a=d.uploadID;if(a!=null){c.errorObserver.notify({entID:b.video_id,error:(b=b.error_summary)!=null?b:g._("Se produjo un error y no se pudo subir el video. Vuelve a intentarlo."),uploadID:a})}});b("gkx")("1454236")&&this.videoUploadFlowNotifier.registerVideoUpload(e,d.uploadID);e.upload(b("VideoUploadFile").fromFile(d))}};c.getCreationSessionID=function(){return this.creationSessionID};return a}();e.exports=a;a.$1=null;a.$2=new Map()}),null);
__d("CometFeedStoryOptimisticProgressBar.react",["fbt","Actor","ComposerMediaFileUploader","React","RunComet","cometComposerLogger","qex","stylex","useOnBeforeUnload"],(function(a,b,c,d,e,f,g){"use strict";e.exports=a;var h=b("React"),i=b("qex")._("1221850")===!0,j=95;function a(){var a=h.useState(0),c=a[0],d=a[1];a=b("Actor").useActor();a=a[0];var e=b("ComposerMediaFileUploader").getInstance(a),f=h.useRef(!1),k=function(a){a=Array.from(a.values()).reduce(function(a,b){a.bytesLoaded+=b.bytesLoaded;a.bytesTotal+=b.bytesTotal;return a},{bytesLoaded:0,bytesTotal:0});a.bytesLoaded===a.bytesTotal&&(f.current=!0);var b=a.bytesTotal!==0?a.bytesLoaded/a.bytesTotal*j:0;d(function(a){return Math.max(b,a)})};b("useOnBeforeUnload")(function(){if(!f.current)return{warnMessage:g._("Tu publicaci\u00f3n a\u00fan se est\u00e1 subiendo. \u00bfQuieres salir sin finalizar el proceso?")}});h.useEffect(function(){i&&e&&e.uploadStatusChangeObserver.subscribe(k);var a=function(){if(!f.current){var a;b("cometComposerLogger")({fields:{terminalReason:"shutdown"},type:"COMPOSER_POST_TERMINAL"},(a=e==null?void 0:e.getCreationSessionID())!=null?a:"")}},c=b("RunComet").onUnload(a);return function(){i&&e&&e.uploadStatusChangeObserver.unsubscribe(k);return c.remove()}},[e]);return i?h.jsx("div",{className:"h4z51re5 osnr6wyh rv4hoivh jktsbyx5 kgtf8isp ed3p1gfi mwvzfrdb kxcb68kb kgjeooe1 dwerhba3 cwj9ozl2",children:h.jsx("div",{className:"stjgntxs ni8dbmo4 qhh1luux mwvzfrdb kxcb68kb kgjeooe1 dwerhba3",children:h.jsx("div",{className:"b7h9ocf4 flx89l3n tn0ko95a qhh1luux mwvzfrdb kxcb68kb kgjeooe1 dwerhba3 nfl8ryma",style:{transform:"translateX(calc(-100% + "+c+"%))"}})})}):h.jsx("div",{className:"h4z51re5 osnr6wyh rv4hoivh jktsbyx5 kgtf8isp ed3p1gfi mwvzfrdb kxcb68kb kgjeooe1 dwerhba3 cwj9ozl2",children:h.jsx("div",{className:"dd2scrzq qhh1luux mwvzfrdb kxcb68kb kgjeooe1 dwerhba3 nfl8ryma nn0ay230 h9pa7xm5 j1l0snac l10wm3d9"})})}}),null);
__d("SpectrumWasm",["Promise","bx"],(function(a,b,c,d,e,f){var g=b("bx").getURL(b("bx")("1061903")),h=function(){var c=typeof document!=="undefined"&&document.currentScript?document.currentScript.src:void 0;return function(d){d=d||{};var f=typeof d!=="undefined"?d:{},i={},j;for(j in f)Object.prototype.hasOwnProperty.call(f,j)&&(i[j]=f[j]);f.arguments=[];f.thisProgram="./this.program";f.quit=function(a,b){throw b};f.preRun=[];f.postRun=[];var k=!0,l=!1,m="";(k||l)&&(l?m=self.location.href:document.currentScript&&(m=document.currentScript.src),c&&(m=c),m.indexOf("blob:")!==0?m=m.substr(0,m.lastIndexOf("/")+1):m="",f.read=function(a){var b=new XMLHttpRequest();b.open("GET",a,!1);b.send(null);return b.responseText},l&&(f.readBinary=function(a){var b=new XMLHttpRequest();b.open("GET",a,!1);b.responseType="arraybuffer";b.send(null);return new Uint8Array(b.response)}),f.readAsync=function(a,b,c){var d=new XMLHttpRequest();d.open("GET",a,!0);d.responseType="arraybuffer";d.onload=function(){if(d.status==200||d.status==0&&d.response){b(d.response);return}c()};d.onerror=c;d.send(null)},f.setWindowTitle=function(a){document.title=a});var n=f.print||(typeof console!=="undefined"?emptyFunction.bind(console):typeof print!=="undefined"?print:null),o=f.printErr||(typeof printErr!=="undefined"?printErr:typeof console!=="undefined"&&emptyFunction.bind(console)||n);for(j in i)Object.prototype.hasOwnProperty.call(i,j)&&(f[j]=i[j]);i=void 0;function aa(a){var b=B[C>>2];a=b+a+15&-16;a>xb()&&$();B[C>>2]=a;return b}function p(a){switch(a){case"i1":case"i8":return 1;case"i16":return 2;case"i32":return 4;case"i64":return 8;case"float":return 4;case"double":return 8;default:if(a[a.length-1]==="*")return 4;else if(a[0]==="i"){var b=parseInt(a.substr(1));t(b%8===0,"getNativeTypeSize invalid bits "+b+", type "+a);return b/8}else return 0}}var ba={"f64-rem":function(a,b){return a%b},"debugger":function(){debugger}};new Array(0);var ca=0,q=function(a){ca=a};m=function(){return ca};typeof WebAssembly!=="object"&&o("no native wasm support detected");function p(a,b,c,d){c=c||"i8";c.charAt(c.length-1)==="*"&&(c="i32");switch(c){case"i1":z[a>>0]=b;break;case"i8":z[a>>0]=b;break;case"i16":ra[a>>1]=b;break;case"i32":B[a>>2]=b;break;case"i64":I=[b>>>0,(p=b,+Ia(p)>=1?p>0?(La(+Ka(p/4294967296),4294967295)|0)>>>0:~~+Ja((p-+(~~p>>>0))/4294967296)>>>0:0)],B[a>>2]=I[0],B[a+4>>2]=I[1];break;case"float":sa[a>>2]=b;break;case"double":ta[a>>3]=b;break;default:$("invalid type for setValue: "+c)}}var r,s=!1;function t(a,b){a||$("Assertion failed: "+b)}function da(a){var b=f["_"+a];t(b,"Cannot call unknown function "+a+", make sure it is exported");return b}function ea(a,b,c,d,e){var f={string:function(a){var b=0;if(a!==null&&a!==void 0&&a!==0){var c=(a.length<<2)+1;b=yc(c);ia(a,b,c)}return b},array:function(a){var b=yc(a.length);ka(a,b);return b}};function e(a){if(b==="string")return v(a);return b==="boolean"?Boolean(a):a}a=da(a);var g=[],h=0;if(d)for(var i=0;i<d.length;i++){var j=f[c[i]];j?(h===0&&(h=Z()),g[i]=j(d[i])):g[i]=d[i]}j=a.apply(null,g);j=e(j);h!==0&&Y(h);return j}function fa(a,b,c,d){c=c||[];var e=c.every(function(a){return a==="number"}),f=b!=="string";return f&&e&&!d?da(a):function(){return ea(a,b,c,arguments,d)}}j=3;function ga(a){return!Aa?aa(a):xc(a)}var ha=typeof TextDecoder!=="undefined"?new TextDecoder("utf8"):void 0;function u(a,b,c){c=b+c;var d=b;while(a[d]&&!(d>=c))++d;if(d-b>16&&a.subarray&&ha)return ha.decode(a.subarray(b,d));else{c="";while(b<d){var e=a[b++];if(!(e&128)){c+=String.fromCharCode(e);continue}var f=a[b++]&63;if((e&224)==192){c+=String.fromCharCode((e&31)<<6|f);continue}var g=a[b++]&63;(e&240)==224?e=(e&15)<<12|f<<6|g:e=(e&7)<<18|f<<12|g<<6|a[b++]&63;if(e<65536)c+=String.fromCharCode(e);else{f=e-65536;c+=String.fromCharCode(55296|f>>10,56320|f&1023)}}}return c}function v(a,b){return a?u(A,a,b):""}function w(a,b,c,d){if(!(d>0))return 0;var e=c;d=c+d-1;for(var f=0;f<a.length;++f){var g=a.charCodeAt(f);if(g>=55296&&g<=57343){var h=a.charCodeAt(++f);g=65536+((g&1023)<<10)|h&1023}if(g<=127){if(c>=d)break;b[c++]=g}else if(g<=2047){if(c+1>=d)break;b[c++]=192|g>>6;b[c++]=128|g&63}else if(g<=65535){if(c+2>=d)break;b[c++]=224|g>>12;b[c++]=128|g>>6&63;b[c++]=128|g&63}else{if(c+3>=d)break;b[c++]=240|g>>18;b[c++]=128|g>>12&63;b[c++]=128|g>>6&63;b[c++]=128|g&63}}b[c]=0;return c-e}function ia(a,b,c){return w(a,A,b,c)}function x(a){var b=0;for(var c=0;c<a.length;++c){var d=a.charCodeAt(c);d>=55296&&d<=57343&&(d=65536+((d&1023)<<10)|a.charCodeAt(++c)&1023);d<=127?++b:d<=2047?b+=2:d<=65535?b+=3:b+=4}return b}typeof TextDecoder!=="undefined"?new TextDecoder("utf-16le"):void 0;function ja(a){var b=x(a)+1,c=xc(b);c&&w(a,z,c,b);return c}function ka(b,a){z.set(b,a)}function la(b,a,c){for(var d=0;d<b.length;++d)z[a++>>0]=b.charCodeAt(d);c||(z[a>>0]=0)}function ma(a){return a}function na(a){var b=/__Z[\w\d_]+/g;return a.replace(b,function(a){var b=ma(a);return a===b?a:b+" ["+a+"]"})}function oa(){var a=new Error();if(!a.stack){try{throw new Error(0)}catch(b){a=b}if(!a.stack)return"(no stack trace available)"}return a.stack.toString()}function pa(){var a=oa();f.extraStackTrace&&(a+="\n"+f.extraStackTrace());return na(a)}i=65536;function qa(a,b){a%b>0&&(a+=b-a%b);return a}var y,z,A,ra,B,sa,ta;function ua(){f.HEAP8=z=new Int8Array(y),f.HEAP16=ra=new Int16Array(y),f.HEAP32=B=new Int32Array(y),f.HEAPU8=A=new Uint8Array(y),f.HEAPU16=new Uint16Array(y),f.HEAPU32=new Uint32Array(y),f.HEAPF32=sa=new Float32Array(y),f.HEAPF64=ta=new Float64Array(y)}j=5385296;var C=142384,D=5242880,E=f.TOTAL_MEMORY||16777216;E<D&&o("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+E+"! (TOTAL_STACK="+D+")");f.wasmMemory?r=f.wasmMemory:r=new WebAssembly.Memory({initial:E/i});r&&(y=r.buffer);E=y.byteLength;ua();B[C>>2]=j;function va(a){while(a.length>0){var b=a.shift();if(typeof b=="function"){b();continue}var c=b.func;typeof c==="number"?b.arg===void 0?f.dynCall_v(c):f.dynCall_vi(c,b.arg):c(b.arg===void 0?null:b.arg)}}var wa=[],xa=[],ya=[],za=[],Aa=!1;function Ba(){if(f.preRun){typeof f.preRun=="function"&&(f.preRun=[f.preRun]);while(f.preRun.length)Ga(f.preRun.shift())}va(wa)}function Ca(){Aa=!0,!f.noFSInit&&!T.init.initialized&&T.init(),P.init(),va(xa)}function Da(){T.ignorePermissions=!1,va(ya)}function Ea(){}function Fa(){if(f.postRun){typeof f.postRun=="function"&&(f.postRun=[f.postRun]);while(f.postRun.length)Ha(f.postRun.shift())}va(za)}function Ga(a){wa.unshift(a)}function Ha(a){za.unshift(a)}var Ia=Math.abs,Ja=Math.ceil,Ka=Math.floor,La=Math.min,F=0,Ma=null,G=null;function Na(a){return a}function Oa(a){F++,f.monitorRunDependencies&&f.monitorRunDependencies(F)}function Pa(a){F--;f.monitorRunDependencies&&f.monitorRunDependencies(F);if(F==0){Ma!==null&&(clearInterval(Ma),Ma=null);if(G){a=G;G=null;a()}}}f.preloadedImages={};f.preloadedAudios={};var Qa="data:application/octet-stream;base64,";function Ra(a){return String.prototype.startsWith?a.startsWith(Qa):a.indexOf(Qa)===0}var H=g;function Sa(){try{if(f.wasmBinary)return new Uint8Array(f.wasmBinary);if(f.readBinary)return f.readBinary(H);else throw"both async and sync fetching of the wasm failed"}catch(a){$(a)}}function Ta(){return!f.wasmBinary&&(k||l)&&typeof fetch==="function"?fetch(H,{credentials:"same-origin"}).then(function(a){if(!a.ok)throw"failed to load wasm binary file at '"+H+"'";return a.arrayBuffer()})["catch"](function(){return Sa()}):new(b("Promise"))(function(a,b){a(Sa())})}function Ua(a){var b={env:a,global:{NaN:NaN,Infinity:Infinity},"global.Math":Math,asm2wasm:ba};function c(b,a){a=b.exports;f.asm=a;Pa("wasm-instantiate")}Oa("wasm-instantiate");function d(a){c(a.instance)}function g(a){return Ta().then(function(a){return WebAssembly.instantiate(a,b)}).then(a,function(a){o("failed to asynchronously prepare wasm: "+a),$(a)})}function h(){if(!f.wasmBinary&&typeof WebAssembly.instantiateStreaming==="function"&&!Ra(H)&&typeof fetch==="function")fetch(H,{credentials:"same-origin"}).then(function(a){return WebAssembly.instantiateStreaming(a,b).then(d,function(a){o("wasm streaming compile failed: "+a),o("falling back to ArrayBuffer instantiation"),g(d)})});else return g(d)}if(f.instantiateWasm)try{a=f.instantiateWasm(b,c);return a}catch(a){o("Module.instantiateWasm callback failed with error: "+a);return!1}h();return{}}f.asm=function(b,c,d){c.memory=r;c.table=new WebAssembly.Table({initial:2194,maximum:2194,element:"anyfunc"});c.__memory_base=1024;c.__table_base=0;b=Ua(c);return b};var I;xa.push({func:function(){vc()}});var J={};function Va(b){var c=64,d=1024,e;!Va.called?(Va.called=!0,J.USER=J.LOGNAME="web_user",J.PATH="/",J.PWD="/",J.HOME="/home/web_user",J.LANG="C.UTF-8",J.LANG=(typeof navigator==="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",J._=f.thisProgram,e=ga(d),c=ga(c*4),B[c>>2]=e,B[b>>2]=c):(c=B[b>>2],e=B[c>>2]);b=[];var g=0;for(var a in J)if(typeof J[a]==="string"){var h=a+"="+J[a];b.push(h);g+=h.length}if(g>d)throw new Error("Environment size exceeded TOTAL_ENV_SIZE!");g=4;for(var d=0;d<b.length;d++){var h=b[d];la(h,e);B[c+d*g>>2]=e;e+=h.length+1}B[c+b.length*g>>2]=0}function Wa(a){return xc(a)}var K={},Xa=[];function Ya(a){if(!a)return;a=K[a];a.refcount++}function Za(b){if(!b||K[b])return b;for(var a in K){var c=+a,d=K[c].adjusted,e=d.length;for(var f=0;f<e;f++)if(d[f]===b)return c}return b}function $a(a){var b=K[a];b&&!b.caught&&(b.caught=!0,W.uncaught_exception--);b&&(b.rethrown=!1);Xa.push(a);Ya(Za(a));return a}var L=0;function ab(a){try{return wc(a)}catch(a){}}function bb(a){if(!a)return;var b=K[a];b.refcount--;b.refcount===0&&!b.rethrown&&(b.destructor&&f.dynCall_vi(b.destructor,a),delete K[a],ab(a))}function cb(){X(0);var a=Xa.pop();a&&(bb(Za(a)),L=0)}function db(a){L||(L=a);throw a}function eb(){var b=L;if(!b)return(q(0),0)|0;var c=K[b],d=c.type;if(!d)return(q(0),b)|0;var e=Array.prototype.slice.call(arguments);uc(d);var a=142368;B[a>>2]=b;b=a;for(var f=0;f<e.length;f++)if(e[f]&&tc(e[f],d,b)){b=B[b>>2];c.adjusted.push(b);return(q(e[f]),b)|0}b=B[b>>2];return(q(d),b)|0}f.___cxa_find_matching_catch=eb;function fb(a,b){return eb(a,b)}function gb(a,b,c){return eb(a,b,c)}function hb(){s=!0;throw"Pure virtual function called!"}function ib(){var a=Xa.pop();a=Za(a);K[a].rethrown||(Xa.push(a),K[a].rethrown=!0);L=a;throw a}function jb(a,b,c){K[a]={ptr:a,adjusted:[a],type:b,destructor:c,refcount:0,caught:!1,rethrown:!1};L=a;!("uncaught_exception"in W)?W.uncaught_exception=1:W.uncaught_exception++;throw a}function kb(){return!!W.uncaught_exception}function lb(){}function M(a){f.___errno_location&&(B[f.___errno_location()>>2]=a);return a}function mb(a,b){M(1);return-1}var N={splitPath:function(a){var b=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return b.exec(a).slice(1)},normalizeArray:function(a,b){var c=0;for(var d=a.length-1;d>=0;d--){var e=a[d];e==="."?a.splice(d,1):e===".."?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c;c--)a.unshift("..");return a},normalize:function(a){var b=a.charAt(0)==="/",c=a.substr(-1)==="/";a=N.normalizeArray(a.split("/").filter(function(a){return!!a}),!b).join("/");!a&&!b&&(a=".");a&&c&&(a+="/");return(b?"/":"")+a},dirname:function(a){a=N.splitPath(a);var b=a[0];a=a[1];if(!b&&!a)return".";a&&(a=a.substr(0,a.length-1));return b+a},basename:function(a){if(a==="/")return"/";var b=a.lastIndexOf("/");return b===-1?a:a.substr(b+1)},extname:function(a){return N.splitPath(a)[3]},join:function(){var a=Array.prototype.slice.call(arguments,0);return N.normalize(a.join("/"))},join2:function(a,b){return N.normalize(a+"/"+b)}},O={resolve:function(){var a="",b=!1;for(var c=arguments.length-1;c>=-1&&!b;c--){var d=c>=0?arguments[c]:T.cwd();if(typeof d!=="string")throw new TypeError("Arguments to path.resolve must be strings");else if(!d)return"";a=d+"/"+a;b=d.charAt(0)==="/"}a=N.normalizeArray(a.split("/").filter(function(a){return!!a}),!b).join("/");return(b?"/":"")+a||"."},relative:function(a,b){a=O.resolve(a).substr(1);b=O.resolve(b).substr(1);function c(a){var b=0;for(;b<a.length;b++)if(a[b]!=="")break;var c=a.length-1;for(;c>=0;c--)if(a[c]!=="")break;return b>c?[]:a.slice(b,c-b+1)}a=c(a.split("/"));c=c(b.split("/"));b=Math.min(a.length,c.length);var d=b;for(var e=0;e<b;e++)if(a[e]!==c[e]){d=e;break}b=[];for(var e=d;e<a.length;e++)b.push("..");b=b.concat(c.slice(d));return b.join("/")}},P={ttys:[],init:function(){},shutdown:function(){},register:function(a,b){P.ttys[a]={input:[],output:[],ops:b},T.registerDevice(a,P.stream_ops)},stream_ops:{open:function(a){var b=P.ttys[a.node.rdev];if(!b)throw new T.ErrnoError(19);a.tty=b;a.seekable=!1},close:function(a){a.tty.ops.flush(a.tty)},flush:function(a){a.tty.ops.flush(a.tty)},read:function(b,a,c,d,e){if(!b.tty||!b.tty.ops.get_char)throw new T.ErrnoError(6);e=0;for(var f=0;f<d;f++){var g;try{g=b.tty.ops.get_char(b.tty)}catch(a){throw new T.ErrnoError(5)}if(g===void 0&&e===0)throw new T.ErrnoError(11);if(g===null||g===void 0)break;e++;a[c+f]=g}e&&(b.node.timestamp=Date.now());return e},write:function(b,a,c,d,e){if(!b.tty||!b.tty.ops.put_char)throw new T.ErrnoError(6);try{for(var e=0;e<d;e++)b.tty.ops.put_char(b.tty,a[c+e])}catch(a){throw new T.ErrnoError(5)}d&&(b.node.timestamp=Date.now());return e}},default_tty_ops:{get_char:function(a){if(!a.input.length){var b=null;typeof window!="undefined"&&typeof window.prompt=="function"?(b=window.prompt("Input: "),b!==null&&(b+="\n")):typeof readline=="function"&&(b=readline(),b!==null&&(b+="\n"));if(!b)return null;a.input=Rb(b,!0)}return a.input.shift()},put_char:function(a,b){b===null||b===10?(n(u(a.output,0)),a.output=[]):b!=0&&a.output.push(b)},flush:function(a){a.output&&a.output.length>0&&(n(u(a.output,0)),a.output=[])}},default_tty1_ops:{put_char:function(a,b){b===null||b===10?(o(u(a.output,0)),a.output=[]):b!=0&&a.output.push(b)},flush:function(a){a.output&&a.output.length>0&&(o(u(a.output,0)),a.output=[])}}},Q={ops_table:null,mount:function(a){return Q.createNode(null,"/",16384|511,0)},createNode:function(a,b,c,d){if(T.isBlkdev(c)||T.isFIFO(c))throw new T.ErrnoError(1);Q.ops_table||(Q.ops_table={dir:{node:{getattr:Q.node_ops.getattr,setattr:Q.node_ops.setattr,lookup:Q.node_ops.lookup,mknod:Q.node_ops.mknod,rename:Q.node_ops.rename,unlink:Q.node_ops.unlink,rmdir:Q.node_ops.rmdir,readdir:Q.node_ops.readdir,symlink:Q.node_ops.symlink},stream:{llseek:Q.stream_ops.llseek}},file:{node:{getattr:Q.node_ops.getattr,setattr:Q.node_ops.setattr},stream:{llseek:Q.stream_ops.llseek,read:Q.stream_ops.read,write:Q.stream_ops.write,allocate:Q.stream_ops.allocate,mmap:Q.stream_ops.mmap,msync:Q.stream_ops.msync}},link:{node:{getattr:Q.node_ops.getattr,setattr:Q.node_ops.setattr,readlink:Q.node_ops.readlink},stream:{}},chrdev:{node:{getattr:Q.node_ops.getattr,setattr:Q.node_ops.setattr},stream:T.chrdev_stream_ops}});c=T.createNode(a,b,c,d);T.isDir(c.mode)?(c.node_ops=Q.ops_table.dir.node,c.stream_ops=Q.ops_table.dir.stream,c.contents={}):T.isFile(c.mode)?(c.node_ops=Q.ops_table.file.node,c.stream_ops=Q.ops_table.file.stream,c.usedBytes=0,c.contents=null):T.isLink(c.mode)?(c.node_ops=Q.ops_table.link.node,c.stream_ops=Q.ops_table.link.stream):T.isChrdev(c.mode)&&(c.node_ops=Q.ops_table.chrdev.node,c.stream_ops=Q.ops_table.chrdev.stream);c.timestamp=Date.now();a&&(a.contents[b]=c);return c},getFileDataAsRegularArray:function(a){if(a.contents&&a.contents.subarray){var b=[];for(var c=0;c<a.usedBytes;++c)b.push(a.contents[c]);return b}return a.contents},getFileDataAsTypedArray:function(a){if(!a.contents)return new Uint8Array();return a.contents.subarray?a.contents.subarray(0,a.usedBytes):new Uint8Array(a.contents)},expandFileStorage:function(a,b){var c=a.contents?a.contents.length:0;if(c>=b)return;var d=1024*1024;b=Math.max(b,c*(c<d?2:1.125)|0);c!=0&&(b=Math.max(b,256));d=a.contents;a.contents=new Uint8Array(b);a.usedBytes>0&&a.contents.set(d.subarray(0,a.usedBytes),0);return},resizeFileStorage:function(a,b){if(a.usedBytes==b)return;if(b==0){a.contents=null;a.usedBytes=0;return}if(!a.contents||a.contents.subarray){var c=a.contents;a.contents=new Uint8Array(new ArrayBuffer(b));c&&a.contents.set(c.subarray(0,Math.min(b,a.usedBytes)));a.usedBytes=b;return}a.contents||(a.contents=[]);if(a.contents.length>b)a.contents.length=b;else while(a.contents.length<b)a.contents.push(0);a.usedBytes=b},node_ops:{getattr:function(a){var b={};b.dev=T.isChrdev(a.mode)?a.id:1;b.ino=a.id;b.mode=a.mode;b.nlink=1;b.uid=0;b.gid=0;b.rdev=a.rdev;T.isDir(a.mode)?b.size=4096:T.isFile(a.mode)?b.size=a.usedBytes:T.isLink(a.mode)?b.size=a.link.length:b.size=0;b.atime=new Date(a.timestamp);b.mtime=new Date(a.timestamp);b.ctime=new Date(a.timestamp);b.blksize=4096;b.blocks=Math.ceil(b.size/b.blksize);return b},setattr:function(a,b){b.mode!==void 0&&(a.mode=b.mode),b.timestamp!==void 0&&(a.timestamp=b.timestamp),b.size!==void 0&&Q.resizeFileStorage(a,b.size)},lookup:function(a,b){throw T.genericErrors[2]},mknod:function(a,b,c,d){return Q.createNode(a,b,c,d)},rename:function(a,b,c){if(T.isDir(a.mode)){var d;try{d=T.lookupNode(b,c)}catch(a){}if(d)for(var e in d.contents)throw new T.ErrnoError(39)}delete a.parent.contents[a.name];a.name=c;b.contents[c]=a;a.parent=b},unlink:function(a,b){delete a.contents[b]},rmdir:function(a,b){var c=T.lookupNode(a,b);for(var d in c.contents)throw new T.ErrnoError(39);delete a.contents[b]},readdir:function(b){var c=[".",".."];for(var a in b.contents){if(!Object.prototype.hasOwnProperty.call(b.contents,a))continue;c.push(a)}return c},symlink:function(a,b,c){a=Q.createNode(a,b,511|40960,0);a.link=c;return a},readlink:function(a){if(!T.isLink(a.mode))throw new T.ErrnoError(22);return a.link}},stream_ops:{read:function(b,a,c,d,e){var f=b.node.contents;if(e>=b.node.usedBytes)return 0;b=Math.min(b.node.usedBytes-e,d);if(b>8&&f.subarray)a.set(f.subarray(e,e+b),c);else for(var d=0;d<b;d++)a[c+d]=f[e+d];return b},write:function(b,a,c,d,e,f){f=!1;if(!d)return 0;b=b.node;b.timestamp=Date.now();if(a.subarray&&(!b.contents||b.contents.subarray))if(f){b.contents=a.subarray(c,c+d);b.usedBytes=d;return d}else if(b.usedBytes===0&&e===0){b.contents=new Uint8Array(a.subarray(c,c+d));b.usedBytes=d;return d}else if(e+d<=b.usedBytes){b.contents.set(a.subarray(c,c+d),e);return d}Q.expandFileStorage(b,e+d);if(b.contents.subarray&&a.subarray)b.contents.set(a.subarray(c,c+d),e);else for(var f=0;f<d;f++)b.contents[e+f]=a[c+f];b.usedBytes=Math.max(b.usedBytes,e+d);return d},llseek:function(a,b,c){b=b;c===1?b+=a.position:c===2&&(T.isFile(a.node.mode)&&(b+=a.node.usedBytes));if(b<0)throw new T.ErrnoError(22);return b},allocate:function(a,b,c){Q.expandFileStorage(a.node,b+c),a.node.usedBytes=Math.max(a.node.usedBytes,b+c)},mmap:function(b,a,c,d,e,f,g){if(!T.isFile(b.node.mode))throw new T.ErrnoError(19);c=b.node.contents;if(!(g&2)&&(c.buffer===a||c.buffer===a.buffer))f=!1,g=c.byteOffset;else{(e>0||e+d<b.node.usedBytes)&&(c.subarray?c=c.subarray(e,e+d):c=Array.prototype.slice.call(c,e,e+d));f=!0;g=xc(d);if(!g)throw new T.ErrnoError(12);a.set(c,g)}return{ptr:g,allocated:f}},msync:function(b,a,c,d,e){if(!T.isFile(b.node.mode))throw new T.ErrnoError(19);if(e&2)return 0;Q.stream_ops.write(b,a,0,d,c,!1);return 0}}},R={dbs:{},indexedDB:function(a){function b(){return a.apply(this,arguments)}b.toString=function(){return a.toString()};return b}(function(){if(typeof indexedDB!=="undefined")return indexedDB;var a=null;typeof window==="object"&&(a=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB);t(a,"IDBFS used, but indexedDB not supported");return a}),DB_VERSION:21,DB_STORE_NAME:"FILE_DATA",mount:function(a){return Q.mount.apply(null,arguments)},syncfs:function(a,b,c){R.getLocalSet(a,function(d,e){if(d)return c(d);R.getRemoteSet(a,function(a,d){if(a)return c(a);a=b?d:e;d=b?e:d;R.reconcile(a,d,c)})})},getDB:function(a,b){var c=R.dbs[a];if(c)return b(null,c);var d;try{d=R.indexedDB().open(a,R.DB_VERSION)}catch(a){return b(a)}if(!d)return b("Unable to connect to IndexedDB");d.onupgradeneeded=function(b){var a=b.target.result;b=b.target.transaction;a.objectStoreNames.contains(R.DB_STORE_NAME)?b=b.objectStore(R.DB_STORE_NAME):b=a.createObjectStore(R.DB_STORE_NAME);b.indexNames.contains("timestamp")||b.createIndex("timestamp","timestamp",{unique:!1})};d.onsuccess=function(){c=d.result,R.dbs[a]=c,b(null,c)};d.onerror=function(a){b(this.error),a.preventDefault()}},getLocalSet:function(a,b){var c={};function d(a){return a!=="."&&a!==".."}function e(a){return function(b){return N.join2(a,b)}}a=T.readdir(a.mountpoint).filter(d).map(e(a.mountpoint));while(a.length){var f=a.pop(),g;try{g=T.stat(f)}catch(a){return b(a)}T.isDir(g.mode)&&a.push.apply(a,T.readdir(f).filter(d).map(e(f)));c[f]={timestamp:g.mtime}}return b(null,{type:"local",entries:c})},getRemoteSet:function(a,b){var c={};R.getDB(a.mountpoint,function(a,d){if(a)return b(a);try{a=d.transaction([R.DB_STORE_NAME],"readonly");a.onerror=function(a){b(this.error),a.preventDefault()};a=a.objectStore(R.DB_STORE_NAME);a=a.index("timestamp");a.openKeyCursor().onsuccess=function(a){a=a.target.result;if(!a)return b(null,{type:"remote",db:d,entries:c});c[a.primaryKey]={timestamp:a.key};a["continue"]()}}catch(a){return b(a)}})},loadLocalEntry:function(a,b){try{var c=T.lookupPath(a);c=c.node;a=T.stat(a)}catch(a){return b(a)}if(T.isDir(a.mode))return b(null,{timestamp:a.mtime,mode:a.mode});else if(T.isFile(a.mode)){c.contents=Q.getFileDataAsTypedArray(c);return b(null,{timestamp:a.mtime,mode:a.mode,contents:c.contents})}else return b(new Error("node type not supported"))},storeLocalEntry:function(a,b,c){try{if(T.isDir(b.mode))T.mkdir(a,b.mode);else if(T.isFile(b.mode))T.writeFile(a,b.contents,{canOwn:!0});else return c(new Error("node type not supported"));T.chmod(a,b.mode);T.utime(a,b.timestamp,b.timestamp)}catch(a){return c(a)}c(null)},removeLocalEntry:function(a,b){try{T.lookupPath(a);var c=T.stat(a);T.isDir(c.mode)?T.rmdir(a):T.isFile(c.mode)&&T.unlink(a)}catch(a){return b(a)}b(null)},loadRemoteEntry:function(a,b,c){a=a.get(b);a.onsuccess=function(a){c(null,a.target.result)};a.onerror=function(a){c(this.error),a.preventDefault()}},storeRemoteEntry:function(a,b,c,d){a=a.put(c,b);a.onsuccess=function(){d(null)};a.onerror=function(a){d(this.error),a.preventDefault()}},removeRemoteEntry:function(a,b,c){a=a["delete"](b);a.onsuccess=function(){c(null)};a.onerror=function(a){c(this.error),a.preventDefault()}},reconcile:function(a,b,c){var d=0,e=[];Object.keys(a.entries).forEach(function(c){var f=a.entries[c],g=b.entries[c];(!g||f.timestamp>g.timestamp)&&(e.push(c),d++)});var f=[];Object.keys(b.entries).forEach(function(c){b.entries[c];var e=a.entries[c];e||(f.push(c),d++)});if(!d)return c(null);var g=!1,h=a.type==="remote"?a.db:b.db;h=h.transaction([R.DB_STORE_NAME],"readwrite");var i=h.objectStore(R.DB_STORE_NAME);function k(a){if(a&&!g){g=!0;return c(a)}}h.onerror=function(a){k(this.error),a.preventDefault()};h.oncomplete=function(a){g||c(null)};e.sort().forEach(function(a){b.type==="local"?R.loadRemoteEntry(i,a,function(b,c){if(b)return k(b);R.storeLocalEntry(a,c,k)}):R.loadLocalEntry(a,function(b,c){if(b)return k(b);R.storeRemoteEntry(i,a,c,k)})});f.sort().reverse().forEach(function(a){b.type==="local"?R.removeLocalEntry(a,k):R.removeRemoteEntry(i,a,k)})}},S={DIR_MODE:16895,FILE_MODE:33279,reader:null,mount:function(a){t(l);S.reader||(S.reader=new FileReaderSync());var b=S.createNode(null,"/",S.DIR_MODE,0),c={};function d(a){a=a.split("/");var d=b;for(var e=0;e<a.length-1;e++){var f=a.slice(0,e+1).join("/");c[f]||(c[f]=S.createNode(d,a[e],S.DIR_MODE,0));d=c[f]}return d}function e(a){a=a.split("/");return a[a.length-1]}Array.prototype.forEach.call(a.opts.files||[],function(a){S.createNode(d(a.name),e(a.name),S.FILE_MODE,0,a,a.lastModifiedDate)});(a.opts.blobs||[]).forEach(function(a){S.createNode(d(a.name),e(a.name),S.FILE_MODE,0,a.data)});(a.opts.packages||[]).forEach(function(a){a.metadata.files.forEach(function(b){var c=b.filename.substr(1);S.createNode(d(c),e(c),S.FILE_MODE,0,a.blob.slice(b.start,b.end))})});return b},createNode:function(a,b,c,d,e,f){d=T.createNode(a,b,c);d.mode=c;d.node_ops=S.node_ops;d.stream_ops=S.stream_ops;d.timestamp=(f||new Date()).getTime();t(S.FILE_MODE!==S.DIR_MODE);c===S.FILE_MODE?(d.size=e.size,d.contents=e):(d.size=4096,d.contents={});a&&(a.contents[b]=d);return d},node_ops:{getattr:function(a){return{dev:1,ino:void 0,mode:a.mode,nlink:1,uid:0,gid:0,rdev:void 0,size:a.size,atime:new Date(a.timestamp),mtime:new Date(a.timestamp),ctime:new Date(a.timestamp),blksize:4096,blocks:Math.ceil(a.size/4096)}},setattr:function(a,b){b.mode!==void 0&&(a.mode=b.mode),b.timestamp!==void 0&&(a.timestamp=b.timestamp)},lookup:function(a,b){throw new T.ErrnoError(2)},mknod:function(a,b,c,d){throw new T.ErrnoError(1)},rename:function(a,b,c){throw new T.ErrnoError(1)},unlink:function(a,b){throw new T.ErrnoError(1)},rmdir:function(a,b){throw new T.ErrnoError(1)},readdir:function(b){var c=[".",".."];for(var a in b.contents){if(!Object.prototype.hasOwnProperty.call(b.contents,a))continue;c.push(a)}return c},symlink:function(a,b,c){throw new T.ErrnoError(1)},readlink:function(a){throw new T.ErrnoError(1)}},stream_ops:{read:function(b,a,c,d,e){if(e>=b.node.size)return 0;b=b.node.contents.slice(e,e+d);e=S.reader.readAsArrayBuffer(b);a.set(new Uint8Array(e),c);return b.size},write:function(b,a,c,d,e){throw new T.ErrnoError(5)},llseek:function(a,b,c){b=b;c===1?b+=a.position:c===2&&(T.isFile(a.node.mode)&&(b+=a.node.size));if(b<0)throw new T.ErrnoError(22);return b}}},T={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,trackingDelegate:{},tracking:{openFlags:{READ:1,WRITE:2}},ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,handleFSError:function(a){if(!(a instanceof T.ErrnoError))throw a+" : "+pa();return M(a.errno)},lookupPath:function(b,c){b=O.resolve(T.cwd(),b);c=c||{};if(!b)return{path:"",node:null};var d={follow_mount:!0,recurse_count:0};for(var a in d)c[a]===void 0&&(c[a]=d[a]);if(c.recurse_count>8)throw new T.ErrnoError(40);d=N.normalizeArray(b.split("/").filter(function(a){return!!a}),!1);b=T.root;var e="/";for(var f=0;f<d.length;f++){var g=f===d.length-1;if(g&&c.parent)break;b=T.lookupNode(b,d[f]);e=N.join2(e,d[f]);T.isMountpoint(b)&&((!g||g&&c.follow_mount)&&(b=b.mounted.root));if(!g||c.follow){g=0;while(T.isLink(b.mode)){var h=T.readlink(e);e=O.resolve(N.dirname(e),h);h=T.lookupPath(e,{recurse_count:c.recurse_count});b=h.node;if(g++>40)throw new T.ErrnoError(40)}}}return{path:e,node:b}},getPath:function(a){var b;while(!0){if(T.isRoot(a)){var c=a.mount.mountpoint;return!b?c:c[c.length-1]!=="/"?c+"/"+b:c+b}b=b?a.name+"/"+b:a.name;a=a.parent}},hashName:function(a,b){var c=0;for(var d=0;d<b.length;d++)c=(c<<5)-c+b.charCodeAt(d)|0;return(a+c>>>0)%T.nameTable.length},hashAddNode:function(a){var b=T.hashName(a.parent.id,a.name);a.name_next=T.nameTable[b];T.nameTable[b]=a},hashRemoveNode:function(a){var b=T.hashName(a.parent.id,a.name);if(T.nameTable[b]===a)T.nameTable[b]=a.name_next;else{b=T.nameTable[b];while(b){if(b.name_next===a){b.name_next=a.name_next;break}b=b.name_next}}},lookupNode:function(b,c){var a=T.mayLookup(b);if(a)throw new T.ErrnoError(a,b);a=T.hashName(b.id,c);for(var a=T.nameTable[a];a;a=a.name_next){var d=a.name;if(a.parent.id===b.id&&d===c)return a}return T.lookup(b,c)},createNode:function(a,b,c,d){if(!T.FSNode){T.FSNode=function(a,b,c,d){a||(a=this),this.parent=a,this.mount=a.mount,this.mounted=null,this.id=T.nextInode++,this.name=b,this.mode=c,this.node_ops={},this.stream_ops={},this.rdev=d};T.FSNode.prototype={};var e=292|73,f=146;Object.defineProperties(T.FSNode.prototype,{read:{get:function(){return(this.mode&e)===e},set:function(a){a?this.mode|=e:this.mode&=~e}},write:{get:function(){return(this.mode&f)===f},set:function(a){a?this.mode|=f:this.mode&=~f}},isFolder:{get:function(){return T.isDir(this.mode)}},isDevice:{get:function(){return T.isChrdev(this.mode)}}})}a=new T.FSNode(a,b,c,d);T.hashAddNode(a);return a},destroyNode:function(a){T.hashRemoveNode(a)},isRoot:function(a){return a===a.parent},isMountpoint:function(a){return!!a.mounted},isFile:function(a){return(a&61440)===32768},isDir:function(a){return(a&61440)===16384},isLink:function(a){return(a&61440)===40960},isChrdev:function(a){return(a&61440)===8192},isBlkdev:function(a){return(a&61440)===24576},isFIFO:function(a){return(a&61440)===4096},isSocket:function(a){return(a&49152)===49152},flagModes:{r:0,rs:1052672,"r+":2,w:577,wx:705,xw:705,"w+":578,"wx+":706,"xw+":706,a:1089,ax:1217,xa:1217,"a+":1090,"ax+":1218,"xa+":1218},modeStringToFlags:function(a){var b=T.flagModes[a];if(typeof b==="undefined")throw new Error("Unknown file open mode: "+a);return b},flagsToPermissionString:function(a){var b=["r","w","rw"][a&3];a&512&&(b+="w");return b},nodePermissions:function(a,b){if(T.ignorePermissions)return 0;if(b.indexOf("r")!==-1&&!(a.mode&292))return 13;else if(b.indexOf("w")!==-1&&!(a.mode&146))return 13;else if(b.indexOf("x")!==-1&&!(a.mode&73))return 13;return 0},mayLookup:function(b){var a=T.nodePermissions(b,"x");if(a)return a;return!b.node_ops.lookup?13:0},mayCreate:function(a,b){try{T.lookupNode(a,b);return 17}catch(a){}return T.nodePermissions(a,"wx")},mayDelete:function(a,b,c){try{b=T.lookupNode(a,b)}catch(a){return a.errno}a=T.nodePermissions(a,"wx");if(a)return a;if(c){if(!T.isDir(b.mode))return 20;if(T.isRoot(b)||T.getPath(b)===T.cwd())return 16}else if(T.isDir(b.mode))return 21;return 0},mayOpen:function(a,b){if(!a)return 2;if(T.isLink(a.mode))return 40;else if(T.isDir(a.mode)&&(T.flagsToPermissionString(b)!=="r"||b&512))return 21;return T.nodePermissions(a,T.flagsToPermissionString(b))},MAX_OPEN_FDS:4096,nextfd:function(a,b){a=a||0;b=b||T.MAX_OPEN_FDS;for(var a=a;a<=b;a++)if(!T.streams[a])return a;throw new T.ErrnoError(24)},getStream:function(a){return T.streams[a]},createStream:function(a,b,c){T.FSStream||(T.FSStream=function(){},T.FSStream.prototype={},Object.defineProperties(T.FSStream.prototype,{object:{get:function(){return this.node},set:function(a){this.node=a}},isRead:{get:function(){return(this.flags&2097155)!==1}},isWrite:{get:function(){return(this.flags&2097155)!==0}},isAppend:{get:function(){return this.flags&1024}}}));var d=new T.FSStream();for(var e in a)d[e]=a[e];a=d;d=T.nextfd(b,c);a.fd=d;T.streams[d]=a;return a},closeStream:function(a){T.streams[a]=null},chrdev_stream_ops:{open:function(a){var b=T.getDevice(a.node.rdev);a.stream_ops=b.stream_ops;a.stream_ops.open&&a.stream_ops.open(a)},llseek:function(){throw new T.ErrnoError(29)}},major:function(a){return a>>8},minor:function(a){return a&255},makedev:function(a,b){return a<<8|b},registerDevice:function(a,b){T.devices[a]={stream_ops:b}},getDevice:function(a){return T.devices[a]},getMounts:function(a){var b=[];a=[a];while(a.length){var c=a.pop();b.push(c);a.push.apply(a,c.mounts)}return b},syncfs:function(a,b){typeof a==="function"&&(b=a,a=!1);T.syncFSRequests++;T.syncFSRequests>1;var c=T.getMounts(T.root.mount),d=0;function e(a){T.syncFSRequests--;return b(a)}function f(a){if(a){if(!f.errored){f.errored=!0;return e(a)}return}++d>=c.length&&e(null)}c.forEach(function(b){if(!b.type.syncfs)return f(null);b.type.syncfs(b,a,f)})},mount:function(a,b,c){var d=c==="/",e=!c,f;if(d&&T.root)throw new T.ErrnoError(16);else if(!d&&!e){e=T.lookupPath(c,{follow_mount:!1});c=e.path;f=e.node;if(T.isMountpoint(f))throw new T.ErrnoError(16);if(!T.isDir(f.mode))throw new T.ErrnoError(20)}e={type:a,opts:b,mountpoint:c,mounts:[]};b=a.mount(e);b.mount=e;e.root=b;d?T.root=b:f&&(f.mounted=e,f.mount&&f.mount.mounts.push(e));return b},unmount:function(a){a=T.lookupPath(a,{follow_mount:!1});if(!T.isMountpoint(a.node))throw new T.ErrnoError(22);a=a.node;var b=a.mounted,c=T.getMounts(b);Object.keys(T.nameTable).forEach(function(a){a=T.nameTable[a];while(a){var b=a.name_next;c.indexOf(a.mount)!==-1&&T.destroyNode(a);a=b}});a.mounted=null;b=a.mount.mounts.indexOf(b);a.mount.mounts.splice(b,1)},lookup:function(a,b){return a.node_ops.lookup(a,b)},mknod:function(b,c,d){var e=T.lookupPath(b,{parent:!0});e=e.node;b=N.basename(b);if(!b||b==="."||b==="..")throw new T.ErrnoError(22);var a=T.mayCreate(e,b);if(a)throw new T.ErrnoError(a);if(!e.node_ops.mknod)throw new T.ErrnoError(1);return e.node_ops.mknod(e,b,c,d)},create:function(a,b){b=b!==void 0?b:438;b&=4095;b|=32768;return T.mknod(a,b,0)},mkdir:function(a,b){b=b!==void 0?b:511;b&=511|512;b|=16384;return T.mknod(a,b,0)},mkdirTree:function(a,b){a=a.split("/");var c="";for(var d=0;d<a.length;++d){if(!a[d])continue;c+="/"+a[d];try{T.mkdir(c,b)}catch(a){if(a.errno!=17)throw a}}},mkdev:function(a,b,c){typeof c==="undefined"&&(c=b,b=438);b|=8192;return T.mknod(a,b,c)},symlink:function(b,c){if(!O.resolve(b))throw new T.ErrnoError(2);var d=T.lookupPath(c,{parent:!0});d=d.node;if(!d)throw new T.ErrnoError(2);c=N.basename(c);var a=T.mayCreate(d,c);if(a)throw new T.ErrnoError(a);if(!d.node_ops.symlink)throw new T.ErrnoError(1);return d.node_ops.symlink(d,c,b)},rename:function(a,b){var c=N.dirname(a),d=N.dirname(b),e=N.basename(a),f=N.basename(b),g,h;try{g=T.lookupPath(a,{parent:!0}),h=g.node,g=T.lookupPath(b,{parent:!0}),g=g.node}catch(a){throw new T.ErrnoError(16)}if(!h||!g)throw new T.ErrnoError(2);if(h.mount!==g.mount)throw new T.ErrnoError(18);var i=T.lookupNode(h,e);d=O.relative(a,d);if(d.charAt(0)!==".")throw new T.ErrnoError(22);d=O.relative(b,c);if(d.charAt(0)!==".")throw new T.ErrnoError(39);try{c=T.lookupNode(g,f)}catch(a){}if(i===c)return;d=T.isDir(i.mode);e=T.mayDelete(h,e,d);if(e)throw new T.ErrnoError(e);e=c?T.mayDelete(g,f,d):T.mayCreate(g,f);if(e)throw new T.ErrnoError(e);if(!h.node_ops.rename)throw new T.ErrnoError(1);if(T.isMountpoint(i)||c&&T.isMountpoint(c))throw new T.ErrnoError(16);if(g!==h){e=T.nodePermissions(h,"w");if(e)throw new T.ErrnoError(e)}try{T.trackingDelegate.willMovePath&&T.trackingDelegate.willMovePath(a,b)}catch(a){}T.hashRemoveNode(i);try{h.node_ops.rename(i,g,f)}catch(a){throw a}finally{T.hashAddNode(i)}try{T.trackingDelegate.onMovePath&&T.trackingDelegate.onMovePath(a,b)}catch(a){}},rmdir:function(b){var c=T.lookupPath(b,{parent:!0});c=c.node;var d=N.basename(b),e=T.lookupNode(c,d),a=T.mayDelete(c,d,!0);if(a)throw new T.ErrnoError(a);if(!c.node_ops.rmdir)throw new T.ErrnoError(1);if(T.isMountpoint(e))throw new T.ErrnoError(16);try{T.trackingDelegate.willDeletePath&&T.trackingDelegate.willDeletePath(b)}catch(a){}c.node_ops.rmdir(c,d);T.destroyNode(e);try{T.trackingDelegate.onDeletePath&&T.trackingDelegate.onDeletePath(b)}catch(a){}},readdir:function(a){a=T.lookupPath(a,{follow:!0});a=a.node;if(!a.node_ops.readdir)throw new T.ErrnoError(20);return a.node_ops.readdir(a)},unlink:function(b){var c=T.lookupPath(b,{parent:!0});c=c.node;var d=N.basename(b),e=T.lookupNode(c,d),a=T.mayDelete(c,d,!1);if(a)throw new T.ErrnoError(a);if(!c.node_ops.unlink)throw new T.ErrnoError(1);if(T.isMountpoint(e))throw new T.ErrnoError(16);try{T.trackingDelegate.willDeletePath&&T.trackingDelegate.willDeletePath(b)}catch(a){}c.node_ops.unlink(c,d);T.destroyNode(e);try{T.trackingDelegate.onDeletePath&&T.trackingDelegate.onDeletePath(b)}catch(a){}},readlink:function(a){a=T.lookupPath(a);a=a.node;if(!a)throw new T.ErrnoError(2);if(!a.node_ops.readlink)throw new T.ErrnoError(22);return O.resolve(T.getPath(a.parent),a.node_ops.readlink(a))},stat:function(a,b){a=T.lookupPath(a,{follow:!b});b=a.node;if(!b)throw new T.ErrnoError(2);if(!b.node_ops.getattr)throw new T.ErrnoError(1);return b.node_ops.getattr(b)},lstat:function(a){return T.stat(a,!0)},chmod:function(a,b,c){if(typeof a==="string"){c=T.lookupPath(a,{follow:!c});c=c.node}else c=a;if(!c.node_ops.setattr)throw new T.ErrnoError(1);c.node_ops.setattr(c,{mode:b&4095|c.mode&-4096,timestamp:Date.now()})},lchmod:function(a,b){T.chmod(a,b,!0)},fchmod:function(a,b){a=T.getStream(a);if(!a)throw new T.ErrnoError(9);T.chmod(a.node,b)},chown:function(a,b,c,d){if(typeof a==="string"){b=T.lookupPath(a,{follow:!d});c=b.node}else c=a;if(!c.node_ops.setattr)throw new T.ErrnoError(1);c.node_ops.setattr(c,{timestamp:Date.now()})},lchown:function(a,b,c){T.chown(a,b,c,!0)},fchown:function(a,b,c){a=T.getStream(a);if(!a)throw new T.ErrnoError(9);T.chown(a.node,b,c)},truncate:function(a,b){if(b<0)throw new T.ErrnoError(22);if(typeof a==="string"){var c=T.lookupPath(a,{follow:!0});c=c.node}else c=a;if(!c.node_ops.setattr)throw new T.ErrnoError(1);if(T.isDir(c.mode))throw new T.ErrnoError(21);if(!T.isFile(c.mode))throw new T.ErrnoError(22);a=T.nodePermissions(c,"w");if(a)throw new T.ErrnoError(a);c.node_ops.setattr(c,{size:b,timestamp:Date.now()})},ftruncate:function(a,b){a=T.getStream(a);if(!a)throw new T.ErrnoError(9);if((a.flags&2097155)===0)throw new T.ErrnoError(22);T.truncate(a.node,b)},utime:function(a,b,c){a=T.lookupPath(a,{follow:!0});a=a.node;a.node_ops.setattr(a,{timestamp:Math.max(b,c)})},open:function(a,b,c,d,e){if(a==="")throw new T.ErrnoError(2);b=typeof b==="string"?T.modeStringToFlags(b):b;c=typeof c==="undefined"?438:c;b&64?c=c&4095|32768:c=0;var g;if(typeof a==="object")g=a;else{a=N.normalize(a);try{var h=T.lookupPath(a,{follow:!(b&131072)});g=h.node}catch(a){}}h=!1;if(b&64)if(g){if(b&128)throw new T.ErrnoError(17)}else g=T.mknod(a,c,0),h=!0;if(!g)throw new T.ErrnoError(2);T.isChrdev(g.mode)&&(b&=-513);if(b&65536&&!T.isDir(g.mode))throw new T.ErrnoError(20);if(!h){c=T.mayOpen(g,b);if(c)throw new T.ErrnoError(c)}b&512&&T.truncate(g,0);b&=~(128|512);h=T.createStream({node:g,path:T.getPath(g),flags:b,seekable:!0,position:0,stream_ops:g.stream_ops,ungotten:[],error:!1},d,e);h.stream_ops.open&&h.stream_ops.open(h);f.logReadFiles&&!(b&1)&&(T.readFiles||(T.readFiles={}),a in T.readFiles||(T.readFiles[a]=1));try{if(T.trackingDelegate.onOpenFile){c=0;(b&2097155)!==1&&(c|=T.tracking.openFlags.READ);(b&2097155)!==0&&(c|=T.tracking.openFlags.WRITE);T.trackingDelegate.onOpenFile(a,c)}}catch(a){}return h},close:function(a){if(T.isClosed(a))throw new T.ErrnoError(9);a.getdents&&(a.getdents=null);try{a.stream_ops.close&&a.stream_ops.close(a)}catch(a){throw a}finally{T.closeStream(a.fd)}a.fd=null},isClosed:function(a){return a.fd===null},llseek:function(a,b,c){if(T.isClosed(a))throw new T.ErrnoError(9);if(!a.seekable||!a.stream_ops.llseek)throw new T.ErrnoError(29);if(c!=0&&c!=1&&c!=2)throw new T.ErrnoError(22);a.position=a.stream_ops.llseek(a,b,c);a.ungotten=[];return a.position},read:function(b,a,c,d,e){if(d<0||e<0)throw new T.ErrnoError(22);if(T.isClosed(b))throw new T.ErrnoError(9);if((b.flags&2097155)===1)throw new T.ErrnoError(9);if(T.isDir(b.node.mode))throw new T.ErrnoError(21);if(!b.stream_ops.read)throw new T.ErrnoError(22);var f=typeof e!=="undefined";if(!f)e=b.position;else if(!b.seekable)throw new T.ErrnoError(29);a=b.stream_ops.read(b,a,c,d,e);f||(b.position+=a);return a},write:function(b,a,c,d,e,f){if(d<0||e<0)throw new T.ErrnoError(22);if(T.isClosed(b))throw new T.ErrnoError(9);if((b.flags&2097155)===0)throw new T.ErrnoError(9);if(T.isDir(b.node.mode))throw new T.ErrnoError(21);if(!b.stream_ops.write)throw new T.ErrnoError(22);b.flags&1024&&T.llseek(b,0,2);var g=typeof e!=="undefined";if(!g)e=b.position;else if(!b.seekable)throw new T.ErrnoError(29);a=b.stream_ops.write(b,a,c,d,e,f);g||(b.position+=a);try{b.path&&T.trackingDelegate.onWriteToFile&&T.trackingDelegate.onWriteToFile(b.path)}catch(a){}return a},allocate:function(a,b,c){if(T.isClosed(a))throw new T.ErrnoError(9);if(b<0||c<=0)throw new T.ErrnoError(22);if((a.flags&2097155)===0)throw new T.ErrnoError(9);if(!T.isFile(a.node.mode)&&!T.isDir(a.node.mode))throw new T.ErrnoError(19);if(!a.stream_ops.allocate)throw new T.ErrnoError(95);a.stream_ops.allocate(a,b,c)},mmap:function(b,a,c,d,e,f,g){if((f&2)!==0&&(g&2)===0&&(b.flags&2097155)!==2)throw new T.ErrnoError(13);if((b.flags&2097155)===1)throw new T.ErrnoError(13);if(!b.stream_ops.mmap)throw new T.ErrnoError(19);return b.stream_ops.mmap(b,a,c,d,e,f,g)},msync:function(b,a,c,d,e){return!b||!b.stream_ops.msync?0:b.stream_ops.msync(b,a,c,d,e)},munmap:function(a){return 0},ioctl:function(a,b,c){if(!a.stream_ops.ioctl)throw new T.ErrnoError(25);return a.stream_ops.ioctl(a,b,c)},readFile:function(a,b){b=b||{};b.flags=b.flags||"r";b.encoding=b.encoding||"binary";if(b.encoding!=="utf8"&&b.encoding!=="binary")throw new Error('Invalid encoding type "'+b.encoding+'"');var c,d=T.open(a,b.flags);a=T.stat(a);a=a.size;var e=new Uint8Array(a);T.read(d,e,0,a,0);b.encoding==="utf8"?c=u(e,0):b.encoding==="binary"&&(c=e);T.close(d);return c},writeFile:function(a,b,c){c=c||{};c.flags=c.flags||"w";a=T.open(a,c.flags,c.mode);if(typeof b==="string"){var d=new Uint8Array(x(b)+1),e=w(b,d,0,d.length);T.write(a,d,0,e,void 0,c.canOwn)}else if(ArrayBuffer.isView(b))T.write(a,b,0,b.byteLength,void 0,c.canOwn);else throw new Error("Unsupported data type");T.close(a)},cwd:function(){return T.currentPath},chdir:function(b){b=T.lookupPath(b,{follow:!0});if(b.node===null)throw new T.ErrnoError(2);if(!T.isDir(b.node.mode))throw new T.ErrnoError(20);var a=T.nodePermissions(b.node,"x");if(a)throw new T.ErrnoError(a);T.currentPath=b.path},createDefaultDirectories:function(){T.mkdir("/tmp"),T.mkdir("/home"),T.mkdir("/home/web_user")},createDefaultDevices:function(){T.mkdir("/dev");T.registerDevice(T.makedev(1,3),{read:function(){return 0},write:function(b,a,c,d,e){return d}});T.mkdev("/dev/null",T.makedev(1,3));P.register(T.makedev(5,0),P.default_tty_ops);P.register(T.makedev(6,0),P.default_tty1_ops);T.mkdev("/dev/tty",T.makedev(5,0));T.mkdev("/dev/tty1",T.makedev(6,0));var a;if(typeof crypto==="object"&&typeof crypto.getRandomValues==="function"){var b=new Uint8Array(1);a=function(){crypto.getRandomValues(b);return b[0]}}a||(a=function(){$("random_device")});T.createDevice("/dev","random",a);T.createDevice("/dev","urandom",a);T.mkdir("/dev/shm");T.mkdir("/dev/shm/tmp")},createSpecialDirectories:function(){T.mkdir("/proc"),T.mkdir("/proc/self"),T.mkdir("/proc/self/fd"),T.mount({mount:function(){var a=T.createNode("/proc/self","fd",16384|511,73);a.node_ops={lookup:function(a,b){a=+b;var c=T.getStream(a);if(!c)throw new T.ErrnoError(9);b={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:function(){return c.path}}};b.parent=b;return b}};return a}},{},"/proc/self/fd")},createStandardStreams:function(){f.stdin?T.createDevice("/dev","stdin",f.stdin):T.symlink("/dev/tty","/dev/stdin"),f.stdout?T.createDevice("/dev","stdout",null,f.stdout):T.symlink("/dev/tty","/dev/stdout"),f.stderr?T.createDevice("/dev","stderr",null,f.stderr):T.symlink("/dev/tty1","/dev/stderr"),T.open("/dev/stdin","r"),T.open("/dev/stdout","w"),T.open("/dev/stderr","w")},ensureErrnoError:function(){if(T.ErrnoError)return;T.ErrnoError=function(a,b){this.node=b,this.setErrno=function(a){this.errno=a},this.setErrno(a),this.message="FS error",this.stack&&Object.defineProperty(this,"stack",{value:new Error().stack,writable:!0})};T.ErrnoError.prototype=new Error();T.ErrnoError.prototype.constructor=T.ErrnoError;[2].forEach(function(a){T.genericErrors[a]=new T.ErrnoError(a),T.genericErrors[a].stack="<generic error, no stack>"})},staticInit:function(){T.ensureErrnoError(),T.nameTable=new Array(4096),T.mount(Q,{},"/"),T.createDefaultDirectories(),T.createDefaultDevices(),T.createSpecialDirectories(),T.filesystems={MEMFS:Q,IDBFS:R,WORKERFS:S}},init:function(a,b,c){T.init.initialized=!0,T.ensureErrnoError(),f.stdin=a||f.stdin,f.stdout=b||f.stdout,f.stderr=c||f.stderr,T.createStandardStreams()},quit:function(){T.init.initialized=!1;var a=f._fflush;a&&a(0);for(var a=0;a<T.streams.length;a++){var b=T.streams[a];if(!b)continue;T.close(b)}},getMode:function(a,b){var c=0;a&&(c|=292|73);b&&(c|=146);return c},joinPath:function(a,b){a=N.join.apply(null,a);b&&a[0]=="/"&&(a=a.substr(1));return a},absolutePath:function(a,b){return O.resolve(b,a)},standardizePath:function(a){return N.normalize(a)},findObject:function(a,b){a=T.analyzePath(a,b);if(a.exists)return a.object;else{M(a.error);return null}},analyzePath:function(a,b){try{var c=T.lookupPath(a,{follow:!b});a=c.path}catch(a){}var d={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var c=T.lookupPath(a,{parent:!0});d.parentExists=!0;d.parentPath=c.path;d.parentObject=c.node;d.name=N.basename(a);c=T.lookupPath(a,{follow:!b});d.exists=!0;d.path=c.path;d.object=c.node;d.name=c.node.name;d.isRoot=c.path==="/"}catch(a){d.error=a.errno}return d},createFolder:function(a,b,c,d){a=N.join2(typeof a==="string"?a:T.getPath(a),b);b=T.getMode(c,d);return T.mkdir(a,b)},createPath:function(a,b,c,d){a=typeof a==="string"?a:T.getPath(a);c=b.split("/").reverse();while(c.length){d=c.pop();if(!d)continue;var e=N.join2(a,d);try{T.mkdir(e)}catch(a){}a=e}return e},createFile:function(a,b,c,d,e){c=N.join2(typeof a==="string"?a:T.getPath(a),b);a=T.getMode(d,e);return T.create(c,a)},createDataFile:function(a,b,c,d,e,f){b=b?N.join2(typeof a==="string"?a:T.getPath(a),b):a;a=T.getMode(d,e);d=T.create(b,a);if(c){if(typeof c==="string"){e=new Array(c.length);for(var b=0,g=c.length;b<g;++b)e[b]=c.charCodeAt(b);c=e}T.chmod(d,a|146);b=T.open(d,"w");T.write(b,c,0,c.length,0,f);T.close(b);T.chmod(d,a)}return d},createDevice:function(a,b,c,d){a=N.join2(typeof a==="string"?a:T.getPath(a),b);b=T.getMode(!!c,!!d);T.createDevice.major||(T.createDevice.major=64);var e=T.makedev(T.createDevice.major++,0);T.registerDevice(e,{open:function(a){a.seekable=!1},close:function(a){d&&d.buffer&&d.buffer.length&&d(10)},read:function(b,a,d,e,f){f=0;for(var g=0;g<e;g++){var h;try{h=c()}catch(a){throw new T.ErrnoError(5)}if(h===void 0&&f===0)throw new T.ErrnoError(11);if(h===null||h===void 0)break;f++;a[d+g]=h}f&&(b.node.timestamp=Date.now());return f},write:function(b,a,c,e,f){for(var f=0;f<e;f++)try{d(a[c+f])}catch(a){throw new T.ErrnoError(5)}e&&(b.node.timestamp=Date.now());return f}});return T.mkdev(a,b,e)},createLink:function(a,b,c,d,e){d=N.join2(typeof a==="string"?a:T.getPath(a),b);return T.symlink(c,d)},forceLoadFile:function(a){if(a.isDevice||a.isFolder||a.link||a.contents)return!0;var b=!0;if(typeof XMLHttpRequest!=="undefined")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");else if(f.read)try{a.contents=Rb(f.read(a.url),!0),a.usedBytes=a.contents.length}catch(a){b=!1}else throw new Error("Cannot load without read() or XMLHttpRequest.");b||M(5);return b},createLazyFile:function(a,b,c,d,e){function f(){this.lengthKnown=!1,this.chunks=[]}f.prototype.get=function(a){if(a>this.length-1||a<0)return void 0;var b=a%this.chunkSize;a=a/this.chunkSize|0;return this.getter(a)[b]};f.prototype.setDataGetter=function(a){this.getter=a};f.prototype.cacheLength=function(){var a=new XMLHttpRequest();a.open("HEAD",c,!1);a.send(null);if(!(a.status>=200&&a.status<300||a.status===304))throw new Error("Couldn't load "+c+". Status: "+a.status);var b=Number(a.getResponseHeader("Content-length")),d,e=(d=a.getResponseHeader("Accept-Ranges"))&&d==="bytes";a=(d=a.getResponseHeader("Content-Encoding"))&&d==="gzip";var f=1024*1024;e||(f=b);var g=function(d,e){if(d>e)throw new Error("invalid range ("+d+", "+e+") or no bytes requested!");if(e>b-1)throw new Error("only "+b+" bytes available! programmer error!");var a=new XMLHttpRequest();a.open("GET",c,!1);b!==f&&a.setRequestHeader("Range","bytes="+d+"-"+e);typeof Uint8Array!="undefined"&&(a.responseType="arraybuffer");a.overrideMimeType&&a.overrideMimeType("text/plain; charset=x-user-defined");a.send(null);if(!(a.status>=200&&a.status<300||a.status===304))throw new Error("Couldn't load "+c+". Status: "+a.status);if(a.response!==void 0)return new Uint8Array(a.response||[]);else return Rb(a.responseText||"",!0)},h=this;h.setDataGetter(function(a){var c=a*f,d=(a+1)*f-1;d=Math.min(d,b-1);typeof h.chunks[a]==="undefined"&&(h.chunks[a]=g(c,d));if(typeof h.chunks[a]==="undefined")throw new Error("doXHR failed!");return h.chunks[a]});(a||!b)&&(f=b=1,b=this.getter(0).length,f=b);this._length=b;this._chunkSize=f;this.lengthKnown=!0};if(typeof XMLHttpRequest!=="undefined"){if(!l)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";f=new f();Object.defineProperties(f,{length:{get:function(){this.lengthKnown||this.cacheLength();return this._length}},chunkSize:{get:function(){this.lengthKnown||this.cacheLength();return this._chunkSize}}});f={isDevice:!1,contents:f}}else var f={isDevice:!1,url:c};var g=T.createFile(a,b,f,d,e);f.contents?g.contents=f.contents:f.url&&(g.contents=null,g.url=f.url);Object.defineProperties(g,{usedBytes:{get:function(){return this.contents.length}}});var h={};a=Object.keys(g.stream_ops);a.forEach(function(a){var b=g.stream_ops[a];h[a]=function(){if(!T.forceLoadFile(g))throw new T.ErrnoError(5);return b.apply(null,arguments)}});h.read=function(b,a,c,d,e){if(!T.forceLoadFile(g))throw new T.ErrnoError(5);b=b.node.contents;if(e>=b.length)return 0;d=Math.min(b.length-e,d);if(b.slice)for(var f=0;f<d;f++)a[c+f]=b[e+f];else for(var f=0;f<d;f++)a[c+f]=b.get(e+f);return d};g.stream_ops=h;return g},createPreloadedFile:function(a,b,c,d,e,g,h,i,j,k){Browser.init();var l=b?O.resolve(N.join2(a,b)):a,m=Na("cp "+l);function n(c){function n(c){k&&k(),i||T.createDataFile(a,b,c,d,e,j),g&&g(),Pa(m)}var o=!1;f.preloadPlugins.forEach(function(a){if(o)return;a.canHandle(l)&&(a.handle(c,l,n,function(){h&&h(),Pa(m)}),o=!0)});o||n(c)}Oa(m);typeof c=="string"?Browser.asyncLoad(c,function(a){n(a)},h):n(c)},indexedDB:function(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB},DB_NAME:function(){return"EM_FS_"+window.location.pathname},DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:function(a,b,c){b=b||function(){};c=c||function(){};var d=T.indexedDB();try{var e=d.open(T.DB_NAME(),T.DB_VERSION)}catch(a){return c(a)}e.onupgradeneeded=function(){var a=e.result;a.createObjectStore(T.DB_STORE_NAME)};e.onsuccess=function(){var d=e.result;d=d.transaction([T.DB_STORE_NAME],"readwrite");var f=d.objectStore(T.DB_STORE_NAME),g=0,h=0,i=a.length;function j(){h==0?b():c()}a.forEach(function(a){a=f.put(T.analyzePath(a).object.contents,a);a.onsuccess=function(){g++,g+h==i&&j()};a.onerror=function(){h++,g+h==i&&j()}});d.onerror=c};e.onerror=c},loadFilesFromDB:function(a,b,c){b=b||function(){};c=c||function(){};var d=T.indexedDB();try{var e=d.open(T.DB_NAME(),T.DB_VERSION)}catch(a){return c(a)}e.onupgradeneeded=c;e.onsuccess=function(){var d=e.result;try{d=d.transaction([T.DB_STORE_NAME],"readonly")}catch(a){c(a);return}var f=d.objectStore(T.DB_STORE_NAME),g=0,h=0,i=a.length;function j(){h==0?b():c()}a.forEach(function(a){var b=f.get(a);b.onsuccess=function(){T.analyzePath(a).exists&&T.unlink(a),T.createDataFile(N.dirname(a),N.basename(a),b.result,!0,!0,!0),g++,g+h==i&&j()};b.onerror=function(){h++,g+h==i&&j()}});d.onerror=c};e.onerror=c}},U={DEFAULT_POLLMASK:5,mappings:{},umask:511,calculateAt:function(a,b){if(b[0]!=="/"){var c;if(a===-100)c=T.cwd();else{a=T.getStream(a);if(!a)throw new T.ErrnoError(9);c=a.path}b=N.join2(c,b)}return b},doStat:function(a,b,c){try{a=a(b)}catch(a){if(a&&a.node&&N.normalize(b)!==N.normalize(T.getPath(a.node)))return-20;throw a}B[c>>2]=a.dev;B[c+4>>2]=0;B[c+8>>2]=a.ino;B[c+12>>2]=a.mode;B[c+16>>2]=a.nlink;B[c+20>>2]=a.uid;B[c+24>>2]=a.gid;B[c+28>>2]=a.rdev;B[c+32>>2]=0;I=[a.size>>>0,(p=a.size,+Ia(p)>=1?p>0?(La(+Ka(p/4294967296),4294967295)|0)>>>0:~~+Ja((p-+(~~p>>>0))/4294967296)>>>0:0)],B[c+40>>2]=I[0],B[c+44>>2]=I[1];B[c+48>>2]=4096;B[c+52>>2]=a.blocks;B[c+56>>2]=a.atime.getTime()/1e3|0;B[c+60>>2]=0;B[c+64>>2]=a.mtime.getTime()/1e3|0;B[c+68>>2]=0;B[c+72>>2]=a.ctime.getTime()/1e3|0;B[c+76>>2]=0;I=[a.ino>>>0,(p=a.ino,+Ia(p)>=1?p>0?(La(+Ka(p/4294967296),4294967295)|0)>>>0:~~+Ja((p-+(~~p>>>0))/4294967296)>>>0:0)],B[c+80>>2]=I[0],B[c+84>>2]=I[1];return 0},doMsync:function(a,b,c,d){a=new Uint8Array(A.subarray(a,a+c));T.msync(b,a,0,c,d)},doMkdir:function(a,b){a=N.normalize(a);a[a.length-1]==="/"&&(a=a.substr(0,a.length-1));T.mkdir(a,b,0);return 0},doMknod:function(a,b,c){switch(b&61440){case 32768:case 8192:case 24576:case 4096:case 49152:break;default:return-22}T.mknod(a,b,c);return 0},doReadlink:function(a,b,c){if(c<=0)return-22;a=T.readlink(a);var d=Math.min(c,x(a)),e=z[b+d];ia(a,b,c+1);z[b+d]=e;return d},doAccess:function(a,b){if(b&-8)return-22;a=T.lookupPath(a,{follow:!0});a=a.node;var c="";b&4&&(c+="r");b&2&&(c+="w");b&1&&(c+="x");return c&&T.nodePermissions(a,c)?-13:0},doDup:function(a,b,c){var d=T.getStream(c);d&&T.close(d);return T.open(a,b,0,c,c).fd},doReadv:function(a,b,c,d){var e=0;for(var f=0;f<c;f++){var g=B[b+f*8>>2],h=B[b+(f*8+4)>>2];g=T.read(a,z,g,h,d);if(g<0)return-1;e+=g;if(g<h)break}return e},doWritev:function(a,b,c,d){var e=0;for(var f=0;f<c;f++){var g=B[b+f*8>>2],h=B[b+(f*8+4)>>2];g=T.write(a,z,g,h,d);if(g<0)return-1;e+=g}return e},varargs:0,get:function(a){U.varargs+=4;a=B[U.varargs-4>>2];return a},getStr:function(){var a=v(U.get());return a},getStreamFromFD:function(){var a=T.getStream(U.get());if(!a)throw new T.ErrnoError(9);return a},get64:function(){var a=U.get();U.get();return a},getZero:function(){U.get()}};function nb(a,b){U.varargs=b;try{a=U.getStreamFromFD();b=U.get();var c=U.get(),d=U.get(),e=U.get(),f=4294967296;b=b*f+(c>>>0);f=9007199254740992;if(b<=-f||b>=f)return-75;T.llseek(a,b,e);I=[a.position>>>0,(p=a.position,+Ia(p)>=1?p>0?(La(+Ka(p/4294967296),4294967295)|0)>>>0:~~+Ja((p-+(~~p>>>0))/4294967296)>>>0:0)],B[d>>2]=I[0],B[d+4>>2]=I[1];a.getdents&&b===0&&e===0&&(a.getdents=null);return 0}catch(a){(typeof T==="undefined"||!(a instanceof T.ErrnoError))&&$(a);return-a.errno}}function ob(a,b){U.varargs=b;try{a=U.getStreamFromFD();b=U.get();var c=U.get();return U.doWritev(a,b,c)}catch(a){(typeof T==="undefined"||!(a instanceof T.ErrnoError))&&$(a);return-a.errno}}function pb(a,b){U.varargs=b;try{a=U.getStreamFromFD();T.close(a);return 0}catch(a){(typeof T==="undefined"||!(a instanceof T.ErrnoError))&&$(a);return-a.errno}}function qb(a,b){if(a==-1||b==0)return-22;var c=U.mappings[a];if(!c)return 0;if(b===c.len){var d=T.getStream(c.fd);U.doMsync(a,d,b,c.flags);T.munmap(d);U.mappings[a]=null;c.allocated&&wc(c.malloc)}return 0}function rb(a,b){U.varargs=b;try{a=U.get();b=U.get();return qb(a,b)}catch(a){(typeof T==="undefined"||!(a instanceof T.ErrnoError))&&$(a);return-a.errno}}function sb(){}function tb(){f.abort()}function ub(){$()}function vb(){return typeof performance==="object"&&performance&&typeof performance.now==="function"}function wb(a,b){var c;if(a===0)c=Date.now();else if(a===1&&vb())c=ub();else{M(22);return-1}B[b>>2]=c/1e3|0;B[b+4>>2]=c%1e3*1e3*1e3|0;return 0}function xb(){return z.length}function yb(a){cd(a)}function V(a){if(a===0)return 0;a=v(a);if(!Object.prototype.hasOwnProperty.call(J,a))return 0;V.ret&&wc(V.ret);V.ret=ja(J[a]);return V.ret}function zb(a){return a}function Ab(a){return Math.pow(2,a)}function Bb(a){return Ab(a)}function Cb(a){var b=Db,c=b.LLVM_SAVEDSTACKS[a];b.LLVM_SAVEDSTACKS.splice(a,1);Y(c)}function Db(){var a=Db;a.LLVM_SAVEDSTACKS||(a.LLVM_SAVEDSTACKS=[]);a.LLVM_SAVEDSTACKS.push(Z());return a.LLVM_SAVEDSTACKS.length-1}function Eb(){$("trap!")}function Fb(a,b,c){A.set(A.subarray(b,b+c),a)}function Gb(){return 0}function Hb(a){$("OOM")}function Ib(a){var b=65536;a=qa(a,b);b=y.byteLength;try{a=r.grow((a-b)/65536);if(a!==(-1|0)){y=r.buffer;return!0}else return!1}catch(a){return!1}}function Jb(a){var b=xb(),c=65536,d=2147483648-c;if(a>d)return!1;var e=16777216;b=Math.max(b,e);while(b<a)b<=536870912?b=qa(2*b,c):b=Math.min(qa((3*b+2147483648)/4,c),d);if(!Ib(b))return!1;ua();return!0}function Kb(a){return a%4===0&&(a%100!==0||a%400===0)}function Lb(a,b){var c=0;for(var d=0;d<=b;c+=a[d++]);return c}var Mb=[31,29,31,30,31,30,31,31,30,31,30,31],Nb=[31,28,31,30,31,30,31,31,30,31,30,31];function Ob(a,b){a=new Date(a.getTime());while(b>0){var c=Kb(a.getFullYear()),d=a.getMonth();c=(c?Mb:Nb)[d];if(b>c-a.getDate())b-=c-a.getDate()+1,a.setDate(1),d<11?a.setMonth(d+1):(a.setMonth(0),a.setFullYear(a.getFullYear()+1));else{a.setDate(a.getDate()+b);return a}}return a}function Pb(a,b,c,d){var e=B[d+40>>2];d={tm_sec:B[d>>2],tm_min:B[d+4>>2],tm_hour:B[d+8>>2],tm_mday:B[d+12>>2],tm_mon:B[d+16>>2],tm_year:B[d+20>>2],tm_wday:B[d+24>>2],tm_yday:B[d+28>>2],tm_isdst:B[d+32>>2],tm_gmtoff:B[d+36>>2],tm_zone:e?v(e):""};e=v(c);c={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var f in c)e=e.replace(new RegExp(f,"g"),c[f]);var g=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],h=["January","February","March","April","May","June","July","August","September","October","November","December"];function i(a,b,c){a=typeof a==="number"?a.toString():a||"";while(a.length<b)a=c[0]+a;return a}function j(a,b){return i(a,b,"0")}function k(a,b){function c(a){return a<0?-1:a>0?1:0}var d;(d=c(a.getFullYear()-b.getFullYear()))===0&&((d=c(a.getMonth()-b.getMonth()))===0&&(d=c(a.getDate()-b.getDate())));return d}function l(a){switch(a.getDay()){case 0:return new Date(a.getFullYear()-1,11,29);case 1:return a;case 2:return new Date(a.getFullYear(),0,3);case 3:return new Date(a.getFullYear(),0,2);case 4:return new Date(a.getFullYear(),0,1);case 5:return new Date(a.getFullYear()-1,11,31);case 6:return new Date(a.getFullYear()-1,11,30)}}function m(a){a=Ob(new Date(a.tm_year+1900,0,1),a.tm_yday);var b=new Date(a.getFullYear(),0,4),c=new Date(a.getFullYear()+1,0,4);b=l(b);c=l(c);if(k(b,a)<=0)if(k(c,a)<=0)return a.getFullYear()+1;else return a.getFullYear();else return a.getFullYear()-1}c={"%a":function(a){return g[a.tm_wday].substring(0,3)},"%A":function(a){return g[a.tm_wday]},"%b":function(a){return h[a.tm_mon].substring(0,3)},"%B":function(a){return h[a.tm_mon]},"%C":function(a){a=a.tm_year+1900;return j(a/100|0,2)},"%d":function(a){return j(a.tm_mday,2)},"%e":function(a){return i(a.tm_mday,2," ")},"%g":function(a){return m(a).toString().substring(2)},"%G":function(a){return m(a)},"%H":function(a){return j(a.tm_hour,2)},"%I":function(a){a=a.tm_hour;a==0?a=12:a>12&&(a-=12);return j(a,2)},"%j":function(a){return j(a.tm_mday+Lb(Kb(a.tm_year+1900)?Mb:Nb,a.tm_mon-1),3)},"%m":function(a){return j(a.tm_mon+1,2)},"%M":function(a){return j(a.tm_min,2)},"%n":function(){return"\n"},"%p":function(a){if(a.tm_hour>=0&&a.tm_hour<12)return"AM";else return"PM"},"%S":function(a){return j(a.tm_sec,2)},"%t":function(){return"\t"},"%u":function(a){return a.tm_wday||7},"%U":function(a){var b=new Date(a.tm_year+1900,0,1),c=b.getDay()===0?b:Ob(b,7-b.getDay());a=new Date(a.tm_year+1900,a.tm_mon,a.tm_mday);if(k(c,a)<0){var d=Lb(Kb(a.getFullYear())?Mb:Nb,a.getMonth()-1)-31,e=31-c.getDate();e=e+d+a.getDate();return j(Math.ceil(e/7),2)}return k(c,b)===0?"01":"00"},"%V":function(a){var b=new Date(a.tm_year+1900,0,4),c=new Date(a.tm_year+1901,0,4);b=l(b);c=l(c);var d=Ob(new Date(a.tm_year+1900,0,1),a.tm_yday);if(k(d,b)<0)return"53";if(k(c,d)<=0)return"01";b.getFullYear()<a.tm_year+1900?c=a.tm_yday+32-b.getDate():c=a.tm_yday+1-b.getDate();return j(Math.ceil(c/7),2)},"%w":function(a){return a.tm_wday},"%W":function(a){var b=new Date(a.tm_year,0,1),c=b.getDay()===1?b:Ob(b,b.getDay()===0?1:7-b.getDay()+1);a=new Date(a.tm_year+1900,a.tm_mon,a.tm_mday);if(k(c,a)<0){var d=Lb(Kb(a.getFullYear())?Mb:Nb,a.getMonth()-1)-31,e=31-c.getDate();e=e+d+a.getDate();return j(Math.ceil(e/7),2)}return k(c,b)===0?"01":"00"},"%y":function(a){return(a.tm_year+1900).toString().substring(2)},"%Y":function(a){return a.tm_year+1900},"%z":function(a){a=a.tm_gmtoff;var b=a>=0;a=Math.abs(a)/60;a=a/60*100+a%60;return(b?"+":"-")+String("0000"+a).slice(-4)},"%Z":function(a){return a.tm_zone},"%%":function(){return"%"}};for(var f in c)e.indexOf(f)>=0&&(e=e.replace(new RegExp(f,"g"),c[f](d)));c=Rb(e,!1);if(c.length>b)return 0;ka(c,a);return c.length-1}function Qb(a,b,c,d){return Pb(a,b,c,d)}T.staticInit();typeof dateNow!=="undefined"?ub=dateNow:typeof performance==="object"&&performance&&typeof performance.now==="function"?ub=function(){return performance.now()}:ub=Date.now;function Rb(a,b,c){c=c>0?c:x(a)+1;c=new Array(c);a=w(a,c,0,c.length);b&&(c.length=a);return c}function Sb(a,b,c,d){var e=Z();try{return zc(a,b,c,d)}catch(a){Y(e);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function Tb(a,b,c,d){var e=Z();try{return Ac(a,b,c,d)}catch(a){Y(e);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function Ub(a){var b=Z();try{return Bc(a)}catch(a){Y(b);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function Vb(a,b){var c=Z();try{return Cc(a,b)}catch(a){Y(c);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function Wb(a,b,c){var d=Z();try{return Dc(a,b,c)}catch(a){Y(d);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function Xb(a,b,c,d){var e=Z();try{return Ec(a,b,c,d)}catch(a){Y(e);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function Yb(a,b,c,d){var e=Z();try{return Fc(a,b,c,d)}catch(a){Y(e);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function Zb(a,b,c,d,e){var f=Z();try{return Gc(a,b,c,d,e)}catch(a){Y(f);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function $b(a,b,c,d,e,f){var g=Z();try{return Hc(a,b,c,d,e,f)}catch(a){Y(g);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function ac(a,b,c,d,e,f,g){var h=Z();try{return Ic(a,b,c,d,e,f,g)}catch(a){Y(h);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function bc(a,b,c,d,e,f,g,h){var i=Z();try{return Jc(a,b,c,d,e,f,g,h)}catch(a){Y(i);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function cc(a,b,c,d,e,f,g,h,i){var j=Z();try{return Kc(a,b,c,d,e,f,g,h,i)}catch(a){Y(j);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function dc(a,b,c,d,e,f,g,h,i,j,k){var l=Z();try{return Lc(a,b,c,d,e,f,g,h,i,j,k)}catch(a){Y(l);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function ec(a,b,c,d,e,f,g,h,i,j,k,l){var m=Z();try{return Mc(a,b,c,d,e,f,g,h,i,j,k,l)}catch(a){Y(m);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function fc(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=Z();try{return Nc(a,b,c,d,e,f,g,h,i,j,k,l,m)}catch(a){Y(n);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function gc(a,b,c,d,e){var f=Z();try{return Oc(a,b,c,d,e)}catch(a){Y(f);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function hc(a){var b=Z();try{Pc(a)}catch(a){Y(b);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function ic(a,b){var c=Z();try{Qc(a,b)}catch(a){Y(c);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function jc(a,b,c){var d=Z();try{Rc(a,b,c)}catch(a){Y(d);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function kc(a,b,c,d,e,f,g,h){var i=Z();try{Sc(a,b,c,d,e,f,g,h)}catch(a){Y(i);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function lc(a,b,c,d){var e=Z();try{Tc(a,b,c,d)}catch(a){Y(e);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function mc(a,b,c,d,e){var f=Z();try{Uc(a,b,c,d,e)}catch(a){Y(f);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function nc(a,b,c,d,e,f){var g=Z();try{Vc(a,b,c,d,e,f)}catch(a){Y(g);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function oc(a,b,c,d,e,f,g){var h=Z();try{Wc(a,b,c,d,e,f,g)}catch(a){Y(h);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function pc(a,b,c,d,e,f,g){var h=Z();try{Xc(a,b,c,d,e,f,g)}catch(a){Y(h);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function qc(a,b,c,d,e,f,g,h){var i=Z();try{Yc(a,b,c,d,e,f,g,h)}catch(a){Y(i);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function rc(a,b,c,d,e,f,g,h,i,j,k){var l=Z();try{Zc(a,b,c,d,e,f,g,h,i,j,k)}catch(a){Y(l);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}function sc(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,aa){var p=Z();try{$c(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,aa)}catch(a){Y(p);if(a!==a+0&&a!=="longjmp")throw a;X(1,0)}}D={};i={s:$,Y:q,b:m,L:Sb,T:Tb,t:Ub,f:Vb,i:Wb,G:Xb,r:Yb,q:Zb,N:$b,B:ac,W:bc,V:cc,w:dc,M:ec,F:fc,X:gc,l:hc,m:ic,e:jc,I:kc,g:lc,k:mc,j:nc,U:oc,K:pc,y:qc,E:rc,J:sc,ma:Va,n:Wa,u:$a,v:cb,c:fb,h:gb,p:ab,la:hb,S:ib,o:jb,ka:kb,ja:lb,ia:mb,d:db,R:M,ha:nb,Q:ob,ga:pb,fa:rb,P:sb,O:tb,ea:wb,da:xb,ca:Fb,ba:Jb,aa:yb,H:V,C:zb,D:Bb,A:Cb,z:Db,x:Eb,$:Gb,_:Qb,Z:Hb,a:C};E=f.asm(D,i,y);f.asm=E;var W=f.__ZSt18uncaught_exceptionv=function(){return f.asm.na.apply(null,arguments)},tc=f.___cxa_can_catch=function(){return f.asm.oa.apply(null,arguments)},uc=f.___cxa_is_pointer_type=function(){return f.asm.pa.apply(null,arguments)},vc=f.___emscripten_environ_constructor=function(){return f.asm.qa.apply(null,arguments)};f.___errno_location=function(){return f.asm.ra.apply(null,arguments)};var wc=f._free=function(){return f.asm.sa.apply(null,arguments)},xc=f._malloc=function(){return f.asm.ta.apply(null,arguments)};f._resizeJpeg=function(){return f.asm.ua.apply(null,arguments)};var X=f._setThrew=function(){return f.asm.va.apply(null,arguments)},yc=f.stackAlloc=function(){return f.asm.Ya.apply(null,arguments)},Y=f.stackRestore=function(){return f.asm.Za.apply(null,arguments)},Z=f.stackSave=function(){return f.asm._a.apply(null,arguments)},zc=f.dynCall_diii=function(){return f.asm.wa.apply(null,arguments)},Ac=f.dynCall_fiii=function(){return f.asm.xa.apply(null,arguments)},Bc=f.dynCall_i=function(){return f.asm.ya.apply(null,arguments)},Cc=f.dynCall_ii=function(){return f.asm.za.apply(null,arguments)},Dc=f.dynCall_iii=function(){return f.asm.Aa.apply(null,arguments)},Ec=f.dynCall_iiif=function(){return f.asm.Ba.apply(null,arguments)},Fc=f.dynCall_iiii=function(){return f.asm.Ca.apply(null,arguments)},Gc=f.dynCall_iiiii=function(){return f.asm.Da.apply(null,arguments)},Hc=f.dynCall_iiiiii=function(){return f.asm.Ea.apply(null,arguments)},Ic=f.dynCall_iiiiiii=function(){return f.asm.Fa.apply(null,arguments)},Jc=f.dynCall_iiiiiiii=function(){return f.asm.Ga.apply(null,arguments)},Kc=f.dynCall_iiiiiiiii=function(){return f.asm.Ha.apply(null,arguments)},Lc=f.dynCall_iiiiiiiiiii=function(){return f.asm.Ia.apply(null,arguments)},Mc=f.dynCall_iiiiiiiiiiii=function(){return f.asm.Ja.apply(null,arguments)},Nc=f.dynCall_iiiiiiiiiiiii=function(){return f.asm.Ka.apply(null,arguments)},Oc=f.dynCall_jiiii=function(){return f.asm.La.apply(null,arguments)},Pc=f.dynCall_v=function(){return f.asm.Ma.apply(null,arguments)},Qc=f.dynCall_vi=function(){return f.asm.Na.apply(null,arguments)},Rc=f.dynCall_vii=function(){return f.asm.Oa.apply(null,arguments)},Sc=f.dynCall_viifiiii=function(){return f.asm.Pa.apply(null,arguments)},Tc=f.dynCall_viii=function(){return f.asm.Qa.apply(null,arguments)},Uc=f.dynCall_viiii=function(){return f.asm.Ra.apply(null,arguments)},Vc=f.dynCall_viiiii=function(){return f.asm.Sa.apply(null,arguments)},Wc=f.dynCall_viiiiif=function(){return f.asm.Ta.apply(null,arguments)},Xc=f.dynCall_viiiiii=function(){return f.asm.Ua.apply(null,arguments)},Yc=f.dynCall_viiiiiii=function(){return f.asm.Va.apply(null,arguments)},Zc=f.dynCall_viiiiiiiiii=function(){return f.asm.Wa.apply(null,arguments)},$c=f.dynCall_viiiiiiiiiiiiiii=function(){return f.asm.Xa.apply(null,arguments)};f.asm=E;f.ccall=ea;f.cwrap=fa;f.getMemory=ga;f.then=function(a){if(f.calledRun)a(f);else{var b=f.onRuntimeInitialized;f.onRuntimeInitialized=function(){b&&b(),a(f)}}return f};function ad(a){this.name="ExitStatus",this.message="Program terminated with exit("+a+")",this.status=a}ad.prototype=new Error();ad.prototype.constructor=ad;G=function a(){f.calledRun||bd(),f.calledRun||(G=a)};function bd(a){a||f.arguments;if(F>0)return;Ba();if(F>0)return;if(f.calledRun)return;function b(){if(f.calledRun)return;f.calledRun=!0;if(s)return;Ca();Da();f.onRuntimeInitialized&&f.onRuntimeInitialized();Fa()}f.setStatus?(f.setStatus("Running..."),setTimeout(function(){setTimeout(function(){f.setStatus("")},1),b()},1)):b()}f.run=bd;function cd(a,b){if(b&&f.noExitRuntime&&a===0)return;f.noExitRuntime||(s=!0,a,Ea(),f.onExit&&f.onExit(a));f.quit(a,new ad(a))}function $(a){f.onAbort&&f.onAbort(a);a!==void 0?(n(a),o(a),a='"'+a+'"'):a="";s=!0;throw"abort("+a+"). Build with -s ASSERTIONS=1 for more info."}f.abort=$;if(f.preInit){typeof f.preInit=="function"&&(f.preInit=[f.preInit]);while(f.preInit.length>0)f.preInit.pop()()}f.noExitRuntime=!0;bd();return d}}();typeof f==="object"&&typeof e==="object"?e.exports=h:typeof define==="function"&&define.amd?define([],function(){return h}):typeof f==="object"&&(f.SpectrumWasm=h)}),null);
__d("SpectrumImageResizer",["invariant","Promise","BlobFactory","FBLogger","SpectrumWasm","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h=2048,i=2048,j=85,k=null,l=null;a=function(){a.isSupported=function(){try{if(typeof WebAssembly==="object"&&typeof WebAssembly.instantiate==="function"){var a=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(a instanceof WebAssembly.Module)return new WebAssembly.Instance(a)instanceof WebAssembly.Instance}}catch(a){b("FBLogger")("spectrum").catching(a).mustfix("Instantiating empty WebAssembly module threw an error")}return!1};a.getSingleton=function(){k||(k=new a());return k};function a(){this.$1=h,this.$2=i,this.$3=j,l=b("SpectrumWasm")()}var c=a.prototype;c.setEncodeQuality=function(a){this.$3=a;return this};c.setMaxWidth=function(a){this.$2=a;return this};c.setMaxHeight=function(a){this.$1=a;return this};c.resizeBlob=function(a,b){return this.$4(a,this.$2,this.$1,this.$3,b)};c.resize360Blob=function(a,b,c){var d,e;c===void 0||c===null?(d=this.$2*4,e=this.$1*4):(d=c,e=c);return this.$4(a,d,e,this.$3,b)};c.$4=function(a,c,d,e,f){var h=new FileReader();h.onload=function(h){var i=new Uint8Array(this.result);i.length>0||g(0,18539);function j(a){return new(b("Promise"))(function(b,c){var d=new Image();d.onload=function(){URL.revokeObjectURL(d.src),b({width:d.width,height:d.height})};d.onerror=function(a){URL.revokeObjectURL(d.src),c(a)};d.src=URL.createObjectURL(a)})}return j(a).then(function(a){l!=null||g(0,18573);return l.then(function(g){var h=g.cwrap("resizeJpeg","number",["number","number","number","number","number","number"]);function k(a){var b=g.getMemory(a.length);g.HEAP8.set(a,b);return b}var l=0,m=0;try{var n=function(a,b){var c=new Int8Array(b);c.set(g.HEAP8.subarray(a,a+b));return c};l=g.getMemory(i.length);m=k(i);k=h(m,i.length,l,c,d,e);h=n(l,k);var o=b("BlobFactory").getBlob([h],{type:"image/jpeg",done:!0});b("promiseDone")(j(o).then(function(b){f(null,o,!1,a.width,a.height,b.width,b.height)}))}finally{m!==0&&g._free(m),l!==0&&g._free(l)}})})["catch"](function(a){f(a,null,!0,null,null,null,null)})};h.readAsArrayBuffer(a);return this};return a}();e.exports=a}),null);
__d("XVideoUnifiedCVCControllerRouteBuilder",["jsRouteBuilder"],(function(a,b,c,d,e,f){a=b("jsRouteBuilder")("/video/unified_cvc/",Object.freeze({}),void 0);c=a;e.exports=c}),null);
__d("useRouteProductAttribution",["CometRouterRouteInfoContext","React"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(){var a=g.useContext(b("CometRouterRouteInfoContext"));return a==null?void 0:a.productAttribution}}),null);
__d("useEventCallbackOn",["React"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a,b,c){g.useEffect(function(){a.addEventListener(b,c);return function(){a.removeEventListener(b,c)}},[a,b,c])}}),null);
__d("VideoPlayerContextSensitiveConfigUtils",[],(function(a,b,c,d,e,f){"use strict";var g=function(a,b){return b.every(function(b){return a[b.name]===b.value})};a=function(a,b){return b.find(function(b){return g(a,b.contexts)})};f.getFirstMatchingValueAndContextTargets=a}),null);
__d("VideoPlayerContextSensitiveConfigResolver",["requireCond","VideoPlayerContextSensitiveConfigUtils","VideoPlayerContextSensitiveConfigPayload","cr:1724253"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1={},this.$2={},a==null?(this.$3=b("VideoPlayerContextSensitiveConfigPayload").static_values,this.$4=b("VideoPlayerContextSensitiveConfigPayload").context_sensitive_values):(this.$3=a.staticValues,this.$4=a.contextSensitiveValues)}var c=a.prototype;c.setContexts=function(a){this.$1=a,this.$2=this.$5(a)};c.getValue=function(a){if(this.$2[a]!=null)return this.$2[a];return this.$3[a]!=null?this.$3[a]:null};c.$5=function(a){var c=this;return Object.keys(this.$4).reduce(function(d,e){var f=c.$4[e];if(f!=null){f=b("VideoPlayerContextSensitiveConfigUtils").getFirstMatchingValueAndContextTargets(a,f);f!=null&&(d[e]=f.value)}return d},{})};a.getPayload=function(){return b("VideoPlayerContextSensitiveConfigPayload")};a.getSources=function(){return b("cr:1724253")};return a}();e.exports=a}),null);
__d("VideoPlayerShakaGlobalConfig",["VideoPlayerContextSensitiveConfigResolver"],(function(a,b,c,d,e,f){var g=new(b("VideoPlayerContextSensitiveConfigResolver"))(),h={};a=function(a){h=a};f.setGlobalOverrideConfig=a;c=function(a,b){if(!!h&&typeof h[a]==="boolean")return h[a];a=g.getValue(a);return a!=null&&typeof a==="boolean"?a:b};f.getBool=c;d=function(a,b){if(!!h&&typeof h[a]==="number")return h[a];a=g.getValue(a);return a!=null&&typeof a==="number"?a:b};f.getNumber=d;e=function(a,b){if(!!h&&typeof h[a]==="string")return h[a];a=g.getValue(a);return a!=null&&typeof a==="string"?a:b};f.getString=e}),null);
__d("useIsBackgrounded",["React","VideoPlayerShakaGlobalConfig","useEventCallbackOn"],(function(a,b,c,d,e,f){"use strict";e.exports=d;var g=b("React");function c(){var b=a.document;if(typeof b.hidden!=="undefined")return"visibilitychange";else if(typeof b.mozHidden!=="undefined")return"mozvisibilitychange";else if(typeof b.msHidden!=="undefined")return"msvisibilitychange";else if(typeof b.webkitHidden!=="undefined")return"webkitvisibilitychange";return"visibilitychange"}function h(){var b=a.document;if(typeof b.hidden!=="undefined")return b.hidden;else if(typeof b.mozHidden!=="undefined")return b.mozHidden;else if(typeof b.msHidden!=="undefined")return b.msHidden;else if(typeof b.webkitHidden!=="undefined")return b.webkitHidden;return!1}var i=c();function j(){var c=a.document.hasFocus?a.document.hasFocus():!0,d=h(),e=b("VideoPlayerShakaGlobalConfig").getBool("comet_www_no_pause_on_blur_or_focus_events",!1);return d||(e?!1:!c)}function d(c){var d=g.useState(function(){return j()}),e=d[0],f=d[1],h=!!c&&c.scrollTerminatesBackgrounded===!0;d=g.useCallback(function(){f(j())},[f,j]);c=d;var k=g.useCallback(function(){var a=j();a&&h&&e&&f(!1)},[e,h,f]);b("VideoPlayerShakaGlobalConfig").getBool("comet_www_no_pause_on_blur_or_focus_events",!1)&&(c=function(){});b("useEventCallbackOn")(a.window,"blur",c);b("useEventCallbackOn")(a.window,"focus",c);b("useEventCallbackOn")(a.document,i,d);b("useEventCallbackOn")(a.window,"scroll",k);return e}}),null);
__d("VideoPlayerViewabilityProvider.react",["React","VideoPlayerViewabilityContexts"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var c=a.children,d=a.isFullscreen;a=a.videoPlayerPassiveViewabilityInfo;return g.jsx(b("VideoPlayerViewabilityContexts").VideoPlayerPassiveViewabilityInfoContext.Provider,{value:a,children:g.jsx(b("VideoPlayerViewabilityContexts").VideoPlayerFullscreenContext.Provider,{value:d,children:c})})}}),null);
__d("wrapWithContextProviders",["React"],(function(a,b,c,d,e,f){"use strict";f.wrapWithContextProviders=a;f.makeRenderProviderFn=c;var g=b("React");function a(a,b){return b.reduceRight(function(a,b){return b(a)},a)}function c(a,b){return function(c){return g.jsx(a.Provider,{value:b,children:c})}}}),null);
__d("VideoPlayerComponentContainer.react",["CometVisualCompletionAttributes","React","VideoPlayerContexts","VideoPlayerHooks","VideoPlayerViewabilityProvider.react","clearTimeout","requireCond","setTimeout","stylex","wrapWithContextProviders","cr:1269159"],(function(a,b,c,d,e,f){"use strict";var g=b("React");function h(a){var c=g.useRef(a);g.useEffect(function(){c.current=a},[a]);var d=g.useState(!1),e=d[0],f=d[1];d=g.useState(function(){var a=null;return{cleanup:function(){a&&a()},pingNotIdle:function(){a&&a();f(!1);var d=b("setTimeout")(function(){f(!0)},c.current);a=function(){b("clearTimeout")(d),a=null}}}});d=d[0];var h=d.cleanup;d=d.pingNotIdle;g.useEffect(function(){return h},[h]);return{isIdle:e,pingNotIdle:d}}function i(){var a=g.useState(!1),b=a[0],c=a[1];a=3e3;a=h(a);var d=a.isIdle,e=a.pingNotIdle;a=g.useCallback(function(){c(!0),e()},[e]);var f=g.useCallback(function(){c(!1),e()},[e]),i=g.useCallback(function(){c(!0),e()},[e]),j=g.useCallback(function(){e()},[e]),k=g.useCallback(function(){e()},[e]);return{isHovering:b,isIdle:d,onMouseDown:j,onMouseEnter:a,onMouseLeave:f,onMouseMove:i,onMouseUp:k}}function j(a){var c=i(),d=c.isHovering,e=c.isIdle,f=c.onMouseDown,h=c.onMouseEnter,j=c.onMouseLeave,k=c.onMouseMove;c=c.onMouseUp;var l=b("VideoPlayerHooks").useIsFullscreen();return g.jsx("div",babelHelpers["extends"]({className:"k4urcfbm kr520xx4 pmk7jnqg datstx6m"+(l&&e?" sorcqhzv":"")},b("CometVisualCompletionAttributes").IGNORE,{onMouseDown:f,onMouseEnter:h,onMouseLeave:j,onMouseMove:k,onMouseUp:c,children:g.jsx(b("VideoPlayerContexts").VideoPlayerMouseHoverContext.Provider,{value:d,children:g.jsx(b("VideoPlayerContexts").VideoPlayerMouseIdleContext.Provider,{value:e,children:a.children})})}))}function a(a){var c=a.children;a=babelHelpers.objectWithoutPropertiesLoose(a,["children"]);var d=a.adClientToken,e=a.audioAvailabilityInfo,f=a.autoplayGatingResult,h=a.broadcastStatus,i=a.canAutoplay,k=a.controller,l=a.dimensions,m=a.initialTracePolicy,n=a.instanceKey,o=a.isFullscreen,p=a.isPremiumMusicVideo,q=a.lastMuteReason,r=a.lastPauseReason,s=a.lastPlayReason,t=a.originalHeight,u=a.originalWidth,v=a.videoFBID,w=a.videoPlayerPassiveViewabilityInfo,x=a.videoState,y=a.volumeSetting,z=x.activeCaptions,A=x.availableVideoQualities,B=x.bufferEnd,C=x.captionsLoaded,D=x.captionsVisible,E=x.currentVideoQuality,F=x.duration,G=x.ended,H=x.error,I=x.inbandCaptionsAutogenerated,J=x.inPlayStalling,K=x.isAbrEnabled,L=x.isLiveRewindActive,M=x.lastPlayedTimeMs,N=x.loopCount,O=x.loopCurrent,P=x.muted,Q=x.paused,R=x.playerImplementationName,S=x.playing,T=x.seekableRanges,U=x.seeking,V=x.selectedVideoQuality,W=x.stalling,X=x.streamInterrupted,Y=x.targetAudioQuality,Z=x.targetPlaybackRate,$=x.targetVideoQuality,aa=x.volume;x=x.watchTimeMs;c=g.jsx(j,{children:c});b("cr:1269159")(n,{controller:k,coreVideoStates:a,videoPlayerPassiveViewabilityInfo:w});v=(a=b("wrapWithContextProviders")).wrapWithContextProviders(c,[a.makeRenderProviderFn((c=b("VideoPlayerContexts")).VideoFBIDContext,v),a.makeRenderProviderFn(c.StallingContext,W),a.makeRenderProviderFn(c.PlayingContext,S),a.makeRenderProviderFn(c.InPlayStallingContext,J),a.makeRenderProviderFn(c.BufferEndContext,B),a.makeRenderProviderFn(c.LastMuteReasonContext,q),a.makeRenderProviderFn(c.LastPlayReasonContext,s),a.makeRenderProviderFn(c.LastPauseReasonContext,r),a.makeRenderProviderFn(c.PausedContext,Q),a.makeRenderProviderFn(c.CurrentVideoQualityContext,E),a.makeRenderProviderFn(c.MutedContext,P),a.makeRenderProviderFn(c.VolumeContext,aa),a.makeRenderProviderFn(c.SelectedVideoQualityContext,V),a.makeRenderProviderFn(c.SeekingContext,U),a.makeRenderProviderFn(c.DurationContext,F),a.makeRenderProviderFn(c.EndedContext,G),a.makeRenderProviderFn(c.ErrorContext,H),a.makeRenderProviderFn(c.DimensionsContext,l||null),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").InstanceKeyContext,n),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").ControllerContext,k),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").AvailableVideoQualitiesContext,A),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").PlayerImplementationNameContext,R),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").IsAbrEnabledContext,K),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").TargetAudioQualityContext,Y),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").TargetVideoQualityContext,$),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").PlaybackRateContext,Z),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").CanAutoplayContext,i),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").VolumeSettingContext,y),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").AutoplayGatingResultContext,f),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").BroadcastStatusContext,h),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").LoopCountContext,N),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").LoopCurrentContext,O),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").AdClientTokenContext,d),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").ActiveCaptionsContext,z),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").CaptionsVisibleContext,D),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").CaptionsLoadedContext,C),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").InbandCaptionsAutogeneratedContext,I),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").StreamInterruptedContext,X),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").WatchTimeContext,x),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").LastPlayedTimeContext,M),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").SeekableRangesContext,T),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").IsLiveRewindActiveContext,L),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").AudioAvailabilityInfoContext,e),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").IsPremiumMusicVideoContext,p),b("wrapWithContextProviders").makeRenderProviderFn(b("VideoPlayerContexts").InitialTracePolicyContext,m),function(a){return g.jsx(b("VideoPlayerContexts").VideoOriginalDimensionsContextMemoProvider,{originalHeight:t,originalWidth:u,children:a})},function(a){return g.jsx(b("VideoPlayerViewabilityProvider.react"),{isFullscreen:o,videoPlayerPassiveViewabilityInfo:w,children:a})}]);return g.jsx("div",{"data-instancekey":n,"data-testid":void 0,children:v})}c=g.memo(a);e.exports=c}),null);
__d("GlobalVideoPortsID",["cometUniqueID","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";f.makeVideoID=a;f.ensureVideoID=c;f.makePlaceID=d;function a(){return"id-pv-"+b("cometUniqueID")()}function c(a){if(typeof a==="string"){var c="id-pv-";if(a.indexOf(c)===0&&a.length>c.length)return a;else throw b("unrecoverableViolation")('Expected a GlobalVideoPortsVideoID, got a string that does not look like it: "'+a+'"',"comet_video_player")}else return null}function d(){return"id-pp-"+b("cometUniqueID")()}}),null);
__d("VideoPlayerFullscreenController",["CometFullScreen","removeFromArray","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";f.createFullscreenController=a;function g(a){return a.current!=null&&b("CometFullScreen").getFullScreenElement()===a.current}function a(a){var c=[];function d(){c.forEach(function(a){a()})}var e=null;return{getIsFullscreen:function(){return g(a)},requestSetIsFullscreen:function(c){var d=a.current;if(d==null)throw b("unrecoverableViolation")("Requested full screen while the element is not present","comet_video_player");c!==g(a)&&(c===!0?b("CometFullScreen").requestFullScreen(d):c===!1&&b("CometFullScreen").exitFullScreen())},subscribe:function(a){c.length===0&&e==null&&(e=b("CometFullScreen").subscribeToFullScreenChangeEvent(d));c.push(a);return{remove:function(){b("removeFromArray")(c,a),c.length===0&&e!=null&&(e(),e=null)}}}}}}),null);
__d("VideoPlayerPortalingPlaceState",["GlobalVideoPortsContexts","GlobalVideoPortsID","React","gkx","usePrevious"],(function(a,b,c,d,e,f){"use strict";f.useVideoPlayerPortalingPlaceState=a;var g=b("React");c=function(a,c){var d=b("usePrevious")(a);g.useEffect(function(){a!==d&&(d!==null&&d&&!a&&c(b("GlobalVideoPortsID").makeVideoID()))},[a,d,c])};d=function(a,c){var d=g.useState(null),e=d[0];d=d[1];a!==e&&(e!==null&&e&&!a&&c(b("GlobalVideoPortsID").makeVideoID()),d(a))};var h=b("gkx")("1375802")?d:c;f.useRegenerateUniqueVideoID_exportedForTest=h;function a(a){var c=a.portalingEnabled;a=a.portalingFromVideoID;var d=b("GlobalVideoPortsContexts").useGlobalVideoPortsLoader(),e=b("GlobalVideoPortsContexts").useGlobalVideoPortsManager(),f=b("GlobalVideoPortsContexts").useGlobalVideoPortsState(),i=e!=null&&f!=null,j=(i||d!=null)&&(c||a!=null),k=g.useState(function(){return b("GlobalVideoPortsID").makePlaceID()});k=k[0];var l=g.useState(function(){return b("GlobalVideoPortsID").makeVideoID()}),m=l[0];l=l[1];c=j&&c&&a!=null;a=c&&a!=null?a:m;h(c,l);g.useEffect(function(){j&&!i&&d&&d()},[i,j,d]);return{canBecomePortableLater:j,currentVideoID:a,globalVideoPortsManager:e,globalVideoPortsState:f,thisPlaceID:k}}}),null);
__d("VideoPlayerPortalingPlaceWithPortaling.react",["CoreVideoPlayerFitParentContainer.react","GlobalVideoPortsRenderers.react","React","getOwnObjectValues","useLayoutEffect_SAFE_FOR_SSR"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var c=a.coreVideoPlayerMetaData,d=a.currentVideoID,e=a.fullscreenController,f=a.globalVideoPortsManager,h=a.globalVideoPortsState,i=a.implementations,j=a.isFullscreen,k=a.portablePlaceMetaData,l=a.renderComponents,m=a.renderPlaceholder,n=a.thisPlaceID,o=a.trackingDataEncrypted,p=a.trackingNodes,q=a.viewportMarginsForViewability;a=g.useState(function(){return b("CoreVideoPlayerFitParentContainer.react").createFitParentContainerDiv({debugRole:null})});var r=a[0],s=g.useRef(null);b("useLayoutEffect_SAFE_FOR_SSR")(function(){f.addOrUpdatePlace({coreVideoPlayerMetaData:c,fullscreenController:e,implementations:i,injectCoreVideoStatesRef:s,isFullscreen:j,portablePlaceContainer:r,portablePlaceID:n,portablePlaceMetaData:k,portableVideoID:d,renderComponents:l,renderPlaceholder:m,trackingDataEncrypted:o,trackingNodes:p,viewportMarginsForViewability:q})},[].concat(b("getOwnObjectValues")(c),[d,e,j,f,r],b("getOwnObjectValues")(k||{}),[l,m,n,o,p,q]));b("useLayoutEffect_SAFE_FOR_SSR")(function(){return function(){f.removePlace({portablePlaceID:n})}},[f,n]);a=f.getPortableVideoState(h,d);return g.jsxs(g.Fragment,{children:[g.jsx(b("CoreVideoPlayerFitParentContainer.react").CoreVideoPlayerFitParentDOMContainer,{debugRole:null,domElement:r},n),g.jsx(b("GlobalVideoPortsRenderers.react").GlobalVideoPortsVideoComponentsRenderer,{currentPlaceID:(h=(h=f.getCurrentPlaceStateForVideo(h,d))==null?void 0:h.portablePlaceID)!=null?h:null,currentVideoID:d,injectCoreVideoStatesRef:s,previousPlaceMetaData:(h=a==null?void 0:a.previousPlaceMetaData)!=null?h:null,renderComponents:l,thisPlaceID:n})]})}}),null);
__d("VideoPlayerPortalingPlace.react",["CometTrackingCodeContext","CometTrackingNodesContext","CometViewportMarginsContext","CoreVideoPlayer.react","CoreVideoPlayerFitParentContainer.react","GlobalVideoPortsID","GlobalVideoPortsRenderers.react","React","VideoPlayerFullscreenController","VideoPlayerPortalingPlaceInfoProvider.react","VideoPlayerPortalingPlaceState","VideoPlayerPortalingPlaceWithPortaling.react","recoverableViolation","useStable"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React"),h={bottom:0,left:0,right:0,top:0},i=g.forwardRef(function(a,c){var d=a.children;a=a.debugRole;return g.jsx(b("CoreVideoPlayerFitParentContainer.react").CoreVideoPlayerFitParentContainer,{debugRole:a,ref:c,children:d})});function a(a){var c=a.implementations,d=a.portalingEnabled,e=a.portalingFromVideoID,f=a.portalingPlaceMetaData,j=a.renderComponents,k=a.renderPlaceholder;a=babelHelpers.objectWithoutPropertiesLoose(a,["implementations","portalingEnabled","portalingFromVideoID","portalingPlaceMetaData","renderComponents","renderPlaceholder"]);g.useEffect(function(){return function(){}},[]);var l=e!=null?b("GlobalVideoPortsID").ensureVideoID(e):null;e!=null&&l==null&&b("recoverableViolation")("The provided portalingFromVideoID ("+String(e)+") does not look like such an ID. The video player will not use portaling until a valid ID is provided","comet_video_player");e=b("VideoPlayerPortalingPlaceState").useVideoPlayerPortalingPlaceState({portalingEnabled:d,portalingFromVideoID:l});d=e.canBecomePortableLater;l=e.currentVideoID;var m=e.globalVideoPortsManager,n=e.globalVideoPortsState;e=e.thisPlaceID;var o=g.useContext(b("CometViewportMarginsContext")),p=g.useRef(null),q=b("useStable")(function(){return b("VideoPlayerFullscreenController").createFullscreenController(p)}),r=g.useState(q.getIsFullscreen()),s=r[0],t=r[1];g.useEffect(function(){var a=q.subscribe(function(){var a=q.getIsFullscreen();t(a)});t(q.getIsFullscreen());return function(){a.remove()}},[q,t]);r=g.useContext(b("CometTrackingNodesContext"));r=r.join("");var u=g.useContext(b("CometTrackingCodeContext"));u=(u=u.encrypted_tracking[0])!=null?u:"";o=s?h:o;if(!d)return g.jsx(i,{debugRole:null,ref:p,children:g.jsx(b("VideoPlayerPortalingPlaceInfoProvider.react").VideoPlayerPortalingPlaceInfoProvider,{currentPlaceID:e,currentVideoID:l,portalingEnabled:!1,previousPlaceMetaData:null,thisPlaceID:e,children:g.jsx(b("CoreVideoPlayer.react"),babelHelpers["extends"]({},a,{fullscreenController:q,implementations:c,isFullscreen:s,renderWithCoreVideoStates:j,trackingDataEncrypted:u,trackingNodes:r,viewportMarginsForViewability:o}))})});if(m&&n)return g.jsx(i,{debugRole:null,ref:p,children:g.jsx(b("VideoPlayerPortalingPlaceWithPortaling.react"),{coreVideoPlayerMetaData:a,currentVideoID:l,fullscreenController:q,globalVideoPortsManager:m,globalVideoPortsState:n,implementations:c,isFullscreen:s,portablePlaceMetaData:f,renderComponents:j,renderPlaceholder:k,thisPlaceID:e,trackingDataEncrypted:u,trackingNodes:r,viewportMarginsForViewability:o})});else return g.jsx(i,{debugRole:null,ref:p,children:g.jsx(b("GlobalVideoPortsRenderers.react").GlobalVideoPortsPlaceholderRenderer,{currentPlaceID:null,currentVideoID:l,originalHeight:a.originalHeight,originalWidth:a.originalWidth,previousPlaceMetaData:null,renderPlaceholder:k,thisPlaceID:e})})}}),null);
__d("VideoPlayerTracePolicyContext",["React"],(function(a,b,c,d,e,f){"use strict";f.useVideoPlayerTracePolicy=a;var g=b("React");c={initialTracePolicy:null,routeTracePolicy:null};var h=g.createContext(c);f.VideoPlayerTracePolicyContext=h;function a(){return g.useContext(h)}}),null);
__d("VideoPlayerTracePolicyProvider.react",["React","VideoPlayerTracePolicyContext"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var c=a.children,d=a.initialTracePolicy,e=a.routeTracePolicy;a=g.useState(d);var f=a[0],h=a[1];a=g.useState(e);var i=a[0],j=a[1];g.useEffect(function(){f!==d&&h(d),i!==e&&j(e)},[d,e,f,i]);return g.jsx(b("VideoPlayerTracePolicyContext").VideoPlayerTracePolicyContext.Provider,{value:{initialTracePolicy:f,routeTracePolicy:i},children:c})}}),null);
__d("CoreVideoPlayerWithComponents.react",["React","VideoPlayerComponentContainer.react","VideoPlayerPortalingPlace.react","VideoPlayerTracePolicyProvider.react"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var c=a.children,d=a.implementations,e=a.portalingEnabled,f=a.portalingFromVideoID,h=a.portalingPlaceMetaData,i=a.portalingRenderPlaceholder;a=babelHelpers.objectWithoutPropertiesLoose(a,["children","implementations","portalingEnabled","portalingFromVideoID","portalingPlaceMetaData","portalingRenderPlaceholder"]);var j=g.useCallback(function(a){return g.jsx(b("VideoPlayerComponentContainer.react"),babelHelpers["extends"]({},a,{children:c}))},[c]);return g.jsx(b("VideoPlayerTracePolicyProvider.react"),{initialTracePolicy:a.initialTracePolicy,routeTracePolicy:a.routeTracePolicy,children:g.jsx(b("VideoPlayerPortalingPlace.react"),babelHelpers["extends"]({},a,{implementations:d,portalingEnabled:e,portalingFromVideoID:f,portalingPlaceMetaData:h,renderComponents:j,renderPlaceholder:i}))})}}),null);
__d("VideoPlayerErrorBoundary.react",["FBLogger","React","getErrorSafe"],(function(a,b,c,d,e,f){"use strict";a=b("React");c=function(a){babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.state={error:null},c.suppressReactDefaultErrorLogging=!0,b)||babelHelpers.assertThisInitialized(c)}c.getDerivedStateFromError=function(a){return{error:b("getErrorSafe")(a)}};var d=c.prototype;d.componentDidCatch=function(a,c){c=c.componentStack;a=b("getErrorSafe")(a);a.componentStack=c;c=this.props;var d=c.description,e=c.onError;c=c.project;var f="ErrorBoundary caught an Error";d!=null&&(f=f+" ("+d+")");d=["OZ_NETWORK","BUFFERING_TIMEOUT","MEDIA_ERR_DECODE"];var g=!0;for(var h=0;h<d.length;h++)a.message.includes(d[h])&&(g=!1);d=b("FBLogger")(c==null?"comet_video_player":c).catching(a);g?d.fatal(f):d.warn(f);e!=null&&e(a)};d.render=function(){var a=this.props,b=a.children;a=a.fallback;var c=this.state.error;return c?typeof a==="function"?a(c):a:b};return c}(a.PureComponent);e.exports=c}),null);
__d("VideoPlayerAutoplayHooks",["React","VideoPlayerAutoplayContexts","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";f.useAutoplayApi=a;f.useVideoAutoplayLocalScope=c;var g=b("React");function a(){var a=g.useContext(b("VideoPlayerAutoplayContexts").AutoplayApiContext);if(a==null)throw b("unrecoverableViolation")("Empty AutoplayApiContext. Are you rendering useAutoplayApi outside of VideoAutoplayManagerX?","comet_video_player");return a}function c(){return g.useContext(b("VideoPlayerAutoplayContexts").VideoAutoplayLocalScopeContext)}}),null);
__d("VideoPlayerDebugAutoplayAPI",["emptyFunction","requireCond","cr:1453865"],(function(a,b,c,d,e,f){"use strict";c=(a=b("cr:1453865"))!=null?a:{useVideoPlayerDebugAPI:b("emptyFunction").thatReturns(null),useVideoPlayerDebugAPIDefinition:b("emptyFunction"),useVideoPlayerDebugInfo:b("emptyFunction").thatReturns(null)};e.exports=c}),null);
__d("evaluateVideoAutoplayDefaultAllowRule",[],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(){return"ALLOW"}a.displayName="evaluateVideoAutoplayDefaultRule"}),null);
__d("evaluateVideoAutoplayDefaultIgnoreRule",[],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(){return"IGNORE"}a.displayName="evaluateVideoAutoplayDefaultIgnoreRule"}),null);
__d("makeSelectedAutoplayVideoSymbol",[],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a,b){b=b+"::"+a;return b}}),null);
__d("AutoplayRulesEngine",[],(function(a,b,c,d,e,f){"use strict";var g=-2,h=-1;a=function(){function a(a){this.$1=g,this.$2=a}var b=a.prototype;b.evaluateAutoplay=function(a,b){b=b();var c=h;if(a)for(var d=0;d<this.$2.length;d++){var e=this.$2[d](a);if(e!=="SKIP"){b=e;c=d;break}}this.$1=c;return b};b.getIndexOfLastWinningRule=function(){return this.$1};b.getRules=function(){return this.$2};return a}();e.exports=a}),null);
__d("useAutoplayRulesEngine",["AutoplayRulesEngine","React"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var c=g.useRef(a),d=g.useState(function(){return new(b("AutoplayRulesEngine"))(a)}),e=d[0],f=d[1];g.useEffect(function(){c.current!==a&&f(function(){return new(b("AutoplayRulesEngine"))(a)})},[a]);g.useEffect(function(){c.current=e.getRules()},[e]);return e}}),null);
__d("useConcurrentAutoplayManagementAPI",["React","removeFromArray","useCometUniqueID"],(function(a,b,c,d,e,f){"use strict";f.useAutoplayControlID=a;f.createConcurrentAutoplayManagementAPI=h;f.useConcurrentAutoplayManagementAPI=c;var g=b("React");function a(){var a=b("useCometUniqueID")();return a}function h(){var a=[];return{isControllingComponent:function(b){var c=a.length;return a[c-1]===b},registerControllingComponent:function(c){b("removeFromArray")(a,c),a.push(c)},unregisterControllingComponent:function(c){var d=a.length;d>1&&b("removeFromArray")(a,c);return d>1}}}function c(){var a=g.useState(function(){return h()});a=a[0];return a}}),null);
__d("oz-player/configs/OzGlobalConfig",[],(function(a,b,c,d,e,f){"use strict";var g=null;a=function(a,b){return g?g.getBool(a,b):b};f.getBool=a;b=function(a,b){return g?g.getNumber(a,b):b};f.getNumber=b;c=function(a,b){return g?g.getString(a,b):b};f.getString=c;d=function(a){g=a};f.setGlobalConfig=d}),null);
__d("oz-player/shims/www/OzCacheStorageWWW",["CacheStorage","gkx"],(function(a,b,c,d,e,f){a="localstorage";c=b("gkx")("1621546")?"_oz_":"_video_";var g=new(b("CacheStorage"))(a,c);d={get:function(a){return g.get(a)},set:function(a,b){g.set(a,b)}};f=d;e.exports=f}),null);
__d("oz-player/shims/OzCacheStorage",["oz-player/shims/www/OzCacheStorageWWW"],(function(a,b,c,d,e,f){a=b("oz-player/shims/www/OzCacheStorageWWW");e.exports=a}),null);
__d("oz-player/shims/www/OzWindowEventsWWW",["Run"],(function(a,b,c,d,e,f){"use strict";a={onUnload:function(a){b("Run").onUnload(a)}};c=a;e.exports=c}),null);
__d("oz-player/shims/OzWindowEvents",["oz-player/shims/www/OzWindowEventsWWW"],(function(a,b,c,d,e,f){"use strict";a=b("oz-player/shims/www/OzWindowEventsWWW");e.exports=a}),null);
__d("oz-player/networks/OzBandwidthCache",["oz-player/shims/OzCacheStorage","oz-player/shims/OzWindowEvents"],(function(a,b,c,d,e,f){a=function(){function a(a,c){var d=this;this.$1=a;this.$2=c;b("oz-player/shims/OzWindowEvents").onUnload(function(){d.updateCachedBandwidth()})}var c=a.prototype;c.getCachedBandwidth=function(){var a=b("oz-player/shims/OzCacheStorage").get(this.$1);if(a==null)return null;a=Number(a);return isNaN(a)?null:a};c.updateCachedBandwidth=function(){b("oz-player/shims/OzCacheStorage").set(this.$1,String(this.$2()))};return a}();e.exports=a}),null);
__d("oz-player/networks/OzBandwidthUtils",[],(function(a,b,c,d,e,f){"use strict";f.getMeanBandwidth=g;f.getStandardDeviationOfBandwidth=h;f.getExponentiallyWeightedMovingAverage=i;f.getExponentiallyWeightedMovingAverageOfBandwidth=j;f.getBandwidthSamplesWithinRangeOfMean=k;f.getBandwidthEstimate=a;function g(a){var b=0;for(var c=0;c<a.length;c++)b+=a[c].bytes*8e3/a[c].timeInMs;return b/a.length}function h(a){var b=g(a),c=0;for(var d=0;d<a.length;d++)c+=Math.pow(a[d].bytes*8e3/a[d].timeInMs-b,2);return Math.round(Math.sqrt(c/a.length))}function i(a,b){b=Math.exp(Math.log(.5)/b);var c=0,d=0;for(var e=0;e<a.length;e++){var f=Math.pow(b,a[e].weight);c=a[e].value*(1-f)+c*f;d+=a[e].weight}return Math.round(c/(1-Math.pow(b,d)))}function j(a,b){return i(a.map(function(a){return{value:a.bytes*8e3/a.timeInMs,weight:a.timeInMs/1e3}}),b)}function k(a,b){var c=g(a),d=[];for(var e=0;e<a.length;e++)Math.abs(c-a[e].bytes*8e3/a[e].timeInMs)<b&&d.push(a[e]);return d}function a(a,b,c,d){var e=h(a);a=k(a,e*c);c=j(a,b);return c-e*d}}),null);
__d("oz-player/shims/OzEventEmitter",["requireCond","cr:1615798"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=new(b("cr:1615798"))()}var c=a.prototype;c.addListener=function(a,b){return this.$1.addListener(a,b)};c.emit=function(a){var b;for(var c=arguments.length,d=new Array(c>1?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];(b=this.$1).emit.apply(b,[a].concat(d))};c.removeAllListeners=function(a){this.$1.removeAllListeners(a)};return a}();e.exports=a}),null);
__d("oz-player/shims/OzReadableStream",["requireCond","cr:1621176"],(function(a,b,c,d,e,f){"use strict";a=b("cr:1621176");e.exports=a}),null);
__d("oz-player/shims/OzWritableStream",["requireCond","cr:1621177"],(function(a,b,c,d,e,f){"use strict";a=b("cr:1621177");e.exports=a}),null);
__d("oz-player/utils/OzError",[],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;c=a.call(this,b.description)||this;c.$OzError1=b;c.name=b.type;return c}var c=b.prototype;c.getExtra=function(){return this.$OzError1.extra||{}};c.getType=function(){return this.$OzError1.type};c.getDescription=function(){return this.$OzError1.description};return b}(babelHelpers.wrapNativeSuper(Error));e.exports=a}),null);
__d("oz-player/networks/OzTransformStream",["oz-player/shims/OzEventEmitter","oz-player/shims/OzReadableStream","oz-player/shims/OzWritableStream","oz-player/utils/OzError"],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(c,a);function c(c){var d;d=a.call(this)||this;d.$OzTransformStream3=function(a){return a};c=c||{};c=c.errorTransform;(c===void 0||c===null)&&(c=d.$OzTransformStream3);var e=c||d.$OzTransformStream3;d.writable=new(b("oz-player/shims/OzWritableStream"))({start:function(a){d.$OzTransformStream2=a},write:function(a){d.emit("writableWrite",a);try{d.onDataWritten(a)}catch(a){d.$OzTransformStream1.error(new(b("oz-player/utils/OzError"))({type:"OZ_STREAM",description:"Error from write handler: "+d.constructor.name,extra:{code:"OZ_S-0",originalError:a}}))}d.$OzTransformStream1.enqueue(a)},close:function(){d.emit("writableClose");try{d.onClose()}catch(a){d.$OzTransformStream1.error(new(b("oz-player/utils/OzError"))({type:"OZ_STREAM",description:"Error from close handler: "+d.constructor.name,extra:{code:"OZ_S-1",originalError:a}}))}d.$OzTransformStream1.close()},abort:function(a){a=e(a);d.$OzTransformStream1.error(a)}});d.readable=new(b("oz-player/shims/OzReadableStream"))({start:function(a){d.$OzTransformStream1=a},cancel:function(a){d.emit("readableCancel",a),d.$OzTransformStream2.error(a)}});return d}var d=c.prototype;d.onDataWritten=function(a){};d.onClose=function(){};return c}(b("oz-player/shims/OzEventEmitter"));e.exports=a}),null);
__d("oz-player/shims/OzNetworkDiagnostics",["requireCond","cr:1615799"],(function(a,b,c,d,e,f){"use strict";a=b("cr:1615799");e.exports=a}),null);
__d("oz-player/utils/OzResourceTimingUtils",[],(function(a,b,c,d,e,f){"use strict";a=function(a){if(!performance.getEntriesByName)return null;a=performance.getEntriesByName(a,"resource");return a.reduce(function(a,b){if(a==null)return b;return typeof b.responseEnd==="number"&&typeof b.responseStart==="number"&&typeof b.startTime==="number"&&typeof a.responseEnd==="number"&&typeof a.responseStart==="number"&&typeof a.requestStart==="number"&&typeof a.startTime==="number"?b.responseEnd<a.responseEnd?a:b:null},null)};f.getLatestResourceTimingEntry=a}),null);
__d("oz-player/networks/OzNetworkRequestStreamBandwidthReporter",["oz-player/shims/OzNetworkDiagnostics","oz-player/utils/OzResourceTimingUtils","oz-player/networks/OzTransformStream"],(function(a,b,c,d,e,f){"use strict";var g=b("oz-player/shims/OzNetworkDiagnostics").getResponseTimeMs;a=function(){function a(a){this.$10=Date.now();this.$11=0;this.$12=0;this.$13=function(){};this.$14=function(){};this.$15=new(b("oz-player/networks/OzTransformStream"))();var c=a.stream,d=a.loggerProvider,e=a.byteCountPerSample,f=a.minimumBytesToSampleOnClose,g=a.minimumSampleDuration,h=a.maximumSampleBandwidth,i=a.usePerformanceEntryOnClose,j=a.useResponseTimeMs,k=a.responseTimeHandicapMs,l=a.ignoreTimeToResponseStart;a=a.ignoreOnStreamWriteSamples;this.$1=c;this.$16=d;this.$2=e;this.$3=f;this.$4=g;this.$5=h;this.$6=i;this.$7=j;this.$8=k;this.$9=l;this.$17=a;this.$15.addListener("writableWrite",this.$18.bind(this));this.$15.addListener("writableClose",this.$19.bind(this))}var c=a.prototype;c.getTransformStream=function(){return this.$15};c.onBandwidthSample=function(a){this.$13=a};c.onTimeToFirstByteMsSample=function(a){this.$14=a};c.$20=function(a,b,c){b=b-c;if(this.$16){c=Date.now();this.$16&&this.$16.getOperationLogger("bandwidth_sampled").setLength(a).setClientTimeEnd(c).setClientTimeBegin(c-b).log()}this.$13(a,b)};c.$18=function(a){a.length!=void 0&&(this.$12+=a.length);if(this.$17)return;this.$21()};c.$19=function(){var a=Date.now()-this.$10,c=this.$1.getLastRequestUrl();c=c!=null?b("oz-player/utils/OzResourceTimingUtils").getLatestResourceTimingEntry(c):null;c&&this.$14(c.responseStart-c.requestStart);if(this.$3>0&&a>0&&this.$11===0&&this.$12>=this.$3){if(this.$6&&c&&c.responseEnd&&c.startTime){c=this.$9?c.responseEnd-c.responseStart:c.responseEnd-c.startTime;a=c>0?c:a}c=this.$1.getLastResponse();c=this.$7?g(c==null?void 0:c.headers)||0:0;this.$22(a,c)||this.$20(this.$12,a,Math.max(c-this.$8,0))}};c.$22=function(a,b){if(a-b<=0)return!0;b=this.$12*8/(a/1e3);return a<this.$4&&b>this.$5};c.$21=function(){var a=Date.now(),b=a-this.$10;this.$2>0&&this.$12>=this.$11+this.$2&&!this.$22(b,0)&&(this.$20(this.$12-this.$11,b,0),this.$10=a,this.$11=this.$12)};return a}();e.exports=a}),null);
__d("oz-player/shims/www/OzDeferredWWW",["Deferred"],(function(a,b,c,d,e,f){"use strict";a=b("Deferred");e.exports=a}),null);
__d("oz-player/shims/OzDeferred",["oz-player/shims/www/OzDeferredWWW"],(function(a,b,c,d,e,f){"use strict";a=b("oz-player/shims/www/OzDeferredWWW");e.exports=a}),null);
__d("oz-player/shims/www/OzMaybeNativePromiseWWW",["MaybeNativePromise"],(function(a,b,c,d,e,f){"use strict";a=b("MaybeNativePromise");e.exports=a}),null);
__d("oz-player/shims/OzMaybeNativePromise",["oz-player/shims/www/OzMaybeNativePromiseWWW"],(function(a,b,c,d,e,f){"use strict";a=b("oz-player/shims/www/OzMaybeNativePromiseWWW");e.exports=a}),null);
__d("oz-player/scheduling/OzRoundRobinPriorityTaskQueue",["oz-player/shims/OzDeferred","oz-player/shims/OzMaybeNativePromise"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b){b===void 0&&(b=-1),this.$3=function(){},this.$4=[],this.$5=new Map(),this.$6=new Map(),this.$1=a,this.$2=b}var c=a.prototype;c.getHighestPriority=function(){return Math.max.apply(Math,this.$4.map(function(a){return a.queue.length?a.priority:-Infinity}))};c.enqueue=function(a,b){b=this.$7(b);var c=this.$5.get(a),d=this.$8(a);if(c===b)return d;this.$5.has(a)&&this.remove(a);c=this.$9(b);var e=this.$4[c];e&&e.priority===b||(e={priority:b,queue:[]},this.$4.splice(c,0,e));this.$5.set(a,b);e.queue.push(a);this.$3(a,b>=this.$1?"immediate":"normal");return d};c.updatePriority=function(a,b){if(!this.$5.has(a))return;this.enqueue(a,b)};c.dequeue=function(){for(var a=0;a<this.$4.length;a++){var b=this.$4[a];if(b.queue.length){b=b.queue.shift();this.$6["delete"](b);this.$5["delete"](b);return b}}return null};c.remove=function(a){this.$6["delete"](a);var b=this.$5.get(a);if(b!==void 0){b=this.$9(b);b=this.$4[b];if(b&&b.queue){var c=b.queue.findIndex(function(b){return b===a});c>-1&&b.queue.splice(c,1)}this.$5["delete"](a)}};c.setOnTaskUpdated=function(a){this.$3=a};c.clearOnTaskUpdated=function(){this.setOnTaskUpdated(function(){})};c.getLength=function(){return this.$5.size};c.test_isEmpty=function(){return this.$5.size===0&&this.$6.size===0&&this.$4.every(function(a){return a.queue.length===0})};c.$8=function(a){var c=this,d=this.$6.get(a);if(!d){var e=new(b("oz-player/shims/OzDeferred"))(b("oz-player/shims/OzMaybeNativePromise"));d=e.getPromise();this.$6.set(a,d);var f=a.run;a.run=function(){return f.call(a).then(function(b){c.remove(a);e.resolve(b);return b})["catch"](function(b){c.remove(a);e.reject(b);throw b})}}return d};c.$9=function(a){a=this.$7(a);var b;for(b=0;b<this.$4.length;b++)if(a>=this.$4[b].priority)return b;return b};c.$7=function(a){this.$2>=0&&(a=Number.parseFloat(a.toFixed(this.$2)));return a};return a}();e.exports=a}),null);
__d("oz-player/shims/ozSetTimeoutAcrossTransitions",["requireCond","cr:1615804"],(function(a,b,c,d,e,f){"use strict";a=b("cr:1615804");e.exports=a}),null);
__d("oz-player/scheduling/OzSequentialTaskScheduler",["oz-player/shims/OzMaybeNativePromise","oz-player/shims/ozSetTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b){this.$3=0;this.$1=a;a=b||{};b=a.taskTimeout;this.$4=b||0}var c=a.prototype;c.start=function(){this.$1.setOnTaskUpdated(this.$5.bind(this));var a=this.$1.dequeue();a&&this.$6(a,"immediate")};c.destroy=function(){this.$2&&this.$2.cancel(),this.$1.clearOnTaskUpdated()};c.$5=function(a,b){b=this.$6(a,b);b&&this.$1.remove(a)};c.$6=function(a,c){var d=this;if(this.$2&&c!=="immediate")return!1;this.$2&&this.$2.cancel();c=a.run()["catch"](function(a){});this.$4>0&&(c=b("oz-player/shims/OzMaybeNativePromise").race([c,new(b("oz-player/shims/OzMaybeNativePromise"))(function(a,c){b("oz-player/shims/ozSetTimeoutAcrossTransitions")(a,d.$4)})]));this.$3++;this.$2=a;c=c.then(function(){d.$3--;d.$2===a&&(d.$2=null);if(d.$3===0){var b=d.$1.dequeue();b&&d.$6(b,"immediate")}});return!0};return a}();e.exports=a}),null);
__d("oz-player/networks/OzStreamingTaskQueueProvider",["oz-player/scheduling/OzRoundRobinPriorityTaskQueue","oz-player/scheduling/OzSequentialTaskScheduler"],(function(a,b,c,d,e,f){"use strict";f.getQueue=a;var g=new Map(),h=new Map(),i=2;f.OZ_QUEUE_MAX_PRIORITY=i;var j=2,k=6e4;function a(a){var c=g.get(a);if(!c){c=new(b("oz-player/scheduling/OzRoundRobinPriorityTaskQueue"))(i,j);var d=new(b("oz-player/scheduling/OzSequentialTaskScheduler"))(c,{taskTimeout:k});g.set(a,c);h.set(a,d);d.start()}return c}}),null);
__d("oz-player/networks/OzBandwidthEstimator",["oz-player/configs/OzGlobalConfig","oz-player/networks/OzStreamingTaskQueueProvider","oz-player/shims/OzEventEmitter","oz-player/networks/OzBandwidthCache","oz-player/networks/OzBandwidthUtils","oz-player/networks/OzNetworkRequestStreamBandwidthReporter"],(function(a,b,c,d,e,f){"use strict";var g=(a=b("oz-player/networks/OzBandwidthUtils")).getBandwidthEstimate,h=a.getExponentiallyWeightedMovingAverage,i=a.getExponentiallyWeightedMovingAverageOfBandwidth,j=a.getStandardDeviationOfBandwidth,k=.9,l=5e5,m=2e4;c=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c;c=a.call(this)||this;c.$OzBandwidthEstimator1=[];c.$OzBandwidthEstimator2=[];c.$OzBandwidthEstimator3=new(b("oz-player/networks/OzBandwidthCache"))(b("oz-player/configs/OzGlobalConfig").getString("bandwidth_cache_key","bandwidthEstimate"),function(){return c.getAdjustedBandwidth(b("oz-player/configs/OzGlobalConfig"))});return c}var d=c.prototype;d.getBandwidth=function(a){var b=g(this.$OzBandwidthEstimator1,a.getNumber("bandwidth_estimator_half_life",6),a.getNumber("bandwidth_estimator_outlier_exclusion_factor",2),a.getNumber("bandwidth_estimator_std_dev_penalty_factor",.1));return b>0?b:this.$OzBandwidthEstimator4(a)};d.getEstimatedTimeToFirstByteMs=function(a){return this.$OzBandwidthEstimator2.length>0?h(this.$OzBandwidthEstimator2.map(function(a){return{value:a,weight:1}}),a.getNumber("time_to_first_byte_estimate_half_life_ms",500)):null};d.$OzBandwidthEstimator4=function(a){var b=this.$OzBandwidthEstimator3.getCachedBandwidth();return typeof b==="number"&&b>0?b:a.getNumber("default_bandwidth_estimate",l)};d.getStandardDeviationOfBandwidth=function(){return j(this.$OzBandwidthEstimator1)};d.getSampleCount=function(){return this.$OzBandwidthEstimator1.length};d.getAdjustedBandwidth=function(a){if(this.$OzBandwidthEstimator1.length===0)return this.$OzBandwidthEstimator4(a);var b=a.getNumber("bandwidth_estimator_variance_penalty_half_life",0)>0?this.$OzBandwidthEstimator5(a):this.$OzBandwidthEstimator6(a);return this.$OzBandwidthEstimator7(a,b)};d.$OzBandwidthEstimator7=function(a,c){var d=Math.max(0,b("oz-player/networks/OzStreamingTaskQueueProvider").getQueue("video").getLength()-a.getNumber("bandwidth_penalty_additional_video_start",0));a=a.getNumber("bandwidth_penalty_per_additional_video",0);d=Math.min(k,d*a);return c*(1-d)};d.$OzBandwidthEstimator5=function(a){var b=i(this.$OzBandwidthEstimator1,a.getNumber("bandwidth_estimator_half_life",6)),c=i(this.$OzBandwidthEstimator1,a.getNumber("bandwidth_estimator_variance_penalty_half_life",0));a=c<b?a.getNumber("bandwidth_estimator_variance_penalty_down_factor",0):a.getNumber("bandwidth_estimator_variance_penalty_up_factor",0);c=Math.abs(b-c)*a;return b-c};d.$OzBandwidthEstimator6=function(a){return this.getBandwidth(a)};d.pipeThroughReporter=function(a,c,d){var e=this;return{startStream:function(f){var g=new(b("oz-player/networks/OzNetworkRequestStreamBandwidthReporter"))({stream:c,loggerProvider:d,byteCountPerSample:a.getNumber("byte_count_per_sample",m),minimumBytesToSampleOnClose:a.getNumber("minimum_bytes_to_sample_on_close",0),minimumSampleDuration:a.getNumber("minimum_bandwidth_sample_duration",0),maximumSampleBandwidth:a.getNumber("maximum_bandwidth_sample_bandwidth",999999999),usePerformanceEntryOnClose:a.getBool("use_performance_entry_on_stream_close",!1),useResponseTimeMs:a.getBool("bandwidth_use_response_time_adjustment",!1),responseTimeHandicapMs:a.getNumber("bandwidth_response_time_handicap",0),ignoreTimeToResponseStart:a.getBool("ignore_time_to_response_start",!1),ignoreOnStreamWriteSamples:a.getBool("bandwidth_ignore_on_stream_write_samples",!1)});g.onBandwidthSample(function(b,c){e.$OzBandwidthEstimator8(b,c),a.getBool("update_bandwidth_cache_on_sample",!1)&&e.$OzBandwidthEstimator3.updateCachedBandwidth()});g.onTimeToFirstByteMsSample(e.$OzBandwidthEstimator9.bind(e));return c.startStream(f).then(function(b){return c.retrievedFromCache()&&a.getBool("exclude_prefetch_bandwidth_samples",!1)?b:b.pipeThrough(g.getTransformStream())})}}};d.$OzBandwidthEstimator8=function(a,c){this.$OzBandwidthEstimator1.push({bytes:a,timeInMs:c}),this.$OzBandwidthEstimator1.length>b("oz-player/configs/OzGlobalConfig").getNumber("max_bandwidth_sample_count",15)&&this.$OzBandwidthEstimator1.shift(),this.emit("bandwidth_sampled")};d.$OzBandwidthEstimator9=function(a){this.$OzBandwidthEstimator2.push(a),this.$OzBandwidthEstimator2.length>b("oz-player/configs/OzGlobalConfig").getNumber("max_bandwidth_sample_count",15)&&this.$OzBandwidthEstimator2.splice(0,1)};return c}(b("oz-player/shims/OzEventEmitter"));e.exports=new c()}),null);
__d("useVideoPlayerBandwidthEstimate",["React","VideoPlayerOzWWWGlobalConfig","oz-player/networks/OzBandwidthEstimator","useInterval"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React"),h=5e3;function a(){var a=function(){return b("oz-player/networks/OzBandwidthEstimator").getBandwidth(b("VideoPlayerOzWWWGlobalConfig"))},c=g.useState(a()),d=c[0],e=c[1];b("useInterval")(function(){return e(a())},h);return d}}),null);
__d("useVideoAutoplayState",["HiddenSubtreePassiveContext","React","VideoPlayerHooks","VideoPlayerViewabilityHooks","gkx","useIsBackgrounded","useVideoPlayerBandwidthEstimate"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(){var a=g.useTransition(),c=a[0],d=(a=b("VideoPlayerHooks")).useAdClientToken(),e=a.useAutoplayGatingResult(),f=a.useBroadcastStatus(),h=a.useEnded(),i=a.useIsFrozenPassive(),j=a.useLastPauseReason(),k=a.useLastPlayReason(),l=a.useMuted(),m=a.usePaused(),n=g.useContext(b("HiddenSubtreePassiveContext"));a=!d;var o=b("useIsBackgrounded")({scrollTerminatesBackgrounded:a}),p=b("useVideoPlayerBandwidthEstimate")(),q=b("VideoPlayerViewabilityHooks").useVideoPlayerPassiveViewabilityInfo(),r=b("VideoPlayerViewabilityHooks").useVideoPlayerExtendedPassiveViewabilityInfo();a=g.useState(n.getCurrentState().backgrounded);var s=a[0],t=a[1];a=g.useState(n.getCurrentState().hidden);var u=a[0],v=a[1];g.useEffect(function(){function a(a,b){v(a),t(b)}var d=n.subscribeToChanges(function(d){b("gkx")("1500552")?c(function(){var b=n.getCurrentState();a(b.hidden,b.backgrounded)}):a(d.hidden,d.backgrounded)}),e=n.getCurrentState().hidden,f=n.getCurrentState().backgrounded;b("gkx")("1500552")?c(function(){var b=n.getCurrentState();a(b.hidden,b.backgrounded)}):a(e,f);return function(){d.remove()}},[n,t,v]);a=g.useState(function(){return i.getCurrentState()});var w=a[0],x=a[1];g.useEffect(function(){var a=i.subscribeToChanges(function(a){x(a)}),b=i.getCurrentState();x(b);return function(){a.remove()}},[i,x]);var y=g.useMemo(function(){return{adClientToken:d,autoplayGatingResult:e,bandwidthEstimate:p,broadcastStatus:f,controllerIsFrozen:w,currentSubtreeIsBackgrounded:s,currentSubtreeIsHidden:u,ended:h,hiddenSubtreePassive:n,isBackgrounded:o,isFrozenPassive:i,lastPauseReason:j,lastPlayReason:k,muted:l,paused:m,videoPlayerExtendedPassiveViewabilityInfo:r,videoPlayerPassiveViewabilityInfo:q}},[d,e,p,f,w,s,u,h,n,o,i,j,k,l,m,r,q]);a=g.useState(y);var z=a[0],A=a[1],B=g.useRef(z);g.useEffect(function(){B.current=z},[z]);g.useEffect(function(){var a=!1;for(var b in y)if(Object.prototype.hasOwnProperty.call(y,b)&&y[b]!==B.current[b]){a=!0;break}a&&A(y)},[y,A]);return z}}),null);
__d("CoreVideoPlayerAutoplayClient.react",["CoreVideoPlayerAutoplayClientUtils","HiddenSubtreePassiveContext","React","VideoPlayerAutoplayHooks","VideoPlayerDebugAutoplayAPI","VideoPlayerHooks","VideoPlayerViewabilityConstants","WwwCometVideoAutoplayFalcoEvent","evaluateVideoAutoplayDefaultAllowRule","evaluateVideoAutoplayDefaultIgnoreRule","makeSelectedAutoplayVideoSymbol","qex","useAutoplayRulesEngine","useCometUniqueID","useConcurrentAutoplayManagementAPI","useVideoAutoplayState"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(){var a,c=b("useCometUniqueID")(),d=(a=b("VideoPlayerHooks")).useCanAutoplay(),e=a.useInstanceKey(),f=g.useMemo(function(){return b("makeSelectedAutoplayVideoSymbol")(c,e)},[c,e]),h=g.useRef(f);g.useEffect(function(){h.current=f},[f]);var i=g.useContext(b("HiddenSubtreePassiveContext")),j=a.useController(),k=g.useRef(!1),l=b("useConcurrentAutoplayManagementAPI").useAutoplayControlID();g.useEffect(function(){b("CoreVideoPlayerAutoplayClientUtils").log(h.current,"[ASSUME CONTROL] "+l),j.registerControllingComponent(l)},[j,l]);var m=a.useVideoPlayerPassiveViewabilityInfo();a=j.getCurrentState();a=a.paused;var n=g.useRef(a),o=b("VideoPlayerAutoplayHooks").useVideoAutoplayLocalScope(),p=g.useRef(o);g.useEffect(function(){p.current=o},[o]);var q=g.useCallback(function(){if(b("qex")._("1696068")){var a=j.getCurrentState(),c=a.lastPlayReason;a=a.paused;var d=n.current;n.current=a;var e=m==null?void 0:m.getCurrent();if(e){e=e.visiblePercentage;a=!a&&a!==d;d=e<b("VideoPlayerViewabilityConstants").DEFAULT_VIEWABILITY_PERCENTAGE_FOR_PAUSE&&e>0;p.current.disableScrollBeforePlayWhenOffscreen!==!0&&a&&c==="user_initiated"&&d&&(k.current=!0)}}},[j,m]),r=g.useRef(q);g.useEffect(function(){r.current=q},[q]);g.useEffect(function(){var a=j.subscribe(function(){q()});return function(){a.remove()}},[j,q]);var s=b("useVideoAutoplayState")(),t=b("useAutoplayRulesEngine")(o.autoplayLocalRules),u=d==="allow"?b("evaluateVideoAutoplayDefaultAllowRule"):b("evaluateVideoAutoplayDefaultIgnoreRule");a=g.useState(function(){return u});var v=a[0],w=a[1];a=g.useState(null);var x=a[0],y=a[1];a=g.useState(function(){return t.evaluateAutoplay(s,u)});var z=a[0],A=a[1];a=g.useState(null);var B=a[0],C=a[1],D=g.useRef(z),E=b("VideoPlayerAutoplayHooks").useAutoplayApi(),F=g.useRef(E);g.useEffect(function(){F.current=E},[E]);var G=d!=="dangerously_disable_autoplay_management";g.useEffect(function(){E.register(f,e,o,j,i,G);b("WwwCometVideoAutoplayFalcoEvent").log(function(){return{autoplay_event_name:"register",autoplay_scope_id:p.current.autoplayScopeID,event_creation_time:Date.now(),initiator:h.current,initiator_type:"autoplay_component",selected_autoplay_video_symbol:E.getAutoplayManagerDebugInfo(p.current).selectedAutoplayVideoSymbol,target:h.current,target_current_autoplay_decision:D.current}});return function(){E.unregister(f),b("WwwCometVideoAutoplayFalcoEvent").log(function(){return{autoplay_event_name:"unregister",autoplay_scope_id:p.current.autoplayScopeID,event_creation_time:Date.now(),initiator:h.current,initiator_type:"autoplay_component",selected_autoplay_video_symbol:E.getAutoplayManagerDebugInfo(p.current).selectedAutoplayVideoSymbol,target:h.current,target_current_autoplay_decision:D.current}})}},[E,o,j,i,e,G,f]);g.useEffect(function(){var a=function(){var c=t.evaluateAutoplay(s,u);D.current=c;var d=t.getRules(),e=t.getIndexOfLastWinningRule(),a=e>=0?d[e]:u;d=m&&m.getCurrent();e=j.getCurrentState();e=e.paused;(B===null||B!==c)&&(A(c),C(c));if(c==="PAUSE"&&!e&&j.isControllingComponent(l)){e=!0;r.current();if(k.current){k.current=!1;var g=d==null?void 0:d.positionToViewport;g&&j.scrollIntoView(g.top<0);e=!1}if(e){g="[PAUSE] via short-circuit on "+a.name+".";b("CoreVideoPlayerAutoplayClientUtils").log(h.current,g);j.pause("autoplay_initiated");b("WwwCometVideoAutoplayFalcoEvent").log(function(){return{autoplay_event_name:"pause",autoplay_scope_id:p.current.autoplayScopeID,event_creation_time:Date.now(),initiator:h.current,initiator_type:"autoplay_component",selected_autoplay_video_symbol:E.getAutoplayManagerDebugInfo(p.current).selectedAutoplayVideoSymbol,target:h.current,target_current_autoplay_decision:c}})}}(x===null||x!==a)&&(w(function(){return a}),y(function(){return a}),b("WwwCometVideoAutoplayFalcoEvent").log(function(){return{autoplay_event_name:"rule_changed",autoplay_scope_id:p.current.autoplayScopeID,event_creation_time:Date.now(),initiator:h.current,initiator_type:"autoplay_component",selected_autoplay_video_symbol:E.getAutoplayManagerDebugInfo(p.current).selectedAutoplayVideoSymbol,target:h.current,target_current_autoplay_decision:c}}));b("CoreVideoPlayerAutoplayClientUtils").log(h.current,"[DECISION: "+c+"] from "+a.name);d&&E.update(f,c,d)},c=i.subscribeToChanges(function(a){i.getCurrentState().hidden||i.getCurrentState().backgrounded?j.isControllingComponent(l)||j.unregisterControllingComponent(l):j.registerControllingComponent(l)}),d=m?m.subscribe(function(){i.getCurrentState().hidden||i.getCurrentState().backgrounded?j.isControllingComponent(l)||j.unregisterControllingComponent(l):j.registerControllingComponent(l),a()}):null;a();return function(){c.remove(),d&&d.remove()}},[E,l,t,j,u,i,x,B,w,A,y,C,f,s,m]);g.useEffect(function(){var a=j.isControllingComponent(l),c=j.getCurrentState();c=c.paused;b("CoreVideoPlayerAutoplayClientUtils").componentShouldPause(z,D.current,c,a)&&(b("CoreVideoPlayerAutoplayClientUtils").log(h.current,"[PAUSE] the video for "+z),j.pause("autoplay_initiated"),b("WwwCometVideoAutoplayFalcoEvent").log(function(){return{autoplay_event_name:"pause",autoplay_scope_id:p.current.autoplayScopeID,event_creation_time:Date.now(),initiator:h.current,initiator_type:"autoplay_component",selected_autoplay_video_symbol:F.current.getAutoplayManagerDebugInfo(p.current).selectedAutoplayVideoSymbol,target:h.current,target_current_autoplay_decision:z}}))},[z,j,l]);g.useEffect(function(){return function(){b("CoreVideoPlayerAutoplayClientUtils").log(h.current,"[RELEASE CONTROL] "+l),j.unregisterControllingComponent(l)}},[j,l]);b("VideoPlayerDebugAutoplayAPI").useVideoPlayerDebugAPIDefinition({applicableRule:v,autoplayApiRef:F,autoplayDecision:z,autoplayLocalScope:o,symbol:f});return null}}),null);
__d("VideoPlayerCaptionsAreaDeferred.react",["React","deferredLoadComponent","requireDeferredForDisplay"],(function(a,b,c,d,e,f){"use strict";b("React");a=b("deferredLoadComponent")(b("requireDeferredForDisplay")("VideoPlayerCaptionsArea.react"));e.exports=a}),null);
__d("VideoPlayerWebSessionExtender.react",["React","VideoPlayerHooks","WebSessionExtender","useCometUniqueID"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(){var a=b("VideoPlayerHooks").usePlaying(),c=b("useCometUniqueID")();g.useEffect(function(){if(a){b("WebSessionExtender").subscribe(c,"video");return function(){b("WebSessionExtender").unsubscribe(c)}}},[a,c]);return null}}),null);
__d("useVideoPlayerDefaultLoadingIndicatorsLogic",["VideoPlayerHooks"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(){var a=b("VideoPlayerHooks").useStalling(),c=b("VideoPlayerHooks").useStreamInterrupted(),d=b("VideoPlayerHooks").useIsLiveRewindActive();c=c&&!d;d=a;a=c?"live_video_interrupted_overlay":d?"spinner":"none";return{liveVideoInterruptedOverlayVisible:c,loadingIndicatorType:a,spinnerVisible:d}}}),null);
__d("useVideoPlayerDefaultLoadingIndicators",["CometPlaceholder.react","React","deferredLoadComponent","requireDeferred","requireDeferredForDisplay","useVideoPlayerDefaultLoadingIndicatorsLogic"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React"),h=b("deferredLoadComponent")(b("requireDeferredForDisplay")("VideoPlayerSpinner.react")),i=b("deferredLoadComponent")(b("requireDeferred")("VideoPlayerWithLiveVideoInterruptedOverlay.react"));function a(){var a=b("useVideoPlayerDefaultLoadingIndicatorsLogic")(),c=a.loadingIndicatorType;a=a.spinnerVisible;var d=g.jsx(b("CometPlaceholder.react"),{fallback:null,children:g.jsx(i,{})});a=g.jsx(h,{isVisible:a});var e=null;switch(c){case"spinner":e=a;break;case"live_video_interrupted_overlay":e=d;break;case"none":default:e=a}return{loadingIndicatorElement:e,loadingIndicatorType:c}}}),null);
__d("UnifiedVideoCVCSubscription",["CVCv3DisabledPlayerOrigins","CVCv3DisabledPlayerSubOrigins","CVCv3SubscriptionHelper","DateConsts","XVideoUnifiedCVCControllerRouteBuilder","clearTimeout","cometAsyncFetch","gkx","promiseDone","setTimeout"],(function(a,b,c,d,e,f){"use strict";var g=Object.values(b("CVCv3DisabledPlayerOrigins")),h=Object.values(b("CVCv3DisabledPlayerSubOrigins")),i=10;a=function(){function a(a,c,d,e,f,i,j){var k=this;this.$1=new(b("CVCv3SubscriptionHelper"))(a,c,d);this.$5=f;this.$6=null;this.$7=j;this.$10=null;this.$11=!this.$1.isValidSubscription();this.$3=null;this.$2=null;a=c!=null?g.includes(c):!1;f=d!=null?h.includes(d):!1;!a&&!f&&(this.$3=e,this.$12=i,this.$4=e.subscribe(function(){if(k.$3==null)return;var a=k.$3.getCurrentState();a.playing?k.$13(a):k.$14()}))}var c=a.prototype;c.$13=function(a){if(this.$3==null)return;var c=!1;this.$7!=null&&(c=!0);c||(c=this.$5?!0:b("gkx")("1124976"));if(!c)return;if(a.playing){if(this.$2==null){c=this.$3.getPlayheadPosition();c>=0&&(this.$2=c)}}else this.$2=null;this.$15(0)};c.stopUnifiedCVC=function(){this.$14()};c.destroy=function(){this.$14(),this.$4!=null&&this.$4.remove(),this.$4=null,this.$3=null};c.$14=function(){b("clearTimeout")(this.$9),b("clearTimeout")(this.$8),this.$9=null,this.$8=null,this.$2=null,this.$1.clearAnyPreviousContext(),this.$10=null};c.$16=function(){b("clearTimeout")(this.$8),this.$8=null};c.$17=function(){this.$10=null,this.$16(),this.$15(0)};c.$15=function(a){var c=this;if(this.$3==null||this.$9!=null||this.$10!=null||this.$11)return;this.$9=b("setTimeout")(function(){c.$9=null;var a=c.$18();if(a==null)return;c.$10=a;var d=Date.now(),e=!1;b("promiseDone")(a,function(b){if(a!==c.$10)return;c.$10=null;if(b!=null){b=c.$1.processUnifiedResponse(b);c.$19(b,d)}else c.$1.logHttpResponseBad("null payload",Date.now()-d)},function(a){e=!0,c.$1.logHttpRequestFailure(a!=null?a.toString():null,Date.now()-d)});c.$8=b("setTimeout")(function(){e||c.$1.logHttpRequestTimeout(Date.now()-d),c.$17()},i*b("DateConsts").MS_PER_SEC)},a)};c.$19=function(a,c){this.$16();c=Date.now()-c;a.d!=null?(this.$1.logHttpRequestSuccess(c),this.$12!=null&&this.$12(a.d)):this.$1.logHttpResponseBad("no data field",c);if(a.a!=null){c=a.a.t;switch(c){case"p":c=a.a.pi;c==null&&(c=i);this.$15(c*b("DateConsts").MS_PER_SEC);break;case"s":this.$11=!0;break}}};c.$18=function(){var a=this.$20();if(a==null)return null;a={d:JSON.stringify(a)};return b("cometAsyncFetch")(b("XVideoUnifiedCVCControllerRouteBuilder").buildURL({}),{data:a,method:"POST"})};c.$20=function(){if(this.$3==null)return null;var a={};this.$7!=null&&(a.lr=this.$7);this.$6!=null&&(a.lc=this.$6);this.$5&&(a.ls=!0);var b=0,c=0;this.$2!=null&&(b=this.$2,c=this.$3.getPlayheadPosition());var d=this.$3.getCurrentState();b=this.$1.makeUnifiedVideoCVCUpdate(b,c,this.$21(d),d.muted,a);return b};c.$21=function(a){if(a.playing||a.seeking)return"playing";else if(a.ended)return"ended";else if(a.paused)return"paused";else return"unknown"};c.testing_setLastStartPosition=function(a){this.$2=a};c.testing_makeUnifiedStateUpdate=function(){return this.$20()};c.testing_handleUnifiedResponse=function(a){return this.$19(a,Date.now())};return a}();e.exports=a}),null);
__d("getPlayerFormatForLogData",[],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a,b){return a===!0?"full_screen":b!=null?b:"inline"}}),null);
__d("useVideoPlayerUnifiedCVCProvider",["UnifiedVideoCVCSubscription","VideoPlayerHooks","createVideoStateHook","getPlayerFormatForLogData","useLayoutEffect_SAFE_FOR_SSR"],(function(a,b,c,d,e,f){"use strict";f.useVideoPlayerUnifiedCVCProvider=a;c=b("createVideoStateHook").createVideoStateHook(null);var g=c.setterHook;d=b("createVideoStateHook").createVideoStateHook(null);var h=d.setterHook;e=d.valueHook;function a(a){var c=a.livingRoomID,d=a.playerFormat,e=a.subOrigin,f=a.videoFBID,i=b("VideoPlayerHooks").useIsLive(),j=b("VideoPlayerHooks").useIsFullscreen(),k=b("VideoPlayerHooks").useController(),l=g(),m=h();b("useLayoutEffect_SAFE_FOR_SSR")(function(){var a=new(b("UnifiedVideoCVCSubscription"))(f,b("getPlayerFormatForLogData")(j,d),e,k,i,function(a){m(a)},c);l(a);return function(){a.destroy()}},[c,j,i,d,m,l,e,k,f])}a=e;f.useVideoPlayerUnifiedCVCData=a}),null);
__d("VideoPlayerXImplSurface.react",["CoreVideoPlayerAutoplayClient.react","React","VideoPlayerCaptionsAreaDeferred.react","VideoPlayerInteractionOverlay.react","VideoPlayerWebSessionExtender.react","gkx","requireCond","useVideoPlayerDefaultLoadingIndicators","useVideoPlayerUnifiedCVCProvider","cr:1583596","cr:946298"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var c=a.children,d=a.disableLoadingIndicator;d=d===void 0?!1:d;var e=a.instreamVideoAdBreaksPlayer,f=a.livingRoomID,h=a.playerFormat,i=a.subOrigin,j=a.videoFBID;a=a.videoPlayerSpherical;b("useVideoPlayerUnifiedCVCProvider").useVideoPlayerUnifiedCVCProvider({livingRoomID:f,playerFormat:h,subOrigin:i,videoFBID:j});f=b("useVideoPlayerDefaultLoadingIndicators")();h=f.loadingIndicatorElement;return g.jsxs(g.Fragment,{children:[a,d?null:h,b("gkx")("1586633")?g.jsx(b("VideoPlayerInteractionOverlay.react").VideoPlayerInteractionOverlay,{}):null,g.jsx(b("VideoPlayerCaptionsAreaDeferred.react"),{children:c}),g.jsx(b("CoreVideoPlayerAutoplayClient.react"),{}),b("cr:1583596")?g.jsx(b("cr:1583596"),{}):null,b("cr:946298")?g.jsx(b("cr:946298"),{subOrigin:i}):null,e,g.jsx(b("VideoPlayerWebSessionExtender.react"),{})]})}}),null);
__d("normalizeVideoPlayerLoopCount",["unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a,c,d){c===void 0&&(c=null);d===void 0&&(d=null);if(a==null){d=((c=c)!=null?c:!1)?(c=d)!=null?c:0:0;d===-1?c=-1:d<0||!Number.isFinite(d)||Math.floor(d)!==d?c=0:c=d}else if(a===-1||a===Number.POSITIVE_INFINITY)c=-1;else if(a<0||!Number.isFinite(a)||Math.floor(a)!==a)throw b("unrecoverableViolation")("Invalid loopingCount: "+a,"comet_video_player");else c=a;return c}}),null);
__d("VideoPlayerXImpl.react",["CoreVideoPlayerWithComponents.react","React","VideoPlayerXImplSurface.react","gkx","normalizeVideoPlayerLoopCount","usePlayerOriginRouteTracePolicy","useRouteProductAttribution"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var c=a.children,d=a.disableLoadingIndicator,e=a.implementations,f=a.instreamVideoAdBreaksPlayer,h=a.portalingEnabled,i=a.portalingFromVideoID,j=a.portalingPlaceMetaData,k=a.portalingRenderPlaceholder,l=a.videoPlayerSpherical;a=babelHelpers.objectWithoutPropertiesLoose(a,["children","disableLoadingIndicator","implementations","instreamVideoAdBreaksPlayer","portalingEnabled","portalingFromVideoID","portalingPlaceMetaData","portalingRenderPlaceholder","videoPlayerSpherical"]);var m=b("usePlayerOriginRouteTracePolicy")(),n=b("useRouteProductAttribution")(),o=a.loopCount,p=a.playerFormat,q=a.subOrigin,r=a.videoFBID;o=b("normalizeVideoPlayerLoopCount")(o);return g.jsx(b("CoreVideoPlayerWithComponents.react"),babelHelpers["extends"]({},a,{implementations:e,loopCount:o,portalingEnabled:h,portalingFromVideoID:i,portalingPlaceMetaData:j,portalingRenderPlaceholder:k,productAttribution:b("gkx")("1759997")?n:null,routeTracePolicy:m,children:g.jsx(b("VideoPlayerXImplSurface.react"),{children:c,disableLoadingIndicator:d,instreamVideoAdBreaksPlayer:f,livingRoomID:a.livingRoomID,playerFormat:p,subOrigin:q,videoFBID:r,videoPlayerSpherical:l})}))}}),null);
__d("CometAudioManagerHooks",["CometAudioManagerContexts","React","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";f.useAudioApi=a;var g=b("React");function a(){var a=g.useContext(b("CometAudioManagerContexts").AudioApiContext);return a}}),null);
__d("makeAudioSymbol",[],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a,b){b=b+"::"+a;return b}}),null);
__d("CoreVideoPlayerAudioClient.react",["CometAudioManagerContexts","CometAudioManagerHooks","CometThrottle","React","VideoPlayerHooks","VideoPlayerPortalingPlaceInfoProvider.react","makeAudioSymbol","useCometUniqueID","usePrevious"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(){var a,c=b("useCometUniqueID")(),d=(a=b("VideoPlayerHooks")).useInstanceKey(),e=g.useMemo(function(){return b("makeAudioSymbol")(c,d)},[c,d]),f=b("CometAudioManagerHooks").useAudioApi(),h=g.useRef(f);g.useEffect(function(){h.current=f},[f]);var i=a.useController(),j=200,k=a.useLastPlayReason(),l=a.useLastMuteReason(),m=a.useMuted();j=b("CometThrottle")(a.useVolume,j,{trailing:!0});j=j();var n=b("usePrevious")(j),o=a.usePaused(),p=g.useContext(b("CometAudioManagerContexts").CometAudioLocalScopeContext),q=g.useContext(b("CometAudioManagerContexts").CometAudioGroupContext),r=b("VideoPlayerPortalingPlaceInfoProvider.react").useVideoPlayerPortalingPlaceInfo(),s=a.useVolumeSetting(),t=g.useMemo(function(){return(q==null?void 0:q.groupID)||b("CometAudioManagerContexts").makeAudioGroupID()},[q==null?void 0:q.groupID]);a=g.useState(!0);var u=a[0];a=a[1];var v={audioLocalScope:p,controller:i,groupID:t,instanceKey:d,lastMuteReason:l,lastPlayReason:k,muted:m,paused:o,previousVolume:n,symbol:e,videoPlayerPortalingPlaceInfo:r,volume:j};g.useEffect(function(){s!=null&&i.setVolume(s)},[i,s]);p=q||{allowSound:u,groupID:t,setAllowSound:a};var w=g.useRef(p);g.useEffect(function(){f&&f.register(v,w.current);return function(){f&&f.unregister(e,t)}},[f,v,t,e]);g.useEffect(function(){f&&f.update(v)},[f,v]);g.useEffect(function(){!u&&h.current&&i.setMuted(!0,"audio_manager_initiated")},[u,h,i]);return null}}),null);
__d("GraphQLVideoAutoplayGatingResult",[],(function(a,b,c,d,e,f){"use strict";f.makeGraphQLVideoAutoplayGatingResult=a;function a(a,b,c){a=a!=null?a:"unknown";b=b?b:null;a={autoplayGatingResult:a,autoplaySetting:b,canAutoplay:c!=null?c:!1};return a}}),null);
__d("getVideoPlayerAutoplayProps",["gkx"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a,c,d){c=c!=null?c:"respect_user_settings";var e=c==="dangerously_always_autoplay";d=d!=null?d:"unknown";var f=b("gkx")("1454109")?a.autoplaySetting||"default_autoplay":a.autoplaySetting,g=b("gkx")("1454109")?f==="off":!1;e=e||c==="respect_user_settings"&&!g&&a.canAutoplay;g=c==="do_not_autoplay"?d:a.autoplayGatingResult;d=e?"allow":c==="dangerously_disable_autoplay_management"?"dangerously_disable_autoplay_management":"deny";return{autoplayGatingResult:g,autoplaySetting:f,canAutoplay:d}}}),null);
__d("VideoPlayerCaptionsDisplay.react",["React","recoverableViolation","stylex"],(function(a,b,c,d,e,f){"use strict";var g,h=b("React"),i={captionsCenterAlign:{justifyContent:"taijpn5t",textAlign:"oqcyycmt"},captionsContainer:{bottom:"lhzng9rx",boxSizing:"rq0escxv",display:"j83agx80",justifyContent:"taijpn5t",paddingLeft:"k2nzzd71",paddingRight:"cnyvn6ex",position:"pmk7jnqg",textAlign:"oqcyycmt",transitionDuration:"pc15xi3s",transitionProperty:"flx89l3n",transitionTimingFunction:"eloblzlw",width:"k4urcfbm"},captionsDefault:{backgroundColor:"d6rk862h",color:"ljqsnud1",fontSize:"a5q79mjw",fontWeight:"ekzkrbhg",lineHeight:"j8p27hm0",marginTop:"kvgmc6g5",marginEnd:"nw5zvenu",marginBottom:"oygrvhab",marginStart:"pbhxczp3",paddingTop:"debrwdc1",paddingEnd:"m4n6deaq",paddingBottom:"pwvavz3a",paddingStart:"n1w2zk5c"},captionsLeftAlign:{justifyContent:"jifvfom9",textAlign:"hzawbc8m"},captionsRightAlign:{justifyContent:"bkfpd7mw",textAlign:"ftzlm3b6"}};function j(a){switch(a){case"center":return i.captionsCenterAlign;case"left":return i.captionsLeftAlign;case"right":return i.captionsRightAlign;default:b("recoverableViolation")("Unsupported captions text alignment: "+a,"comet_video_player")}}function a(a){var c=a.activeCaptions;a=a.adjustments;var d=c==null?void 0:c.rows;if(d!=null&&d.length>0){d=d.map(function(a){return a.trim()}).filter(function(a){return!!a});return d.length>0?h.jsx("div",{className:(g||(g=b("stylex")))(i.captionsContainer,j((c=c==null?void 0:(c=c.styles)==null?void 0:c.textAlignment)!=null?c:"center")),style:{paddingLeft:a.left,paddingRight:a.right,transform:"translateY("+-a.bottom+"px)"},children:h.jsx("div",{className:(g||(g=b("stylex")))(i.captionsDefault),children:d.map(function(a,b){return h.jsxs("span",{children:[a,h.jsx("br",{})]},b)})})}):null}return null}c=h.memo(a);d=c;e.exports=d}),null);
__d("useVideoPlayerCaptionsDisplayAdjustments",["React","VideoPlayerHooks"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(){var a=b("VideoPlayerHooks").useVideoPlayerCaptionsReservations(),c=g.useMemo(function(){var b={bottom:0,left:0,right:0,top:0};a.length>0&&a.forEach(function(a){b[a.location]+=a.size});return b},[a]);return c}}),null);
__d("VideoPlayerCaptions.react",["React","VideoPlayerCaptionsDisplay.react","VideoPlayerHooks","useVideoPlayerCaptionsDisplayAdjustments"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(){var a=b("VideoPlayerHooks").useActiveCaptions(),c=b("useVideoPlayerCaptionsDisplayAdjustments")();return g.jsx(b("VideoPlayerCaptionsDisplay.react"),{activeCaptions:a,adjustments:c})}}),null);
__d("VideoPlayerCaptionsArea.react",["React","VideoPlayerCaptions.react","VideoPlayerContexts","VideoPlayerHooks"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function h(a,b){switch(b.type){case"reserve":return a.concat(b.reservation);case"release":return a.filter(function(a){return a!==b.reservation});default:return a}}function a(a){a=a.children;var c=g.useReducer(h,[]),d=c[0],e=c[1];c=g.useState({release:function(a){e({reservation:a,type:"release"})},reserve:function(a){e({reservation:a,type:"reserve"});return a}});c=c[0];var f=b("VideoPlayerHooks").useCaptionsVisible();return g.jsx(b("VideoPlayerContexts").VideoPlayerCaptionsReservationActionsContext.Provider,{value:c,children:g.jsxs(b("VideoPlayerContexts").VideoPlayerCaptionsReservationsContext.Provider,{value:d,children:[f?g.jsx(b("VideoPlayerCaptions.react"),{}):null,a]})})}}),null);
__d("VideoPlayerFallbackCover.react",["fbt","React","requireCond","cr:1405514"],(function(a,b,c,d,e,f,g){"use strict";e.exports=a;var h=b("React");function a(a){var c;c=(c=a.message)!=null?c:g._("Tenemos problemas para reproducir este video.");return h.jsx(b("cr:1405514"),{debugError:a.debugError,message:c,onRetry:a.onRetry})}}),null);
__d("VideoPlayerFallbackCoverImplWithoutRetry.react",["React","TetraText.react","requireCond","stylex","cr:1672302"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var c=a.debugError,d=a.message;a.onRetry;return g.jsxs("div",{className:"stjgntxs ni8dbmo4 taijpn5t j83agx80 ora8z2hr bp9cbjyn kr520xx4 j9ispegn pmk7jnqg n7fi1qx3 rq0escxv i09qtzwb",children:[g.jsx("div",{className:"ij9ysmuz cbu4d94t j83agx80 bp9cbjyn",children:g.jsx(b("TetraText.react"),{align:"center",color:"white",type:"bodyLink3",children:d})}),b("cr:1672302")?g.jsx(b("cr:1672302"),{error:c}):null]})}}),null);
__d("VideoPlayerPlayButton.react",["fbt","CometImage.react","CometPressable.react","React","stylex"],(function(a,b,c,d,e,f,g){"use strict";e.exports=a;var h,i=b("React");function a(a){var c=a.isVisible;a=a.onClick;var d=i.jsx(b("CometImage.react"),{src:"/images/video/play_72dp.png"});a=a!=null?i.jsx(b("CometPressable.react"),{display:"inline",label:g._("Reproducir video"),onPress:a,overlayDisabled:!0,children:d}):d;return i.jsx("i",{className:(h||(h=b("stylex"))).dedupe({"border-top-start-radius-1":"s45kfl79","border-top-end-radius-1":"emlxlaya","border-bottom-end-radius-1":"bkmhp75w","border-bottom-start-radius-1":"spb7xbtv","cursor-1":"nhd2j8a9","height-1":"rdkrh8wx","margin-top-1":"jtnsf9zi","margin-end-1":"cxmmr5t8","margin-bottom-1":"oygrvhab","margin-start-1":"kw0a5h6o","opacity-1":"pedkr2u6","position-1":"pmk7jnqg","start-1":"kfkz5moi","top-1":"rk01pc8j","width-1":"orwu60u2"},c?null:{"opacity-1":"b5wmifdl","visibility-1":"kr9hpln1"}),children:a})}}),null);
__d("VideoPlayerRetryableErrorBoundary.react",["React","VideoPlayerErrorBoundary.react"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var c=a.children,d=a.description,e=a.fallback;a=g.useState(0);var f=a[0],h=a[1],i=g.useCallback(function(){h(function(a){return a+1})},[]);a=g.useCallback(function(a){return f>=3?e({error:a,retry:null}):e({error:a,retry:i})},[e,i,f]);return g.jsx(b("VideoPlayerErrorBoundary.react"),{description:d,fallback:a,project:"comet_video_player",children:c},f)}}),null);
__d("VideoPlayerSmallPlayButton.react",["fbt","CometImage.react","CometPressable.react","React","stylex"],(function(a,b,c,d,e,f,g){"use strict";e.exports=a;var h,i=b("React");function a(a){var c=a.isVisible;a=a.onClick;var d=i.jsx(b("CometImage.react"),{src:"/images/video/play_48dp.png"});a=a!=null?i.jsx(b("CometPressable.react"),{display:"inline",label:g._("Reproducir video"),onPress:a,overlayDisabled:!0,children:d}):d;return i.jsx("i",{className:(h||(h=b("stylex"))).dedupe({"border-top-start-radius-1":"s45kfl79","border-top-end-radius-1":"emlxlaya","border-bottom-end-radius-1":"bkmhp75w","border-bottom-start-radius-1":"spb7xbtv","cursor-1":"nhd2j8a9","height-1":"m7zwrmfr","margin-top-1":"f43gzcya","margin-end-1":"cxmmr5t8","margin-bottom-1":"oygrvhab","margin-start-1":"bnywmjdh","opacity-1":"pedkr2u6","position-1":"pmk7jnqg","start-1":"kfkz5moi","top-1":"rk01pc8j","width-1":"tmrshh9y"},c?null:{"opacity-1":"b5wmifdl","visibility-1":"kr9hpln1"}),children:a})}}),null);
__d("useDebouncedValue",["React"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a,b){var c=g.useState(a),d=c[0],e=c[1];g.useEffect(function(){var c=setTimeout(function(){return e(a)},b);return function(){return clearTimeout(c)}},[a,b]);return d}}),null);
__d("VideoPlayerSpinner.react",["CometLoadingAnimation.react","React","stylex","useDebouncedValue"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g,h=b("React"),i=36;function a(a){a=a.isVisible;var c=b("useDebouncedValue")(a,a?200:500);return h.jsx("div",{className:(g||(g=b("stylex"))).dedupe({"height-1":"tv7at329","opacity-1":"pedkr2u6","position-1":"pmk7jnqg","start-1":"kfkz5moi","top-1":"rk01pc8j","transform-0.1":"py2didcb","transition-delay-1":"chkx7lpg","transition-duration-1":"kmdw4o4n","transition-property-1":"art1omkt","transition-timing-function-1":"e4zzj2sf","width-1":"thwo4zme"},a?null:{"opacity-1":"b5wmifdl","transition-delay-1":"hwaazqwg","transition-duration-1":"kmdw4o4n","transition-property-1":"l23jz15m","transition-timing-function-1":"e4zzj2sf","visibility-1":"kr9hpln1"}),children:h.jsx(b("CometLoadingAnimation.react"),{animationPaused:!c,size:i})})}}),null);
__d("VideoPlayerSurface.react",["React"],(function(a,b,c,d,e,f){"use strict";a=b("React");c=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.render=function(){return this.props.children!=null?this.props.children:null};return b}(a.PureComponent);e.exports=c}),null);
__d("VideoPlayerFullscreenControl.react",["ix","fbt","React","VideoPlayerControlIcon.react","VideoPlayerHooks","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";e.exports=a;var i=b("React");function a(a){var c=a.onPress,d=a.onUserInteraction,e=a.shouldUnmute,f=b("VideoPlayerHooks").useController(),j=b("VideoPlayerHooks").useIsFullscreen(),k=b("VideoPlayerHooks").useLastMuteReason();a=j?h._("Salir de pantalla completa"):h._("Ver en pantalla completa");var l=function(){c&&c(),f.requestSetIsFullscreen(!j),e===!0&&k!=="user_initiated"&&f.setMuted(!1,"product_initiated"),d&&d({name:"video_fullscreen_button",type:"happened"})};return i.jsx(b("VideoPlayerControlIcon.react"),{icon:j?b("fbicon")._(g("517758"),20):b("fbicon")._(g("517763"),20),label:a,onPress:l,tooltip:a})}}),null);
__d("VideoPlayerInstreamAdsStateHooks",["createVideoStateHook"],(function(a,b,c,d,e,f){"use strict";f.useInstreamAdsMidRollsState=a;f.useInstreamAdsMidRollsValue=c;f.useInstreamAdsPostRollState=d;f.useInstreamAdsPostRollValue=e;f.useInstreamAdsPostRollEndedOrSkippedStateSetter=p;f.useInstreamAdsPostRollEndedOrSkippedStateValue=q;f.useInstreamAdsState=u;f.useInstreamAdsStateValue=v;f.useInstreamAdsIsEmptyState=z;f.useInstreamAdsIsEmptyStateValue=A;f.useInstreamAdsCurrentInsertionState=E;f.useInstreamAdsCurrentInsertionStateValue=F;f.useStartIndicatorBeginningTimeState=J;f.useStartIndicatorBeginningTimeStateValue=K;f.useInstreamAdsExtraFieldsState=O;f.useInstreamAdsExtraFieldsStateValue=P;f.useInstreamAdsHideAdBehaviorState=T;f.useInstreamAdsHideAdBehaviorStateValue=U;f.useUnifiedSchedulerLastFetchTimeState=Y;f.useUnifiedSchedulerLastFetchTimeStateValue=aa;f.useInstreamAdsHasCTAState=da;f.useInstreamAdsHasCTAStateValue=ea;f.useInstreamAdsFeedContextCardState=ha;f.useInstreamAdsFeedContextCardStateValue=ia;f.useInstreamAdsIsStart=ja;c=(a=b("createVideoStateHook")).createVideoStateHook();var g=c.stateHook,h=c.valueHook,i=[];function a(){return g(i)}function c(){return h(i)}d=a.createVideoStateHook();var j=d.stateHook,k=d.valueHook,l=null;function d(){return j(l)}function e(){return k(l)}e=a.createVideoStateHook();var m=e.setterHook,n=e.valueHook,o=!0;function p(){return m(o)}function q(){return n(o)}p=a.createVideoStateHook();var r=p.stateHook,s=p.valueHook,t="INIT";function u(){return r(t)}function v(){return s(t)}q=a.createVideoStateHook();var w=q.stateHook,x=q.valueHook,y=!0;function z(){return w(y)}function A(){return x(y)}u=a.createVideoStateHook();var B=u.stateHook,C=u.valueHook,D=null;function E(){return B(D)}function F(){return C(D)}z=a.createVideoStateHook();var G=z.stateHook,H=z.valueHook,I=null;function J(){return G(I)}function K(){return H(I)}A=a.createVideoStateHook();var L=A.stateHook,M=A.valueHook,N=null;function O(){return L(N)}function P(){return M(N)}E=a.createVideoStateHook();var Q=E.stateHook,R=E.valueHook,S=null;function T(){return Q(S)}function U(){return R(S)}F=a.createVideoStateHook();var V=F.stateHook,W=F.valueHook,X=null;function Y(){return V(X)}function aa(){return W(X)}J=a.createVideoStateHook();var ba=J.stateHook,ca=J.valueHook,Z=!1;function da(){return ba(Z)}function ea(){return ca(Z)}K=a.createVideoStateHook();var fa=K.stateHook,ga=K.valueHook,$=null;function ha(){return fa($)}function ia(){return ga($)}function ja(){var a=v();a=a==="STARTING_INDICATOR"||a==="START"||a==="START_AD"||a==="PLAY_NI_VIDEO";return a}}),null);
__d("useVideoPlayerDefaultControlsVisibility",["React","VideoPlayerHooks","VideoPlayerInstreamAdsStateHooks","VideoPlayerUserInteractionCounter","clearTimeout","setTimeout"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React"),h=5e3;function a(a){a=a===void 0?{}:a;var c=a.forceVisible,d=a.forceVisibleOnMount;a.isInteracting;a=b("VideoPlayerUserInteractionCounter").useVideoPlayerUserInteractionCounter();var e=a.ongoingInteractionsCount;a=a.onUserInteraction;var f=b("VideoPlayerHooks").useEnded(),i=b("VideoPlayerHooks").useIsHovering(),j=b("VideoPlayerHooks").usePaused(),k=b("VideoPlayerHooks").useIsMouseIdle(),l=b("VideoPlayerHooks").useVideoPlaybackEnded(),m=b("VideoPlayerInstreamAdsStateHooks").useInstreamAdsIsStart();b("VideoPlayerUserInteractionCounter").useVideoPlayerUserInteraction("video_pointer_active",i&&!k,a);i=g.useState(d===!0);var n=i[0],o=i[1];g.useEffect(function(){if(!j&&n){var a=b("setTimeout")(function(){o(!1)},h);return function(){b("clearTimeout")(a)}}},[n,j]);c===!0||c===!1?k=c:m?k=!1:e>0||n?k=!0:j?k=f?l:!0:k=!1;return{isControlsVisible:k,onUserInteraction:a}}}),null);
__d("useVideoPlayerHasStartedPlayingAtLeastOnce",["React","VideoPlayerHooks","createVideoStateHook"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");c=b("createVideoStateHook").createVideoStateHook(null);var h=c.stateHook;function a(){var a=h(!1),c=a[0],d=a[1],e=b("VideoPlayerHooks").usePlaying();g.useEffect(function(){e&&d(!0)},[e,d]);return c}}),null);
__d("useVideoPlayerBigPlayButtonOverlay",["React","VideoPlayerHooks","VideoPlayerPlayButton.react","VideoPlayerSmallPlayButton.react","useVideoPlayerHasStartedPlayingAtLeastOnce"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){a=a===void 0?{}:a;var c=a.buttonSize;c=c===void 0?"large":c;var d=a.forceVisible,e=a.overrideInteraction,f=a.shouldUnmute;a=b("useVideoPlayerHasStartedPlayingAtLeastOnce")();var h=b("VideoPlayerHooks").usePaused(),i=b("VideoPlayerHooks").useLastMuteReason(),j=b("VideoPlayerHooks").useController(),k=g.useCallback(function(){j.play("user_initiated"),f===!0&&i!=="user_initiated"&&j.setMuted(!1,"product_initiated")},[j,i,f]);e=e!=null?e.handler:k;k=d===!0||d===!1?d:!a&&h;d=c==="small"?g.jsx(b("VideoPlayerSmallPlayButton.react"),{isVisible:k,onClick:e}):g.jsx(b("VideoPlayerPlayButton.react"),{isVisible:k,onClick:e});return{bigPlayButtonElement:d,bigPlayButtonIsVisible:k}}}),null);
__d("defaultErrorBoundaryFallback",["fbt","React","VideoPlayerFallbackCover.react","gkx"],(function(a,b,c,d,e,f,g){"use strict";e.exports=a;var h=b("React");function i(a){return a&&b("gkx")("1792489")?a.message.toLowerCase().indexOf("audio_renderer_error")>=0:!1}function a(a){var c=a.error;a=a.retry;var d=i(c),e=null;a=a;d&&(e=g._("Error de procesador de audio: reinicia la computadora."),a=null);return h.jsx(b("VideoPlayerFallbackCover.react"),{debugError:c,message:e,onRetry:a})}}),null);
__d("VideoPlayerProgressiveImplementationData",[],(function(a,b,c,d,e,f){"use strict";f.makeProgressiveImplementationData=a;function a(a){var b=a.hdSrc,c=a.hdSrcPreferred;a=a.sdSrc;return a==null?null:{hdSrc:b,hdSrcPreferred:c,sdSrc:a}}}),null);
__d("getErrorMessageFromMediaErrorCode",[],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a){switch(a){case 1:return"The fetching process for the media resource was aborted by the user agent at the users request.";case 2:return"A network error of some description caused the user agent to stop fetching the media resource, after the resource was established to be usable.";case 3:return"An error of some description occurred while decoding the media resource, after the resource was established to be usable.";case 4:return"The media resource indicated by the src attribute was not suitable."}return null}}),null);
__d("getErrorNameFromMediaErrorCode",[],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a){switch(a){case 1:return"MEDIA_ERR_ABORTED";case 2:return"MEDIA_ERR_NETWORK";case 3:return"MEDIA_ERR_DECODE";case 4:return"MEDIA_ERR_SRC_NOT_SUPPORTED";default:return"MEDIA_ERR_UNKNOWN_"+((a=a)!=null?a:"UNDEFINED")}}}),null);
__d("VideoMimeTypes",[],(function(a,b,c,d,e,f){function a(a,b,c){return a+'; codecs="'+b+", "+c+'"'}f="mp4a.40.2";function b(a){return"avc1.42E0"+a.toString(16).toUpperCase()}function c(a){return"avc1.4D40"+a.toString(16).toUpperCase()}function d(a){return"avc1.6400"+a.toString(16).toUpperCase()}var g="video/mp4";b=a(g,b(30),f);var h=a(g,c(30),f);c=a(g,c(31),f);var i=a(g,d(50),f);a=a(g,d(51),f);g={h264baseline:b,h264main30avc:h,h264main31avc:c,h264high50avc:i,h264high51avc:a};e.exports=g}),null);
__d("VideoPlayerConnectionQuality",[],(function(a,b,c,d,e,f){"use strict";var g={POOR:"POOR",MODERATE:"MODERATE",GOOD:"GOOD",EXCELLENT:"EXCELLENT"},h=[{bandwidth:5e5,connectionQuality:g.POOR},{bandwidth:2e6,connectionQuality:g.MODERATE},{bandwidth:1e7,connectionQuality:g.GOOD}],i=100,j=null,k=null;a=function(a){if(j!==null&&k!==null&&j>=Date.now()-i)return k;a=a();var b=null;if(a!=null)for(var c=0;c<h.length;c++)if(a<h[c].bandwidth){b=h[c].connectionQuality;break}b===null&&(b=g.EXCELLENT);j=Date.now();k=b;return b};f.evaluate=a}),null);
__d("VideoPlayerLoggerPlayerStates",[],(function(a,b,c,d,e,f){a="started";b="unpaused";c={STARTED:a,UNPAUSED:b};e.exports=c}),null);
__d("getVideoBrowserTabId",["guid"],(function(a,b,c,d,e,f){e.exports=a;var g=b("guid")().slice(-8);function a(){return g}}),null);
__d("VideoPlayerProgressiveImplementationEngineExtrasAPI",[],(function(a,b,c,d,e,f){"use strict";f.createVideoPlayerProgressiveImplementationEngineExtrasAPI=a;function a(a){var b=a.getPlayingVideoInfo;a=a.setUserSelectedVideoQuality;a={getApproximateFBLSToPlayerDisplayLatency:function(){return null},getAudioRepresentationIDAtTime:function(a){return null},getAvailableVideoQualities:function(){var a;return(a=(a=b())==null?void 0:a.availableQualities)!=null?a:[]},getCurrentAudioRepresentation:function(){return null},getCurrentPlayingVideoQuality:function(){var a;return(a=(a=b())==null?void 0:a.targetQuality)!=null?a:""},getCurrentTargetVideoQuality:function(){var a;return(a=(a=b())==null?void 0:a.targetQuality)!=null?a:""},getCurrentVideoRepresentation:function(){return null},getEstimatedBandwidth:function(){return null},getInbandCaptionsAutogeneratedFromManifest:function(){return!1},getInbandCaptionsExpectedFromManifest:function(){return!1},getPerfLoggerProvider:function(){return null},getStreamType:function(){return"progressive"},getUserSelectedVideoQuality:function(){var a;return(a=(a=b())==null?void 0:a.selectedQuality)!=null?a:"notselected"},getVideoProjectionType:function(){return"cubemap"},getVideoRepresentationIDAtTime:function(a){return"oep_hd"},getVideoRepresentations:function(){return null},isDrm:function(){var a;return((a=b())==null?void 0:a.graphQLVideoDRMInfo)!=null},isFBIsLiveTemplated:function(){return!1},isFBMS:function(){return!1},isFBWasLive:function(){return!1},isPredictiveDash:function(){return!1},setDimensions:function(a){},setEnableLiveheadCatchup:function(){},setLatencyLevel:function(){},setUserSelectedVideoQuality:a};return a}}),null);
__d("VideoPlayerProgressiveImplementationEngineUtils",["gkx"],(function(a,b,c,d,e,f){"use strict";f.createResolvedVideoInfoProgressive=a;f.updatePlayingVideoInfoProgressiveWithUserSelectedQuality=c;f.updatePlayingVideoInfoProgressiveWithCurrentPlayingQuality=d;var g="hd",h="sd";function a(a){var c=[];a.sdSrc!=null&&c.push(h);a.hdSrc!=null&&c.push(g);var d=a.hdSrcPreferred&&a.hdSrc!=null&&b("gkx")("1483656")?g:h;return babelHelpers["extends"]({},a,{availableQualities:c,playingQuality:null,playingSrc:null,selectedQuality:d,targetQuality:d,targetSrc:null})}function c(a,b){var c=a.hdSrc,d=a.sdSrc,e,f;b==="notselected"||b==="auto"?(e=d!=null?h:c!=null?g:h,f=d!=null?d:c!=null?c:null):b===g&&c!=null?(e=g,f=c):b===h&&d!=null?(e=h,f=d):(e=h,f=null);f===""&&(f=null);return babelHelpers["extends"]({},a,{selectedQuality:b,targetQuality:e,targetSrc:f})}function d(a,b,c){return babelHelpers["extends"]({},a,{playingQuality:b,playingSrc:c})}}),null);
__d("VideoPlayerProgressiveImplementationEngine",["FBLogger","UserAgent","VideoPlayerImplementationEngineAPI","VideoPlayerImplementationEngineVideoElementAPI","VideoPlayerImplementationErrors","VideoPlayerODS","VideoPlayerProgressiveImplementationEngineExtrasAPI","VideoPlayerProgressiveImplementationEngineUtils","emptyFunction","gkx","promiseDone","requireCond","unrecoverableViolation","cr:1680308","cr:1473550","cr:1512856"],(function(a,b,c,d,e,f){"use strict";f.createVideoPlayerProgressiveImplementationEngine=a;var g=b("emptyFunction");function h(a,c){return b("VideoPlayerImplementationErrors").createVideoPlayerErrorFromGenericError("PROGRESSIVE_JAVASCRIPT_NATIVE",a,c)}function a(a){var c=a.debugLogId,d=a.handleFatalError,e=a.initialProps;a=a.setExposedStateInReact;var f={current:null},i={current:null},j={current:null},k={current:null},l=function(){var a=k.current;a!=null&&(k.current=null,a())},m=function(a){l();var c=u();if(c==null)throw b("unrecoverableViolation")("Need videoElement in startSwitchingSource","comet_video_player");if(b("cr:1512856")==null)throw b("unrecoverableViolation")("Need SourceSwitcher in startSwitchingSource","comet_video_player");k.current=b("cr:1512856").startSwitchingVideoElementSource({getShouldBePlaying:function(){return x.getCurrentState().controlledState.playbackState==="playing"||x.getCurrentState().controlledState.playbackState==="stalling"},onSourceSwitchCancelled:function(){x.dispatch({type:"buffering_end_requested"})},onSourceSwitchFailed:function(a){b("FBLogger")("comet_video_player").catching(a).warn("Progressive source switch failed: %s",String(a)),x.dispatch({type:"buffering_end_requested"})},onSourceSwitchStarted:function(){x.dispatch({payload:{bufferingType:"in_play"},type:"buffering_begin_requested"})},onSourceSwitchSucceeded:function(){var a=j.current;a!=null&&a.targetQuality!=null&&(j.current=b("VideoPlayerProgressiveImplementationEngineUtils").updatePlayingVideoInfoProgressiveWithCurrentPlayingQuality(a,a.targetQuality,a.targetSrc));x.dispatch({type:"buffering_end_requested"})},targetSrc:a,videoElement:c})},n={current:null},o=function(){var a=u(),c=i.current;if(a==null||c==null)return;try{var d,f=c.graphQLVideoDRMInfo,g=c.videoFBID;d=f?(d=f.fairplayCert)!=null?d:null:null;b("cr:1680308")&&(n.current=f&&d!=null&&g!=null?new(b("cr:1680308"))(d,a,g,f.videoLicenseUriMap):null);var h=b("VideoPlayerImplementationEngineVideoElementAPI").createVideoPlayerImplementationEngineVideoElementAPI(a);y.current=h;j.current=c;d=t();v({inbandCaptionsAutogeneratedFromManifest:r.getInbandCaptionsAutogeneratedFromManifest(),inbandCaptionsExpectedFromManifest:r.getInbandCaptionsExpectedFromManifest(),inbandCaptionsExpectedFromProps:d==null?void 0:d.inbandCaptionsExpectedFromProps,sideLoadCaptionsExpectedFromProps:d==null?void 0:d.sideLoadCaptionsExpectedFromProps,sideLoadCaptionsUrlFromProps:d==null?void 0:d.sideLoadCaptionsUrlFromProps});g=function(){h.setPlayheadPosition(e.startTimestamp),x.dispatch({payload:{availableQualities:r.getAvailableVideoQualities(),selectedVideoQuality:r.getUserSelectedVideoQuality(),targetVideoQuality:r.getCurrentTargetVideoQuality(),videoProjection:r.getVideoProjectionType()},type:"implementation_engine_initialized"})};b("UserAgent").isBrowser("IE11")?b("promiseDone")(h.loadMetaData().then(g)):g()}catch(a){w(a,"progressive_player_create_exception")}},p=function(a,c){if(c==null)return!0;else if(a.videoFBID!==c.videoFBID){var d=14;b("VideoPlayerODS").bumpEntityKey("comet_video_player","ProgressiveImplementation.video_fbid_changed",d);return!1}else if(a.hdSrc!==c.hdSrc||a.sdSrc!==c.sdSrc){d=14;b("VideoPlayerODS").bumpEntityKey("comet_video_player","ProgressiveImplementation.src_changed",d);return!1}else return!1},q=function(a){var c;c={graphQLVideoDRMInfo:(c=a.graphQLVideoDRMInfo)!=null?c:null,hdSrc:a.hdSrc===""?null:(c=a.hdSrc)!=null?c:null,hdSrcPreferred:a.hdSrcPreferred,sdSrc:a.sdSrc===""?null:(c=a.sdSrc)!=null?c:null,videoFBID:a.videoFBID};if(!p(c,f.current))return!1;if(c.hdSrc==null&&c.sdSrc==null)throw b("unrecoverableViolation")("Empty hdSrc and sdSrc","comet_video_player");f.current=c;i.current=b("VideoPlayerProgressiveImplementationEngineUtils").createResolvedVideoInfoProgressive(c);o();return!0},r=b("VideoPlayerProgressiveImplementationEngineExtrasAPI").createVideoPlayerProgressiveImplementationEngineExtrasAPI({getPlayingVideoInfo:function(){return j.current},setUserSelectedVideoQuality:function(a){var c=j.current;if(!c)throw b("unrecoverableViolation")("Attempt to switch quality when playingVideoInfo does not exist","comet_video_player");var d=y.current;if(!d)throw b("unrecoverableViolation")("Attempt to switch quality when videoElementAPI does not exist","comet_video_player");var e=c.targetQuality,f=c.targetSrc;j.current=b("VideoPlayerProgressiveImplementationEngineUtils").updatePlayingVideoInfoProgressiveWithUserSelectedQuality(c,a);c=j.current;a=c.targetQuality;c=c.targetSrc;if(b("gkx")("1467411"))c!==f&&(c==null?(l(),d.setSrc(null)):m(c)),e!=null&&a!==e&&a!=null&&x.dispatch({payload:{targetVideoQuality:a},type:"representation_changed"});else{d.setSrc(c);if(c!=null){e=(f=x.getCurrentState().uncontrolledState.videoElementPlayheadPosition)!=null?f:0;e>0&&d.setPlayheadPosition(e);x.getCurrentState().controlledState.playbackState==="playing"&&d.play();x.dispatch({payload:{targetVideoQuality:r.getCurrentTargetVideoQuality()},type:"representation_changed"})}}}}),s=function(){n.current&&(n.current.destroy(),n.current=null)};c=b("VideoPlayerImplementationEngineAPI").createVideoPlayerImplementationEngine({createDebugAPI:function(a){var c=a.getVideoElementAPI;a=a.logger;return b("cr:1473550")?b("cr:1473550").createVideoPlayerImplementationDebugAPI({engineExtrasAPI:r,getVideoElementAPI:c,logger:a}):null},createVideoPlayerError:h,debugLog:g,debugLogId:c,destroyEngineParts:function(){if(b("gkx")("1467411")){l();var a=y.current;a&&a.setSrc(null);j.current=null}s()},engineExtrasAPI:r,engineMetadata:{isAbrEnabled:!1,playerImplementationName:"progressive_v2",playerVersion:"comet_progressive",streamingFormat:"progressive"},handleFatalError:d,handleVideoElementMounted:o,handleVideoElementUnmounted:function(){b("gkx")("1467411")&&l()},handleVideoInfoChange:q,initialProps:e,setExposedStateInReact:a});d=c.engine;var t=c.getCaptionsInfo,u=c.getVideoElement,v=c.handleCaptionsInfoChange,w=c.handleFatalImplementationError,x=c.machine,y=c.videoElementAPIRef;return d}}),null);
__d("VideoPlayerProgressiveImplementationV2.react",["React","VideoPlayerImplementationEngineAPI","VideoPlayerImplementationReactVideoElement.react","VideoPlayerProgressiveImplementationEngine"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var c=b("VideoPlayerImplementationEngineAPI").useVideoPlayerImplementationEngine(a,b("VideoPlayerProgressiveImplementationEngine").createVideoPlayerProgressiveImplementationEngine),d=c[0];c=c[1];return g.jsx(b("VideoPlayerImplementationReactVideoElement.react"),{implementationController:c.implementationController,implementationExposedState:d,renderWithVideoImplementationStates:a.renderWithVideoImplementationStates,videoElementCallbacks:c.videoElementCallbacks,videoElementRefCallback:c.videoElementRefCallback})}}),null);
__d("oz-player/shims/www/OzEventEmitterWWW",["EventEmitter"],(function(a,b,c,d,e,f){"use strict";a=b("EventEmitter");e.exports=a}),null);
__d("oz-player/shims/www/OzNetworkDiagnosticsWWW",[],(function(a,b,c,d,e,f){"use strict";a={getResponseTimeMs:function(a){return a?parseInt(a.get("x-fb-response-time-ms"),10):null}};b=a;e.exports=b}),null);
__d("oz-player/shims/www/OzReadableStreamWWW",["requireCond","cr:927622"],(function(a,b,c,d,e,f){"use strict";b("cr:927622")&&(b("cr:927622").ReadableStream.isPolyfilled=!0);a=b("cr:927622")?b("cr:927622").ReadableStream:window.ReadableStream;c=a;e.exports=c}),null);
__d("oz-player/shims/www/OzWritableStreamWWW",["requireCond","cr:927623"],(function(a,b,c,d,e,f){"use strict";b("cr:927623")&&(b("cr:927623").WritableStream.isPolyfilled=!0);a=b("cr:927623")?b("cr:927623").WritableStream:window.WritableStream;c=a;e.exports=c}),null);
__d("oz-player/shims/www/ozSetTimeoutAcrossTransitionsWWW",["setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){"use strict";a=b("setTimeoutAcrossTransitions");e.exports=a}),null);
__d("CometComposerEditVideoButtonWithNuxQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{kind:"Literal",name:"nux_id",value:8473}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometComposerEditVideoButtonWithNuxQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"nux",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"CometComposerEditVideoButtonWithNux_nux"}],storageKey:"nux(nux_id:8473)"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"CometComposerEditVideoButtonWithNuxQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"nux",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"nux_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"should_show",storageKey:null}],type:"DefaultNUX",abstractKey:null}],storageKey:"nux(nux_id:8473)"}]},params:{id:"3557933320896366",metadata:{},name:"CometComposerEditVideoButtonWithNuxQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("CometComposerEditVideoButtonWithNux_nux.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometComposerEditVideoButtonWithNux_nux",selections:[{args:null,kind:"FragmentSpread",name:"useMaybeNUX_nux"}],type:"DefaultNUX",abstractKey:null};e.exports=a}),null);
__d("EntPhotoCollageItemContainerQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a={defaultValue:null,kind:"LocalArgument",name:"id"},b={defaultValue:null,kind:"LocalArgument",name:"scale"},c=[{kind:"Variable",name:"id",variableName:"id"}];return{fragment:{argumentDefinitions:[a,b],kind:"Fragment",metadata:null,name:"EntPhotoCollageItemContainerQuery",selections:[{alias:null,args:c,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"EntPhotoCollageItem_media"}],type:"Photo",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[b,a],kind:"Operation",name:"EntPhotoCollageItemContainerQuery",selections:[{alias:null,args:c,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Literal",name:"context",value:"comet_media_viewer"},{kind:"Literal",name:"height",value:1e6},{kind:"Variable",name:"scale",variableName:"scale"},{kind:"Literal",name:"width",value:1e6}],concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Vect2",kind:"LinkedField",name:"focus",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null}],storageKey:null}],type:"Photo",abstractKey:null}],storageKey:null}]},params:{id:"2930723467039587",metadata:{},name:"EntPhotoCollageItemContainerQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("EntPhotoCollageItem_media.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[{kind:"RootArgument",name:"scale"}],kind:"Fragment",metadata:null,name:"EntPhotoCollageItem_media",selections:[{alias:null,args:[{kind:"Literal",name:"context",value:"comet_media_viewer"},{kind:"Literal",name:"height",value:1e6},{kind:"Variable",name:"scale",variableName:"scale"},{kind:"Literal",name:"width",value:1e6}],concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Vect2",kind:"LinkedField",name:"focus",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null}],storageKey:null}],type:"Photo",abstractKey:null};e.exports=a}),null);
__d("ComposerMediaDeepDiveItemQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"id"}],b=[{kind:"Variable",name:"id",variableName:"id"}],c={alias:null,args:null,kind:"ScalarField",name:"has_taggable_products",storageKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"ComposerMediaDeepDiveItemQuery",selections:[{alias:null,args:b,concreteType:"Page",kind:"LinkedField",name:"page",plural:!1,selections:[c],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"ComposerMediaDeepDiveItemQuery",selections:[{alias:null,args:b,concreteType:"Page",kind:"LinkedField",name:"page",plural:!1,selections:[c,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{id:"2545780295523587",metadata:{},name:"ComposerMediaDeepDiveItemQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("EntPhotoDeepDiveItemContainerQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a={defaultValue:null,kind:"LocalArgument",name:"id"},b={defaultValue:null,kind:"LocalArgument",name:"scale"},c=[{kind:"Variable",name:"id",variableName:"id"}];return{fragment:{argumentDefinitions:[a,b],kind:"Fragment",metadata:null,name:"EntPhotoDeepDiveItemContainerQuery",selections:[{alias:null,args:c,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"EntPhotoDeepDiveItem_media"}],type:"Photo",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[b,a],kind:"Operation",name:"EntPhotoDeepDiveItemContainerQuery",selections:[{alias:null,args:c,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Literal",name:"context",value:"comet_media_viewer"},{kind:"Literal",name:"height",value:1e6},{kind:"Variable",name:"scale",variableName:"scale"},{kind:"Literal",name:"width",value:1e6}],concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null}],storageKey:null}],type:"Photo",abstractKey:null}],storageKey:null}]},params:{id:"2758576607601107",metadata:{},name:"EntPhotoDeepDiveItemContainerQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("EntPhotoDeepDiveItem_media.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[{kind:"RootArgument",name:"scale"}],kind:"Fragment",metadata:null,name:"EntPhotoDeepDiveItem_media",selections:[{alias:null,args:[{kind:"Literal",name:"context",value:"comet_media_viewer"},{kind:"Literal",name:"height",value:1e6},{kind:"Variable",name:"scale",variableName:"scale"},{kind:"Literal",name:"width",value:1e6}],concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null}],storageKey:null}],type:"Photo",abstractKey:null};e.exports=a}),null);
__d("RemoteVideoFilePreviewQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"videoID"}],b=[{kind:"Variable",name:"id",variableName:"videoID"}],c={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},e=[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"start",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"representation_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"mime_codec",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"segment_type",storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"RemoteVideoFilePreviewQuery",selections:[{alias:null,args:b,concreteType:"Video",kind:"LinkedField",name:"video",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"VideoPlayerRelay_video"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"RemoteVideoFilePreviewQuery",selections:[{alias:null,args:b,concreteType:"Video",kind:"LinkedField",name:"video",plural:!1,selections:[c,{alias:null,args:null,kind:"ScalarField",name:"original_width",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"original_height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"broadcaster_origin",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"broadcast_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"broadcast_status",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_live_streaming",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_live_trace_enabled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_looping",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_video_broadcast",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"loop_count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_spherical",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_spherical_enabled",storageKey:null},{alias:null,args:null,concreteType:"MusicVideoMetadata",kind:"LinkedField",name:"pmv_metadata",plural:!1,selections:[d,c],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"permalink_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"captions_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dash_prefetch_experimental",storageKey:null},{alias:null,args:null,concreteType:"VideoCaptionLocale",kind:"LinkedField",name:"video_available_captions_locales",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"localized_creation_method",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"VideoPrefetchResources",kind:"LinkedField",name:"dash_prefetch_resources",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoPrefetchResource",kind:"LinkedField",name:"audio",plural:!0,selections:e,storageKey:null},{alias:null,args:null,concreteType:"VideoPrefetchResource",kind:"LinkedField",name:"video",plural:!0,selections:e,storageKey:null}],storageKey:null},{alias:null,args:[{kind:"Literal",name:"context",value:"DEFAULT"},{kind:"Literal",name:"supported",value:["CometVideoPlayerOzImplementation","CometVideoPlayerShakaImplementation","CometVideoPlayerProgressiveImplementation"]}],concreteType:null,kind:"LinkedField",name:"comet_video_player_implementations",plural:!0,selections:[d,{kind:"InlineFragment",selections:[{documentName:"useRelay3DVideoImplementations_video",fragmentName:"useRelay3DOzImplementation_implementation",fragmentPropName:"implementation",kind:"ModuleImport"}],type:"CometVideoPlayerOzImplementation",abstractKey:null},{kind:"InlineFragment",selections:[{documentName:"useRelay3DVideoImplementations_video",fragmentName:"useRelay3DShakaImplementation_implementation",fragmentPropName:"implementation",kind:"ModuleImport"}],type:"CometVideoPlayerShakaImplementation",abstractKey:null},{kind:"InlineFragment",selections:[{documentName:"useRelay3DVideoImplementations_video",fragmentName:"useRelay3DProgressiveImplementation_implementation",fragmentPropName:"implementation",kind:"ModuleImport"}],type:"CometVideoPlayerProgressiveImplementation",abstractKey:null}],storageKey:'comet_video_player_implementations(context:"DEFAULT",supported:["CometVideoPlayerOzImplementation","CometVideoPlayerShakaImplementation","CometVideoPlayerProgressiveImplementation"])'},{alias:null,args:null,kind:"ScalarField",name:"can_use_oz",storageKey:null},{alias:"playable_url_dash",args:[{kind:"Literal",name:"scrubbing_preference",value:"MPEG_DASH"}],kind:"ScalarField",name:"playable_url",storageKey:'playable_url(scrubbing_preference:"MPEG_DASH")'},{alias:null,args:null,kind:"ScalarField",name:"dash_manifest",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"min_quality_preference",storageKey:null},{alias:null,args:null,concreteType:"VideoPlayerShakaLiveP2PInit",kind:"LinkedField",name:"video_player_shaka_live_p2p_init",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"json_encoded_video_data",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"playable_url",storageKey:null},{alias:"playable_url_quality_hd",args:[{kind:"Literal",name:"quality",value:"HD"}],kind:"ScalarField",name:"playable_url",storageKey:'playable_url(quality:"HD")'},{alias:null,args:null,concreteType:"SphericalVideoFallbackUrls",kind:"LinkedField",name:"spherical_video_fallback_urls",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"hd",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sd",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_gaming_video",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_latency_menu_enabled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"comet_video_player_static_config",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"comet_video_player_context_sensitive_config",storageKey:null},{alias:null,args:null,concreteType:"VideoPlayerShakaPerformanceLoggerInit",kind:"LinkedField",name:"video_player_shaka_performance_logger_init",plural:!1,selections:[{documentName:"useVideoPlayerShakaPerformanceLoggerRelay_video",fragmentName:"useVideoPlayerShakaPerformanceLoggerRelay_init",fragmentPropName:"init",kind:"ModuleImport"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"autoplay_gating_result",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"viewer_autoplay_setting",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"can_autoplay",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"drm_info",storageKey:null},{alias:null,args:null,concreteType:"VideoP2PSettings",kind:"LinkedField",name:"p2p_settings",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ticket",storageKey:null},{alias:null,args:null,concreteType:"VideoP2PSettingsConfig",kind:"LinkedField",name:"config",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"delay_p2p_until_play",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"disable_hivejava_for_livevc",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"VideoHiveInitializationOptions",kind:"LinkedField",name:"hive_initialization_options",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoHiveInitializationOptionHiveJava",kind:"LinkedField",name:"hive_java",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"min_version",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hive_tech_order",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"debug_level",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"AudioSettings",kind:"LinkedField",name:"audio_settings",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"video_volume_setting",storageKey:null},c],storageKey:null},{alias:null,args:null,concreteType:"CaptionsSettings",kind:"LinkedField",name:"captions_settings",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"always_show_captions",storageKey:null},c],storageKey:null},{alias:null,args:null,concreteType:"VideoBroadcastLowLatencyConfig",kind:"LinkedField",name:"broadcast_low_latency_config",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ll_desired_latency_ms",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ll_latency_tolerance_ms",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"audio_availability",storageKey:null},{alias:null,args:null,concreteType:"VideoMutedSegment",kind:"LinkedField",name:"muted_segments",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"mute_start_time_in_sec",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"mute_end_time_in_sec",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SphericalVideoRenderer",kind:"LinkedField",name:"spherical_video_renderer",plural:!1,selections:[{documentName:"VideoPlayerRelay_video_spherical_video_renderer",fragmentName:"VideoPlayerSphericalRelay_sphericalVideoRenderer",fragmentPropName:"sphericalVideoRenderer",kind:"ModuleImport"}],storageKey:null},{alias:null,args:null,concreteType:"InstreamVideoAdBreaks",kind:"LinkedField",name:"instream_video_ad_breaks_comet",plural:!1,selections:[{documentName:"VideoPlayerRelay_video_instream_video_ad_breaks_comet",fragmentName:"InstreamVideoAdBreaksPlayer_adBreaks",fragmentPropName:"adBreaks",kind:"ModuleImport"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_premium_music_video",storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"selected_latency_setting",storageKey:null}]}],storageKey:null}]},params:{id:"3201247810004507",metadata:{},name:"RemoteVideoFilePreviewQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("CometComposerEditMediaAttachmentItemButton.react",["ix","fbt","CometMediaEditorPageResource","React","TetraButton.react","emptyFunction","fbicon","lazyLoadComponent","useCometComposerPushPage","useComposerPluginIneligibility"],(function(a,b,c,d,e,f,g,h){"use strict";var i=b("React"),j=b("lazyLoadComponent")(b("CometMediaEditorPageResource"));function a(a,c){var d=a.buttonLabel;d=d===void 0?h._("Editar"):d;var e=a.index,f=a.isOnVideoLiteComposer;a=a.onClickLog;var k=a===void 0?b("emptyFunction"):a,l=b("useCometComposerPushPage")();a=b("useComposerPluginIneligibility")().has("MEDIA_EDIT");return a?null:i.jsx(b("TetraButton.react"),{icon:b("fbicon")._(g("477825"),16),label:d,onPress:function(){l!=null&&(k(),l(h._("Detalles de la foto"),function(a){a=a.onReturn;return i.jsx(j,{index:e,isDialog:!0,isOnVideoLiteComposer:f,onBack:a})},{hasCustomHeader:!0}))},ref:c,testid:void 0,type:"overlay"})}c=i.forwardRef(a);e.exports=c}),null);
__d("CometComposerEditVideoButtonWithNux.react",["fbt","CometComposerEditMediaAttachmentItemButton.react","CometRelay","React","setTimeout","stylex","useCometCallout","useCometVideoComposerLog","useMaybeNUX","CometComposerEditVideoButtonWithNuxQuery.graphql","CometComposerEditVideoButtonWithNux_nux.graphql"],(function(a,b,c,d,e,f,g){"use strict";e.exports=a;var h,i,j=b("React"),k={nux:{maxWidth:"nqmqzb3c"}},l=h!==void 0?h:h=b("CometComposerEditVideoButtonWithNuxQuery.graphql"),m=i!==void 0?i:i=b("CometComposerEditVideoButtonWithNux_nux.graphql");function n(a){var c=g._("Usa las opciones de publicaci\u00f3n para agregar a tu video un t\u00edtulo y subt\u00edtulos, as\u00ed como para realizar otros cambios que podr\u00edan mejorar la distribuci\u00f3n.");a=b("CometRelay").useFragment(m,a);a=b("useMaybeNUX")(a);var d=a[0],e=a[1];a=j.useState(!1);var f=a[0],h=a[1];a={align:"start",arrowStyle:"inset",autoAlign:!0,hasCloseButton:!0,label:c,onHide:function(){h(!1),e()},position:"below",type:"accent",xstyle:k.nux};c=b("useCometCallout")(a,f);d===!0&&b("setTimeout")(function(){h(d)},100);return c}function a(){var a=j.useRef(!1),c=b("useCometVideoComposerLog")(),d=c.logEvent;j.useEffect(function(){a.current||(d("dialog_bootloaded"),a.current=!0)},[d]);c=b("CometRelay").useLazyLoadQuery(l,{});c=c.nux!==null?n(c.nux):null;return j.jsx(b("CometComposerEditMediaAttachmentItemButton.react"),{buttonLabel:g._("Opciones de publicaci\u00f3n"),index:0,isOnVideoLiteComposer:!0,onClickLog:function(){d("open_publish_option_edit_flow")},ref:c})}}),null);
__d("genArrayBufferFromFile",["Promise"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a){return"arrayBuffer"in a&&typeof a.arrayBuffer==="function"?a.arrayBuffer():new(b("Promise"))(function(b,c){var d=new FileReader();d.onload=function(){var a=d.result;a instanceof ArrayBuffer?b(a):c()};d.onerror=function(){c(d.error)};d.readAsArrayBuffer(a)})}}),null);
__d("parseIFDEntry",[],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a){var b=a.readU16(),c=a.readU16(),d=a.readU32(),e=Object.freeze({offset:a.peekU32(),type:"offset"});switch(c){case 1:case 2:case 7:if(d<5){e={type:"data",values:[]};for(var f=0;f<d;f++)e.values.push(a.readU8())}break;case 6:if(d<5){e={type:"data",values:[]};for(var f=0;f<d;f++)e.values.push(a.readI8())}break;case 3:if(d<3){e={type:"data",values:[]};for(var f=0;f<d;f++)e.values.push(a.readU16())}break;case 8:if(d<3){e={type:"data",values:[]};for(var f=0;f<d;f++)e.values.push(a.readI16())}break;case 4:d<2&&(e={type:"data",values:[a.readU32()]});break;case 9:d<2&&(e={type:"data",values:[a.readI32()]});break;case 11:d<2&&(e={type:"data",values:[a.readF32()]});break;case 5:case 10:case 12:a.seekRelative(4);break}return{format:c,tag:b,value:e}}}),null);
__d("parseIFDTable",["parseIFDEntry"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a){var c=a.readU16(),d=[];for(var e=0;e<c;e++)d.push(b("parseIFDEntry")(a));c=a.readU32();return{entries:d,nextTableOffset:c}}}),null);
__d("parseTIFFHeader",["EndianAwareDataReader","parseIFDTable"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a,c){c===void 0&&(c=0);var d=new Uint8Array(a,c),e=!0;if(d[0]===77&&d[1]===77)e=!1;else if(d[0]!==73||d[1]!==73)return null;d=new(b("EndianAwareDataReader"))(a,e);d.seekTo(c+2);if(d.readU16()!==42)return null;a=d.readU32();d.seekRelative(a-8);e=b("parseIFDTable")(d);return[e]}}),null);
__d("extractJPEGOrientationData",["genArrayBufferFromFile","parseTIFFHeader"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=65496,h=65498,i=1165519206;function a(a){return b("genArrayBufferFromFile")(a).then(function(a){var c=new DataView(a);if(c.getUint16(0,!1)!==g)return null;var d=2;while(d<a.byteLength-2&&c.getUint16(d)!==h){var e=c.getUint16(d),f=e&65280;e=e&255;if(f===65280)if(e===225){if(c.getUint32(d+4)!==i||c.getUint16(d+8)!==0)return null;f=b("parseTIFFHeader")(a,d+10);if(f!=null){f=f[0];for(var f=f.entries,j=Array.isArray(f),k=0,f=j?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var l;if(j){if(k>=f.length)break;l=f[k++]}else{k=f.next();if(k.done)break;l=k.value}l=l;if(l.tag===274){l=l.value;if(l.type==="data"){l=l.values[0];if(l==null)return null;return l===0||l===1||l===2||l===3||l===4||l===5||l===6||l===7||l===8?l:null}return null}}}return null}else if(e!==0&&(e<208||e>217)){l=c.getUint16(d+2,!1);d+=l+2}}return null})}}),null);
__d("extractXMPMetadata",["extractUTF8StringFromBuffer","genArrayBufferFromFile"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=65496,h=65498,i="http://ns.adobe.com/xap/1.0/\0";function j(a,b){for(var c=0;c<i.length;c++){var d=i.charCodeAt(c);if(a.getUint8(b+c)!==d)return!1}return!0}function a(a){return b("genArrayBufferFromFile")(a).then(function(a){var c=new DataView(a);if(c.getUint16(0,!1)!==g)return null;var d=2;while(d<a.byteLength-2&&c.getUint16(d)!==h){var e=c.getUint16(d),f=e&65280;e=e&255;if(f===65280)if(e===225){if(j(c,d+4)){f=c.getUint16(d+2)-i.length-2;f=b("extractUTF8StringFromBuffer")(c.buffer,d+4+i.length,f);f.charCodeAt(f.length-1)===0&&(f=f.substr(0,f.length-1));try{var k=new DOMParser();k=k.parseFromString(f,"application/xml");return k.getElementsByTagName("parsererror").length>0?null:k}catch(a){return null}}f=c.getUint16(d+2,!1);d+=f+2}else if(e!==0&&(e<208||e>217)){k=c.getUint16(d+2,!1);d+=k+2}}return null})}}),null);
__d("genDimensionsFromImageFile",["Promise"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a){var c=new Image(),d=new(b("Promise"))(function(a,b){c.onload=function(){a({height:c.height,width:c.width})},c.onerror=function(){b()}});a instanceof File?c.src=URL.createObjectURL(a):c.src=a;return d}}),null);
__d("genDimensionsFromVideoFile",["Promise"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a){var c=document.createElement("video"),d=new(b("Promise"))(function(a,b){c.onloadedmetadata=function(){a({height:c.videoHeight,width:c.videoWidth})},c.onerror=function(){b()}});a instanceof File?c.src=URL.createObjectURL(a):c.src=a;return d}}),null);
__d("genIsHEICFile",["genArrayBufferFromFile"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a){var c=[102,116,121,112],d=[104,101,105,99],e=[104,101,105,120];return b("genArrayBufferFromFile")(a).then(function(a){a=new Uint8Array(a);var b=a.slice(4,8).reduce(function(a,b,d){return a&&b===c[d]},!0);if(!b)return!1;b=a.slice(8,12).reduce(function(a,b,c){return a&&b===d[c]},!0);if(b)return!0;b=a.slice(8,12).reduce(function(a,b,c){return a&&b===e[c]},!0);return b?!0:!1})}}),null);
__d("readVINT",[],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a,b){var c=0;b=Math.min(a.length,(b=b)!=null?b:Number.MAX_VALUE);var d=0;while(c<b){var e=a[c];if(e===0)d+=8,c++;else{d+=8-Math.floor(Math.log2(e));if(d>b||d<0)return null;e=g(a,d);return{vintData:e,nextReadOffset:d}}}return null}function g(a,b){var c=Math.floor(b/8),d=a[c],e=8-b%8;e<8&&(d^=1<<e);e=new Uint8Array(new ArrayBuffer(b-c));e[0]=d;e.set(a.slice(c+1,b),1);return e}}),null);
__d("readEBMLHeader",["readVINT","$InternalEnum"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function g(a){return a.reduce(function(a,b){return a*256+b},0)}function h(a){return String.fromCharCode.apply(String,Array.from(a))}var i=b("$InternalEnum")({EBML:440786851,EBMLVersion:17030,EBMLReadVersion:17143,EBMLMaxSizeLength:17139,EBMLMaxIDLength:17138,DocType:17026,DocTypeVersion:17031,DocTypeReadVersion:17029});function j(a){var c=b("readVINT")(a,4);if(c==null)return null;var d=g(a.slice(0,c.nextReadOffset));d=i.cast(d);var e=b("readVINT")(a.slice(c.nextReadOffset));if(e==null)return null;var f=g(e.vintData);c=c.nextReadOffset+e.nextReadOffset;e=c+f;if(e>a.length)return null;f=a.slice(c,e);return{id:d,data:f,nextReadOffset:e}}function k(a){a=j(a);if(a==null||a.id!==i.EBML)return null;a=a.data;var b=new Map(),c=j(a);while(c!=null)c.id!=null&&b.set(c.id,c.data),a=a.slice(c.nextReadOffset),c=j(a);return b}function a(a){var b,c=k(new Uint8Array(a));if(c==null)return null;a=function(a,b){a=c.get(a);if(a==null)return null;else return b(a)};var d=a(i.DocType,h);return d==null?null:{ebmlVersion:(b=a(i.EBMLVersion,g))!=null?b:1,ebmlReadVersion:(b=a(i.EBMLReadVersion,g))!=null?b:1,ebmlMaxIDLength:(b=a(i.EBMLMaxIDLength,g))!=null?b:4,ebmlMaxSizeLength:(b=a(i.EBMLMaxSizeLength,g))!=null?b:8,docType:d,docTypeVersion:(b=a(i.DocTypeVersion,g))!=null?b:1,docTypeReadVersion:(d=a(i.DocTypeReadVersion,g))!=null?d:1}}}),null);
__d("isValidMKV",["Promise","readEBMLHeader"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function g(a){a=b("readEBMLHeader")(a);if(a==null)return!1;else return a.ebmlMaxIDLength===4&&a.ebmlMaxSizeLength>=1&&a.ebmlMaxSizeLength<=8&&a.docType==="matroska"}function a(a){return new(b("Promise"))(function(b,c){var d=new FileReader();d.onerror=function(){return c(d.error)};d.onload=function(){var a=d.result;a instanceof ArrayBuffer?b(g(a)):c()};d.readAsArrayBuffer(a)})}}),null);
__d("parseDocForSphericalMetadata",["Comet360PhotoTypes"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=["GPano:CroppedAreaImageHeightPixels","GPano:CroppedAreaImageWidthPixels","GPano:CroppedAreaLeftPixels","GPano:CroppedAreaTopPixels","GPano:FullPanoHeightPixels","GPano:FullPanoWidthPixels","GPano:InitialHorizontalFOVDegrees","GPano:InitialVerticalFOVDegrees","GPano:InitialViewHeadingDegrees","GPano:InitialViewPitchDegrees","GPano:ProjectionType","GPano:UsePanoramaViewer"];function a(a){var b;if(!h(a,"GPano:ProjectionType"))return null;b=(b=a.getElementsByTagName("GPano:ProjectionType")[0].firstChild)==null?void 0:b.nodeValue;if(b!=="equirectangular")return null;b=i();for(var c=0;c<g.length;c++){var d,e=g[c];if(!h(a,e))continue;d=(d=a.getElementsByTagName(e)[0].firstChild)==null?void 0:d.nodeValue;e=e.substr("GPano:".length);isNaN(d)?b[e]=d:b[e]=Number(d)}return k(b)}function h(a,b){a=a.getElementsByTagName(b);return a.length!==0}function i(){return{CroppedAreaImageHeightPixels:0,CroppedAreaImageWidthPixels:0,CroppedAreaLeftPixels:0,CroppedAreaTopPixels:0,FullPanoHeightPixels:0,FullPanoWidthPixels:0,InitialHorizontalFOVDegrees:0,InitialVerticalFOVDegrees:0,InitialViewHeadingDegrees:0,InitialViewPitchDegrees:0,ProjectionType:"equirectangular",UsePanoramaViewer:!0}}function j(a){return a/180*Math.PI}function k(a){var c=a.CroppedAreaImageWidthPixels/a.CroppedAreaImageHeightPixels,d=a.CroppedAreaImageWidthPixels/a.FullPanoWidthPixels*Math.PI*2,e=a.CroppedAreaImageHeightPixels/a.FullPanoHeightPixels*Math.PI*2;(isNaN(c)||c===0)&&(c=2);(isNaN(d)||d===0)&&(d=Math.PI*2);(isNaN(e)||e===0)&&(e=Math.PI*2);var f=a.InitialViewHeadingDegrees,g=a.InitialViewPitchDegrees,h=a.InitialHorizontalFOVDegrees;a=a.InitialVerticalFOVDegrees;c={aspectRatio:c,horizontalFov:d,projectionType:b("Comet360PhotoTypes").Comet360PhotoProjection.Equirectangular,startingView:{heading:j(f),horizontalFov:h!==0?j(h):null,pitch:j(g),verticalFov:a!==0?j(a):null},verticalFov:e};return c}}),null);
__d("usePagesCometComposerMultiMediaRestrictions",["fbt","React","cometPushToast"],(function(a,b,c,d,e,f,g){"use strict";e.exports=a;var h=b("React");function a(a,c){var d=h.useCallback(function(a){a!=null&&a.map(function(a){return c({attachment:a,type:"REMOVE_MEDIA_ATTACHMENT_ITEM"})})},[c]);return h.useCallback(function(){if(a!=null){var c=a.filter(function(a){return a.fileType==="PHOTO"}),e=a.filter(function(a){return a.fileType==="VIDEO"});c.length>0&&e.length>0&&(e.length===1&&e[0].state==="NEW"&&!c.some(function(a){return a.state==="NEW"})?d(c):d(e),b("cometPushToast").cometPushSimpleToast(g._("No puedes agregar fotos y un video al mismo tiempo")));e.length>1&&(d(e.slice(1)),b("cometPushToast").cometPushSimpleToast(g._("Selecciona solo un archivo de video a la vez.")))}},[a,d])}}),null);
__d("CometComposerHeadlessMediaUploaderImpl.react",["Promise","PagesCometComposerContext","React","extractJPEGOrientationData","extractXMPMetadata","genDimensionsFromImageFile","genDimensionsFromVideoFile","genIsHEICFile","gkx","isValidMKV","parseDocForSphericalMetadata","promiseDone","recoverableViolation","requireCond","useCometComposerLoggerDispatcher","usePagesCometComposerMultiMediaRestrictions","cr:1506337"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var c=a.composerUploader,d=a.dispatch,e=a.mediaAttachments,f=a.mediaUploadStatuses,h=a.useOptimisticMediaPost,i=b("useCometComposerLoggerDispatcher")(),j=g.useContext(b("PagesCometComposerContext")),k=b("usePagesCometComposerMultiMediaRestrictions")(e,d),l=g.useCallback(function(a){d(babelHelpers["extends"]({type:"MEDIA_UPLOAD_STARTED"},a)),i({fields:{media_id:a.uploadID},type:"MEDIA_UPLOAD_TRANSFER_START"})},[d,i]),m=g.useCallback(function(a){d(babelHelpers["extends"]({type:"MEDIA_UPLOAD_PROGRESS"},a))},[d]),n=g.useCallback(function(a){var b=f&&f[a.uploadID];b!=null&&b.resolveFileUpload({attachmentID:a.entID,attachmentType:a.attachmentType})},[f]),o=g.useCallback(function(a){d({entID:a.entID,imageURL:a.attachmentType==="PHOTO"?a.imageURL:void 0,type:"MEDIA_UPLOAD_SUCCESSFUL",uploadID:a.uploadID}),i({fields:{media_id:a.uploadID,media_item_fbid:a.entID},type:"MEDIA_UPLOAD_TRANSFER_SUCCESS"}),i({fields:{media_id:a.uploadID,media_item_fbid:a.entID,media_type:a.attachmentType},type:"MEDIA_UPLOAD_SUCCESS"}),i({fields:{media_id:a.uploadID,media_item_fbid:a.entID,media_type:a.attachmentType},type:"MEDIA_UPLOAD_FLOW_SUCCESS"})},[d,i]),p=g.useCallback(function(a){d(babelHelpers["extends"]({type:"MEDIA_UPLOAD_FAILED"},a)),i({fields:{media_id:a.uploadID},type:"MEDIA_UPLOAD_FAILURE"})},[d,i]);g.useEffect(function(){j!=null&&e!=null&&k();c.startedObserver.subscribe(l);c.progressObserver.subscribe(m);c.successObserver.subscribe(o);c.errorObserver.subscribe(p);h&&c.successObserver.subscribe(n);return function(){c.startedObserver.unsubscribe(l),c.progressObserver.unsubscribe(m),c.successObserver.unsubscribe(o),c.errorObserver.unsubscribe(p)}});var q=function(a){return a.state==="CLIENT_PROCESSING_COMPLETE"&&a.fileType!=="UNKNOWN"?[a.file,a.fileType]:null},r=g.useCallback(function(a){var b=a.map(function(a){return a.file&&((a=a.file)==null?void 0:a.uploadID)}).filter(Boolean);d({type:"MARK_UPLOADS_CLIENT_PROCESSING",uploadIDs:b});a.forEach(function(a){var b;return i({fields:{media_id:(b=(b=a.file)==null?void 0:b.uploadID)!=null?b:"",media_type:a.fileType},type:"MEDIA_UPLOAD_PROCESS_START"})})},[d,i]),s=g.useCallback(function(a){var c=a.file;if(c)return b("genIsHEICFile")(c).then(function(e){e&&d({type:"MARK_UPLOADS_AS_PHOTO",uploadIDs:[c==null?void 0:c.uploadID].filter(Boolean)});return b("Promise").resolve(a)});else return b("Promise").resolve(a)},[d]),t=g.useCallback(function(a){var c=a.file;if(c)return b("isValidMKV")(c).then(function(e){e&&d({type:"MARK_UPLOADS_AS_VIDEO",uploadIDs:[c==null?void 0:c.uploadID].filter(Boolean)});return b("Promise").resolve(a)});else return b("Promise").resolve(a)},[d]),u=g.useCallback(function(a){var c=a.file;return c?b("extractJPEGOrientationData")(c).then(function(c){c!=null&&c>0&&d({attachment:a,type:"SET_MEDIA_ATTACHMENT_ITEM_USE_CDN_PREVIEW"});return b("Promise").resolve(a)})["catch"](function(c){b("recoverableViolation")("An error occurred when parsing an uploaded image","comet_composer",{error:c});return b("Promise").resolve(a)}):b("Promise").resolve(a)},[d]),v=g.useCallback(function(a){var c=a.file,e=null;return c?b("extractXMPMetadata")(c).then(function(c){c!=null&&(e=b("parseDocForSphericalMetadata")(c));if(e!=null){d({attachment:a,sphericalEncoding:e,type:"SET_MEDIA_ATTACHMENT_ITEM_SPHERICAL_ENCODING"});return b("Promise").resolve(a)}})["catch"](function(c){b("recoverableViolation")("An error occurred when parsing an uploaded image","comet_composer",{error:c});return b("Promise").resolve(a)}):b("Promise").resolve(a)},[d]),w=g.useCallback(function(a){var c=a.file?a.file:void 0,e=a.fileObjectURL,f;if(e!=null)switch(a.fileType){case"PHOTO":f=b("genDimensionsFromImageFile")(e);break;case"VIDEO":f=b("genDimensionsFromVideoFile")(e);break}else if(c!=null)switch(a.fileType){case"PHOTO":f=b("genDimensionsFromImageFile")(c);break;case"VIDEO":f=b("genDimensionsFromVideoFile")(c);break}else f=b("Promise").resolve({height:0,width:0});if(f!=null)return f.then(function(b){var c=b.height;b=b.width;d({attachment:a,height:c,type:"SET_MEDIA_ATTACHMENT_ITEM_DIMENSIONS",width:b})},function(){d({attachment:a,height:0,type:"SET_MEDIA_ATTACHMENT_ITEM_DIMENSIONS",width:0})})},[d]),x=g.useCallback(function(){var a=(e||[]).map(function(a){return a.state==="NEW"?a:null}).filter(Boolean);a.forEach(function(a){var c=a.file.uploadID;c!=null&&(i({fields:{media_id:c,media_type:a.fileType},type:"MEDIA_UPLOAD_FLOW_START"}),i({fields:{media_id:c,media_type:a.fileType},type:"MEDIA_UPLOAD_START"}));c=[];r([a]);a.fileType==="UNKNOWN"&&a.file?(c.push(s(a)),c.push(t(a))):a.fileType==="PHOTO"&&(c.push(u(a)),c.push(v(a)));c.push(w(a));b("promiseDone")(b("Promise").all(c).then(function(){var b=[a.file.uploadID].filter(Boolean),c=a.fileType;d({type:"MEDIA_ATTACHMENT_CLIENT_PROCESSING_COMPLETED",uploadIDs:b});b.forEach(function(a){return i({fields:{media_id:a,media_type:c},type:"MEDIA_UPLOAD_PROCESS_SUCCESS"})})}))})},[w,s,t,u,v,d,i,r,e]),y=g.useCallback(function(){if(e!=null&&e.some(function(a){return a.state==="CLIENT_PROCESSING_COMPLETE"})){var a=e.filter(function(a){return a.state==="CLIENT_PROCESSING_COMPLETE"}).map(q).filter(Boolean);a.length>0&&(d({type:"QUEUE_UPLOADS",uploadIDs:a.map(function(a){var b=a[0];a[1];return b==null?void 0:b.uploadID}).filter(Boolean)}),c.upload(a))}},[c,d,e]),z=g.useCallback(function(){b("cr:1506337")!==null&&b("cr:1506337")(e,d)},[d,e]);g.useEffect(function(){x(),y(),b("gkx")("1488423")&&z()},[x,y,z]);return null}}),null);
__d("Comet360PhotoEditButton.react",["ix","fbt","CometComposerPushPageContext","CometErrorBoundary.react","FeedComposerCometGlimmer.react","JSResourceForInteraction","React","TetraButton.react","lazyLoadComponent","fbicon","useCometComposerPushPage"],(function(a,b,c,d,e,f,g,h){"use strict";e.exports=a;var i=b("React"),j=b("lazyLoadComponent")(b("JSResourceForInteraction")("Comet360PhotoEditor.react").__setRef("Comet360PhotoEditButton.react"));function a(){var a=b("useCometComposerPushPage")(),c="Edit";return i.jsx(b("TetraButton.react"),{icon:b("fbicon")._(g("477825"),16),label:c,onPress:function(){a&&a(h._("Seleccionar vista inicial"),function(c){c=c.onReturn;return i.jsx(b("CometComposerPushPageContext").Provider,{value:a,children:i.jsx(b("CometErrorBoundary.react"),{fallback:function(){return i.jsx(b("FeedComposerCometGlimmer.react"),{})},children:i.jsx(j,{onBack:c})})})})},type:"overlay"})}}),null);
__d("ComposerMediaDeepDiveAddMediaButton.react",["ix","fbt","React","TetraButton.react","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";e.exports=a;var i=b("React");function a(a){a=a.onClick;return i.jsx(b("TetraButton.react"),{icon:b("fbicon")._(g("481773"),16),label:h._("Agregar fotos\/videos"),onPress:a,reduceEmphasis:!0,type:"secondary"})}}),null);
__d("LocalVideoFilePreview.react",["regeneratorRuntime","React","VideoPlayerPlayButton.react","clearTimeout","generateVideoThumbnails","setTimeout","stylex","useComposerViewStateDispatcher"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React"),h=function(a){var c,d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:c=a.videoPlayer;f.next=3;return b("regeneratorRuntime").awrap(b("generateVideoThumbnails")(c,c.videoWidth?c.videoWidth:0,c.videoHeight?c.videoHeight:0,10,"contain",0,null));case 3:d=f.sent;e=d.thumbnails;return f.abrupt("return",e);case 6:case"end":return f.stop()}},null,this)};function a(a){var c=a.disableHoverPlay,d=a.disablePlayOverlayBtn,e=a.mediaAttachment,f=a.needLoadData,i=a.setVideoRef,j=a.showPlaybackControls,k=a.videoAttachmentMetadata,l=g.useRef(null),m=g.useRef(null);a=g.useState(!1);var n=a[0],o=a[1],p=b("useComposerViewStateDispatcher")();a=function(){m.current!==null&&b("clearTimeout")(m.current),l.current&&l.current.play(),o(!0),j||(m.current=b("setTimeout")(q,1e4))};var q=function(){var a=l.current;a!==null&&(a.pause(),j||(a.currentTime=0));o(!1)},r=function(a){p({type:"SET_VIDEO_ATTACHMENT_METADATA",videoAttachmentMetadata:babelHelpers["extends"]({},k,{generatedThumbnails:a})})},s=function(a){p({type:"SET_VIDEO_ATTACHMENT_METADATA",videoAttachmentMetadata:babelHelpers["extends"]({},k,{isGeneratingThumbnails:a})})},t=function(){var a,c;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:a=l.current;if(!(a!==null)){d.next=11;break}i&&i(a);if(!f){d.next=11;break}s(!0);d.next=7;return b("regeneratorRuntime").awrap(h({videoPlayer:a}));case 7:c=d.sent,a.currentTime=0,r(c),s(!1);case 11:case"end":return d.stop()}},null,this)};return e.fileType!=="FILE"?g.jsxs(g.Fragment,{children:[g.jsx("video",{className:"k4urcfbm r0294ipz datstx6m",controls:j,onClick:function(){o(!0)},onLoadedData:t,onMouseEnter:c?null:a,onMouseLeave:c?null:q,onPause:function(){o(!1)},ref:l,src:e.state!=="NEW"&&e.state!=="CLIENT_PROCESSING"&&e.state!=="CLIENT_PROCESSING_COMPLETE"&&e.fileObjectURL}),g.jsx(b("VideoPlayerPlayButton.react"),{isVisible:!n&&!d,onClick:a})]}):null}}),null);
__d("RemoteVideoFilePreview.react",["CometPlaceholder.react","CometProgressRing.react","CometRelay","PlayableCollageItemOverlay.react","React","RecoverableViolationWithComponentStack.react","VideoPlayerHooks","VideoPlayerRelay.react","VideoPlayerSurface.react","stylex","useDebouncedValue","useVideoPlayerClip","RemoteVideoFilePreviewQuery.graphql"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g,h=b("React");function a(a){a=a.mediaAttachment;a=a.entID;return a==null?null:h.jsx(b("CometPlaceholder.react"),{fallback:h.jsx(j,{}),children:h.jsx(i,{videoID:a})})}function i(a){a=a.videoID;a=b("CometRelay").useLazyLoadQuery(g!==void 0?g:g=b("RemoteVideoFilePreviewQuery.graphql"),{videoID:a});a=a.video;return a==null?h.jsx(b("RecoverableViolationWithComponentStack.react"),{errorMessage:"video should not be null in preview",projectName:"comet_composer"}):h.jsx(b("VideoPlayerRelay.react"),{canAutoplay:"do_not_autoplay",portalingEnabled:!1,subOrigin:"embedded_video_preview",video:a,children:h.jsx(b("VideoPlayerSurface.react"),{children:h.jsx(k,{})})})}function j(){return h.jsx("div",{className:"k4urcfbm pmk7jnqg datstx6m",children:h.jsx(b("CometProgressRing.react"),{color:"dark",duration:5,size:32,type:"estimated"})})}function k(){var a=b("VideoPlayerHooks").useController(),c=b("VideoPlayerHooks").usePaused(),d=b("VideoPlayerHooks").usePlaying();d=b("useDebouncedValue")(d,5);c=c&&!d;b("useVideoPlayerClip")({clipDuration:10,pauseOnLoop:!0});d=function(){a.getCurrentState().paused&&a.play("user_initiated")};var e=function(){a.getCurrentState().playing&&(a.pause("product_initiated"),a.seek(0))};return h.jsx("div",{className:"k4urcfbm pmk7jnqg datstx6m",onMouseEnter:d,onMouseLeave:e,children:c?h.jsx(b("PlayableCollageItemOverlay.react"),{}):null})}}),null);
__d("CometComposerVideoPreview.react",["CollageItemFallback.react","LocalVideoFilePreview.react","React","RemoteVideoFilePreview.react","stylex"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g,h=b("React"),i={imageArea:{height:"djkytl3r"}};function a(a){var c=a.isPlayablePreview;c=c===void 0?!1:c;var d=a.mediaAttachment,e=a.setVideoRef;a=a.videoStyle;if(d.fileType!=="VIDEO")return null;if(d.file&&d.fileObjectURL!=null)if(d.useCDNPreview===!0)return h.jsx("div",{className:(g||(g=b("stylex")))(i.imageArea),children:h.jsx(b("CollageItemFallback.react"),{fileType:d.fileType,filename:d.file.name})});else{var f=(d==null?void 0:d.videoAttachmentMetadata)||{},j=(f==null?void 0:f.generatedThumbnails)||[];j=j&&j.length>0;return h.jsx("div",{className:(g||(g=b("stylex")))(a),children:h.jsx(b("LocalVideoFilePreview.react"),{disableHoverPlay:c,disablePlayOverlayBtn:c&&(f==null?void 0:f.thumbnailType)==="scrubber_selected",mediaAttachment:d,needLoadData:c&&!j,setVideoRef:e,showPlaybackControls:c&&(f==null?void 0:f.thumbnailType)!=="scrubber_selected",videoAttachmentMetadata:f})})}return d.state==="PREEXISTING"?h.jsx("div",{className:(g||(g=b("stylex")))(a),children:h.jsx(b("RemoteVideoFilePreview.react"),{mediaAttachment:d})}):null}}),null);
__d("ComposerMediaDeepDiveCaptionEditor.react",["fbt","CometFormTextArea.react","React","composerMediaAttachmentReducer","useComposerViewStateDispatcher","useComposerViewStateReducer"],(function(a,b,c,d,e,f,g){"use strict";e.exports=a;var h=b("React");function a(a){var c=a.mediaAttachmentItem;b("useComposerViewStateReducer")(b("composerMediaAttachmentReducer"));var d=b("useComposerViewStateDispatcher")();return h.jsx(b("CometFormTextArea.react"),{label:g._("Pie de foto"),maxRows:2,minRows:2,onValueChange:function(a){d({attachment:c,caption:a,type:"SET_MEDIA_ATTACHMENT_CAPTION"})},value:c.fileType==="PHOTO"||c.fileType==="VIDEO"?((a=c.data)==null?void 0:(a=a.message)==null?void 0:a.text)||"":""})}}),null);
__d("ComposerMediaDeepDiveMetadataPill.react",["CometPressable.react","React","TetraIcon.react","TetraText.react","stylex"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var c=g.useState(!1),d=c[0],e=c[1];return g.jsx("div",{children:g.jsx(b("CometPressable.react"),{"aria-label":a.label,onHoverIn:function(){e(!0)},onHoverOut:function(){return e(!1)},onPress:a.onPress,overlayDisabled:!0,children:g.jsxs("div",{className:"pcp91wgn iuny7tx3 p8fzw8mz ipjc6fyt qjjbsfad j83agx80 qrtewk5h lsl2245n hqlzco19 o3c63hce lit7pgxp d6rk862h bp9cbjyn",children:[g.jsx(b("TetraIcon.react"),{color:"white",icon:a.icon}),d||Boolean(a.shouldAlwaysShowLabel)?g.jsx("div",{className:"pcp91wgn buofh1pr rj1gh0hx",children:g.jsx(b("TetraText.react"),{color:"white",type:"body4",children:a.label})}):null]})})})}}),null);
__d("ProductTagComposerPhotoHoverProductIconClickFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1744201");c=b("FalcoLoggerInternal").create("product_tag_composer_photo_hover_product_icon_click",a);e.exports=c}),null);
__d("ComposerMediaDeepDiveTagProducts.react",["ix","fbt","Actor","CometMediaEditorPageResource","ComposerMediaDeepDiveMetadataPill.react","React","fbicon","intlList","lazyLoadComponent","useCometComposerPushPage","withComposerViewStatePart","ProductTagComposerPhotoHoverProductIconClickFalcoEvent"],(function(a,b,c,d,e,f,g,h){"use strict";var i=b("React"),j=b("lazyLoadComponent")(b("CometMediaEditorPageResource"));function a(a){var c=b("useCometComposerPushPage")(),d=a.mediaAttachment.fileType==="PHOTO"?(a.mediaAttachment.data.tags||[]).map(function(a){return a==null?void 0:(a=a.taggee)==null?void 0:a.name}).filter(Boolean):null,e=h._("Etiquetar productos"),f=!1;d&&d.length>0&&(f=!0,e=b("intlList")(d));d=b("Actor").useActor();var k=d[0],l=function(){if(a.mediaAttachment.fileType!=="PHOTO")return;var c=a.mediaAttachment.data.id;b("ProductTagComposerPhotoHoverProductIconClickFalcoEvent").log(function(){return{creation_session_id:a.creationSessionID,creator_id:k,media_id:c,media_type:"photo",platform:"comet",referral_source:"composer"}})};return a.mediaAttachment.fileType==="PHOTO"?i.jsx(b("ComposerMediaDeepDiveMetadataPill.react"),{icon:b("fbicon")._(g("1650379"),12),label:e,onPress:function(){l(),c!=null&&c(h._("Detalles de la foto"),function(b){b=b.onReturn;return i.jsx(j,{index:a.index,initialTool:"PRODUCT_TAG",isDialog:!0,onBack:b})},{hasCustomHeader:!0})},shouldAlwaysShowLabel:f}):null}c=b("withComposerViewStatePart")(a,function(a){return{creationSessionID:a.creationSessionID}});e.exports=c}),null);
__d("ComposerMediaDeepDiveTaggedPeople.react",["ix","fbt","CometMediaEditorPageResource","ComposerMediaDeepDiveMetadataPill.react","React","fbicon","intlList","lazyLoadComponent","useCometComposerPushPage"],(function(a,b,c,d,e,f,g,h){"use strict";e.exports=a;var i=b("React"),j=b("lazyLoadComponent")(b("CometMediaEditorPageResource"));function a(a){var c=b("useCometComposerPushPage")(),d=a.mediaAttachment.fileType==="PHOTO"?(a.mediaAttachment.data.tags||[]).map(function(a){return a==null?void 0:(a=a.taggee)==null?void 0:a.name}).filter(Boolean):null,e=h._("Etiquetar foto"),f=!1;d&&d.length>0&&(f=!0,e=b("intlList")(d));return i.jsx(b("ComposerMediaDeepDiveMetadataPill.react"),{icon:b("fbicon")._(g("502469"),12),label:e,onPress:function(){c!=null&&c(h._("Detalles de la foto"),function(b){b=b.onReturn;return i.jsx(j,{index:a.index,initialTool:"XY_TAG",isDialog:!0,onBack:b})},{hasCustomHeader:!0})},shouldAlwaysShowLabel:f})}}),null);
__d("ComposerMediaDeepDiveUploadFailedItem.react",["CometColumn.react","CometColumnItem.react","CometPickerNullState.react","NullStateMedia","React","TetraNullState.react","stylex"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var c=a.errorMessage;a=a.fileName;return g.jsx("div",{className:"datstx6m j83agx80 gigke590 l36b2tei mvoc3dfa zonuqk10 ljqcmsvz bp9cbjyn",children:g.jsx(b("CometColumn.react"),{align:"center",expanding:!0,verticalAlign:"center",children:g.jsx(b("CometColumnItem.react"),{children:g.jsx(b("TetraNullState.react"),{body:(c=c)!=null?c:"",bodyColor:"negative",headline:a,icon:b("NullStateMedia")})})})})}}),null);
__d("DeepDiveImageFilePreview.react",["BaseImage.react","CometBlurredBackgroundImage.react","React","stylex"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g,h=b("React"),i={image:{height:"datstx6m",objectFit:"r0294ipz",position:"pmk7jnqg",start:"j9ispegn",top:"kr520xx4",width:"k4urcfbm"},root:{backgroundColor:"pgeiv1et",position:"l9j0dhe7"}};function a(a){var c=a.blurredBackground,d=a.fileName,e=a.uri;a=a.xstyle;return h.jsxs("div",{className:(g||(g=b("stylex")))(i.root,a),children:[c===!0&&h.jsx(b("CometBlurredBackgroundImage.react"),{draggable:!1,src:e}),h.jsx(b("BaseImage.react"),{alt:d,draggable:!1,src:e,xstyle:i.image})]})}}),null);
__d("EntPhotoDeepDiveItem.react",["CometRelay","DeepDiveImageFilePreview.react","React","EntPhotoDeepDiveItem_media.graphql"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g,h=b("React");function a(a){var c=a.media;a=babelHelpers.objectWithoutPropertiesLoose(a,["media"]);c=b("CometRelay").useFragment(g!==void 0?g:g=b("EntPhotoDeepDiveItem_media.graphql"),c);c=c==null?void 0:(c=c.image)==null?void 0:c.uri;return c!=null?h.jsx(b("DeepDiveImageFilePreview.react"),babelHelpers["extends"]({uri:c},a)):null}}),null);
__d("EntPhotoDeepDiveItemContainer.react",["CometRelay","EntPhotoDeepDiveItem.react","React","WebPixelRatio","EntPhotoDeepDiveItemContainerQuery.graphql"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g,h=b("React");function a(a){var c=a.fileName,d=a.id;a=a.xstyle;d={id:d,scale:b("WebPixelRatio").get()};d=b("CometRelay").useLazyLoadQuery(g!==void 0?g:g=b("EntPhotoDeepDiveItemContainerQuery.graphql"),d);return h.jsx(b("EntPhotoDeepDiveItem.react"),{blurredBackground:!0,fileName:c,media:d==null?void 0:d.node,xstyle:a})}}),null);
__d("ComposerMediaDeepDiveItem.react",["Actor","CollageItemFallback.react","CometComposerEditMediaAttachmentItemButton.react","CometComposerRemoveMediaAttachmentItemButton.react","CometComposerVideoPreview.react","CometPlaceholder.react","CometRelay","ComposerMediaDeepDiveCaptionEditor.react","ComposerMediaDeepDiveTaggedPeople.react","ComposerMediaDeepDiveTagProducts.react","ComposerMediaDeepDiveUploadFailedItem.react","DeepDiveImageFilePreview.react","EntPhotoDeepDiveItemContainer.react","React","recoverableViolation","requireCond","stylex","useComposerPluginIneligibility","cr:1707168","ComposerMediaDeepDiveItemQuery.graphql"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g,h,i=b("React"),j=(c=b("cr:1707168"))!=null?c:function(a){return null},k={captionArea:{backgroundColor:"cwj9ozl2",paddingTop:"cxgpxx05",paddingEnd:"dflh9lhu",paddingBottom:"sj5x9vvc",paddingStart:"scb9dxdr"},editMediaButton:{position:"pmk7jnqg",start:"rnx8an3s",top:"fcg2cn6m"},failedImageArea:{height:"jh4d4hv6"},imageArea:{height:"djkytl3r"},mediaAndMetadata:{position:"l9j0dhe7"},metadataArea:{bottom:"d2iitwg3",marginEnd:"tvfksri0",position:"pmk7jnqg",start:"rnx8an3s"},removeItemButton:{end:"swmj3c3o",position:"pmk7jnqg",top:"fcg2cn6m"},root:{borderTopStartRadius:"ue3kfks5",borderTopEndRadius:"pw54ja7n",borderBottomEndRadius:"uo3d90p7",borderBottomStartRadius:"l82x9zwi",boxShadow:"ad9n1n66",marginBottom:"sjgh65i0",overflowX:"ni8dbmo4",overflowY:"stjgntxs",position:"l9j0dhe7"}};function a(a){var c,d=a.canUserEditCaption,e=a.itemIndex,f=a.mediaAttachment;a=i.useState(!1);var l=a[0],m=a[1];a=b("Actor").useActor();a=b("CometRelay").useLazyLoadQuery(g!==void 0?g:g=b("ComposerMediaDeepDiveItemQuery.graphql"),{id:a[0]});var n=(a==null?void 0:(a=a.page)==null?void 0:a.has_taggable_products)===!0,o=f.fileType==="VIDEO",p=j([f]),q=b("useComposerPluginIneligibility")().has("MEDIA_EDIT");a=function(a){return i.jsxs("div",{className:(h||(h=b("stylex")))(k.root),onMouseEnter:function(){return m(!0)},onMouseLeave:function(){return m(!1)},children:[i.jsxs("div",{className:h(k.mediaAndMetadata),children:[a,!o&&!q&&i.jsx("div",{className:(h||(h=b("stylex")))(k.metadataArea),children:n===!0?i.jsx(b("ComposerMediaDeepDiveTagProducts.react"),{index:e,mediaAttachment:f}):i.jsx(b("ComposerMediaDeepDiveTaggedPeople.react"),{index:e,mediaAttachment:f})})]}),l?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:(h||(h=b("stylex")))(k.editMediaButton),children:o&&!s?p:i.jsx(b("CometComposerEditMediaAttachmentItemButton.react"),{index:e})}),i.jsx("div",{className:(h||(h=b("stylex")))(k.removeItemButton),children:i.jsx(b("CometComposerRemoveMediaAttachmentItemButton.react"),{attachment:f})})]}):null,d&&!s?i.jsx("div",{className:(h||(h=b("stylex")))(k.captionArea),children:i.jsx(b("ComposerMediaDeepDiveCaptionEditor.react"),{mediaAttachmentItem:f})}):null]})};var r,s;if(f.state==="CLIENT_PROCESSING"||f.state==="CLIENT_PROCESSING_COMPLETE")return i.jsx("div",{className:(h||(h=b("stylex")))(k.imageArea),children:i.jsx(b("CollageItemFallback.react"),{fileType:f.fileType})});else if(f.state==="FAILED"){s=!0;r=i.jsx("div",{className:(h||(h=b("stylex")))(k.failedImageArea),children:i.jsx(b("ComposerMediaDeepDiveUploadFailedItem.react"),{errorMessage:f.error,fileName:f.file.name})});return a(r)}else if(f.state==="PREEXISTING"){var t=i.jsx("div",{className:(h||(h=b("stylex")))(k.imageArea),children:i.jsx(b("CollageItemFallback.react"),{fileType:f.fileType})});switch(f.fileType){case"PHOTO":r=f.entID!=null?i.jsx(b("CometPlaceholder.react"),{fallback:t,children:i.jsx(b("EntPhotoDeepDiveItemContainer.react"),{id:f.entID,xstyle:k.imageArea})}):null;break;case"VIDEO":r=i.jsx(b("CometComposerVideoPreview.react"),{mediaAttachment:f});break;case"UNKNOWN":b("recoverableViolation")("`UNKNOWN` media attachment in composer media deep dive","comet_composer");r=null;break}return a(r)}else if(f.file&&f.fileObjectURL!=null){switch(f.fileType){case"PHOTO":switch(f.useCDNPreview){case!0:t=i.jsx("div",{className:(h||(h=b("stylex")))(k.imageArea),children:i.jsx(b("CollageItemFallback.react"),{fileType:f.fileType,filename:(t=f.file)==null?void 0:t.name,percentComplete:f.state==="UPLOADING"?f.percentComplete:void 0})});switch(f.state){case"UPLOADED":r=f.entID!=null?i.jsx(b("CometPlaceholder.react"),{fallback:t,children:i.jsx(b("EntPhotoDeepDiveItemContainer.react"),{fileName:(c=f.file)==null?void 0:c.name,id:f.entID,xstyle:k.imageArea})}):null;break;default:r=t;break}break;default:r=i.jsx(b("DeepDiveImageFilePreview.react"),{blurredBackground:!0,fileName:(c=f.file)==null?void 0:c.name,uri:f.fileObjectURL,xstyle:k.imageArea})}break;case"VIDEO":f.file.type==="image/gif"?r=i.jsx(b("DeepDiveImageFilePreview.react"),{fileName:f.file.name,uri:f.fileObjectURL,xstyle:k.imageArea}):r=i.jsx(b("CometComposerVideoPreview.react"),{mediaAttachment:f});break;case"FILE":case"UNKNOWN":r=null}return a(r)}else return null}}),null);
__d("ComposerMediaDeepDive.react",["fbt","CometComposerUploadMediaButtonRenderer.react","CometDraggableList.react","CometPickerNullState.react","CometRow.react","CometRowItem.react","CometScrollableArea.react","ComposerMediaDeepDiveAddMediaButton.react","ComposerMediaDeepDiveItem.react","NullStateMedia","React","TetraButton.react","TetraText.react","composerMediaAttachmentReducer","composerMediaAttachmentUtils","gkx","stylex","useComposerValidationErrors","useComposerViewStateDispatcher","useComposerViewStateReducer","withComposerViewStatePart"],(function(a,b,c,d,e,f,g){"use strict";var h,i=b("React"),j=b("gkx")("1663744"),k={error:{display:"j83agx80",justifyContent:"taijpn5t"},items:{backgroundColor:"g6srhlxm",flexGrow:"buofh1pr",flexShrink:"g5gj957u",paddingTop:"discj3wi",paddingEnd:"hv4rvrfc",paddingBottom:"qt6c0cv9",paddingStart:"dati1w0a"},root:{display:"j83agx80",flexDirection:"cbu4d94t",maxHeight:"f0kvp8a6",width:"oh7imozk"},toolbar:{borderTop:"dwg5866k",paddingTop:"pybr56ya",paddingEnd:"ph5uu5jm",paddingBottom:"f10w8fjw",paddingStart:"b3onmgus"}},l=80;function a(a){var c=a.mediaAttachments,d=a.mediaAttachmentsLimit,e=a.popPage;b("useComposerViewStateReducer")(b("composerMediaAttachmentReducer"));var f=b("useComposerViewStateDispatcher")();a=b("useComposerValidationErrors")();a=a.mediaLimit;d=(d=d)!=null?d:l;a=a!=null?i.jsxs(b("TetraText.react"),{color:"negative",type:"bodyLink4",children:[c==null?void 0:c.length,"/",d]}):null;d=i.useCallback(function(a,b,c){f({sourceIndex:b,targetIndex:c,type:"REORDER_MEDIA_ATTACHMENT_ITEM"})},[f]);var m=c||[];return i.jsxs("div",{className:(h||(h=b("stylex")))(k.root),children:[m.length===0?i.jsx(b("CometPickerNullState.react"),{body:g._("Agrega una foto o un video para empezar"),icon:b("NullStateMedia")}):i.jsx(b("CometScrollableArea.react"),{horizontal:!1,xstyle:k.items,children:i.jsx(b("CometDraggableList.react"),{items:m.map(function(a,c){return a.file||a.useCDNPreview?i.jsx(b("ComposerMediaDeepDiveItem.react"),{canUserEditCaption:!j||m.length>1,itemIndex:c,mediaAttachment:a},"media-"+(b("composerMediaAttachmentUtils").getIDFromMediaAttachment(a)||c)):null}).filter(Boolean),onReorder:d})}),i.jsx("div",{className:h(k.toolbar),children:i.jsxs(b("CometRow.react"),{align:"end",paddingTop:0,children:[b("gkx")("1733966")&&a!=null&&i.jsx(b("CometRowItem.react"),{expanding:!0,xstyle:k.error,children:a}),i.jsx(b("CometRowItem.react"),{children:i.jsx(b("CometComposerUploadMediaButtonRenderer.react"),{Button:b("ComposerMediaDeepDiveAddMediaButton.react")})}),i.jsx(b("CometRowItem.react"),{children:i.jsx(b("TetraButton.react"),{label:g._("Listo"),onPress:function(){e()},padding:"wide",type:"primary"})})]})})]})}c=b("withComposerViewStatePart")(a,function(a){return{mediaAttachments:a.mediaAttachments,mediaAttachmentsLimit:a.mediaAttachmentsLimit}});e.exports=c}),null);
__d("ComposerCometOpenMediaDeepDiveButton.react",["ix","fbt","CometComposerPushPageContext","ComposerMediaDeepDive.react","React","TetraButton.react","fbicon","useCometComposerPushPage"],(function(a,b,c,d,e,f,g,h){"use strict";e.exports=a;var i=b("React");function a(a){a=a.buttonLabel;a=a===void 0?h._("Editar todo"):a;var c=b("useCometComposerPushPage")();return i.jsx(b("TetraButton.react"),{icon:b("fbicon")._(g("477825"),16),label:a,onPress:function(){c&&c(h._("Fotos\/videos"),function(a){a=a.onReturn;return i.jsx(b("CometComposerPushPageContext").Provider,{value:c,children:i.jsx(b("ComposerMediaDeepDive.react"),{popPage:a})})})},type:"overlay"})}}),null);
__d("ComposerCometEditMediaActionsOverlay.react",["ix","fbt","Comet360PhotoEditButton.react","CometComposerEditMediaAttachmentItemButton.react","CometComposerEditVideoButtonWithNux.react","CometFileSelector.react","CometRow.react","CometRowItem.react","ComposerCometOpenMediaDeepDiveButton.react","React","TetraButton.react","fbicon","gkx","requireCond","stylex","useComposerPluginIneligibility","useComposerViewStateDispatcher","cr:1613921","cr:1707168"],(function(a,b,c,d,e,f,g,h){"use strict";e.exports=a;var i,j=b("React"),k=(c=b("cr:1707168"))!=null?c:function(a){return null},l={buttonLayer:{backgroundColor:"rsx06lma",height:"datstx6m",opacity:"b5wmifdl",paddingTop:"pybr56ya",position:"pmk7jnqg",start:"j9ispegn",top:"kr520xx4",width:"k4urcfbm"},buttonLayerVisible:{opacity:"pedkr2u6"}};function a(a){var c=a.accept,d=a.inComposer,e=a.mediaAttachments,f=a.showButtons;a=a.videoLiteComposerEligible;var m=b("useComposerViewStateDispatcher")(),n=function(a){a.length>0&&m({files:Array.from(a),type:"ADD_MEDIA_ATTACHMENT_ITEMS"})},o=e.length===1&&e[0].fileType==="VIDEO",p=a&&o,q=e.length===1&&e[0].fileType==="PHOTO"&&e[0].sphericalEncoding!=null,r=b("useComposerPluginIneligibility")().has("MEDIA_EDIT"),s=j.useMemo(function(){if(e.length>1)return j.jsx(b("ComposerCometOpenMediaDeepDiveButton.react"),{});if(r)return null;if(o)return p?j.jsx(b("CometComposerEditVideoButtonWithNux.react"),{}):null;return q&&b("gkx")("1750713")?j.jsx(b("Comet360PhotoEditButton.react"),{}):j.jsx(b("CometComposerEditMediaAttachmentItemButton.react"),{index:0})},[e.length,r,o,q,p]),t=k(e);return j.jsx(b("CometFileSelector.react"),{accept:c,multiple:!0,onFilesSelected:n,children:function(a){return d&&j.jsx("div",{className:(i||(i=b("stylex")))([l.buttonLayer,(p||f)&&l.buttonLayerVisible]),children:j.jsxs(b("CometRow.react"),{align:"start",paddingTop:0,children:[s&&j.jsx(b("CometRowItem.react"),{children:s}),p?null:j.jsx(b("CometRowItem.react"),{children:j.jsx(b("TetraButton.react"),{icon:b("fbicon")._(g("481773"),16),label:h._("Agregar fotos\/videos"),onPress:a,type:"overlay"})}),b("cr:1613921")?j.jsx(b("CometRowItem.react"),{children:j.jsx(b("cr:1613921"),{})}):null,t&&j.jsx(b("CometRowItem.react"),{children:t})]})})}})}}),null);
__d("CometComposerPhotoLayoutItem.react",["CometBackgroundImage.react","CometComposerFocusImage.react","CometPhotoLayoutMediaOverlay.react","ComposerCometPhotoLayoutMediaAttachmentContext","React"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var c=a.alt,d=a.height,e=a.numPhotosNotShown,f=a.onError,h=a.shouldShowOverlay,i=a.src,j=a.viewportAspectRatio;a=a.width;var k=g.useContext(b("ComposerCometPhotoLayoutMediaAttachmentContext")),l=k.focusX;k=k.focusY;if(d==null||a==null)return g.jsx(b("CometBackgroundImage.react"),{draggable:!1,src:i});else return g.jsxs(g.Fragment,{children:[g.jsx(b("CometComposerFocusImage.react").CometComposerFocusImage,{alt:c,focusX:l,focusY:k,imageHeight:d,imageWidth:a,onError:f,src:i,viewportAspectRatio:j}),h===!0&&e!=null?g.jsx(b("CometPhotoLayoutMediaOverlay.react"),{numItemsNotShown:e}):null]})}}),null);
__d("ComposerCometSelectedPhotoLayoutContext",["React"],(function(a,b,c,d,e,f){"use strict";a=b("React");c={layout:"classic"};d=a.createContext(c);e.exports=d}),null);
__d("EntPhotoCollageItem.react",["CometBackgroundImage.react","CometComposerPhotoLayoutItem.react","CometRelay","ComposerCometPhotoLayoutMediaAttachmentContext","ComposerCometSelectedPhotoLayoutContext","React","composerMediaAttachmentReducer","useComposerViewStateDispatcher","useComposerViewStateReducer","EntPhotoCollageItem_media.graphql"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g,h=b("React");function a(a){var c;b("useComposerViewStateReducer")(b("composerMediaAttachmentReducer"));var d=b("useComposerViewStateDispatcher")(),e=b("CometRelay").useFragment(g!==void 0?g:g=b("EntPhotoCollageItem_media.graphql"),a.media);h.useEffect(function(){var b,c;b=e==null?void 0:(b=e.image)==null?void 0:b.height;c=e==null?void 0:(c=e.image)==null?void 0:c.width;b!=null&&c!=null&&d({entID:a.id,height:b,type:"SET_MEDIA_ATTACHMENT_ITEM_CDN_DIMENSIONS",width:c})},[e,d,a.id]);c=e==null?void 0:(c=e.image)==null?void 0:c.uri;var f=h.useContext(b("ComposerCometSelectedPhotoLayoutContext")),i=h.useContext(b("ComposerCometPhotoLayoutMediaAttachmentContext")),j=i.numPhotosNotShown,k=i.setFocusX,l=i.setFocusY,m=i.shouldShowOverlay;i=i.viewportAspectRatio;var n=e==null?void 0:e.image,o=n==null?void 0:n.height;n=n==null?void 0:n.width;var p=e==null?void 0:e.focus,q=p==null?void 0:p.x,r=p==null?void 0:p.y;h.useEffect(function(){k&&l&&q!=null&&r!=null&&(k(q),l(r))},[k,l,q,r]);if(c==null)return null;else if(!!f.layout&&f.layout!=="classic")return h.jsx(b("CometComposerPhotoLayoutItem.react"),{height:o,numPhotosNotShown:j,shouldShowOverlay:m,src:c,viewportAspectRatio:i,width:n});else return h.jsx(b("CometBackgroundImage.react"),{draggable:!1,src:c})}}),null);
__d("EntPhotoCollageItemContainer.react",["CometRelay","EntPhotoCollageItem.react","React","WebPixelRatio","EntPhotoCollageItemContainerQuery.graphql"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g,h=b("React");function a(a){var c=b("CometRelay").useLazyLoadQuery(g!==void 0?g:g=b("EntPhotoCollageItemContainerQuery.graphql"),{id:a.id,scale:b("WebPixelRatio").get()});return h.jsx(b("EntPhotoCollageItem.react"),{id:a.id,media:c==null?void 0:c.node})}}),null);
__d("CDNPreviewPhotoCollageItem.react",["CollageItemFallback.react","CometPlaceholder.react","EntPhotoCollageItemContainer.react","React"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var c=a.entID,d=a.filename,e=a.fileType;a=a.percentComplete;e=g.jsx(b("CollageItemFallback.react"),{fileType:e,filename:d,percentComplete:a});if(c!=null)return g.jsx(b("CometPlaceholder.react"),{fallback:e,children:g.jsx(b("EntPhotoCollageItemContainer.react"),{id:c})});else return e}}),null);
__d("OptimisticallyUploadedPhotoCollageItem.react",["CDNPreviewPhotoCollageItem.react","CometBackgroundImage.react","JSResourceForInteraction","PlayableCollageItemOverlay.react","React","composerMediaAttachmentReducer","lazyLoadComponent","useComposerViewStateDispatcher","useComposerViewStateReducer"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React"),h=b("lazyLoadComponent")(b("JSResourceForInteraction")("CometComposerSphericalMediaGyroIndicator.react").__setRef("OptimisticallyUploadedPhotoCollageItem.react"));function a(a){var c=a.attachment;b("useComposerViewStateReducer")(b("composerMediaAttachmentReducer"));var d=b("useComposerViewStateDispatcher")();a=c.sphericalEncoding?g.jsx(h,{}):null;return c.fileObjectURL!=null&&c.useCDNPreview!==!0?g.jsxs(g.Fragment,{children:[g.jsx(b("CometBackgroundImage.react"),{draggable:!1,onError:function(){d({attachment:c,type:"SET_MEDIA_ATTACHMENT_ITEM_USE_CDN_PREVIEW"})},src:c.fileObjectURL}),c.fileType==="VIDEO"?g.jsx(b("PlayableCollageItemOverlay.react"),{}):null,a]}):g.jsxs(g.Fragment,{children:[g.jsx(b("CDNPreviewPhotoCollageItem.react"),{entID:c.entID,fileType:c.fileType,filename:c.fileName,percentComplete:c.percentComplete}),a]})}}),null);
__d("OptimisticallyUploadedVideoCollageItem.react",["CDNPreviewPhotoCollageItem.react","CircularProgressBar.react","PlayableCollageItemOverlay.react","React","composerMediaAttachmentReducer","stylex","useComposerViewStateDispatcher","useComposerViewStateReducer"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var c=a.attachment;b("useComposerViewStateReducer")(b("composerMediaAttachmentReducer"));var d=b("useComposerViewStateDispatcher")();a=c.fileObjectURL;var e=c.percentComplete;return c.fileObjectURL!=null&&c.useCDNPreview!==!0?g.jsxs(g.Fragment,{children:[g.jsx("video",{className:"k4urcfbm bixrwtb6 datstx6m",onLoadedMetadata:function(a){a.target.videoWidth===0&&a.target.videoHeight===0&&d({attachment:c,type:"SET_MEDIA_ATTACHMENT_ITEM_USE_CDN_PREVIEW"})},src:a}),g.jsx(b("PlayableCollageItemOverlay.react"),{}),e!=null&&g.jsx(b("CircularProgressBar.react"),{percentComplete:e*100})]}):g.jsx(b("CDNPreviewPhotoCollageItem.react"),{fileType:c.fileType,filename:c.fileName,percentComplete:c.percentComplete})}}),null);
__d("OptimisticallyUploadedCollageItem.react",["OptimisticallyUploadedPhotoCollageItem.react","OptimisticallyUploadedVideoCollageItem.react","React"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){a=a.attachment;var c=a.fileType==="PHOTO"||a.fileType==="UNKNOWN"||a.fileType==="VIDEO"&&a.fileMimeType==="image/gif";return c?g.jsx(b("OptimisticallyUploadedPhotoCollageItem.react"),{attachment:a}):g.jsx(b("OptimisticallyUploadedVideoCollageItem.react"),{attachment:a})}}),null);
__d("PreexistingPhotoLayoutItem.react",["CDNPreviewPhotoCollageItem.react","CometPlaceholder.react","JSResourceForInteraction","React","composerMediaAttachmentReducer","lazyLoadComponent","useComposerViewStateReducer"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React"),h=b("lazyLoadComponent")(b("JSResourceForInteraction")("CometComposerSphericalMediaGyroIndicator.react").__setRef("PreexistingPhotoLayoutItem.react"));function a(a){a=a.attachment;b("useComposerViewStateReducer")(b("composerMediaAttachmentReducer"));var c=a.sphericalEncoding?g.jsx(b("CometPlaceholder.react"),{fallback:null,children:g.jsx(h,{})}):null;return g.jsxs(g.Fragment,{children:[g.jsx(b("CDNPreviewPhotoCollageItem.react"),{entID:a.entID,fileType:a.fileType,filename:null}),c]})}}),null);
__d("PreexistingPhotoCollageItem.react",["CometBackgroundImage.react","PreexistingPhotoLayoutItem.react","React"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){a=a.attachment;return a.fileType!=="UNKNOWN"?g.jsx(b("PreexistingPhotoLayoutItem.react"),{attachment:a}):g.jsx(b("CometBackgroundImage.react"),{draggable:!1,src:a.url})}}),null);
__d("UploadingOrUploadedPhotoCollageItem.react",["CDNPreviewPhotoCollageItem.react","CometBackgroundImage.react","CometPlaceholder.react","JSResourceForInteraction","PlayableCollageItemOverlay.react","React","composerMediaAttachmentReducer","lazyLoadComponent","useComposerViewStateDispatcher","useComposerViewStateReducer"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React"),h=b("lazyLoadComponent")(b("JSResourceForInteraction")("CometComposerSphericalMediaGyroIndicator.react").__setRef("UploadingOrUploadedPhotoCollageItem.react"));function a(a){var c=a.attachment;b("useComposerViewStateReducer")(b("composerMediaAttachmentReducer"));var d=b("useComposerViewStateDispatcher")();a=c.sphericalEncoding?g.jsx(b("CometPlaceholder.react"),{fallback:null,children:g.jsx(h,{})}):null;var e=c.file;return c.fileObjectURL!=null&&c.useCDNPreview!==!0?g.jsxs(g.Fragment,{children:[g.jsx(b("CometBackgroundImage.react"),{alt:e.name,draggable:!1,onError:function(){d({attachment:c,type:"SET_MEDIA_ATTACHMENT_ITEM_USE_CDN_PREVIEW"})},src:c.fileObjectURL}),c.fileType==="VIDEO"?g.jsx(b("PlayableCollageItemOverlay.react"),{}):null,a]}):g.jsxs(g.Fragment,{children:[g.jsx(b("CDNPreviewPhotoCollageItem.react"),{entID:c.state==="UPLOADED"?c.entID:void 0,fileType:c.fileType,filename:e.name}),a]})}}),null);
__d("UploadingOrUploadedPhotoLayoutItem.react",["CDNPreviewPhotoCollageItem.react","CometComposerPhotoLayoutItem.react","CometPlaceholder.react","ComposerCometPhotoLayoutMediaAttachmentContext","JSResourceForInteraction","React","composerMediaAttachmentReducer","lazyLoadComponent","useComposerViewStateDispatcher","useComposerViewStateReducer"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React"),h=b("lazyLoadComponent")(b("JSResourceForInteraction")("CometComposerSphericalMediaGyroIndicator.react").__setRef("UploadingOrUploadedPhotoLayoutItem.react")),i=500,j=261;function a(a){var c=a.attachment;b("useComposerViewStateReducer")(b("composerMediaAttachmentReducer"));var d=b("useComposerViewStateDispatcher")();a=c.sphericalEncoding?g.jsx(b("CometPlaceholder.react"),{fallback:null,children:g.jsx(h,{})}):null;var e=function(){d({attachment:c,type:"SET_MEDIA_ATTACHMENT_ITEM_USE_CDN_PREVIEW"})},f=c.width!=null?c.width:null,k=c.height!=null?c.height:null;(f==null||k==null)&&(f=i,k=j);var l=g.useContext(b("ComposerCometPhotoLayoutMediaAttachmentContext")),m=l.numPhotosNotShown,n=l.shouldShowOverlay;l=l.viewportAspectRatio;var o=c.file;if(c.useCDNPreview!==!0&&c.fileObjectURL!=null)return g.jsxs("div",{children:[g.jsx(b("CometComposerPhotoLayoutItem.react"),{alt:o.name,height:k,numPhotosNotShown:m,onError:e,shouldShowOverlay:n,src:c.fileObjectURL,viewportAspectRatio:l,width:f}),a]});else return g.jsxs(g.Fragment,{children:[g.jsx(b("CDNPreviewPhotoCollageItem.react"),{entID:c.state==="UPLOADED"?c.entID:void 0,fileType:c.fileType,filename:o.name}),a]})}}),null);
__d("CDNPreviewVideoCollageItem.react",["CollageItemFallback.react","React"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var c=a.filename;a=a.fileType;return g.jsx(b("CollageItemFallback.react"),{fileType:a,filename:c})}}),null);
__d("CometVideoEditorUtils.react",[],(function(a,b,c,d,e,f){"use strict";var g=function(a){if(!a||!a.length)return null;for(var a=a,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;switch(d.state){case"UPLOADING":switch(d.fileType){case"VIDEO":return d;default:}break;case"UPLOADED":switch(d.fileType){case"VIDEO":return d;default:}break;default:}}return null};f.getFirstVideoAttachment=g;a=function(a){if(!a)return null;a=g(a.mediaAttachments);return(a==null?void 0:a.videoAttachmentMetadata)||null};f.getVideoAttachmentMetaDataFromComposerState=a;b=function(a){if(a.fileType==="VIDEO"&&a.state==="UPLOADED"){return(a==null?void 0:(a=a.videoAttachmentMetadata)==null?void 0:a.thumbnailPreviewURL)||""}return""};f.getThumbnailURLFromVideoMetadata=b}),null);
__d("UploadingOrUploadedVideoCollageItem.react",["CDNPreviewVideoCollageItem.react","CometVideoEditorUtils.react","PlayableCollageItemOverlay.react","React","stylex"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){a=a.attachment;if(a.fileType==="VIDEO"){var c=a.file,d=b("CometVideoEditorUtils.react").getThumbnailURLFromVideoMetadata(a);return a.fileObjectURL!=null&&a.useCDNPreview!==!0?g.jsxs(g.Fragment,{children:[g.jsx("video",{className:"k4urcfbm bixrwtb6 datstx6m",poster:d,src:a.fileObjectURL}),g.jsx(b("PlayableCollageItemOverlay.react"),{})]}):g.jsx(b("CDNPreviewVideoCollageItem.react"),{entID:a.state==="UPLOADED"?a.entID:void 0,fileType:a.fileType,filename:c.name})}else return null}}),null);
__d("UploadingOrUploadedCollageItem.react",["ComposerCometSelectedPhotoLayoutContext","React","UploadingOrUploadedPhotoCollageItem.react","UploadingOrUploadedPhotoLayoutItem.react","UploadingOrUploadedVideoCollageItem.react"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){a=a.attachment;var c=a.fileType==="PHOTO"||a.fileType==="VIDEO"&&a.file.type==="image/gif",d=g.useContext(b("ComposerCometSelectedPhotoLayoutContext"));d=!!d.layout&&d.layout!=="classic";if(c)return d?g.jsx(b("UploadingOrUploadedPhotoLayoutItem.react"),{attachment:a}):g.jsx(b("UploadingOrUploadedPhotoCollageItem.react"),{attachment:a});else return g.jsx(b("UploadingOrUploadedVideoCollageItem.react"),{attachment:a})}}),null);
__d("CometComposerMediaAttachmentItem.react",["CollageItemFallback.react","CometBackgroundImage.react","CometComposerRemoveMediaAttachmentItemButton.react","CometPlaceholder.react","JSResourceForInteraction","OptimisticallyUploadedCollageItem.react","PlayableCollageItemOverlay.react","PreexistingPhotoCollageItem.react","React","TetraText.react","UploadingOrUploadedCollageItem.react","lazyLoadComponent","stylex"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React"),h=b("lazyLoadComponent")(b("JSResourceForInteraction")("CometComposerSphericalMediaGyroIndicator.react").__setRef("CometComposerMediaAttachmentItem.react"));function a(a){var c=a.attachment;a=a.withRemoveButton;var d=a===void 0?!0:a;a=c.sphericalEncoding?g.jsx(b("CometPlaceholder.react"),{fallback:null,children:g.jsx(h,{})}):null;var e=function(a){return d?g.jsx(b("CometComposerRemoveMediaAttachmentItemButton.react"),{attachment:a}):null};switch(c.state){case"PREEXISTING":var f;switch(c.fileType){case"VIDEO":f=g.jsxs(g.Fragment,{children:[g.jsx(b("CometBackgroundImage.react"),{draggable:!1,src:c.imageURL}),g.jsx(b("PlayableCollageItemOverlay.react"),{}),a]});break;case"PHOTO":f=g.jsx(b("PreexistingPhotoCollageItem.react"),{attachment:c});break;default:f=g.jsxs(g.Fragment,{children:[g.jsx(b("CometBackgroundImage.react"),{draggable:!1,src:c.url}),a]});break}return g.jsxs(g.Fragment,{children:[f,e(c)]});case"NEW":case"CLIENT_PROCESSING":case"CLIENT_PROCESSING_COMPLETE":return g.jsxs(g.Fragment,{children:[g.jsx(b("CollageItemFallback.react"),{fileType:c.fileType,filename:c.file.name}),a]});case"QUEUED":case"UPLOADING":case"UPLOADED":return c.file==null?null:g.jsxs(g.Fragment,{children:[g.jsx(b("UploadingOrUploadedCollageItem.react"),{attachment:c}),c.state==="UPLOADED"?e(c):g.jsx("div",{className:"g7nl5sj3 kr520xx4 pmk7jnqg datstx6m n7fi1qx3 m96f97by",style:{width:(1-(c.percentComplete||0))*100+"%"},children:e(c)})]});case"FAILED":return g.jsxs(g.Fragment,{children:[c.file.name,c.error!=null?g.jsxs(g.Fragment,{children:[g.jsx("br",{}),g.jsx(b("TetraText.react"),{color:"negative",type:"body4",children:c.error})]}):null]});case"OPTIMISTIC_UPLOADED":return c.fileObjectURL==null?null:g.jsx(b("OptimisticallyUploadedCollageItem.react"),{attachment:c});default:return null}}}),null);
__d("CometComposerMediaAttachmentItemContainer.react",["CometComposerMediaAttachmentItem.react","React","qex","stylex"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g,h=b("React"),i=b("qex")._("1138950");function a(a){var c=h.jsx(b("CometComposerMediaAttachmentItem.react"),babelHelpers["extends"]({},a));return c?h.jsx("div",{className:(g||(g=b("stylex"))).dedupe({"overflow-wrap-1":"jm1wdb64","position-1":"l9j0dhe7"},a.attachment.state==="failed"?{"border-top-color-0.4":"jw3uvs1e","border-end-color-0.4":"hmw3o7ox","border-bottom-color-0.4":"ku5f423u","border-start-color-0.4":"a64ryyup"}:null,i===!0?{"height-1":"datstx6m","width-1":"k4urcfbm"}:{"border-top-0.3":"dwg5866k","border-end-0.3":"ccnbzhu1","border-bottom-0.3":"eip75gnj","border-start-0.3":"tr4kgdav","flex-grow-1":"kb5gq1qc","flex-shrink-1":"pfnyh3mw","height-1":"qzj7cv8z","margin-top-1":"rs0gx3tq","margin-end-1":"fv0vnmcu","margin-bottom-1":"dicw6rsg","margin-start-1":"ggphbty4","width-1":"gjzvkazv","border-top-color-0.4":null,"border-bottom-color-0.4":null}),children:c}):null}}),null);
__d("useMediaCollage",["CollageLayoutConfig","CometFeedStoryMediaLayoutConstants","React","ReactComposerCollageLayoutSelection"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a,c,d){var e=g.useState(null),f=e[0],h=e[1];e=g.useRef(new Map());a=a.reduce(function(b,c,a){c.width!=null&&c.height!=null?b.set(a,[c.width,c.height]):b.set(a,[0,0]);return b},new Map());if(a.size!==e.current.size)e.current=a;else{var i=!1;for(var j=a,k=Array.isArray(j),l=0,j=k?j:j[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var m;if(k){if(l>=j.length)break;m=j[l++]}else{l=j.next();if(l.done)break;m=l.value}m=m;var n=m[0];m=m[1];var o=m[0];m=m[1];n=e.current.get(n)||[void 0,void 0];var p=n[0];n=n[1];i=i||o!==p||m!==n}i&&(e.current=a)}var q=e.current,r=g.useCallback(function(){if(q.size===1){var a=q.get(0)||[400,400];a=Math.max(a[0]/a[1],b("CometFeedStoryMediaLayoutConstants").DEFAULT_MIN_ASPECT_RATIO);h(new(b("CollageLayoutConfig"))([{height:1,width:1,x:0,y:0}],c,d,c/a))}else if(q.size>1){a=b("ReactComposerCollageLayoutSelection").getBestUserCollageLayout(q);var e=[];a.forEach(function(a,b){e.push({height:a.getHeight(),width:a.getWidth(),x:a.getLeft(),y:a.getTop()})});h(new(b("CollageLayoutConfig"))(e,c,d))}else h(null)},[c,q,d]);g.useEffect(function(){q.size>0&&r()},[r,q]);return f}}),null);
__d("ComposerCometMediaAttachmentClassicLayout.react",["fbt","CometComposerHeadlessMediaUploader.react","CometComposerMediaAttachmentItemContainer.react","CometPlaceholder.react","React","composerMediaAttachmentReducer","stylex","useComposerViewStateReducer","useMediaCollage"],(function(a,b,c,d,e,f,g){"use strict";e.exports=a;var h=b("React"),i=5;c=500;d=16;f=1;var j=c-d*2-f*2,k=466;function a(a){var c=a.mediaAttachments,d=a.mediaUploadLoggingMetadata,e=a.width;e=e===void 0?j:e;a=a.withoutUploader;e=b("useMediaCollage")(c,e,2);var f=e!=null?e.getItemStyleInfos():[],l=(c||[]).length-f.length;b("useComposerViewStateReducer")(b("composerMediaAttachmentReducer"));return h.jsxs("div",{style:{height:e!=null?e.getCalculatedHeight()+"px":k},children:[a!==!0&&h.jsx(b("CometPlaceholder.react"),{fallback:null,children:h.jsx(b("CometComposerHeadlessMediaUploader.react"),{mediaUploadLoggingMetadata:d})}),f.map(function(a,d){var e=(c||[])[d];if(e==null)return null;var f=d===i-1&&l>0;return h.jsxs("div",{className:"pmk7jnqg stjgntxs ni8dbmo4 taijpn5t j83agx80 bp9cbjyn","data-testid":void 0,style:a,children:[h.jsx(b("CometComposerMediaAttachmentItemContainer.react"),{attachment:e,withRemoveButton:!1},"media-"+d),f?h.jsx("div",{className:"kr520xx4 j9ispegn pmk7jnqg taijpn5t cbu4d94t n7fi1qx3 j83agx80 i09qtzwb sx5rzos5 bp9cbjyn",children:h.jsx("div",{className:"oqcyycmt lrazzd5p mhxlubs3 qrtewk5h",children:g._("+{num}",[g._param("num",l+1)])})}):null]},"media-"+d+"-container")})]})}}),null);
__d("ComposerCometMediaAttachmentCollageLayoutRenderer.react",["ComposerCometMediaAttachmentClassicLayout.react","React","gkx","requireCond","stylex","unrecoverableViolation","cr:1661928","cr:1674490"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var c=a.selectedPhotoLayout,d=babelHelpers.objectWithoutPropertiesLoose(a,["selectedPhotoLayout"]);a=b("gkx")("1609581");var e=function(){return g.jsx(b("ComposerCometMediaAttachmentClassicLayout.react"),babelHelpers["extends"]({},d))};if(!c||!a)return e();switch(c){case"classic":return e();case"columns":if(b("cr:1661928"))return g.jsx(b("cr:1661928"),{mediaAttachments:d.mediaAttachments});else throw new(b("unrecoverableViolation"))("ComposerCometMediaAttachmentCollageLayoutRenderer was unable to render Column Photo Layout","comet_composer");case"banner":return h(c);case"frame":if(b("cr:1674490"))return g.jsx(b("cr:1674490"),{mediaAttachments:d.mediaAttachments});else throw new(b("unrecoverableViolation"))("ComposerCometMediaAttachmentCollageLayoutRenderer was unable to render Frame Photo Layout","comet_composer");default:c;throw b("unrecoverableViolation")("photo layout not supported in ComposerCometMediaAttachmentCollageLayoutRenderer","comet_composer")}}function h(a){return g.jsx("div",{className:"sgwjjusx",children:a})}}),null);
__d("ComposerCometMediaAttachmentCollage.react",["ComposerCometEditMediaActionsOverlay.react","ComposerCometMediaAttachmentCollageLayoutRenderer.react","React","composerMediaAttachmentReducer","fileInputAcceptValues","stylex","useComposerViewStateReducer"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g,h=b("React");function a(a){var c=a.disableVideoUploads,d=a.inComposer,e=a.mediaAttachments,f=a.mediaUploadLoggingMetadata,i=a.removeBorderRadiusBottomStyle;i=i===void 0?!1:i;var j=a.selectedPhotoLayout,k=a.videoLiteComposerEligible;k=k===void 0?!1:k;var l=a.width;a=a.withoutUploader;var m=h.useState(!1),n=m[0],o=m[1];m=h.useState(!1);var p=m[0],q=m[1];b("useComposerViewStateReducer")(b("composerMediaAttachmentReducer"));m=c!==!0?b("fileInputAcceptValues").PHOTO_AND_VIDEO:b("fileInputAcceptValues").PHOTO;return h.jsxs("div",{className:(g||(g=b("stylex"))).dedupe({"border-top-start-radius-1":"ue3kfks5","border-top-end-radius-1":"pw54ja7n","border-bottom-end-radius-1":"uo3d90p7","border-bottom-start-radius-1":"l82x9zwi","overflow-x-1":"ni8dbmo4","overflow-y-1":"stjgntxs","position-1":"l9j0dhe7","width-1":"k4urcfbm"},d?null:{"border-top-0.3":"qu0x051f","border-end-0.3":"esr5mh6w","border-bottom-0.3":"e9989ue4","border-start-0.3":"r7d6kgcz","border-top-start-radius-1":"monazrh9","border-top-end-radius-1":"h905i5nu","border-bottom-end-radius-1":"jinzq4gt","border-bottom-start-radius-1":"mrjvor2e"},i?{"border-bottom-end-radius-1":"jinzq4gt","border-bottom-start-radius-1":"mrjvor2e"}:null),onBlur:function(){return o(!1)},onFocus:function(){return o(!0)},onMouseEnter:function(){return q(!0)},onMouseLeave:function(){return q(!1)},children:[h.jsx(b("ComposerCometMediaAttachmentCollageLayoutRenderer.react"),{inComposer:d,mediaAttachments:e,mediaUploadLoggingMetadata:f,selectedPhotoLayout:j,width:l,withoutUploader:a}),h.jsx(b("ComposerCometEditMediaActionsOverlay.react"),{accept:m,inComposer:d,mediaAttachments:e,showButtons:n||p,videoLiteComposerEligible:k})]})}}),null);
__d("makeMediaAttachmentReadyForPreview",[],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a){switch(a.state){case"NEW":case"CLIENT_PROCESSING":switch(a.fileType){case"PHOTO":return{data:a.data,file:a.file,fileObjectURL:a.fileObjectURL,fileType:"PHOTO",sphericalEncoding:a.sphericalEncoding,state:"CLIENT_PROCESSING",useCDNPreview:a.useCDNPreview};case"VIDEO":return{data:a.data,file:a.file,fileObjectURL:a.fileObjectURL,fileType:"VIDEO",state:"CLIENT_PROCESSING",useCDNPreview:a.useCDNPreview};default:return a}case"PREEXISTING":return a;case"UPLOADED":switch(a.fileType){case"PHOTO":return{data:a.data,entID:a.data.id,file:a.file,fileObjectURL:a.fileObjectURL,fileType:"PHOTO",height:a.height,sphericalEncoding:a.sphericalEncoding,state:"UPLOADED",useCDNPreview:a.useCDNPreview,width:a.width};case"VIDEO":return{data:a.data,entID:a.data.id,file:a.file,fileObjectURL:a.fileObjectURL,fileType:"VIDEO",height:a.height,state:"UPLOADED",useCDNPreview:a.useCDNPreview,videoAttachmentMetadata:a.videoAttachmentMetadata,width:a.width};default:return a}case"FAILED":switch(a.fileType){case"PHOTO":return{data:a.data,error:a.error,file:a.file,fileObjectURL:a.fileObjectURL,fileType:"PHOTO",height:a.height,sphericalEncoding:a.sphericalEncoding,state:"FAILED",useCDNPreview:!0,width:a.width};case"VIDEO":return{data:a.data,error:a.error,file:a.file,fileObjectURL:a.fileObjectURL,fileType:"VIDEO",height:a.height,state:"FAILED",useCDNPreview:!0,width:a.width};default:return a}default:var b;switch(a.state){case"QUEUED":b=0;break;case"UPLOADING":b=a.percentComplete;break;case"UPLOADED":b=1;break;default:b=void 0;break}switch(a.fileType){case"PHOTO":return{fileMimeType:a.file.type,fileName:a.file.name,fileObjectURL:a.fileObjectURL,fileType:a.fileType,height:a.height,percentComplete:b,sphericalEncoding:a.sphericalEncoding,state:"OPTIMISTIC_UPLOADED",uploadID:a.file.uploadID,useCDNPreview:a.useCDNPreview,width:a.width};case"VIDEO":return{fileMimeType:a.file.type,fileName:a.file.name,fileObjectURL:a.fileObjectURL,fileType:a.fileType,height:a.height,percentComplete:b,state:"OPTIMISTIC_UPLOADED",uploadID:a.file.uploadID,useCDNPreview:a.useCDNPreview,width:a.width};default:return{fileMimeType:a.file.type,fileName:a.file.name,fileObjectURL:a.fileObjectURL,fileType:a.fileType,percentComplete:b,state:"OPTIMISTIC_UPLOADED",uploadID:a.file.uploadID}}}}}),null);
__d("CometComposerMediaAttachmentArea.react",["ComposerCometMediaAttachmentCollage.react","ComposerCometSelectedPhotoLayoutContext","React","composerMediaAttachmentReducer","makeMediaAttachmentReadyForPreview","requireDeferred","useComposerViewStateDispatcher","useComposerViewStateReducer","withComposerViewStatePart"],(function(a,b,c,d,e,f){"use strict";var g=b("React");b("requireDeferred")("mediaAttachmentAreaTransform");function a(a){var c=a.disableVideo;c=c===void 0?!1:c;var d=a.mediaAttachments,e=a.mediaUploadLoggingMetadata,f=a.selectedPhotoLayout,h=a.videoLiteComposerEligible;h=h===void 0?!1:h;a=a.width;b("useComposerViewStateReducer")(b("composerMediaAttachmentReducer"));var i=b("useComposerViewStateDispatcher")();g.useEffect(function(){return function(){i({type:"REMOVE_ALL_MEDIA_ATTACHMENT_ITEMS"})}},[i]);var j=g.useMemo(function(){return{layout:f}},[f]);return d!=null?g.jsx(b("ComposerCometSelectedPhotoLayoutContext").Provider,{value:j,children:g.jsx(b("ComposerCometMediaAttachmentCollage.react"),{disableVideoUploads:c,inComposer:!0,mediaAttachments:d.map(function(a){switch(a.state){case"PREEXISTING":return a;default:return a.file&&a.fileType!=="UNKNOWN"?a:null}}).filter(Boolean).map(b("makeMediaAttachmentReadyForPreview")),mediaUploadLoggingMetadata:e,selectedPhotoLayout:f,videoLiteComposerEligible:h,width:a})}):null}c=b("withComposerViewStatePart")(a,function(a){return{mediaAttachments:a.mediaAttachments,selectedPhotoLayout:a.photoLayout}});e.exports=c}),null);
__d("cometComposerCheckMediaAttachmentsForPhoto3d",[],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a,b){if(!a)return;var c=a.reduce(function(a,b){b.state==="UPLOADED"&&b.fileType==="PHOTO"&&a.push(b);return a},[]);if(a.length!==2||c.length!==2)return;a=g(c);c=h(a);if(c==null)return;b({colorImageIds:c.colorImageIds,depthImageIds:c.depthImageIds,placeholderImage:c.placeholderImage,type:"SET_PHOTO3D_CREATION_DATA"});b({attachmentType:"PHOTO3D",type:"ACTIVATE_ATTACHMENT_TYPE"})}function g(a){var b={},c=["jpg","jpeg","png"];a.forEach(function(a){var d=a.file.name;if(!d)return;var e=d.lastIndexOf(".");if(e<0)return;var f=d.split(".").pop().toLowerCase();if(!c.includes(f))return;f=d.substring(0,e).toLowerCase();d=f.split("_");if(d.length>1&&d.pop().toLowerCase()==="depth"){e=d.join("_");e in b||(b[e]={colorImage:null,depthImage:null});b[e].depthImage=a}else f in b||(b[f]={colorImage:null,depthImage:null}),b[f].colorImage=a});return b}function h(a){var b=Object.keys(a).sort();if(b.length===0)return null;var c=[],d=[],e=null;b.forEach(function(b){b=a[b];var f=b.colorImage;b=b.depthImage;if(!f||!b)return null;var g=f.entID;b=b.entID;if(g==null||b==null)return null;e==null&&(e=f);c.push(g);d.push(b)});return c.length===0||c.length!==d.length||e===null?null:{colorImageIds:c,depthImageIds:d,placeholderImage:e}}}),null);
__d("VideoPlayerCaptionsController",["JSResource","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";f.createCaptionsController=a;var g=b("JSResource")("VideoPlayerHTML5ApiCea608State").__setRef("VideoPlayerCaptionsController"),h=b("JSResource")("VideoPlayerHTML5ApiWebVttState").__setRef("VideoPlayerCaptionsController");function a(a){var c=a.captionsUrl,d=a.inbandCaptionsExpected,e=a.onCaptionsLoaded,f=null,i=null,j=null,k=null;function l(a){var c=h.load().then(function(b){if(c!==j)return;f=new b({captionsDisplay:null,onCaptionsLoaded:e,onReady:function(b){b.loadFromUrl(a)}})})["catch"](function(a){if(c!==j)return;b("recoverableViolation")("Failed to load the VideoPlayerHTML5ApiWebVttState module: "+a.message,"comet_video_player")});return c}function m(){var a=g.load().then(function(b){if(a!==k)return;i=new b({captionsDisplay:null,onCaptionsLoaded:e,onReady:function(a){a.processQueue()}})})["catch"](function(c){if(a!==k)return;b("recoverableViolation")("Failed to load the VideoPlayerHTML5ApiCea608State module: "+c.message,"comet_video_player")});return a}c!=null?j=l(c):d===!0&&(k=m());return{destroy:function(){f&&(f.destroy(),f=null),i&&(i.destroy(),i=null),j&&(j=null),k&&(k=null)},handleCea608BytesReceived:function(a){i&&i.enqueueBytes(a)},handleTimeUpdate:function(a){if(f){f.source&&f.source.handleTimeUpdate(a);return f.getCurrentScreenRepresentation()}else if(i){i.source&&i.source.handleTimeUpdate(a);return i.getCurrentScreenRepresentation()}return null},updateCaptionsUrl:function(a){f&&(f.destroy(),f=null),a!=null&&(j=l(a))},updateInbandCaptionsExpected:function(a){i&&(i.destroy(),i=null),a&&(k=m())}}}}),null);
__d("VideoPlayerBanzaiLogFlusher",["Banzai","BanzaiConsts","emptyFunction","gkx"],(function(a,b,c,d,e,f){"use strict";var g,h="video_player";a=b("emptyFunction");c=function(){function a(a){this.$1=a}var c=a.prototype;c.flushLogs=function(){var a=this.$1.consumeLoggerEvents();a.forEach(function(a){var c={event:a.eventType,logData:a.logData,routeTracePolicy:a.routeTracePolicy,source:a.source_VPL_LOGGING_HACK};if(a.source_VPL_LOGGING_HACK==="animated_image_share"&&b("gkx")("1710047"))return;a=(a=a.logData)==null?void 0:a.ad_client_token;var d=b("gkx")("1426867")?{batch:1500,delay:(g||(g=b("BanzaiConsts"))).VITAL_WAIT}:{delay:(g||(g=b("BanzaiConsts"))).VITAL_WAIT};b("gkx")("1107827")?b("Banzai").post(h,c,d):a!=null?b("Banzai").post(h,c,b("Banzai").VITAL):(d.delay=(g||(g=b("BanzaiConsts"))).BASIC_WAIT_COMET,b("Banzai").post(h,c,d))})};return a}();e.exports=c}),null);
__d("VideoPlayerImplementationErrors",["getErrorMessageFromMediaErrorCode","getErrorNameFromMediaErrorCode"],(function(a,b,c,d,e,f){"use strict";f.createVideoPlayerErrorFromHTMLVideoElementError=a;f.createVideoPlayerErrorFromVideoElementPlayPromiseRejectionReason=c;f.createVideoPlayerErrorFromGenericError=d;function a(a){var c=a.errorLocation,d=a.hostCallError,e=a.videoElementError,f=a.videoElementNetworkState;a=a.videoElementReadyState;var g=e==null?void 0:e.code,h=d!=null&&typeof d.message==="string"?d.message:null;h==null&&(h=e==null?void 0:e.message);h==null&&g!=null&&(h=b("getErrorMessageFromMediaErrorCode")(g));e={createdTimestamp:Date.now(),errorDescription:((e=h)!=null?e:"Empty error")+("; code: "+((h=g)!=null?h:"undefined"))+("; readyState: "+a)+("; networkState: "+f),errorLocation:c,errorName:b("getErrorNameFromMediaErrorCode")(g),originalError:d};return e}function c(a,b){if(a==null){var c={createdTimestamp:Date.now(),errorDescription:"Empty rejection reason from video play()",errorLocation:b,errorName:"PlayRejectedError"};return c}c={createdTimestamp:Date.now(),errorCode:typeof a.code==="string"?a.code:typeof a.code==="number"?String(a.code):void 0,errorDescription:typeof a.message==="string"?a.message:String(a),errorLocation:b,errorName:typeof a.name==="string"?a.name:"PlayRejectedError"};return c}function d(a,b,c){var d;d={message:(d=b==null?void 0:b.message)!=null?d:"",name:(d=b==null?void 0:b.name)!=null?d:"UnknownError",stack:(b==null?void 0:b.stack)||new Error().stack};b={createdTimestamp:Date.now(),errorCode:null,errorDescription:d.name+" "+d.message,errorLocation:c,errorName:a,stack:d.stack,url:null};return b}}),null);
__d("VideoPlayerImplementationStateMachine",["VideoPlayerImplementationErrors","gkx","recoverableViolation","shallowEqual","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";f.createVideoPlayerImplementationStateMachine=m;f.createVideoPlayerImplementationStateMachineWithStateTransitionHandlers=a;f.createReactVideoElementCallbacksForStateMachine=c;function g(a){var b=a.bufferingDetected,c=a.seeking;a=a.waitingForDomPlaying;return!b&&!c&&!a}function h(a){var c=a.bufferingDetected,d=a.prevPlaybackState,e=a.seeking;a=a.waitingForDomPlaying;c=g({bufferingDetected:c,seeking:e,waitingForDomPlaying:a});e=d;switch(d){case"stalling":e=c?"playing":"stalling";break;case"ended":case"paused":case"playing":break;default:d;b("recoverableViolation")("unexpected playbackState: "+d,"comet_video_player");break}return e}function i(a,c,d){switch(d.type){case"host_call_pause":case"host_call_play":case"host_call_set_current_time":case"host_call_set_volume":case"host_call_set_muted":case"host_call_set_playback_rate":case"host_call_set_video_quality":return babelHelpers["extends"]({},a,{hostCallQueue:a.hostCallQueue.concat([d])});case"dom_event_ended":return babelHelpers["extends"]({},a,{playbackState:"ended",waitingForDomPlaying:!1});case"dom_event_pause":if(a.playbackState==="ended")return a;if(c.videoElementEnded===!0)return babelHelpers["extends"]({},a,{playbackState:"ended",waitingForDomPlaying:!1});return a.playbackState==="paused"?a:babelHelpers["extends"]({},a,{playbackState:"paused",waitingForDomPlaying:!1});case"dom_event_play":var e=a.playbackState,f=e;switch(e){case"playing":case"stalling":case"ended":case"paused":f="stalling";break;default:e;b("recoverableViolation")("unexpected playbackState: "+e,"comet_video_player");break}e=!0;return babelHelpers["extends"]({},a,{playbackState:f,waitingForDomPlaying:e});case"dom_event_playing":f=a.bufferingDetected;e=a.seeking;var g=!1,i=a.playbackState;return babelHelpers["extends"]({},a,{playbackState:h({bufferingDetected:f,prevPlaybackState:i,seeking:e,waitingForDomPlaying:g}),waitingForDomPlaying:g});case"dom_event_timeupdate":if(a.waitingForDomTimeUpdateAfterSeeked){f=a.bufferingDetected;i=a.seeking;e=!1;g=a.playbackState;return babelHelpers["extends"]({},a,{playbackState:h({bufferingDetected:f,prevPlaybackState:g,seeking:i,waitingForDomPlaying:e}),waitingForDomPlaying:e,waitingForDomTimeUpdateAfterSeeked:!1})}return a;case"dom_event_seeking":f=a.playbackState;g=f;switch(f){case"paused":case"ended":break;case"stalling":case"playing":g="stalling";break;default:f,b("recoverableViolation")("unexpected playbackState: "+f,"comet_video_player")}return babelHelpers["extends"]({},a,{playbackState:g,seeking:!0,waitingForDomPlaying:!0});case"dom_event_seeked":i=a.bufferingDetected;e=a.waitingForDomPlaying;f=!1;g=a.playbackState;return babelHelpers["extends"]({},a,{implementationSeekSourcePosition:null,playbackState:h({bufferingDetected:i,prevPlaybackState:g,seeking:f,waitingForDomPlaying:e}),seeking:f,waitingForDomTimeUpdateAfterSeeked:!0});case"dom_event_error":i=b("VideoPlayerImplementationErrors").createVideoPlayerErrorFromHTMLVideoElementError({errorLocation:"dom_event_error",hostCallError:null,videoElementError:d.payload.videoElementError,videoElementNetworkState:d.payload.videoElementNetworkState,videoElementReadyState:d.payload.videoElementReadyState});return babelHelpers["extends"]({},a,{error:i,playbackState:"paused",waitingForDomPlaying:!1});case"dom_event_play_promise_created":return babelHelpers["extends"]({},a,{hostCallPlayIDLast:d.payload.hostCallPlayID});case"dom_event_play_promise_resolved":return a.hostCallPlayIDLast!==d.payload.hostCallPlayID?a:babelHelpers["extends"]({},a,{hostCallPlayIDLast:null});case"dom_event_play_promise_rejected":return a.hostCallPlayIDLast!==d.payload.hostCallPlayID?a:babelHelpers["extends"]({},a,{hostCallPlayIDLast:null,playbackState:a.playbackState==="stalling"?"paused":a.playbackState,waitingForDomPlaying:!1});case"implementation_host_call_queue_flushed":return babelHelpers["extends"]({},a,{hostCallQueue:[]});case"implementation_host_call_failed":g=b("VideoPlayerImplementationErrors").createVideoPlayerErrorFromHTMLVideoElementError({errorLocation:d.payload.errorLocation,hostCallError:d.payload.hostCallError,videoElementError:d.payload.videoElementError,videoElementNetworkState:d.payload.videoElementNetworkState,videoElementReadyState:d.payload.videoElementReadyState});return babelHelpers["extends"]({},a,{error:g,playbackState:"paused",waitingForDomPlaying:!1});case"implementation_video_node_unmounted":return a;case"implementation_engine_initialized":return babelHelpers["extends"]({},a,{availableQualities:d.payload.availableQualities,selectedVideoQuality:d.payload.selectedVideoQuality,targetVideoQuality:d.payload.targetVideoQuality,videoProjection:d.payload.videoProjection});case"implementation_engine_destroyed":return a;case"implementation_fatal_error":return babelHelpers["extends"]({},a,{error:d.payload.fatalError,playbackState:"paused",waitingForDomPlaying:!1});case"implementation_seek_requested":return babelHelpers["extends"]({},a,{implementationSeekSourcePosition:d.payload.seekSourcePosition});case"representation_changed":return babelHelpers["extends"]({},a,{targetVideoQuality:d.payload.targetVideoQuality});case"controller_pause_requested":return a.playbackState==="ended"?a:babelHelpers["extends"]({},a,{lastPauseReason:d.payload.reason,lastPausedTimeMs:Date.now(),lastPlayedTimeMs:0,playbackState:"paused",waitingForDomPlaying:!1,watchTimeMs:a.lastPlayedTimeMs>0?a.watchTimeMs+(Date.now()-a.lastPlayedTimeMs):a.watchTimeMs});case"controller_play_requested":if(a.playbackState!=="paused"&&a.playbackState!=="ended")return a;e=a.loopCount>0&&a.loopCurrent<a.loopCount||a.loopCount===-1?d.payload.reason==="loop_initiated"?a.loopCurrent+1:a.loopCurrent:0;return babelHelpers["extends"]({},a,{lastPlayReason:d.payload.reason,lastPlayedTimeMs:a.lastPlayedTimeMs===0?Date.now():a.lastPlayedTimeMs,loopCurrent:e,playbackState:"stalling",waitingForDomPlaying:!0});case"controller_seek_requested":return babelHelpers["extends"]({},a,{implementationSeekSourcePosition:(f=c.videoElementPlayheadPosition)!=null?f:a.implementationSeekSourcePosition,seekTargetPosition:d.payload.seekTargetPosition,seeking:!0});case"controller_quality_requested":return babelHelpers["extends"]({},a,{selectedVideoQuality:d.payload.selectedVideoQuality});case"controller_set_playback_rate":return babelHelpers["extends"]({},a,{targetPlaybackRate:d.payload.playbackRate});case"controller_muted_requested":return babelHelpers["extends"]({},a,{lastMuteReason:d.payload.reason,muted:d.payload.muted});case"controller_volume_requested":return babelHelpers["extends"]({},a,{volume:d.payload.volume});case"controller_scrub_begin_requested":return a.scrubbing?a:babelHelpers["extends"]({},a,{scrubbing:!0,seekTargetPosition:null});case"controller_scrub_end_requested":return!a.scrubbing?a:babelHelpers["extends"]({},a,{implementationSeekSourcePosition:(i=c.videoElementPlayheadPosition)!=null?i:a.implementationSeekSourcePosition,scrubbing:!1,seekTargetPosition:d.payload.seekTargetPosition,seeking:d.payload.seekTargetPosition!=null});case"buffering_begin_requested":g=a.playbackState;e=g;switch(g){case"paused":case"ended":break;case"playing":case"stalling":e="stalling";break;default:g;b("recoverableViolation")("unexpected playbackState: "+g,"comet_video_player");break}f=d.payload.bufferingType;return babelHelpers["extends"]({},a,{bufferingDetected:!0,lastBufferingType:f,playbackState:e});case"buffering_end_requested":c=a.seeking;i=a.waitingForDomPlaying;g=!1;f=a.playbackState;return babelHelpers["extends"]({},a,{bufferingDetected:g,playbackState:h({bufferingDetected:g,prevPlaybackState:f,seeking:c,waitingForDomPlaying:i})});case"controller_set_captions_visible_requested":e=d.payload.captionsVisible;return a.captionsVisible===e?a:babelHelpers["extends"]({},a,{activeCaptions:e?a.activeCaptions:null,captionsVisible:e});case"controller_set_active_captions_requested":g=d.payload.activeCaptions;c=(f=g==null?void 0:g.rows)!=null?f:[];i=a.activeCaptions;var j=(e=i==null?void 0:i.rows)!=null?e:[];return j.length===c.length&&c.every(function(a,b){return j[b]===a})?a:babelHelpers["extends"]({},a,{activeCaptions:g});case"captions_loaded":return babelHelpers["extends"]({},a,{activeCaptions:a.activeCaptions,captionsLoaded:!0});case"captions_unloaded":return babelHelpers["extends"]({},a,{activeCaptions:null,captionsLoaded:!1});case"inband_captions_autogenerated_changed":f=d.payload.inbandCaptionsAutogenerated;return a.inbandCaptionsAutogenerated===f?a:babelHelpers["extends"]({},a,{inbandCaptionsAutogenerated:f});case"stream_ended":return babelHelpers["extends"]({},a,{streamEnded:!0});case"stream_interrupted":return babelHelpers["extends"]({},a,{streamInterrupted:!0});case"stream_resumed":return babelHelpers["extends"]({},a,{streamInterrupted:!1});case"seekable_ranges_changed":i=d.payload.seekableRanges;return babelHelpers["extends"]({},a,{seekableRanges:i});case"controller_set_is_live_rewind_active_requested":e=d.payload.isLiveRewindActive;return babelHelpers["extends"]({},a,{isLiveRewindActive:e});case"loop_count_change_requested":c=d.payload.loopCount;return c===a.loopCount?a:babelHelpers["extends"]({},a,{loopCount:c,loopCurrent:0});case"player_dimensions_changed":g=d.payload.dimensions;f=g.height;i=g.width;return i===a.dimensions.width&&f===a.dimensions.height?a:babelHelpers["extends"]({},a,{dimensions:{height:f,width:i}});default:return a}}function j(a,c,d){var e=c.type!=="dom_seeking";e=e?d:a.uncontrolledState;d=!b("shallowEqual")(e,a.uncontrolledState);c=i(a.controlledState,e,c);var f=!b("shallowEqual")(c,a.controlledState);return d||f?babelHelpers["extends"]({},a,{controlledState:f?c:a.controlledState,uncontrolledState:d?e:a.uncontrolledState}):a}var k,l;function m(a){var c=a.collectUncontrolledState,d=a.debugLogId;d=a.initialState;var e=a.onDispatched,f=a.onFatalError,g=d,h=g,i=0,k=!1,l=!1,m=!0,n=!0;return{dispatch:function(a){if(!n)return;var d=null,g=null;try{++i;if(i>=10)if(!k){k=!0;throw b("unrecoverableViolation")("Video player state machine loop detected","comet_video_player")}else return;var o=h.uncontrolledState;if(m)try{o=c()}catch(a){m=!1,g=a}var p=h;o=j(p,a,o);h=o;e(p,o,a)}catch(a){n=!1,d=a}finally{if(!l&&(d!=null||g!=null)){l=!0;try{f((p=d)!=null?p:g)}catch(a){}}--i}},getCurrentState:function(){return h},getInitialState:function(){return g}}}var n,o;function a(a){var b=a.collectUncontrolledState,c=a.debugLogId,d=a.initialState,e=a.onFatalError,f=a.stateTransitionHandlers;function g(a,b,c){try{var d=!0,e=0;while(d&&e<f.length){var g=f[e];d=g(a,b,c);++e}}finally{}}return m({collectUncontrolledState:b,debugLogId:c,initialState:d,onDispatched:g,onFatalError:e})}function c(a,b){function c(){}function d(a){return a}function e(c){return function(e){var f=d(e.currentTarget);b(f,["reactEvent("+e.type+")"]);a.dispatch(c)}}return{onAbort:c,onCanPlay:c,onCanPlayThrough:c,onDurationChange:e({type:"dom_event_durationchange"}),onEmptied:c,onEncrypted:c,onEnded:e({type:"dom_event_ended"}),onError:function(c){var e=d(c.currentTarget);b(e,["reactEvent("+c.type+")"]);a.dispatch({payload:{videoElementError:e.error,videoElementNetworkState:e.networkState,videoElementReadyState:e.readyState},type:"dom_event_error"})},onLoadStart:c,onLoadedData:c,onLoadedMetadata:c,onPause:e({type:"dom_event_pause"}),onPlay:e({type:"dom_event_play"}),onPlaying:e({type:"dom_event_playing"}),onProgress:e({type:"dom_event_progress"}),onRateChange:e({type:"dom_event_ratechange"}),onSeeked:e({type:"dom_event_seeked"}),onSeeking:e({type:"dom_event_seeking"}),onStalled:c,onSuspend:c,onTimeUpdate:e({type:"dom_event_timeupdate"}),onVolumeChange:e({type:"dom_event_volumechange"}),onWaiting:e({type:"dom_event_waiting"})}}}),null);
__d("VideoPlayerImplementationStateMachineHostCallQueue",["cometUniqueID","emptyFunction","gkx","promiseDone"],(function(a,b,c,d,e,f){"use strict";f.makeHostCallID=g;f.applyOrQueueHostCall=i;f.flushHostCallQueue=a;c=b("emptyFunction");function g(){return"id-vpdom-"+b("cometUniqueID")()}function h(a){var c=a.engineExtrasAPI,d=a.hostCall,e=a.machine;a=a.videoElementAPI;switch(d.type){case"host_call_play":var f=a.play();f&&(e.dispatch({payload:{hostCallPlayID:d.payload.hostCallID},type:"dom_event_play_promise_created"}),b("promiseDone")(f.then(function(){e.dispatch({payload:{hostCallPlayID:d.payload.hostCallID},type:"dom_event_play_promise_resolved"})},function(a){e.dispatch({payload:{hostCallPlayID:d.payload.hostCallID,playPromiseRejectionReason:a},type:"dom_event_play_promise_rejected"})})));break;case"host_call_pause":a.pause();break;case"host_call_set_playback_rate":a.setPlaybackRate(d.payload.playbackRate);break;case"host_call_set_muted":a.setMuted(d.payload.muted);break;case"host_call_set_volume":a.setVolume(d.payload.volume);break;case"host_call_set_current_time":a.setPlayheadPosition(d.payload.currentTime);break;case"host_call_set_video_quality":c.setUserSelectedVideoQuality(d.payload.selectedVideoQuality);break;case"host_call_set_latency_level":c.setLatencyLevel(d.payload.latencyLevel);break;default:d.type;return!1}return!0}function i(a){var b=a.engineExtrasAPI,c=a.hostCall,d=a.machine;a=a.videoElementAPI;if(!a||!b)d.dispatch(c);else{var e=!1;try{e=h({engineExtrasAPI:b,hostCall:c,machine:d,videoElementAPI:a})}catch(b){d.dispatch({payload:{errorLocation:"apply_host_call_catch",hostCall:c,hostCallError:b,videoElementError:a.getError(),videoElementNetworkState:a.getNetworkState(),videoElementReadyState:a.getReadyState()},type:"implementation_host_call_failed"})}e&&d.dispatch({payload:{hostCall:c},type:"implementation_host_call_applied"})}}function j(a){var b=[];function c(){b=b.filter(function(a){return a.type!=="host_call_play"&&a.type!=="host_call_pause"})}function d(a){b=b.filter(function(b){return b.type!==a})}a.forEach(function(a){switch(a.type){case"host_call_play":c();break;case"host_call_pause":c();break;case"host_call_set_playback_rate":d(a.type);break;case"host_call_set_muted":d(a.type);break;case"host_call_set_volume":d(a.type);break;case"host_call_set_current_time":d(a.type);break;case"host_call_set_video_quality":d(a.type);break;case"host_call_set_latency_level":d(a.type);break;default:a.type}b=b.concat([a])});return b}function a(a){var b=a.engineExtrasAPI,c=a.machine,d=a.reason,e=a.state,f=a.videoElementAPI;a=[{payload:{hostCallID:g(),reason:d,volume:e.controlledState.volume},type:"host_call_set_volume"},{payload:{hostCallID:g(),muted:e.controlledState.muted,reason:d},type:"host_call_set_muted"},{payload:{hostCallID:g(),reason:d,selectedVideoQuality:e.controlledState.selectedVideoQuality},type:"host_call_set_video_quality"}];d=j(e.controlledState.hostCallQueue.concat(a));d.forEach(function(a){i({engineExtrasAPI:b,hostCall:a,machine:c,videoElementAPI:f})});c.dispatch({payload:{hostCallsFlushed:d},type:"implementation_host_call_queue_flushed"})}}),null);
__d("VideoPlayerMutedStateChange",[],(function(a,b,c,d,e,f){"use strict";f.getVideoPlayerMutedStateChange=a;function a(a){var b=a.currMuted,c=a.currVolume,d=a.prevMuted;a=a.prevVolume;b=b||c===0;c=d||a===0;if(c===b)return null;return b?"muted":"unmuted"}}),null);
__d("VideoPlayerImplementationStateMachineLogger",["PlaybackSpeedExperiments","SiteData","VideoMimeTypes","VideoPlayerConnectionQuality","VideoPlayerLoggerPlayerStates","VideoPlayerMutedStateChange","VideoPlayerStateBasedLoggingEvents","emptyFunction","getPlayerFormatForLogData","getVideoBrowserTabId","gkx","mapObject","recoverableViolation","removeFromArray"],(function(a,b,c,d,e,f){"use strict";f.createVideoPlayerImplementationStateMachineLogger=a;var g,h=6e4;f.HEARTBEAT_INTERVAL=h;var i=.5,j=null,k=function(a){var b;j=(b=j)!=null?b:document.createElement("video");return!("canPlayType"in j)?"":j.canPlayType(a)};d=c=b("emptyFunction");e=c;a=c;f=c;var l=(d=b("PlaybackSpeedExperiments").enablePlaybackSpeedLogging())!=null?d:!1;function m(){return{canLogPausedOrFinishedPlaying:!1,canLogPlayingEvent:!0,debugSubscribers:[],dontLogPauseOnUnpausedSeeking:!1,hasLoggedStallData:!1,hasLoggedStartedPlaying:!1,hasPausedOnce:!1,hasPendingRequestedPlaying:!1,initialSuborigin:void 0,interruptCount:0,interruptDuration:0,interruptEndTimestamp:0,interruptStartTimestamp:0,isLoggingScrubbingSequence:!1,lastLoggedError:null,lastLoggedFullscreenState:!1,lastLoggedPlaybackSpeed:null,lastLoggedViewabilityPercentage:void 0,lastStartTimePosition:null,lastTrackedRepresentation:null,nextHeartbeatTime:null,nextPlayedThreeSecondsPlayheadPosition:null,sequenceNumber:0,shouldIgnoreDomPause:!1,shouldIgnoreDomPlay:!1,shouldLogRequestedPlayingForScrub:!1,stallCount:0,stallCount200ms:0,stallDuration:0,stallStartTimestamp:0,stallCountTotal:0,stallDurationTotal:0,startStallCountTotal:0,startStallDurationTotal:0,vplEventSequenceNumber:0}}function n(a,b){return b==="muted"||b==="unmuted"||b==="started_playing"||b==="caption_change"||b==="unpaused"?a.controlledState.captionsVisible?"on":"off":void 0}function a(a){var c=new Map(),d=a.initialLoggingMetaData,e=d,f=[],j=m(),o=new Set(b("VideoPlayerStateBasedLoggingEvents").StateBasedLoggingEventNames);function p(a){j.debugSubscribers.push(a);return function(){b("removeFromArray")(j.debugSubscribers,a)}}function q(a){j.debugSubscribers.forEach(function(b){return b(a)})}function r(a){var b=j.stallStartTimestamp;if(b>0){j.stallCount+=1;j.stallCountTotal+=1;j.hasPendingRequestedPlaying&&(j.startStallCountTotal+=1);a=a-b;j.stallDurationTotal+=a;j.stallDuration+=a;j.stallCount200ms+=a>200?1:0;j.hasPendingRequestedPlaying&&(j.startStallDurationTotal+=a)}}function s(a,b){a=a.uncontrolledState.videoElementPlayheadPosition==null?null:a.uncontrolledState.videoElementPlayheadPosition;var c=null;switch(b){case"paused":case"cancelled_requested_playing":case"finished_playing":case"heart_beat":case"playback_speed_changed":case"representation_ended":c=j.lastStartTimePosition;break;case"scrubbed":c=a;break;default:break}switch(b){case"paused":case"cancelled_requested_playing":case"finished_playing":case"scrubbed":j.lastStartTimePosition=null;break;case"started_playing":case"unpaused":case"heart_beat":case"playback_speed_changed":case"representation_ended":j.lastStartTimePosition=a;break;default:break}return{video_last_start_time_position:c}}function t(a,b){var c=b.uncontrolledState.clockTimestamp;a=a.controlledState.streamInterrupted;b=b.controlledState.streamInterrupted;!a&&b?j.interruptStartTimestamp=c:a&&!b&&j.interruptStartTimestamp>0&&(j.interruptEndTimestamp=c,j.interruptCount+=1,j.interruptDuration+=j.interruptEndTimestamp-j.interruptStartTimestamp)}function u(a,b){var c=b.uncontrolledState.clockTimestamp;a=a.controlledState.playbackState;var d=b.controlledState.playbackState;a!=="stalling"&&d==="stalling"&&(q("stall_start"),j.stallStartTimestamp=c);a==="stalling"&&d!=="stalling"&&(r(b.uncontrolledState.clockTimestamp),j.stallStartTimestamp=0,q("stall_end"))}function v(a,b,c){a=b.uncontrolledState;b=a.videoElementPlayheadPosition;switch(c){case"unpaused":case"started_playing":j.nextPlayedThreeSecondsPlayheadPosition=((a=b)!=null?a:0)+3;break;case"paused":case"finished_playing":j.nextPlayedThreeSecondsPlayheadPosition=null;break;default:break}}function w(a,b,c){if(j.interruptCount>0&&j.interruptDuration>0){a={interrupt_count:j.interruptCount,interrupt_time:j.interruptDuration};j.interruptCount=0;j.interruptDuration=0;j.interruptStartTimestamp=0;j.interruptEndTimestamp=0;return a}return{interrupt_count:null,interrupt_time:null}}function x(a,b,c){var d={stall_count:null,stall_count_200_ms:null,stall_time:null},e=b.uncontrolledState.clockTimestamp,f=function(){var a={stall_count:j.stallCount,stall_count_200_ms:j.stallCount200ms,stall_time:j.stallDuration};j.stallCount=0;j.stallCount200ms=0;j.stallDuration=0;j.stallStartTimestamp=0;return a};a=a.controlledState.playbackState;var g=b.controlledState.playbackState;a!=="stalling"&&g==="stalling"&&(j.stallStartTimestamp=e);switch(c){case"started_playing":case"unpaused":case"finished_playing":case"paused":case"cancelled_requested_playing":case"playback_speed_changed":case"representation_ended":r(b.uncontrolledState.clockTimestamp);d=f();break;case"heart_beat":b.controlledState.playbackState!=="stalling"&&(r(b.uncontrolledState.clockTimestamp),d=f());break;default:break}return d}function y(a,b){a=a?a.getAndFlushTracedFrames():null;switch(b){case"finished_playing":case"paused":case"heart_beat":return a!=null?JSON.stringify(a):null;default:return null}}function z(a){a=a.controlledState.playbackState;switch(a){case"playing":case"stalling":return"playing";case"paused":return"paused";case"ended":return"finished";default:a;return"unknown"}}function A(){return{state:j.hasLoggedStartedPlaying?b("VideoPlayerLoggerPlayerStates").UNPAUSED:b("VideoPlayerLoggerPlayerStates").STARTED}}function B(e){var g=e.eventType,h=e.logDataOverrides,i=e.prevState,k=e.state;e=s(k,g);e=e.video_last_start_time_position;var m=x(i,k,g),p=m.stall_count,q=m.stall_count_200_ms;m=m.stall_time;var r=w(i,k,g),t=r.interrupt_count;r=r.interrupt_time;var u=y(a.initialLoggingMetaData.videoLiveTrace,g),A=[],B=a.initialLoggingMetaData.coreVideoPlayerMetaData.autoplayGatingResult;B&&A.push(B);B=g==="entered_fs"?!0:g==="exited_fs"?!1:j.lastLoggedFullscreenState;var C=b("getPlayerFormatForLogData")(B,d.coreVideoPlayerMetaData.playerFormat),D=k.uncontrolledState.viewabilityPercentage,E=Boolean(k.uncontrolledState.isFBIsLiveTemplated),F=Boolean(k.uncontrolledState.isFBWasLive),G=k.uncontrolledState.videoElementPlaybackRate;G=G==null||G===0?j.lastLoggedPlaybackSpeed:G;var H=a.initialLoggingMetaData.productAttribution;u={access_token:a.initialLoggingMetaData.accessToken,ad_client_token:d.coreVideoPlayerMetaData.adClientToken,attribution_id:H!=null?JSON.stringify(H):null,autoplay_eligible:a.initialLoggingMetaData.coreVideoPlayerMetaData.canAutoplay==="allow",autoplay_failure_reasons:JSON.stringify(A),autoplay_setting:a.initialLoggingMetaData.coreVideoPlayerMetaData.autoplaySetting,broadcaster_origin:a.initialLoggingMetaData.coreVideoPlayerMetaData.broadcasterOrigin,browser_tab_id:b("getVideoBrowserTabId")(),caption_state:n(k,g),current_playback_speed:l?G:null,current_viewability_percentage:D,data_connection_quality:b("VideoPlayerConnectionQuality").evaluate(function(){return k.uncontrolledState.estimatedBandwidth}),dropped_frame_count:k.uncontrolledState.videoElementDroppedFrameCount,external_log_id:d.coreVideoPlayerMetaData.externalLogID,external_log_type:d.coreVideoPlayerMetaData.externalLogType,frame_events:u,interrupt_count:t,interrupt_time:r,is_abr_enabled:k.isAbrEnabled,is_fbms:k.uncontrolledState.isFBMS,is_predictive_playback:k.uncontrolledState.isPredictiveDash,is_sound_on:!k.controlledState.muted,is_live_video_rewound:k.controlledState.isLiveRewindActive,is_templated_manifest:E||F,last_viewability_percentage:j.lastLoggedViewabilityPercentage,living_room_session_id:a.initialLoggingMetaData.coreVideoPlayerMetaData.livingRoomID,playback_is_drm:Boolean(a.initialLoggingMetaData.coreVideoPlayerMetaData.graphQLVideoDRMInfo),playback_duration:k.uncontrolledState.videoElementDuration,playback_is_broadcast:a.initialLoggingMetaData.coreVideoPlayerMetaData.isVideoBroadcast,playback_is_live_streaming:a.initialLoggingMetaData.coreVideoPlayerMetaData.isLiveStreaming,player_format:C,player_instance_key:d.instanceKey,player_origin:d.coreVideoPlayerMetaData.playerOriginOverride,player_state:z(k),player_suborigin:d.coreVideoPlayerMetaData.subOrigin,player_version:k.playerVersion,representation_id:k.uncontrolledState.videoRepresentationID,source_VPL_LOGGING_HACK:d.coreVideoPlayerMetaData.source_VPL_LOGGING_HACK,stall_count:p,stall_count_200_ms:q,stall_time:m,streaming_format:k.streamingFormat,total_frame_count:k.uncontrolledState.videoElementTotalFrameCount,tracking_data_encrypted:a.initialLoggingMetaData.trackingDataEncrypted,tracking_nodes:a.initialLoggingMetaData.trackingNodes,v2_heart_beat:b("gkx")("1434599")&&g==="heart_beat"?!0:null,video_bandwidth:k.uncontrolledState.estimatedBandwidth,video_id:d.coreVideoPlayerMetaData.videoFBID,video_last_start_time_position:e,video_play_reason:k.controlledState.lastPlayReason,video_player_height:(H=d.dimensions)==null?void 0:H.height,video_player_width:(A=d.dimensions)==null?void 0:A.width,video_time_position:k.uncontrolledState.videoElementPlayheadPosition,web_client_revision:b("SiteData").client_revision};t={event_seq_num:++j.vplEventSequenceNumber,seq_num:o.has(g)?++j.sequenceNumber:null,time_ms:Date.now()};var I={};c.forEach(function(a,b){I[b]=a});r=babelHelpers["extends"]({},I,u,h,t);F=(E=j.initialSuborigin)!=null?E:d.coreVideoPlayerMetaData.subOrigin;p=(C=r.source_VPL_LOGGING_HACK)!=null?C:F;m=(q=d.coreVideoPlayerMetaData.initialTracePolicy)!=null?q:d.coreVideoPlayerMetaData.routeTracePolicy;e={eventType:g,logData:r,routeTracePolicy:m,source_VPL_LOGGING_HACK:p};f.push(e);v(i,k,g);j.initialSuborigin==null&&F!=null&&(j.initialSuborigin=F);j.lastLoggedFullscreenState=B;j.lastLoggedPlaybackSpeed=G;g==="viewability_changed"&&(j.lastLoggedViewabilityPercentage=D)}var C={};function D(a,b,c){B({eventType:"requested_playing",logDataOverrides:babelHelpers["extends"]({},c,A()),prevState:a,state:b});j.hasPendingRequestedPlaying=!0;j.canLogPausedOrFinishedPlaying=!0;return C}function E(a,b,c){if(!j.canLogPausedOrFinishedPlaying)return C;else if(j.hasPendingRequestedPlaying){F(a,b,c);j.canLogPausedOrFinishedPlaying=!1;j.hasPendingRequestedPlaying=!1;return C}else{B({eventType:"paused",logDataOverrides:c,prevState:a,state:b});j.canLogPausedOrFinishedPlaying=!1;j.hasPendingRequestedPlaying=!1;return C}}function F(a,b,c){B({eventType:"cancelled_requested_playing",logDataOverrides:babelHelpers["extends"]({},c,A()),prevState:a,state:b});return C}function G(a,b,c){if(c.type==="dom_event_play_promise_rejected"&&j.hasPendingRequestedPlaying){c=c.payload.playPromiseRejectionReason;if(c!=null&&c.name==="NotAllowedError"){F(a,b,{debug_reason:"not_allowed"});return C}else return C}else return C}function H(a,b,c){if((c.type==="controller_play_requested"||c.type==="dom_event_play"&&!j.shouldIgnoreDomPlay)&&a.controlledState.playbackState!==b.controlledState.playbackState){c=b.uncontrolledState.liveTraceContext;c=c?{live_trace_source_id:c.sourceId,live_trace_stream_id:c.streamId,live_trace_stream_type:c.streamType}:null;D(a,b,c);return C}else return C}function I(a,b,c){if(a.controlledState.playbackState==="stalling"&&b.controlledState.playbackState==="playing"&&j.canLogPlayingEvent){B({eventType:j.hasLoggedStartedPlaying?"unpaused":"started_playing",prevState:a,state:b});j.hasLoggedStartedPlaying=!0;j.canLogPlayingEvent=!1;j.hasPendingRequestedPlaying=!1;return C}else return C}function J(a,c,d){var e=c.controlledState.playbackState,f=a.controlledState.playbackState;if(d.type==="controller_scrub_begin_requested"&&!a.controlledState.scrubbing&&e!=="paused"&&e!=="ended"){E(a,c);j.isLoggingScrubbingSequence=!0;return C}else if(!a.controlledState.seeking&&c.controlledState.seeking&&!j.isLoggingScrubbingSequence&&e!=="paused"&&e!=="ended"&&!j.hasPendingRequestedPlaying){E(a,c);j.shouldLogRequestedPlayingForScrub=!0;return C}else if(d.type==="controller_scrub_end_requested"&&a.controlledState.scrubbing&&e!=="paused"&&e!=="ended"){D(a,c,{video_time_position:d.payload.seekTargetPosition});return C}else if(a.controlledState.seeking&&!c.controlledState.seeking){d=c.uncontrolledState.videoElementPlayheadPosition;var g=a.controlledState.implementationSeekSourcePosition;(!b("gkx")("1482680")||g!=null&&d!=null&&Math.abs(g-d)>i)&&(j.shouldLogRequestedPlayingForScrub&&e!=="paused"&&e!=="ended"&&D(a,c),B({eventType:"scrubbed",prevState:a,state:c}),j.isLoggingScrubbingSequence=!1,j.shouldLogRequestedPlayingForScrub=!1,f!=="paused"&&f!=="ended"&&(j.canLogPlayingEvent=!0));return C}else return C}function K(a,b,c){if(a.controlledState.playbackState!==b.controlledState.playbackState&&b.controlledState.playbackState==="ended"&&j.canLogPausedOrFinishedPlaying){B({eventType:"finished_playing",prevState:a,state:b});j.canLogPausedOrFinishedPlaying=!1;return C}else return C}function L(a,b,c){if((c.type==="controller_pause_requested"||c.type==="dom_event_pause"&&!j.shouldIgnoreDomPause)&&a.controlledState.playbackState!==b.controlledState.playbackState){E(a,b);return C}else return C}function M(a,c,d){var e=c.controlledState.playbackState;if(e!=="paused"&&e!=="ended"){b("gkx")("1469813")&&d.type==="implementation_video_node_unmounted"?E(a,a,{debug_reason:"unloaded"}):(d.type==="implementation_unmounted"||d.type==="implementation_engine_destroy_requested")&&E(a,c,{debug_reason:"unloaded"});return C}else return C}function N(a,c,d){d=c.controlledState.muted;var e=c.controlledState.volume,f=a.controlledState.muted,g=a.controlledState.volume;d=b("VideoPlayerMutedStateChange").getVideoPlayerMutedStateChange({currMuted:d,currVolume:e,prevMuted:f,prevVolume:g});f={current_volume:Math.round(e*100)};switch(d){case"muted":B({eventType:"muted",logDataOverrides:f,prevState:a,state:c});return C;case"unmuted":B({eventType:"unmuted",logDataOverrides:f,prevState:a,state:c});return C;case null:if(g<e){B({eventType:"volume_increase",logDataOverrides:f,prevState:a,state:c});return C}else if(g>e){B({eventType:"volume_decrease",logDataOverrides:f,prevState:a,state:c});return C}else return C;default:d;b("recoverableViolation")('Unexpected mutedStateChange "'+d+'"',"comet_video_player");return C}}function O(a,b,c){c=b.uncontrolledState.videoRepresentationID;var d=j.lastTrackedRepresentation,e=b.controlledState.playbackState,f=b.controlledState.seeking;if(!f&&e!=="paused"&&e!=="ended"&&d!=null&&d!==c){B({eventType:"representation_ended",logDataOverrides:{next_representation_id:c,representation_id:d},prevState:a,state:b});j.lastTrackedRepresentation=c;q("quality_change");return C}else if(d==null&&d!==c){j.lastTrackedRepresentation=c;return C}else return C}function P(a,c){var e=a.controlledState.error;return{currentVideo:{audioStreamId:a.uncontrolledState.audioRepresentationID,dashAudioFormat:void 0,hasHD:void 0,hasRateLimit:void 0,hasSubtitles:a.controlledState.captionsLoaded,isDrm:Boolean(d.coreVideoPlayerMetaData.graphQLVideoDRMInfo),isHD:void 0,isLiveStream:d.coreVideoPlayerMetaData.isLiveStreaming,isRateLimited:void 0,liveManifestUrl:void 0,projection:void 0,resourceUrl:void 0,streamId:a.uncontrolledState.videoRepresentationID,streamType:a.streamingFormat,tagHD:void 0,tagSD:void 0,videoID:d.coreVideoPlayerMetaData.videoFBID},player:{canPlayType:(g||(g=b("mapObject")))(b("VideoMimeTypes"),k),dimensions:d.dimensions?{height:d.dimensions.height,width:d.dimensions.width}:null,droppedFrames:a.uncontrolledState.videoElementDroppedFrameCount,inPlayStallCount:void 0,inPlayStallTime:void 0,initializationTime:void 0,initializationTimestamp:void 0,interruptCount:void 0,interruptTime:void 0,lastError:e,loggedError:j.lastLoggedError,stack:e==null?void 0:e.stack,stallCount:j.stallCount,stallTime:j.stallDuration,state:z(a),totalFrames:a.uncontrolledState.videoElementTotalFrameCount,version:a.playerVersion,videoSource:void 0,viewabilityPercentage:a.uncontrolledState.viewabilityPercentage},playerStateMachine:{action:c,state:a}}}function Q(a,c,d){var e=c.controlledState.error;if(e!=null&&e!==j.lastLoggedError&&e.errorCode!=="410"){var f=e.errorDescription,g=e.errorName,h=e.url,i=e.errorCode==null||e.errorCode===""?g:e.errorCode;d=P(c,d);B({eventType:"error",logDataOverrides:babelHelpers["extends"]({},b("gkx")("1565232")?A():null,{error:g,error_code:i,error_description:f,error_domain:g,error_user_info:JSON.stringify(d),resource_url:h}),prevState:a,state:c});j.lastLoggedError=e}return C}function R(a,b,c){if(!l)return C;var d=b.uncontrolledState.videoElementPlaybackRate;c.type==="dom_event_ratechange"&&j.lastLoggedPlaybackSpeed!=null&&d!==0&&d!==j.lastLoggedPlaybackSpeed&&B({eventType:"playback_speed_changed",prevState:a,state:b});return C}function S(a,b,c){c=b.controlledState.playbackState;c==="paused"||c==="ended"?j.nextHeartbeatTime=null:c!=="stalling"&&j.nextHeartbeatTime==null&&(j.nextHeartbeatTime=Date.now()+h);var d=j.nextHeartbeatTime;if(d!=null){var e=Date.now();e>=d&&(c!=="stalling"&&B({eventType:"heart_beat",prevState:a,state:b}),j.nextHeartbeatTime=e+h)}return C}function T(a,b,c){if(c.type==="implementation_mounted"){B({eventType:"player_loaded",prevState:a,state:b});return C}else return C}function U(a,b,c){B({eventType:c?"entered_fs":"exited_fs",prevState:a,state:b})}function V(a,b,c){c=d.coreVideoPlayerMetaData.playerFormat;e.coreVideoPlayerMetaData.playerFormat!==c&&B({eventType:"player_format_changed",prevState:a,state:b});return C}function W(a,b,c){if(c.type==="dom_event_timeupdate"){c=j.nextPlayedThreeSecondsPlayheadPosition;if(c!=null){var d=b.uncontrolledState;d=d.videoElementPlayheadPosition;d!=null&&c<=d&&(B({eventType:"played_for_three_seconds",prevState:a,state:b}),j.nextPlayedThreeSecondsPlayheadPosition=null)}}return C}function X(a,b,c){if(c.type!=="notify_fullscreen_changed")return C;c=j.lastLoggedFullscreenState;var d=b.uncontrolledState.isFullscreen;if(c!==!0&&d===!0){U(a,b,d);return C}else if(c===!0&&d===!1){U(a,b,d);return C}else return C}function Y(a,c,e){e=d.coreVideoPlayerMetaData.adClientToken;if((e==null||e==="")&&b("gkx")("1401747"))return C;e=c.controlledState.playbackState;var f=j.lastLoggedViewabilityPercentage,g=c.uncontrolledState.viewabilityPercentage;if(e!=="paused"&&e!=="ended"&&f!=null&&f!==g){B({eventType:"viewability_changed",prevState:a,state:c});return C}else return C}function Z(a,b,c){if(c.type==="controller_set_captions_visible_requested"){B({eventType:"caption_change",prevState:a,state:b});return C}else return C}function $(a){e=d;if(a.type==="notify_logging_metadata_change"){a=a.payload.loggingMetaData;d=a}}return{addDebugSubscriber:function(a){return p(a)},consumeLoggerEvents:function(){var a=f.splice(0);return a},getLoggerState:function(){return j},handleStateMachine:function(a,b,c){$(c);var d=b.controlledState.playbackState;u(a,b);t(a,b);var e=[V,X,Y,G,H,J,I,K,L,N,M,T,Z,O,Q,S,R,W];e.forEach(function(d){d(a,b,c)});(d==="paused"||d==="ended")&&(j.canLogPlayingEvent=!0);c.type==="controller_pause_requested"&&(j.hasPausedOnce=!0,j.shouldIgnoreDomPause=!0);c.type==="controller_play_requested"&&(j.hasPausedOnce=!0,j.shouldIgnoreDomPlay=!0);c.type==="dom_event_pause"&&(j.shouldIgnoreDomPause=!1);c.type==="dom_event_play"&&(j.shouldIgnoreDomPlay=!1,j.lastLoggedViewabilityPercentage=b.uncontrolledState.viewabilityPercentage)},logVPLEvent:function(a){var b=a.eventType,c=a.logDataOverrides;a=a.state;B({eventType:b,logDataOverrides:c,prevState:a,state:a})},setAdditionalLogData:function(a,b){c.set(a,b)}}}}),null);
__d("convertToViewabilityPercentage",[],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a){if(a>=.99)return 100;else if(a>=.75)return 75;else if(a>=.5)return 50;else if(a>=.25)return 25;else if(a>=0)return 0;else return-2}}),null);
__d("VideoPlayerImplementationStateMachineStateUncontrolledState",["convertToViewabilityPercentage","gkx"],(function(a,b,c,d,e,f){"use strict";f.createVideoPlayerImplementationStateMachineStateUncontrolledState=a;function a(a){var c=a.engineExtrasAPI,d=a.fullscreenControllerRef,e=a.videoElementAPI,f=a.videoLiveTraceRef;a=a.videoPlayerPassiveViewabilityInfoRef;f=f.current;if(e==null){var g={audioRepresentationID:void 0,clockTimestamp:Date.now(),currentPlayingVideoQuality:void 0,estimatedBandwidth:void 0,isFBIsLiveTemplated:void 0,isFBMS:void 0,isFBWasLive:void 0,isFullscreen:d.current?d.current.getIsFullscreen():void 0,isPredictiveDash:void 0,liveTraceContext:f?f.getLiveTraceContext():void 0,videoElementDebugCurrentSrc:void 0,videoElementDebugSrc:void 0,videoElementDroppedFrameCount:void 0,videoElementDuration:void 0,videoElementEnded:void 0,videoElementError:void 0,videoElementLastBufferEndPosition:void 0,videoElementMuted:void 0,videoElementNetworkState:void 0,videoElementPaused:void 0,videoElementPlaybackRate:void 0,videoElementPlayheadPosition:void 0,videoElementReadyState:void 0,videoElementTotalFrameCount:void 0,videoElementVolume:void 0,videoRepresentationID:void 0,viewabilityPercentage:void 0};return g}g=e.getPlayheadPosition();a=a&&a.current;a=a&&a.getCurrent();d={audioRepresentationID:c?c.getAudioRepresentationIDAtTime(g):void 0,clockTimestamp:Date.now(),currentPlayingVideoQuality:c?c.getCurrentPlayingVideoQuality():void 0,estimatedBandwidth:c?c.getEstimatedBandwidth():void 0,isFBIsLiveTemplated:c?c.isFBIsLiveTemplated():void 0,isFBMS:c?c.isFBMS():void 0,isFBWasLive:c?c.isFBWasLive():void 0,isFullscreen:d.current?d.current.getIsFullscreen():void 0,isPredictiveDash:c?c.isPredictiveDash():void 0,liveTraceContext:f?f.getLiveTraceContext():void 0,videoElementDebugCurrentSrc:b("gkx")("1526990")?(d=e.getUnderlyingVideoElement())==null?void 0:d.currentSrc:void 0,videoElementDebugSrc:b("gkx")("1526990")?(f=e.getUnderlyingVideoElement())==null?void 0:f.src:void 0,videoElementDroppedFrameCount:e.getDroppedFrameCount(),videoElementDuration:e.getDuration(),videoElementEnded:e.getEnded(),videoElementError:e.getError(),videoElementLastBufferEndPosition:e.getLastBufferEndPosition(),videoElementMuted:e.getMuted(),videoElementNetworkState:e.getNetworkState(),videoElementPaused:e.getPaused(),videoElementPlaybackRate:e.getPlaybackRate(),videoElementPlayheadPosition:g,videoElementReadyState:e.getReadyState(),videoElementTotalFrameCount:e.getTotalFrameCount(),videoElementVolume:e.getVolume(),videoRepresentationID:c?c.getVideoRepresentationIDAtTime(g):void 0,viewabilityPercentage:a?b("convertToViewabilityPercentage")(a.visiblePercentage):void 0};return d}}),null);
__d("VideoPlayerImplementationStateMachineState",["VideoPlayerImplementationStateMachineStateUncontrolledState"],(function(a,b,c,d,e,f){"use strict";f.createVideoPlayerImplementationStateMachineInitialState=a;function a(a){var c=a.alwaysShowCaptions,d=a.areCaptionsAutogenerated,e=a.dimensions,f=a.isAbrEnabled,g=a.playerImplementationName,h=a.playerVersion;a=a.streamingFormat;var i=!0,j=1,k=b("VideoPlayerImplementationStateMachineStateUncontrolledState").createVideoPlayerImplementationStateMachineStateUncontrolledState({engineExtrasAPI:null,fullscreenControllerRef:{current:null},videoElementAPI:null,videoLiveTraceRef:{current:null},videoPlayerPassiveViewabilityInfoRef:{current:null}});return{controlledState:{activeCaptions:null,availableQualities:[],bufferingDetected:!1,captionsLoaded:!1,captionsVisible:c,dimensions:e,error:null,hostCallPlayIDLast:null,hostCallQueue:[],implementationSeekSourcePosition:null,inbandCaptionsAutogenerated:d,isLiveRewindActive:!1,lastBufferingType:null,lastMuteReason:null,lastPauseReason:null,lastPausedTimeMs:0,lastPlayReason:null,lastPlayedTimeMs:0,latencyLevel:"normal",loopCount:0,loopCurrent:0,muted:i,playbackState:"paused",scrubbing:!1,seekTargetPosition:null,seekableRanges:null,seeking:!1,selectedVideoQuality:"notselected",streamEnded:!1,streamInterrupted:!1,targetAudioQuality:"",targetPlaybackRate:1,targetVideoQuality:"",videoProjection:null,volume:j,waitingForDomPlaying:!1,waitingForDomTimeUpdateAfterSeeked:!1,watchTimeMs:0},isAbrEnabled:f,playerImplementationName:g,playerVersion:h,streamingFormat:a,uncontrolledState:k}}}),null);
__d("VideoPlayerODS",["ODS","Random"],(function(a,b,c,d,e,f){"use strict";a=function(a,c,d){b("Random").coinflip(d)&&b("ODS").bumpEntityKey(2079,a,c,d)};f.bumpEntityKey=a}),null);
__d("VideoPlayerImplementationEngineAPI",["Banzai","ErrorMetadata","FBLogger","NetworkStatus","PlaybackSpeedExperiments","React","RunComet","SubscriptionsHandler","VideoPlayerBanzaiLogFlusher","VideoPlayerCaptionsController","VideoPlayerImplementationErrors","VideoPlayerImplementationStateMachine","VideoPlayerImplementationStateMachineHostCallQueue","VideoPlayerImplementationStateMachineLogger","VideoPlayerImplementationStateMachineState","VideoPlayerImplementationStateMachineStateUncontrolledState","VideoPlayerODS","clearTimeout","deepEquals","err","gkx","killswitch","recoverableViolation","removeFromArray","requireCond","setTimeout","unrecoverableViolation","useConcurrentAutoplayManagementAPI","useStable","cr:683059"],(function(a,b,c,d,e,f){"use strict";f.internal_createVideoPlayerImplementationControllerImpl=j;f.internal_createVideoPlayerImplementationEngineStateMachineWithEffects=m;f.internal_createVideoPlayerImplementationExposedStateFromStateMachineState=q;f.createVideoPlayerImplementationEngine=a;f.useVideoPlayerImplementationEngine=c;var g=b("React"),h=6e4,i=function(){function a(a){var b=a.pauseRequestCallbacks,c=a.playRequestCallbacks,d=a.scrubBeginRequestCallbacks;a=a.scrubEndRequestCallbacks;this.$1=c;this.$2=b;this.$3=d;this.$4=a}var c=a.prototype;c.playRequest=function(a){var c=this;this.$1.push(a);return function(){b("removeFromArray")(c.$1,a)}};c.pauseRequest=function(a){var c=this;this.$2.push(a);return function(){b("removeFromArray")(c.$2,a)}};c.scrubBeginRequest=function(a){var c=this;this.$3.push(a);return function(){b("removeFromArray")(c.$3,a)}};c.scrubEndRequest=function(a){var c=this;this.$4.push(a);return function(){b("removeFromArray")(c.$4,a)}};return a}();function j(a){var c=a.concurrentAutoplayManagementAPI,d=a.debugAPI,e=a.fullscreenControllerRef,f=a.getCurrentExposedState,g=a.getCurrentIsFullscreen,h=a.getCurrentLiveRewindPlayheadPosition,j=a.getCurrentPlayheadPosition,k=a.loggerAPI,l=a.pauseImpl,m=a.playImpl,n=a.scrubBeginImpl,o=a.scrubEndImpl,p=a.seekImpl,q=a.selectVideoQualityImpl,r=a.setCaptionsVisibleImpl,s=a.setIsLiveRewindActiveImpl,t=a.setLatencyLevelImpl,u=a.setMutedImpl,v=a.setPlaybackRateImpl,w=a.setVolumeImpl,x=a.subscribers,y=a.videoElementAPIRef,z=new Set(),A=!1,B=null,C=[],D=[],E=[],F=[],G=new i({pauseRequestCallbacks:D,playRequestCallbacks:C,scrubBeginRequestCallbacks:E,scrubEndRequestCallbacks:F}),H={freeze:function(){if(!f().paused)throw b("unrecoverableViolation")("Video player must be paused before the controller freeze","comet_video_player");var a={};try{var c=!1;z.size===0&&(c=!0,B={exposedState:f(),isFullscreen:g(),liveRewindPlayheadPosition:h(),playheadPosition:j()});z.add(a);c&&(A=!0,x.forEach(function(a){a()}))}finally{A=!1}return a},isFrozen:function(){return B!=null},unfreeze:function(a){if(!z.has(a))throw b("unrecoverableViolation")("Video player controller unfreeze token not found","comet_video_player");z["delete"](a);z.size===0&&(B=null,x.forEach(function(a){a()}))}},I=babelHelpers["extends"]({},c,H,k,{debugAPI:d,getCurrentState:function(){return B!=null?B.exposedState:f()},getIsFullscreen:function(){return B!=null?B.isFullscreen:g()},getLiveRewindPlayheadPosition:function(){return B!=null?B.liveRewindPlayheadPosition:h()},getPlayheadPosition:function(){return B!=null?B.playheadPosition:j()},internal_getVideoElement:function(){var a=y.current;if(a!=null){a=a.getUnderlyingVideoElement();return a}return null},observeOn:function(){return G},pause:function(a){if(H.isFrozen())return;D.forEach(function(b){return b(a)});l(a)},play:function(a){if(H.isFrozen())return;C.forEach(function(b){return b(a)});m(a)},requestSetIsFullscreen:function(a){if(H.isFrozen())return;var b=e.current;b&&b.requestSetIsFullscreen(a)},scrollIntoView:function(a){var b=I.internal_getVideoElement();b&&b.scrollIntoView(a)},scrubBegin:function(){if(H.isFrozen())return;E.forEach(function(a){return a()});n()},scrubEnd:function(a){if(H.isFrozen())return;F.forEach(function(b){return b(a)});o(a)},seek:function(a){if(H.isFrozen())return;p(a)},selectVideoQuality:function(a){if(H.isFrozen())return;q(a)},setCaptionsVisible:function(a){if(H.isFrozen())return;r(a)},setIsLiveRewindActive:function(a){if(H.isFrozen())return;s(a)},setLatencyLevel:function(a){if(H.isFrozen())return;t(a)},setMuted:function(a,b){if(H.isFrozen())return;u(a,b)},setPlaybackRate:function(a){if(H.isFrozen())return;v(a)},setVolume:function(a){if(H.isFrozen())return;w(a)},subscribe:function(a){var c=function(){if(H.isFrozen()&&!A)return;a()},d=e.current,f=d?d.subscribe(c):null;x.push(c);return{remove:function(){f&&f.remove(),b("removeFromArray")(x,c)}}},videoElementAPIRef:y});return I}function k(a){var b=a.concurrentAutoplayManagementAPI,c=a.createExposedState,d=a.debugAPI,e=a.fullscreenControllerRef,f=a.logger,g=a.machine,h=a.subscribers;a=a.videoElementAPIRef;var i={setAdditionalLogData:function(a,b){f.setAdditionalLogData(a,b)}};return j({concurrentAutoplayManagementAPI:b,debugAPI:d,fullscreenControllerRef:e,getCurrentExposedState:function(){return c(g.getCurrentState())},getCurrentIsFullscreen:function(){var a=e.current;return a?a.getIsFullscreen():!1},getCurrentLiveRewindPlayheadPosition:function(){var a=g.getCurrentState();a=a.controlledState;var b=a.isLiveRewindActive,c=a.seekableRanges;a=a.seekTargetPosition;if(!b||a==null)return null;c=(b=c==null?void 0:c.end(0))!=null?b:0;return a-c},getCurrentPlayheadPosition:function(){var a,b=0;return(a=g.getCurrentState().uncontrolledState.videoElementPlayheadPosition)!=null?a:b},loggerAPI:i,pauseImpl:function(a){g.dispatch({payload:{reason:a},type:"controller_pause_requested"})},playImpl:function(a){g.dispatch({payload:{reason:a},type:"controller_play_requested"})},scrubBeginImpl:function(){g.dispatch({type:"controller_scrub_begin_requested"})},scrubEndImpl:function(a){g.dispatch({payload:{seekTargetPosition:a},type:"controller_scrub_end_requested"})},seekImpl:function(a){g.dispatch({payload:{seekTargetPosition:a},type:"controller_seek_requested"})},selectVideoQualityImpl:function(a){g.dispatch({payload:{selectedVideoQuality:a},type:"controller_quality_requested"})},setCaptionsVisibleImpl:function(a){g.dispatch({payload:{captionsVisible:a},type:"controller_set_captions_visible_requested"})},setIsLiveRewindActiveImpl:function(a){g.dispatch({payload:{isLiveRewindActive:a},type:"controller_set_is_live_rewind_active_requested"})},setLatencyLevelImpl:function(a){g.dispatch({payload:{latencyLevel:a},type:"controller_set_latency_level_requested"})},setMutedImpl:function(a,b){g.dispatch({payload:{muted:a,reason:b},type:"controller_muted_requested"})},setPlaybackRateImpl:function(a){g.dispatch({payload:{playbackRate:a},type:"controller_set_playback_rate"})},setVolumeImpl:function(a){g.dispatch({payload:{volume:a},type:"controller_volume_requested"})},subscribers:h,videoElementAPIRef:a})}function l(a){a=a.current;if(a==null)throw b("unrecoverableViolation")("Attempted to access VideoElementAPI while it is not available.","comet_video_player");return a}function m(a){var c=a.alwaysShowCaptions,d=a.areCaptionsAutogenerated,e=a.captionsControllerRef,f=a.debugLogId,g=a.dimensions,i=a.engineExtrasAPI,j=a.engineMetadata,k=a.fullscreenControllerRef,m=a.handleFatalError,o=a.handleStateMachine,p=a.videoElementAPIRef,q=a.videoLiveTraceRef,r=a.videoPlayerPassiveViewabilityInfoRef;function s(a){b("VideoPlayerImplementationStateMachineHostCallQueue").applyOrQueueHostCall({engineExtrasAPI:i,hostCall:a,machine:v,videoElementAPI:p.current})}var t=null,u=null;a=[function(a,c,d){b("cr:683059")&&d.type==="implementation_host_call_applied"&&d.payload.hostCall.type==="host_call_play"&&c.controlledState.lastPlayReason==="autoplay_initiated"?b("cr:683059").addFirstMarkerPoint("firstVideoAutoplayStalling"):b("cr:683059")&&c.controlledState.playbackState!==a.controlledState.playbackState&&c.controlledState.playbackState==="playing"&&c.controlledState.lastPlayReason==="autoplay_initiated"&&b("cr:683059").addFirstMarkerPoint("firstVideoAutoplayPlaying");return!0},function(a,b,c){o(a,b,c);return!0},function(a,c,d){if(b("gkx")("1633455")&&(a.controlledState.streamInterrupted===!1&&c.controlledState.streamInterrupted===!0||a.controlledState.streamInterrupted===!0&&c.controlledState.streamInterrupted===!1)){a=c.controlledState;c=a.bufferingDetected;var e=a.lastBufferingType,f=a.streamInterrupted;a=a.targetPlaybackRate;f?(c&&v.dispatch({type:"buffering_end_requested"}),s({payload:{hostCallID:b("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),playbackRate:0,reason:d.type},type:"host_call_set_playback_rate"})):(s({payload:{hostCallID:b("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),playbackRate:a,reason:d.type},type:"host_call_set_playback_rate"}),c&&v.dispatch({payload:{bufferingType:e||"in_play"},type:"buffering_begin_requested"}))}return!0},function(a,c,d){if(a.controlledState.bufferingDetected===!1&&c.controlledState.bufferingDetected===!0||a.controlledState.bufferingDetected===!0&&c.controlledState.bufferingDetected===!1){t!==null&&(b("clearTimeout")(t),t=null);if(c.controlledState.bufferingDetected&&(!b("gkx")("1633455")||!c.controlledState.streamInterrupted)){d=function a(){t=null;if(b("gkx")("1849507")&&!b("NetworkStatus").isOnline())t=b("setTimeout")(a,h);else{var c=b("VideoPlayerImplementationErrors").createVideoPlayerErrorFromGenericError("BUFFERING_TIMEOUT",b("err")("The video has been in a buffering state for over "+h+" ms."),"buffering_timeout");u&&(u.log(),u=null);v.dispatch({payload:{fatalError:c},type:"implementation_fatal_error"})}};t=b("setTimeout")(d,h);a=i.getPerfLoggerProvider();u=a?a.getOperationLogger("buffering").setType(c.controlledState.lastBufferingType||"in_play"):null}else!c.controlledState.bufferingDetected&&u!=null&&(u.log(),u=null)}return!0},function(a,c,d){if(!(d.type==="implementation_engine_destroy_requested"))return!0;t!==null&&b("clearTimeout")(t);t=null;return!1},function(a,c,d){if(!(d.type==="implementation_engine_initialized"))return!0;a=l(p);d=d.type;b("VideoPlayerImplementationStateMachineHostCallQueue").flushHostCallQueue({engineExtrasAPI:i,machine:v,reason:d,state:c,videoElementAPI:a});return!1},function(a,b,c){if(!(c.type==="dom_event_ended"))return!0;a=b.controlledState;(a.loopCount>0&&a.loopCurrent<a.loopCount||a.loopCount===-1)&&v.dispatch({payload:{reason:"loop_initiated"},type:"controller_play_requested"});return!1},function(a,c,d){if(!(d.type==="controller_pause_requested"))return!0;a=c.controlledState.playbackState;if(!(a==="paused"))return!1;s({payload:{hostCallID:b("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),reason:d.type},type:"host_call_pause"});return!1},function(a,c,d){if(!(d.type==="controller_play_requested"))return!0;a=c.controlledState.playbackState;if(!(a==="stalling"))return!1;s({payload:{hostCallID:b("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),reason:d.type},type:"host_call_play"});return!1},function(a,c,d){if(!(d.type==="controller_seek_requested"))return!0;a=c.controlledState;c=a.seeking;a=a.seekTargetPosition;c&&a!=null&&s({payload:{currentTime:a,hostCallID:b("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),reason:d.type},type:"host_call_set_current_time"});return!1},function(a,c,d){if(!(d.type==="controller_muted_requested"))return!0;a=c.controlledState.muted;if(!(a===d.payload.muted))return!1;s({payload:{hostCallID:b("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),muted:a,reason:d.type},type:"host_call_set_muted"});return!1},function(a,c,d){if(!(d.type==="controller_scrub_begin_requested"))return!0;s({payload:{hostCallID:b("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),playbackRate:0,reason:d.type},type:"host_call_set_playback_rate"});return!1},function(a,c,d){if(!(d.type==="controller_scrub_end_requested"))return!0;a=c.controlledState;c=a.seeking;var e=a.seekTargetPosition;a=a.targetPlaybackRate;c&&e!=null?(s({payload:{hostCallID:b("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),playbackRate:a,reason:d.type+":seek"},type:"host_call_set_playback_rate"}),s({payload:{currentTime:e,hostCallID:b("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),reason:d.type+":seek"},type:"host_call_set_current_time"})):s({payload:{hostCallID:b("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),playbackRate:a,reason:d.type+":cancel"},type:"host_call_set_playback_rate"});return!1},function(a,c,d){if(!(d.type==="buffering_begin_requested"))return!0;s({payload:{hostCallID:b("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),playbackRate:0,reason:d.type},type:"host_call_set_playback_rate"});return!1},function(a,c,d){if(!(d.type==="controller_set_playback_rate"))return!0;s({payload:{hostCallID:b("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),playbackRate:d.payload.playbackRate,reason:d.type},type:"host_call_set_playback_rate"});return!1},function(a,c,d){if(!(d.type==="buffering_end_requested"))return!0;s({payload:{hostCallID:b("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),playbackRate:c.controlledState.targetPlaybackRate,reason:d.type},type:"host_call_set_playback_rate"});return!1},function(a,c,d){if(!(d.type==="controller_volume_requested"))return!0;s({payload:{hostCallID:b("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),reason:d.type,volume:c.controlledState.volume},type:"host_call_set_volume"});return!1},function(a,c,d){if(!(d.type==="controller_quality_requested"))return!0;s({payload:{hostCallID:b("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),reason:d.type,selectedVideoQuality:c.controlledState.selectedVideoQuality},type:"host_call_set_video_quality"});return!1},function(a,c,d){if(!(d.type==="controller_set_latency_level_requested"||d.type==="implementation_set_latency_level_requested"))return!0;s({payload:{hostCallID:b("VideoPlayerImplementationStateMachineHostCallQueue").makeHostCallID(),latencyLevel:d.payload.latencyLevel,reason:d.type},type:"host_call_set_latency_level"});return!1},function(a,c,d){if(!(d.type==="dom_event_timeupdate"||d.type==="captions_loaded"))return!0;d=e.current;var f=c.controlledState.captionsVisible,g=p.current;g=g?g.getPlayheadPosition():0;if(b("PlaybackSpeedExperiments").enableCometPlaybackSpeedControl()&&c.controlledState.isLiveRewindActive){var h=c.controlledState.seekableRanges;h=h!=null?(h=h.end(h.length()-1))!=null?h:0:0;g>=h&&v.dispatch({payload:{isLiveRewindActive:!1},type:"controller_set_is_live_rewind_active_requested"})}if(d&&f&&c.controlledState.captionsLoaded){h=d.handleTimeUpdate(g);f=a.controlledState.activeCaptions;n(f,h)&&v.dispatch({payload:{activeCaptions:h},type:"controller_set_active_captions_requested"})}c=q.current;c!=null&&c.onUpdateStatus({position:g});return!1},function(a,b,c){if(!(c.type==="cea608_bytes_received"))return!0;a=e.current;if(a){b=c.payload;c=b.timescale;b=b.videoBytes;a.handleCea608BytesReceived({timescale:c,videoBytes:b})}return!1},function(a,c,d){if(!(d.type==="controller_set_is_live_rewind_active_requested"))return!0;i.setEnableLiveheadCatchup(!d.payload.isLiveRewindActive);!!b("PlaybackSpeedExperiments").enableCometPlaybackSpeedControl()&&!d.payload.isLiveRewindActive&&v.dispatch({payload:{playbackRate:1},type:"controller_set_playback_rate"});return!1}];var v=b("VideoPlayerImplementationStateMachine").createVideoPlayerImplementationStateMachineWithStateTransitionHandlers({collectUncontrolledState:function(){var a=p.current;return b("VideoPlayerImplementationStateMachineStateUncontrolledState").createVideoPlayerImplementationStateMachineStateUncontrolledState({engineExtrasAPI:i,fullscreenControllerRef:k,videoElementAPI:a,videoLiveTraceRef:q,videoPlayerPassiveViewabilityInfoRef:r})},debugLogId:f,initialState:b("VideoPlayerImplementationStateMachineState").createVideoPlayerImplementationStateMachineInitialState({alwaysShowCaptions:c,areCaptionsAutogenerated:d,dimensions:g,isAbrEnabled:j.isAbrEnabled,playerImplementationName:j.playerImplementationName,playerVersion:j.playerVersion,streamingFormat:j.streamingFormat}),onFatalError:m,stateTransitionHandlers:a});return v}function n(a,b){if(a===null&&b===null)return!1;if(a===null||b===null)return!0;var c=(b=b.rows)!=null?b:[];a=(b=a.rows)!=null?b:[];return a.length!==c.length||a.some(function(a,b){return a!==c[b]})}function o(a,b,c,d){a!==b.current&&(c.current&&(c.current.remove(),c.current=null),b.current=a),b.current&&!c.current&&(c.current=b.current.subscribe(function(){d.dispatch({type:"notify_fullscreen_changed"})}))}function p(a,b,c,d){a!==b.current&&(c.current&&(c.current.remove(),c.current=null),b.current=a),b.current&&!c.current&&(c.current=b.current.subscribe(function(){d.dispatch({type:"notify_viewability_changed"})}))}function q(a){var b=a.engineMetadata;a=a.state;var c=a.controlledState,d=c.activeCaptions,e=c.availableQualities,f=c.captionsLoaded,g=c.captionsVisible,h=c.error,i=c.inbandCaptionsAutogenerated,j=c.isLiveRewindActive,k=c.lastMuteReason,l=c.lastPauseReason,m=c.lastPlayedTimeMs,n=c.lastPlayReason,o=c.latencyLevel,p=c.loopCount,q=c.loopCurrent,r=c.muted,s=c.playbackState,t=c.seekableRanges,u=c.seeking,v=c.seekTargetPosition,w=c.selectedVideoQuality,x=c.streamInterrupted,y=c.targetAudioQuality,z=c.targetPlaybackRate,A=c.targetVideoQuality,B=c.videoProjection,C=c.volume;c=c.watchTimeMs;var D=a.uncontrolledState,E=D.currentPlayingVideoQuality,F=D.videoElementDuration;D=D.videoElementLastBufferEndPosition;var G=s==="ended",H=s==="paused"||G,I=s==="playing",J=s==="inPlayStalling";s=s==="stalling"||J;d={activeCaptions:d,availableVideoQualities:e,bufferEnd:(d=D)!=null?d:0,captionsLoaded:f,captionsVisible:g,currentVideoQuality:(e=E)!=null?e:"",duration:(D=F)!=null?D:0,ended:G,error:h,inPlayStalling:J,inbandCaptionsAutogenerated:i,isAbrEnabled:b.isAbrEnabled,isLiveRewindActive:j,lastMuteReason:k,lastPauseReason:l,lastPlayReason:n,lastPlayedTimeMs:m,latencyLevel:o,loopCount:p,loopCurrent:q,muted:r,paused:H,playerImplementationName:a.playerImplementationName,playerVersion:a.playerVersion,playing:I,seekTargetPosition:v,seekableRanges:t,seeking:u,selectedVideoQuality:w,stalling:s,streamInterrupted:x,targetAudioQuality:y,targetPlaybackRate:z,targetVideoQuality:A,videoProjection:B,volume:C,watchTimeMs:c};return d}function a(a){var c,d=a.createDebugAPI,e=a.createVideoPlayerError,f=a.debugLog;f=a.debugLogId;var g=a.destroyEngineParts,h=a.engineExtrasAPI,i=a.engineMetadata,j=a.handleFatalError,l=a.handleVideoElementMounted,n=a.handleVideoElementUnmounted,r=a.handleVideoInfoChange,s=a.initialProps,t=a.setExposedStateInReact,u=b("VideoPlayerImplementationStateMachineLogger").createVideoPlayerImplementationStateMachineLogger({debugLogId:f,initialLoggingMetaData:s.loggingMetaData}),v=new(b("VideoPlayerBanzaiLogFlusher"))(u),w={current:(a=s.videoPlayerPassiveViewabilityInfo)!=null?a:null},x={current:(a=s.fullscreenController)!=null?a:null},y={current:null},z={current:(a=s.videoLiveTrace)!=null?a:null};a=b("useConcurrentAutoplayManagementAPI").createConcurrentAutoplayManagementAPI();var A=[],B=function(){A.forEach(function(a){a()}),v.flushLogs()},C={current:null},D={current:{inbandCaptionsAutogeneratedFromManifest:!1,inbandCaptionsExpectedFromManifest:!1,inbandCaptionsExpectedFromProps:s.inbandCaptionsExpected,sideLoadCaptionsExpectedFromProps:s.sideLoadCaptionsExpected,sideLoadCaptionsUrlFromProps:(c=s.captionsUrl)!=null?c:null}},E={current:null},F={current:null},G=new(b("SubscriptionsHandler"))(),H="before_mounted";function I(){return H==="mounted"}var J={current:null},K=function(a){a=q({engineMetadata:i,state:a});return a},L={current:null},M={current:null},N=function(a){if(I()){if(a===L.current)return;var c=K(a);if(M.current!=null&&b("deepEquals")(M.current,c))return;L.current=a;M.current=c;t(c)}};c=function(a,b,c){u.handleStateMachine(a,b,c),N(b),B()};var O=function(a,b){},P=function(a){O(a,"state_machine_fatal_error")},Q=m({alwaysShowCaptions:Boolean(s.alwaysShowCaptions),areCaptionsAutogenerated:Boolean(s.areCaptionsAutogenerated),captionsControllerRef:y,debugLogId:f,dimensions:s.dimensions,engineExtrasAPI:h,engineMetadata:i,fullscreenControllerRef:x,handleFatalError:P,handleStateMachine:c,videoElementAPIRef:J,videoLiveTraceRef:z,videoPlayerPassiveViewabilityInfoRef:w}),R=!1,S=function(a){var c=C.current!=null,d=J.current!=null;G.release();Q.dispatch({payload:{reason:a,videoElementAPIExisted:d,videoElementExisted:c},type:"implementation_engine_destroy_requested"});try{b("gkx")("1494163")?g(["destroyEngine("+a+")"]):R||(R=!0,g(["destroyEngine("+a+")"]))}catch(e){if(b("gkx")("1494163"))try{b("FBLogger")("comet_video_player").catching(e).warn("Error thrown by destroyEngineParts: %s %s",e.message,JSON.stringify({playerImplementationName:i.playerImplementationName,reason:a,videoElementAPIExisted:d,videoElementExisted:c}))}catch(a){}}var e=y.current;e!=null&&(Q.getCurrentState().controlledState.captionsLoaded&&Q.dispatch({type:"captions_unloaded"}),y.current=null,e.destroy());e=z.current;e!=null&&(z.current=null);o(null,x,E,Q);p(null,w,F,Q);Q.dispatch({payload:{reason:a,videoElementAPIExisted:d,videoElementExisted:c},type:"implementation_engine_destroyed"})};O=function(a,b){a=e(a,b);Q.dispatch({payload:{fatalError:a},type:"implementation_fatal_error"});S("implementation_fatal_error");j(a)};function T(a){return a.sideLoadCaptionsExpectedFromProps&&a.sideLoadCaptionsUrlFromProps!==null}function U(a){return a.inbandCaptionsExpectedFromProps&&((a=a.inbandCaptionsExpectedFromManifest)!=null?a:!1)}function V(a){return(a=a.inbandCaptionsAutogeneratedFromManifest)!=null?a:!1}var W=function(a){var c=T(a),d=U(a),e=V(a),f=y.current;e!==V(D.current)&&Q.dispatch({payload:{inbandCaptionsAutogenerated:e},type:"inband_captions_autogenerated_changed"});f!=null?d!==U(D.current)&&(f.updateInbandCaptionsExpected(d),!d&&Q.getCurrentState().controlledState.captionsLoaded&&Q.dispatch({type:"captions_unloaded"})):(c||d)&&f==null&&(y.current=b("VideoPlayerCaptionsController").createCaptionsController({captionsUrl:c?a.sideLoadCaptionsUrlFromProps:null,inbandCaptionsExpected:d,onCaptionsLoaded:function(){Q.getCurrentState().controlledState.captionsLoaded||Q.dispatch({type:"captions_loaded"})}}));D.current=a},X=function(a){h!=null&&a&&a.width>0&&a.height>0&&(h.setDimensions(a),Q.dispatch({payload:{dimensions:{height:a.height,width:a.width}},type:"player_dimensions_changed"}))},Y=function(a){a!==Q.getCurrentState().controlledState.loopCount&&Q.dispatch({payload:{loopCount:a},type:"loop_count_change_requested"})},Z=function(a){"srcObject"in a&&(a.srcObject=null)},$=function(a,c){if(C.current===a)return;if(!I()&&b("gkx")("1405244"))return;if(!I()){var d=function(a){switch(a){case"unmounted":return"EngineAPI.handleVideoElement.unmounted";case"before_mounted":return"EngineAPI.handleVideoElement.before_mounted";case"mounted":return null;default:a;return null}}(H);d&&b("VideoPlayerODS").bumpEntityKey("comet_video_player",d,1)}a!=null&&C.current!=null&&C.current!==a&&b("recoverableViolation")("The video element was recreated","comet_video_player");d=C.current;d&&Z(d);C.current=a;b("gkx")("1494163")&&(a==null&&(J.current=null));C.current!=null?(Q.dispatch({type:"implementation_video_node_mounted"}),l([].concat(c,["handleVideoElement(non-null)"]))):(Q.dispatch({type:"implementation_video_node_unmounted"}),n([].concat(c,["handleVideoElement(null)"])))};f=s.loggingMetaData.instanceKey;P=function(a){var b;if(!I())return;o((b=a.fullscreenController)!=null?b:null,x,E,Q);p((b=a.videoPlayerPassiveViewabilityInfo)!=null?b:null,w,F,Q);if(!r(a)){b={inbandCaptionsAutogeneratedFromManifest:D.current.inbandCaptionsAutogeneratedFromManifest,inbandCaptionsExpectedFromManifest:D.current.inbandCaptionsExpectedFromManifest,inbandCaptionsExpectedFromProps:a.inbandCaptionsExpected,sideLoadCaptionsExpectedFromProps:a.sideLoadCaptionsExpected,sideLoadCaptionsUrlFromProps:(b=a.captionsUrl)!=null?b:null};W(b);X(a.dimensions);Y((b=a.loopCount)!=null?b:0)}Q.dispatch({payload:{loggingMetaData:a.loggingMetaData},type:"notify_logging_metadata_change"})};c=function(){if(H!=="before_mounted"){var a=function(a){switch(a){case"before_mounted":return null;case"unmounted":return"EngineAPI.handleReactMount.unmounted";case"mounted":return"EngineAPI.handleReactMount.mounted";default:a;return null}}(H);a&&b("VideoPlayerODS").bumpEntityKey("comet_video_player",a,1)}I()||(H="mounted",G.addSubscriptions(b("RunComet").onUnload(function(){S("page_unload")})),G.addSubscriptions(b("Banzai").subscribe(b("Banzai").SHUTDOWN,function(){S("banzai_shutdown")})),Q.dispatch({type:"implementation_mounted"}),l(["handleReactMount"]))};s=function(){if(!I()){var a=function(a){switch(a){case"unmounted":return"EngineAPI.handleReactUnmount.unmounted";case"before_mounted":return"EngineAPI.handleReactUnmount.before_mounted";case"mounted":return null;default:a;return null}}(H);a&&b("VideoPlayerODS").bumpEntityKey("comet_video_player",a,1)}I()&&(H="unmounted",Q.dispatch({payload:{reason:"react_effect_cleanup"},type:"implementation_unmounted"}),S("implementation_unmounted:react_effect_cleanup"))};f=k({concurrentAutoplayManagementAPI:a,createExposedState:K,debugAPI:d({getVideoElementAPI:function(){return J.current},logger:u}),fullscreenControllerRef:x,logger:u,machine:Q,subscribers:A,videoElementAPIRef:J});a=b("VideoPlayerImplementationStateMachine").createReactVideoElementCallbacksForStateMachine(Q,$);d=K(Q.getInitialState());c={destroy:S,handleReactMount:c,handleReactPropsChanged:P,handleReactUnmount:s,implementationController:f,initialExposedState:d,logFlusher:v,machine:Q,notifySubscribers:B,videoElementCallbacks:a,videoElementRefCallback:function(a){$(a,["videoElementRefCallback"])}};return{engine:c,getCaptionsInfo:function(){return D.current},getVideoElement:function(){return C.current},getVideoLiveTrace:function(){return z.current},handleCaptionsInfoChange:W,handleFatalImplementationError:O,logger:u,machine:Q,videoElementAPIRef:J}}function r(a){var c,d=new Error(a.errorDescription);d.errorName=a.errorName;d.type="error";a.stack!=null&&a.stack!==""&&(d.stack=a.stack);var e=new(b("ErrorMetadata"))();e.addEntries(["COMET_VIDEO","ERROR_LOCATION",a.errorLocation],["COMET_VIDEO","ERROR_CODE",(c=a.errorCode)!=null?c:""],["COMET_VIDEO","ERROR_URL",(c=a.url)!=null?c:""]);c=a.originalError;c!=null&&(typeof c==="string"?e.addEntry("COMET_VIDEO","ORIGINAL_ERROR",c):c instanceof Error&&c.message!=null&&e.addEntry("COMET_VIDEO","ORIGINAL_ERROR",c.message));d.metadata=e;return d}function c(a,c){var d=g.useState(null),e=d[0],f=d[1],h=g.useRef(!1),i=g.useRef(null);d=g.useState(null);var j=d[0],k=d[1];g.useEffect(function(){j||(i.current=null)},[j]);var l=g.useRef(a),m=g.useRef(c),n=b("useStable")(function(){return m.current({debugLogId:String(l.current.loggingMetaData.instanceKey),handleFatalError:function(a){if(h.current&&b("gkx")("1722590"))return;b("gkx")("1444664")?i.current||(i.current=a,k(a)):k(a)},initialProps:l.current,setExposedStateInReact:f})});c=(d=e)!=null?d:n.initialExposedState;d=(e=c.error)!=null?e:j;if(d!=null){if(b("killswitch")("COMET_VIDEO_ERROR_DEAGGREGATION"))throw b("unrecoverableViolation")(d.errorName+": "+d.errorDescription,"comet_video_player",{error:d.originalError instanceof Error?d.originalError:void 0});throw r(d)}g.useEffect(function(){n.handleReactMount();return function(){h.current=!0,n.handleReactUnmount()}},[n]);var o=g.useRef(null);g.useEffect(function(){a!==o.current&&n.handleReactPropsChanged(a),o.current=a});return[c,n]}}),null);
__d("VideoPlaybackQuality",[],(function(a,b,c,d,e,f){f.getDroppedFrames=a;f.getTotalFrames=b;function a(a){if(typeof a.getVideoPlaybackQuality==="function")return a.getVideoPlaybackQuality().droppedVideoFrames;a=a.webkitDroppedFrameCount;return typeof a==="number"?a:0}function b(a){if(typeof a.getVideoPlaybackQuality==="function")return a.getVideoPlaybackQuality().totalVideoFrames;a=a.webkitDecodedFrameCount;return typeof a==="number"?a:0}}),null);
__d("VideoPlayerImplementationEngineVideoElementAPI",["Promise","VideoPlaybackQuality"],(function(a,b,c,d,e,f){"use strict";f.getDurationFromVideoElement=h;f.getLastBufferEndPositionFromVideoElement=i;f.getPlayheadPositionFromVideoElement=j;f.createVideoPlayerImplementationEngineVideoElementAPI=a;function g(a){return isNaN(a)?0:a}function h(a){return g(a.duration)}function i(a){a=a.buffered;return a.length>0?a.end(a.length-1):0}function j(a){return g(a.currentTime)}function a(a){return{getCanPlayPromise:function(){return new(b("Promise"))(function(b,c){a.readyState===4?b():a.addEventListener("canplay",function(){return b()})})},getDroppedFrameCount:function(){return b("VideoPlaybackQuality").getDroppedFrames(a)},getDuration:function(){return h(a)},getEnded:function(){return a.ended},getError:function(){return a.error},getLastBufferEndPosition:function(){return i(a)},getMuted:function(){return a.muted},getNetworkState:function(){return a.networkState},getPaused:function(){return a.paused},getPlaybackRate:function(){return a.playbackRate},getPlayheadPosition:function(){return j(a)},getReadyState:function(){return a.readyState},getTotalFrameCount:function(){return b("VideoPlaybackQuality").getTotalFrames(a)},getUnderlyingVideoElement:function(){return a},getVolume:function(){return a.volume},loadMetaData:function(){return new(b("Promise"))(function(b,c){a.addEventListener("loadedmetadata",function(){return b()})})},pause:function(){a.pause()},play:function(){var c=a.play();c=c&&typeof c.then==="function"?b("Promise").resolve(c):null;return c},setDuration:function(b){a.duration=b},setMuted:function(b){a.muted=b},setPlaybackRate:function(b){a.playbackRate=b},setPlayheadPosition:function(b){a.currentTime=b},setSrc:function(b){b==null||b===""?a.removeAttribute("src"):a.setAttribute("src",b)},setVolume:function(b){a.volume=b}}}}),null);
__d("VideoPlayerImplementationReactVideoElement.react",["React","stylex"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){var b=a.implementationController,c=a.implementationExposedState,d=a.renderWithVideoImplementationStates,e=a.src,f=a.videoElementCallbacks;a=a.videoElementRefCallback;f=g.jsxs(g.Fragment,{children:[g.jsx("video",babelHelpers["extends"]({className:"k4urcfbm datstx6m a8c37x1j",controls:!1,muted:!0},f,{ref:a,src:e})),d({implementationController:b,videoState:c})]});return f}}),null);